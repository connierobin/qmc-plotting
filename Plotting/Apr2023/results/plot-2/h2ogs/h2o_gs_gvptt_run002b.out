Rank =    0  Free Memory = 74915 MB
Rank =    1  Free Memory = 74915 MB
Rank =    2  Free Memory = 74915 MB
Rank =    3  Free Memory = 74915 MB
Rank =    4  Free Memory = 74915 MB
Rank =    5  Free Memory = 74915 MB
Rank =    6  Free Memory = 74915 MB
Rank =    7  Free Memory = 74915 MB
Rank =    8  Free Memory = 74915 MB
Rank =    9  Free Memory = 74915 MB
Rank =   10  Free Memory = 74915 MB
Rank =   11  Free Memory = 74915 MB
Rank =   12  Free Memory = 74915 MB
Rank =   13  Free Memory = 74915 MB
Rank =   14  Free Memory = 74915 MB
Rank =   15  Free Memory = 74901 MB
Rank =   16  Free Memory = 74901 MB
Rank =   17  Free Memory = 74900 MB
Rank =   18  Free Memory = 74900 MB
Rank =   19  Free Memory = 74900 MB
Rank =   20  Free Memory = 74900 MB
Rank =   21  Free Memory = 74900 MB
Rank =   22  Free Memory = 74900 MB
Rank =   23  Free Memory = 74900 MB
Rank =   24  Free Memory = 74900 MB
Rank =   25  Free Memory = 74900 MB
Rank =   26  Free Memory = 74900 MB
Rank =   27  Free Memory = 74900 MB
Rank =   28  Free Memory = 74900 MB
Rank =   29  Free Memory = 74900 MB
Rank =   30  Free Memory = 74900 MB
Rank =   31  Free Memory = 74900 MB
Rank =   32  Free Memory = 84251 MB
Rank =   33  Free Memory = 84251 MB
Rank =   34  Free Memory = 84251 MB
Rank =   35  Free Memory = 84251 MB
Rank =   36  Free Memory = 84251 MB
Rank =   37  Free Memory = 84251 MB
Rank =   38  Free Memory = 84251 MB
Rank =   39  Free Memory = 84251 MB
Rank =   40  Free Memory = 84251 MB
Rank =   41  Free Memory = 84251 MB
Rank =   42  Free Memory = 84251 MB
Rank =   43  Free Memory = 84251 MB
Rank =   44  Free Memory = 84251 MB
Rank =   45  Free Memory = 84251 MB
Rank =   46  Free Memory = 84251 MB
Rank =   47  Free Memory = 84251 MB
Rank =   48  Free Memory = 84251 MB
Rank =   49  Free Memory = 84251 MB
Rank =   50  Free Memory = 84251 MB
Rank =   51  Free Memory = 84251 MB
Rank =   52  Free Memory = 84251 MB
Rank =   53  Free Memory = 84251 MB
Rank =   54  Free Memory = 84251 MB
Rank =   55  Free Memory = 84251 MB
Rank =   56  Free Memory = 84251 MB
Rank =   57  Free Memory = 84251 MB
Rank =   58  Free Memory = 84251 MB
Rank =   59  Free Memory = 84250 MB
Rank =   60  Free Memory = 84250 MB
Rank =   61  Free Memory = 84250 MB
Rank =   62  Free Memory = 84250 MB
Rank =   63  Free Memory = 84250 MB
Rank =   64  Free Memory = 89901 MB
Rank =   65  Free Memory = 89901 MB
Rank =   66  Free Memory = 89901 MB
Rank =   67  Free Memory = 89901 MB
Rank =   68  Free Memory = 89901 MB
Rank =   69  Free Memory = 89901 MB
Rank =   70  Free Memory = 89901 MB
Rank =   71  Free Memory = 89901 MB
Rank =   72  Free Memory = 89901 MB
Rank =   73  Free Memory = 89901 MB
Rank =   74  Free Memory = 89901 MB
Rank =   75  Free Memory = 89901 MB
Rank =   76  Free Memory = 89901 MB
Rank =   77  Free Memory = 89901 MB
Rank =   78  Free Memory = 89901 MB
Rank =   79  Free Memory = 89901 MB
Rank =   80  Free Memory = 89901 MB
Rank =   81  Free Memory = 89901 MB
Rank =   82  Free Memory = 89901 MB
Rank =   83  Free Memory = 89901 MB
Rank =   84  Free Memory = 89901 MB
Rank =   85  Free Memory = 89901 MB
Rank =   86  Free Memory = 89901 MB
Rank =   87  Free Memory = 89901 MB
Rank =   88  Free Memory = 89901 MB
Rank =   89  Free Memory = 89901 MB
Rank =   90  Free Memory = 89901 MB
Rank =   91  Free Memory = 89901 MB
Rank =   92  Free Memory = 89901 MB
Rank =   93  Free Memory = 89901 MB
Rank =   94  Free Memory = 89901 MB
Rank =   95  Free Memory = 89901 MB
Rank =   96  Free Memory = 87358 MB
Rank =   97  Free Memory = 87358 MB
Rank =   98  Free Memory = 87358 MB
Rank =   99  Free Memory = 87358 MB
Rank =  100  Free Memory = 87358 MB
Rank =  101  Free Memory = 87358 MB
Rank =  102  Free Memory = 87358 MB
Rank =  103  Free Memory = 87358 MB
Rank =  104  Free Memory = 87358 MB
Rank =  105  Free Memory = 87358 MB
Rank =  106  Free Memory = 87358 MB
Rank =  107  Free Memory = 87358 MB
Rank =  108  Free Memory = 87358 MB
Rank =  109  Free Memory = 87358 MB
Rank =  110  Free Memory = 87358 MB
Rank =  111  Free Memory = 87358 MB
Rank =  112  Free Memory = 87358 MB
Rank =  113  Free Memory = 87358 MB
Rank =  114  Free Memory = 87358 MB
Rank =  115  Free Memory = 87358 MB
Rank =  116  Free Memory = 87358 MB
Rank =  117  Free Memory = 87358 MB
Rank =  118  Free Memory = 87358 MB
Rank =  119  Free Memory = 87358 MB
Rank =  120  Free Memory = 87358 MB
Rank =  121  Free Memory = 87357 MB
Rank =  122  Free Memory = 87357 MB
Rank =  123  Free Memory = 87357 MB
Rank =  124  Free Memory = 87357 MB
Rank =  125  Free Memory = 87357 MB
Rank =  126  Free Memory = 87357 MB
Rank =  127  Free Memory = 87357 MB
  Input file(s): opt_h2o_gs_gvptt_run002b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run002b.xml

  Project = H2O
  date    = 2023-03-12 23:39:20 PDT
  host    = n0057.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 280

  Range of prime numbers to use as seeds over processors and threads = 1831-2819


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.732180e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2999e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2466
    reference variance = 0.203961
====================================================
  Execution time = 4.0431e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0855e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0799e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308616140099
                                         uncertainty =       0.002999932447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308616140099
                                         uncertainty =       0.002999932447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392778519
  error estimate for blocks of size 2^( 2) =       0.000404117914
  error estimate for blocks of size 2^( 3) =       0.000414623221
  error estimate for blocks of size 2^( 4) =       0.000421862960
  error estimate for blocks of size 2^( 5) =       0.000427137253
  error estimate for blocks of size 2^( 6) =       0.000430978895
  error estimate for blocks of size 2^( 7) =       0.000433188720

      target function =                  N/A
              le_mean =     -17.214035865731
             les_mean =     296.631580562891
             stat err =       0.000428291957
             autocorr =       1.189006915382
              std dev =       0.555472709036
             le_variance =       0.308549930484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721403586573e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214035865731       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214352720526       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214496215313       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214651735425       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214820620860       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214879301549       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214891871947       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214898763225       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214901544308       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214901774588       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214901579806       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214901611280       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214901552446       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.754127e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214035865731       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214172983583       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214235341200       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214301112765       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214372994023       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214391878364       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214391762181       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214392649490       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214392559589       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214392630157       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214392460880       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.636414e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214035865731       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214077809883       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214097460345       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214118401544       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214139767413       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214144338149       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214144510053       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214144646323       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214144574191       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214144580571       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214144520271       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.561889e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1556e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.928161e-01                 1 1 ON  0
uu_1  3.710096e-02                 1 1 ON  1
uu_2  -4.658209e-02                1 1 ON  2
uu_3  -9.444368e-02                1 1 ON  3
uu_4  -1.252838e-01                1 1 ON  4
uu_5  -1.327568e-01                1 1 ON  5
uu_6  -1.094005e-01                1 1 ON  6
uu_7  -3.344619e-02                1 1 ON  7
uu_8  1.030105e-01                 1 1 ON  8
uu_9  1.188706e-01                 1 1 ON  9
ud_0  3.198532e-01                 1 1 ON  10
ud_1  7.799842e-02                 1 1 ON  11
ud_2  -1.010728e-02                1 1 ON  12
ud_3  -5.823617e-02                1 1 ON  13
ud_4  -1.073136e-01                1 1 ON  14
ud_5  -1.487772e-01                1 1 ON  15
ud_6  -1.577180e-01                1 1 ON  16
ud_7  -1.081435e-01                1 1 ON  17
ud_8  9.570863e-03                 1 1 ON  18
ud_9  9.250182e-02                 1 1 ON  19
eO_0  -6.868058e-01                1 1 ON  20
eO_1  -4.052009e-01                1 1 ON  21
eO_2  -5.626468e-02                1 1 ON  22
eO_3  1.651322e-01                 1 1 ON  23
eO_4  2.642878e-01                 1 1 ON  24
eO_5  3.065813e-01                 1 1 ON  25
eO_6  2.482185e-01                 1 1 ON  26
eO_7  1.082418e-01                 1 1 ON  27
eO_8  2.729164e-02                 1 1 ON  28
eO_9  1.814189e-02                 1 1 ON  29
eH1_0 -1.760392e-01                1 1 ON  30
eH1_1 -9.842485e-02                1 1 ON  31
eH1_2 -6.249092e-02                1 1 ON  32
eH1_3 -2.846173e-02                1 1 ON  33
eH1_4 1.803688e-02                 1 1 ON  34
eH1_5 3.106134e-02                 1 1 ON  35
eH1_6 7.762475e-02                 1 1 ON  36
eH1_7 1.114397e-01                 1 1 ON  37
eH1_8 8.860022e-02                 1 1 ON  38
eH1_9 2.361472e-02                 1 1 ON  39
eH2_0 -1.777485e-01                1 1 ON  40
eH2_1 -1.002759e-01                1 1 ON  41
eH2_2 -6.450117e-02                1 1 ON  42
eH2_3 -2.996246e-02                1 1 ON  43
eH2_4 1.654379e-02                 1 1 ON  44
eH2_5 3.147603e-02                 1 1 ON  45
eH2_6 8.009504e-02                 1 1 ON  46
eH2_7 1.152036e-01                 1 1 ON  47
eH2_8 9.165177e-02                 1 1 ON  48
eH2_9 2.562889e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.151266
====================================================
  Execution time = 3.9714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0763e-01
  Total weights = 2.0000e+06
  Execution time = 3.6539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306548037048
                                         uncertainty =       0.005670935065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306548037048
                                         uncertainty =       0.005670935065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391441803
  error estimate for blocks of size 2^( 2) =       0.000403375984
  error estimate for blocks of size 2^( 3) =       0.000413734758
  error estimate for blocks of size 2^( 4) =       0.000420703707
  error estimate for blocks of size 2^( 5) =       0.000425191399
  error estimate for blocks of size 2^( 6) =       0.000425414195
  error estimate for blocks of size 2^( 7) =       0.000425910459

      target function =                  N/A
              le_mean =     -17.215538737872
             les_mean =     296.681227251683
             stat err =       0.000424304940
             autocorr =       1.174956451979
              std dev =       0.553582306215
             le_variance =       0.306453369755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311592118717
                                         uncertainty =       0.005691654765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311592118717
                                         uncertainty =       0.005691654765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394646610
  error estimate for blocks of size 2^( 2) =       0.000405539696
  error estimate for blocks of size 2^( 3) =       0.000415041360
  error estimate for blocks of size 2^( 4) =       0.000421515548
  error estimate for blocks of size 2^( 5) =       0.000425843542
  error estimate for blocks of size 2^( 6) =       0.000425851936
  error estimate for blocks of size 2^( 7) =       0.000426322786

      target function =                  N/A
              le_mean =     -17.215631361896
             les_mean =     296.689454927046
             stat err =       0.000424883453
             autocorr =       1.159105275107
              std dev =       0.558114588685
             le_variance =       0.311491894103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310079134408
                                         uncertainty =       0.005665578701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310079134408
                                         uncertainty =       0.005665578701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393687654
  error estimate for blocks of size 2^( 2) =       0.000404769119
  error estimate for blocks of size 2^( 3) =       0.000414441572
  error estimate for blocks of size 2^( 4) =       0.000421017243
  error estimate for blocks of size 2^( 5) =       0.000425390924
  error estimate for blocks of size 2^( 6) =       0.000425443154
  error estimate for blocks of size 2^( 7) =       0.000425862928

      target function =                  N/A
              le_mean =     -17.215549961734
             les_mean =     296.685140268338
             stat err =       0.000424428562
             autocorr =       1.162266213826
              std dev =       0.556758420103
             le_variance =       0.309979938355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306738950353
                                         uncertainty =       0.005667679221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306738950353
                                         uncertainty =       0.005667679221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391563286
  error estimate for blocks of size 2^( 2) =       0.000403352137
  error estimate for blocks of size 2^( 3) =       0.000413598114
  error estimate for blocks of size 2^( 4) =       0.000420503794
  error estimate for blocks of size 2^( 5) =       0.000424973366
  error estimate for blocks of size 2^( 6) =       0.000425168402
  error estimate for blocks of size 2^( 7) =       0.000425646231

      target function =                  N/A
              le_mean =     -17.215495271124
             les_mean =     296.679920889961
             stat err =       0.000424072948
             autocorr =       1.172943818866
              std dev =       0.553754108962
             le_variance =       0.306643613193


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215538737872        initial
     2.5000e-01     2.5000e+00             1.7541e-02       -17.215631361896  <--
     1.0000e+00     1.0000e+01             5.6364e-03       -17.215549961734
     4.0000e+00     4.0000e+01             1.5619e-03       -17.215495271124

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.8100e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.951145e-01 1 1  ON 0
 uu_1                 3.875559e-02 1 1  ON 1
 uu_2                -4.773476e-02 1 1  ON 2
 uu_3                -9.607225e-02 1 1  ON 3
 uu_4                -1.258191e-01 1 1  ON 4
 uu_5                -1.328758e-01 1 1  ON 5
 uu_6                -1.097309e-01 1 1  ON 6
 uu_7                -3.398938e-02 1 1  ON 7
 uu_8                 1.027938e-01 1 1  ON 8
 uu_9                 1.190591e-01 1 1  ON 9
 ud_0                 3.274828e-01 1 1  ON 10
 ud_1                 8.094699e-02 1 1  ON 11
 ud_2                -1.318112e-02 1 1  ON 12
 ud_3                -6.318498e-02 1 1  ON 13
 ud_4                -1.097566e-01 1 1  ON 14
 ud_5                -1.482699e-01 1 1  ON 15
 ud_6                -1.576176e-01 1 1  ON 16
 ud_7                -1.087796e-01 1 1  ON 17
 ud_8                 9.071962e-03 1 1  ON 18
 ud_9                 9.254795e-02 1 1  ON 19
 eO_0                -6.987107e-01 1 1  ON 20
 eO_1                -4.095116e-01 1 1  ON 21
 eO_2                -4.850975e-02 1 1  ON 22
 eO_3                 1.726587e-01 1 1  ON 23
 eO_4                 2.654501e-01 1 1  ON 24
 eO_5                 3.057177e-01 1 1  ON 25
 eO_6                 2.483299e-01 1 1  ON 26
 eO_7                 1.085950e-01 1 1  ON 27
 eO_8                 2.735530e-02 1 1  ON 28
 eO_9                 1.818052e-02 1 1  ON 29
eH1_0                -1.767619e-01 1 1  ON 30
eH1_1                -9.881805e-02 1 1  ON 31
eH1_2                -6.270947e-02 1 1  ON 32
eH1_3                -2.788912e-02 1 1  ON 33
eH1_4                 1.867103e-02 1 1  ON 34
eH1_5                 3.155344e-02 1 1  ON 35
eH1_6                 7.704155e-02 1 1  ON 36
eH1_7                 1.112755e-01 1 1  ON 37
eH1_8                 8.882510e-02 1 1  ON 38
eH1_9                 2.371210e-02 1 1  ON 39
eH2_0                -1.785179e-01 1 1  ON 40
eH2_1                -1.008754e-01 1 1  ON 41
eH2_2                -6.458840e-02 1 1  ON 42
eH2_3                -2.942131e-02 1 1  ON 43
eH2_4                 1.709042e-02 1 1  ON 44
eH2_5                 3.193825e-02 1 1  ON 45
eH2_6                 7.977498e-02 1 1  ON 46
eH2_7                 1.151057e-01 1 1  ON 47
eH2_8                 9.187125e-02 1 1  ON 48
eH2_9                 2.567553e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0966e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2264
    reference variance = 0.261563
====================================================
  Execution time = 4.1577e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2699e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0800e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327087914303
                                         uncertainty =       0.017155848933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327087914303
                                         uncertainty =       0.017155848933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404344916
  error estimate for blocks of size 2^( 2) =       0.000414497201
  error estimate for blocks of size 2^( 3) =       0.000423888231
  error estimate for blocks of size 2^( 4) =       0.000430346112
  error estimate for blocks of size 2^( 5) =       0.000434386552
  error estimate for blocks of size 2^( 6) =       0.000436242340
  error estimate for blocks of size 2^( 7) =       0.000436015267

      target function =                  N/A
              le_mean =     -17.216451962894
             les_mean =     296.733207648978
             stat err =       0.000434247568
             autocorr =       1.153375748697
              std dev =       0.571830063762
             le_variance =       0.326989621822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645196289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216451962894       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538795239       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216602139228       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216673234817       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216742493395       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216813885995       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216846647504       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216870222988       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216875557895       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216882027115       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216882378015       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216883221367       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216881861659       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216882175162       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216882227079       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216882685258       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216882763001       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.876871e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216451962894       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216507793406       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546140608       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216584670951       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216628978972       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216660511432       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216666620428       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216672672758       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216672847276       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216673377386       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216673178163       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216673024731       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.178289e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216451962894       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216474956014       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490812050       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216504924390       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216522791949       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216531389348       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216531366369       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216532467182       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216532370298       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216532386470       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216532350074       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.724441e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.327457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2392e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.975864e-01 1 1  ON 0
 uu_1                 4.028532e-02 1 1  ON 1
 uu_2                -4.847731e-02 1 1  ON 2
 uu_3                -9.753314e-02 1 1  ON 3
 uu_4                -1.269108e-01 1 1  ON 4
 uu_5                -1.330710e-01 1 1  ON 5
 uu_6                -1.100972e-01 1 1  ON 6
 uu_7                -3.456238e-02 1 1  ON 7
 uu_8                 1.025705e-01 1 1  ON 8
 uu_9                 1.193646e-01 1 1  ON 9
 ud_0                 3.334351e-01 1 1  ON 10
 ud_1                 8.324418e-02 1 1  ON 11
 ud_2                -1.520347e-02 1 1  ON 12
 ud_3                -6.716586e-02 1 1  ON 13
 ud_4                -1.125370e-01 1 1  ON 14
 ud_5                -1.480340e-01 1 1  ON 15
 ud_6                -1.568987e-01 1 1  ON 16
 ud_7                -1.090526e-01 1 1  ON 17
 ud_8                 8.646536e-03 1 1  ON 18
 ud_9                 9.257949e-02 1 1  ON 19
 eO_0                -7.104936e-01 1 1  ON 20
 eO_1                -4.138617e-01 1 1  ON 21
 eO_2                -4.274956e-02 1 1  ON 22
 eO_3                 1.807606e-01 1 1  ON 23
 eO_4                 2.675895e-01 1 1  ON 24
 eO_5                 3.048501e-01 1 1  ON 25
 eO_6                 2.485476e-01 1 1  ON 26
 eO_7                 1.091626e-01 1 1  ON 27
 eO_8                 2.749066e-02 1 1  ON 28
 eO_9                 1.823153e-02 1 1  ON 29
eH1_0                -1.775791e-01 1 1  ON 30
eH1_1                -9.991420e-02 1 1  ON 31
eH1_2                -6.270227e-02 1 1  ON 32
eH1_3                -2.733647e-02 1 1  ON 33
eH1_4                 1.897834e-02 1 1  ON 34
eH1_5                 3.245516e-02 1 1  ON 35
eH1_6                 7.700992e-02 1 1  ON 36
eH1_7                 1.110651e-01 1 1  ON 37
eH1_8                 8.906134e-02 1 1  ON 38
eH1_9                 2.380879e-02 1 1  ON 39
eH2_0                -1.795535e-01 1 1  ON 40
eH2_1                -1.016654e-01 1 1  ON 41
eH2_2                -6.433935e-02 1 1  ON 42
eH2_3                -2.877432e-02 1 1  ON 43
eH2_4                 1.761545e-02 1 1  ON 44
eH2_5                 3.224970e-02 1 1  ON 45
eH2_6                 7.939695e-02 1 1  ON 46
eH2_7                 1.150676e-01 1 1  ON 47
eH2_8                 9.223010e-02 1 1  ON 48
eH2_9                 2.580036e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2513
    reference variance = 0.251558
====================================================
  Execution time = 4.0595e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1463e-01
  Total weights = 2.0000e+06
  Execution time = 3.6605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310339651274
                                         uncertainty =       0.003441995110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310339651274
                                         uncertainty =       0.003441995110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393887034
  error estimate for blocks of size 2^( 2) =       0.000404485405
  error estimate for blocks of size 2^( 3) =       0.000413731854
  error estimate for blocks of size 2^( 4) =       0.000420470249
  error estimate for blocks of size 2^( 5) =       0.000424354613
  error estimate for blocks of size 2^( 6) =       0.000425702070
  error estimate for blocks of size 2^( 7) =       0.000426181397

      target function =                  N/A
              le_mean =     -17.215806602689
             les_mean =     296.694290817441
             stat err =       0.000424177082
             autocorr =       1.159714349188
              std dev =       0.557040385775
             le_variance =       0.310293991385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319025770863
                                         uncertainty =       0.003489401864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319025770863
                                         uncertainty =       0.003489401864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399360657
  error estimate for blocks of size 2^( 2) =       0.000409274531
  error estimate for blocks of size 2^( 3) =       0.000417936835
  error estimate for blocks of size 2^( 4) =       0.000424288541
  error estimate for blocks of size 2^( 5) =       0.000427892082
  error estimate for blocks of size 2^( 6) =       0.000429124825
  error estimate for blocks of size 2^( 7) =       0.000429440897

      target function =                  N/A
              le_mean =     -17.215772396915
             les_mean =     296.701796932064
             stat err =       0.000427686586
             autocorr =       1.146887190521
              std dev =       0.564781257824
             le_variance =       0.318977869189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320172692336
                                         uncertainty =       0.003493927304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320172692336
                                         uncertainty =       0.003493927304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400078252
  error estimate for blocks of size 2^( 2) =       0.000409976776
  error estimate for blocks of size 2^( 3) =       0.000418642854
  error estimate for blocks of size 2^( 4) =       0.000425019351
  error estimate for blocks of size 2^( 5) =       0.000428632897
  error estimate for blocks of size 2^( 6) =       0.000429843212
  error estimate for blocks of size 2^( 7) =       0.000430169353

      target function =                  N/A
              le_mean =     -17.215796183305
             les_mean =     296.703763280711
             stat err =       0.000428416203
             autocorr =       1.146679076703
              std dev =       0.565796090202
             le_variance =       0.320125215688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311910512348
                                         uncertainty =       0.003450979254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311910512348
                                         uncertainty =       0.003450979254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394882606
  error estimate for blocks of size 2^( 2) =       0.000405322685
  error estimate for blocks of size 2^( 3) =       0.000414441369
  error estimate for blocks of size 2^( 4) =       0.000421105357
  error estimate for blocks of size 2^( 5) =       0.000424932864
  error estimate for blocks of size 2^( 6) =       0.000426250693
  error estimate for blocks of size 2^( 7) =       0.000426703520

      target function =                  N/A
              le_mean =     -17.215747580213
             les_mean =     296.693829134069
             stat err =       0.000424748109
             autocorr =       1.156982792443
              std dev =       0.558448336358
             le_variance =       0.311864544381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215806602689        initial  <--
     6.2500e-02     6.2500e-01             2.8769e-02       -17.215772396915
     2.5000e-01     2.5000e+00             1.1783e-02       -17.215796183305
     1.0000e+00     1.0000e+01             3.7244e-03       -17.215747580213

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.0324
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.951145e-01 1 1  ON 0
 uu_1                 3.875559e-02 1 1  ON 1
 uu_2                -4.773476e-02 1 1  ON 2
 uu_3                -9.607225e-02 1 1  ON 3
 uu_4                -1.258191e-01 1 1  ON 4
 uu_5                -1.328758e-01 1 1  ON 5
 uu_6                -1.097309e-01 1 1  ON 6
 uu_7                -3.398938e-02 1 1  ON 7
 uu_8                 1.027938e-01 1 1  ON 8
 uu_9                 1.190591e-01 1 1  ON 9
 ud_0                 3.274828e-01 1 1  ON 10
 ud_1                 8.094699e-02 1 1  ON 11
 ud_2                -1.318112e-02 1 1  ON 12
 ud_3                -6.318498e-02 1 1  ON 13
 ud_4                -1.097566e-01 1 1  ON 14
 ud_5                -1.482699e-01 1 1  ON 15
 ud_6                -1.576176e-01 1 1  ON 16
 ud_7                -1.087796e-01 1 1  ON 17
 ud_8                 9.071962e-03 1 1  ON 18
 ud_9                 9.254795e-02 1 1  ON 19
 eO_0                -6.987107e-01 1 1  ON 20
 eO_1                -4.095116e-01 1 1  ON 21
 eO_2                -4.850975e-02 1 1  ON 22
 eO_3                 1.726587e-01 1 1  ON 23
 eO_4                 2.654501e-01 1 1  ON 24
 eO_5                 3.057177e-01 1 1  ON 25
 eO_6                 2.483299e-01 1 1  ON 26
 eO_7                 1.085950e-01 1 1  ON 27
 eO_8                 2.735530e-02 1 1  ON 28
 eO_9                 1.818052e-02 1 1  ON 29
eH1_0                -1.767619e-01 1 1  ON 30
eH1_1                -9.881805e-02 1 1  ON 31
eH1_2                -6.270947e-02 1 1  ON 32
eH1_3                -2.788912e-02 1 1  ON 33
eH1_4                 1.867103e-02 1 1  ON 34
eH1_5                 3.155344e-02 1 1  ON 35
eH1_6                 7.704155e-02 1 1  ON 36
eH1_7                 1.112755e-01 1 1  ON 37
eH1_8                 8.882510e-02 1 1  ON 38
eH1_9                 2.371210e-02 1 1  ON 39
eH2_0                -1.785179e-01 1 1  ON 40
eH2_1                -1.008754e-01 1 1  ON 41
eH2_2                -6.458840e-02 1 1  ON 42
eH2_3                -2.942131e-02 1 1  ON 43
eH2_4                 1.709042e-02 1 1  ON 44
eH2_5                 3.193825e-02 1 1  ON 45
eH2_6                 7.977498e-02 1 1  ON 46
eH2_7                 1.151057e-01 1 1  ON 47
eH2_8                 9.187125e-02 1 1  ON 48
eH2_9                 2.567553e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1143e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2295
    reference variance = 0.210217
====================================================
  Execution time = 4.0202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1652e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0677e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316483684468
                                         uncertainty =       0.005807777261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316483684468
                                         uncertainty =       0.005807777261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397818165
  error estimate for blocks of size 2^( 2) =       0.000408097669
  error estimate for blocks of size 2^( 3) =       0.000417525952
  error estimate for blocks of size 2^( 4) =       0.000424395902
  error estimate for blocks of size 2^( 5) =       0.000428106829
  error estimate for blocks of size 2^( 6) =       0.000431083128
  error estimate for blocks of size 2^( 7) =       0.000431749804

      target function =                  N/A
              le_mean =     -17.215082792513
             les_mean =     296.675593979929
             stat err =       0.000428833916
             autocorr =       1.162007767539
              std dev =       0.562599844557
             le_variance =       0.316518585096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721508279251e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215082792513       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215125767243       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215155785447       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215179867214       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215197013974       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215206374312       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215207186584       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215208499757       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215208830515       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215208664027       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215208481779       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.621000e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215082792513       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215096718941       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215106676721       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215114629392       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215120010854       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215121948531       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215121761595       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215121942559       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215122028159       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215122033914       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.575816e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215082792513       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215086552592       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215089277868       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215091461901       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215092909857       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215093341077       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215093263841       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215093295751       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215093313268       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215093317580       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.071605e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0890e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.954316e-01 1 1  ON 0
 uu_1                 3.902124e-02 1 1  ON 1
 uu_2                -4.789403e-02 1 1  ON 2
 uu_3                -9.628926e-02 1 1  ON 3
 uu_4                -1.259162e-01 1 1  ON 4
 uu_5                -1.328324e-01 1 1  ON 5
 uu_6                -1.098218e-01 1 1  ON 6
 uu_7                -3.406607e-02 1 1  ON 7
 uu_8                 1.027530e-01 1 1  ON 8
 uu_9                 1.190821e-01 1 1  ON 9
 ud_0                 3.285408e-01 1 1  ON 10
 ud_1                 8.131755e-02 1 1  ON 11
 ud_2                -1.363652e-02 1 1  ON 12
 ud_3                -6.384734e-02 1 1  ON 13
 ud_4                -1.100786e-01 1 1  ON 14
 ud_5                -1.481756e-01 1 1  ON 15
 ud_6                -1.575830e-01 1 1  ON 16
 ud_7                -1.088656e-01 1 1  ON 17
 ud_8                 9.008948e-03 1 1  ON 18
 ud_9                 9.254761e-02 1 1  ON 19
 eO_0                -7.002865e-01 1 1  ON 20
 eO_1                -4.100701e-01 1 1  ON 21
 eO_2                -4.743701e-02 1 1  ON 22
 eO_3                 1.736654e-01 1 1  ON 23
 eO_4                 2.655636e-01 1 1  ON 24
 eO_5                 3.055901e-01 1 1  ON 25
 eO_6                 2.483365e-01 1 1  ON 26
 eO_7                 1.086437e-01 1 1  ON 27
 eO_8                 2.736221e-02 1 1  ON 28
 eO_9                 1.818335e-02 1 1  ON 29
eH1_0                -1.768768e-01 1 1  ON 30
eH1_1                -9.884733e-02 1 1  ON 31
eH1_2                -6.274569e-02 1 1  ON 32
eH1_3                -2.781632e-02 1 1  ON 33
eH1_4                 1.875928e-02 1 1  ON 34
eH1_5                 3.164264e-02 1 1  ON 35
eH1_6                 7.697616e-02 1 1  ON 36
eH1_7                 1.112336e-01 1 1  ON 37
eH1_8                 8.884874e-02 1 1  ON 38
eH1_9                 2.372220e-02 1 1  ON 39
eH2_0                -1.786455e-01 1 1  ON 40
eH2_1                -1.008964e-01 1 1  ON 41
eH2_2                -6.461331e-02 1 1  ON 42
eH2_3                -2.936640e-02 1 1  ON 43
eH2_4                 1.718977e-02 1 1  ON 44
eH2_5                 3.201191e-02 1 1  ON 45
eH2_6                 7.971034e-02 1 1  ON 46
eH2_7                 1.150832e-01 1 1  ON 47
eH2_8                 9.189403e-02 1 1  ON 48
eH2_9                 2.568232e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.209
    reference variance = 0.164162
====================================================
  Execution time = 3.9895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1754e-01
  Total weights = 2.0000e+06
  Execution time = 3.6529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316782694131
                                         uncertainty =       0.005920832857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316782694131
                                         uncertainty =       0.005920832857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397964255
  error estimate for blocks of size 2^( 2) =       0.000408670706
  error estimate for blocks of size 2^( 3) =       0.000417936021
  error estimate for blocks of size 2^( 4) =       0.000424920780
  error estimate for blocks of size 2^( 5) =       0.000429124315
  error estimate for blocks of size 2^( 6) =       0.000430856678
  error estimate for blocks of size 2^( 7) =       0.000431312690

      target function =                  N/A
              le_mean =     -17.215242684053
             les_mean =     296.681331608395
             stat err =       0.000429053616
             autocorr =       1.162344867127
              std dev =       0.562806446249
             le_variance =       0.316751095940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319366829947
                                         uncertainty =       0.006021773926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319366829947
                                         uncertainty =       0.006021773926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399584506
  error estimate for blocks of size 2^( 2) =       0.000410094608
  error estimate for blocks of size 2^( 3) =       0.000419185506
  error estimate for blocks of size 2^( 4) =       0.000426058370
  error estimate for blocks of size 2^( 5) =       0.000430177542
  error estimate for blocks of size 2^( 6) =       0.000431862869
  error estimate for blocks of size 2^( 7) =       0.000432237429

      target function =                  N/A
              le_mean =     -17.215249542771
             les_mean =     296.684152215539
             stat err =       0.000430084053
             autocorr =       1.158482287279
              std dev =       0.565097828114
             le_variance =       0.319335555339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396493498
                                         uncertainty =       0.005982949235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396493498
                                         uncertainty =       0.005982949235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398976866
  error estimate for blocks of size 2^( 2) =       0.000409557612
  error estimate for blocks of size 2^( 3) =       0.000418713252
  error estimate for blocks of size 2^( 4) =       0.000425627921
  error estimate for blocks of size 2^( 5) =       0.000429777223
  error estimate for blocks of size 2^( 6) =       0.000431479250
  error estimate for blocks of size 2^( 7) =       0.000431880536

      target function =                  N/A
              le_mean =     -17.215240731000
             les_mean =     296.682878345969
             stat err =       0.000429691233
             autocorr =       1.159892008225
              std dev =       0.564238494679
             le_variance =       0.318365078878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316991455752
                                         uncertainty =       0.005929061245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316991455752
                                         uncertainty =       0.005929061245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398095392
  error estimate for blocks of size 2^( 2) =       0.000408784300
  error estimate for blocks of size 2^( 3) =       0.000418034514
  error estimate for blocks of size 2^( 4) =       0.000425009671
  error estimate for blocks of size 2^( 5) =       0.000429205796
  error estimate for blocks of size 2^( 6) =       0.000430933976
  error estimate for blocks of size 2^( 7) =       0.000431382419

      target function =                  N/A
              le_mean =     -17.215240985843
             les_mean =     296.681481924185
             stat err =       0.000429132966
             autocorr =       1.162008901606
              std dev =       0.562991902258
             le_variance =       0.316959882008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215242684053        initial
     6.2500e-01     6.2500e+00             5.6210e-03       -17.215249542771  <--
     2.5000e+00     2.5000e+01             1.5758e-03       -17.215240731000
     1.0000e+01     1.0000e+02             4.0716e-04       -17.215240985843

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 5.8329e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.963684e-01 1 1  ON 0
 uu_1                 3.960029e-02 1 1  ON 1
 uu_2                -4.817160e-02 1 1  ON 2
 uu_3                -9.684484e-02 1 1  ON 3
 uu_4                -1.262716e-01 1 1  ON 4
 uu_5                -1.327897e-01 1 1  ON 5
 uu_6                -1.100419e-01 1 1  ON 6
 uu_7                -3.426993e-02 1 1  ON 7
 uu_8                 1.026354e-01 1 1  ON 8
 uu_9                 1.191539e-01 1 1  ON 9
 ud_0                 3.308564e-01 1 1  ON 10
 ud_1                 8.212486e-02 1 1  ON 11
 ud_2                -1.445453e-02 1 1  ON 12
 ud_3                -6.538179e-02 1 1  ON 13
 ud_4                -1.109828e-01 1 1  ON 14
 ud_5                -1.479823e-01 1 1  ON 15
 ud_6                -1.573695e-01 1 1  ON 16
 ud_7                -1.090612e-01 1 1  ON 17
 ud_8                 8.831829e-03 1 1  ON 18
 ud_9                 9.254938e-02 1 1  ON 19
 eO_0                -7.043317e-01 1 1  ON 20
 eO_1                -4.115596e-01 1 1  ON 21
 eO_2                -4.514528e-02 1 1  ON 22
 eO_3                 1.764256e-01 1 1  ON 23
 eO_4                 2.661044e-01 1 1  ON 24
 eO_5                 3.052952e-01 1 1  ON 25
 eO_6                 2.483769e-01 1 1  ON 26
 eO_7                 1.087971e-01 1 1  ON 27
 eO_8                 2.738422e-02 1 1  ON 28
 eO_9                 1.819218e-02 1 1  ON 29
eH1_0                -1.772083e-01 1 1  ON 30
eH1_1                -9.901416e-02 1 1  ON 31
eH1_2                -6.276797e-02 1 1  ON 32
eH1_3                -2.765121e-02 1 1  ON 33
eH1_4                 1.895054e-02 1 1  ON 34
eH1_5                 3.194791e-02 1 1  ON 35
eH1_6                 7.683123e-02 1 1  ON 36
eH1_7                 1.111199e-01 1 1  ON 37
eH1_8                 8.892348e-02 1 1  ON 38
eH1_9                 2.375359e-02 1 1  ON 39
eH2_0                -1.790052e-01 1 1  ON 40
eH2_1                -1.010405e-01 1 1  ON 41
eH2_2                -6.461165e-02 1 1  ON 42
eH2_3                -2.924531e-02 1 1  ON 43
eH2_4                 1.739987e-02 1 1  ON 44
eH2_5                 3.227715e-02 1 1  ON 45
eH2_6                 7.956801e-02 1 1  ON 46
eH2_7                 1.150282e-01 1 1  ON 47
eH2_8                 9.196623e-02 1 1  ON 48
eH2_9                 2.570364e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0923e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2002
    reference variance = 0.307464
====================================================
  Execution time = 4.0195e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1833e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0960e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318287507812
                                         uncertainty =       0.006721193087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318287507812
                                         uncertainty =       0.006721193087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398956884
  error estimate for blocks of size 2^( 2) =       0.000409158563
  error estimate for blocks of size 2^( 3) =       0.000418423734
  error estimate for blocks of size 2^( 4) =       0.000425381245
  error estimate for blocks of size 2^( 5) =       0.000429670961
  error estimate for blocks of size 2^( 6) =       0.000431877260
  error estimate for blocks of size 2^( 7) =       0.000433394566

      target function =                  N/A
              le_mean =     -17.216012098971
             les_mean =     296.709405623997
             stat err =       0.000430081008
             autocorr =       1.162113649194
              std dev =       0.564210236742
             le_variance =       0.318333191244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721601209897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216012098971       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216039373313       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216091809815       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216130003007       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216168295955       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216176938290       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216195209685       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216197268770       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216198836509       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216200180306       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216201516549       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216202016150       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216201695793       residual = 7.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.398033e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216012098971       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216024424175       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216049059184       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216060795578       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216079962151       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216082189924       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216085592050       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216085441339       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216085811331       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216085779309       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216085857832       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.726898e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216012098971       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216015959747       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216023969972       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216027117886       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216032998693       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216033605568       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216034192146       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216034134536       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216034222581       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216034191918       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.321155e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.339293 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1170e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.973764e-01 1 1  ON 0
 uu_1                 4.016290e-02 1 1  ON 1
 uu_2                -4.834372e-02 1 1  ON 2
 uu_3                -9.743351e-02 1 1  ON 3
 uu_4                -1.266124e-01 1 1  ON 4
 uu_5                -1.327273e-01 1 1  ON 5
 uu_6                -1.103184e-01 1 1  ON 6
 uu_7                -3.458605e-02 1 1  ON 7
 uu_8                 1.024915e-01 1 1  ON 8
 uu_9                 1.192394e-01 1 1  ON 9
 ud_0                 3.333703e-01 1 1  ON 10
 ud_1                 8.314887e-02 1 1  ON 11
 ud_2                -1.506094e-02 1 1  ON 12
 ud_3                -6.696652e-02 1 1  ON 13
 ud_4                -1.119539e-01 1 1  ON 14
 ud_5                -1.479021e-01 1 1  ON 15
 ud_6                -1.571725e-01 1 1  ON 16
 ud_7                -1.094099e-01 1 1  ON 17
 ud_8                 8.493365e-03 1 1  ON 18
 ud_9                 9.251875e-02 1 1  ON 19
 eO_0                -7.090586e-01 1 1  ON 20
 eO_1                -4.133447e-01 1 1  ON 21
 eO_2                -4.278274e-02 1 1  ON 22
 eO_3                 1.797170e-01 1 1  ON 23
 eO_4                 2.671385e-01 1 1  ON 24
 eO_5                 3.049063e-01 1 1  ON 25
 eO_6                 2.483707e-01 1 1  ON 26
 eO_7                 1.089687e-01 1 1  ON 27
 eO_8                 2.741140e-02 1 1  ON 28
 eO_9                 1.820364e-02 1 1  ON 29
eH1_0                -1.775996e-01 1 1  ON 30
eH1_1                -9.936614e-02 1 1  ON 31
eH1_2                -6.263135e-02 1 1  ON 32
eH1_3                -2.744747e-02 1 1  ON 33
eH1_4                 1.905611e-02 1 1  ON 34
eH1_5                 3.242835e-02 1 1  ON 35
eH1_6                 7.667893e-02 1 1  ON 36
eH1_7                 1.109692e-01 1 1  ON 37
eH1_8                 8.900657e-02 1 1  ON 38
eH1_9                 2.378588e-02 1 1  ON 39
eH2_0                -1.793738e-01 1 1  ON 40
eH2_1                -1.012785e-01 1 1  ON 41
eH2_2                -6.452173e-02 1 1  ON 42
eH2_3                -2.909605e-02 1 1  ON 43
eH2_4                 1.749728e-02 1 1  ON 44
eH2_5                 3.263973e-02 1 1  ON 45
eH2_6                 7.944361e-02 1 1  ON 46
eH2_7                 1.149259e-01 1 1  ON 47
eH2_8                 9.205705e-02 1 1  ON 48
eH2_9                 2.572735e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1668
    reference variance = 0.231872
====================================================
  Execution time = 3.9617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0822e-01
  Total weights = 2.0000e+06
  Execution time = 3.6375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306445669256
                                         uncertainty =       0.002254697436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306445669256
                                         uncertainty =       0.002254697436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391456459
  error estimate for blocks of size 2^( 2) =       0.000401847732
  error estimate for blocks of size 2^( 3) =       0.000410835359
  error estimate for blocks of size 2^( 4) =       0.000417272243
  error estimate for blocks of size 2^( 5) =       0.000422012443
  error estimate for blocks of size 2^( 6) =       0.000425774493
  error estimate for blocks of size 2^( 7) =       0.000427201517

      target function =                  N/A
              le_mean =     -17.215595692983
             les_mean =     296.683211230096
             stat err =       0.000423065174
             autocorr =       1.168012864244
              std dev =       0.553603033853
             le_variance =       0.306476319092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310779495988
                                         uncertainty =       0.002298946053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310779495988
                                         uncertainty =       0.002298946053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394215198
  error estimate for blocks of size 2^( 2) =       0.000404283308
  error estimate for blocks of size 2^( 3) =       0.000412996155
  error estimate for blocks of size 2^( 4) =       0.000419263576
  error estimate for blocks of size 2^( 5) =       0.000423931657
  error estimate for blocks of size 2^( 6) =       0.000427627740
  error estimate for blocks of size 2^( 7) =       0.000428948229

      target function =                  N/A
              le_mean =     -17.215612074834
             les_mean =     296.688110201114
             stat err =       0.000424942801
             autocorr =       1.161968149368
              std dev =       0.557504480116
             le_variance =       0.310811245349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310114823065
                                         uncertainty =       0.002291036005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310114823065
                                         uncertainty =       0.002291036005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393793389
  error estimate for blocks of size 2^( 2) =       0.000403920020
  error estimate for blocks of size 2^( 3) =       0.000412682615
  error estimate for blocks of size 2^( 4) =       0.000418982050
  error estimate for blocks of size 2^( 5) =       0.000423659237
  error estimate for blocks of size 2^( 6) =       0.000427356893
  error estimate for blocks of size 2^( 7) =       0.000428694467

      target function =                  N/A
              le_mean =     -17.215598892468
             les_mean =     296.686991538437
             stat err =       0.000424673162
             autocorr =       1.162981451494
              std dev =       0.556907952160
             le_variance =       0.310146467180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306974851942
                                         uncertainty =       0.002260226007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306974851942
                                         uncertainty =       0.002260226007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391794375
  error estimate for blocks of size 2^( 2) =       0.000402141561
  error estimate for blocks of size 2^( 3) =       0.000411092050
  error estimate for blocks of size 2^( 4) =       0.000417506346
  error estimate for blocks of size 2^( 5) =       0.000422235798
  error estimate for blocks of size 2^( 6) =       0.000425987008
  error estimate for blocks of size 2^( 7) =       0.000427400541

      target function =                  N/A
              le_mean =     -17.215588617096
             les_mean =     296.683496944843
             stat err =       0.000423282423
             autocorr =       1.167196766286
              std dev =       0.554080919427
             le_variance =       0.307005665273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215595692983        initial
     1.5625e-01     1.5625e+00             1.3980e-02       -17.215612074834  <--
     6.2500e-01     6.2500e+00             4.7269e-03       -17.215598892468
     2.5000e+00     2.5000e+01             1.3212e-03       -17.215588617096

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 6.1110e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.996740e-01 1 1  ON 0
 uu_1                 4.139530e-02 1 1  ON 1
 uu_2                -4.829745e-02 1 1  ON 2
 uu_3                -9.834072e-02 1 1  ON 3
 uu_4                -1.277355e-01 1 1  ON 4
 uu_5                -1.331239e-01 1 1  ON 5
 uu_6                -1.108813e-01 1 1  ON 6
 uu_7                -3.537760e-02 1 1  ON 7
 uu_8                 1.020963e-01 1 1  ON 8
 uu_9                 1.194914e-01 1 1  ON 9
 ud_0                 3.370020e-01 1 1  ON 10
 ud_1                 8.494681e-02 1 1  ON 11
 ud_2                -1.536027e-02 1 1  ON 12
 ud_3                -6.901011e-02 1 1  ON 13
 ud_4                -1.139547e-01 1 1  ON 14
 ud_5                -1.482827e-01 1 1  ON 15
 ud_6                -1.564208e-01 1 1  ON 16
 ud_7                -1.100797e-01 1 1  ON 17
 ud_8                 7.593030e-03 1 1  ON 18
 ud_9                 9.243983e-02 1 1  ON 19
 eO_0                -7.183120e-01 1 1  ON 20
 eO_1                -4.174851e-01 1 1  ON 21
 eO_2                -4.004209e-02 1 1  ON 22
 eO_3                 1.864376e-01 1 1  ON 23
 eO_4                 2.709132e-01 1 1  ON 24
 eO_5                 3.043443e-01 1 1  ON 25
 eO_6                 2.484366e-01 1 1  ON 26
 eO_7                 1.094805e-01 1 1  ON 27
 eO_8                 2.749353e-02 1 1  ON 28
 eO_9                 1.823732e-02 1 1  ON 29
eH1_0                -1.785512e-01 1 1  ON 30
eH1_1                -1.001398e-01 1 1  ON 31
eH1_2                -6.233266e-02 1 1  ON 32
eH1_3                -2.715874e-02 1 1  ON 33
eH1_4                 1.909402e-02 1 1  ON 34
eH1_5                 3.365188e-02 1 1  ON 35
eH1_6                 7.655657e-02 1 1  ON 36
eH1_7                 1.106099e-01 1 1  ON 37
eH1_8                 8.925630e-02 1 1  ON 38
eH1_9                 2.388103e-02 1 1  ON 39
eH2_0                -1.802500e-01 1 1  ON 40
eH2_1                -1.019313e-01 1 1  ON 41
eH2_2                -6.427560e-02 1 1  ON 42
eH2_3                -2.889484e-02 1 1  ON 43
eH2_4                 1.749104e-02 1 1  ON 44
eH2_5                 3.360141e-02 1 1  ON 45
eH2_6                 7.939409e-02 1 1  ON 46
eH2_7                 1.147020e-01 1 1  ON 47
eH2_8                 9.232783e-02 1 1  ON 48
eH2_9                 2.579823e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1229e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1549
    reference variance = 0.202086
====================================================
  Execution time = 4.0996e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1352e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0912e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313535138285
                                         uncertainty =       0.003082732073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313535138285
                                         uncertainty =       0.003082732073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395926406
  error estimate for blocks of size 2^( 2) =       0.000405893728
  error estimate for blocks of size 2^( 3) =       0.000415077700
  error estimate for blocks of size 2^( 4) =       0.000421081927
  error estimate for blocks of size 2^( 5) =       0.000425323552
  error estimate for blocks of size 2^( 6) =       0.000426889196
  error estimate for blocks of size 2^( 7) =       0.000428111100

      target function =                  N/A
              le_mean =     -17.216301840545
             les_mean =     296.714564345221
             stat err =       0.000425351444
             autocorr =       1.154162309937
              std dev =       0.559924492418
             le_variance =       0.313515437209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630184055e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216301840545       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216330179975       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216346303326       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216381373565       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216394332946       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216421156421       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216431459853       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216434694530       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216437675593       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216442981119       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216442227062       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216439351935       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216440796719       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216441661733       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216441180660       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216441469366       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216441575829       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 2.269254e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216301840545       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216321052473       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216331533954       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216352163955       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216357201386       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216366388391       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216369256398       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216369379178       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216369624814       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216370420633       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216369994756       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216369542608       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 9.126299e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216301840545       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216310236202       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216314936396       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216322526298       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216323501853       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216325170076       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216325537463       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216325450933       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216325479069       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216325576818       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.936788e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1923e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.017262e-01 1 1  ON 0
 uu_1                 4.262745e-02 1 1  ON 1
 uu_2                -4.810315e-02 1 1  ON 2
 uu_3                -9.918331e-02 1 1  ON 3
 uu_4                -1.290811e-01 1 1  ON 4
 uu_5                -1.342291e-01 1 1  ON 5
 uu_6                -1.108204e-01 1 1  ON 6
 uu_7                -3.610044e-02 1 1  ON 7
 uu_8                 1.016311e-01 1 1  ON 8
 uu_9                 1.199356e-01 1 1  ON 9
 ud_0                 3.398816e-01 1 1  ON 10
 ud_1                 8.648324e-02 1 1  ON 11
 ud_2                -1.530971e-02 1 1  ON 12
 ud_3                -7.043486e-02 1 1  ON 13
 ud_4                -1.159840e-01 1 1  ON 14
 ud_5                -1.488656e-01 1 1  ON 15
 ud_6                -1.560802e-01 1 1  ON 16
 ud_7                -1.106512e-01 1 1  ON 17
 ud_8                 6.746670e-03 1 1  ON 18
 ud_9                 9.254938e-02 1 1  ON 19
 eO_0                -7.274383e-01 1 1  ON 20
 eO_1                -4.221398e-01 1 1  ON 21
 eO_2                -3.896684e-02 1 1  ON 22
 eO_3                 1.925488e-01 1 1  ON 23
 eO_4                 2.758780e-01 1 1  ON 24
 eO_5                 3.046412e-01 1 1  ON 25
 eO_6                 2.488119e-01 1 1  ON 26
 eO_7                 1.101776e-01 1 1  ON 27
 eO_8                 2.761053e-02 1 1  ON 28
 eO_9                 1.831401e-02 1 1  ON 29
eH1_0                -1.794128e-01 1 1  ON 30
eH1_1                -1.011486e-01 1 1  ON 31
eH1_2                -6.253010e-02 1 1  ON 32
eH1_3                -2.694631e-02 1 1  ON 33
eH1_4                 1.926032e-02 1 1  ON 34
eH1_5                 3.461006e-02 1 1  ON 35
eH1_6                 7.695306e-02 1 1  ON 36
eH1_7                 1.103693e-01 1 1  ON 37
eH1_8                 8.965929e-02 1 1  ON 38
eH1_9                 2.399949e-02 1 1  ON 39
eH2_0                -1.814538e-01 1 1  ON 40
eH2_1                -1.027369e-01 1 1  ON 41
eH2_2                -6.411768e-02 1 1  ON 42
eH2_3                -2.855977e-02 1 1  ON 43
eH2_4                 1.784363e-02 1 1  ON 44
eH2_5                 3.442968e-02 1 1  ON 45
eH2_6                 7.946410e-02 1 1  ON 46
eH2_7                 1.144384e-01 1 1  ON 47
eH2_8                 9.267085e-02 1 1  ON 48
eH2_9                 2.588576e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2801
    reference variance = 0.194702
====================================================
  Execution time = 3.9676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1799e-01
  Total weights = 2.0000e+06
  Execution time = 3.6401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315838471370
                                         uncertainty =       0.003316763763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315838471370
                                         uncertainty =       0.003316763763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397333749
  error estimate for blocks of size 2^( 2) =       0.000407018587
  error estimate for blocks of size 2^( 3) =       0.000415894641
  error estimate for blocks of size 2^( 4) =       0.000423064758
  error estimate for blocks of size 2^( 5) =       0.000427857661
  error estimate for blocks of size 2^( 6) =       0.000430762537
  error estimate for blocks of size 2^( 7) =       0.000431845844

      target function =                  N/A
              le_mean =     -17.216056478117
             les_mean =     296.708348716708
             stat err =       0.000428382700
             autocorr =       1.162392867299
              std dev =       0.561914777239
             le_variance =       0.315748216880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320252530062
                                         uncertainty =       0.003371639835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320252530062
                                         uncertainty =       0.003371639835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400100304
  error estimate for blocks of size 2^( 2) =       0.000409557090
  error estimate for blocks of size 2^( 3) =       0.000418221353
  error estimate for blocks of size 2^( 4) =       0.000425245654
  error estimate for blocks of size 2^( 5) =       0.000429907642
  error estimate for blocks of size 2^( 6) =       0.000432746796
  error estimate for blocks of size 2^( 7) =       0.000433850041

      target function =                  N/A
              le_mean =     -17.216025445835
             les_mean =     296.711692497791
             stat err =       0.000430437533
             autocorr =       1.157397408324
              std dev =       0.565827275984
             le_variance =       0.320160506248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320535517327
                                         uncertainty =       0.003374453971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320535517327
                                         uncertainty =       0.003374453971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400276967
  error estimate for blocks of size 2^( 2) =       0.000409734768
  error estimate for blocks of size 2^( 3) =       0.000418411640
  error estimate for blocks of size 2^( 4) =       0.000425454846
  error estimate for blocks of size 2^( 5) =       0.000430105753
  error estimate for blocks of size 2^( 6) =       0.000432937911
  error estimate for blocks of size 2^( 7) =       0.000434033239

      target function =                  N/A
              le_mean =     -17.216018213143
             les_mean =     296.711726255326
             stat err =       0.000430632937
             autocorr =       1.157426144286
              std dev =       0.566077115142
             le_variance =       0.320443300288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316700354565
                                         uncertainty =       0.003327874714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316700354565
                                         uncertainty =       0.003327874714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397875422
  error estimate for blocks of size 2^( 2) =       0.000407512013
  error estimate for blocks of size 2^( 3) =       0.000416347688
  error estimate for blocks of size 2^( 4) =       0.000423493207
  error estimate for blocks of size 2^( 5) =       0.000428256092
  error estimate for blocks of size 2^( 6) =       0.000431145509
  error estimate for blocks of size 2^( 7) =       0.000432228805

      target function =                  N/A
              le_mean =     -17.216037897290
             les_mean =     296.708570426111
             stat err =       0.000428780903
             autocorr =       1.161386155245
              std dev =       0.562680818491
             le_variance =       0.316609703498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216056478117        initial  <--
     3.9062e-02     3.9062e-01             2.2693e-02       -17.216025445835
     1.5625e-01     1.5625e+00             9.1263e-03       -17.216018213143
     6.2500e-01     6.2500e+00             2.9368e-03       -17.216037897290

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.0258
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.996740e-01 1 1  ON 0
 uu_1                 4.139530e-02 1 1  ON 1
 uu_2                -4.829745e-02 1 1  ON 2
 uu_3                -9.834072e-02 1 1  ON 3
 uu_4                -1.277355e-01 1 1  ON 4
 uu_5                -1.331239e-01 1 1  ON 5
 uu_6                -1.108813e-01 1 1  ON 6
 uu_7                -3.537760e-02 1 1  ON 7
 uu_8                 1.020963e-01 1 1  ON 8
 uu_9                 1.194914e-01 1 1  ON 9
 ud_0                 3.370020e-01 1 1  ON 10
 ud_1                 8.494681e-02 1 1  ON 11
 ud_2                -1.536027e-02 1 1  ON 12
 ud_3                -6.901011e-02 1 1  ON 13
 ud_4                -1.139547e-01 1 1  ON 14
 ud_5                -1.482827e-01 1 1  ON 15
 ud_6                -1.564208e-01 1 1  ON 16
 ud_7                -1.100797e-01 1 1  ON 17
 ud_8                 7.593030e-03 1 1  ON 18
 ud_9                 9.243983e-02 1 1  ON 19
 eO_0                -7.183120e-01 1 1  ON 20
 eO_1                -4.174851e-01 1 1  ON 21
 eO_2                -4.004209e-02 1 1  ON 22
 eO_3                 1.864376e-01 1 1  ON 23
 eO_4                 2.709132e-01 1 1  ON 24
 eO_5                 3.043443e-01 1 1  ON 25
 eO_6                 2.484366e-01 1 1  ON 26
 eO_7                 1.094805e-01 1 1  ON 27
 eO_8                 2.749353e-02 1 1  ON 28
 eO_9                 1.823732e-02 1 1  ON 29
eH1_0                -1.785512e-01 1 1  ON 30
eH1_1                -1.001398e-01 1 1  ON 31
eH1_2                -6.233266e-02 1 1  ON 32
eH1_3                -2.715874e-02 1 1  ON 33
eH1_4                 1.909402e-02 1 1  ON 34
eH1_5                 3.365188e-02 1 1  ON 35
eH1_6                 7.655657e-02 1 1  ON 36
eH1_7                 1.106099e-01 1 1  ON 37
eH1_8                 8.925630e-02 1 1  ON 38
eH1_9                 2.388103e-02 1 1  ON 39
eH2_0                -1.802500e-01 1 1  ON 40
eH2_1                -1.019313e-01 1 1  ON 41
eH2_2                -6.427560e-02 1 1  ON 42
eH2_3                -2.889484e-02 1 1  ON 43
eH2_4                 1.749104e-02 1 1  ON 44
eH2_5                 3.360141e-02 1 1  ON 45
eH2_6                 7.939409e-02 1 1  ON 46
eH2_7                 1.147020e-01 1 1  ON 47
eH2_8                 9.232783e-02 1 1  ON 48
eH2_9                 2.579823e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0996e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.259076
====================================================
  Execution time = 4.0497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1399e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0782e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313861208622
                                         uncertainty =       0.005881264241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313861208622
                                         uncertainty =       0.005881264241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396225990
  error estimate for blocks of size 2^( 2) =       0.000406386279
  error estimate for blocks of size 2^( 3) =       0.000415268819
  error estimate for blocks of size 2^( 4) =       0.000422230585
  error estimate for blocks of size 2^( 5) =       0.000425164601
  error estimate for blocks of size 2^( 6) =       0.000427234674
  error estimate for blocks of size 2^( 7) =       0.000430384380

      target function =                  N/A
              le_mean =     -17.216319179447
             les_mean =     296.715636002071
             stat err =       0.000426253560
             autocorr =       1.157311102262
              std dev =       0.560348168975
             le_variance =       0.313990070474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631917945e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216319179447       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319896964       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216323804668       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216339532852       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216342098367       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216341129536       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216342507689       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216342574813       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216342821140       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216342811648       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216342842254       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.371821e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216319179447       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319411042       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216320819601       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216325440785       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216326158827       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216325824721       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216326080403       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216325984511       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216326027752       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216326030280       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.241176e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216319179447       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319241890       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216319637913       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216320831718       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216321016373       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216320940333       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216320985466       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216320960644       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216320971694       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.225732e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1290e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.999621e-01 1 1  ON 0
 uu_1                 4.161979e-02 1 1  ON 1
 uu_2                -4.830090e-02 1 1  ON 2
 uu_3                -9.844107e-02 1 1  ON 3
 uu_4                -1.279932e-01 1 1  ON 4
 uu_5                -1.331595e-01 1 1  ON 5
 uu_6                -1.109260e-01 1 1  ON 6
 uu_7                -3.548776e-02 1 1  ON 7
 uu_8                 1.020531e-01 1 1  ON 8
 uu_9                 1.195322e-01 1 1  ON 9
 ud_0                 3.374886e-01 1 1  ON 10
 ud_1                 8.515716e-02 1 1  ON 11
 ud_2                -1.545295e-02 1 1  ON 12
 ud_3                -6.928442e-02 1 1  ON 13
 ud_4                -1.142412e-01 1 1  ON 14
 ud_5                -1.483353e-01 1 1  ON 15
 ud_6                -1.563273e-01 1 1  ON 16
 ud_7                -1.101315e-01 1 1  ON 17
 ud_8                 7.511815e-03 1 1  ON 18
 ud_9                 9.244596e-02 1 1  ON 19
 eO_0                -7.195532e-01 1 1  ON 20
 eO_1                -4.180744e-01 1 1  ON 21
 eO_2                -3.972660e-02 1 1  ON 22
 eO_3                 1.874100e-01 1 1  ON 23
 eO_4                 2.713725e-01 1 1  ON 24
 eO_5                 3.042976e-01 1 1  ON 25
 eO_6                 2.484700e-01 1 1  ON 26
 eO_7                 1.095565e-01 1 1  ON 27
 eO_8                 2.750527e-02 1 1  ON 28
 eO_9                 1.824187e-02 1 1  ON 29
eH1_0                -1.786682e-01 1 1  ON 30
eH1_1                -1.003095e-01 1 1  ON 31
eH1_2                -6.231379e-02 1 1  ON 32
eH1_3                -2.706240e-02 1 1  ON 33
eH1_4                 1.914452e-02 1 1  ON 34
eH1_5                 3.378062e-02 1 1  ON 35
eH1_6                 7.649160e-02 1 1  ON 36
eH1_7                 1.105913e-01 1 1  ON 37
eH1_8                 8.930978e-02 1 1  ON 38
eH1_9                 2.389642e-02 1 1  ON 39
eH2_0                -1.802900e-01 1 1  ON 40
eH2_1                -1.020462e-01 1 1  ON 41
eH2_2                -6.423748e-02 1 1  ON 42
eH2_3                -2.881694e-02 1 1  ON 43
eH2_4                 1.753008e-02 1 1  ON 44
eH2_5                 3.361581e-02 1 1  ON 45
eH2_6                 7.933955e-02 1 1  ON 46
eH2_7                 1.146797e-01 1 1  ON 47
eH2_8                 9.237599e-02 1 1  ON 48
eH2_9                 2.581057e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.3565
    reference variance = 0.558662
====================================================
  Execution time = 4.0190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 4.1010e-01
  Total weights = 2.0000e+06
  Execution time = 3.6480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409932930259
                                         uncertainty =       0.094451513482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409932930259
                                         uncertainty =       0.094451513482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000452672461
  error estimate for blocks of size 2^( 2) =       0.000461329570
  error estimate for blocks of size 2^( 3) =       0.000469532805
  error estimate for blocks of size 2^( 4) =       0.000475913087
  error estimate for blocks of size 2^( 5) =       0.000480438922
  error estimate for blocks of size 2^( 6) =       0.000483224884
  error estimate for blocks of size 2^( 7) =       0.000482929744

      target function =                  N/A
              le_mean =     -17.215913000457
             les_mean =     296.797484947523
             stat err =       0.000480626659
             autocorr =       1.127320915915
              std dev =       0.640175533051
             le_variance =       0.409824713117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.410870219414
                                         uncertainty =       0.094073739656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.410870219414
                                         uncertainty =       0.094073739656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000453190305
  error estimate for blocks of size 2^( 2) =       0.000461784883
  error estimate for blocks of size 2^( 3) =       0.000469938508
  error estimate for blocks of size 2^( 4) =       0.000476279612
  error estimate for blocks of size 2^( 5) =       0.000480808499
  error estimate for blocks of size 2^( 6) =       0.000483605120
  error estimate for blocks of size 2^( 7) =       0.000483326059

      target function =                  N/A
              le_mean =     -17.215917113882
             les_mean =     296.798564771091
             stat err =       0.000481004822
             autocorr =       1.126516716612
              std dev =       0.640907875132
             le_variance =       0.410762904406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.410493681262
                                         uncertainty =       0.094147914396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.410493681262
                                         uncertainty =       0.094147914396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000452982406
  error estimate for blocks of size 2^( 2) =       0.000461599398
  error estimate for blocks of size 2^( 3) =       0.000469771390
  error estimate for blocks of size 2^( 4) =       0.000476127077
  error estimate for blocks of size 2^( 5) =       0.000480654522
  error estimate for blocks of size 2^( 6) =       0.000483445140
  error estimate for blocks of size 2^( 7) =       0.000483160172

      target function =                  N/A
              le_mean =     -17.215913760454
             les_mean =     296.798072522218
             stat err =       0.000480846728
             autocorr =       1.126809920233
              std dev =       0.640613861875
             le_variance =       0.410386120026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.410005634170
                                         uncertainty =       0.094406094645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.410005634170
                                         uncertainty =       0.094406094645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000452712664
  error estimate for blocks of size 2^( 2) =       0.000461364213
  error estimate for blocks of size 2^( 3) =       0.000469563138
  error estimate for blocks of size 2^( 4) =       0.000475940055
  error estimate for blocks of size 2^( 5) =       0.000480466051
  error estimate for blocks of size 2^( 6) =       0.000483252492
  error estimate for blocks of size 2^( 7) =       0.000482958680

      target function =                  N/A
              le_mean =     -17.215912821092
             les_mean =     296.797551570826
             stat err =       0.000480654319
             autocorr =       1.127250435655
              std dev =       0.640232389312
             le_variance =       0.409897512324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215913000457        initial
     3.9062e-01     3.9062e+00             4.3718e-03       -17.215917113882  <--
     1.5625e+00     1.5625e+01             1.2412e-03       -17.215913760454
     6.2500e+00     6.2500e+01             3.2257e-04       -17.215912821092

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 5.8584e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.007826e-01 1 1  ON 0
 uu_1                 4.214939e-02 1 1  ON 1
 uu_2                -4.821819e-02 1 1  ON 2
 uu_3                -9.871499e-02 1 1  ON 3
 uu_4                -1.286011e-01 1 1  ON 4
 uu_5                -1.333938e-01 1 1  ON 5
 uu_6                -1.110560e-01 1 1  ON 6
 uu_7                -3.579434e-02 1 1  ON 7
 uu_8                 1.019290e-01 1 1  ON 8
 uu_9                 1.196527e-01 1 1  ON 9
 ud_0                 3.385222e-01 1 1  ON 10
 ud_1                 8.566065e-02 1 1  ON 11
 ud_2                -1.553686e-02 1 1  ON 12
 ud_3                -6.987083e-02 1 1  ON 13
 ud_4                -1.149290e-01 1 1  ON 14
 ud_5                -1.485669e-01 1 1  ON 15
 ud_6                -1.560677e-01 1 1  ON 16
 ud_7                -1.102529e-01 1 1  ON 17
 ud_8                 7.281679e-03 1 1  ON 18
 ud_9                 9.246505e-02 1 1  ON 19
 eO_0                -7.226838e-01 1 1  ON 20
 eO_1                -4.196800e-01 1 1  ON 21
 eO_2                -3.919744e-02 1 1  ON 22
 eO_3                 1.898420e-01 1 1  ON 23
 eO_4                 2.728297e-01 1 1  ON 24
 eO_5                 3.042239e-01 1 1  ON 25
 eO_6                 2.485753e-01 1 1  ON 26
 eO_7                 1.097822e-01 1 1  ON 27
 eO_8                 2.754030e-02 1 1  ON 28
 eO_9                 1.825532e-02 1 1  ON 29
eH1_0                -1.789939e-01 1 1  ON 30
eH1_1                -1.007166e-01 1 1  ON 31
eH1_2                -6.225963e-02 1 1  ON 32
eH1_3                -2.685439e-02 1 1  ON 33
eH1_4                 1.924241e-02 1 1  ON 34
eH1_5                 3.412872e-02 1 1  ON 35
eH1_6                 7.633917e-02 1 1  ON 36
eH1_7                 1.105440e-01 1 1  ON 37
eH1_8                 8.946807e-02 1 1  ON 38
eH1_9                 2.394208e-02 1 1  ON 39
eH2_0                -1.804037e-01 1 1  ON 40
eH2_1                -1.023214e-01 1 1  ON 41
eH2_2                -6.412649e-02 1 1  ON 42
eH2_3                -2.864417e-02 1 1  ON 43
eH2_4                 1.759418e-02 1 1  ON 44
eH2_5                 3.365767e-02 1 1  ON 45
eH2_6                 7.921338e-02 1 1  ON 46
eH2_7                 1.146203e-01 1 1  ON 47
eH2_8                 9.251889e-02 1 1  ON 48
eH2_9                 2.584722e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0988e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2256
    reference variance = 0.278053
====================================================
  Execution time = 4.1075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1845e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1114e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318432797489
                                         uncertainty =       0.003015727920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318432797489
                                         uncertainty =       0.003015727920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399028964
  error estimate for blocks of size 2^( 2) =       0.000408565480
  error estimate for blocks of size 2^( 3) =       0.000417393277
  error estimate for blocks of size 2^( 4) =       0.000423876944
  error estimate for blocks of size 2^( 5) =       0.000427276100
  error estimate for blocks of size 2^( 6) =       0.000429877400
  error estimate for blocks of size 2^( 7) =       0.000431209799

      target function =                  N/A
              le_mean =     -17.215455580528
             les_mean =     296.690358914130
             stat err =       0.000428060061
             autocorr =       1.150801915786
              std dev =       0.564312172672
             le_variance =       0.318448228226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721545558053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215455580528       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215463292803       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215481542177       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215497194925       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215505879755       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215513061110       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215516210063       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215520635212       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215517608353       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215519659351       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215518868246       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215519287812       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215519108576       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215519115583       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.119847e-02

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215455580528       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215459248979       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215467343421       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215473168395       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215477016639       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215477678809       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215477988728       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215478684749       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215478391953       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215478137477       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215478328534       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.707080e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215455580528       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215456764913       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215459313945       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215460861894       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215462138404       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215462072042       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215462017359       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215462114536       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215462104554       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.036776e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.359555 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2201e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.018678e-01 1 1  ON 0
 uu_1                 4.266522e-02 1 1  ON 1
 uu_2                -4.808511e-02 1 1  ON 2
 uu_3                -9.906608e-02 1 1  ON 3
 uu_4                -1.291977e-01 1 1  ON 4
 uu_5                -1.338888e-01 1 1  ON 5
 uu_6                -1.111996e-01 1 1  ON 6
 uu_7                -3.615122e-02 1 1  ON 7
 uu_8                 1.017796e-01 1 1  ON 8
 uu_9                 1.198237e-01 1 1  ON 9
 ud_0                 3.397026e-01 1 1  ON 10
 ud_1                 8.624891e-02 1 1  ON 11
 ud_2                -1.556280e-02 1 1  ON 12
 ud_3                -7.050970e-02 1 1  ON 13
 ud_4                -1.158745e-01 1 1  ON 14
 ud_5                -1.488518e-01 1 1  ON 15
 ud_6                -1.557185e-01 1 1  ON 16
 ud_7                -1.103701e-01 1 1  ON 17
 ud_8                 6.998410e-03 1 1  ON 18
 ud_9                 9.249019e-02 1 1  ON 19
 eO_0                -7.263909e-01 1 1  ON 20
 eO_1                -4.217354e-01 1 1  ON 21
 eO_2                -3.886138e-02 1 1  ON 22
 eO_3                 1.925205e-01 1 1  ON 23
 eO_4                 2.748905e-01 1 1  ON 24
 eO_5                 3.043279e-01 1 1  ON 25
 eO_6                 2.487360e-01 1 1  ON 26
 eO_7                 1.101052e-01 1 1  ON 27
 eO_8                 2.760311e-02 1 1  ON 28
 eO_9                 1.827532e-02 1 1  ON 29
eH1_0                -1.793285e-01 1 1  ON 30
eH1_1                -1.009066e-01 1 1  ON 31
eH1_2                -6.245548e-02 1 1  ON 32
eH1_3                -2.673802e-02 1 1  ON 33
eH1_4                 1.951069e-02 1 1  ON 34
eH1_5                 3.429679e-02 1 1  ON 35
eH1_6                 7.631811e-02 1 1  ON 36
eH1_7                 1.104557e-01 1 1  ON 37
eH1_8                 8.964657e-02 1 1  ON 38
eH1_9                 2.401448e-02 1 1  ON 39
eH2_0                -1.808717e-01 1 1  ON 40
eH2_1                -1.027154e-01 1 1  ON 41
eH2_2                -6.399610e-02 1 1  ON 42
eH2_3                -2.843563e-02 1 1  ON 43
eH2_4                 1.780451e-02 1 1  ON 44
eH2_5                 3.390040e-02 1 1  ON 45
eH2_6                 7.911269e-02 1 1  ON 46
eH2_7                 1.145153e-01 1 1  ON 47
eH2_8                 9.269982e-02 1 1  ON 48
eH2_9                 2.591159e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1779
    reference variance = 0.260443
====================================================
  Execution time = 4.0798e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3204e-01
  Total weights = 2.0000e+06
  Execution time = 3.6445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331024870509
                                         uncertainty =       0.008901909307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331024870509
                                         uncertainty =       0.008901909307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406785978
  error estimate for blocks of size 2^( 2) =       0.000416594868
  error estimate for blocks of size 2^( 3) =       0.000424940838
  error estimate for blocks of size 2^( 4) =       0.000431579601
  error estimate for blocks of size 2^( 5) =       0.000435197476
  error estimate for blocks of size 2^( 6) =       0.000437567612
  error estimate for blocks of size 2^( 7) =       0.000438206778

      target function =                  N/A
              le_mean =     -17.215892462776
             les_mean =     296.717902788994
             stat err =       0.000435637867
             autocorr =       1.146883477222
              std dev =       0.575282247762
             le_variance =       0.330949664590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333664556897
                                         uncertainty =       0.008994027945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333664556897
                                         uncertainty =       0.008994027945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408404412
  error estimate for blocks of size 2^( 2) =       0.000418097917
  error estimate for blocks of size 2^( 3) =       0.000426331478
  error estimate for blocks of size 2^( 4) =       0.000432892018
  error estimate for blocks of size 2^( 5) =       0.000436468754
  error estimate for blocks of size 2^( 6) =       0.000438845798
  error estimate for blocks of size 2^( 7) =       0.000439447225

      target function =                  N/A
              le_mean =     -17.215892307212
             les_mean =     296.720536093841
             stat err =       0.000436913449
             autocorr =       1.144484660321
              std dev =       0.577571058067
             le_variance =       0.333588327117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333254330573
                                         uncertainty =       0.008978240023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333254330573
                                         uncertainty =       0.008978240023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408153306
  error estimate for blocks of size 2^( 2) =       0.000417869489
  error estimate for blocks of size 2^( 3) =       0.000426129415
  error estimate for blocks of size 2^( 4) =       0.000432710096
  error estimate for blocks of size 2^( 5) =       0.000436299441
  error estimate for blocks of size 2^( 6) =       0.000438670522
  error estimate for blocks of size 2^( 7) =       0.000439276400

      target function =                  N/A
              le_mean =     -17.215885548250
             les_mean =     296.719893286332
             stat err =       0.000436739115
             autocorr =       1.144979054617
              std dev =       0.577215940941
             le_variance =       0.333178242477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331373583213
                                         uncertainty =       0.008913904207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331373583213
                                         uncertainty =       0.008913904207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407000145
  error estimate for blocks of size 2^( 2) =       0.000416793792
  error estimate for blocks of size 2^( 3) =       0.000425125992
  error estimate for blocks of size 2^( 4) =       0.000431755792
  error estimate for blocks of size 2^( 5) =       0.000435369364
  error estimate for blocks of size 2^( 6) =       0.000437738968
  error estimate for blocks of size 2^( 7) =       0.000438372621

      target function =                  N/A
              le_mean =     -17.215889469485
             les_mean =     296.718148295837
             stat err =       0.000435809186
             autocorr =       1.146578074197
              std dev =       0.575585124851
             le_variance =       0.331298235950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215892462776        initial  <--
     9.7656e-02     9.7656e-01             1.1198e-02       -17.215892307212
     3.9062e-01     3.9062e+00             3.7071e-03       -17.215885548250
     1.5625e+00     1.5625e+01             1.0368e-03       -17.215889469485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.1807
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.007826e-01 1 1  ON 0
 uu_1                 4.214939e-02 1 1  ON 1
 uu_2                -4.821819e-02 1 1  ON 2
 uu_3                -9.871499e-02 1 1  ON 3
 uu_4                -1.286011e-01 1 1  ON 4
 uu_5                -1.333938e-01 1 1  ON 5
 uu_6                -1.110560e-01 1 1  ON 6
 uu_7                -3.579434e-02 1 1  ON 7
 uu_8                 1.019290e-01 1 1  ON 8
 uu_9                 1.196527e-01 1 1  ON 9
 ud_0                 3.385222e-01 1 1  ON 10
 ud_1                 8.566065e-02 1 1  ON 11
 ud_2                -1.553686e-02 1 1  ON 12
 ud_3                -6.987083e-02 1 1  ON 13
 ud_4                -1.149290e-01 1 1  ON 14
 ud_5                -1.485669e-01 1 1  ON 15
 ud_6                -1.560677e-01 1 1  ON 16
 ud_7                -1.102529e-01 1 1  ON 17
 ud_8                 7.281679e-03 1 1  ON 18
 ud_9                 9.246505e-02 1 1  ON 19
 eO_0                -7.226838e-01 1 1  ON 20
 eO_1                -4.196800e-01 1 1  ON 21
 eO_2                -3.919744e-02 1 1  ON 22
 eO_3                 1.898420e-01 1 1  ON 23
 eO_4                 2.728297e-01 1 1  ON 24
 eO_5                 3.042239e-01 1 1  ON 25
 eO_6                 2.485753e-01 1 1  ON 26
 eO_7                 1.097822e-01 1 1  ON 27
 eO_8                 2.754030e-02 1 1  ON 28
 eO_9                 1.825532e-02 1 1  ON 29
eH1_0                -1.789939e-01 1 1  ON 30
eH1_1                -1.007166e-01 1 1  ON 31
eH1_2                -6.225963e-02 1 1  ON 32
eH1_3                -2.685439e-02 1 1  ON 33
eH1_4                 1.924241e-02 1 1  ON 34
eH1_5                 3.412872e-02 1 1  ON 35
eH1_6                 7.633917e-02 1 1  ON 36
eH1_7                 1.105440e-01 1 1  ON 37
eH1_8                 8.946807e-02 1 1  ON 38
eH1_9                 2.394208e-02 1 1  ON 39
eH2_0                -1.804037e-01 1 1  ON 40
eH2_1                -1.023214e-01 1 1  ON 41
eH2_2                -6.412649e-02 1 1  ON 42
eH2_3                -2.864417e-02 1 1  ON 43
eH2_4                 1.759418e-02 1 1  ON 44
eH2_5                 3.365767e-02 1 1  ON 45
eH2_6                 7.921338e-02 1 1  ON 46
eH2_7                 1.146203e-01 1 1  ON 47
eH2_8                 9.251889e-02 1 1  ON 48
eH2_9                 2.584722e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1139e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2157
    reference variance = 0.201289
====================================================
  Execution time = 4.2271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0734e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319778850170
                                         uncertainty =       0.004577797629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319778850170
                                         uncertainty =       0.004577797629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399820635
  error estimate for blocks of size 2^( 2) =       0.000409486169
  error estimate for blocks of size 2^( 3) =       0.000418202921
  error estimate for blocks of size 2^( 4) =       0.000424585109
  error estimate for blocks of size 2^( 5) =       0.000429446241
  error estimate for blocks of size 2^( 6) =       0.000432261896
  error estimate for blocks of size 2^( 7) =       0.000434097079

      target function =                  N/A
              le_mean =     -17.216777091148
             les_mean =     296.737126326345
             stat err =       0.000430097581
             autocorr =       1.157187122110
              std dev =       0.565431764161
             le_variance =       0.319713079922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677709115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216777091148       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216779357005       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216781733221       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216784555750       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216784640408       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216785247490       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216785426587       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216785538695       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216785498517       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216785533326       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.652731e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216777091148       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216777760568       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216778388076       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216779093577       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216779097893       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216779242541       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216779278591       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216779310787       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216779299241       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.359708e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216777091148       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216777266469       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216777425357       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216777601017       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216777600208       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216777635535       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216777645479       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216777652943       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216777650072       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.105536e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3014e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.009296e-01 1 1  ON 0
 uu_1                 4.219408e-02 1 1  ON 1
 uu_2                -4.823347e-02 1 1  ON 2
 uu_3                -9.878357e-02 1 1  ON 3
 uu_4                -1.286527e-01 1 1  ON 4
 uu_5                -1.334309e-01 1 1  ON 5
 uu_6                -1.110815e-01 1 1  ON 6
 uu_7                -3.581291e-02 1 1  ON 7
 uu_8                 1.019221e-01 1 1  ON 8
 uu_9                 1.196688e-01 1 1  ON 9
 ud_0                 3.386597e-01 1 1  ON 10
 ud_1                 8.573941e-02 1 1  ON 11
 ud_2                -1.553626e-02 1 1  ON 12
 ud_3                -6.996710e-02 1 1  ON 13
 ud_4                -1.150267e-01 1 1  ON 14
 ud_5                -1.485856e-01 1 1  ON 15
 ud_6                -1.560261e-01 1 1  ON 16
 ud_7                -1.102697e-01 1 1  ON 17
 ud_8                 7.243333e-03 1 1  ON 18
 ud_9                 9.246383e-02 1 1  ON 19
 eO_0                -7.231198e-01 1 1  ON 20
 eO_1                -4.198866e-01 1 1  ON 21
 eO_2                -3.912802e-02 1 1  ON 22
 eO_3                 1.901755e-01 1 1  ON 23
 eO_4                 2.730172e-01 1 1  ON 24
 eO_5                 3.042224e-01 1 1  ON 25
 eO_6                 2.485859e-01 1 1  ON 26
 eO_7                 1.098166e-01 1 1  ON 27
 eO_8                 2.754704e-02 1 1  ON 28
 eO_9                 1.825660e-02 1 1  ON 29
eH1_0                -1.790318e-01 1 1  ON 30
eH1_1                -1.007509e-01 1 1  ON 31
eH1_2                -6.227141e-02 1 1  ON 32
eH1_3                -2.683637e-02 1 1  ON 33
eH1_4                 1.925089e-02 1 1  ON 34
eH1_5                 3.416204e-02 1 1  ON 35
eH1_6                 7.634522e-02 1 1  ON 36
eH1_7                 1.105365e-01 1 1  ON 37
eH1_8                 8.948552e-02 1 1  ON 38
eH1_9                 2.394862e-02 1 1  ON 39
eH2_0                -1.804650e-01 1 1  ON 40
eH2_1                -1.023564e-01 1 1  ON 41
eH2_2                -6.412981e-02 1 1  ON 42
eH2_3                -2.860293e-02 1 1  ON 43
eH2_4                 1.763079e-02 1 1  ON 44
eH2_5                 3.368167e-02 1 1  ON 45
eH2_6                 7.920487e-02 1 1  ON 46
eH2_7                 1.146017e-01 1 1  ON 47
eH2_8                 9.253622e-02 1 1  ON 48
eH2_9                 2.585383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1823
    reference variance = 0.166942
====================================================
  Execution time = 3.9614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2198e-01
  Total weights = 2.0000e+06
  Execution time = 3.6535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321869526199
                                         uncertainty =       0.006670911888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321869526199
                                         uncertainty =       0.006670911888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401158214
  error estimate for blocks of size 2^( 2) =       0.000410859587
  error estimate for blocks of size 2^( 3) =       0.000419070945
  error estimate for blocks of size 2^( 4) =       0.000425937475
  error estimate for blocks of size 2^( 5) =       0.000430681133
  error estimate for blocks of size 2^( 6) =       0.000433399544
  error estimate for blocks of size 2^( 7) =       0.000435089052

      target function =                  N/A
              le_mean =     -17.216636911424
             les_mean =     296.734442203613
             stat err =       0.000431276801
             autocorr =       1.155795016475
              std dev =       0.567323386394
             le_variance =       0.321855824749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322321985537
                                         uncertainty =       0.006680026601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322321985537
                                         uncertainty =       0.006680026601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401440120
  error estimate for blocks of size 2^( 2) =       0.000411118165
  error estimate for blocks of size 2^( 3) =       0.000419307316
  error estimate for blocks of size 2^( 4) =       0.000426157346
  error estimate for blocks of size 2^( 5) =       0.000430889988
  error estimate for blocks of size 2^( 6) =       0.000433606176
  error estimate for blocks of size 2^( 7) =       0.000435300855

      target function =                  N/A
              le_mean =     -17.216638203321
             les_mean =     296.734939202918
             stat err =       0.000431488591
             autocorr =       1.155306153897
              std dev =       0.567722062303
             le_variance =       0.322308340025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322122542007
                                         uncertainty =       0.006676090670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322122542007
                                         uncertainty =       0.006676090670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401315883
  error estimate for blocks of size 2^( 2) =       0.000411004328
  error estimate for blocks of size 2^( 3) =       0.000419203527
  error estimate for blocks of size 2^( 4) =       0.000426061122
  error estimate for blocks of size 2^( 5) =       0.000430798923
  error estimate for blocks of size 2^( 6) =       0.000433516251
  error estimate for blocks of size 2^( 7) =       0.000435208359

      target function =                  N/A
              le_mean =     -17.216637476297
             les_mean =     296.734714704970
             stat err =       0.000431396164
             autocorr =       1.155526370613
              std dev =       0.567546364439
             le_variance =       0.322108875788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321901895752
                                         uncertainty =       0.006671582382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321901895752
                                         uncertainty =       0.006671582382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401178389
  error estimate for blocks of size 2^( 2) =       0.000410878095
  error estimate for blocks of size 2^( 3) =       0.000419087889
  error estimate for blocks of size 2^( 4) =       0.000425953277
  error estimate for blocks of size 2^( 5) =       0.000430696189
  error estimate for blocks of size 2^( 6) =       0.000433414463
  error estimate for blocks of size 2^( 7) =       0.000435104300

      target function =                  N/A
              le_mean =     -17.216636959210
             les_mean =     296.734476223359
             stat err =       0.000431292057
             autocorr =       1.155760536382
              std dev =       0.567351918190
             le_variance =       0.321888199073


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216636911424        initial
     9.7656e-01     9.7656e+00             1.6527e-03       -17.216638203321  <--
     3.9062e+00     3.9062e+01             4.3597e-04       -17.216637476297
     1.5625e+01     1.5625e+02             1.1055e-04       -17.216636959210

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 5.8018e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.013310e-01 1 1  ON 0
 uu_1                 4.231755e-02 1 1  ON 1
 uu_2                -4.825146e-02 1 1  ON 2
 uu_3                -9.896522e-02 1 1  ON 3
 uu_4                -1.288147e-01 1 1  ON 4
 uu_5                -1.335427e-01 1 1  ON 5
 uu_6                -1.111549e-01 1 1  ON 6
 uu_7                -3.586725e-02 1 1  ON 7
 uu_8                 1.019014e-01 1 1  ON 8
 uu_9                 1.197174e-01 1 1  ON 9
 ud_0                 3.390225e-01 1 1  ON 10
 ud_1                 8.595384e-02 1 1  ON 11
 ud_2                -1.552657e-02 1 1  ON 12
 ud_3                -7.020354e-02 1 1  ON 13
 ud_4                -1.153018e-01 1 1  ON 14
 ud_5                -1.486550e-01 1 1  ON 15
 ud_6                -1.559021e-01 1 1  ON 16
 ud_7                -1.103141e-01 1 1  ON 17
 ud_8                 7.129300e-03 1 1  ON 18
 ud_9                 9.246032e-02 1 1  ON 19
 eO_0                -7.243365e-01 1 1  ON 20
 eO_1                -4.204946e-01 1 1  ON 21
 eO_2                -3.897877e-02 1 1  ON 22
 eO_3                 1.910885e-01 1 1  ON 23
 eO_4                 2.736019e-01 1 1  ON 24
 eO_5                 3.042350e-01 1 1  ON 25
 eO_6                 2.486206e-01 1 1  ON 26
 eO_7                 1.099209e-01 1 1  ON 27
 eO_8                 2.756751e-02 1 1  ON 28
 eO_9                 1.826046e-02 1 1  ON 29
eH1_0                -1.791403e-01 1 1  ON 30
eH1_1                -1.008543e-01 1 1  ON 31
eH1_2                -6.229834e-02 1 1  ON 32
eH1_3                -2.679534e-02 1 1  ON 33
eH1_4                 1.926946e-02 1 1  ON 34
eH1_5                 3.425813e-02 1 1  ON 35
eH1_6                 7.637091e-02 1 1  ON 36
eH1_7                 1.105160e-01 1 1  ON 37
eH1_8                 8.953858e-02 1 1  ON 38
eH1_9                 2.396848e-02 1 1  ON 39
eH2_0                -1.806357e-01 1 1  ON 40
eH2_1                -1.024559e-01 1 1  ON 41
eH2_2                -6.413109e-02 1 1  ON 42
eH2_3                -2.850479e-02 1 1  ON 43
eH2_4                 1.772751e-02 1 1  ON 44
eH2_5                 3.375485e-02 1 1  ON 45
eH2_6                 7.918725e-02 1 1  ON 46
eH2_7                 1.145471e-01 1 1  ON 47
eH2_8                 9.258882e-02 1 1  ON 48
eH2_9                 2.587387e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1104e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2154
    reference variance = 0.270952
====================================================
  Execution time = 4.0675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1697e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0805e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316940679722
                                         uncertainty =       0.003029206873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316940679722
                                         uncertainty =       0.003029206873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398100804
  error estimate for blocks of size 2^( 2) =       0.000408264440
  error estimate for blocks of size 2^( 3) =       0.000417600286
  error estimate for blocks of size 2^( 4) =       0.000424268147
  error estimate for blocks of size 2^( 5) =       0.000428837774
  error estimate for blocks of size 2^( 6) =       0.000430601688
  error estimate for blocks of size 2^( 7) =       0.000432695784

      target function =                  N/A
              le_mean =     -17.216897494071
             les_mean =     296.738527663172
             stat err =       0.000429100848
             autocorr =       1.161803382246
              std dev =       0.562999556238
             le_variance =       0.316968500324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689749407e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216897494071       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216907669173       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216915316512       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216919596229       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216922352042       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216928045150       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216927091477       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216927779471       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216927678810       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216927855954       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 5.426175e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216897494071       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216901276791       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216903628840       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216904621697       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216905359659       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216906618530       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216906283270       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216906277693       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216906252886       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.591612e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216897494071       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216898570863       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216899190845       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216899421281       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216899603106       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216899882544       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216899796427       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216899783807       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.196406e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1490e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.017587e-01 1 1  ON 0
 uu_1                 4.257212e-02 1 1  ON 1
 uu_2                -4.822248e-02 1 1  ON 2
 uu_3                -9.910514e-02 1 1  ON 3
 uu_4                -1.290982e-01 1 1  ON 4
 uu_5                -1.337846e-01 1 1  ON 5
 uu_6                -1.111617e-01 1 1  ON 6
 uu_7                -3.599802e-02 1 1  ON 7
 uu_8                 1.018448e-01 1 1  ON 8
 uu_9                 1.197828e-01 1 1  ON 9
 ud_0                 3.394241e-01 1 1  ON 10
 ud_1                 8.617202e-02 1 1  ON 11
 ud_2                -1.559252e-02 1 1  ON 12
 ud_3                -7.049052e-02 1 1  ON 13
 ud_4                -1.156904e-01 1 1  ON 14
 ud_5                -1.487249e-01 1 1  ON 15
 ud_6                -1.556354e-01 1 1  ON 16
 ud_7                -1.103446e-01 1 1  ON 17
 ud_8                 7.016485e-03 1 1  ON 18
 ud_9                 9.246898e-02 1 1  ON 19
 eO_0                -7.259282e-01 1 1  ON 20
 eO_1                -4.213374e-01 1 1  ON 21
 eO_2                -3.878287e-02 1 1  ON 22
 eO_3                 1.922657e-01 1 1  ON 23
 eO_4                 2.743601e-01 1 1  ON 24
 eO_5                 3.042717e-01 1 1  ON 25
 eO_6                 2.487250e-01 1 1  ON 26
 eO_7                 1.100466e-01 1 1  ON 27
 eO_8                 2.758570e-02 1 1  ON 28
 eO_9                 1.826941e-02 1 1  ON 29
eH1_0                -1.792650e-01 1 1  ON 30
eH1_1                -1.009867e-01 1 1  ON 31
eH1_2                -6.228313e-02 1 1  ON 32
eH1_3                -2.672335e-02 1 1  ON 33
eH1_4                 1.928819e-02 1 1  ON 34
eH1_5                 3.431820e-02 1 1  ON 35
eH1_6                 7.636827e-02 1 1  ON 36
eH1_7                 1.105194e-01 1 1  ON 37
eH1_8                 8.960201e-02 1 1  ON 38
eH1_9                 2.398611e-02 1 1  ON 39
eH2_0                -1.808700e-01 1 1  ON 40
eH2_1                -1.025623e-01 1 1  ON 41
eH2_2                -6.406053e-02 1 1  ON 42
eH2_3                -2.845472e-02 1 1  ON 43
eH2_4                 1.789453e-02 1 1  ON 44
eH2_5                 3.382420e-02 1 1  ON 45
eH2_6                 7.910381e-02 1 1  ON 46
eH2_7                 1.145029e-01 1 1  ON 47
eH2_8                 9.266903e-02 1 1  ON 48
eH2_9                 2.590085e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1775
    reference variance = 0.261783
====================================================
  Execution time = 3.9574e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2709e-01
  Total weights = 2.0000e+06
  Execution time = 3.6400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326678068918
                                         uncertainty =       0.006311555958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326678068918
                                         uncertainty =       0.006311555958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404159584
  error estimate for blocks of size 2^( 2) =       0.000413557811
  error estimate for blocks of size 2^( 3) =       0.000421640630
  error estimate for blocks of size 2^( 4) =       0.000427566822
  error estimate for blocks of size 2^( 5) =       0.000431205697
  error estimate for blocks of size 2^( 6) =       0.000432803693
  error estimate for blocks of size 2^( 7) =       0.000434747425

      target function =                  N/A
              le_mean =     -17.216043270746
             les_mean =     296.718835675443
             stat err =       0.000431580909
             autocorr =       1.140298854324
              std dev =       0.571567964984
             le_variance =       0.326689938596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327886289217
                                         uncertainty =       0.006332183900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327886289217
                                         uncertainty =       0.006332183900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404906860
  error estimate for blocks of size 2^( 2) =       0.000414247932
  error estimate for blocks of size 2^( 3) =       0.000422270733
  error estimate for blocks of size 2^( 4) =       0.000428154240
  error estimate for blocks of size 2^( 5) =       0.000431782909
  error estimate for blocks of size 2^( 6) =       0.000433351915
  error estimate for blocks of size 2^( 7) =       0.000435289461

      target function =                  N/A
              le_mean =     -17.216044669050
             les_mean =     296.720093013614
             stat err =       0.000432144631
             autocorr =       1.139063600159
              std dev =       0.572624773162
             le_variance =       0.327899130839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327477608234
                                         uncertainty =       0.006325614588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327477608234
                                         uncertainty =       0.006325614588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404654280
  error estimate for blocks of size 2^( 2) =       0.000414015083
  error estimate for blocks of size 2^( 3) =       0.000422059585
  error estimate for blocks of size 2^( 4) =       0.000427958582
  error estimate for blocks of size 2^( 5) =       0.000431591252
  error estimate for blocks of size 2^( 6) =       0.000433174350
  error estimate for blocks of size 2^( 7) =       0.000435115975

      target function =                  N/A
              le_mean =     -17.216042546527
             les_mean =     296.719610971938
             stat err =       0.000431960040
             autocorr =       1.139511911142
              std dev =       0.572267570170
             le_variance =       0.327490171868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326787980915
                                         uncertainty =       0.006313532590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326787980915
                                         uncertainty =       0.006313532590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404227628
  error estimate for blocks of size 2^( 2) =       0.000413620528
  error estimate for blocks of size 2^( 3) =       0.000421698031
  error estimate for blocks of size 2^( 4) =       0.000427620433
  error estimate for blocks of size 2^( 5) =       0.000431258434
  error estimate for blocks of size 2^( 6) =       0.000432854503
  error estimate for blocks of size 2^( 7) =       0.000434798074

      target function =                  N/A
              le_mean =     -17.216042900355
             les_mean =     296.718932933575
             stat err =       0.000431632861
             autocorr =       1.140189444183
              std dev =       0.571664193482
             le_variance =       0.326799950110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216043270746        initial
     2.4414e-01     2.4414e+00             5.4262e-03       -17.216044669050  <--
     9.7656e-01     9.7656e+00             1.5916e-03       -17.216042546527
     3.9062e+00     3.9062e+01             4.1964e-04       -17.216042900355

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 5.7977e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.028411e-01 1 1  ON 0
 uu_1                 4.320842e-02 1 1  ON 1
 uu_2                -4.803032e-02 1 1  ON 2
 uu_3                -9.941498e-02 1 1  ON 3
 uu_4                -1.297629e-01 1 1  ON 4
 uu_5                -1.344920e-01 1 1  ON 5
 uu_6                -1.112847e-01 1 1  ON 6
 uu_7                -3.638107e-02 1 1  ON 7
 uu_8                 1.016833e-01 1 1  ON 8
 uu_9                 1.199765e-01 1 1  ON 9
 ud_0                 3.402724e-01 1 1  ON 10
 ud_1                 8.665428e-02 1 1  ON 11
 ud_2                -1.562043e-02 1 1  ON 12
 ud_3                -7.105947e-02 1 1  ON 13
 ud_4                -1.164970e-01 1 1  ON 14
 ud_5                -1.490943e-01 1 1  ON 15
 ud_6                -1.550285e-01 1 1  ON 16
 ud_7                -1.103982e-01 1 1  ON 17
 ud_8                 6.701728e-03 1 1  ON 18
 ud_9                 9.249639e-02 1 1  ON 19
 eO_0                -7.297627e-01 1 1  ON 20
 eO_1                -4.235914e-01 1 1  ON 21
 eO_2                -3.867410e-02 1 1  ON 22
 eO_3                 1.948805e-01 1 1  ON 23
 eO_4                 2.767175e-01 1 1  ON 24
 eO_5                 3.044868e-01 1 1  ON 25
 eO_6                 2.490362e-01 1 1  ON 26
 eO_7                 1.104196e-01 1 1  ON 27
 eO_8                 2.764021e-02 1 1  ON 28
 eO_9                 1.829592e-02 1 1  ON 29
eH1_0                -1.795643e-01 1 1  ON 30
eH1_1                -1.013107e-01 1 1  ON 31
eH1_2                -6.224881e-02 1 1  ON 32
eH1_3                -2.655786e-02 1 1  ON 33
eH1_4                 1.927375e-02 1 1  ON 34
eH1_5                 3.443240e-02 1 1  ON 35
eH1_6                 7.640444e-02 1 1  ON 36
eH1_7                 1.105387e-01 1 1  ON 37
eH1_8                 8.979019e-02 1 1  ON 38
eH1_9                 2.403853e-02 1 1  ON 39
eH2_0                -1.813847e-01 1 1  ON 40
eH2_1                -1.028368e-01 1 1  ON 41
eH2_2                -6.392765e-02 1 1  ON 42
eH2_3                -2.829424e-02 1 1  ON 43
eH2_4                 1.818126e-02 1 1  ON 44
eH2_5                 3.401470e-02 1 1  ON 45
eH2_6                 7.891639e-02 1 1  ON 46
eH2_7                 1.143795e-01 1 1  ON 47
eH2_8                 9.290588e-02 1 1  ON 48
eH2_9                 2.598093e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0947e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1433
    reference variance = 0.175336
====================================================
  Execution time = 4.2312e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1481e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0993e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314831505962
                                         uncertainty =       0.002833835794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314831505962
                                         uncertainty =       0.002833835794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396741325
  error estimate for blocks of size 2^( 2) =       0.000406422310
  error estimate for blocks of size 2^( 3) =       0.000415676792
  error estimate for blocks of size 2^( 4) =       0.000422442184
  error estimate for blocks of size 2^( 5) =       0.000426659432
  error estimate for blocks of size 2^( 6) =       0.000430130014
  error estimate for blocks of size 2^( 7) =       0.000432387580

      target function =                  N/A
              le_mean =     -17.216347311849
             les_mean =     296.717421962771
             stat err =       0.000427904802
             autocorr =       1.163267091459
              std dev =       0.561076962590
             le_variance =       0.314807357949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634731185e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216347311849       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216357029498       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216361858249       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216364665192       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216376968246       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216374971979       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216379609102       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216382968082       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216385953136       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216385992977       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216384942352       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216386432011       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216386155111       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216386190840       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216386290343       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 1.099579e-02

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216347311849       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216352258228       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216354364760       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216354702137       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216360340614       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216359370868       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216359675412       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216360708261       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216361227889       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216360979760       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216360856971       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 3.768304e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216347311849       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216348980688       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216349673264       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216349535594       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216351250849       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216351026790       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216350838173       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216351082283       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216351095318       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.081740e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3318e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.040634e-01 1 1  ON 0
 uu_1                 4.396144e-02 1 1  ON 1
 uu_2                -4.769423e-02 1 1  ON 2
 uu_3                -9.954725e-02 1 1  ON 3
 uu_4                -1.299820e-01 1 1  ON 4
 uu_5                -1.350331e-01 1 1  ON 5
 uu_6                -1.119525e-01 1 1  ON 6
 uu_7                -3.718233e-02 1 1  ON 7
 uu_8                 1.012979e-01 1 1  ON 8
 uu_9                 1.201410e-01 1 1  ON 9
 ud_0                 3.415461e-01 1 1  ON 10
 ud_1                 8.735796e-02 1 1  ON 11
 ud_2                -1.521201e-02 1 1  ON 12
 ud_3                -7.125014e-02 1 1  ON 13
 ud_4                -1.171637e-01 1 1  ON 14
 ud_5                -1.498392e-01 1 1  ON 15
 ud_6                -1.549875e-01 1 1  ON 16
 ud_7                -1.108455e-01 1 1  ON 17
 ud_8                 6.121409e-03 1 1  ON 18
 ud_9                 9.248674e-02 1 1  ON 19
 eO_0                -7.335310e-01 1 1  ON 20
 eO_1                -4.259739e-01 1 1  ON 21
 eO_2                -3.887834e-02 1 1  ON 22
 eO_3                 1.971841e-01 1 1  ON 23
 eO_4                 2.798572e-01 1 1  ON 24
 eO_5                 3.046305e-01 1 1  ON 25
 eO_6                 2.492635e-01 1 1  ON 26
 eO_7                 1.108611e-01 1 1  ON 27
 eO_8                 2.769289e-02 1 1  ON 28
 eO_9                 1.832261e-02 1 1  ON 29
eH1_0                -1.800901e-01 1 1  ON 30
eH1_1                -1.015555e-01 1 1  ON 31
eH1_2                -6.229794e-02 1 1  ON 32
eH1_3                -2.648216e-02 1 1  ON 33
eH1_4                 1.941832e-02 1 1  ON 34
eH1_5                 3.478911e-02 1 1  ON 35
eH1_6                 7.649554e-02 1 1  ON 36
eH1_7                 1.103480e-01 1 1  ON 37
eH1_8                 9.003095e-02 1 1  ON 38
eH1_9                 2.410523e-02 1 1  ON 39
eH2_0                -1.819006e-01 1 1  ON 40
eH2_1                -1.029851e-01 1 1  ON 41
eH2_2                -6.375151e-02 1 1  ON 42
eH2_3                -2.798080e-02 1 1  ON 43
eH2_4                 1.801296e-02 1 1  ON 44
eH2_5                 3.445980e-02 1 1  ON 45
eH2_6                 7.878696e-02 1 1  ON 46
eH2_7                 1.141347e-01 1 1  ON 47
eH2_8                 9.309339e-02 1 1  ON 48
eH2_9                 2.605283e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.0928
    reference variance = 0.274936
====================================================
  Execution time = 4.0856e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1871e-01
  Total weights = 2.0000e+06
  Execution time = 3.6387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317898628217
                                         uncertainty =       0.004182566919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317898628217
                                         uncertainty =       0.004182566919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398666281
  error estimate for blocks of size 2^( 2) =       0.000408342788
  error estimate for blocks of size 2^( 3) =       0.000416939540
  error estimate for blocks of size 2^( 4) =       0.000424037929
  error estimate for blocks of size 2^( 5) =       0.000426912239
  error estimate for blocks of size 2^( 6) =       0.000427284413
  error estimate for blocks of size 2^( 7) =       0.000428998845

      target function =                  N/A
              le_mean =     -17.216650271266
             les_mean =     296.730916011099
             stat err =       0.000426808356
             autocorr =       1.146164145025
              std dev =       0.563799261221
             le_variance =       0.317869606954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319786233142
                                         uncertainty =       0.004179896283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319786233142
                                         uncertainty =       0.004179896283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399847712
  error estimate for blocks of size 2^( 2) =       0.000409441334
  error estimate for blocks of size 2^( 3) =       0.000417933934
  error estimate for blocks of size 2^( 4) =       0.000424964012
  error estimate for blocks of size 2^( 5) =       0.000427780815
  error estimate for blocks of size 2^( 6) =       0.000428103994
  error estimate for blocks of size 2^( 7) =       0.000429860247

      target function =                  N/A
              le_mean =     -17.216655859610
             les_mean =     296.732995214068
             stat err =       0.000427677267
             autocorr =       1.144044983420
              std dev =       0.565470057303
             le_variance =       0.319756385706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319602430875
                                         uncertainty =       0.004184800532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319602430875
                                         uncertainty =       0.004184800532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399732861
  error estimate for blocks of size 2^( 2) =       0.000409340593
  error estimate for blocks of size 2^( 3) =       0.000417855291
  error estimate for blocks of size 2^( 4) =       0.000424902173
  error estimate for blocks of size 2^( 5) =       0.000427734771
  error estimate for blocks of size 2^( 6) =       0.000428074933
  error estimate for blocks of size 2^( 7) =       0.000429822836

      target function =                  N/A
              le_mean =     -17.216652904302
             les_mean =     296.732709787166
             stat err =       0.000427633678
             autocorr =       1.144469170090
              std dev =       0.565307632838
             le_variance =       0.319572719745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318188256968
                                         uncertainty =       0.004183224264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318188256968
                                         uncertainty =       0.004183224264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398847795
  error estimate for blocks of size 2^( 2) =       0.000408512604
  error estimate for blocks of size 2^( 3) =       0.000417095895
  error estimate for blocks of size 2^( 4) =       0.000424186154
  error estimate for blocks of size 2^( 5) =       0.000427054230
  error estimate for blocks of size 2^( 6) =       0.000427421845
  error estimate for blocks of size 2^( 7) =       0.000429141799

      target function =                  N/A
              le_mean =     -17.216649420543
             les_mean =     296.731176237433
             stat err =       0.000426951007
             autocorr =       1.145886740581
              std dev =       0.564055960542
             le_variance =       0.318159126623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216650271266        initial
     6.1035e-02     6.1035e-01             1.0996e-02       -17.216655859610  <--
     2.4414e-01     2.4414e+00             3.7683e-03       -17.216652904302
     9.7656e-01     9.7656e+00             1.0817e-03       -17.216649420543

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 5.9240e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.061952e-01 1 1  ON 0
 uu_1                 4.551057e-02 1 1  ON 1
 uu_2                -4.674151e-02 1 1  ON 2
 uu_3                -9.935195e-02 1 1  ON 3
 uu_4                -1.305608e-01 1 1  ON 4
 uu_5                -1.360330e-01 1 1  ON 5
 uu_6                -1.132359e-01 1 1  ON 6
 uu_7                -3.928974e-02 1 1  ON 7
 uu_8                 1.001390e-01 1 1  ON 8
 uu_9                 1.206235e-01 1 1  ON 9
 ud_0                 3.435283e-01 1 1  ON 10
 ud_1                 8.885418e-02 1 1  ON 11
 ud_2                -1.428316e-02 1 1  ON 12
 ud_3                -7.117791e-02 1 1  ON 13
 ud_4                -1.179727e-01 1 1  ON 14
 ud_5                -1.511100e-01 1 1  ON 15
 ud_6                -1.553384e-01 1 1  ON 16
 ud_7                -1.118621e-01 1 1  ON 17
 ud_8                 4.485744e-03 1 1  ON 18
 ud_9                 9.245121e-02 1 1  ON 19
 eO_0                -7.407585e-01 1 1  ON 20
 eO_1                -4.312539e-01 1 1  ON 21
 eO_2                -4.057720e-02 1 1  ON 22
 eO_3                 2.001580e-01 1 1  ON 23
 eO_4                 2.867786e-01 1 1  ON 24
 eO_5                 3.063664e-01 1 1  ON 25
 eO_6                 2.502092e-01 1 1  ON 26
 eO_7                 1.121947e-01 1 1  ON 27
 eO_8                 2.785017e-02 1 1  ON 28
 eO_9                 1.840180e-02 1 1  ON 29
eH1_0                -1.809903e-01 1 1  ON 30
eH1_1                -1.020694e-01 1 1  ON 31
eH1_2                -6.247535e-02 1 1  ON 32
eH1_3                -2.638002e-02 1 1  ON 33
eH1_4                 1.957258e-02 1 1  ON 34
eH1_5                 3.493482e-02 1 1  ON 35
eH1_6                 7.701160e-02 1 1  ON 36
eH1_7                 1.099807e-01 1 1  ON 37
eH1_8                 9.076754e-02 1 1  ON 38
eH1_9                 2.430536e-02 1 1  ON 39
eH2_0                -1.825967e-01 1 1  ON 40
eH2_1                -1.032277e-01 1 1  ON 41
eH2_2                -6.357689e-02 1 1  ON 42
eH2_3                -2.759394e-02 1 1  ON 43
eH2_4                 1.802442e-02 1 1  ON 44
eH2_5                 3.463931e-02 1 1  ON 45
eH2_6                 7.868626e-02 1 1  ON 46
eH2_7                 1.135976e-01 1 1  ON 47
eH2_8                 9.366455e-02 1 1  ON 48
eH2_9                 2.626805e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1256e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2008
    reference variance = 0.150276
====================================================
  Execution time = 4.0959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2563e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1121e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325731491473
                                         uncertainty =       0.003987585661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325731491473
                                         uncertainty =       0.003987585661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403504440
  error estimate for blocks of size 2^( 2) =       0.000413311557
  error estimate for blocks of size 2^( 3) =       0.000422031979
  error estimate for blocks of size 2^( 4) =       0.000428104715
  error estimate for blocks of size 2^( 5) =       0.000432028763
  error estimate for blocks of size 2^( 6) =       0.000435160051
  error estimate for blocks of size 2^( 7) =       0.000436616053

      target function =                  N/A
              le_mean =     -17.216086300356
             les_mean =     296.719259005464
             stat err =       0.000432977395
             autocorr =       1.151420110431
              std dev =       0.570641452220
             le_variance =       0.325631666991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721608630036e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216086300356       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216087297406       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216090953701       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216088563537       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216093696289       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216099856328       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216110466274       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216112019709       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216111905820       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216116041191       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216117247248       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216117923057       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216122687143       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216122186888       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216123056993       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216124021879       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216123512301       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216124124836       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216123888512       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 2.071956e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216086300356       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216087128130       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216090423145       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216088434379       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216090797302       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216095792907       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216100350130       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216100038270       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216099799901       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216100597987       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216100850534       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216100650474       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216101675851       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216101318821       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 8.091994e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216086300356       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216086793341       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216089043584       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216088325348       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216088544977       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216091064582       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216091720896       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216091529467       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216091370599       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216091480536       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 2.616168e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.386491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2096e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.081994e-01 1 1  ON 0
 uu_1                 4.702242e-02 1 1  ON 1
 uu_2                -4.570600e-02 1 1  ON 2
 uu_3                -9.923804e-02 1 1  ON 3
 uu_4                -1.315121e-01 1 1  ON 4
 uu_5                -1.373357e-01 1 1  ON 5
 uu_6                -1.136862e-01 1 1  ON 6
 uu_7                -4.174571e-02 1 1  ON 7
 uu_8                 9.845937e-02 1 1  ON 8
 uu_9                 1.214573e-01 1 1  ON 9
 ud_0                 3.454351e-01 1 1  ON 10
 ud_1                 9.038148e-02 1 1  ON 11
 ud_2                -1.378023e-02 1 1  ON 12
 ud_3                -7.147576e-02 1 1  ON 13
 ud_4                -1.189393e-01 1 1  ON 14
 ud_5                -1.523850e-01 1 1  ON 15
 ud_6                -1.554128e-01 1 1  ON 16
 ud_7                -1.125487e-01 1 1  ON 17
 ud_8                 2.542437e-03 1 1  ON 18
 ud_9                 9.245981e-02 1 1  ON 19
 eO_0                -7.488505e-01 1 1  ON 20
 eO_1                -4.372843e-01 1 1  ON 21
 eO_2                -4.310554e-02 1 1  ON 22
 eO_3                 2.026105e-01 1 1  ON 23
 eO_4                 2.935820e-01 1 1  ON 24
 eO_5                 3.097319e-01 1 1  ON 25
 eO_6                 2.516667e-01 1 1  ON 26
 eO_7                 1.140740e-01 1 1  ON 27
 eO_8                 2.820746e-02 1 1  ON 28
 eO_9                 1.856657e-02 1 1  ON 29
eH1_0                -1.808072e-01 1 1  ON 30
eH1_1                -1.026786e-01 1 1  ON 31
eH1_2                -6.265831e-02 1 1  ON 32
eH1_3                -2.642814e-02 1 1  ON 33
eH1_4                 1.931489e-02 1 1  ON 34
eH1_5                 3.434993e-02 1 1  ON 35
eH1_6                 7.724853e-02 1 1  ON 36
eH1_7                 1.098828e-01 1 1  ON 37
eH1_8                 9.170522e-02 1 1  ON 38
eH1_9                 2.454060e-02 1 1  ON 39
eH2_0                -1.833199e-01 1 1  ON 40
eH2_1                -1.039517e-01 1 1  ON 41
eH2_2                -6.407117e-02 1 1  ON 42
eH2_3                -2.774394e-02 1 1  ON 43
eH2_4                 1.837089e-02 1 1  ON 44
eH2_5                 3.465557e-02 1 1  ON 45
eH2_6                 7.864515e-02 1 1  ON 46
eH2_7                 1.134441e-01 1 1  ON 47
eH2_8                 9.505121e-02 1 1  ON 48
eH2_9                 2.668133e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2125
    reference variance = 0.186833
====================================================
  Execution time = 3.9582e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1926e-01
  Total weights = 2.0000e+06
  Execution time = 3.6348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318003653039
                                         uncertainty =       0.004112882211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318003653039
                                         uncertainty =       0.004112882211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398687363
  error estimate for blocks of size 2^( 2) =       0.000408439589
  error estimate for blocks of size 2^( 3) =       0.000417323168
  error estimate for blocks of size 2^( 4) =       0.000423874977
  error estimate for blocks of size 2^( 5) =       0.000427488750
  error estimate for blocks of size 2^( 6) =       0.000429633202
  error estimate for blocks of size 2^( 7) =       0.000431196199

      target function =                  N/A
              le_mean =     -17.216125240890
             les_mean =     296.712871378367
             stat err =       0.000428048282
             autocorr =       1.152711366053
              std dev =       0.563829076312
             le_variance =       0.317903227295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320504602863
                                         uncertainty =       0.004127197036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320504602863
                                         uncertainty =       0.004127197036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400251552
  error estimate for blocks of size 2^( 2) =       0.000409906127
  error estimate for blocks of size 2^( 3) =       0.000418666495
  error estimate for blocks of size 2^( 4) =       0.000425141084
  error estimate for blocks of size 2^( 5) =       0.000428699689
  error estimate for blocks of size 2^( 6) =       0.000430789724
  error estimate for blocks of size 2^( 7) =       0.000432398364

      target function =                  N/A
              le_mean =     -17.216136796755
             les_mean =     296.715768653658
             stat err =       0.000429257215
             autocorr =       1.150188864478
              std dev =       0.566041172775
             le_variance =       0.320402609277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320785877714
                                         uncertainty =       0.004129589786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320785877714
                                         uncertainty =       0.004129589786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400427178
  error estimate for blocks of size 2^( 2) =       0.000410080919
  error estimate for blocks of size 2^( 3) =       0.000418844121
  error estimate for blocks of size 2^( 4) =       0.000425327552
  error estimate for blocks of size 2^( 5) =       0.000428884232
  error estimate for blocks of size 2^( 6) =       0.000430976635
  error estimate for blocks of size 2^( 7) =       0.000432586542

      target function =                  N/A
              le_mean =     -17.216135935907
             les_mean =     296.716020252983
             stat err =       0.000429443740
             autocorr =       1.150179071025
              std dev =       0.566289545814
             le_variance =       0.320683849698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318592804399
                                         uncertainty =       0.004116554651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318592804399
                                         uncertainty =       0.004116554651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399056428
  error estimate for blocks of size 2^( 2) =       0.000408786055
  error estimate for blocks of size 2^( 3) =       0.000417643292
  error estimate for blocks of size 2^( 4) =       0.000424180596
  error estimate for blocks of size 2^( 5) =       0.000427781607
  error estimate for blocks of size 2^( 6) =       0.000429915479
  error estimate for blocks of size 2^( 7) =       0.000431488490

      target function =                  N/A
              le_mean =     -17.216122920523
             les_mean =     296.713380321106
             stat err =       0.000428341543
             autocorr =       1.152157288899
              std dev =       0.564351012924
             le_variance =       0.318492065789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216125240890        initial
     1.5259e-02     1.5259e-01             2.0720e-02       -17.216136796755  <--
     6.1035e-02     6.1035e-01             8.0920e-03       -17.216135935907
     2.4414e-01     2.4414e+00             2.6162e-03       -17.216122920523

*****************************************************************************
Applying the update for shift_i =   1.5259e-02     and shift_s =   1.5259e-01
*****************************************************************************

  Execution time = 5.7908e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.109400e-01 1 1  ON 0
 uu_1                 4.920300e-02 1 1  ON 1
 uu_2                -4.406985e-02 1 1  ON 2
 uu_3                -9.851320e-02 1 1  ON 3
 uu_4                -1.319657e-01 1 1  ON 4
 uu_5                -1.392057e-01 1 1  ON 5
 uu_6                -1.156865e-01 1 1  ON 6
 uu_7                -4.651215e-02 1 1  ON 7
 uu_8                 9.397259e-02 1 1  ON 8
 uu_9                 1.238242e-01 1 1  ON 9
 ud_0                 3.476757e-01 1 1  ON 10
 ud_1                 9.230725e-02 1 1  ON 11
 ud_2                -1.245585e-02 1 1  ON 12
 ud_3                -7.098084e-02 1 1  ON 13
 ud_4                -1.195049e-01 1 1  ON 14
 ud_5                -1.539581e-01 1 1  ON 15
 ud_6                -1.569509e-01 1 1  ON 16
 ud_7                -1.137894e-01 1 1  ON 17
 ud_8                -2.353772e-03 1 1  ON 18
 ud_9                 9.249271e-02 1 1  ON 19
 eO_0                -7.614781e-01 1 1  ON 20
 eO_1                -4.479945e-01 1 1  ON 21
 eO_2                -5.017736e-02 1 1  ON 22
 eO_3                 2.016105e-01 1 1  ON 23
 eO_4                 3.005820e-01 1 1  ON 24
 eO_5                 3.205354e-01 1 1  ON 25
 eO_6                 2.574388e-01 1 1  ON 26
 eO_7                 1.198655e-01 1 1  ON 27
 eO_8                 2.927259e-02 1 1  ON 28
 eO_9                 1.904481e-02 1 1  ON 29
eH1_0                -1.813660e-01 1 1  ON 30
eH1_1                -1.035732e-01 1 1  ON 31
eH1_2                -6.320981e-02 1 1  ON 32
eH1_3                -2.678702e-02 1 1  ON 33
eH1_4                 1.894089e-02 1 1  ON 34
eH1_5                 3.292112e-02 1 1  ON 35
eH1_6                 7.703127e-02 1 1  ON 36
eH1_7                 1.100973e-01 1 1  ON 37
eH1_8                 9.461533e-02 1 1  ON 38
eH1_9                 2.524805e-02 1 1  ON 39
eH2_0                -1.844084e-01 1 1  ON 40
eH2_1                -1.053694e-01 1 1  ON 41
eH2_2                -6.507555e-02 1 1  ON 42
eH2_3                -2.844505e-02 1 1  ON 43
eH2_4                 1.788153e-02 1 1  ON 44
eH2_5                 3.400863e-02 1 1  ON 45
eH2_6                 7.807134e-02 1 1  ON 46
eH2_7                 1.135661e-01 1 1  ON 47
eH2_8                 9.926474e-02 1 1  ON 48
eH2_9                 2.790605e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1001e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.38159
====================================================
  Execution time = 4.1037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1744e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0985e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317536927683
                                         uncertainty =       0.003232227563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317536927683
                                         uncertainty =       0.003232227563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398396441
  error estimate for blocks of size 2^( 2) =       0.000408107322
  error estimate for blocks of size 2^( 3) =       0.000416613174
  error estimate for blocks of size 2^( 4) =       0.000423276041
  error estimate for blocks of size 2^( 5) =       0.000427844347
  error estimate for blocks of size 2^( 6) =       0.000429390816
  error estimate for blocks of size 2^( 7) =       0.000428354679

      target function =                  N/A
              le_mean =     -17.215864710261
             les_mean =     296.703437011295
             stat err =       0.000427216471
             autocorr =       1.149913245008
              std dev =       0.563417649695
             le_variance =       0.317439447988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586471026e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215864710261       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215868014254       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215866310669       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215870096766       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215874424073       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215881621495       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215881270881       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215886690235       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215888845274       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215895862520       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215892391629       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215895658696       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215893770354       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215893647018       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215895139494       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215897972117       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215904877027       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215904470656       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215904845719       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215904021413       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215903400602       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215906014257       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215906265685       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215905688550       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.215905380850       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-03 is 3.936098e-02

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215864710261       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215867863304       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215866216615       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215869497122       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215873470303       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215879076277       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215878323897       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215881716986       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215882665689       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215886555709       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215883438387       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215884402063       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215883035875       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215883028258       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215883161358       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215883765865       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215885377223       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215885397330       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215885071912       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215884861765       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.288561e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215864710261       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215867376120       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215865979665       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215867912319       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215870912157       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215873631307       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215872704562       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215873946630       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215873949451       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215875032752       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215873933575       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215873768507       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215873926031       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.453454e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2047e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.121675e-01 1 1  ON 0
 uu_1                 5.034190e-02 1 1  ON 1
 uu_2                -4.354861e-02 1 1  ON 2
 uu_3                -9.856734e-02 1 1  ON 3
 uu_4                -1.333970e-01 1 1  ON 4
 uu_5                -1.413348e-01 1 1  ON 5
 uu_6                -1.183925e-01 1 1  ON 6
 uu_7                -4.888607e-02 1 1  ON 7
 uu_8                 9.128429e-02 1 1  ON 8
 uu_9                 1.280211e-01 1 1  ON 9
 ud_0                 3.497578e-01 1 1  ON 10
 ud_1                 9.450809e-02 1 1  ON 11
 ud_2                -1.048785e-02 1 1  ON 12
 ud_3                -6.981047e-02 1 1  ON 13
 ud_4                -1.195217e-01 1 1  ON 14
 ud_5                -1.546731e-01 1 1  ON 15
 ud_6                -1.589132e-01 1 1  ON 16
 ud_7                -1.154904e-01 1 1  ON 17
 ud_8                -8.799414e-03 1 1  ON 18
 ud_9                 9.247081e-02 1 1  ON 19
 eO_0                -7.743637e-01 1 1  ON 20
 eO_1                -4.595703e-01 1 1  ON 21
 eO_2                -5.772947e-02 1 1  ON 22
 eO_3                 1.995452e-01 1 1  ON 23
 eO_4                 3.045707e-01 1 1  ON 24
 eO_5                 3.303303e-01 1 1  ON 25
 eO_6                 2.670758e-01 1 1  ON 26
 eO_7                 1.280651e-01 1 1  ON 27
 eO_8                 3.081906e-02 1 1  ON 28
 eO_9                 1.955145e-02 1 1  ON 29
eH1_0                -1.836303e-01 1 1  ON 30
eH1_1                -1.056371e-01 1 1  ON 31
eH1_2                -6.473701e-02 1 1  ON 32
eH1_3                -2.816015e-02 1 1  ON 33
eH1_4                 1.783164e-02 1 1  ON 34
eH1_5                 3.273301e-02 1 1  ON 35
eH1_6                 7.830405e-02 1 1  ON 36
eH1_7                 1.109490e-01 1 1  ON 37
eH1_8                 9.936445e-02 1 1  ON 38
eH1_9                 2.646877e-02 1 1  ON 39
eH2_0                -1.845152e-01 1 1  ON 40
eH2_1                -1.064507e-01 1 1  ON 41
eH2_2                -6.581251e-02 1 1  ON 42
eH2_3                -2.939532e-02 1 1  ON 43
eH2_4                 1.668892e-02 1 1  ON 44
eH2_5                 3.307904e-02 1 1  ON 45
eH2_6                 7.660515e-02 1 1  ON 46
eH2_7                 1.124334e-01 1 1  ON 47
eH2_8                 1.043321e-01 1 1  ON 48
eH2_9                 2.988271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2408
    reference variance = 0.367637
====================================================
  Execution time = 3.9657e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2404e-01
  Total weights = 2.0000e+06
  Execution time = 3.6283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323563651064
                                         uncertainty =       0.003998698039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323563651064
                                         uncertainty =       0.003998698039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402204925
  error estimate for blocks of size 2^( 2) =       0.000411844793
  error estimate for blocks of size 2^( 3) =       0.000420788076
  error estimate for blocks of size 2^( 4) =       0.000427801857
  error estimate for blocks of size 2^( 5) =       0.000431424310
  error estimate for blocks of size 2^( 6) =       0.000433461289
  error estimate for blocks of size 2^( 7) =       0.000434808476

      target function =                  N/A
              le_mean =     -17.216653963782
             les_mean =     296.736711150290
             stat err =       0.000431873983
             autocorr =       1.152973472215
              std dev =       0.568803659851
             le_variance =       0.323537603460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324784589668
                                         uncertainty =       0.004012950068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324784589668
                                         uncertainty =       0.004012950068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402962831
  error estimate for blocks of size 2^( 2) =       0.000412553842
  error estimate for blocks of size 2^( 3) =       0.000421418820
  error estimate for blocks of size 2^( 4) =       0.000428357527
  error estimate for blocks of size 2^( 5) =       0.000431921439
  error estimate for blocks of size 2^( 6) =       0.000433893955
  error estimate for blocks of size 2^( 7) =       0.000435181760

      target function =                  N/A
              le_mean =     -17.216653474511
             les_mean =     296.737914785794
             stat err =       0.000432338670
             autocorr =       1.151113603592
              std dev =       0.569875501111
             le_variance =       0.324758086766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324616549144
                                         uncertainty =       0.004009940147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324616549144
                                         uncertainty =       0.004009940147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402858478
  error estimate for blocks of size 2^( 2) =       0.000412469348
  error estimate for blocks of size 2^( 3) =       0.000421362092
  error estimate for blocks of size 2^( 4) =       0.000428336185
  error estimate for blocks of size 2^( 5) =       0.000431919350
  error estimate for blocks of size 2^( 6) =       0.000433891923
  error estimate for blocks of size 2^( 7) =       0.000435163506

      target function =                  N/A
              le_mean =     -17.216656942540
             les_mean =     296.737866020723
             stat err =       0.000432327741
             autocorr =       1.151651805543
              std dev =       0.569727922713
             le_variance =       0.324589905919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323593829774
                                         uncertainty =       0.003999128285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323593829774
                                         uncertainty =       0.003999128285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402223598
  error estimate for blocks of size 2^( 2) =       0.000411861733
  error estimate for blocks of size 2^( 3) =       0.000420800196
  error estimate for blocks of size 2^( 4) =       0.000427812740
  error estimate for blocks of size 2^( 5) =       0.000431429257
  error estimate for blocks of size 2^( 6) =       0.000433448217
  error estimate for blocks of size 2^( 7) =       0.000434772817

      target function =                  N/A
              le_mean =     -17.216650593079
             les_mean =     296.736625127719
             stat err =       0.000431865758
             autocorr =       1.152822511627
              std dev =       0.568830067201
             le_variance =       0.323567645352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216653963782        initial
     3.8147e-03     3.8147e-02             3.9361e-02       -17.216653474511
     1.5259e-02     1.5259e-01             1.2886e-02       -17.216656942540  <--
     6.1035e-02     6.1035e-01             4.4535e-03       -17.216650593079

*****************************************************************************
Applying the update for shift_i =   1.5259e-02     and shift_s =   1.5259e-01
*****************************************************************************

  Execution time = 6.1522e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.121675e-01 1 1  ON 0
 uu_1                 5.034190e-02 1 1  ON 1
 uu_2                -4.354861e-02 1 1  ON 2
 uu_3                -9.856734e-02 1 1  ON 3
 uu_4                -1.333970e-01 1 1  ON 4
 uu_5                -1.413348e-01 1 1  ON 5
 uu_6                -1.183925e-01 1 1  ON 6
 uu_7                -4.888607e-02 1 1  ON 7
 uu_8                 9.128429e-02 1 1  ON 8
 uu_9                 1.280211e-01 1 1  ON 9
 ud_0                 3.497578e-01 1 1  ON 10
 ud_1                 9.450809e-02 1 1  ON 11
 ud_2                -1.048785e-02 1 1  ON 12
 ud_3                -6.981047e-02 1 1  ON 13
 ud_4                -1.195217e-01 1 1  ON 14
 ud_5                -1.546731e-01 1 1  ON 15
 ud_6                -1.589132e-01 1 1  ON 16
 ud_7                -1.154904e-01 1 1  ON 17
 ud_8                -8.799414e-03 1 1  ON 18
 ud_9                 9.247081e-02 1 1  ON 19
 eO_0                -7.743637e-01 1 1  ON 20
 eO_1                -4.595703e-01 1 1  ON 21
 eO_2                -5.772947e-02 1 1  ON 22
 eO_3                 1.995452e-01 1 1  ON 23
 eO_4                 3.045707e-01 1 1  ON 24
 eO_5                 3.303303e-01 1 1  ON 25
 eO_6                 2.670758e-01 1 1  ON 26
 eO_7                 1.280651e-01 1 1  ON 27
 eO_8                 3.081906e-02 1 1  ON 28
 eO_9                 1.955145e-02 1 1  ON 29
eH1_0                -1.836303e-01 1 1  ON 30
eH1_1                -1.056371e-01 1 1  ON 31
eH1_2                -6.473701e-02 1 1  ON 32
eH1_3                -2.816015e-02 1 1  ON 33
eH1_4                 1.783164e-02 1 1  ON 34
eH1_5                 3.273301e-02 1 1  ON 35
eH1_6                 7.830405e-02 1 1  ON 36
eH1_7                 1.109490e-01 1 1  ON 37
eH1_8                 9.936445e-02 1 1  ON 38
eH1_9                 2.646877e-02 1 1  ON 39
eH2_0                -1.845152e-01 1 1  ON 40
eH2_1                -1.064507e-01 1 1  ON 41
eH2_2                -6.581251e-02 1 1  ON 42
eH2_3                -2.939532e-02 1 1  ON 43
eH2_4                 1.668892e-02 1 1  ON 44
eH2_5                 3.307904e-02 1 1  ON 45
eH2_6                 7.660515e-02 1 1  ON 46
eH2_7                 1.124334e-01 1 1  ON 47
eH2_8                 1.043321e-01 1 1  ON 48
eH2_9                 2.988271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1358e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2079
    reference variance = 0.203376
====================================================
  Execution time = 4.0848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1950e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0916e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319485085455
                                         uncertainty =       0.002818669021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319485085455
                                         uncertainty =       0.002818669021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399690594
  error estimate for blocks of size 2^( 2) =       0.000409415489
  error estimate for blocks of size 2^( 3) =       0.000418512692
  error estimate for blocks of size 2^( 4) =       0.000424136664
  error estimate for blocks of size 2^( 5) =       0.000428852256
  error estimate for blocks of size 2^( 6) =       0.000429843309
  error estimate for blocks of size 2^( 7) =       0.000431002428

      target function =                  N/A
              le_mean =     -17.217121055431
             les_mean =     296.748762419996
             stat err =       0.000428458664
             autocorr =       1.149132220082
              std dev =       0.565247859233
             le_variance =       0.319505142367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712105543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217121055431       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217121496155       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217122585079       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217122645728       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217123087333       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217123272710       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217126990589       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217125398054       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217128391436       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217127521641       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217134530990       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217140635160       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217139513345       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217142140404       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217141776703       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217142803988       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217144303946       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217144112240       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217148068080       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217150230054       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217148275107       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-03 is 3.432468e-02

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217121055431       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217121478152       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217122503146       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217122591869       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217122953663       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217122864108       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217125947434       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217124674664       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217126840190       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217125702308       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217128733953       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217130140343       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217129676144       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217130479112       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217130244171       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217130132650       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217130521025       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 8.818815e-03

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217121055431       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217121418781       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217122245231       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217122412328       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217122554793       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217121966051       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217123806224       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217123272884       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217124212414       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217123495672       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217124237031       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217124155551       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 2.456120e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3263e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.132268e-01 1 1  ON 0
 uu_1                 5.151763e-02 1 1  ON 1
 uu_2                -4.266756e-02 1 1  ON 2
 uu_3                -9.790480e-02 1 1  ON 3
 uu_4                -1.325830e-01 1 1  ON 4
 uu_5                -1.417839e-01 1 1  ON 5
 uu_6                -1.201483e-01 1 1  ON 6
 uu_7                -5.333152e-02 1 1  ON 7
 uu_8                 8.718385e-02 1 1  ON 8
 uu_9                 1.308187e-01 1 1  ON 9
 ud_0                 3.515450e-01 1 1  ON 10
 ud_1                 9.600078e-02 1 1  ON 11
 ud_2                -9.037857e-03 1 1  ON 12
 ud_3                -6.850099e-02 1 1  ON 13
 ud_4                -1.185490e-01 1 1  ON 14
 ud_5                -1.550045e-01 1 1  ON 15
 ud_6                -1.601292e-01 1 1  ON 16
 ud_7                -1.167669e-01 1 1  ON 17
 ud_8                -1.503511e-02 1 1  ON 18
 ud_9                 9.183264e-02 1 1  ON 19
 eO_0                -7.813211e-01 1 1  ON 20
 eO_1                -4.658765e-01 1 1  ON 21
 eO_2                -6.429419e-02 1 1  ON 22
 eO_3                 1.939231e-01 1 1  ON 23
 eO_4                 3.041183e-01 1 1  ON 24
 eO_5                 3.379728e-01 1 1  ON 25
 eO_6                 2.758946e-01 1 1  ON 26
 eO_7                 1.360630e-01 1 1  ON 27
 eO_8                 3.175230e-02 1 1  ON 28
 eO_9                 1.989712e-02 1 1  ON 29
eH1_0                -1.854341e-01 1 1  ON 30
eH1_1                -1.070978e-01 1 1  ON 31
eH1_2                -6.607400e-02 1 1  ON 32
eH1_3                -2.907984e-02 1 1  ON 33
eH1_4                 1.717338e-02 1 1  ON 34
eH1_5                 3.247371e-02 1 1  ON 35
eH1_6                 7.945597e-02 1 1  ON 36
eH1_7                 1.113843e-01 1 1  ON 37
eH1_8                 1.029076e-01 1 1  ON 38
eH1_9                 2.764291e-02 1 1  ON 39
eH2_0                -1.866107e-01 1 1  ON 40
eH2_1                -1.079003e-01 1 1  ON 41
eH2_2                -6.716869e-02 1 1  ON 42
eH2_3                -2.978849e-02 1 1  ON 43
eH2_4                 1.655913e-02 1 1  ON 44
eH2_5                 3.260597e-02 1 1  ON 45
eH2_6                 7.661594e-02 1 1  ON 46
eH2_7                 1.126202e-01 1 1  ON 47
eH2_8                 1.085943e-01 1 1  ON 48
eH2_9                 3.118809e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2696
    reference variance = 0.275555
====================================================
  Execution time = 3.9802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2258e-01
  Total weights = 2.0000e+06
  Execution time = 3.6391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322141861467
                                         uncertainty =       0.003672441090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322141861467
                                         uncertainty =       0.003672441090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401367263
  error estimate for blocks of size 2^( 2) =       0.000411384726
  error estimate for blocks of size 2^( 3) =       0.000419813931
  error estimate for blocks of size 2^( 4) =       0.000426169682
  error estimate for blocks of size 2^( 5) =       0.000429642997
  error estimate for blocks of size 2^( 6) =       0.000432566808
  error estimate for blocks of size 2^( 7) =       0.000434344129

      target function =                  N/A
              le_mean =     -17.216888706847
             les_mean =     296.743447941820
             stat err =       0.000430680904
             autocorr =       1.151402952158
              std dev =       0.567619026248
             le_variance =       0.322191358959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322982095602
                                         uncertainty =       0.003682632059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322982095602
                                         uncertainty =       0.003682632059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401890217
  error estimate for blocks of size 2^( 2) =       0.000411866207
  error estimate for blocks of size 2^( 3) =       0.000420239710
  error estimate for blocks of size 2^( 4) =       0.000426539955
  error estimate for blocks of size 2^( 5) =       0.000429998894
  error estimate for blocks of size 2^( 6) =       0.000432891332
  error estimate for blocks of size 2^( 7) =       0.000434662173

      target function =                  N/A
              le_mean =     -17.216901382433
             les_mean =     296.744724544437
             stat err =       0.000431023089
             autocorr =       1.150233996444
              std dev =       0.568358595891
             le_variance =       0.323031493523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951505397
                                         uncertainty =       0.003688524662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951505397
                                         uncertainty =       0.003688524662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401871251
  error estimate for blocks of size 2^( 2) =       0.000411848040
  error estimate for blocks of size 2^( 3) =       0.000420228915
  error estimate for blocks of size 2^( 4) =       0.000426542217
  error estimate for blocks of size 2^( 5) =       0.000430015331
  error estimate for blocks of size 2^( 6) =       0.000432919540
  error estimate for blocks of size 2^( 7) =       0.000434690174

      target function =                  N/A
              le_mean =     -17.216899458961
             les_mean =     296.744627822752
             stat err =       0.000431041815
             autocorr =       1.150442532435
              std dev =       0.568331773075
             le_variance =       0.323001004286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322372406527
                                         uncertainty =       0.003678731996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322372406527
                                         uncertainty =       0.003678731996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401510887
  error estimate for blocks of size 2^( 2) =       0.000411513557
  error estimate for blocks of size 2^( 3) =       0.000419928108
  error estimate for blocks of size 2^( 4) =       0.000426272374
  error estimate for blocks of size 2^( 5) =       0.000429747902
  error estimate for blocks of size 2^( 6) =       0.000432666182
  error estimate for blocks of size 2^( 7) =       0.000434436299

      target function =                  N/A
              le_mean =     -17.216886943658
             les_mean =     296.743617853802
             stat err =       0.000430780689
             autocorr =       1.151112588229
              std dev =       0.567822141436
             le_variance =       0.322421984305


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216888706847        initial
     3.8147e-03     3.8147e-02             3.4325e-02       -17.216901382433  <--
     1.5259e-02     1.5259e-01             8.8188e-03       -17.216899458961
     6.1035e-02     6.1035e-01             2.4561e-03       -17.216886943658

*****************************************************************************
Applying the update for shift_i =   3.8147e-03     and shift_s =   3.8147e-02
*****************************************************************************

  Execution time = 5.8169e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.143289e-01 1 1  ON 0
 uu_1                 5.250130e-02 1 1  ON 1
 uu_2                -4.197381e-02 1 1  ON 2
 uu_3                -9.756712e-02 1 1  ON 3
 uu_4                -1.328105e-01 1 1  ON 4
 uu_5                -1.430901e-01 1 1  ON 5
 uu_6                -1.236245e-01 1 1  ON 6
 uu_7                -5.889273e-02 1 1  ON 7
 uu_8                 7.700109e-02 1 1  ON 8
 uu_9                 1.386528e-01 1 1  ON 9
 ud_0                 3.546008e-01 1 1  ON 10
 ud_1                 9.893028e-02 1 1  ON 11
 ud_2                -6.338050e-03 1 1  ON 12
 ud_3                -6.615799e-02 1 1  ON 13
 ud_4                -1.168763e-01 1 1  ON 14
 ud_5                -1.545051e-01 1 1  ON 15
 ud_6                -1.624700e-01 1 1  ON 16
 ud_7                -1.195205e-01 1 1  ON 17
 ud_8                -2.909585e-02 1 1  ON 18
 ud_9                 9.005363e-02 1 1  ON 19
 eO_0                -7.976827e-01 1 1  ON 20
 eO_1                -4.814649e-01 1 1  ON 21
 eO_2                -7.835124e-02 1 1  ON 22
 eO_3                 1.826324e-01 1 1  ON 23
 eO_4                 2.994612e-01 1 1  ON 24
 eO_5                 3.451830e-01 1 1  ON 25
 eO_6                 3.014004e-01 1 1  ON 26
 eO_7                 1.608087e-01 1 1  ON 27
 eO_8                 3.477566e-02 1 1  ON 28
 eO_9                 2.089583e-02 1 1  ON 29
eH1_0                -1.882438e-01 1 1  ON 30
eH1_1                -1.095539e-01 1 1  ON 31
eH1_2                -6.838382e-02 1 1  ON 32
eH1_3                -3.107833e-02 1 1  ON 33
eH1_4                 1.547740e-02 1 1  ON 34
eH1_5                 3.139673e-02 1 1  ON 35
eH1_6                 7.654567e-02 1 1  ON 36
eH1_7                 1.119660e-01 1 1  ON 37
eH1_8                 1.136049e-01 1 1  ON 38
eH1_9                 3.121401e-02 1 1  ON 39
eH2_0                -1.893232e-01 1 1  ON 40
eH2_1                -1.104211e-01 1 1  ON 41
eH2_2                -6.952855e-02 1 1  ON 42
eH2_3                -3.182015e-02 1 1  ON 43
eH2_4                 1.476685e-02 1 1  ON 44
eH2_5                 3.067254e-02 1 1  ON 45
eH2_6                 7.310369e-02 1 1  ON 46
eH2_7                 1.124830e-01 1 1  ON 47
eH2_8                 1.212680e-01 1 1  ON 48
eH2_9                 3.511936e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1146e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2683
    reference variance = 0.859713
====================================================
  Execution time = 4.0841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2521e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0985e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325276609755
                                         uncertainty =       0.004854630025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325276609755
                                         uncertainty =       0.004854630025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403242132
  error estimate for blocks of size 2^( 2) =       0.000412905857
  error estimate for blocks of size 2^( 3) =       0.000421555853
  error estimate for blocks of size 2^( 4) =       0.000427729622
  error estimate for blocks of size 2^( 5) =       0.000431920411
  error estimate for blocks of size 2^( 6) =       0.000433990192
  error estimate for blocks of size 2^( 7) =       0.000435373004

      target function =                  N/A
              le_mean =     -17.215587197248
             les_mean =     296.701650818216
             stat err =       0.000432253307
             autocorr =       1.149065655827
              std dev =       0.570270492646
             le_variance =       0.325208434782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721558719725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215587197248       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215588825355       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215589357262       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215589051291       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215590603195       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215594420835       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215596615626       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215600567120       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215601310442       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215601675040       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215606211958       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215605818452       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215608557868       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215612906598       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215611933115       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215625527395       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215629278260       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215632848425       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215644315613       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215645688854       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215644663417       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215648066345       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215651339006       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215654793771       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.215652655141       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.215652475600       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.215653110315       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.215652789951       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-04 is 1.574982e-01

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215587197248       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215588808016       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215589333663       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215589019625       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215590509400       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215594229196       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215596287977       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215599895792       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215600442464       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215600640397       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215604322393       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215603508260       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215605539558       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215608114466       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215606376205       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215612243589       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215613586840       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215614162044       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215616926639       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215616670724       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215615945197       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215616872577       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-03 is 3.682459e-02

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215587197248       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215588742201       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215589245682       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215588905044       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215590179122       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215593552460       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215595151133       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215597731230       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215597797170       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215597704299       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215599599434       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215598454369       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215599623938       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215600117426       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215599114298       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215600144224       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215600519219       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 9.192810e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.446255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1857e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.130160e-01 1 1  ON 0
 uu_1                 5.071654e-02 1 1  ON 1
 uu_2                -4.381257e-02 1 1  ON 2
 uu_3                -9.961399e-02 1 1  ON 3
 uu_4                -1.356276e-01 1 1  ON 4
 uu_5                -1.472203e-01 1 1  ON 5
 uu_6                -1.304435e-01 1 1  ON 6
 uu_7                -6.105355e-02 1 1  ON 7
 uu_8                 6.820907e-02 1 1  ON 8
 uu_9                 1.525663e-01 1 1  ON 9
 ud_0                 3.545293e-01 1 1  ON 10
 ud_1                 9.861513e-02 1 1  ON 11
 ud_2                -7.153212e-03 1 1  ON 12
 ud_3                -6.695340e-02 1 1  ON 13
 ud_4                -1.176614e-01 1 1  ON 14
 ud_5                -1.552880e-01 1 1  ON 15
 ud_6                -1.648407e-01 1 1  ON 16
 ud_7                -1.252451e-01 1 1  ON 17
 ud_8                -3.378737e-02 1 1  ON 18
 ud_9                 9.198760e-02 1 1  ON 19
 eO_0                -8.155489e-01 1 1  ON 20
 eO_1                -4.987603e-01 1 1  ON 21
 eO_2                -9.382003e-02 1 1  ON 22
 eO_3                 1.708975e-01 1 1  ON 23
 eO_4                 2.926932e-01 1 1  ON 24
 eO_5                 3.442966e-01 1 1  ON 25
 eO_6                 3.215039e-01 1 1  ON 26
 eO_7                 1.976333e-01 1 1  ON 27
 eO_8                 4.303985e-02 1 1  ON 28
 eO_9                 2.418560e-02 1 1  ON 29
eH1_0                -1.885393e-01 1 1  ON 30
eH1_1                -1.101539e-01 1 1  ON 31
eH1_2                -6.910763e-02 1 1  ON 32
eH1_3                -3.224240e-02 1 1  ON 33
eH1_4                 1.385200e-02 1 1  ON 34
eH1_5                 2.447662e-02 1 1  ON 35
eH1_6                 6.790984e-02 1 1  ON 36
eH1_7                 1.058733e-01 1 1  ON 37
eH1_8                 1.323675e-01 1 1  ON 38
eH1_9                 3.657420e-02 1 1  ON 39
eH2_0                -1.905523e-01 1 1  ON 40
eH2_1                -1.116400e-01 1 1  ON 41
eH2_2                -7.018839e-02 1 1  ON 42
eH2_3                -3.344830e-02 1 1  ON 43
eH2_4                 1.259639e-02 1 1  ON 44
eH2_5                 2.294627e-02 1 1  ON 45
eH2_6                 6.754412e-02 1 1  ON 46
eH2_7                 1.031258e-01 1 1  ON 47
eH2_8                 1.397930e-01 1 1  ON 48
eH2_9                 4.401646e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2215
    reference variance = 0.177706
====================================================
  Execution time = 3.9614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2300e-01
  Total weights = 2.0000e+06
  Execution time = 3.6606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322491039223
                                         uncertainty =       0.002833237712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322491039223
                                         uncertainty =       0.002833237712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523888
  error estimate for blocks of size 2^( 2) =       0.000411346890
  error estimate for blocks of size 2^( 3) =       0.000420024079
  error estimate for blocks of size 2^( 4) =       0.000425817723
  error estimate for blocks of size 2^( 5) =       0.000430113399
  error estimate for blocks of size 2^( 6) =       0.000432162863
  error estimate for blocks of size 2^( 7) =       0.000434859100

      target function =                  N/A
              le_mean =     -17.216274649129
             les_mean =     296.722555498079
             stat err =       0.000430738271
             autocorr =       1.150811374810
              std dev =       0.567840527830
             le_variance =       0.322442865046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323748110019
                                         uncertainty =       0.002842236876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323748110019
                                         uncertainty =       0.002842236876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402306476
  error estimate for blocks of size 2^( 2) =       0.000412087299
  error estimate for blocks of size 2^( 3) =       0.000420700283
  error estimate for blocks of size 2^( 4) =       0.000426420748
  error estimate for blocks of size 2^( 5) =       0.000430653538
  error estimate for blocks of size 2^( 6) =       0.000432715079
  error estimate for blocks of size 2^( 7) =       0.000435518205

      target function =                  N/A
              le_mean =     -17.216294578888
             les_mean =     296.724499865856
             stat err =       0.000431326893
             autocorr =       1.149473668195
              std dev =       0.568947274049
             le_variance =       0.323701000648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323676123405
                                         uncertainty =       0.002843808353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323676123405
                                         uncertainty =       0.002843808353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402261469
  error estimate for blocks of size 2^( 2) =       0.000412056462
  error estimate for blocks of size 2^( 3) =       0.000420695384
  error estimate for blocks of size 2^( 4) =       0.000426438747
  error estimate for blocks of size 2^( 5) =       0.000430691633
  error estimate for blocks of size 2^( 6) =       0.000432787958
  error estimate for blocks of size 2^( 7) =       0.000435531839

      target function =                  N/A
              le_mean =     -17.216272598574
             les_mean =     296.723670605683
             stat err =       0.000431362544
             autocorr =       1.149920968614
              std dev =       0.568883625250
             le_variance =       0.323628579077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322945124141
                                         uncertainty =       0.002837362524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322945124141
                                         uncertainty =       0.002837362524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401806613
  error estimate for blocks of size 2^( 2) =       0.000411616723
  error estimate for blocks of size 2^( 3) =       0.000420279197
  error estimate for blocks of size 2^( 4) =       0.000426058350
  error estimate for blocks of size 2^( 5) =       0.000430340547
  error estimate for blocks of size 2^( 6) =       0.000432412345
  error estimate for blocks of size 2^( 7) =       0.000435111265

      target function =                  N/A
              le_mean =     -17.216264245752
             les_mean =     296.722651527186
             stat err =       0.000430980627
             autocorr =       1.150485994168
              std dev =       0.568240362075
             le_variance =       0.322897109091


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216274649129        initial
     9.5367e-04     9.5367e-03             1.5750e-01       -17.216294578888  <--
     3.8147e-03     3.8147e-02             3.6825e-02       -17.216272598574
     1.5259e-02     1.5259e-01             9.1928e-03       -17.216264245752

*****************************************************************************
Applying the update for shift_i =   9.5367e-04     and shift_s =   9.5367e-03
*****************************************************************************

  Execution time = 5.8046e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.087920e-01 1 1  ON 0
 uu_1                 4.621043e-02 1 1  ON 1
 uu_2                -4.859128e-02 1 1  ON 2
 uu_3                -1.048348e-01 1 1  ON 3
 uu_4                -1.417851e-01 1 1  ON 4
 uu_5                -1.550389e-01 1 1  ON 5
 uu_6                -1.430588e-01 1 1  ON 6
 uu_7                -8.027679e-02 1 1  ON 7
 uu_8                 3.032669e-02 1 1  ON 8
 uu_9                 1.918310e-01 1 1  ON 9
 ud_0                 3.554573e-01 1 1  ON 10
 ud_1                 9.937012e-02 1 1  ON 11
 ud_2                -6.833700e-03 1 1  ON 12
 ud_3                -6.694305e-02 1 1  ON 13
 ud_4                -1.182890e-01 1 1  ON 14
 ud_5                -1.568234e-01 1 1  ON 15
 ud_6                -1.714881e-01 1 1  ON 16
 ud_7                -1.360256e-01 1 1  ON 17
 ud_8                -6.371923e-02 1 1  ON 18
 ud_9                 8.943261e-02 1 1  ON 19
 eO_0                -8.618432e-01 1 1  ON 20
 eO_1                -5.439809e-01 1 1  ON 21
 eO_2                -1.366469e-01 1 1  ON 22
 eO_3                 1.332642e-01 1 1  ON 23
 eO_4                 2.632686e-01 1 1  ON 24
 eO_5                 3.348147e-01 1 1  ON 25
 eO_6                 3.648499e-01 1 1  ON 26
 eO_7                 3.183069e-01 1 1  ON 27
 eO_8                 7.289481e-02 1 1  ON 28
 eO_9                 3.580031e-02 1 1  ON 29
eH1_0                -1.954116e-01 1 1  ON 30
eH1_1                -1.175629e-01 1 1  ON 31
eH1_2                -7.636456e-02 1 1  ON 32
eH1_3                -3.968484e-02 1 1  ON 33
eH1_4                 6.497897e-03 1 1  ON 34
eH1_5                 1.369862e-02 1 1  ON 35
eH1_6                 6.085756e-02 1 1  ON 36
eH1_7                 7.837389e-02 1 1  ON 37
eH1_8                 1.888536e-01 1 1  ON 38
eH1_9                 5.486414e-02 1 1  ON 39
eH2_0                -1.982384e-01 1 1  ON 40
eH2_1                -1.196711e-01 1 1  ON 41
eH2_2                -7.778952e-02 1 1  ON 42
eH2_3                -4.146959e-02 1 1  ON 43
eH2_4                 4.522077e-03 1 1  ON 44
eH2_5                 1.149283e-02 1 1  ON 45
eH2_6                 5.899616e-02 1 1  ON 46
eH2_7                 6.862212e-02 1 1  ON 47
eH2_8                 1.952329e-01 1 1  ON 48
eH2_9                 7.471723e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0991e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1486
    reference variance = 0.244441
====================================================
  Execution time = 4.0743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2004e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1003e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319950117297
                                         uncertainty =       0.004460573828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319950117297
                                         uncertainty =       0.004460573828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400025841
  error estimate for blocks of size 2^( 2) =       0.000409309035
  error estimate for blocks of size 2^( 3) =       0.000417609098
  error estimate for blocks of size 2^( 4) =       0.000424124927
  error estimate for blocks of size 2^( 5) =       0.000428182789
  error estimate for blocks of size 2^( 6) =       0.000430139677
  error estimate for blocks of size 2^( 7) =       0.000427895535

      target function =                  N/A
              le_mean =     -17.216281678653
             les_mean =     296.720396026323
             stat err =       0.000427585732
             autocorr =       1.142537110987
              std dev =       0.565721970263
             le_variance =       0.320041347638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628167865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216281678653       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216283342326       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288074497       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216292320654       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216295751058       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216297199623       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216302058648       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216306839684       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216307798319       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216308036356       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216308913251       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216311239041       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216311415545       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216310289018       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216309682850       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216307765483       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216309740577       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216307254722       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216306455768       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216309337036       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216307638089       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216308142688       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216308073766       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216313688229       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216320463034       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216317571651       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216318998786       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216321823792       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.216320464034       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.216321809066       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.216322376148       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-04 is 2.083113e-01

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216281678653       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216283335861       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288046255       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216292272609       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216295671566       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216297112048       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216301919468       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216306620294       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216307531542       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216307723867       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216308559765       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216310804156       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216310947672       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216309851635       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216309267754       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216307465156       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216309297369       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216307135094       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216306424439       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216308865533       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216307627892       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216308036574       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216308063588       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216311584319       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216315052067       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216312985925       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216313566580       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-04 is 5.905057e-02

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216281678653       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216283310497       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216287936260       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216292086089       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216295363933       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216296773035       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216301382928       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216305783477       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216306521262       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216306559114       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216307254012       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216309213358       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216309251958       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216308271998       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216307770581       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216306345345       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216307738544       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216306442337       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216305905658       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216307368018       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216306851005       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216307070020       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-03 is 1.531924e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.482908 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1788e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.034229e-01 1 1  ON 0
 uu_1                 4.099303e-02 1 1  ON 1
 uu_2                -5.327677e-02 1 1  ON 2
 uu_3                -1.090362e-01 1 1  ON 3
 uu_4                -1.450338e-01 1 1  ON 4
 uu_5                -1.560312e-01 1 1  ON 5
 uu_6                -1.406976e-01 1 1  ON 6
 uu_7                -8.666752e-02 1 1  ON 7
 uu_8                 1.046790e-02 1 1  ON 8
 uu_9                 1.939353e-01 1 1  ON 9
 ud_0                 3.533208e-01 1 1  ON 10
 ud_1                 9.756353e-02 1 1  ON 11
 ud_2                -7.777307e-03 1 1  ON 12
 ud_3                -6.770273e-02 1 1  ON 13
 ud_4                -1.190531e-01 1 1  ON 14
 ud_5                -1.576317e-01 1 1  ON 15
 ud_6                -1.708108e-01 1 1  ON 16
 ud_7                -1.392181e-01 1 1  ON 17
 ud_8                -7.357832e-02 1 1  ON 18
 ud_9                 6.440624e-02 1 1  ON 19
 eO_0                -8.681260e-01 1 1  ON 20
 eO_1                -5.517609e-01 1 1  ON 21
 eO_2                -1.476290e-01 1 1  ON 22
 eO_3                 1.173298e-01 1 1  ON 23
 eO_4                 2.404476e-01 1 1  ON 24
 eO_5                 3.211023e-01 1 1  ON 25
 eO_6                 3.541654e-01 1 1  ON 26
 eO_7                 3.773575e-01 1 1  ON 27
 eO_8                 9.340568e-02 1 1  ON 28
 eO_9                 3.966858e-02 1 1  ON 29
eH1_0                -1.992882e-01 1 1  ON 30
eH1_1                -1.205720e-01 1 1  ON 31
eH1_2                -7.974417e-02 1 1  ON 32
eH1_3                -4.243837e-02 1 1  ON 33
eH1_4                 4.735881e-03 1 1  ON 34
eH1_5                 2.004859e-02 1 1  ON 35
eH1_6                 6.168782e-02 1 1  ON 36
eH1_7                 5.845950e-02 1 1  ON 37
eH1_8                 1.905718e-01 1 1  ON 38
eH1_9                 6.947132e-02 1 1  ON 39
eH2_0                -2.041434e-01 1 1  ON 40
eH2_1                -1.249733e-01 1 1  ON 41
eH2_2                -8.419504e-02 1 1  ON 42
eH2_3                -4.712970e-02 1 1  ON 43
eH2_4                -7.703053e-04 1 1  ON 44
eH2_5                 1.165802e-02 1 1  ON 45
eH2_6                 5.530064e-02 1 1  ON 46
eH2_7                 8.060952e-02 1 1  ON 47
eH2_8                 2.032855e-01 1 1  ON 48
eH2_9                 8.262458e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1804
    reference variance = 0.193499
====================================================
  Execution time = 4.0382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2409e-01
  Total weights = 2.0000e+06
  Execution time = 3.6466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325274561828
                                         uncertainty =       0.003127063735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325274561828
                                         uncertainty =       0.003127063735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403235199
  error estimate for blocks of size 2^( 2) =       0.000412723552
  error estimate for blocks of size 2^( 3) =       0.000421014629
  error estimate for blocks of size 2^( 4) =       0.000426472345
  error estimate for blocks of size 2^( 5) =       0.000430717524
  error estimate for blocks of size 2^( 6) =       0.000432838655
  error estimate for blocks of size 2^( 7) =       0.000434107425

      target function =                  N/A
              le_mean =     -17.216486145069
             les_mean =     296.732592271910
             stat err =       0.000431033987
             autocorr =       1.142631417788
              std dev =       0.570260687004
             le_variance =       0.325197251143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323852868686
                                         uncertainty =       0.003113238698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323852868686
                                         uncertainty =       0.003113238698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402353033
  error estimate for blocks of size 2^( 2) =       0.000411861150
  error estimate for blocks of size 2^( 3) =       0.000420191558
  error estimate for blocks of size 2^( 4) =       0.000425634604
  error estimate for blocks of size 2^( 5) =       0.000429838609
  error estimate for blocks of size 2^( 6) =       0.000431935785
  error estimate for blocks of size 2^( 7) =       0.000433298705

      target function =                  N/A
              le_mean =     -17.216505698541
             les_mean =     296.731844232043
             stat err =       0.000430176926
             autocorr =       1.143087998252
              std dev =       0.569013115880
             le_variance =       0.323775926044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323213308256
                                         uncertainty =       0.003108215904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323213308256
                                         uncertainty =       0.003108215904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401955664
  error estimate for blocks of size 2^( 2) =       0.000411490322
  error estimate for blocks of size 2^( 3) =       0.000419854784
  error estimate for blocks of size 2^( 4) =       0.000425334094
  error estimate for blocks of size 2^( 5) =       0.000429565708
  error estimate for blocks of size 2^( 6) =       0.000431640120
  error estimate for blocks of size 2^( 7) =       0.000433042052

      target function =                  N/A
              le_mean =     -17.216501123676
             les_mean =     296.731047491144
             stat err =       0.000429895494
             autocorr =       1.143851064732
              std dev =       0.568451151086
             le_variance =       0.323136711171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324345431950
                                         uncertainty =       0.003118866701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324345431950
                                         uncertainty =       0.003118866701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402658888
  error estimate for blocks of size 2^( 2) =       0.000412158708
  error estimate for blocks of size 2^( 3) =       0.000420472997
  error estimate for blocks of size 2^( 4) =       0.000425938648
  error estimate for blocks of size 2^( 5) =       0.000430184420
  error estimate for blocks of size 2^( 6) =       0.000432281511
  error estimate for blocks of size 2^( 7) =       0.000433600319

      target function =                  N/A
              le_mean =     -17.216466395324
             les_mean =     296.730983338619
             stat err =       0.000430501225
             autocorr =       1.143073624319
              std dev =       0.569445659783
             le_variance =       0.324268359445


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216486145069        initial
     2.3842e-04     2.3842e-03             2.0831e-01       -17.216505698541  <--
     9.5367e-04     9.5367e-03             5.9051e-02       -17.216501123676
     3.8147e-03     3.8147e-02             1.5319e-02       -17.216466395324

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 5.8755e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.920892e-01 1 1  ON 0
 uu_1                 2.968563e-02 1 1  ON 1
 uu_2                -6.439474e-02 1 1  ON 2
 uu_3                -1.200796e-01 1 1  ON 3
 uu_4                -1.558250e-01 1 1  ON 4
 uu_5                -1.664092e-01 1 1  ON 5
 uu_6                -1.493548e-01 1 1  ON 6
 uu_7                -1.089350e-01 1 1  ON 7
 uu_8                -3.116134e-02 1 1  ON 8
 uu_9                 1.970770e-01 1 1  ON 9
 ud_0                 3.485745e-01 1 1  ON 10
 ud_1                 9.296185e-02 1 1  ON 11
 ud_2                -1.200317e-02 1 1  ON 12
 ud_3                -7.198228e-02 1 1  ON 13
 ud_4                -1.236169e-01 1 1  ON 14
 ud_5                -1.628732e-01 1 1  ON 15
 ud_6                -1.759662e-01 1 1  ON 16
 ud_7                -1.514393e-01 1 1  ON 17
 ud_8                -9.678673e-02 1 1  ON 18
 ud_9                 8.333461e-04 1 1  ON 19
 eO_0                -9.065652e-01 1 1  ON 20
 eO_1                -5.908141e-01 1 1  ON 21
 eO_2                -1.875074e-01 1 1  ON 22
 eO_3                 7.637794e-02 1 1  ON 23
 eO_4                 2.009257e-01 1 1  ON 24
 eO_5                 3.017042e-01 1 1  ON 25
 eO_6                 3.322324e-01 1 1  ON 26
 eO_7                 5.266182e-01 1 1  ON 27
 eO_8                 1.561371e-01 1 1  ON 28
 eO_9                 5.262598e-02 1 1  ON 29
eH1_0                -2.069873e-01 1 1  ON 30
eH1_1                -1.281487e-01 1 1  ON 31
eH1_2                -8.754382e-02 1 1  ON 32
eH1_3                -4.977935e-02 1 1  ON 33
eH1_4                -2.244032e-03 1 1  ON 34
eH1_5                 1.666427e-02 1 1  ON 35
eH1_6                 4.734216e-02 1 1  ON 36
eH1_7                 3.865783e-02 1 1  ON 37
eH1_8                 1.911199e-01 1 1  ON 38
eH1_9                 1.099154e-01 1 1  ON 39
eH2_0                -2.128584e-01 1 1  ON 40
eH2_1                -1.326249e-01 1 1  ON 41
eH2_2                -9.258233e-02 1 1  ON 42
eH2_3                -5.491961e-02 1 1  ON 43
eH2_4                -8.519848e-03 1 1  ON 44
eH2_5                 7.008253e-03 1 1  ON 45
eH2_6                 3.673960e-02 1 1  ON 46
eH2_7                 8.943256e-02 1 1  ON 47
eH2_8                 2.212222e-01 1 1  ON 48
eH2_9                 1.062211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1055e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1192
    reference variance = 0.708494
====================================================
  Execution time = 4.1553e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2883e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0887e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328925055011
                                         uncertainty =       0.004973579358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328925055011
                                         uncertainty =       0.004973579358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405483356
  error estimate for blocks of size 2^( 2) =       0.000414857636
  error estimate for blocks of size 2^( 3) =       0.000422852768
  error estimate for blocks of size 2^( 4) =       0.000429007283
  error estimate for blocks of size 2^( 5) =       0.000432080709
  error estimate for blocks of size 2^( 6) =       0.000433399243
  error estimate for blocks of size 2^( 7) =       0.000435649048

      target function =                  N/A
              le_mean =     -17.216863867394
             les_mean =     296.749234767187
             stat err =       0.000432534071
             autocorr =       1.137875068475
              std dev =       0.573440060719
             le_variance =       0.328833503238


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686386739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216863867394       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216866756950       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216864698960       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216867856547       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216868110782       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216867513631       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216869794486       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216870552005       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216870089647       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216873771220       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216874788040       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216874727914       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216875146590       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216876653351       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216880233415       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216880014646       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216880319568       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216879463437       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216878825594       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216881341775       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216881529397       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216882567755       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216883418155       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216883043235       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216884401951       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216885828786       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-05 is 4.794139e-02

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216863867394       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216866753881       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216864694894       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216867844914       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216868097672       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216867500579       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216869773252       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216870526392       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216870065311       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216873727781       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216874732881       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216874668565       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216875081525       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216876574082       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216880095520       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216879866016       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216880154989       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216879316041       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216878673510       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216881067850       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216881235758       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216882201521       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216882939907       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216882512724       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216883665246       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216884889779       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-04 is 4.309167e-02

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216863867394       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216866741670       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216864678796       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216867798867       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216868045833       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216867449007       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216869689466       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216870425439       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216869969449       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216873557029       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216874516778       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216874436744       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216874827999       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216876266168       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216879565154       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216879298253       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216879530147       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216878757259       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216878105541       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216880095467       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216880210496       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216880949638       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216881366875       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216880878822       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216881551294       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216882296253       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-04 is 3.081769e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.516687 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2480e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.893872e-01 1 1  ON 0
 uu_1                 2.665199e-02 1 1  ON 1
 uu_2                -6.804181e-02 1 1  ON 2
 uu_3                -1.240120e-01 1 1  ON 3
 uu_4                -1.602203e-01 1 1  ON 4
 uu_5                -1.719832e-01 1 1  ON 5
 uu_6                -1.602389e-01 1 1  ON 6
 uu_7                -1.127429e-01 1 1  ON 7
 uu_8                -2.347562e-02 1 1  ON 8
 uu_9                 1.864461e-01 1 1  ON 9
 ud_0                 3.486139e-01 1 1  ON 10
 ud_1                 9.323309e-02 1 1  ON 11
 ud_2                -1.260064e-02 1 1  ON 12
 ud_3                -7.288203e-02 1 1  ON 13
 ud_4                -1.241835e-01 1 1  ON 14
 ud_5                -1.638678e-01 1 1  ON 15
 ud_6                -1.792772e-01 1 1  ON 16
 ud_7                -1.583567e-01 1 1  ON 17
 ud_8                -1.156574e-01 1 1  ON 18
 ud_9                 2.364059e-03 1 1  ON 19
 eO_0                -9.140769e-01 1 1  ON 20
 eO_1                -5.962128e-01 1 1  ON 21
 eO_2                -1.901422e-01 1 1  ON 22
 eO_3                 7.680018e-02 1 1  ON 23
 eO_4                 2.059805e-01 1 1  ON 24
 eO_5                 2.969420e-01 1 1  ON 25
 eO_6                 3.387736e-01 1 1  ON 26
 eO_7                 5.064709e-01 1 1  ON 27
 eO_8                 1.734380e-01 1 1  ON 28
 eO_9                 5.879230e-02 1 1  ON 29
eH1_0                -2.079576e-01 1 1  ON 30
eH1_1                -1.303163e-01 1 1  ON 31
eH1_2                -8.926947e-02 1 1  ON 32
eH1_3                -5.254562e-02 1 1  ON 33
eH1_4                -6.541926e-03 1 1  ON 34
eH1_5                 5.451386e-03 1 1  ON 35
eH1_6                 4.372080e-02 1 1  ON 36
eH1_7                 5.635966e-02 1 1  ON 37
eH1_8                 1.837584e-01 1 1  ON 38
eH1_9                 1.179300e-01 1 1  ON 39
eH2_0                -2.081911e-01 1 1  ON 40
eH2_1                -1.294253e-01 1 1  ON 41
eH2_2                -8.789456e-02 1 1  ON 42
eH2_3                -5.072701e-02 1 1  ON 43
eH2_4                -4.196700e-03 1 1  ON 44
eH2_5                 9.187957e-03 1 1  ON 45
eH2_6                 5.182317e-02 1 1  ON 46
eH2_7                 4.634089e-02 1 1  ON 47
eH2_8                 2.093610e-01 1 1  ON 48
eH2_9                 1.144914e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.0981
    reference variance = 0.255231
====================================================
  Execution time = 4.0222e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2233e-01
  Total weights = 2.0000e+06
  Execution time = 3.6460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321707406438
                                         uncertainty =       0.002829522101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321707406438
                                         uncertainty =       0.002829522101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401087165
  error estimate for blocks of size 2^( 2) =       0.000409918508
  error estimate for blocks of size 2^( 3) =       0.000418342442
  error estimate for blocks of size 2^( 4) =       0.000424541027
  error estimate for blocks of size 2^( 5) =       0.000428845638
  error estimate for blocks of size 2^( 6) =       0.000429630155
  error estimate for blocks of size 2^( 7) =       0.000429411024

      target function =                  N/A
              le_mean =     -17.216406106778
             les_mean =     296.726380900707
             stat err =       0.000428106961
             autocorr =       1.139271017583
              std dev =       0.567222908640
             le_variance =       0.321741828086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322310866498
                                         uncertainty =       0.002833287794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322310866498
                                         uncertainty =       0.002833287794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401462933
  error estimate for blocks of size 2^( 2) =       0.000410266927
  error estimate for blocks of size 2^( 3) =       0.000418665760
  error estimate for blocks of size 2^( 4) =       0.000424831506
  error estimate for blocks of size 2^( 5) =       0.000429113310
  error estimate for blocks of size 2^( 6) =       0.000429869641
  error estimate for blocks of size 2^( 7) =       0.000429706632

      target function =                  N/A
              le_mean =     -17.216375239816
             les_mean =     296.725921210834
             stat err =       0.000428380272
             autocorr =       1.138591710950
              std dev =       0.567754325265
             le_variance =       0.322344973857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323092265047
                                         uncertainty =       0.002837241685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323092265047
                                         uncertainty =       0.002837241685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401949034
  error estimate for blocks of size 2^( 2) =       0.000410758540
  error estimate for blocks of size 2^( 3) =       0.000419166068
  error estimate for blocks of size 2^( 4) =       0.000425333316
  error estimate for blocks of size 2^( 5) =       0.000429617344
  error estimate for blocks of size 2^( 6) =       0.000430363254
  error estimate for blocks of size 2^( 7) =       0.000430255937

      target function =                  N/A
              le_mean =     -17.216411790300
             les_mean =     296.727960823926
             stat err =       0.000428892463
             autocorr =       1.138557186874
              std dev =       0.568441775654
             le_variance =       0.323126052309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322258976627
                                         uncertainty =       0.002833701262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322258976627
                                         uncertainty =       0.002833701262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401430613
  error estimate for blocks of size 2^( 2) =       0.000410237748
  error estimate for blocks of size 2^( 3) =       0.000418636220
  error estimate for blocks of size 2^( 4) =       0.000424809412
  error estimate for blocks of size 2^( 5) =       0.000429094619
  error estimate for blocks of size 2^( 6) =       0.000429856146
  error estimate for blocks of size 2^( 7) =       0.000429683911

      target function =                  N/A
              le_mean =     -17.216374249104
             les_mean =     296.725835198694
             stat err =       0.000428361022
             autocorr =       1.138672715537
              std dev =       0.567708617721
             le_variance =       0.322293074635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216406106778        initial
     5.9605e-05     5.9605e-04             4.7941e-02       -17.216375239816
     2.3842e-04     2.3842e-03             4.3092e-02       -17.216411790300  <--
     9.5367e-04     9.5367e-03             3.0818e-02       -17.216374249104

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 5.8659e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.893872e-01 1 1  ON 0
 uu_1                 2.665199e-02 1 1  ON 1
 uu_2                -6.804181e-02 1 1  ON 2
 uu_3                -1.240120e-01 1 1  ON 3
 uu_4                -1.602203e-01 1 1  ON 4
 uu_5                -1.719832e-01 1 1  ON 5
 uu_6                -1.602389e-01 1 1  ON 6
 uu_7                -1.127429e-01 1 1  ON 7
 uu_8                -2.347562e-02 1 1  ON 8
 uu_9                 1.864461e-01 1 1  ON 9
 ud_0                 3.486139e-01 1 1  ON 10
 ud_1                 9.323309e-02 1 1  ON 11
 ud_2                -1.260064e-02 1 1  ON 12
 ud_3                -7.288203e-02 1 1  ON 13
 ud_4                -1.241835e-01 1 1  ON 14
 ud_5                -1.638678e-01 1 1  ON 15
 ud_6                -1.792772e-01 1 1  ON 16
 ud_7                -1.583567e-01 1 1  ON 17
 ud_8                -1.156574e-01 1 1  ON 18
 ud_9                 2.364059e-03 1 1  ON 19
 eO_0                -9.140769e-01 1 1  ON 20
 eO_1                -5.962128e-01 1 1  ON 21
 eO_2                -1.901422e-01 1 1  ON 22
 eO_3                 7.680018e-02 1 1  ON 23
 eO_4                 2.059805e-01 1 1  ON 24
 eO_5                 2.969420e-01 1 1  ON 25
 eO_6                 3.387736e-01 1 1  ON 26
 eO_7                 5.064709e-01 1 1  ON 27
 eO_8                 1.734380e-01 1 1  ON 28
 eO_9                 5.879230e-02 1 1  ON 29
eH1_0                -2.079576e-01 1 1  ON 30
eH1_1                -1.303163e-01 1 1  ON 31
eH1_2                -8.926947e-02 1 1  ON 32
eH1_3                -5.254562e-02 1 1  ON 33
eH1_4                -6.541926e-03 1 1  ON 34
eH1_5                 5.451386e-03 1 1  ON 35
eH1_6                 4.372080e-02 1 1  ON 36
eH1_7                 5.635966e-02 1 1  ON 37
eH1_8                 1.837584e-01 1 1  ON 38
eH1_9                 1.179300e-01 1 1  ON 39
eH2_0                -2.081911e-01 1 1  ON 40
eH2_1                -1.294253e-01 1 1  ON 41
eH2_2                -8.789456e-02 1 1  ON 42
eH2_3                -5.072701e-02 1 1  ON 43
eH2_4                -4.196700e-03 1 1  ON 44
eH2_5                 9.187957e-03 1 1  ON 45
eH2_6                 5.182317e-02 1 1  ON 46
eH2_7                 4.634089e-02 1 1  ON 47
eH2_8                 2.093610e-01 1 1  ON 48
eH2_9                 1.144914e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1115e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2166
    reference variance = 0.340269
====================================================
  Execution time = 4.0651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3180e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0728e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331298628350
                                         uncertainty =       0.006626015555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331298628350
                                         uncertainty =       0.006626015555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407311209
  error estimate for blocks of size 2^( 2) =       0.000416213130
  error estimate for blocks of size 2^( 3) =       0.000423913984
  error estimate for blocks of size 2^( 4) =       0.000429744821
  error estimate for blocks of size 2^( 5) =       0.000433393048
  error estimate for blocks of size 2^( 6) =       0.000435419549
  error estimate for blocks of size 2^( 7) =       0.000436260388

      target function =                  N/A
              le_mean =     -17.216545975134
             les_mean =     296.741259990523
             stat err =       0.000433704451
             autocorr =       1.133796298740
              std dev =       0.576025036364
             le_variance =       0.331804842518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654597513e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545975134       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216541075245       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216540464440       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216541227001       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216540732575       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216539529711       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216539226535       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216539476585       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216541245012       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216542255956       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216543253562       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216542986799       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216542356055       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216542850667       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216542406412       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216541564189       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216541677711       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216541245188       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216541635214       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216541751021       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216539768392       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216541019251       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216539575030       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216539672346       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216540328943       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216541221262       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216544703849       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216544007831       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.216543403803       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.216543051204       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-05 is 8.209865e-02

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545975134       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216541077974       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216540466681       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216541228876       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216540736816       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216539533676       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216539231483       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216539483047       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216541244686       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216542248005       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216543236916       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216542964526       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216542338889       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216542818691       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216542382713       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216541564210       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216541677902       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216541257585       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216541616761       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216541751532       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216539886468       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216541074799       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216539842462       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216539854032       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216540491641       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-04 is 2.298945e-02

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545975134       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216541088857       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216540475631       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216541236346       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216540753634       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216539549438       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216539251170       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216539508688       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216541243535       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216542217029       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216543172493       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216542879176       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216542273590       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216542698900       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216542294496       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216541563309       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216541676371       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216541299399       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216541555001       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216541748142       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216540263248       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216541228489       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216540540162       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216540385560       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-04 is 1.519234e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.551712 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1419e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.914077e-01 1 1  ON 0
 uu_1                 2.883650e-02 1 1  ON 1
 uu_2                -6.587470e-02 1 1  ON 2
 uu_3                -1.223528e-01 1 1  ON 3
 uu_4                -1.591948e-01 1 1  ON 4
 uu_5                -1.716305e-01 1 1  ON 5
 uu_6                -1.595173e-01 1 1  ON 6
 uu_7                -1.142107e-01 1 1  ON 7
 uu_8                -3.920810e-02 1 1  ON 8
 uu_9                 1.634566e-01 1 1  ON 9
 ud_0                 3.446923e-01 1 1  ON 10
 ud_1                 8.888180e-02 1 1  ON 11
 ud_2                -1.678520e-02 1 1  ON 12
 ud_3                -7.700809e-02 1 1  ON 13
 ud_4                -1.286114e-01 1 1  ON 14
 ud_5                -1.682291e-01 1 1  ON 15
 ud_6                -1.807360e-01 1 1  ON 16
 ud_7                -1.598023e-01 1 1  ON 17
 ud_8                -9.640730e-02 1 1  ON 18
 ud_9                -9.173945e-03 1 1  ON 19
 eO_0                -9.187665e-01 1 1  ON 20
 eO_1                -6.010236e-01 1 1  ON 21
 eO_2                -1.939251e-01 1 1  ON 22
 eO_3                 7.529129e-02 1 1  ON 23
 eO_4                 2.074432e-01 1 1  ON 24
 eO_5                 2.980696e-01 1 1  ON 25
 eO_6                 3.324979e-01 1 1  ON 26
 eO_7                 5.036194e-01 1 1  ON 27
 eO_8                 1.912683e-01 1 1  ON 28
 eO_9                 6.018504e-02 1 1  ON 29
eH1_0                -2.114947e-01 1 1  ON 30
eH1_1                -1.317556e-01 1 1  ON 31
eH1_2                -9.034321e-02 1 1  ON 32
eH1_3                -5.334102e-02 1 1  ON 33
eH1_4                -7.616628e-03 1 1  ON 34
eH1_5                 3.592366e-03 1 1  ON 35
eH1_6                 4.215855e-02 1 1  ON 36
eH1_7                 6.472372e-02 1 1  ON 37
eH1_8                 1.786152e-01 1 1  ON 38
eH1_9                 1.200263e-01 1 1  ON 39
eH2_0                -2.052956e-01 1 1  ON 40
eH2_1                -1.269770e-01 1 1  ON 41
eH2_2                -8.551897e-02 1 1  ON 42
eH2_3                -4.841519e-02 1 1  ON 43
eH2_4                -2.726850e-03 1 1  ON 44
eH2_5                 8.445932e-03 1 1  ON 45
eH2_6                 4.598362e-02 1 1  ON 46
eH2_7                 4.330208e-02 1 1  ON 47
eH2_8                 1.994936e-01 1 1  ON 48
eH2_9                 1.196569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2468
    reference variance = 0.253998
====================================================
  Execution time = 4.0133e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2184e-01
  Total weights = 2.0000e+06
  Execution time = 3.6493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320946068369
                                         uncertainty =       0.003265913906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320946068369
                                         uncertainty =       0.003265913906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401038405
  error estimate for blocks of size 2^( 2) =       0.000410650693
  error estimate for blocks of size 2^( 3) =       0.000418250664
  error estimate for blocks of size 2^( 4) =       0.000424133944
  error estimate for blocks of size 2^( 5) =       0.000427700396
  error estimate for blocks of size 2^( 6) =       0.000429091778
  error estimate for blocks of size 2^( 7) =       0.000431417589

      target function =                  N/A
              le_mean =     -17.216308920275
             les_mean =     296.722956281609
             stat err =       0.000428085927
             autocorr =       1.139436095908
              std dev =       0.567153950955
             le_variance =       0.321663604084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320973481245
                                         uncertainty =       0.003268993827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320973481245
                                         uncertainty =       0.003268993827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401053849
  error estimate for blocks of size 2^( 2) =       0.000410662274
  error estimate for blocks of size 2^( 3) =       0.000418265172
  error estimate for blocks of size 2^( 4) =       0.000424161979
  error estimate for blocks of size 2^( 5) =       0.000427740017
  error estimate for blocks of size 2^( 6) =       0.000429081517
  error estimate for blocks of size 2^( 7) =       0.000431406650

      target function =                  N/A
              le_mean =     -17.216322090746
             les_mean =     296.723434550496
             stat err =       0.000428097541
             autocorr =       1.139410164362
              std dev =       0.567175792001
             le_variance =       0.321688379032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321363414206
                                         uncertainty =       0.003272606754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321363414206
                                         uncertainty =       0.003272606754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401298020
  error estimate for blocks of size 2^( 2) =       0.000410908840
  error estimate for blocks of size 2^( 3) =       0.000418516152
  error estimate for blocks of size 2^( 4) =       0.000424409685
  error estimate for blocks of size 2^( 5) =       0.000427981887
  error estimate for blocks of size 2^( 6) =       0.000429311727
  error estimate for blocks of size 2^( 7) =       0.000431651507

      target function =                  N/A
              le_mean =     -17.216333123594
             les_mean =     296.724206263559
             stat err =       0.000428338702
             autocorr =       1.139306558639
              std dev =       0.567521102728
             le_variance =       0.322080202041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321110501237
                                         uncertainty =       0.003269978190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321110501237
                                         uncertainty =       0.003269978190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401140226
  error estimate for blocks of size 2^( 2) =       0.000410748389
  error estimate for blocks of size 2^( 3) =       0.000418349277
  error estimate for blocks of size 2^( 4) =       0.000424235203
  error estimate for blocks of size 2^( 5) =       0.000427803012
  error estimate for blocks of size 2^( 6) =       0.000429166407
  error estimate for blocks of size 2^( 7) =       0.000431498370

      target function =                  N/A
              le_mean =     -17.216313309636
             les_mean =     296.723270776359
             stat err =       0.000428175748
             autocorr =       1.139335687483
              std dev =       0.567297947929
             le_variance =       0.321826961724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216308920275        initial
     5.9605e-05     5.9605e-04             8.2099e-02       -17.216322090746
     2.3842e-04     2.3842e-03             2.2989e-02       -17.216333123594  <--
     9.5367e-04     9.5367e-03             1.5192e-02       -17.216313309636

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 5.8559e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.914077e-01 1 1  ON 0
 uu_1                 2.883650e-02 1 1  ON 1
 uu_2                -6.587470e-02 1 1  ON 2
 uu_3                -1.223528e-01 1 1  ON 3
 uu_4                -1.591948e-01 1 1  ON 4
 uu_5                -1.716305e-01 1 1  ON 5
 uu_6                -1.595173e-01 1 1  ON 6
 uu_7                -1.142107e-01 1 1  ON 7
 uu_8                -3.920810e-02 1 1  ON 8
 uu_9                 1.634566e-01 1 1  ON 9
 ud_0                 3.446923e-01 1 1  ON 10
 ud_1                 8.888180e-02 1 1  ON 11
 ud_2                -1.678520e-02 1 1  ON 12
 ud_3                -7.700809e-02 1 1  ON 13
 ud_4                -1.286114e-01 1 1  ON 14
 ud_5                -1.682291e-01 1 1  ON 15
 ud_6                -1.807360e-01 1 1  ON 16
 ud_7                -1.598023e-01 1 1  ON 17
 ud_8                -9.640730e-02 1 1  ON 18
 ud_9                -9.173945e-03 1 1  ON 19
 eO_0                -9.187665e-01 1 1  ON 20
 eO_1                -6.010236e-01 1 1  ON 21
 eO_2                -1.939251e-01 1 1  ON 22
 eO_3                 7.529129e-02 1 1  ON 23
 eO_4                 2.074432e-01 1 1  ON 24
 eO_5                 2.980696e-01 1 1  ON 25
 eO_6                 3.324979e-01 1 1  ON 26
 eO_7                 5.036194e-01 1 1  ON 27
 eO_8                 1.912683e-01 1 1  ON 28
 eO_9                 6.018504e-02 1 1  ON 29
eH1_0                -2.114947e-01 1 1  ON 30
eH1_1                -1.317556e-01 1 1  ON 31
eH1_2                -9.034321e-02 1 1  ON 32
eH1_3                -5.334102e-02 1 1  ON 33
eH1_4                -7.616628e-03 1 1  ON 34
eH1_5                 3.592366e-03 1 1  ON 35
eH1_6                 4.215855e-02 1 1  ON 36
eH1_7                 6.472372e-02 1 1  ON 37
eH1_8                 1.786152e-01 1 1  ON 38
eH1_9                 1.200263e-01 1 1  ON 39
eH2_0                -2.052956e-01 1 1  ON 40
eH2_1                -1.269770e-01 1 1  ON 41
eH2_2                -8.551897e-02 1 1  ON 42
eH2_3                -4.841519e-02 1 1  ON 43
eH2_4                -2.726850e-03 1 1  ON 44
eH2_5                 8.445932e-03 1 1  ON 45
eH2_6                 4.598362e-02 1 1  ON 46
eH2_7                 4.330208e-02 1 1  ON 47
eH2_8                 1.994936e-01 1 1  ON 48
eH2_9                 1.196569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0998e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.163171
====================================================
  Execution time = 4.0713e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2146e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1008e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321475693788
                                         uncertainty =       0.003498788056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321475693788
                                         uncertainty =       0.003498788056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400913332
  error estimate for blocks of size 2^( 2) =       0.000409957834
  error estimate for blocks of size 2^( 3) =       0.000418985900
  error estimate for blocks of size 2^( 4) =       0.000425801351
  error estimate for blocks of size 2^( 5) =       0.000429799977
  error estimate for blocks of size 2^( 6) =       0.000431885614
  error estimate for blocks of size 2^( 7) =       0.000433697108

      target function =                  N/A
              le_mean =     -17.216886890590
             les_mean =     296.742657042554
             stat err =       0.000430296012
             autocorr =       1.151950043050
              std dev =       0.566977071763
             le_variance =       0.321462999905


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688689059e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886890590       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886568937       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216888848885       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216888270303       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887339123       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216886545023       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216889623329       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216887420871       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216886966702       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216887098062       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216889212126       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216888143878       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216886987669       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216887394342       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216888127594       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216887919558       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216888349468       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216887111709       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216886424260       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216885567647       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216887151736       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216887212167       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216887668216       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216887053061       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216887479186       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-05 is 2.427624e-02

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886890590       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886569148       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216888847289       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216888270635       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887340148       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216886546451       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216889619397       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216887422389       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216886969831       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216887101947       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216889202934       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216888142065       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216886996737       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216887405541       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216888122163       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216887908976       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216888331134       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216887141524       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216886478125       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216885674878       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216887182231       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216887244473       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216887660080       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216887098095       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216887488944       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-04 is 2.248553e-02

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886890590       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886569992       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216888840922       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216888271941       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887344208       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216886552133       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216889603797       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216887428376       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216886982199       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216887117221       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216889167163       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216888135101       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216887031406       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216887447409       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216888102077       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216887873210       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216888266604       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216887243562       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216886662688       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216886030297       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216887281054       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216887345410       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-04 is 1.597354e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.579892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1754e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.848824e-01 1 1  ON 0
 uu_1                 2.263404e-02 1 1  ON 1
 uu_2                -7.206945e-02 1 1  ON 2
 uu_3                -1.282565e-01 1 1  ON 3
 uu_4                -1.642917e-01 1 1  ON 4
 uu_5                -1.761486e-01 1 1  ON 5
 uu_6                -1.639660e-01 1 1  ON 6
 uu_7                -1.143707e-01 1 1  ON 7
 uu_8                -2.195228e-02 1 1  ON 8
 uu_9                 1.543161e-01 1 1  ON 9
 ud_0                 3.457644e-01 1 1  ON 10
 ud_1                 9.032808e-02 1 1  ON 11
 ud_2                -1.525046e-02 1 1  ON 12
 ud_3                -7.553272e-02 1 1  ON 13
 ud_4                -1.274524e-01 1 1  ON 14
 ud_5                -1.670975e-01 1 1  ON 15
 ud_6                -1.819615e-01 1 1  ON 16
 ud_7                -1.597036e-01 1 1  ON 17
 ud_8                -1.188928e-01 1 1  ON 18
 ud_9                -9.290671e-03 1 1  ON 19
 eO_0                -9.199167e-01 1 1  ON 20
 eO_1                -6.016035e-01 1 1  ON 21
 eO_2                -1.951795e-01 1 1  ON 22
 eO_3                 7.433443e-02 1 1  ON 23
 eO_4                 2.037487e-01 1 1  ON 24
 eO_5                 2.955803e-01 1 1  ON 25
 eO_6                 3.319442e-01 1 1  ON 26
 eO_7                 4.980605e-01 1 1  ON 27
 eO_8                 2.018077e-01 1 1  ON 28
 eO_9                 6.343566e-02 1 1  ON 29
eH1_0                -2.091360e-01 1 1  ON 30
eH1_1                -1.311755e-01 1 1  ON 31
eH1_2                -9.052903e-02 1 1  ON 32
eH1_3                -5.362574e-02 1 1  ON 33
eH1_4                -8.101948e-03 1 1  ON 34
eH1_5                 3.092775e-03 1 1  ON 35
eH1_6                 4.389314e-02 1 1  ON 36
eH1_7                 6.417548e-02 1 1  ON 37
eH1_8                 1.745499e-01 1 1  ON 38
eH1_9                 1.214827e-01 1 1  ON 39
eH2_0                -2.056998e-01 1 1  ON 40
eH2_1                -1.280358e-01 1 1  ON 41
eH2_2                -8.710364e-02 1 1  ON 42
eH2_3                -5.052953e-02 1 1  ON 43
eH2_4                -4.507320e-03 1 1  ON 44
eH2_5                 6.034372e-03 1 1  ON 45
eH2_6                 4.684782e-02 1 1  ON 46
eH2_7                 4.594110e-02 1 1  ON 47
eH2_8                 1.955627e-01 1 1  ON 48
eH2_9                 1.248344e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1453
    reference variance = 0.215473
====================================================
  Execution time = 3.9768e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2089e-01
  Total weights = 2.0000e+06
  Execution time = 3.6633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321031207770
                                         uncertainty =       0.002898501076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321031207770
                                         uncertainty =       0.002898501076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400672877
  error estimate for blocks of size 2^( 2) =       0.000410132713
  error estimate for blocks of size 2^( 3) =       0.000418287812
  error estimate for blocks of size 2^( 4) =       0.000424676988
  error estimate for blocks of size 2^( 5) =       0.000429121851
  error estimate for blocks of size 2^( 6) =       0.000432315963
  error estimate for blocks of size 2^( 7) =       0.000432717383

      target function =                  N/A
              le_mean =     -17.216631798281
             les_mean =     296.733487825068
             stat err =       0.000429708046
             autocorr =       1.150183370060
              std dev =       0.566637016121
             le_variance =       0.321077508038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320838732439
                                         uncertainty =       0.002896898428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320838732439
                                         uncertainty =       0.002896898428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400552710
  error estimate for blocks of size 2^( 2) =       0.000410023329
  error estimate for blocks of size 2^( 3) =       0.000418174646
  error estimate for blocks of size 2^( 4) =       0.000424559581
  error estimate for blocks of size 2^( 5) =       0.000428995039
  error estimate for blocks of size 2^( 6) =       0.000432195450
  error estimate for blocks of size 2^( 7) =       0.000432615441

      target function =                  N/A
              le_mean =     -17.216618752431
             les_mean =     296.732846052778
             stat err =       0.000429591378
             autocorr =       1.150248733928
              std dev =       0.566467074654
             le_variance =       0.320884946668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320720512380
                                         uncertainty =       0.002895382090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320720512380
                                         uncertainty =       0.002895382090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400478840
  error estimate for blocks of size 2^( 2) =       0.000409966040
  error estimate for blocks of size 2^( 3) =       0.000418119740
  error estimate for blocks of size 2^( 4) =       0.000424505342
  error estimate for blocks of size 2^( 5) =       0.000428933665
  error estimate for blocks of size 2^( 6) =       0.000432138097
  error estimate for blocks of size 2^( 7) =       0.000432576100

      target function =                  N/A
              le_mean =     -17.216619793677
             les_mean =     296.732763561806
             stat err =       0.000429538301
             autocorr =       1.150388792960
              std dev =       0.566362606610
             le_variance =       0.320766602166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320923558139
                                         uncertainty =       0.002897560290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320923558139
                                         uncertainty =       0.002897560290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400605607
  error estimate for blocks of size 2^( 2) =       0.000410075378
  error estimate for blocks of size 2^( 3) =       0.000418227042
  error estimate for blocks of size 2^( 4) =       0.000424613870
  error estimate for blocks of size 2^( 5) =       0.000429050023
  error estimate for blocks of size 2^( 6) =       0.000432239136
  error estimate for blocks of size 2^( 7) =       0.000432651781

      target function =                  N/A
              le_mean =     -17.216619904562
             les_mean =     296.732970482073
             stat err =       0.000429638703
             autocorr =       1.150198366711
              std dev =       0.566541882307
             le_variance =       0.320969704408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216631798281        initial  <--
     5.9605e-05     5.9605e-04             2.4276e-02       -17.216618752431
     2.3842e-04     2.3842e-03             2.2486e-02       -17.216619793677
     9.5367e-04     9.5367e-03             1.5974e-02       -17.216619904562

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.2242
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.914077e-01 1 1  ON 0
 uu_1                 2.883650e-02 1 1  ON 1
 uu_2                -6.587470e-02 1 1  ON 2
 uu_3                -1.223528e-01 1 1  ON 3
 uu_4                -1.591948e-01 1 1  ON 4
 uu_5                -1.716305e-01 1 1  ON 5
 uu_6                -1.595173e-01 1 1  ON 6
 uu_7                -1.142107e-01 1 1  ON 7
 uu_8                -3.920810e-02 1 1  ON 8
 uu_9                 1.634566e-01 1 1  ON 9
 ud_0                 3.446923e-01 1 1  ON 10
 ud_1                 8.888180e-02 1 1  ON 11
 ud_2                -1.678520e-02 1 1  ON 12
 ud_3                -7.700809e-02 1 1  ON 13
 ud_4                -1.286114e-01 1 1  ON 14
 ud_5                -1.682291e-01 1 1  ON 15
 ud_6                -1.807360e-01 1 1  ON 16
 ud_7                -1.598023e-01 1 1  ON 17
 ud_8                -9.640730e-02 1 1  ON 18
 ud_9                -9.173945e-03 1 1  ON 19
 eO_0                -9.187665e-01 1 1  ON 20
 eO_1                -6.010236e-01 1 1  ON 21
 eO_2                -1.939251e-01 1 1  ON 22
 eO_3                 7.529129e-02 1 1  ON 23
 eO_4                 2.074432e-01 1 1  ON 24
 eO_5                 2.980696e-01 1 1  ON 25
 eO_6                 3.324979e-01 1 1  ON 26
 eO_7                 5.036194e-01 1 1  ON 27
 eO_8                 1.912683e-01 1 1  ON 28
 eO_9                 6.018504e-02 1 1  ON 29
eH1_0                -2.114947e-01 1 1  ON 30
eH1_1                -1.317556e-01 1 1  ON 31
eH1_2                -9.034321e-02 1 1  ON 32
eH1_3                -5.334102e-02 1 1  ON 33
eH1_4                -7.616628e-03 1 1  ON 34
eH1_5                 3.592366e-03 1 1  ON 35
eH1_6                 4.215855e-02 1 1  ON 36
eH1_7                 6.472372e-02 1 1  ON 37
eH1_8                 1.786152e-01 1 1  ON 38
eH1_9                 1.200263e-01 1 1  ON 39
eH2_0                -2.052956e-01 1 1  ON 40
eH2_1                -1.269770e-01 1 1  ON 41
eH2_2                -8.551897e-02 1 1  ON 42
eH2_3                -4.841519e-02 1 1  ON 43
eH2_4                -2.726850e-03 1 1  ON 44
eH2_5                 8.445932e-03 1 1  ON 45
eH2_6                 4.598362e-02 1 1  ON 46
eH2_7                 4.330208e-02 1 1  ON 47
eH2_8                 1.994936e-01 1 1  ON 48
eH2_9                 1.196569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1099e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1602
    reference variance = 0.319509
====================================================
  Execution time = 4.0604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2277e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1044e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322856786526
                                         uncertainty =       0.003384399198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322856786526
                                         uncertainty =       0.003384399198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401725879
  error estimate for blocks of size 2^( 2) =       0.000410687624
  error estimate for blocks of size 2^( 3) =       0.000418943321
  error estimate for blocks of size 2^( 4) =       0.000425310054
  error estimate for blocks of size 2^( 5) =       0.000429570305
  error estimate for blocks of size 2^( 6) =       0.000431022969
  error estimate for blocks of size 2^( 7) =       0.000433760506

      target function =                  N/A
              le_mean =     -17.216446914984
             les_mean =     296.728811578123
             stat err =       0.000429915959
             autocorr =       1.145269024111
              std dev =       0.568126185839
             le_variance =       0.322767363036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644691498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216446914984       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216446803107       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216449411040       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449689422       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449195303       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216448856571       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216448848874       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216450264449       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216451502444       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216449760274       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216449091778       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216449110097       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216449658563       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216449441570       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216447934718       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216452125673       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216452219812       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216452872777       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216452806294       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216454114014       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216454810129       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216454486924       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216454521458       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216455069781       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-04 is 2.318444e-02

solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216446914984       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216446804039       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216449405330       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449661494       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449175949       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216448808210       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216448874021       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216450119384       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216451572561       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216450038890       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216449085041       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216449111654       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216449607779       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216449408353       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216448166162       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216451529161       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216451486515       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216451878683       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216451752426       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216452535899       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216452818129       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-03 is 1.181411e-02

solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216446914984       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216446807616       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216449376773       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449547916       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449100895       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216448631780       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216448951259       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216449622560       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216450985560       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216450047386       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216449077592       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216449076394       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216449446420       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216449279385       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216448618331       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216450289815       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216450212625       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 4.488802e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.601734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1675e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.890112e-01 1 1  ON 0
 uu_1                 2.664102e-02 1 1  ON 1
 uu_2                -6.791644e-02 1 1  ON 2
 uu_3                -1.243004e-01 1 1  ON 3
 uu_4                -1.606867e-01 1 1  ON 4
 uu_5                -1.736939e-01 1 1  ON 5
 uu_6                -1.612642e-01 1 1  ON 6
 uu_7                -1.126327e-01 1 1  ON 7
 uu_8                -3.869306e-02 1 1  ON 8
 uu_9                 1.612533e-01 1 1  ON 9
 ud_0                 3.466625e-01 1 1  ON 10
 ud_1                 9.078969e-02 1 1  ON 11
 ud_2                -1.498019e-02 1 1  ON 12
 ud_3                -7.546359e-02 1 1  ON 13
 ud_4                -1.274938e-01 1 1  ON 14
 ud_5                -1.676338e-01 1 1  ON 15
 ud_6                -1.826127e-01 1 1  ON 16
 ud_7                -1.628596e-01 1 1  ON 17
 ud_8                -1.082214e-01 1 1  ON 18
 ud_9                -9.444606e-03 1 1  ON 19
 eO_0                -9.193432e-01 1 1  ON 20
 eO_1                -6.012263e-01 1 1  ON 21
 eO_2                -1.944722e-01 1 1  ON 22
 eO_3                 7.425348e-02 1 1  ON 23
 eO_4                 2.049396e-01 1 1  ON 24
 eO_5                 2.970313e-01 1 1  ON 25
 eO_6                 3.339676e-01 1 1  ON 26
 eO_7                 4.995698e-01 1 1  ON 27
 eO_8                 1.961499e-01 1 1  ON 28
 eO_9                 6.251350e-02 1 1  ON 29
eH1_0                -2.114617e-01 1 1  ON 30
eH1_1                -1.331802e-01 1 1  ON 31
eH1_2                -9.167726e-02 1 1  ON 32
eH1_3                -5.474396e-02 1 1  ON 33
eH1_4                -7.498221e-03 1 1  ON 34
eH1_5                 3.161337e-03 1 1  ON 35
eH1_6                 4.518691e-02 1 1  ON 36
eH1_7                 6.375165e-02 1 1  ON 37
eH1_8                 1.778331e-01 1 1  ON 38
eH1_9                 1.208483e-01 1 1  ON 39
eH2_0                -2.086280e-01 1 1  ON 40
eH2_1                -1.302327e-01 1 1  ON 41
eH2_2                -8.895813e-02 1 1  ON 42
eH2_3                -5.203430e-02 1 1  ON 43
eH2_4                -4.768782e-03 1 1  ON 44
eH2_5                 7.173354e-03 1 1  ON 45
eH2_6                 5.046053e-02 1 1  ON 46
eH2_7                 5.130481e-02 1 1  ON 47
eH2_8                 2.005327e-01 1 1  ON 48
eH2_9                 1.216944e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1952
    reference variance = 0.205794
====================================================
  Execution time = 3.9687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2562e-01
  Total weights = 2.0000e+06
  Execution time = 3.6587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325435811428
                                         uncertainty =       0.004622460240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325435811428
                                         uncertainty =       0.004622460240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403428332
  error estimate for blocks of size 2^( 2) =       0.000412832724
  error estimate for blocks of size 2^( 3) =       0.000421466901
  error estimate for blocks of size 2^( 4) =       0.000427840715
  error estimate for blocks of size 2^( 5) =       0.000431293473
  error estimate for blocks of size 2^( 6) =       0.000432534913
  error estimate for blocks of size 2^( 7) =       0.000433972911

      target function =                  N/A
              le_mean =     -17.216677901261
             les_mean =     296.739506630972
             stat err =       0.000431410503
             autocorr =       1.143532834060
              std dev =       0.570533818426
             le_variance =       0.325508837968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462480226
                                         uncertainty =       0.004622334367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462480226
                                         uncertainty =       0.004622334367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403444793
  error estimate for blocks of size 2^( 2) =       0.000412849957
  error estimate for blocks of size 2^( 3) =       0.000421475929
  error estimate for blocks of size 2^( 4) =       0.000427837799
  error estimate for blocks of size 2^( 5) =       0.000431289462
  error estimate for blocks of size 2^( 6) =       0.000432510770
  error estimate for blocks of size 2^( 7) =       0.000433954250

      target function =                  N/A
              le_mean =     -17.216675768886
             les_mean =     296.739459769608
             stat err =       0.000431398070
             autocorr =       1.143373618726
              std dev =       0.570557097434
             le_variance =       0.325535401432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325681357960
                                         uncertainty =       0.004624609472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325681357960
                                         uncertainty =       0.004624609472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403580343
  error estimate for blocks of size 2^( 2) =       0.000412985014
  error estimate for blocks of size 2^( 3) =       0.000421600632
  error estimate for blocks of size 2^( 4) =       0.000427949828
  error estimate for blocks of size 2^( 5) =       0.000431400260
  error estimate for blocks of size 2^( 6) =       0.000432615116
  error estimate for blocks of size 2^( 7) =       0.000434068981

      target function =                  N/A
              le_mean =     -17.216677012899
             les_mean =     296.739721389841
             stat err =       0.000431508546
             autocorr =       1.143190991372
              std dev =       0.570748794321
             le_variance =       0.325754186219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325484291847
                                         uncertainty =       0.004622853227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325484291847
                                         uncertainty =       0.004622853227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403458306
  error estimate for blocks of size 2^( 2) =       0.000412861215
  error estimate for blocks of size 2^( 3) =       0.000421486519
  error estimate for blocks of size 2^( 4) =       0.000427847594
  error estimate for blocks of size 2^( 5) =       0.000431298415
  error estimate for blocks of size 2^( 6) =       0.000432530379
  error estimate for blocks of size 2^( 7) =       0.000433976557

      target function =                  N/A
              le_mean =     -17.216674466557
             les_mean =     296.739436734448
             stat err =       0.000431413236
             autocorr =       1.143377414585
              std dev =       0.570576208623
             le_variance =       0.325557209847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216677901261        initial  <--
     5.9605e-04     5.9605e-03             2.3184e-02       -17.216675768886
     2.3842e-03     2.3842e-02             1.1814e-02       -17.216677012899
     9.5367e-03     9.5367e-02             4.4888e-03       -17.216674466557

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.0641
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.914077e-01 1 1  ON 0
 uu_1                 2.883650e-02 1 1  ON 1
 uu_2                -6.587470e-02 1 1  ON 2
 uu_3                -1.223528e-01 1 1  ON 3
 uu_4                -1.591948e-01 1 1  ON 4
 uu_5                -1.716305e-01 1 1  ON 5
 uu_6                -1.595173e-01 1 1  ON 6
 uu_7                -1.142107e-01 1 1  ON 7
 uu_8                -3.920810e-02 1 1  ON 8
 uu_9                 1.634566e-01 1 1  ON 9
 ud_0                 3.446923e-01 1 1  ON 10
 ud_1                 8.888180e-02 1 1  ON 11
 ud_2                -1.678520e-02 1 1  ON 12
 ud_3                -7.700809e-02 1 1  ON 13
 ud_4                -1.286114e-01 1 1  ON 14
 ud_5                -1.682291e-01 1 1  ON 15
 ud_6                -1.807360e-01 1 1  ON 16
 ud_7                -1.598023e-01 1 1  ON 17
 ud_8                -9.640730e-02 1 1  ON 18
 ud_9                -9.173945e-03 1 1  ON 19
 eO_0                -9.187665e-01 1 1  ON 20
 eO_1                -6.010236e-01 1 1  ON 21
 eO_2                -1.939251e-01 1 1  ON 22
 eO_3                 7.529129e-02 1 1  ON 23
 eO_4                 2.074432e-01 1 1  ON 24
 eO_5                 2.980696e-01 1 1  ON 25
 eO_6                 3.324979e-01 1 1  ON 26
 eO_7                 5.036194e-01 1 1  ON 27
 eO_8                 1.912683e-01 1 1  ON 28
 eO_9                 6.018504e-02 1 1  ON 29
eH1_0                -2.114947e-01 1 1  ON 30
eH1_1                -1.317556e-01 1 1  ON 31
eH1_2                -9.034321e-02 1 1  ON 32
eH1_3                -5.334102e-02 1 1  ON 33
eH1_4                -7.616628e-03 1 1  ON 34
eH1_5                 3.592366e-03 1 1  ON 35
eH1_6                 4.215855e-02 1 1  ON 36
eH1_7                 6.472372e-02 1 1  ON 37
eH1_8                 1.786152e-01 1 1  ON 38
eH1_9                 1.200263e-01 1 1  ON 39
eH2_0                -2.052956e-01 1 1  ON 40
eH2_1                -1.269770e-01 1 1  ON 41
eH2_2                -8.551897e-02 1 1  ON 42
eH2_3                -4.841519e-02 1 1  ON 43
eH2_4                -2.726850e-03 1 1  ON 44
eH2_5                 8.445932e-03 1 1  ON 45
eH2_6                 4.598362e-02 1 1  ON 46
eH2_7                 4.330208e-02 1 1  ON 47
eH2_8                 1.994936e-01 1 1  ON 48
eH2_9                 1.196569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0975e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2592
    reference variance = 0.272253
====================================================
  Execution time = 4.0264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2306e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0947e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323093656101
                                         uncertainty =       0.003088890224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323093656101
                                         uncertainty =       0.003088890224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401909163
  error estimate for blocks of size 2^( 2) =       0.000411592110
  error estimate for blocks of size 2^( 3) =       0.000419845497
  error estimate for blocks of size 2^( 4) =       0.000426323696
  error estimate for blocks of size 2^( 5) =       0.000430049246
  error estimate for blocks of size 2^( 6) =       0.000431557530
  error estimate for blocks of size 2^( 7) =       0.000430950872

      target function =                  N/A
              le_mean =     -17.216879351685
             les_mean =     296.743996399289
             stat err =       0.000429720336
             autocorr =       1.143183632216
              std dev =       0.568385388925
             le_variance =       0.323061950344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687935168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-03, overlap shift 5.9605e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879351685       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879391143       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216880806461       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216880606588       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216878343320       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216881308094       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216881659644       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216883718893       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216882854313       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216883090931       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216880110838       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216881206480       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216881278450       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216880677172       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216880547103       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216880212668       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216880258834       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216881174661       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216880826244       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-03 is 4.619496e-03

solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879351685       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879389151       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216880643066       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216880585330       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216878517182       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216880935082       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216881258255       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216882712671       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216881892048       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216882102334       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216880469498       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216881088694       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 2.694481e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879351685       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879382857       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216880219977       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216880434999       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216878922700       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216880261272       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216880465599       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216881024354       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216880701163       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 9.037703e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.611367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1227e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.905695e-01 1 1  ON 0
 uu_1                 2.827818e-02 1 1  ON 1
 uu_2                -6.638604e-02 1 1  ON 2
 uu_3                -1.227099e-01 1 1  ON 3
 uu_4                -1.593665e-01 1 1  ON 4
 uu_5                -1.719192e-01 1 1  ON 5
 uu_6                -1.589859e-01 1 1  ON 6
 uu_7                -1.140043e-01 1 1  ON 7
 uu_8                -3.838005e-02 1 1  ON 8
 uu_9                 1.635069e-01 1 1  ON 9
 ud_0                 3.442709e-01 1 1  ON 10
 ud_1                 8.856517e-02 1 1  ON 11
 ud_2                -1.681751e-02 1 1  ON 12
 ud_3                -7.689329e-02 1 1  ON 13
 ud_4                -1.284715e-01 1 1  ON 14
 ud_5                -1.681359e-01 1 1  ON 15
 ud_6                -1.812405e-01 1 1  ON 16
 ud_7                -1.599255e-01 1 1  ON 17
 ud_8                -9.657447e-02 1 1  ON 18
 ud_9                -8.737593e-03 1 1  ON 19
 eO_0                -9.173580e-01 1 1  ON 20
 eO_1                -6.000551e-01 1 1  ON 21
 eO_2                -1.941470e-01 1 1  ON 22
 eO_3                 7.406459e-02 1 1  ON 23
 eO_4                 2.047487e-01 1 1  ON 24
 eO_5                 2.979896e-01 1 1  ON 25
 eO_6                 3.335672e-01 1 1  ON 26
 eO_7                 5.034728e-01 1 1  ON 27
 eO_8                 1.918749e-01 1 1  ON 28
 eO_9                 6.042744e-02 1 1  ON 29
eH1_0                -2.116164e-01 1 1  ON 30
eH1_1                -1.330407e-01 1 1  ON 31
eH1_2                -9.146923e-02 1 1  ON 32
eH1_3                -5.436960e-02 1 1  ON 33
eH1_4                -7.908925e-03 1 1  ON 34
eH1_5                 5.475886e-03 1 1  ON 35
eH1_6                 4.354509e-02 1 1  ON 36
eH1_7                 6.476994e-02 1 1  ON 37
eH1_8                 1.787821e-01 1 1  ON 38
eH1_9                 1.201849e-01 1 1  ON 39
eH2_0                -2.048379e-01 1 1  ON 40
eH2_1                -1.265562e-01 1 1  ON 41
eH2_2                -8.559937e-02 1 1  ON 42
eH2_3                -4.865751e-02 1 1  ON 43
eH2_4                -2.448214e-03 1 1  ON 44
eH2_5                 7.570686e-03 1 1  ON 45
eH2_6                 4.478643e-02 1 1  ON 46
eH2_7                 4.424202e-02 1 1  ON 47
eH2_8                 1.995069e-01 1 1  ON 48
eH2_9                 1.198229e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2233
    reference variance = 0.177928
====================================================
  Execution time = 3.9983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2092e-01
  Total weights = 2.0000e+06
  Execution time = 3.6491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321227772242
                                         uncertainty =       0.003379632057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321227772242
                                         uncertainty =       0.003379632057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400737015
  error estimate for blocks of size 2^( 2) =       0.000410401382
  error estimate for blocks of size 2^( 3) =       0.000418653402
  error estimate for blocks of size 2^( 4) =       0.000425043981
  error estimate for blocks of size 2^( 5) =       0.000428978806
  error estimate for blocks of size 2^( 6) =       0.000430440007
  error estimate for blocks of size 2^( 7) =       0.000431592096

      target function =                  N/A
              le_mean =     -17.216645694251
             les_mean =     296.734069110633
             stat err =       0.000429013722
             autocorr =       1.146102475499
              std dev =       0.566727721077
             le_variance =       0.321180309838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320856939537
                                         uncertainty =       0.003374301679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320856939537
                                         uncertainty =       0.003374301679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400505659
  error estimate for blocks of size 2^( 2) =       0.000410179679
  error estimate for blocks of size 2^( 3) =       0.000418441083
  error estimate for blocks of size 2^( 4) =       0.000424835938
  error estimate for blocks of size 2^( 5) =       0.000428765136
  error estimate for blocks of size 2^( 6) =       0.000430220230
  error estimate for blocks of size 2^( 7) =       0.000431361576

      target function =                  N/A
              le_mean =     -17.216648411486
             les_mean =     296.733791929364
             stat err =       0.000428795720
             autocorr =       1.146261144345
              std dev =       0.566400534106
             le_variance =       0.320809565036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320723367667
                                         uncertainty =       0.003371407021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320723367667
                                         uncertainty =       0.003371407021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400422317
  error estimate for blocks of size 2^( 2) =       0.000410103220
  error estimate for blocks of size 2^( 3) =       0.000418368851
  error estimate for blocks of size 2^( 4) =       0.000424762752
  error estimate for blocks of size 2^( 5) =       0.000428694877
  error estimate for blocks of size 2^( 6) =       0.000430139429
  error estimate for blocks of size 2^( 7) =       0.000431275936

      target function =                  N/A
              le_mean =     -17.216652886288
             les_mean =     296.733812511271
             stat err =       0.000428718248
             autocorr =       1.146324012327
              std dev =       0.566282672057
             le_variance =       0.320676064672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321133023845
                                         uncertainty =       0.003377832085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321133023845
                                         uncertainty =       0.003377832085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400677921
  error estimate for blocks of size 2^( 2) =       0.000410345938
  error estimate for blocks of size 2^( 3) =       0.000418599868
  error estimate for blocks of size 2^( 4) =       0.000424988972
  error estimate for blocks of size 2^( 5) =       0.000428922014
  error estimate for blocks of size 2^( 6) =       0.000430378837
  error estimate for blocks of size 2^( 7) =       0.000431521875

      target function =                  N/A
              le_mean =     -17.216647210109
             les_mean =     296.734026590274
             stat err =       0.000428952925
             autocorr =       1.146115647835
              std dev =       0.566644150638
             le_variance =       0.321085593452


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216645694251        initial
     5.9605e-03     5.9605e-02             4.6195e-03       -17.216648411486
     2.3842e-02     2.3842e-01             2.6945e-03       -17.216652886288  <--
     9.5367e-02     9.5367e-01             9.0377e-04       -17.216647210109

*****************************************************************************
Applying the update for shift_i =   2.3842e-02     and shift_s =   2.3842e-01
*****************************************************************************

  Execution time = 5.8368e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.905695e-01 1 1  ON 0
 uu_1                 2.827818e-02 1 1  ON 1
 uu_2                -6.638604e-02 1 1  ON 2
 uu_3                -1.227099e-01 1 1  ON 3
 uu_4                -1.593665e-01 1 1  ON 4
 uu_5                -1.719192e-01 1 1  ON 5
 uu_6                -1.589859e-01 1 1  ON 6
 uu_7                -1.140043e-01 1 1  ON 7
 uu_8                -3.838005e-02 1 1  ON 8
 uu_9                 1.635069e-01 1 1  ON 9
 ud_0                 3.442709e-01 1 1  ON 10
 ud_1                 8.856517e-02 1 1  ON 11
 ud_2                -1.681751e-02 1 1  ON 12
 ud_3                -7.689329e-02 1 1  ON 13
 ud_4                -1.284715e-01 1 1  ON 14
 ud_5                -1.681359e-01 1 1  ON 15
 ud_6                -1.812405e-01 1 1  ON 16
 ud_7                -1.599255e-01 1 1  ON 17
 ud_8                -9.657447e-02 1 1  ON 18
 ud_9                -8.737593e-03 1 1  ON 19
 eO_0                -9.173580e-01 1 1  ON 20
 eO_1                -6.000551e-01 1 1  ON 21
 eO_2                -1.941470e-01 1 1  ON 22
 eO_3                 7.406459e-02 1 1  ON 23
 eO_4                 2.047487e-01 1 1  ON 24
 eO_5                 2.979896e-01 1 1  ON 25
 eO_6                 3.335672e-01 1 1  ON 26
 eO_7                 5.034728e-01 1 1  ON 27
 eO_8                 1.918749e-01 1 1  ON 28
 eO_9                 6.042744e-02 1 1  ON 29
eH1_0                -2.116164e-01 1 1  ON 30
eH1_1                -1.330407e-01 1 1  ON 31
eH1_2                -9.146923e-02 1 1  ON 32
eH1_3                -5.436960e-02 1 1  ON 33
eH1_4                -7.908925e-03 1 1  ON 34
eH1_5                 5.475886e-03 1 1  ON 35
eH1_6                 4.354509e-02 1 1  ON 36
eH1_7                 6.476994e-02 1 1  ON 37
eH1_8                 1.787821e-01 1 1  ON 38
eH1_9                 1.201849e-01 1 1  ON 39
eH2_0                -2.048379e-01 1 1  ON 40
eH2_1                -1.265562e-01 1 1  ON 41
eH2_2                -8.559937e-02 1 1  ON 42
eH2_3                -4.865751e-02 1 1  ON 43
eH2_4                -2.448214e-03 1 1  ON 44
eH2_5                 7.570686e-03 1 1  ON 45
eH2_6                 4.478643e-02 1 1  ON 46
eH2_7                 4.424202e-02 1 1  ON 47
eH2_8                 1.995069e-01 1 1  ON 48
eH2_9                 1.198229e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0960e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2251
    reference variance = 0.165269
====================================================
  Execution time = 4.1073e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3262e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1167e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332711463620
                                         uncertainty =       0.011805021169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332711463620
                                         uncertainty =       0.011805021169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407809723
  error estimate for blocks of size 2^( 2) =       0.000417686914
  error estimate for blocks of size 2^( 3) =       0.000426900273
  error estimate for blocks of size 2^( 4) =       0.000432846176
  error estimate for blocks of size 2^( 5) =       0.000436112482
  error estimate for blocks of size 2^( 6) =       0.000435560154
  error estimate for blocks of size 2^( 7) =       0.000436599036

      target function =                  N/A
              le_mean =     -17.217231432086
             les_mean =     296.765675559818
             stat err =       0.000435279462
             autocorr =       1.139255675776
              std dev =       0.576730040924
             le_variance =       0.332617540104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721723143209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-03, overlap shift 5.9605e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217231432086       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217229723183       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217230409030       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217230543452       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217230603462       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217230029534       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217230471738       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217231377340       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217232695946       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217232421389       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217233341529       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217232961658       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217233519638       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217232682582       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217231773566       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217232032969       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217231734252       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-03 is 6.822890e-03

solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217231432086       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217229831539       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217230413405       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217230548672       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217230663548       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217230137965       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217230489746       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217231128050       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217232104852       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217231854169       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217232298422       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217231979544       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 2.064873e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217231432086       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217230155353       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217230491964       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217230591917       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217230811254       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217230436245       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217230619093       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217230846248       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217231297874       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217231156410       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 8.219698e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.620122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2255e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.904752e-01 1 1  ON 0
 uu_1                 2.808090e-02 1 1  ON 1
 uu_2                -6.662270e-02 1 1  ON 2
 uu_3                -1.227934e-01 1 1  ON 3
 uu_4                -1.591262e-01 1 1  ON 4
 uu_5                -1.716401e-01 1 1  ON 5
 uu_6                -1.588262e-01 1 1  ON 6
 uu_7                -1.142430e-01 1 1  ON 7
 uu_8                -3.836324e-02 1 1  ON 8
 uu_9                 1.628631e-01 1 1  ON 9
 ud_0                 3.450324e-01 1 1  ON 10
 ud_1                 8.951664e-02 1 1  ON 11
 ud_2                -1.614571e-02 1 1  ON 12
 ud_3                -7.637704e-02 1 1  ON 13
 ud_4                -1.279682e-01 1 1  ON 14
 ud_5                -1.676976e-01 1 1  ON 15
 ud_6                -1.820041e-01 1 1  ON 16
 ud_7                -1.611275e-01 1 1  ON 17
 ud_8                -9.863934e-02 1 1  ON 18
 ud_9                -8.971130e-03 1 1  ON 19
 eO_0                -9.170805e-01 1 1  ON 20
 eO_1                -5.998127e-01 1 1  ON 21
 eO_2                -1.936714e-01 1 1  ON 22
 eO_3                 7.380454e-02 1 1  ON 23
 eO_4                 2.040451e-01 1 1  ON 24
 eO_5                 2.981990e-01 1 1  ON 25
 eO_6                 3.335876e-01 1 1  ON 26
 eO_7                 5.027399e-01 1 1  ON 27
 eO_8                 1.921896e-01 1 1  ON 28
 eO_9                 6.053791e-02 1 1  ON 29
eH1_0                -2.108148e-01 1 1  ON 30
eH1_1                -1.324205e-01 1 1  ON 31
eH1_2                -9.177960e-02 1 1  ON 32
eH1_3                -5.434360e-02 1 1  ON 33
eH1_4                -7.787105e-03 1 1  ON 34
eH1_5                 4.468845e-03 1 1  ON 35
eH1_6                 4.345664e-02 1 1  ON 36
eH1_7                 6.438748e-02 1 1  ON 37
eH1_8                 1.788910e-01 1 1  ON 38
eH1_9                 1.202307e-01 1 1  ON 39
eH2_0                -2.054841e-01 1 1  ON 40
eH2_1                -1.269846e-01 1 1  ON 41
eH2_2                -8.632992e-02 1 1  ON 42
eH2_3                -4.911095e-02 1 1  ON 43
eH2_4                -2.395541e-03 1 1  ON 44
eH2_5                 9.464543e-03 1 1  ON 45
eH2_6                 4.521524e-02 1 1  ON 46
eH2_7                 4.446248e-02 1 1  ON 47
eH2_8                 1.990409e-01 1 1  ON 48
eH2_9                 1.198141e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2516
    reference variance = 0.178746
====================================================
  Execution time = 4.0629e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2391e-01
  Total weights = 2.0000e+06
  Execution time = 3.6772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323751284047
                                         uncertainty =       0.003034978613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323751284047
                                         uncertainty =       0.003034978613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402349070
  error estimate for blocks of size 2^( 2) =       0.000411767988
  error estimate for blocks of size 2^( 3) =       0.000419881104
  error estimate for blocks of size 2^( 4) =       0.000425125558
  error estimate for blocks of size 2^( 5) =       0.000428715423
  error estimate for blocks of size 2^( 6) =       0.000429763308
  error estimate for blocks of size 2^( 7) =       0.000429617850

      target function =                  N/A
              le_mean =     -17.216814282148
             les_mean =     296.742463412498
             stat err =       0.000428305535
             autocorr =       1.133186439874
              std dev =       0.569007511726
             le_variance =       0.323769548401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323889689029
                                         uncertainty =       0.003039230172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323889689029
                                         uncertainty =       0.003039230172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402434998
  error estimate for blocks of size 2^( 2) =       0.000411853421
  error estimate for blocks of size 2^( 3) =       0.000419956517
  error estimate for blocks of size 2^( 4) =       0.000425189488
  error estimate for blocks of size 2^( 5) =       0.000428779232
  error estimate for blocks of size 2^( 6) =       0.000429823465
  error estimate for blocks of size 2^( 7) =       0.000429688271

      target function =                  N/A
              le_mean =     -17.216813489651
             les_mean =     296.742574430972
             stat err =       0.000428370114
             autocorr =       1.133044175691
              std dev =       0.569129032367
             le_variance =       0.323907855483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324045108323
                                         uncertainty =       0.003043452746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324045108323
                                         uncertainty =       0.003043452746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402531414
  error estimate for blocks of size 2^( 2) =       0.000411950664
  error estimate for blocks of size 2^( 3) =       0.000420047889
  error estimate for blocks of size 2^( 4) =       0.000425268860
  error estimate for blocks of size 2^( 5) =       0.000428855283
  error estimate for blocks of size 2^( 6) =       0.000429889546
  error estimate for blocks of size 2^( 7) =       0.000429757812

      target function =                  N/A
              le_mean =     -17.216814432363
             les_mean =     296.742762115535
             stat err =       0.000428442875
             autocorr =       1.132886212407
              std dev =       0.569265385513
             le_variance =       0.324063079143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323830587116
                                         uncertainty =       0.003037921349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323830587116
                                         uncertainty =       0.003037921349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402398268
  error estimate for blocks of size 2^( 2) =       0.000411818175
  error estimate for blocks of size 2^( 3) =       0.000419925155
  error estimate for blocks of size 2^( 4) =       0.000425161221
  error estimate for blocks of size 2^( 5) =       0.000428749554
  error estimate for blocks of size 2^( 6) =       0.000429792711
  error estimate for blocks of size 2^( 7) =       0.000429649981

      target function =                  N/A
              le_mean =     -17.216814195312
             les_mean =     296.742539605373
             stat err =       0.000428338367
             autocorr =       1.133083065172
              std dev =       0.569077087406
             le_variance =       0.323848731411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216814282148        initial
     5.9605e-03     5.9605e-02             6.8229e-03       -17.216813489651
     2.3842e-02     2.3842e-01             2.0649e-03       -17.216814432363  <--
     9.5367e-02     9.5367e-01             8.2197e-04       -17.216814195312

*****************************************************************************
Applying the update for shift_i =   2.3842e-02     and shift_s =   2.3842e-01
*****************************************************************************

  Execution time = 5.9099e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.904752e-01 1 1  ON 0
 uu_1                 2.808090e-02 1 1  ON 1
 uu_2                -6.662270e-02 1 1  ON 2
 uu_3                -1.227934e-01 1 1  ON 3
 uu_4                -1.591262e-01 1 1  ON 4
 uu_5                -1.716401e-01 1 1  ON 5
 uu_6                -1.588262e-01 1 1  ON 6
 uu_7                -1.142430e-01 1 1  ON 7
 uu_8                -3.836324e-02 1 1  ON 8
 uu_9                 1.628631e-01 1 1  ON 9
 ud_0                 3.450324e-01 1 1  ON 10
 ud_1                 8.951664e-02 1 1  ON 11
 ud_2                -1.614571e-02 1 1  ON 12
 ud_3                -7.637704e-02 1 1  ON 13
 ud_4                -1.279682e-01 1 1  ON 14
 ud_5                -1.676976e-01 1 1  ON 15
 ud_6                -1.820041e-01 1 1  ON 16
 ud_7                -1.611275e-01 1 1  ON 17
 ud_8                -9.863934e-02 1 1  ON 18
 ud_9                -8.971130e-03 1 1  ON 19
 eO_0                -9.170805e-01 1 1  ON 20
 eO_1                -5.998127e-01 1 1  ON 21
 eO_2                -1.936714e-01 1 1  ON 22
 eO_3                 7.380454e-02 1 1  ON 23
 eO_4                 2.040451e-01 1 1  ON 24
 eO_5                 2.981990e-01 1 1  ON 25
 eO_6                 3.335876e-01 1 1  ON 26
 eO_7                 5.027399e-01 1 1  ON 27
 eO_8                 1.921896e-01 1 1  ON 28
 eO_9                 6.053791e-02 1 1  ON 29
eH1_0                -2.108148e-01 1 1  ON 30
eH1_1                -1.324205e-01 1 1  ON 31
eH1_2                -9.177960e-02 1 1  ON 32
eH1_3                -5.434360e-02 1 1  ON 33
eH1_4                -7.787105e-03 1 1  ON 34
eH1_5                 4.468845e-03 1 1  ON 35
eH1_6                 4.345664e-02 1 1  ON 36
eH1_7                 6.438748e-02 1 1  ON 37
eH1_8                 1.788910e-01 1 1  ON 38
eH1_9                 1.202307e-01 1 1  ON 39
eH2_0                -2.054841e-01 1 1  ON 40
eH2_1                -1.269846e-01 1 1  ON 41
eH2_2                -8.632992e-02 1 1  ON 42
eH2_3                -4.911095e-02 1 1  ON 43
eH2_4                -2.395541e-03 1 1  ON 44
eH2_5                 9.464543e-03 1 1  ON 45
eH2_6                 4.521524e-02 1 1  ON 46
eH2_7                 4.446248e-02 1 1  ON 47
eH2_8                 1.990409e-01 1 1  ON 48
eH2_9                 1.198141e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1136e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2073
    reference variance = 0.227133
====================================================
  Execution time = 4.0763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2003e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0924e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319894010353
                                         uncertainty =       0.003149222493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319894010353
                                         uncertainty =       0.003149222493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400021614
  error estimate for blocks of size 2^( 2) =       0.000409394938
  error estimate for blocks of size 2^( 3) =       0.000417670515
  error estimate for blocks of size 2^( 4) =       0.000424262119
  error estimate for blocks of size 2^( 5) =       0.000428528642
  error estimate for blocks of size 2^( 6) =       0.000430395767
  error estimate for blocks of size 2^( 7) =       0.000430039027

      target function =                  N/A
              le_mean =     -17.217205511467
             les_mean =     296.752200048188
             stat err =       0.000428306389
             autocorr =       1.146415866976
              std dev =       0.565715992465
             le_variance =       0.320034584130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721720551147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-03, overlap shift 5.9605e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217205511467       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217206816052       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217204957751       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217204061999       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217203640225       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217203700355       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217204473344       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217205345449       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217205362448       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217205439371       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217206517970       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217207168521       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217207402674       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217206897493       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217206434033       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217206821531       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217207521918       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-03 is 4.921697e-03

solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217205511467       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217206684790       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217204891824       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217204030929       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217203636885       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217203643179       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217204213452       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217204755795       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217204906143       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217204720945       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217205308897       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217205678940       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 3.029203e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217205511467       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217206348083       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217204807179       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217204099442       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217203803116       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217203757058       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217204045534       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217204167706       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217204322752       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217204203063       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217204277471       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.136642e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.629012 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1702e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.904862e-01 1 1  ON 0
 uu_1                 2.775898e-02 1 1  ON 1
 uu_2                -6.682622e-02 1 1  ON 2
 uu_3                -1.230426e-01 1 1  ON 3
 uu_4                -1.596745e-01 1 1  ON 4
 uu_5                -1.720515e-01 1 1  ON 5
 uu_6                -1.592822e-01 1 1  ON 6
 uu_7                -1.134438e-01 1 1  ON 7
 uu_8                -3.808922e-02 1 1  ON 8
 uu_9                 1.623091e-01 1 1  ON 9
 ud_0                 3.438639e-01 1 1  ON 10
 ud_1                 8.835776e-02 1 1  ON 11
 ud_2                -1.710569e-02 1 1  ON 12
 ud_3                -7.726844e-02 1 1  ON 13
 ud_4                -1.286679e-01 1 1  ON 14
 ud_5                -1.680414e-01 1 1  ON 15
 ud_6                -1.816109e-01 1 1  ON 16
 ud_7                -1.580983e-01 1 1  ON 17
 ud_8                -9.793660e-02 1 1  ON 18
 ud_9                -8.902549e-03 1 1  ON 19
 eO_0                -9.173916e-01 1 1  ON 20
 eO_1                -5.998469e-01 1 1  ON 21
 eO_2                -1.940493e-01 1 1  ON 22
 eO_3                 7.455955e-02 1 1  ON 23
 eO_4                 2.043950e-01 1 1  ON 24
 eO_5                 2.966111e-01 1 1  ON 25
 eO_6                 3.339029e-01 1 1  ON 26
 eO_7                 5.026863e-01 1 1  ON 27
 eO_8                 1.926982e-01 1 1  ON 28
 eO_9                 6.075996e-02 1 1  ON 29
eH1_0                -2.108323e-01 1 1  ON 30
eH1_1                -1.324391e-01 1 1  ON 31
eH1_2                -9.098027e-02 1 1  ON 32
eH1_3                -5.423551e-02 1 1  ON 33
eH1_4                -7.605507e-03 1 1  ON 34
eH1_5                 3.748711e-03 1 1  ON 35
eH1_6                 4.232163e-02 1 1  ON 36
eH1_7                 6.453888e-02 1 1  ON 37
eH1_8                 1.792007e-01 1 1  ON 38
eH1_9                 1.204182e-01 1 1  ON 39
eH2_0                -2.061687e-01 1 1  ON 40
eH2_1                -1.275547e-01 1 1  ON 41
eH2_2                -8.605447e-02 1 1  ON 42
eH2_3                -4.883632e-02 1 1  ON 43
eH2_4                -2.720128e-03 1 1  ON 44
eH2_5                 8.596941e-03 1 1  ON 45
eH2_6                 4.673207e-02 1 1  ON 46
eH2_7                 4.518722e-02 1 1  ON 47
eH2_8                 1.985503e-01 1 1  ON 48
eH2_9                 1.197636e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2055
    reference variance = 0.287733
====================================================
  Execution time = 3.9742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2263e-01
  Total weights = 2.0000e+06
  Execution time = 3.6501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322904583627
                                         uncertainty =       0.005365642291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322904583627
                                         uncertainty =       0.005365642291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401791787
  error estimate for blocks of size 2^( 2) =       0.000411047353
  error estimate for blocks of size 2^( 3) =       0.000419198288
  error estimate for blocks of size 2^( 4) =       0.000425129126
  error estimate for blocks of size 2^( 5) =       0.000428744235
  error estimate for blocks of size 2^( 6) =       0.000430373713
  error estimate for blocks of size 2^( 7) =       0.000432933643

      target function =                  N/A
              le_mean =     -17.216458056243
             les_mean =     296.729301120533
             stat err =       0.000429295179
             autocorr =       1.141589363575
              std dev =       0.568219393885
             le_variance =       0.322873279588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576671843
                                         uncertainty =       0.005363090986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576671843
                                         uncertainty =       0.005363090986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401587775
  error estimate for blocks of size 2^( 2) =       0.000410853288
  error estimate for blocks of size 2^( 3) =       0.000419021443
  error estimate for blocks of size 2^( 4) =       0.000424962082
  error estimate for blocks of size 2^( 5) =       0.000428593718
  error estimate for blocks of size 2^( 6) =       0.000430254774
  error estimate for blocks of size 2^( 7) =       0.000432830495

      target function =                  N/A
              le_mean =     -17.216456434597
             les_mean =     296.728917485170
             stat err =       0.000429160267
             autocorr =       1.142031403626
              std dev =       0.567930877893
             le_variance =       0.322545482064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322433049804
                                         uncertainty =       0.005361796490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322433049804
                                         uncertainty =       0.005361796490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401498363
  error estimate for blocks of size 2^( 2) =       0.000410771975
  error estimate for blocks of size 2^( 3) =       0.000418955635
  error estimate for blocks of size 2^( 4) =       0.000424906016
  error estimate for blocks of size 2^( 5) =       0.000428552756
  error estimate for blocks of size 2^( 6) =       0.000430234731
  error estimate for blocks of size 2^( 7) =       0.000432811351

      target function =                  N/A
              le_mean =     -17.216459974721
             les_mean =     296.728895770348
             stat err =       0.000429126214
             autocorr =       1.142358802097
              std dev =       0.567804429693
             le_variance =       0.322401870379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322732078181
                                         uncertainty =       0.005364114126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322732078181
                                         uncertainty =       0.005364114126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401684418
  error estimate for blocks of size 2^( 2) =       0.000410945008
  error estimate for blocks of size 2^( 3) =       0.000419106618
  error estimate for blocks of size 2^( 4) =       0.000425043481
  error estimate for blocks of size 2^( 5) =       0.000428669640
  error estimate for blocks of size 2^( 6) =       0.000430315624
  error estimate for blocks of size 2^( 7) =       0.000432877303

      target function =                  N/A
              le_mean =     -17.216457492683
             les_mean =     296.729109179867
             stat err =       0.000429226512
             autocorr =       1.141834359834
              std dev =       0.568067552202
             le_variance =       0.322700743865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216458056243        initial
     5.9605e-03     5.9605e-02             4.9217e-03       -17.216456434597
     2.3842e-02     2.3842e-01             3.0292e-03       -17.216459974721  <--
     9.5367e-02     9.5367e-01             1.1366e-03       -17.216457492683

*****************************************************************************
Applying the update for shift_i =   2.3842e-02     and shift_s =   2.3842e-01
*****************************************************************************

  Execution time = 5.8175e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.904862e-01 1 1  ON 0
 uu_1                 2.775898e-02 1 1  ON 1
 uu_2                -6.682622e-02 1 1  ON 2
 uu_3                -1.230426e-01 1 1  ON 3
 uu_4                -1.596745e-01 1 1  ON 4
 uu_5                -1.720515e-01 1 1  ON 5
 uu_6                -1.592822e-01 1 1  ON 6
 uu_7                -1.134438e-01 1 1  ON 7
 uu_8                -3.808922e-02 1 1  ON 8
 uu_9                 1.623091e-01 1 1  ON 9
 ud_0                 3.438639e-01 1 1  ON 10
 ud_1                 8.835776e-02 1 1  ON 11
 ud_2                -1.710569e-02 1 1  ON 12
 ud_3                -7.726844e-02 1 1  ON 13
 ud_4                -1.286679e-01 1 1  ON 14
 ud_5                -1.680414e-01 1 1  ON 15
 ud_6                -1.816109e-01 1 1  ON 16
 ud_7                -1.580983e-01 1 1  ON 17
 ud_8                -9.793660e-02 1 1  ON 18
 ud_9                -8.902549e-03 1 1  ON 19
 eO_0                -9.173916e-01 1 1  ON 20
 eO_1                -5.998469e-01 1 1  ON 21
 eO_2                -1.940493e-01 1 1  ON 22
 eO_3                 7.455955e-02 1 1  ON 23
 eO_4                 2.043950e-01 1 1  ON 24
 eO_5                 2.966111e-01 1 1  ON 25
 eO_6                 3.339029e-01 1 1  ON 26
 eO_7                 5.026863e-01 1 1  ON 27
 eO_8                 1.926982e-01 1 1  ON 28
 eO_9                 6.075996e-02 1 1  ON 29
eH1_0                -2.108323e-01 1 1  ON 30
eH1_1                -1.324391e-01 1 1  ON 31
eH1_2                -9.098027e-02 1 1  ON 32
eH1_3                -5.423551e-02 1 1  ON 33
eH1_4                -7.605507e-03 1 1  ON 34
eH1_5                 3.748711e-03 1 1  ON 35
eH1_6                 4.232163e-02 1 1  ON 36
eH1_7                 6.453888e-02 1 1  ON 37
eH1_8                 1.792007e-01 1 1  ON 38
eH1_9                 1.204182e-01 1 1  ON 39
eH2_0                -2.061687e-01 1 1  ON 40
eH2_1                -1.275547e-01 1 1  ON 41
eH2_2                -8.605447e-02 1 1  ON 42
eH2_3                -4.883632e-02 1 1  ON 43
eH2_4                -2.720128e-03 1 1  ON 44
eH2_5                 8.596941e-03 1 1  ON 45
eH2_6                 4.673207e-02 1 1  ON 46
eH2_7                 4.518722e-02 1 1  ON 47
eH2_8                 1.985503e-01 1 1  ON 48
eH2_9                 1.197636e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0988e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2478
    reference variance = 0.487985
====================================================
  Execution time = 4.0673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2522e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0943e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325061207634
                                         uncertainty =       0.003882688563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325061207634
                                         uncertainty =       0.003882688563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403249331
  error estimate for blocks of size 2^( 2) =       0.000412693901
  error estimate for blocks of size 2^( 3) =       0.000420881579
  error estimate for blocks of size 2^( 4) =       0.000426684959
  error estimate for blocks of size 2^( 5) =       0.000429800734
  error estimate for blocks of size 2^( 6) =       0.000431116438
  error estimate for blocks of size 2^( 7) =       0.000432490037

      target function =                  N/A
              le_mean =     -17.216159502158
             les_mean =     296.721367887351
             stat err =       0.000430023042
             autocorr =       1.137198145797
              std dev =       0.570280673178
             le_variance =       0.325220046200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721615950216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-03, overlap shift 5.9605e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216159502158       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160854861       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216160160311       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216160653888       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216164923668       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216165112475       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216166440231       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216165812334       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216166534489       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216165911194       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216166707863       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216165396437       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216166914314       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216166745981       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216166980967       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216167667134       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216168226212       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-03 is 6.056005e-03

solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216159502158       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160703231       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216160154161       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216160605413       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216164451460       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216164611538       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216165603732       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216165085991       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216165584146       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216165072314       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216165639033       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216164959675       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216165640991       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 2.469850e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216159502158       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160331413       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216160072420       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216160490131       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216163253277       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216163353020       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216163763783       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216163427078       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216163545976       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216163318413       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 7.342250e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.638103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1631e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.901177e-01 1 1  ON 0
 uu_1                 2.771637e-02 1 1  ON 1
 uu_2                -6.697625e-02 1 1  ON 2
 uu_3                -1.230774e-01 1 1  ON 3
 uu_4                -1.600278e-01 1 1  ON 4
 uu_5                -1.717420e-01 1 1  ON 5
 uu_6                -1.597590e-01 1 1  ON 6
 uu_7                -1.139118e-01 1 1  ON 7
 uu_8                -3.735594e-02 1 1  ON 8
 uu_9                 1.620567e-01 1 1  ON 9
 ud_0                 3.445596e-01 1 1  ON 10
 ud_1                 8.885999e-02 1 1  ON 11
 ud_2                -1.661785e-02 1 1  ON 12
 ud_3                -7.696668e-02 1 1  ON 13
 ud_4                -1.285129e-01 1 1  ON 14
 ud_5                -1.682883e-01 1 1  ON 15
 ud_6                -1.821125e-01 1 1  ON 16
 ud_7                -1.593451e-01 1 1  ON 17
 ud_8                -9.897961e-02 1 1  ON 18
 ud_9                -8.723591e-03 1 1  ON 19
 eO_0                -9.174855e-01 1 1  ON 20
 eO_1                -6.001291e-01 1 1  ON 21
 eO_2                -1.935734e-01 1 1  ON 22
 eO_3                 7.519595e-02 1 1  ON 23
 eO_4                 2.048756e-01 1 1  ON 24
 eO_5                 2.941413e-01 1 1  ON 25
 eO_6                 3.342592e-01 1 1  ON 26
 eO_7                 5.025444e-01 1 1  ON 27
 eO_8                 1.934721e-01 1 1  ON 28
 eO_9                 6.096791e-02 1 1  ON 29
eH1_0                -2.103883e-01 1 1  ON 30
eH1_1                -1.317617e-01 1 1  ON 31
eH1_2                -9.059380e-02 1 1  ON 32
eH1_3                -5.395503e-02 1 1  ON 33
eH1_4                -8.180656e-03 1 1  ON 34
eH1_5                 2.440247e-03 1 1  ON 35
eH1_6                 4.105859e-02 1 1  ON 36
eH1_7                 6.457125e-02 1 1  ON 37
eH1_8                 1.798367e-01 1 1  ON 38
eH1_9                 1.208433e-01 1 1  ON 39
eH2_0                -2.055472e-01 1 1  ON 40
eH2_1                -1.281222e-01 1 1  ON 41
eH2_2                -8.660457e-02 1 1  ON 42
eH2_3                -4.951008e-02 1 1  ON 43
eH2_4                -2.920081e-03 1 1  ON 44
eH2_5                 9.625798e-03 1 1  ON 45
eH2_6                 4.690451e-02 1 1  ON 46
eH2_7                 4.542214e-02 1 1  ON 47
eH2_8                 1.982191e-01 1 1  ON 48
eH2_9                 1.199615e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2398
    reference variance = 0.423477
====================================================
  Execution time = 3.9854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4536e-01
  Total weights = 2.0000e+06
  Execution time = 3.6488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345137980057
                                         uncertainty =       0.018461319101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345137980057
                                         uncertainty =       0.018461319101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415410589
  error estimate for blocks of size 2^( 2) =       0.000424274410
  error estimate for blocks of size 2^( 3) =       0.000431912161
  error estimate for blocks of size 2^( 4) =       0.000436860500
  error estimate for blocks of size 2^( 5) =       0.000439895358
  error estimate for blocks of size 2^( 6) =       0.000441209819
  error estimate for blocks of size 2^( 7) =       0.000444503467

      target function =                  N/A
              le_mean =     -17.215667726405
             les_mean =     296.724347008736
             stat err =       0.000440617286
             autocorr =       1.125039928435
              std dev =       0.587479289272
             le_variance =       0.345131915323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345408644826
                                         uncertainty =       0.018476000923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345408644826
                                         uncertainty =       0.018476000923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415573350
  error estimate for blocks of size 2^( 2) =       0.000424431847
  error estimate for blocks of size 2^( 3) =       0.000432060524
  error estimate for blocks of size 2^( 4) =       0.000437008942
  error estimate for blocks of size 2^( 5) =       0.000440047352
  error estimate for blocks of size 2^( 6) =       0.000441376969
  error estimate for blocks of size 2^( 7) =       0.000444671653

      target function =                  N/A
              le_mean =     -17.215670862537
             les_mean =     296.724725493304
             stat err =       0.000440776229
             autocorr =       1.124970026951
              std dev =       0.587709468031
             le_variance =       0.345402418814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345615848660
                                         uncertainty =       0.018483666688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345615848660
                                         uncertainty =       0.018483666688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415698032
  error estimate for blocks of size 2^( 2) =       0.000424555881
  error estimate for blocks of size 2^( 3) =       0.000432176404
  error estimate for blocks of size 2^( 4) =       0.000437120826
  error estimate for blocks of size 2^( 5) =       0.000440157514
  error estimate for blocks of size 2^( 6) =       0.000441498807
  error estimate for blocks of size 2^( 7) =       0.000444798158

      target function =                  N/A
              le_mean =     -17.215676863623
             les_mean =     296.725139407863
             stat err =       0.000440893826
             autocorr =       1.124895288439
              std dev =       0.587885795021
             le_variance =       0.345609707988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345276840658
                                         uncertainty =       0.018470336172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345276840658
                                         uncertainty =       0.018470336172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415494130
  error estimate for blocks of size 2^( 2) =       0.000424355302
  error estimate for blocks of size 2^( 3) =       0.000431986120
  error estimate for blocks of size 2^( 4) =       0.000436931256
  error estimate for blocks of size 2^( 5) =       0.000439963645
  error estimate for blocks of size 2^( 6) =       0.000441286772
  error estimate for blocks of size 2^( 7) =       0.000444580627

      target function =                  N/A
              le_mean =     -17.215669263806
             les_mean =     296.724538771507
             stat err =       0.000440690575
             autocorr =       1.124961709775
              std dev =       0.587597433105
             le_variance =       0.345270743392


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215667726405        initial
     5.9605e-03     5.9605e-02             6.0560e-03       -17.215670862537
     2.3842e-02     2.3842e-01             2.4698e-03       -17.215676863623  <--
     9.5367e-02     9.5367e-01             7.3423e-04       -17.215669263806

*****************************************************************************
Applying the update for shift_i =   2.3842e-02     and shift_s =   2.3842e-01
*****************************************************************************

  Execution time = 5.8212e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.901177e-01 1 1  ON 0
 uu_1                 2.771637e-02 1 1  ON 1
 uu_2                -6.697625e-02 1 1  ON 2
 uu_3                -1.230774e-01 1 1  ON 3
 uu_4                -1.600278e-01 1 1  ON 4
 uu_5                -1.717420e-01 1 1  ON 5
 uu_6                -1.597590e-01 1 1  ON 6
 uu_7                -1.139118e-01 1 1  ON 7
 uu_8                -3.735594e-02 1 1  ON 8
 uu_9                 1.620567e-01 1 1  ON 9
 ud_0                 3.445596e-01 1 1  ON 10
 ud_1                 8.885999e-02 1 1  ON 11
 ud_2                -1.661785e-02 1 1  ON 12
 ud_3                -7.696668e-02 1 1  ON 13
 ud_4                -1.285129e-01 1 1  ON 14
 ud_5                -1.682883e-01 1 1  ON 15
 ud_6                -1.821125e-01 1 1  ON 16
 ud_7                -1.593451e-01 1 1  ON 17
 ud_8                -9.897961e-02 1 1  ON 18
 ud_9                -8.723591e-03 1 1  ON 19
 eO_0                -9.174855e-01 1 1  ON 20
 eO_1                -6.001291e-01 1 1  ON 21
 eO_2                -1.935734e-01 1 1  ON 22
 eO_3                 7.519595e-02 1 1  ON 23
 eO_4                 2.048756e-01 1 1  ON 24
 eO_5                 2.941413e-01 1 1  ON 25
 eO_6                 3.342592e-01 1 1  ON 26
 eO_7                 5.025444e-01 1 1  ON 27
 eO_8                 1.934721e-01 1 1  ON 28
 eO_9                 6.096791e-02 1 1  ON 29
eH1_0                -2.103883e-01 1 1  ON 30
eH1_1                -1.317617e-01 1 1  ON 31
eH1_2                -9.059380e-02 1 1  ON 32
eH1_3                -5.395503e-02 1 1  ON 33
eH1_4                -8.180656e-03 1 1  ON 34
eH1_5                 2.440247e-03 1 1  ON 35
eH1_6                 4.105859e-02 1 1  ON 36
eH1_7                 6.457125e-02 1 1  ON 37
eH1_8                 1.798367e-01 1 1  ON 38
eH1_9                 1.208433e-01 1 1  ON 39
eH2_0                -2.055472e-01 1 1  ON 40
eH2_1                -1.281222e-01 1 1  ON 41
eH2_2                -8.660457e-02 1 1  ON 42
eH2_3                -4.951008e-02 1 1  ON 43
eH2_4                -2.920081e-03 1 1  ON 44
eH2_5                 9.625798e-03 1 1  ON 45
eH2_6                 4.690451e-02 1 1  ON 46
eH2_7                 4.542214e-02 1 1  ON 47
eH2_8                 1.982191e-01 1 1  ON 48
eH2_9                 1.199615e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0985e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2633
    reference variance = 0.246667
====================================================
  Execution time = 4.1426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2737e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0870e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327396787546
                                         uncertainty =       0.006217699927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327396787546
                                         uncertainty =       0.006217699927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404577817
  error estimate for blocks of size 2^( 2) =       0.000413774166
  error estimate for blocks of size 2^( 3) =       0.000422131273
  error estimate for blocks of size 2^( 4) =       0.000428503464
  error estimate for blocks of size 2^( 5) =       0.000433942550
  error estimate for blocks of size 2^( 6) =       0.000436176089
  error estimate for blocks of size 2^( 7) =       0.000440111385

      target function =                  N/A
              le_mean =     -17.216274437489
             les_mean =     296.727471763834
             stat err =       0.000434683372
             autocorr =       1.154361731729
              std dev =       0.572159436333
             le_variance =       0.327366420585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627443749e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-03, overlap shift 5.9605e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216274437489       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216278610328       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216281499625       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216283402658       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216288264897       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216289636182       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216289771662       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216290474624       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216291685010       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216293075687       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216290659639       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216291240929       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216292141004       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216292440207       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216292986297       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216293154569       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216292924893       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216292489375       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216292440861       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-03 is 6.743874e-03

solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216274437489       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216278168491       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216280713744       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216282505763       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216286514817       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216287435026       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216287232144       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216287689010       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216288469253       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216289252492       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216287590939       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216288094677       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216288537128       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216288671564       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216288627205       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 2.788680e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216274437489       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216277058427       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216278848317       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216280335888       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216282603982       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216282768855       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216282341878       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216282537169       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216282858383       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216283008665       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.265917e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.649232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2313e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.890383e-01 1 1  ON 0
 uu_1                 2.689558e-02 1 1  ON 1
 uu_2                -6.775588e-02 1 1  ON 2
 uu_3                -1.238094e-01 1 1  ON 3
 uu_4                -1.600959e-01 1 1  ON 4
 uu_5                -1.727423e-01 1 1  ON 5
 uu_6                -1.592083e-01 1 1  ON 6
 uu_7                -1.125551e-01 1 1  ON 7
 uu_8                -3.585739e-02 1 1  ON 8
 uu_9                 1.617615e-01 1 1  ON 9
 ud_0                 3.443267e-01 1 1  ON 10
 ud_1                 8.846098e-02 1 1  ON 11
 ud_2                -1.705345e-02 1 1  ON 12
 ud_3                -7.741652e-02 1 1  ON 13
 ud_4                -1.291427e-01 1 1  ON 14
 ud_5                -1.689774e-01 1 1  ON 15
 ud_6                -1.821690e-01 1 1  ON 16
 ud_7                -1.584414e-01 1 1  ON 17
 ud_8                -9.869792e-02 1 1  ON 18
 ud_9                -7.990485e-03 1 1  ON 19
 eO_0                -9.171184e-01 1 1  ON 20
 eO_1                -6.000329e-01 1 1  ON 21
 eO_2                -1.940512e-01 1 1  ON 22
 eO_3                 7.411139e-02 1 1  ON 23
 eO_4                 2.034795e-01 1 1  ON 24
 eO_5                 2.949572e-01 1 1  ON 25
 eO_6                 3.346049e-01 1 1  ON 26
 eO_7                 5.026147e-01 1 1  ON 27
 eO_8                 1.943671e-01 1 1  ON 28
 eO_9                 6.126656e-02 1 1  ON 29
eH1_0                -2.120527e-01 1 1  ON 30
eH1_1                -1.337091e-01 1 1  ON 31
eH1_2                -9.222174e-02 1 1  ON 32
eH1_3                -5.506385e-02 1 1  ON 33
eH1_4                -8.331809e-03 1 1  ON 34
eH1_5                 4.899890e-03 1 1  ON 35
eH1_6                 4.384727e-02 1 1  ON 36
eH1_7                 6.498444e-02 1 1  ON 37
eH1_8                 1.800687e-01 1 1  ON 38
eH1_9                 1.211094e-01 1 1  ON 39
eH2_0                -2.063007e-01 1 1  ON 40
eH2_1                -1.283677e-01 1 1  ON 41
eH2_2                -8.746852e-02 1 1  ON 42
eH2_3                -5.016093e-02 1 1  ON 43
eH2_4                -3.656165e-03 1 1  ON 44
eH2_5                 9.362512e-03 1 1  ON 45
eH2_6                 4.795822e-02 1 1  ON 46
eH2_7                 4.754890e-02 1 1  ON 47
eH2_8                 1.982902e-01 1 1  ON 48
eH2_9                 1.200315e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1387
    reference variance = 0.417817
====================================================
  Execution time = 4.0639e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2057e-01
  Total weights = 2.0000e+06
  Execution time = 3.6505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320488501458
                                         uncertainty =       0.003947617877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320488501458
                                         uncertainty =       0.003947617877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400297681
  error estimate for blocks of size 2^( 2) =       0.000409945572
  error estimate for blocks of size 2^( 3) =       0.000417945236
  error estimate for blocks of size 2^( 4) =       0.000423932505
  error estimate for blocks of size 2^( 5) =       0.000428451029
  error estimate for blocks of size 2^( 6) =       0.000431608104
  error estimate for blocks of size 2^( 7) =       0.000435437073

      target function =                  N/A
              le_mean =     -17.216513515287
             les_mean =     296.728813928351
             stat err =       0.000429857178
             autocorr =       1.153140479502
              std dev =       0.566106409194
             le_variance =       0.320476466530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320549050427
                                         uncertainty =       0.003948581831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320549050427
                                         uncertainty =       0.003948581831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400335433
  error estimate for blocks of size 2^( 2) =       0.000409982171
  error estimate for blocks of size 2^( 3) =       0.000417980073
  error estimate for blocks of size 2^( 4) =       0.000423955746
  error estimate for blocks of size 2^( 5) =       0.000428480084
  error estimate for blocks of size 2^( 6) =       0.000431642981
  error estimate for blocks of size 2^( 7) =       0.000435473581

      target function =                  N/A
              le_mean =     -17.216503602963
             les_mean =     296.728533068753
             stat err =       0.000429888098
             autocorr =       1.153088874253
              std dev =       0.566159799161
             le_variance =       0.320536918186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690649970
                                         uncertainty =       0.003949235292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690649970
                                         uncertainty =       0.003949235292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400423864
  error estimate for blocks of size 2^( 2) =       0.000410067029
  error estimate for blocks of size 2^( 3) =       0.000418063460
  error estimate for blocks of size 2^( 4) =       0.000424035106
  error estimate for blocks of size 2^( 5) =       0.000428559495
  error estimate for blocks of size 2^( 6) =       0.000431737093
  error estimate for blocks of size 2^( 7) =       0.000435569389

      target function =                  N/A
              le_mean =     -17.216503186741
             les_mean =     296.728660360904
             stat err =       0.000429975270
             autocorr =       1.153047110187
              std dev =       0.566284859566
             le_variance =       0.320678542174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320599100639
                                         uncertainty =       0.003948408972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320599100639
                                         uncertainty =       0.003948408972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400366738
  error estimate for blocks of size 2^( 2) =       0.000410009935
  error estimate for blocks of size 2^( 3) =       0.000418005721
  error estimate for blocks of size 2^( 4) =       0.000423985917
  error estimate for blocks of size 2^( 5) =       0.000428503212
  error estimate for blocks of size 2^( 6) =       0.000431666585
  error estimate for blocks of size 2^( 7) =       0.000435494749

      target function =                  N/A
              le_mean =     -17.216507061178
             les_mean =     296.728702277261
             stat err =       0.000429912616
             autocorr =       1.153040070593
              std dev =       0.566204070947
             le_variance =       0.320587049957


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216513515287        initial  <--
     5.9605e-03     5.9605e-02             6.7439e-03       -17.216503602963
     2.3842e-02     2.3842e-01             2.7887e-03       -17.216503186741
     9.5367e-02     9.5367e-01             1.2659e-03       -17.216507061178

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.0436
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.901177e-01 1 1  ON 0
 uu_1                 2.771637e-02 1 1  ON 1
 uu_2                -6.697625e-02 1 1  ON 2
 uu_3                -1.230774e-01 1 1  ON 3
 uu_4                -1.600278e-01 1 1  ON 4
 uu_5                -1.717420e-01 1 1  ON 5
 uu_6                -1.597590e-01 1 1  ON 6
 uu_7                -1.139118e-01 1 1  ON 7
 uu_8                -3.735594e-02 1 1  ON 8
 uu_9                 1.620567e-01 1 1  ON 9
 ud_0                 3.445596e-01 1 1  ON 10
 ud_1                 8.885999e-02 1 1  ON 11
 ud_2                -1.661785e-02 1 1  ON 12
 ud_3                -7.696668e-02 1 1  ON 13
 ud_4                -1.285129e-01 1 1  ON 14
 ud_5                -1.682883e-01 1 1  ON 15
 ud_6                -1.821125e-01 1 1  ON 16
 ud_7                -1.593451e-01 1 1  ON 17
 ud_8                -9.897961e-02 1 1  ON 18
 ud_9                -8.723591e-03 1 1  ON 19
 eO_0                -9.174855e-01 1 1  ON 20
 eO_1                -6.001291e-01 1 1  ON 21
 eO_2                -1.935734e-01 1 1  ON 22
 eO_3                 7.519595e-02 1 1  ON 23
 eO_4                 2.048756e-01 1 1  ON 24
 eO_5                 2.941413e-01 1 1  ON 25
 eO_6                 3.342592e-01 1 1  ON 26
 eO_7                 5.025444e-01 1 1  ON 27
 eO_8                 1.934721e-01 1 1  ON 28
 eO_9                 6.096791e-02 1 1  ON 29
eH1_0                -2.103883e-01 1 1  ON 30
eH1_1                -1.317617e-01 1 1  ON 31
eH1_2                -9.059380e-02 1 1  ON 32
eH1_3                -5.395503e-02 1 1  ON 33
eH1_4                -8.180656e-03 1 1  ON 34
eH1_5                 2.440247e-03 1 1  ON 35
eH1_6                 4.105859e-02 1 1  ON 36
eH1_7                 6.457125e-02 1 1  ON 37
eH1_8                 1.798367e-01 1 1  ON 38
eH1_9                 1.208433e-01 1 1  ON 39
eH2_0                -2.055472e-01 1 1  ON 40
eH2_1                -1.281222e-01 1 1  ON 41
eH2_2                -8.660457e-02 1 1  ON 42
eH2_3                -4.951008e-02 1 1  ON 43
eH2_4                -2.920081e-03 1 1  ON 44
eH2_5                 9.625798e-03 1 1  ON 45
eH2_6                 4.690451e-02 1 1  ON 46
eH2_7                 4.542214e-02 1 1  ON 47
eH2_8                 1.982191e-01 1 1  ON 48
eH2_9                 1.199615e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1136e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2949
    reference variance = 0.162895
====================================================
  Execution time = 4.0666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1575e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0950e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315823015912
                                         uncertainty =       0.002912941322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315823015912
                                         uncertainty =       0.002912941322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397335342
  error estimate for blocks of size 2^( 2) =       0.000406835566
  error estimate for blocks of size 2^( 3) =       0.000415142198
  error estimate for blocks of size 2^( 4) =       0.000420795837
  error estimate for blocks of size 2^( 5) =       0.000423811146
  error estimate for blocks of size 2^( 6) =       0.000426416413
  error estimate for blocks of size 2^( 7) =       0.000427120424

      target function =                  N/A
              le_mean =     -17.216660210097
             les_mean =     296.729139379718
             stat err =       0.000424535955
             autocorr =       1.141601584977
              std dev =       0.561917029167
             le_variance =       0.315750747668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666021010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660210097       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216656374582       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216655562958       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216654891248       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216655018668       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216655778982       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216655141674       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216655372977       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216655629560       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216655739630       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 1.067440e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660210097       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216657790844       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216656870967       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216656417853       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216656451964       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216656629127       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216656198557       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216656231806       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216656294838       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 4.289241e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660210097       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216659233409       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216658623478       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216658410514       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216658344398       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216658283331       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216658131323       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.559923e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.653317 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1626e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.899301e-01 1 1  ON 0
 uu_1                 2.785995e-02 1 1  ON 1
 uu_2                -6.680918e-02 1 1  ON 2
 uu_3                -1.232183e-01 1 1  ON 3
 uu_4                -1.601136e-01 1 1  ON 4
 uu_5                -1.719332e-01 1 1  ON 5
 uu_6                -1.595648e-01 1 1  ON 6
 uu_7                -1.139579e-01 1 1  ON 7
 uu_8                -3.729498e-02 1 1  ON 8
 uu_9                 1.620480e-01 1 1  ON 9
 ud_0                 3.444906e-01 1 1  ON 10
 ud_1                 8.891195e-02 1 1  ON 11
 ud_2                -1.676447e-02 1 1  ON 12
 ud_3                -7.698689e-02 1 1  ON 13
 ud_4                -1.286039e-01 1 1  ON 14
 ud_5                -1.679979e-01 1 1  ON 15
 ud_6                -1.820692e-01 1 1  ON 16
 ud_7                -1.593383e-01 1 1  ON 17
 ud_8                -9.912023e-02 1 1  ON 18
 ud_9                -8.729627e-03 1 1  ON 19
 eO_0                -9.176518e-01 1 1  ON 20
 eO_1                -6.000975e-01 1 1  ON 21
 eO_2                -1.933207e-01 1 1  ON 22
 eO_3                 7.516291e-02 1 1  ON 23
 eO_4                 2.047402e-01 1 1  ON 24
 eO_5                 2.941149e-01 1 1  ON 25
 eO_6                 3.343110e-01 1 1  ON 26
 eO_7                 5.024919e-01 1 1  ON 27
 eO_8                 1.935222e-01 1 1  ON 28
 eO_9                 6.098925e-02 1 1  ON 29
eH1_0                -2.105681e-01 1 1  ON 30
eH1_1                -1.319133e-01 1 1  ON 31
eH1_2                -9.088729e-02 1 1  ON 32
eH1_3                -5.416546e-02 1 1  ON 33
eH1_4                -7.751732e-03 1 1  ON 34
eH1_5                 2.768889e-03 1 1  ON 35
eH1_6                 4.110256e-02 1 1  ON 36
eH1_7                 6.453121e-02 1 1  ON 37
eH1_8                 1.798687e-01 1 1  ON 38
eH1_9                 1.208631e-01 1 1  ON 39
eH2_0                -2.057011e-01 1 1  ON 40
eH2_1                -1.280126e-01 1 1  ON 41
eH2_2                -8.659143e-02 1 1  ON 42
eH2_3                -4.954312e-02 1 1  ON 43
eH2_4                -2.896885e-03 1 1  ON 44
eH2_5                 9.445012e-03 1 1  ON 45
eH2_6                 4.699346e-02 1 1  ON 46
eH2_7                 4.553082e-02 1 1  ON 47
eH2_8                 1.982089e-01 1 1  ON 48
eH2_9                 1.199810e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2592
    reference variance = 0.256284
====================================================
  Execution time = 3.9934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2475e-01
  Total weights = 2.0000e+06
  Execution time = 3.6477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324680337826
                                         uncertainty =       0.004444322884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324680337826
                                         uncertainty =       0.004444322884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402960670
  error estimate for blocks of size 2^( 2) =       0.000412575750
  error estimate for blocks of size 2^( 3) =       0.000420833556
  error estimate for blocks of size 2^( 4) =       0.000427378430
  error estimate for blocks of size 2^( 5) =       0.000431024760
  error estimate for blocks of size 2^( 6) =       0.000432679861
  error estimate for blocks of size 2^( 7) =       0.000435971845

      target function =                  N/A
              le_mean =     -17.217209665078
             les_mean =     296.757063092392
             stat err =       0.000431763724
             autocorr =       1.148066332551
              std dev =       0.569872444961
             le_variance =       0.324754603526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324744349449
                                         uncertainty =       0.004447565285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324744349449
                                         uncertainty =       0.004447565285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403000450
  error estimate for blocks of size 2^( 2) =       0.000412610714
  error estimate for blocks of size 2^( 3) =       0.000420863219
  error estimate for blocks of size 2^( 4) =       0.000427397894
  error estimate for blocks of size 2^( 5) =       0.000431047151
  error estimate for blocks of size 2^( 6) =       0.000432698944
  error estimate for blocks of size 2^( 7) =       0.000436011498

      target function =                  N/A
              le_mean =     -17.217210825591
             les_mean =     296.757167176363
             stat err =       0.000431788872
             autocorr =       1.147973406832
              std dev =       0.569928702485
             le_variance =       0.324818725916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324682774804
                                         uncertainty =       0.004447568756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324682774804
                                         uncertainty =       0.004447568756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402962279
  error estimate for blocks of size 2^( 2) =       0.000412571371
  error estimate for blocks of size 2^( 3) =       0.000420823761
  error estimate for blocks of size 2^( 4) =       0.000427355887
  error estimate for blocks of size 2^( 5) =       0.000431006512
  error estimate for blocks of size 2^( 6) =       0.000432657889
  error estimate for blocks of size 2^( 7) =       0.000435977640

      target function =                  N/A
              le_mean =     -17.217211648235
             les_mean =     296.757133973859
             stat err =       0.000431749482
             autocorr =       1.147981428773
              std dev =       0.569874719668
             le_variance =       0.324757196117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324661386051
                                         uncertainty =       0.004444851808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324661386051
                                         uncertainty =       0.004444851808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402948935
  error estimate for blocks of size 2^( 2) =       0.000412562688
  error estimate for blocks of size 2^( 3) =       0.000420819261
  error estimate for blocks of size 2^( 4) =       0.000427361328
  error estimate for blocks of size 2^( 5) =       0.000431008779
  error estimate for blocks of size 2^( 6) =       0.000432663296
  error estimate for blocks of size 2^( 7) =       0.000435961450

      target function =                  N/A
              le_mean =     -17.217209578075
             les_mean =     296.757041181605
             stat err =       0.000431748713
             autocorr =       1.148053373554
              std dev =       0.569855848984
             le_variance =       0.324735688621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217209665078        initial
     5.9605e-02     5.9605e-01             1.0674e-03       -17.217210825591
     2.3842e-01     2.3842e+00             4.2892e-04       -17.217211648235  <--
     9.5367e-01     9.5367e+00             1.5599e-04       -17.217209578075

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 5.8341e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.899301e-01 1 1  ON 0
 uu_1                 2.785995e-02 1 1  ON 1
 uu_2                -6.680918e-02 1 1  ON 2
 uu_3                -1.232183e-01 1 1  ON 3
 uu_4                -1.601136e-01 1 1  ON 4
 uu_5                -1.719332e-01 1 1  ON 5
 uu_6                -1.595648e-01 1 1  ON 6
 uu_7                -1.139579e-01 1 1  ON 7
 uu_8                -3.729498e-02 1 1  ON 8
 uu_9                 1.620480e-01 1 1  ON 9
 ud_0                 3.444906e-01 1 1  ON 10
 ud_1                 8.891195e-02 1 1  ON 11
 ud_2                -1.676447e-02 1 1  ON 12
 ud_3                -7.698689e-02 1 1  ON 13
 ud_4                -1.286039e-01 1 1  ON 14
 ud_5                -1.679979e-01 1 1  ON 15
 ud_6                -1.820692e-01 1 1  ON 16
 ud_7                -1.593383e-01 1 1  ON 17
 ud_8                -9.912023e-02 1 1  ON 18
 ud_9                -8.729627e-03 1 1  ON 19
 eO_0                -9.176518e-01 1 1  ON 20
 eO_1                -6.000975e-01 1 1  ON 21
 eO_2                -1.933207e-01 1 1  ON 22
 eO_3                 7.516291e-02 1 1  ON 23
 eO_4                 2.047402e-01 1 1  ON 24
 eO_5                 2.941149e-01 1 1  ON 25
 eO_6                 3.343110e-01 1 1  ON 26
 eO_7                 5.024919e-01 1 1  ON 27
 eO_8                 1.935222e-01 1 1  ON 28
 eO_9                 6.098925e-02 1 1  ON 29
eH1_0                -2.105681e-01 1 1  ON 30
eH1_1                -1.319133e-01 1 1  ON 31
eH1_2                -9.088729e-02 1 1  ON 32
eH1_3                -5.416546e-02 1 1  ON 33
eH1_4                -7.751732e-03 1 1  ON 34
eH1_5                 2.768889e-03 1 1  ON 35
eH1_6                 4.110256e-02 1 1  ON 36
eH1_7                 6.453121e-02 1 1  ON 37
eH1_8                 1.798687e-01 1 1  ON 38
eH1_9                 1.208631e-01 1 1  ON 39
eH2_0                -2.057011e-01 1 1  ON 40
eH2_1                -1.280126e-01 1 1  ON 41
eH2_2                -8.659143e-02 1 1  ON 42
eH2_3                -4.954312e-02 1 1  ON 43
eH2_4                -2.896885e-03 1 1  ON 44
eH2_5                 9.445012e-03 1 1  ON 45
eH2_6                 4.699346e-02 1 1  ON 46
eH2_7                 4.553082e-02 1 1  ON 47
eH2_8                 1.982089e-01 1 1  ON 48
eH2_9                 1.199810e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0997e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2031
    reference variance = 0.180937
====================================================
  Execution time = 4.0555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2627e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0936e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326282893692
                                         uncertainty =       0.005084853238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326282893692
                                         uncertainty =       0.005084853238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403899606
  error estimate for blocks of size 2^( 2) =       0.000413207554
  error estimate for blocks of size 2^( 3) =       0.000421597179
  error estimate for blocks of size 2^( 4) =       0.000427849134
  error estimate for blocks of size 2^( 5) =       0.000431063045
  error estimate for blocks of size 2^( 6) =       0.000434864149
  error estimate for blocks of size 2^( 7) =       0.000434290173

      target function =                  N/A
              le_mean =     -17.216593865669
             les_mean =     296.737373956099
             stat err =       0.000432016625
             autocorr =       1.144073852184
              std dev =       0.571200300968
             le_variance =       0.326269783826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659386567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216593865669       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216592561096       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216594065799       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216594426488       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216594552676       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216594359580       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216594535799       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216594555710       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216594619382       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216594324548       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216594269675       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 1.114277e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216593865669       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216593115337       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216594076595       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216594154928       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216594189523       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216594165966       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216594339566       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216594312025       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 5.134943e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216593865669       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216593587705       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216593934015       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216593959838       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216593940403       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216593978353       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216594006078       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.647463e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.657590 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1501e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.899308e-01 1 1  ON 0
 uu_1                 2.782267e-02 1 1  ON 1
 uu_2                -6.682491e-02 1 1  ON 2
 uu_3                -1.230976e-01 1 1  ON 3
 uu_4                -1.599472e-01 1 1  ON 4
 uu_5                -1.722638e-01 1 1  ON 5
 uu_6                -1.596524e-01 1 1  ON 6
 uu_7                -1.139977e-01 1 1  ON 7
 uu_8                -3.722568e-02 1 1  ON 8
 uu_9                 1.620532e-01 1 1  ON 9
 ud_0                 3.444745e-01 1 1  ON 10
 ud_1                 8.866169e-02 1 1  ON 11
 ud_2                -1.686633e-02 1 1  ON 12
 ud_3                -7.700400e-02 1 1  ON 13
 ud_4                -1.285438e-01 1 1  ON 14
 ud_5                -1.678228e-01 1 1  ON 15
 ud_6                -1.820161e-01 1 1  ON 16
 ud_7                -1.593824e-01 1 1  ON 17
 ud_8                -9.914603e-02 1 1  ON 18
 ud_9                -8.646902e-03 1 1  ON 19
 eO_0                -9.174110e-01 1 1  ON 20
 eO_1                -5.998462e-01 1 1  ON 21
 eO_2                -1.933540e-01 1 1  ON 22
 eO_3                 7.464942e-02 1 1  ON 23
 eO_4                 2.046923e-01 1 1  ON 24
 eO_5                 2.942353e-01 1 1  ON 25
 eO_6                 3.341911e-01 1 1  ON 26
 eO_7                 5.024662e-01 1 1  ON 27
 eO_8                 1.936068e-01 1 1  ON 28
 eO_9                 6.102691e-02 1 1  ON 29
eH1_0                -2.104574e-01 1 1  ON 30
eH1_1                -1.320149e-01 1 1  ON 31
eH1_2                -9.096313e-02 1 1  ON 32
eH1_3                -5.422542e-02 1 1  ON 33
eH1_4                -7.882261e-03 1 1  ON 34
eH1_5                 3.081688e-03 1 1  ON 35
eH1_6                 4.113677e-02 1 1  ON 36
eH1_7                 6.436572e-02 1 1  ON 37
eH1_8                 1.798810e-01 1 1  ON 38
eH1_9                 1.208979e-01 1 1  ON 39
eH2_0                -2.057318e-01 1 1  ON 40
eH2_1                -1.277847e-01 1 1  ON 41
eH2_2                -8.660441e-02 1 1  ON 42
eH2_3                -4.949993e-02 1 1  ON 43
eH2_4                -3.181519e-03 1 1  ON 44
eH2_5                 9.126473e-03 1 1  ON 45
eH2_6                 4.713861e-02 1 1  ON 46
eH2_7                 4.568118e-02 1 1  ON 47
eH2_8                 1.982296e-01 1 1  ON 48
eH2_9                 1.200160e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2528
    reference variance = 0.194595
====================================================
  Execution time = 4.0947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2231e-01
  Total weights = 2.0000e+06
  Execution time = 3.6469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322223927493
                                         uncertainty =       0.003491035401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322223927493
                                         uncertainty =       0.003491035401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401380304
  error estimate for blocks of size 2^( 2) =       0.000410854892
  error estimate for blocks of size 2^( 3) =       0.000418861841
  error estimate for blocks of size 2^( 4) =       0.000424367279
  error estimate for blocks of size 2^( 5) =       0.000427816335
  error estimate for blocks of size 2^( 6) =       0.000430128106
  error estimate for blocks of size 2^( 7) =       0.000431619604

      target function =                  N/A
              le_mean =     -17.216814511954
             les_mean =     296.740914074099
             stat err =       0.000428482831
             autocorr =       1.139606021499
              std dev =       0.567637468975
             le_variance =       0.322212296184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322236729791
                                         uncertainty =       0.003493190746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322236729791
                                         uncertainty =       0.003493190746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401388305
  error estimate for blocks of size 2^( 2) =       0.000410859897
  error estimate for blocks of size 2^( 3) =       0.000418869254
  error estimate for blocks of size 2^( 4) =       0.000424380933
  error estimate for blocks of size 2^( 5) =       0.000427828066
  error estimate for blocks of size 2^( 6) =       0.000430143200
  error estimate for blocks of size 2^( 7) =       0.000431644139

      target function =                  N/A
              le_mean =     -17.216819144588
             les_mean =     296.741086439910
             stat err =       0.000428499084
             autocorr =       1.139647038044
              std dev =       0.567648785406
             le_variance =       0.322225143573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322416515038
                                         uncertainty =       0.003495986969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322416515038
                                         uncertainty =       0.003495986969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401500290
  error estimate for blocks of size 2^( 2) =       0.000410968138
  error estimate for blocks of size 2^( 3) =       0.000418975045
  error estimate for blocks of size 2^( 4) =       0.000424486964
  error estimate for blocks of size 2^( 5) =       0.000427933310
  error estimate for blocks of size 2^( 6) =       0.000430250662
  error estimate for blocks of size 2^( 7) =       0.000431748312

      target function =                  N/A
              le_mean =     -17.216819733158
             les_mean =     296.741286528556
             stat err =       0.000428604812
             autocorr =       1.139573546288
              std dev =       0.567807155385
             le_variance =       0.322404965706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322301078760
                                         uncertainty =       0.003492496419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322301078760
                                         uncertainty =       0.003492496419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401428364
  error estimate for blocks of size 2^( 2) =       0.000410900749
  error estimate for blocks of size 2^( 3) =       0.000418907108
  error estimate for blocks of size 2^( 4) =       0.000424413508
  error estimate for blocks of size 2^( 5) =       0.000427861545
  error estimate for blocks of size 2^( 6) =       0.000430174956
  error estimate for blocks of size 2^( 7) =       0.000431666950

      target function =                  N/A
              le_mean =     -17.216815525114
             les_mean =     296.741026128249
             stat err =       0.000428529240
             autocorr =       1.139579974343
              std dev =       0.567705437327
             le_variance =       0.322289463571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216814511954        initial
     5.9605e-02     5.9605e-01             1.1143e-03       -17.216819144588
     2.3842e-01     2.3842e+00             5.1349e-04       -17.216819733158  <--
     9.5367e-01     9.5367e+00             1.6475e-04       -17.216815525114

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 5.9297e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.899308e-01 1 1  ON 0
 uu_1                 2.782267e-02 1 1  ON 1
 uu_2                -6.682491e-02 1 1  ON 2
 uu_3                -1.230976e-01 1 1  ON 3
 uu_4                -1.599472e-01 1 1  ON 4
 uu_5                -1.722638e-01 1 1  ON 5
 uu_6                -1.596524e-01 1 1  ON 6
 uu_7                -1.139977e-01 1 1  ON 7
 uu_8                -3.722568e-02 1 1  ON 8
 uu_9                 1.620532e-01 1 1  ON 9
 ud_0                 3.444745e-01 1 1  ON 10
 ud_1                 8.866169e-02 1 1  ON 11
 ud_2                -1.686633e-02 1 1  ON 12
 ud_3                -7.700400e-02 1 1  ON 13
 ud_4                -1.285438e-01 1 1  ON 14
 ud_5                -1.678228e-01 1 1  ON 15
 ud_6                -1.820161e-01 1 1  ON 16
 ud_7                -1.593824e-01 1 1  ON 17
 ud_8                -9.914603e-02 1 1  ON 18
 ud_9                -8.646902e-03 1 1  ON 19
 eO_0                -9.174110e-01 1 1  ON 20
 eO_1                -5.998462e-01 1 1  ON 21
 eO_2                -1.933540e-01 1 1  ON 22
 eO_3                 7.464942e-02 1 1  ON 23
 eO_4                 2.046923e-01 1 1  ON 24
 eO_5                 2.942353e-01 1 1  ON 25
 eO_6                 3.341911e-01 1 1  ON 26
 eO_7                 5.024662e-01 1 1  ON 27
 eO_8                 1.936068e-01 1 1  ON 28
 eO_9                 6.102691e-02 1 1  ON 29
eH1_0                -2.104574e-01 1 1  ON 30
eH1_1                -1.320149e-01 1 1  ON 31
eH1_2                -9.096313e-02 1 1  ON 32
eH1_3                -5.422542e-02 1 1  ON 33
eH1_4                -7.882261e-03 1 1  ON 34
eH1_5                 3.081688e-03 1 1  ON 35
eH1_6                 4.113677e-02 1 1  ON 36
eH1_7                 6.436572e-02 1 1  ON 37
eH1_8                 1.798810e-01 1 1  ON 38
eH1_9                 1.208979e-01 1 1  ON 39
eH2_0                -2.057318e-01 1 1  ON 40
eH2_1                -1.277847e-01 1 1  ON 41
eH2_2                -8.660441e-02 1 1  ON 42
eH2_3                -4.949993e-02 1 1  ON 43
eH2_4                -3.181519e-03 1 1  ON 44
eH2_5                 9.126473e-03 1 1  ON 45
eH2_6                 4.713861e-02 1 1  ON 46
eH2_7                 4.568118e-02 1 1  ON 47
eH2_8                 1.982296e-01 1 1  ON 48
eH2_9                 1.200160e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1080e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2166
    reference variance = 0.162575
====================================================
  Execution time = 4.1777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2604e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0895e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325797929919
                                         uncertainty =       0.005585103510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325797929919
                                         uncertainty =       0.005585103510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403757591
  error estimate for blocks of size 2^( 2) =       0.000413286520
  error estimate for blocks of size 2^( 3) =       0.000421548078
  error estimate for blocks of size 2^( 4) =       0.000427902066
  error estimate for blocks of size 2^( 5) =       0.000431422990
  error estimate for blocks of size 2^( 6) =       0.000432399451
  error estimate for blocks of size 2^( 7) =       0.000432968721

      target function =                  N/A
              le_mean =     -17.215650491709
             les_mean =     296.704662073991
             stat err =       0.000431173307
             autocorr =       1.140413456167
              std dev =       0.570999460882
             le_variance =       0.326040384328


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721565049171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215650491709       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215650613251       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215649216486       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215649989068       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215650093519       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215650502429       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215650531628       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215650056116       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215650337203       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215650710875       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215651518545       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 1.326143e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215650491709       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215650569335       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215649568923       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215649848384       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215650164030       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215650257519       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215650356173       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215650137070       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 4.720016e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215650491709       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215650523454       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215650063987       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215650068807       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215650239527       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215650275579       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215650310291       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.406364e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.661927 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2682e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.901255e-01 1 1  ON 0
 uu_1                 2.761546e-02 1 1  ON 1
 uu_2                -6.707638e-02 1 1  ON 2
 uu_3                -1.231916e-01 1 1  ON 3
 uu_4                -1.600064e-01 1 1  ON 4
 uu_5                -1.724139e-01 1 1  ON 5
 uu_6                -1.595145e-01 1 1  ON 6
 uu_7                -1.138606e-01 1 1  ON 7
 uu_8                -3.712247e-02 1 1  ON 8
 uu_9                 1.620726e-01 1 1  ON 9
 ud_0                 3.445568e-01 1 1  ON 10
 ud_1                 8.869154e-02 1 1  ON 11
 ud_2                -1.705693e-02 1 1  ON 12
 ud_3                -7.706442e-02 1 1  ON 13
 ud_4                -1.286045e-01 1 1  ON 14
 ud_5                -1.681810e-01 1 1  ON 15
 ud_6                -1.818183e-01 1 1  ON 16
 ud_7                -1.592651e-01 1 1  ON 17
 ud_8                -9.908249e-02 1 1  ON 18
 ud_9                -8.575698e-03 1 1  ON 19
 eO_0                -9.171209e-01 1 1  ON 20
 eO_1                -5.998332e-01 1 1  ON 21
 eO_2                -1.933827e-01 1 1  ON 22
 eO_3                 7.434144e-02 1 1  ON 23
 eO_4                 2.043570e-01 1 1  ON 24
 eO_5                 2.943239e-01 1 1  ON 25
 eO_6                 3.343608e-01 1 1  ON 26
 eO_7                 5.024716e-01 1 1  ON 27
 eO_8                 1.936620e-01 1 1  ON 28
 eO_9                 6.106191e-02 1 1  ON 29
eH1_0                -2.104558e-01 1 1  ON 30
eH1_1                -1.323125e-01 1 1  ON 31
eH1_2                -9.111441e-02 1 1  ON 32
eH1_3                -5.396447e-02 1 1  ON 33
eH1_4                -7.977231e-03 1 1  ON 34
eH1_5                 3.178449e-03 1 1  ON 35
eH1_6                 4.118211e-02 1 1  ON 36
eH1_7                 6.443715e-02 1 1  ON 37
eH1_8                 1.799136e-01 1 1  ON 38
eH1_9                 1.209096e-01 1 1  ON 39
eH2_0                -2.059978e-01 1 1  ON 40
eH2_1                -1.275776e-01 1 1  ON 41
eH2_2                -8.644598e-02 1 1  ON 42
eH2_3                -4.965395e-02 1 1  ON 43
eH2_4                -3.004352e-03 1 1  ON 44
eH2_5                 8.654472e-03 1 1  ON 45
eH2_6                 4.715927e-02 1 1  ON 46
eH2_7                 4.593597e-02 1 1  ON 47
eH2_8                 1.982449e-01 1 1  ON 48
eH2_9                 1.200413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2504
    reference variance = 0.356734
====================================================
  Execution time = 3.9570e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2954e-01
  Total weights = 2.0000e+06
  Execution time = 3.6647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329232519234
                                         uncertainty =       0.007977849147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329232519234
                                         uncertainty =       0.007977849147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405782735
  error estimate for blocks of size 2^( 2) =       0.000414919712
  error estimate for blocks of size 2^( 3) =       0.000423166993
  error estimate for blocks of size 2^( 4) =       0.000428784823
  error estimate for blocks of size 2^( 5) =       0.000432823904
  error estimate for blocks of size 2^( 6) =       0.000435039368
  error estimate for blocks of size 2^( 7) =       0.000436547659

      target function =                  N/A
              le_mean =     -17.216452010484
             les_mean =     296.735538920419
             stat err =       0.000433298939
             autocorr =       1.140218598533
              std dev =       0.573863446974
             le_variance =       0.329319255773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329442934906
                                         uncertainty =       0.007989766474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329442934906
                                         uncertainty =       0.007989766474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405912388
  error estimate for blocks of size 2^( 2) =       0.000415044004
  error estimate for blocks of size 2^( 3) =       0.000423287552
  error estimate for blocks of size 2^( 4) =       0.000428901430
  error estimate for blocks of size 2^( 5) =       0.000432932984
  error estimate for blocks of size 2^( 6) =       0.000435148825
  error estimate for blocks of size 2^( 7) =       0.000436663740

      target function =                  N/A
              le_mean =     -17.216454723533
             les_mean =     296.735842815889
             stat err =       0.000433411745
             autocorr =       1.140083710230
              std dev =       0.574046804022
             le_variance =       0.329529733208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329683005158
                                         uncertainty =       0.007991867798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329683005158
                                         uncertainty =       0.007991867798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406060316
  error estimate for blocks of size 2^( 2) =       0.000415187722
  error estimate for blocks of size 2^( 3) =       0.000423427023
  error estimate for blocks of size 2^( 4) =       0.000429037369
  error estimate for blocks of size 2^( 5) =       0.000433066526
  error estimate for blocks of size 2^( 6) =       0.000435280313
  error estimate for blocks of size 2^( 7) =       0.000436796682

      target function =                  N/A
              le_mean =     -17.216455769954
             les_mean =     296.736119073666
             stat err =       0.000433545222
             autocorr =       1.139955015875
              std dev =       0.574256005422
             le_variance =       0.329769959764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329340038093
                                         uncertainty =       0.007980333204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329340038093
                                         uncertainty =       0.007980333204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405848996
  error estimate for blocks of size 2^( 2) =       0.000414983367
  error estimate for blocks of size 2^( 3) =       0.000423228360
  error estimate for blocks of size 2^( 4) =       0.000428844269
  error estimate for blocks of size 2^( 5) =       0.000432881309
  error estimate for blocks of size 2^( 6) =       0.000435096795
  error estimate for blocks of size 2^( 7) =       0.000436605828

      target function =                  N/A
              le_mean =     -17.216452280891
             les_mean =     296.735655790511
             stat err =       0.000433357050
             autocorr =       1.140152074063
              std dev =       0.573957154346
             le_variance =       0.329426815025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216452010484        initial
     5.9605e-02     5.9605e-01             1.3261e-03       -17.216454723533
     2.3842e-01     2.3842e+00             4.7200e-04       -17.216455769954  <--
     9.5367e-01     9.5367e+00             1.4064e-04       -17.216452280891

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 5.8007e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.901255e-01 1 1  ON 0
 uu_1                 2.761546e-02 1 1  ON 1
 uu_2                -6.707638e-02 1 1  ON 2
 uu_3                -1.231916e-01 1 1  ON 3
 uu_4                -1.600064e-01 1 1  ON 4
 uu_5                -1.724139e-01 1 1  ON 5
 uu_6                -1.595145e-01 1 1  ON 6
 uu_7                -1.138606e-01 1 1  ON 7
 uu_8                -3.712247e-02 1 1  ON 8
 uu_9                 1.620726e-01 1 1  ON 9
 ud_0                 3.445568e-01 1 1  ON 10
 ud_1                 8.869154e-02 1 1  ON 11
 ud_2                -1.705693e-02 1 1  ON 12
 ud_3                -7.706442e-02 1 1  ON 13
 ud_4                -1.286045e-01 1 1  ON 14
 ud_5                -1.681810e-01 1 1  ON 15
 ud_6                -1.818183e-01 1 1  ON 16
 ud_7                -1.592651e-01 1 1  ON 17
 ud_8                -9.908249e-02 1 1  ON 18
 ud_9                -8.575698e-03 1 1  ON 19
 eO_0                -9.171209e-01 1 1  ON 20
 eO_1                -5.998332e-01 1 1  ON 21
 eO_2                -1.933827e-01 1 1  ON 22
 eO_3                 7.434144e-02 1 1  ON 23
 eO_4                 2.043570e-01 1 1  ON 24
 eO_5                 2.943239e-01 1 1  ON 25
 eO_6                 3.343608e-01 1 1  ON 26
 eO_7                 5.024716e-01 1 1  ON 27
 eO_8                 1.936620e-01 1 1  ON 28
 eO_9                 6.106191e-02 1 1  ON 29
eH1_0                -2.104558e-01 1 1  ON 30
eH1_1                -1.323125e-01 1 1  ON 31
eH1_2                -9.111441e-02 1 1  ON 32
eH1_3                -5.396447e-02 1 1  ON 33
eH1_4                -7.977231e-03 1 1  ON 34
eH1_5                 3.178449e-03 1 1  ON 35
eH1_6                 4.118211e-02 1 1  ON 36
eH1_7                 6.443715e-02 1 1  ON 37
eH1_8                 1.799136e-01 1 1  ON 38
eH1_9                 1.209096e-01 1 1  ON 39
eH2_0                -2.059978e-01 1 1  ON 40
eH2_1                -1.275776e-01 1 1  ON 41
eH2_2                -8.644598e-02 1 1  ON 42
eH2_3                -4.965395e-02 1 1  ON 43
eH2_4                -3.004352e-03 1 1  ON 44
eH2_5                 8.654472e-03 1 1  ON 45
eH2_6                 4.715927e-02 1 1  ON 46
eH2_7                 4.593597e-02 1 1  ON 47
eH2_8                 1.982449e-01 1 1  ON 48
eH2_9                 1.200413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1070e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2445
    reference variance = 0.186407
====================================================
  Execution time = 4.0344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2451e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0801e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324535760961
                                         uncertainty =       0.003861859638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324535760961
                                         uncertainty =       0.003861859638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402810029
  error estimate for blocks of size 2^( 2) =       0.000412088770
  error estimate for blocks of size 2^( 3) =       0.000420262043
  error estimate for blocks of size 2^( 4) =       0.000425974068
  error estimate for blocks of size 2^( 5) =       0.000429157508
  error estimate for blocks of size 2^( 6) =       0.000431098618
  error estimate for blocks of size 2^( 7) =       0.000433679385

      target function =                  N/A
              le_mean =     -17.215806373732
             les_mean =     296.708500774395
             stat err =       0.000429977395
             autocorr =       1.139437997897
              std dev =       0.569659405978
             le_variance =       0.324511838819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721580637373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215806373732       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215808044286       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215808118054       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215808430246       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215808418854       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215808436608       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215807789279       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215807681720       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215808410265       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215808068408       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 9.116349e-04

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215806373732       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215807501456       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215807559417       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215807652155       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215807680846       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215807720375       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215807404850       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215807487689       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215807625977       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 3.385268e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215806373732       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215806864098       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215806913032       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215806879683       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215806932005       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215806895418       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215806822257       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.226020e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.666072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1155e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.245
    reference variance = 0.261754
====================================================
  Execution time = 3.9202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.5637e-01
  Total weights = 2.0000e+06
  Execution time = 3.6229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381323949
                                         uncertainty =       0.023527937151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381323949
                                         uncertainty =       0.023527937151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422122438
  error estimate for blocks of size 2^( 2) =       0.000430490091
  error estimate for blocks of size 2^( 3) =       0.000438061537
  error estimate for blocks of size 2^( 4) =       0.000443603606
  error estimate for blocks of size 2^( 5) =       0.000447683310
  error estimate for blocks of size 2^( 6) =       0.000450279023
  error estimate for blocks of size 2^( 7) =       0.000449586653

      target function =                  N/A
              le_mean =     -17.217281174074
             les_mean =     296.791145553547
             stat err =       0.000447788148
             autocorr =       1.125299988940
              std dev =       0.596971276216
             le_variance =       0.356374704627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356395480346
                                         uncertainty =       0.023532324930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356395480346
                                         uncertainty =       0.023532324930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422130904
  error estimate for blocks of size 2^( 2) =       0.000430499698
  error estimate for blocks of size 2^( 3) =       0.000438073083
  error estimate for blocks of size 2^( 4) =       0.000443616107
  error estimate for blocks of size 2^( 5) =       0.000447696780
  error estimate for blocks of size 2^( 6) =       0.000450297268
  error estimate for blocks of size 2^( 7) =       0.000449587812

      target function =                  N/A
              le_mean =     -17.217281433845
             les_mean =     296.791168794559
             stat err =       0.000447799492
             autocorr =       1.125311861924
              std dev =       0.596983249791
             le_variance =       0.356389000531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356388359510
                                         uncertainty =       0.023537935882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356388359510
                                         uncertainty =       0.023537935882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422126668
  error estimate for blocks of size 2^( 2) =       0.000430497123
  error estimate for blocks of size 2^( 3) =       0.000438072077
  error estimate for blocks of size 2^( 4) =       0.000443617114
  error estimate for blocks of size 2^( 5) =       0.000447697787
  error estimate for blocks of size 2^( 6) =       0.000450299715
  error estimate for blocks of size 2^( 7) =       0.000449585900

      target function =                  N/A
              le_mean =     -17.217281783770
             les_mean =     296.791173691310
             stat err =       0.000447800129
             autocorr =       1.125337650839
              std dev =       0.596977259008
             le_variance =       0.356381847772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356387150889
                                         uncertainty =       0.023530703302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356387150889
                                         uncertainty =       0.023530703302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422125895
  error estimate for blocks of size 2^( 2) =       0.000430494080
  error estimate for blocks of size 2^( 3) =       0.000438066122
  error estimate for blocks of size 2^( 4) =       0.000443609215
  error estimate for blocks of size 2^( 5) =       0.000447689311
  error estimate for blocks of size 2^( 6) =       0.000450286641
  error estimate for blocks of size 2^( 7) =       0.000449589671

      target function =                  N/A
              le_mean =     -17.217280874162
             les_mean =     296.791141064384
             stat err =       0.000447793710
             autocorr =       1.125309506688
              std dev =       0.596976166009
             le_variance =       0.356380542783


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217281174074        initial
     5.9605e-02     5.9605e-01             9.1163e-04       -17.217281433845
     2.3842e-01     2.3842e+00             3.3853e-04       -17.217281783770  <--
     9.5367e-01     9.5367e+00             1.2260e-04       -17.217280874162

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 5.7469e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0863e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2326
    reference variance = 0.203895
====================================================
  Execution time = 4.0909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2614e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0704e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326228100044
                                         uncertainty =       0.004258545165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326228100044
                                         uncertainty =       0.004258545165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403821631
  error estimate for blocks of size 2^( 2) =       0.000413160038
  error estimate for blocks of size 2^( 3) =       0.000421243685
  error estimate for blocks of size 2^( 4) =       0.000426839624
  error estimate for blocks of size 2^( 5) =       0.000430683419
  error estimate for blocks of size 2^( 6) =       0.000432011130
  error estimate for blocks of size 2^( 7) =       0.000432441888

      target function =                  N/A
              le_mean =     -17.217020850814
             les_mean =     296.751950634195
             stat err =       0.000430494015
             autocorr =       1.136462417329
              std dev =       0.571090027850
             le_variance =       0.326143819910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702085081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217020850814       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217022179582       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217023201810       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217021263458       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217021859516       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217022764259       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217021994946       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217021584228       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217021830499       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217021866364       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217021815731       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 1.191291e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217020850814       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217021553115       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217022378108       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217021149150       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217021428839       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217021863593       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217021464549       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217021392059       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 3.933722e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217020850814       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217021094173       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217021493560       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217021038897       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217021033232       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217021158740       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217021080081       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.221339e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.670552 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1624e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.901415e-01 1 1  ON 0
 uu_1                 2.737303e-02 1 1  ON 1
 uu_2                -6.724147e-02 1 1  ON 2
 uu_3                -1.234737e-01 1 1  ON 3
 uu_4                -1.599644e-01 1 1  ON 4
 uu_5                -1.722221e-01 1 1  ON 5
 uu_6                -1.596936e-01 1 1  ON 6
 uu_7                -1.135709e-01 1 1  ON 7
 uu_8                -3.703247e-02 1 1  ON 8
 uu_9                 1.619669e-01 1 1  ON 9
 ud_0                 3.445019e-01 1 1  ON 10
 ud_1                 8.872789e-02 1 1  ON 11
 ud_2                -1.680143e-02 1 1  ON 12
 ud_3                -7.703154e-02 1 1  ON 13
 ud_4                -1.285673e-01 1 1  ON 14
 ud_5                -1.680867e-01 1 1  ON 15
 ud_6                -1.821428e-01 1 1  ON 16
 ud_7                -1.594806e-01 1 1  ON 17
 ud_8                -9.926250e-02 1 1  ON 18
 ud_9                -8.511770e-03 1 1  ON 19
 eO_0                -9.170252e-01 1 1  ON 20
 eO_1                -5.996801e-01 1 1  ON 21
 eO_2                -1.935556e-01 1 1  ON 22
 eO_3                 7.454008e-02 1 1  ON 23
 eO_4                 2.040156e-01 1 1  ON 24
 eO_5                 2.942899e-01 1 1  ON 25
 eO_6                 3.343047e-01 1 1  ON 26
 eO_7                 5.024048e-01 1 1  ON 27
 eO_8                 1.937785e-01 1 1  ON 28
 eO_9                 6.112162e-02 1 1  ON 29
eH1_0                -2.105309e-01 1 1  ON 30
eH1_1                -1.326756e-01 1 1  ON 31
eH1_2                -9.131345e-02 1 1  ON 32
eH1_3                -5.431175e-02 1 1  ON 33
eH1_4                -7.812340e-03 1 1  ON 34
eH1_5                 3.819407e-03 1 1  ON 35
eH1_6                 4.131687e-02 1 1  ON 36
eH1_7                 6.437453e-02 1 1  ON 37
eH1_8                 1.799091e-01 1 1  ON 38
eH1_9                 1.209551e-01 1 1  ON 39
eH2_0                -2.061587e-01 1 1  ON 40
eH2_1                -1.275440e-01 1 1  ON 41
eH2_2                -8.652048e-02 1 1  ON 42
eH2_3                -4.963451e-02 1 1  ON 43
eH2_4                -3.445342e-03 1 1  ON 44
eH2_5                 8.935511e-03 1 1  ON 45
eH2_6                 4.727455e-02 1 1  ON 46
eH2_7                 4.605716e-02 1 1  ON 47
eH2_8                 1.982439e-01 1 1  ON 48
eH2_9                 1.200869e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1681
    reference variance = 0.192284
====================================================
  Execution time = 4.0137e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1968e-01
  Total weights = 2.0000e+06
  Execution time = 3.6189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319926774610
                                         uncertainty =       0.002791056156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319926774610
                                         uncertainty =       0.002791056156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399890987
  error estimate for blocks of size 2^( 2) =       0.000409069531
  error estimate for blocks of size 2^( 3) =       0.000417201014
  error estimate for blocks of size 2^( 4) =       0.000422804115
  error estimate for blocks of size 2^( 5) =       0.000427389835
  error estimate for blocks of size 2^( 6) =       0.000430456978
  error estimate for blocks of size 2^( 7) =       0.000431649540

      target function =                  N/A
              le_mean =     -17.216338845987
             les_mean =     296.722148702473
             stat err =       0.000428075117
             autocorr =       1.145926431785
              std dev =       0.565531256908
             le_variance =       0.319825602540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319683643542
                                         uncertainty =       0.002789874755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319683643542
                                         uncertainty =       0.002789874755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399739033
  error estimate for blocks of size 2^( 2) =       0.000408927240
  error estimate for blocks of size 2^( 3) =       0.000417065914
  error estimate for blocks of size 2^( 4) =       0.000422670431
  error estimate for blocks of size 2^( 5) =       0.000427258272
  error estimate for blocks of size 2^( 6) =       0.000430317523
  error estimate for blocks of size 2^( 7) =       0.000431501863

      target function =                  N/A
              le_mean =     -17.216335641931
             les_mean =     296.721795365112
             stat err =       0.000427937022
             autocorr =       1.146058020924
              std dev =       0.565316362128
             le_variance =       0.319582589290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319648691617
                                         uncertainty =       0.002790532952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319648691617
                                         uncertainty =       0.002790532952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399717188
  error estimate for blocks of size 2^( 2) =       0.000408908241
  error estimate for blocks of size 2^( 3) =       0.000417049053
  error estimate for blocks of size 2^( 4) =       0.000422652811
  error estimate for blocks of size 2^( 5) =       0.000427243861
  error estimate for blocks of size 2^( 6) =       0.000430301926
  error estimate for blocks of size 2^( 7) =       0.000431484225

      target function =                  N/A
              le_mean =     -17.216335547382
             les_mean =     296.721757180760
             stat err =       0.000427920706
             autocorr =       1.146095891793
              std dev =       0.565285468146
             le_variance =       0.319547660497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319839005870
                                         uncertainty =       0.002790879919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319839005870
                                         uncertainty =       0.002790879919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399836130
  error estimate for blocks of size 2^( 2) =       0.000409017763
  error estimate for blocks of size 2^( 3) =       0.000417151591
  error estimate for blocks of size 2^( 4) =       0.000422754745
  error estimate for blocks of size 2^( 5) =       0.000427341539
  error estimate for blocks of size 2^( 6) =       0.000430406877
  error estimate for blocks of size 2^( 7) =       0.000431597632

      target function =                  N/A
              le_mean =     -17.216337889760
             les_mean =     296.722028036059
             stat err =       0.000428025198
             autocorr =       1.145973575888
              std dev =       0.565453677623
             le_variance =       0.319737861538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216338845987        initial  <--
     5.9605e-02     5.9605e-01             1.1913e-03       -17.216335641931
     2.3842e-01     2.3842e+00             3.9337e-04       -17.216335547382
     9.5367e-01     9.5367e+00             1.2213e-04       -17.216337889760

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.3879
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1002e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2901
    reference variance = 0.315428
====================================================
  Execution time = 4.0201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0800e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325976568710
                                         uncertainty =       0.004607351135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325976568710
                                         uncertainty =       0.004607351135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403729021
  error estimate for blocks of size 2^( 2) =       0.000413581397
  error estimate for blocks of size 2^( 3) =       0.000422103792
  error estimate for blocks of size 2^( 4) =       0.000427923073
  error estimate for blocks of size 2^( 5) =       0.000432391448
  error estimate for blocks of size 2^( 6) =       0.000434914583
  error estimate for blocks of size 2^( 7) =       0.000435156802

      target function =                  N/A
              le_mean =     -17.216746247620
             les_mean =     296.742345436336
             stat err =       0.000432596476
             autocorr =       1.148116659604
              std dev =       0.570959056677
             le_variance =       0.325994244401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674624762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216746247620       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216746685738       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216747321567       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216747706043       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216748206189       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216748325820       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216748344490       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 2.411959e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216746247620       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216746376196       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216746598326       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216746691482       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216746832218       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216746838276       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216746844837       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.183245e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216746247620       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216746281225       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216746342887       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216746365931       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216746399957       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216746399234       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216746400641       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.930186e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.673767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1010e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.900539e-01 1 1  ON 0
 uu_1                 2.763876e-02 1 1  ON 1
 uu_2                -6.713805e-02 1 1  ON 2
 uu_3                -1.233804e-01 1 1  ON 3
 uu_4                -1.600028e-01 1 1  ON 4
 uu_5                -1.724203e-01 1 1  ON 5
 uu_6                -1.594105e-01 1 1  ON 6
 uu_7                -1.136823e-01 1 1  ON 7
 uu_8                -3.712131e-02 1 1  ON 8
 uu_9                 1.619918e-01 1 1  ON 9
 ud_0                 3.445375e-01 1 1  ON 10
 ud_1                 8.862113e-02 1 1  ON 11
 ud_2                -1.687133e-02 1 1  ON 12
 ud_3                -7.713877e-02 1 1  ON 13
 ud_4                -1.286142e-01 1 1  ON 14
 ud_5                -1.681017e-01 1 1  ON 15
 ud_6                -1.818478e-01 1 1  ON 16
 ud_7                -1.593277e-01 1 1  ON 17
 ud_8                -9.916500e-02 1 1  ON 18
 ud_9                -8.565974e-03 1 1  ON 19
 eO_0                -9.170248e-01 1 1  ON 20
 eO_1                -5.998346e-01 1 1  ON 21
 eO_2                -1.934328e-01 1 1  ON 22
 eO_3                 7.454226e-02 1 1  ON 23
 eO_4                 2.040316e-01 1 1  ON 24
 eO_5                 2.942685e-01 1 1  ON 25
 eO_6                 3.344157e-01 1 1  ON 26
 eO_7                 5.024591e-01 1 1  ON 27
 eO_8                 1.937266e-01 1 1  ON 28
 eO_9                 6.108623e-02 1 1  ON 29
eH1_0                -2.104959e-01 1 1  ON 30
eH1_1                -1.324864e-01 1 1  ON 31
eH1_2                -9.141095e-02 1 1  ON 32
eH1_3                -5.412861e-02 1 1  ON 33
eH1_4                -7.821157e-03 1 1  ON 34
eH1_5                 3.451536e-03 1 1  ON 35
eH1_6                 4.134169e-02 1 1  ON 36
eH1_7                 6.446538e-02 1 1  ON 37
eH1_8                 1.799362e-01 1 1  ON 38
eH1_9                 1.209316e-01 1 1  ON 39
eH2_0                -2.062054e-01 1 1  ON 40
eH2_1                -1.275004e-01 1 1  ON 41
eH2_2                -8.647441e-02 1 1  ON 42
eH2_3                -4.934839e-02 1 1  ON 43
eH2_4                -3.325493e-03 1 1  ON 44
eH2_5                 8.775408e-03 1 1  ON 45
eH2_6                 4.709598e-02 1 1  ON 46
eH2_7                 4.599939e-02 1 1  ON 47
eH2_8                 1.982597e-01 1 1  ON 48
eH2_9                 1.200596e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2643
    reference variance = 0.226988
====================================================
  Execution time = 3.8743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2497e-01
  Total weights = 2.0000e+06
  Execution time = 3.6095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119007571
                                         uncertainty =       0.003865167571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119007571
                                         uncertainty =       0.003865167571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403126259
  error estimate for blocks of size 2^( 2) =       0.000412658359
  error estimate for blocks of size 2^( 3) =       0.000420671036
  error estimate for blocks of size 2^( 4) =       0.000427805417
  error estimate for blocks of size 2^( 5) =       0.000431802812
  error estimate for blocks of size 2^( 6) =       0.000433027455
  error estimate for blocks of size 2^( 7) =       0.000433301518

      target function =                  N/A
              le_mean =     -17.216292145102
             les_mean =     296.725736624251
             stat err =       0.000431484301
             autocorr =       1.145639082352
              std dev =       0.570106622722
             le_variance =       0.325021561272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324980672091
                                         uncertainty =       0.003864464691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324980672091
                                         uncertainty =       0.003864464691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403040480
  error estimate for blocks of size 2^( 2) =       0.000412576153
  error estimate for blocks of size 2^( 3) =       0.000420589829
  error estimate for blocks of size 2^( 4) =       0.000427725099
  error estimate for blocks of size 2^( 5) =       0.000431722447
  error estimate for blocks of size 2^( 6) =       0.000432946924
  error estimate for blocks of size 2^( 7) =       0.000433219679

      target function =                  N/A
              le_mean =     -17.216291795730
             les_mean =     296.725586291090
             stat err =       0.000431403537
             autocorr =       1.145697769963
              std dev =       0.569985313682
             le_variance =       0.324883257813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325013014619
                                         uncertainty =       0.003864570827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325013014619
                                         uncertainty =       0.003864570827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403060541
  error estimate for blocks of size 2^( 2) =       0.000412595490
  error estimate for blocks of size 2^( 3) =       0.000420609106
  error estimate for blocks of size 2^( 4) =       0.000427744314
  error estimate for blocks of size 2^( 5) =       0.000431741408
  error estimate for blocks of size 2^( 6) =       0.000432965892
  error estimate for blocks of size 2^( 7) =       0.000433239707

      target function =                  N/A
              le_mean =     -17.216291645348
             les_mean =     296.725613454152
             stat err =       0.000431422830
             autocorr =       1.145686196694
              std dev =       0.570013683115
             le_variance =       0.324915598938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325103570421
                                         uncertainty =       0.003865078176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325103570421
                                         uncertainty =       0.003865078176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403116688
  error estimate for blocks of size 2^( 2) =       0.000412649206
  error estimate for blocks of size 2^( 3) =       0.000420662028
  error estimate for blocks of size 2^( 4) =       0.000427796539
  error estimate for blocks of size 2^( 5) =       0.000431793879
  error estimate for blocks of size 2^( 6) =       0.000433018496
  error estimate for blocks of size 2^( 7) =       0.000433292556

      target function =                  N/A
              le_mean =     -17.216292053155
             les_mean =     296.725718025879
             stat err =       0.000431475368
             autocorr =       1.145646043758
              std dev =       0.570093087887
             le_variance =       0.325006128857


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216292145102        initial  <--
     5.9605e-01     5.9605e+00             2.4120e-04       -17.216291795730
     2.3842e+00     2.3842e+01             7.1832e-05       -17.216291645348
     9.5367e+00     9.5367e+01             1.9302e-05       -17.216292053155

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 56.9055
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0792e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.214
    reference variance = 0.274603
====================================================
  Execution time = 4.0040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4064e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1037e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340693998523
                                         uncertainty =       0.011945114987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340693998523
                                         uncertainty =       0.011945114987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412699926
  error estimate for blocks of size 2^( 2) =       0.000421918658
  error estimate for blocks of size 2^( 3) =       0.000430288153
  error estimate for blocks of size 2^( 4) =       0.000436122950
  error estimate for blocks of size 2^( 5) =       0.000438356341
  error estimate for blocks of size 2^( 6) =       0.000439893154
  error estimate for blocks of size 2^( 7) =       0.000442211554

      target function =                  N/A
              le_mean =     -17.216314612208
             les_mean =     296.742131114512
             stat err =       0.000439146000
             autocorr =       1.132267598341
              std dev =       0.583645832927
             le_variance =       0.340642458293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631461221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216314612208       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216314653145       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216314845330       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216314844736       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216314848066       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216314847929       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216314837996       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.768217e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216314612208       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216314622689       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216314673584       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216314674093       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216314675066       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216314675345       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216314672651       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.006876e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216314612208       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216314614844       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216314627758       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216314627934       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216314628190       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216314628279       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216314627591       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.561725e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.676879 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1086e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.900913e-01 1 1  ON 0
 uu_1                 2.766852e-02 1 1  ON 1
 uu_2                -6.711779e-02 1 1  ON 2
 uu_3                -1.233878e-01 1 1  ON 3
 uu_4                -1.599937e-01 1 1  ON 4
 uu_5                -1.724915e-01 1 1  ON 5
 uu_6                -1.594302e-01 1 1  ON 6
 uu_7                -1.136787e-01 1 1  ON 7
 uu_8                -3.711534e-02 1 1  ON 8
 uu_9                 1.619950e-01 1 1  ON 9
 ud_0                 3.445645e-01 1 1  ON 10
 ud_1                 8.859440e-02 1 1  ON 11
 ud_2                -1.688805e-02 1 1  ON 12
 ud_3                -7.711608e-02 1 1  ON 13
 ud_4                -1.286160e-01 1 1  ON 14
 ud_5                -1.681247e-01 1 1  ON 15
 ud_6                -1.818359e-01 1 1  ON 16
 ud_7                -1.593242e-01 1 1  ON 17
 ud_8                -9.916012e-02 1 1  ON 18
 ud_9                -8.564004e-03 1 1  ON 19
 eO_0                -9.170185e-01 1 1  ON 20
 eO_1                -5.998446e-01 1 1  ON 21
 eO_2                -1.934326e-01 1 1  ON 22
 eO_3                 7.455845e-02 1 1  ON 23
 eO_4                 2.040324e-01 1 1  ON 24
 eO_5                 2.942555e-01 1 1  ON 25
 eO_6                 3.344178e-01 1 1  ON 26
 eO_7                 5.024653e-01 1 1  ON 27
 eO_8                 1.937203e-01 1 1  ON 28
 eO_9                 6.108376e-02 1 1  ON 29
eH1_0                -2.104806e-01 1 1  ON 30
eH1_1                -1.324605e-01 1 1  ON 31
eH1_2                -9.144468e-02 1 1  ON 32
eH1_3                -5.413832e-02 1 1  ON 33
eH1_4                -7.814371e-03 1 1  ON 34
eH1_5                 3.427801e-03 1 1  ON 35
eH1_6                 4.134772e-02 1 1  ON 36
eH1_7                 6.448116e-02 1 1  ON 37
eH1_8                 1.799387e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062043e-01 1 1  ON 40
eH2_1                -1.275419e-01 1 1  ON 41
eH2_2                -8.640525e-02 1 1  ON 42
eH2_3                -4.935094e-02 1 1  ON 43
eH2_4                -3.339099e-03 1 1  ON 44
eH2_5                 8.773117e-03 1 1  ON 45
eH2_6                 4.709252e-02 1 1  ON 46
eH2_7                 4.599419e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200578e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1879
    reference variance = 0.398238
====================================================
  Execution time = 3.9323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2661e-01
  Total weights = 2.0000e+06
  Execution time = 3.6126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326525654725
                                         uncertainty =       0.004264234820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326525654725
                                         uncertainty =       0.004264234820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404113968
  error estimate for blocks of size 2^( 2) =       0.000413848573
  error estimate for blocks of size 2^( 3) =       0.000422356670
  error estimate for blocks of size 2^( 4) =       0.000428927171
  error estimate for blocks of size 2^( 5) =       0.000432734038
  error estimate for blocks of size 2^( 6) =       0.000435139683
  error estimate for blocks of size 2^( 7) =       0.000435763286

      target function =                  N/A
              le_mean =     -17.216700359529
             les_mean =     296.741387305400
             stat err =       0.000433141044
             autocorr =       1.148817266160
              std dev =       0.571503454853
             le_variance =       0.326616198909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326490018783
                                         uncertainty =       0.004263595395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326490018783
                                         uncertainty =       0.004263595395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404091924
  error estimate for blocks of size 2^( 2) =       0.000413827374
  error estimate for blocks of size 2^( 3) =       0.000422335953
  error estimate for blocks of size 2^( 4) =       0.000428907247
  error estimate for blocks of size 2^( 5) =       0.000432713934
  error estimate for blocks of size 2^( 6) =       0.000435119418
  error estimate for blocks of size 2^( 7) =       0.000435743819

      target function =                  N/A
              le_mean =     -17.216700317160
             les_mean =     296.741350214203
             stat err =       0.000433121104
             autocorr =       1.148836828233
              std dev =       0.571472279828
             le_variance =       0.326580566612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326506538297
                                         uncertainty =       0.004263892837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326506538297
                                         uncertainty =       0.004263892837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404102143
  error estimate for blocks of size 2^( 2) =       0.000413837200
  error estimate for blocks of size 2^( 3) =       0.000422345553
  error estimate for blocks of size 2^( 4) =       0.000428916477
  error estimate for blocks of size 2^( 5) =       0.000432723245
  error estimate for blocks of size 2^( 6) =       0.000435128799
  error estimate for blocks of size 2^( 7) =       0.000435752824

      target function =                  N/A
              le_mean =     -17.216700338254
             les_mean =     296.741367458459
             stat err =       0.000433130337
             autocorr =       1.148827698419
              std dev =       0.571486731697
             le_variance =       0.326597084506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326523219260
                                         uncertainty =       0.004264191308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326523219260
                                         uncertainty =       0.004264191308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404112462
  error estimate for blocks of size 2^( 2) =       0.000413847124
  error estimate for blocks of size 2^( 3) =       0.000422355254
  error estimate for blocks of size 2^( 4) =       0.000428925808
  error estimate for blocks of size 2^( 5) =       0.000432732663
  error estimate for blocks of size 2^( 6) =       0.000435138296
  error estimate for blocks of size 2^( 7) =       0.000435761952

      target function =                  N/A
              le_mean =     -17.216700356778
             les_mean =     296.741384775463
             stat err =       0.000433139680
             autocorr =       1.148818592786
              std dev =       0.571501324324
             le_variance =       0.326613763704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216700359529        initial  <--
     5.9605e+00     5.9605e+01             3.7682e-05       -17.216700317160
     2.3842e+01     2.3842e+02             1.0069e-05       -17.216700338254
     9.5367e+01     9.5367e+02             2.5617e-06       -17.216700356778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5545
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0865e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1839
    reference variance = 0.299808
====================================================
  Execution time = 4.0226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4152e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1046e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341525394719
                                         uncertainty =       0.018461676611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341525394719
                                         uncertainty =       0.018461676611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413234289
  error estimate for blocks of size 2^( 2) =       0.000422125522
  error estimate for blocks of size 2^( 3) =       0.000430331044
  error estimate for blocks of size 2^( 4) =       0.000436021152
  error estimate for blocks of size 2^( 5) =       0.000438906263
  error estimate for blocks of size 2^( 6) =       0.000440779486
  error estimate for blocks of size 2^( 7) =       0.000441273150

      target function =                  N/A
              le_mean =     -17.216693012090
             les_mean =     296.756043256674
             stat err =       0.000439245013
             autocorr =       1.129850486604
              std dev =       0.584401535660
             le_variance =       0.341525154881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669301209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216693012090       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216693013881       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216693024498       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216693022322       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216693021541       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216693022426       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 1.758065e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216693012090       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216693012539       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216693015205       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216693014661       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216693014463       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216693014687       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 4.409676e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216693012090       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216693012202       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216693012870       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216693012733       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216693012684       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216693012740       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.103331e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.679516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1281e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.900912e-01 1 1  ON 0
 uu_1                 2.766856e-02 1 1  ON 1
 uu_2                -6.712015e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599953e-01 1 1  ON 4
 uu_5                -1.724918e-01 1 1  ON 5
 uu_6                -1.594274e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711574e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445744e-01 1 1  ON 10
 ud_1                 8.858826e-02 1 1  ON 11
 ud_2                -1.688678e-02 1 1  ON 12
 ud_3                -7.711817e-02 1 1  ON 13
 ud_4                -1.286174e-01 1 1  ON 14
 ud_5                -1.681280e-01 1 1  ON 15
 ud_6                -1.818354e-01 1 1  ON 16
 ud_7                -1.593238e-01 1 1  ON 17
 ud_8                -9.915853e-02 1 1  ON 18
 ud_9                -8.563870e-03 1 1  ON 19
 eO_0                -9.170176e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934358e-01 1 1  ON 22
 eO_3                 7.456331e-02 1 1  ON 23
 eO_4                 2.040321e-01 1 1  ON 24
 eO_5                 2.942544e-01 1 1  ON 25
 eO_6                 3.344179e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937199e-01 1 1  ON 28
 eO_9                 6.108358e-02 1 1  ON 29
eH1_0                -2.104794e-01 1 1  ON 30
eH1_1                -1.324594e-01 1 1  ON 31
eH1_2                -9.144620e-02 1 1  ON 32
eH1_3                -5.413779e-02 1 1  ON 33
eH1_4                -7.814870e-03 1 1  ON 34
eH1_5                 3.425871e-03 1 1  ON 35
eH1_6                 4.134870e-02 1 1  ON 36
eH1_7                 6.448151e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062048e-01 1 1  ON 40
eH2_1                -1.275403e-01 1 1  ON 41
eH2_2                -8.640367e-02 1 1  ON 42
eH2_3                -4.935004e-02 1 1  ON 43
eH2_4                -3.343130e-03 1 1  ON 44
eH2_5                 8.775067e-03 1 1  ON 45
eH2_6                 4.709260e-02 1 1  ON 46
eH2_7                 4.599309e-02 1 1  ON 47
eH2_8                 1.982613e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.3188
    reference variance = 0.332165
====================================================
  Execution time = 4.0146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1947e-01
  Total weights = 2.0000e+06
  Execution time = 3.6071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319537223754
                                         uncertainty =       0.003007344018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319537223754
                                         uncertainty =       0.003007344018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399670437
  error estimate for blocks of size 2^( 2) =       0.000409386834
  error estimate for blocks of size 2^( 3) =       0.000417808933
  error estimate for blocks of size 2^( 4) =       0.000424067541
  error estimate for blocks of size 2^( 5) =       0.000427435106
  error estimate for blocks of size 2^( 6) =       0.000427883248
  error estimate for blocks of size 2^( 7) =       0.000428067094

      target function =                  N/A
              le_mean =     -17.217212144583
             les_mean =     296.751866787964
             stat err =       0.000426863247
             autocorr =       1.140705346543
              std dev =       0.565219352230
             le_variance =       0.319472916135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319536181100
                                         uncertainty =       0.003007322710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319536181100
                                         uncertainty =       0.003007322710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399669785
  error estimate for blocks of size 2^( 2) =       0.000409386222
  error estimate for blocks of size 2^( 3) =       0.000417808360
  error estimate for blocks of size 2^( 4) =       0.000424067002
  error estimate for blocks of size 2^( 5) =       0.000427434570
  error estimate for blocks of size 2^( 6) =       0.000427882748
  error estimate for blocks of size 2^( 7) =       0.000428066594

      target function =                  N/A
              le_mean =     -17.217212138064
             les_mean =     296.751865521601
             stat err =       0.000426862729
             autocorr =       1.140706295423
              std dev =       0.565218430567
             le_variance =       0.319471874253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319536699217
                                         uncertainty =       0.003007333309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319536699217
                                         uncertainty =       0.003007333309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399670109
  error estimate for blocks of size 2^( 2) =       0.000409386526
  error estimate for blocks of size 2^( 3) =       0.000417808645
  error estimate for blocks of size 2^( 4) =       0.000424067270
  error estimate for blocks of size 2^( 5) =       0.000427434836
  error estimate for blocks of size 2^( 6) =       0.000427882996
  error estimate for blocks of size 2^( 7) =       0.000428066843

      target function =                  N/A
              le_mean =     -17.217212141283
             les_mean =     296.751866150209
             stat err =       0.000426862986
             autocorr =       1.140705823752
              std dev =       0.565218888561
             le_variance =       0.319472391987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319537158083
                                         uncertainty =       0.003007342677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319537158083
                                         uncertainty =       0.003007342677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399670396
  error estimate for blocks of size 2^( 2) =       0.000409386795
  error estimate for blocks of size 2^( 3) =       0.000417808897
  error estimate for blocks of size 2^( 4) =       0.000424067507
  error estimate for blocks of size 2^( 5) =       0.000427435072
  error estimate for blocks of size 2^( 6) =       0.000427883216
  error estimate for blocks of size 2^( 7) =       0.000428067063

      target function =                  N/A
              le_mean =     -17.217212144169
             les_mean =     296.751866708088
             stat err =       0.000426863214
             autocorr =       1.140705406292
              std dev =       0.565219294180
             le_variance =       0.319472850513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217212144583        initial  <--
     5.9605e+01     5.9605e+02             1.7581e-06       -17.217212138064
     2.3842e+02     2.3842e+03             4.4097e-07       -17.217212141283
     9.5367e+02     9.5367e+03             1.1033e-07       -17.217212144169

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.2942
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0958e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2986
    reference variance = 0.270537
====================================================
  Execution time = 3.9585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2378e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0624e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782299617
                                         uncertainty =       0.003254790939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782299617
                                         uncertainty =       0.003254790939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402355036
  error estimate for blocks of size 2^( 2) =       0.000411674715
  error estimate for blocks of size 2^( 3) =       0.000420380276
  error estimate for blocks of size 2^( 4) =       0.000426588259
  error estimate for blocks of size 2^( 5) =       0.000429787434
  error estimate for blocks of size 2^( 6) =       0.000431868973
  error estimate for blocks of size 2^( 7) =       0.000432634010

      target function =                  N/A
              le_mean =     -17.216542628911
             les_mean =     296.733119081491
             stat err =       0.000430219669
             autocorr =       1.143303782239
              std dev =       0.569015949058
             le_variance =       0.323779150282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654262891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216542628911       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216542628712       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216542630270       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216542630577       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216542630409       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216542630572       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216542630343       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.662529e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216542628911       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216542628861       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216542629251       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216542629328       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216542629285       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216542629328       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216542629269       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 6.658378e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216542628911       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216542628898       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216542628996       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216542629015       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216542629005       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216542629017       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216542629001       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 1.664723e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.682601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0217e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766894e-02 1 1  ON 1
 uu_2                -6.712007e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724921e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136793e-01 1 1  ON 7
 uu_8                -3.711582e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858808e-02 1 1  ON 11
 ud_2                -1.688694e-02 1 1  ON 12
 ud_3                -7.711813e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681281e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593237e-01 1 1  ON 17
 ud_8                -9.915846e-02 1 1  ON 18
 ud_9                -8.563871e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456346e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144629e-02 1 1  ON 32
eH1_3                -5.413810e-02 1 1  ON 33
eH1_4                -7.814918e-03 1 1  ON 34
eH1_5                 3.426074e-03 1 1  ON 35
eH1_6                 4.134866e-02 1 1  ON 36
eH1_7                 6.448168e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640356e-02 1 1  ON 42
eH2_3                -4.935046e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775436e-03 1 1  ON 45
eH2_6                 4.709266e-02 1 1  ON 46
eH2_7                 4.599310e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1709
    reference variance = 0.205364
====================================================
  Execution time = 3.8958e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3416e-01
  Total weights = 2.0000e+06
  Execution time = 3.6097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202594584
                                         uncertainty =       0.006784523947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202594584
                                         uncertainty =       0.006784523947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408751796
  error estimate for blocks of size 2^( 2) =       0.000418004963
  error estimate for blocks of size 2^( 3) =       0.000426415053
  error estimate for blocks of size 2^( 4) =       0.000432537516
  error estimate for blocks of size 2^( 5) =       0.000436052407
  error estimate for blocks of size 2^( 6) =       0.000437571950
  error estimate for blocks of size 2^( 7) =       0.000437815470

      target function =                  N/A
              le_mean =     -17.216623623513
             les_mean =     296.746284887753
             stat err =       0.000435994336
             autocorr =       1.137738217514
              std dev =       0.578062333258
             le_variance =       0.334156061132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202367154
                                         uncertainty =       0.006784512114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202367154
                                         uncertainty =       0.006784512114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408751657
  error estimate for blocks of size 2^( 2) =       0.000418004830
  error estimate for blocks of size 2^( 3) =       0.000426414923
  error estimate for blocks of size 2^( 4) =       0.000432537390
  error estimate for blocks of size 2^( 5) =       0.000436052284
  error estimate for blocks of size 2^( 6) =       0.000437571830
  error estimate for blocks of size 2^( 7) =       0.000437815348

      target function =                  N/A
              le_mean =     -17.216623623194
             les_mean =     296.746284649456
             stat err =       0.000435994213
             autocorr =       1.137738351906
              std dev =       0.578062136643
             le_variance =       0.334155833820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202480819
                                         uncertainty =       0.006784518027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202480819
                                         uncertainty =       0.006784518027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408751726
  error estimate for blocks of size 2^( 2) =       0.000418004897
  error estimate for blocks of size 2^( 3) =       0.000426414988
  error estimate for blocks of size 2^( 4) =       0.000432537453
  error estimate for blocks of size 2^( 5) =       0.000436052345
  error estimate for blocks of size 2^( 6) =       0.000437571890
  error estimate for blocks of size 2^( 7) =       0.000437815409

      target function =                  N/A
              le_mean =     -17.216623623353
             les_mean =     296.746284768547
             stat err =       0.000435994274
             autocorr =       1.137738284737
              std dev =       0.578062234907
             le_variance =       0.334155947426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202580362
                                         uncertainty =       0.006784523207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202580362
                                         uncertainty =       0.006784523207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408751787
  error estimate for blocks of size 2^( 2) =       0.000418004955
  error estimate for blocks of size 2^( 3) =       0.000426415044
  error estimate for blocks of size 2^( 4) =       0.000432537508
  error estimate for blocks of size 2^( 5) =       0.000436052399
  error estimate for blocks of size 2^( 6) =       0.000437571942
  error estimate for blocks of size 2^( 7) =       0.000437815462

      target function =                  N/A
              le_mean =     -17.216623623493
             les_mean =     296.746284872850
             stat err =       0.000435994328
             autocorr =       1.137738225917
              std dev =       0.578062320963
             le_variance =       0.334156046917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216623623513        initial  <--
     5.9605e+02     5.9605e+03             2.6625e-07       -17.216623623194
     2.3842e+03     2.3842e+04             6.6584e-08       -17.216623623353
     9.5367e+03     9.5367e+04             1.6647e-08       -17.216623623493

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.1752
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0740e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2317
    reference variance = 0.182831
====================================================
  Execution time = 3.9684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2199e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0909e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322009673892
                                         uncertainty =       0.003277100230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322009673892
                                         uncertainty =       0.003277100230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401243654
  error estimate for blocks of size 2^( 2) =       0.000410817873
  error estimate for blocks of size 2^( 3) =       0.000419338389
  error estimate for blocks of size 2^( 4) =       0.000425403658
  error estimate for blocks of size 2^( 5) =       0.000429171552
  error estimate for blocks of size 2^( 6) =       0.000430903494
  error estimate for blocks of size 2^( 7) =       0.000430861226

      target function =                  N/A
              le_mean =     -17.216853925470
             les_mean =     296.742051868928
             stat err =       0.000429084983
             autocorr =       1.143589812232
              std dev =       0.567444216602
             le_variance =       0.321992938955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685392547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216853925470       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216853925492       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216853925548       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216853925501       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216853925599       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216853925572       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 2.418318e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216853925470       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216853925475       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216853925489       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216853925478       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216853925506       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216853925495       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 6.045907e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216853925470       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216853925471       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216853925475       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216853925470       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216853925493       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216853925462       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 1.511484e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.685191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0601e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712009e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724921e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563873e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814870e-03 1 1  ON 34
eH1_5                 3.426041e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342873e-03 1 1  ON 44
eH2_5                 8.775440e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2739
    reference variance = 0.469803
====================================================
  Execution time = 3.9649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3374e-01
  Total weights = 2.0000e+06
  Execution time = 3.6818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643240957
                                         uncertainty =       0.007703229101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643240957
                                         uncertainty =       0.007703229101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408500345
  error estimate for blocks of size 2^( 2) =       0.000417791209
  error estimate for blocks of size 2^( 3) =       0.000426397239
  error estimate for blocks of size 2^( 4) =       0.000432308938
  error estimate for blocks of size 2^( 5) =       0.000435227242
  error estimate for blocks of size 2^( 6) =       0.000438597286
  error estimate for blocks of size 2^( 7) =       0.000440354982

      target function =                  N/A
              le_mean =     -17.216756510731
             les_mean =     296.750449645888
             stat err =       0.000436622112
             autocorr =       1.142422105640
              std dev =       0.577706727462
             le_variance =       0.333745062954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643222505
                                         uncertainty =       0.007703228671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643222505
                                         uncertainty =       0.007703228671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408500333
  error estimate for blocks of size 2^( 2) =       0.000417791198
  error estimate for blocks of size 2^( 3) =       0.000426397228
  error estimate for blocks of size 2^( 4) =       0.000432308928
  error estimate for blocks of size 2^( 5) =       0.000435227232
  error estimate for blocks of size 2^( 6) =       0.000438597276
  error estimate for blocks of size 2^( 7) =       0.000440354972

      target function =                  N/A
              le_mean =     -17.216756510567
             les_mean =     296.750449621790
             stat err =       0.000436622102
             autocorr =       1.142422115556
              std dev =       0.577706711499
             le_variance =       0.333745044511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643231730
                                         uncertainty =       0.007703228886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643231730
                                         uncertainty =       0.007703228886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408500339
  error estimate for blocks of size 2^( 2) =       0.000417791204
  error estimate for blocks of size 2^( 3) =       0.000426397234
  error estimate for blocks of size 2^( 4) =       0.000432308933
  error estimate for blocks of size 2^( 5) =       0.000435227237
  error estimate for blocks of size 2^( 6) =       0.000438597281
  error estimate for blocks of size 2^( 7) =       0.000440354977

      target function =                  N/A
              le_mean =     -17.216756510649
             les_mean =     296.750449633839
             stat err =       0.000436622107
             autocorr =       1.142422110605
              std dev =       0.577706719480
             le_variance =       0.333745053732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643239804
                                         uncertainty =       0.007703229074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643239804
                                         uncertainty =       0.007703229074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408500344
  error estimate for blocks of size 2^( 2) =       0.000417791209
  error estimate for blocks of size 2^( 3) =       0.000426397238
  error estimate for blocks of size 2^( 4) =       0.000432308937
  error estimate for blocks of size 2^( 5) =       0.000435227241
  error estimate for blocks of size 2^( 6) =       0.000438597286
  error estimate for blocks of size 2^( 7) =       0.000440354982

      target function =                  N/A
              le_mean =     -17.216756510721
             les_mean =     296.750449644382
             stat err =       0.000436622111
             autocorr =       1.142422106261
              std dev =       0.577706726464
             le_variance =       0.333745061801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216756510731        initial  <--
     5.9605e+03     5.9605e+04             2.4183e-08       -17.216756510567
     2.3842e+04     2.3842e+05             6.0459e-09       -17.216756510649
     9.5367e+04     9.5367e+05             1.5115e-09       -17.216756510721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.9224
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0853e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2571
    reference variance = 0.3368
====================================================
  Execution time = 4.1178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2796e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0736e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328050957458
                                         uncertainty =       0.004966946523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328050957458
                                         uncertainty =       0.004966946523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404944700
  error estimate for blocks of size 2^( 2) =       0.000414485610
  error estimate for blocks of size 2^( 3) =       0.000423196145
  error estimate for blocks of size 2^( 4) =       0.000429329175
  error estimate for blocks of size 2^( 5) =       0.000433777106
  error estimate for blocks of size 2^( 6) =       0.000436203609
  error estimate for blocks of size 2^( 7) =       0.000438428346

      target function =                  N/A
              le_mean =     -17.216497015763
             les_mean =     296.735729749666
             stat err =       0.000434434559
             autocorr =       1.150952216902
              std dev =       0.572678286534
             le_variance =       0.327960419867


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649701576e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216497015763       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216497015771       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216497015772       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216497015771       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216497015768       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216497015768       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216497015770       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.000028e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216497015763       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216497015765       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216497015765       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216497015531       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216497015801       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216497015703       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216497015727       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 7.500133e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216497015763       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216497015764       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216497015764       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216497016253       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216497016466       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216497012768       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216497015813       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 1.875043e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.688270 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1923e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724921e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342879e-03 1 1  ON 44
eH2_5                 8.775442e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2434
    reference variance = 0.251638
====================================================
  Execution time = 3.9211e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1969e-01
  Total weights = 2.0000e+06
  Execution time = 3.6221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318713673642
                                         uncertainty =       0.003022618791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318713673642
                                         uncertainty =       0.003022618791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399806799
  error estimate for blocks of size 2^( 2) =       0.000409374232
  error estimate for blocks of size 2^( 3) =       0.000418161523
  error estimate for blocks of size 2^( 4) =       0.000425316213
  error estimate for blocks of size 2^( 5) =       0.000428007022
  error estimate for blocks of size 2^( 6) =       0.000430321051
  error estimate for blocks of size 2^( 7) =       0.000433036709

      target function =                  N/A
              le_mean =     -17.216776276421
             les_mean =     296.737076145951
             stat err =       0.000429170249
             autocorr =       1.152282230240
              std dev =       0.565412197829
             le_variance =       0.319690953454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318713668900
                                         uncertainty =       0.003022618747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318713668900
                                         uncertainty =       0.003022618747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399806796
  error estimate for blocks of size 2^( 2) =       0.000409374229
  error estimate for blocks of size 2^( 3) =       0.000418161520
  error estimate for blocks of size 2^( 4) =       0.000425316210
  error estimate for blocks of size 2^( 5) =       0.000428007019
  error estimate for blocks of size 2^( 6) =       0.000430321048
  error estimate for blocks of size 2^( 7) =       0.000433036707

      target function =                  N/A
              le_mean =     -17.216776276419
             les_mean =     296.737076141138
             stat err =       0.000429170246
             autocorr =       1.152282232899
              std dev =       0.565412193630
             le_variance =       0.319690948706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318713671271
                                         uncertainty =       0.003022618769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318713671271
                                         uncertainty =       0.003022618769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399806798
  error estimate for blocks of size 2^( 2) =       0.000409374231
  error estimate for blocks of size 2^( 3) =       0.000418161521
  error estimate for blocks of size 2^( 4) =       0.000425316211
  error estimate for blocks of size 2^( 5) =       0.000428007021
  error estimate for blocks of size 2^( 6) =       0.000430321050
  error estimate for blocks of size 2^( 7) =       0.000433036708

      target function =                  N/A
              le_mean =     -17.216776276420
             les_mean =     296.737076143544
             stat err =       0.000429170247
             autocorr =       1.152282231565
              std dev =       0.565412195729
             le_variance =       0.319690951080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318713673346
                                         uncertainty =       0.003022618788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318713673346
                                         uncertainty =       0.003022618788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399806799
  error estimate for blocks of size 2^( 2) =       0.000409374232
  error estimate for blocks of size 2^( 3) =       0.000418161523
  error estimate for blocks of size 2^( 4) =       0.000425316212
  error estimate for blocks of size 2^( 5) =       0.000428007022
  error estimate for blocks of size 2^( 6) =       0.000430321051
  error estimate for blocks of size 2^( 7) =       0.000433036709

      target function =                  N/A
              le_mean =     -17.216776276421
             les_mean =     296.737076145650
             stat err =       0.000429170249
             autocorr =       1.152282230411
              std dev =       0.565412197567
             le_variance =       0.319690953157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216776276421        initial  <--
     5.9605e+04     5.9605e+05             3.0000e-09       -17.216776276419
     2.3842e+05     2.3842e+06             7.5001e-10       -17.216776276420
     9.5367e+05     9.5367e+06             1.8750e-10       -17.216776276421

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.4406
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0937e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2316
    reference variance = 0.232465
====================================================
  Execution time = 3.9453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3261e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1044e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332607197438
                                         uncertainty =       0.010216316006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332607197438
                                         uncertainty =       0.010216316006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407802905
  error estimate for blocks of size 2^( 2) =       0.000417131239
  error estimate for blocks of size 2^( 3) =       0.000425634678
  error estimate for blocks of size 2^( 4) =       0.000432077119
  error estimate for blocks of size 2^( 5) =       0.000436387848
  error estimate for blocks of size 2^( 6) =       0.000437544233
  error estimate for blocks of size 2^( 7) =       0.000440643257

      target function =                  N/A
              le_mean =     -17.217446674978
             les_mean =     296.773076258604
             stat err =       0.000436663114
             autocorr =       1.146548378758
              std dev =       0.576720399506
             le_variance =       0.332606419207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721744667498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217446674978       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217446674978       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217446674979       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217446674745       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217446674992       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217446674612       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217446674763       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.252571e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217446674978       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217446674978       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217446674978       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217446674706       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217446676268       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217446674611       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217446675193       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.063142e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217446674978       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217446674978       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217446674978       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217446674978       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217446673712       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217446671570       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217446690972       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.657878e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.691524 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0507e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2469
    reference variance = 0.276624
====================================================
  Execution time = 3.9138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2298e-01
  Total weights = 2.0000e+06
  Execution time = 3.6106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323030736552
                                         uncertainty =       0.004744604561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323030736552
                                         uncertainty =       0.004744604561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401859339
  error estimate for blocks of size 2^( 2) =       0.000411339916
  error estimate for blocks of size 2^( 3) =       0.000419586522
  error estimate for blocks of size 2^( 4) =       0.000426356800
  error estimate for blocks of size 2^( 5) =       0.000430448519
  error estimate for blocks of size 2^( 6) =       0.000433047890
  error estimate for blocks of size 2^( 7) =       0.000434556011

      target function =                  N/A
              le_mean =     -17.216821195190
             les_mean =     296.741913763094
             stat err =       0.000431102305
             autocorr =       1.150833665375
              std dev =       0.568314928041
             le_variance =       0.322981857434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323030736008
                                         uncertainty =       0.004744604552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323030736008
                                         uncertainty =       0.004744604552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401859339
  error estimate for blocks of size 2^( 2) =       0.000411339915
  error estimate for blocks of size 2^( 3) =       0.000419586522
  error estimate for blocks of size 2^( 4) =       0.000426356799
  error estimate for blocks of size 2^( 5) =       0.000430448519
  error estimate for blocks of size 2^( 6) =       0.000433047890
  error estimate for blocks of size 2^( 7) =       0.000434556011

      target function =                  N/A
              le_mean =     -17.216821195192
             les_mean =     296.741913762619
             stat err =       0.000431102305
             autocorr =       1.150833665718
              std dev =       0.568314927563
             le_variance =       0.322981856891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323030736280
                                         uncertainty =       0.004744604557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323030736280
                                         uncertainty =       0.004744604557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401859339
  error estimate for blocks of size 2^( 2) =       0.000411339916
  error estimate for blocks of size 2^( 3) =       0.000419586522
  error estimate for blocks of size 2^( 4) =       0.000426356799
  error estimate for blocks of size 2^( 5) =       0.000430448519
  error estimate for blocks of size 2^( 6) =       0.000433047890
  error estimate for blocks of size 2^( 7) =       0.000434556011

      target function =                  N/A
              le_mean =     -17.216821195191
             les_mean =     296.741913762857
             stat err =       0.000431102305
             autocorr =       1.150833665545
              std dev =       0.568314927802
             le_variance =       0.322981857162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323030736518
                                         uncertainty =       0.004744604561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323030736518
                                         uncertainty =       0.004744604561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401859339
  error estimate for blocks of size 2^( 2) =       0.000411339916
  error estimate for blocks of size 2^( 3) =       0.000419586522
  error estimate for blocks of size 2^( 4) =       0.000426356800
  error estimate for blocks of size 2^( 5) =       0.000430448519
  error estimate for blocks of size 2^( 6) =       0.000433047890
  error estimate for blocks of size 2^( 7) =       0.000434556011

      target function =                  N/A
              le_mean =     -17.216821195190
             les_mean =     296.741913763065
             stat err =       0.000431102305
             autocorr =       1.150833665398
              std dev =       0.568314928011
             le_variance =       0.322981857400


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216821195190        initial
     5.9605e+05     5.9605e+06             4.2526e-10       -17.216821195192  <--
     2.3842e+06     2.3842e+07             1.0631e-10       -17.216821195191
     9.5367e+06     9.5367e+07             2.6579e-11       -17.216821195190

*****************************************************************************
Applying the update for shift_i =   5.9605e+05     and shift_s =   5.9605e+06
*****************************************************************************

  Execution time = 5.7337e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0785e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2393
    reference variance = 0.177424
====================================================
  Execution time = 3.9565e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1546e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0902e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315560371885
                                         uncertainty =       0.003332128347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315560371885
                                         uncertainty =       0.003332128347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397154089
  error estimate for blocks of size 2^( 2) =       0.000406425457
  error estimate for blocks of size 2^( 3) =       0.000414836931
  error estimate for blocks of size 2^( 4) =       0.000420655010
  error estimate for blocks of size 2^( 5) =       0.000424332533
  error estimate for blocks of size 2^( 6) =       0.000426212066
  error estimate for blocks of size 2^( 7) =       0.000426364357

      target function =                  N/A
              le_mean =     -17.215954522297
             les_mean =     296.704552696326
             stat err =       0.000424390992
             autocorr =       1.141863622618
              std dev =       0.561660698515
             le_variance =       0.315462740256


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595452230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215954522297       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215954522299       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215954522299       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215954522281       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215954522305       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215954522322       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 7.619191e-10

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215954522297       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215954522298       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215954522298       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215954522279       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215954522297       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215954522119       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.904800e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215954522297       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215954522297       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215954522297       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215954521635       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215954522006       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215954522297       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 4.761991e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.694208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0475e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1675
    reference variance = 0.229632
====================================================
  Execution time = 4.0317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2566e-01
  Total weights = 2.0000e+06
  Execution time = 3.6115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325700730534
                                         uncertainty =       0.003569976145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325700730534
                                         uncertainty =       0.003569976145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403523829
  error estimate for blocks of size 2^( 2) =       0.000412967709
  error estimate for blocks of size 2^( 3) =       0.000420894661
  error estimate for blocks of size 2^( 4) =       0.000426967979
  error estimate for blocks of size 2^( 5) =       0.000430284327
  error estimate for blocks of size 2^( 6) =       0.000431740347
  error estimate for blocks of size 2^( 7) =       0.000432360855

      target function =                  N/A
              le_mean =     -17.216157207337
             les_mean =     296.721731785626
             stat err =       0.000430338377
             autocorr =       1.137317663702
              std dev =       0.570668871345
             le_variance =       0.325662960722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325700729785
                                         uncertainty =       0.003569976140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325700729785
                                         uncertainty =       0.003569976140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403523828
  error estimate for blocks of size 2^( 2) =       0.000412967709
  error estimate for blocks of size 2^( 3) =       0.000420894661
  error estimate for blocks of size 2^( 4) =       0.000426967979
  error estimate for blocks of size 2^( 5) =       0.000430284326
  error estimate for blocks of size 2^( 6) =       0.000431740347
  error estimate for blocks of size 2^( 7) =       0.000432360855

      target function =                  N/A
              le_mean =     -17.216157207335
             les_mean =     296.721731784824
             stat err =       0.000430338377
             autocorr =       1.137317664209
              std dev =       0.570668870690
             le_variance =       0.325662959974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325700730160
                                         uncertainty =       0.003569976143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325700730160
                                         uncertainty =       0.003569976143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403523829
  error estimate for blocks of size 2^( 2) =       0.000412967709
  error estimate for blocks of size 2^( 3) =       0.000420894661
  error estimate for blocks of size 2^( 4) =       0.000426967979
  error estimate for blocks of size 2^( 5) =       0.000430284326
  error estimate for blocks of size 2^( 6) =       0.000431740347
  error estimate for blocks of size 2^( 7) =       0.000432360855

      target function =                  N/A
              le_mean =     -17.216157207336
             les_mean =     296.721731785225
             stat err =       0.000430338377
             autocorr =       1.137317663950
              std dev =       0.570668871017
             le_variance =       0.325662960348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325700730487
                                         uncertainty =       0.003569976145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325700730487
                                         uncertainty =       0.003569976145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403523829
  error estimate for blocks of size 2^( 2) =       0.000412967709
  error estimate for blocks of size 2^( 3) =       0.000420894661
  error estimate for blocks of size 2^( 4) =       0.000426967979
  error estimate for blocks of size 2^( 5) =       0.000430284327
  error estimate for blocks of size 2^( 6) =       0.000431740347
  error estimate for blocks of size 2^( 7) =       0.000432360855

      target function =                  N/A
              le_mean =     -17.216157207337
             les_mean =     296.721731785575
             stat err =       0.000430338377
             autocorr =       1.137317663730
              std dev =       0.570668871304
             le_variance =       0.325662960675


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216157207337        initial  <--
     1.4901e+05     1.4901e+06             7.6192e-10       -17.216157207335
     5.9605e+05     5.9605e+06             1.9048e-10       -17.216157207336
     2.3842e+06     2.3842e+07             4.7620e-11       -17.216157207337

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.4982
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0898e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1906
    reference variance = 0.202204
====================================================
  Execution time = 4.0873e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2559e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1002e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325449204197
                                         uncertainty =       0.003338382267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325449204197
                                         uncertainty =       0.003338382267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403480270
  error estimate for blocks of size 2^( 2) =       0.000412910573
  error estimate for blocks of size 2^( 3) =       0.000421292451
  error estimate for blocks of size 2^( 4) =       0.000428052795
  error estimate for blocks of size 2^( 5) =       0.000432410990
  error estimate for blocks of size 2^( 6) =       0.000434097363
  error estimate for blocks of size 2^( 7) =       0.000435469346

      target function =                  N/A
              le_mean =     -17.216367750663
             les_mean =     296.728911019354
             stat err =       0.000432507624
             autocorr =       1.149060588145
              std dev =       0.570607269570
             le_variance =       0.325592656086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636775066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216367750663       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367750663       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216367750663       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216367750378       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216367750786       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216367750674       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216367751449       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.163509e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216367750663       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367750663       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216367750663       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216367750663       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216367750663       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216367752073       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216367751445       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 2.908786e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216367750663       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367750663       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216367750663       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216367749664       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216367749343       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216367740536       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216367746780       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 7.271894e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.697275 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1883e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2714
    reference variance = 0.360718
====================================================
  Execution time = 3.9100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2539e-01
  Total weights = 2.0000e+06
  Execution time = 3.6087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325436741070
                                         uncertainty =       0.004150546362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325436741070
                                         uncertainty =       0.004150546362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403357304
  error estimate for blocks of size 2^( 2) =       0.000412398813
  error estimate for blocks of size 2^( 3) =       0.000420559459
  error estimate for blocks of size 2^( 4) =       0.000426357851
  error estimate for blocks of size 2^( 5) =       0.000431229302
  error estimate for blocks of size 2^( 6) =       0.000432042249
  error estimate for blocks of size 2^( 7) =       0.000434493091

      target function =                  N/A
              le_mean =     -17.216557013745
             les_mean =     296.735229473766
             stat err =       0.000431030623
             autocorr =       1.141921900591
              std dev =       0.570433369400
             le_variance =       0.325394228925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325436740891
                                         uncertainty =       0.004150546360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325436740891
                                         uncertainty =       0.004150546360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403357304
  error estimate for blocks of size 2^( 2) =       0.000412398813
  error estimate for blocks of size 2^( 3) =       0.000420559459
  error estimate for blocks of size 2^( 4) =       0.000426357851
  error estimate for blocks of size 2^( 5) =       0.000431229302
  error estimate for blocks of size 2^( 6) =       0.000432042249
  error estimate for blocks of size 2^( 7) =       0.000434493090

      target function =                  N/A
              le_mean =     -17.216557013745
             les_mean =     296.735229473590
             stat err =       0.000431030623
             autocorr =       1.141921900705
              std dev =       0.570433369243
             le_variance =       0.325394228745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325436740980
                                         uncertainty =       0.004150546361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325436740980
                                         uncertainty =       0.004150546361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403357304
  error estimate for blocks of size 2^( 2) =       0.000412398813
  error estimate for blocks of size 2^( 3) =       0.000420559459
  error estimate for blocks of size 2^( 4) =       0.000426357851
  error estimate for blocks of size 2^( 5) =       0.000431229302
  error estimate for blocks of size 2^( 6) =       0.000432042249
  error estimate for blocks of size 2^( 7) =       0.000434493090

      target function =                  N/A
              le_mean =     -17.216557013745
             les_mean =     296.735229473678
             stat err =       0.000431030623
             autocorr =       1.141921900637
              std dev =       0.570433369321
             le_variance =       0.325394228835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325436741059
                                         uncertainty =       0.004150546362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325436741059
                                         uncertainty =       0.004150546362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403357304
  error estimate for blocks of size 2^( 2) =       0.000412398813
  error estimate for blocks of size 2^( 3) =       0.000420559459
  error estimate for blocks of size 2^( 4) =       0.000426357851
  error estimate for blocks of size 2^( 5) =       0.000431229302
  error estimate for blocks of size 2^( 6) =       0.000432042249
  error estimate for blocks of size 2^( 7) =       0.000434493091

      target function =                  N/A
              le_mean =     -17.216557013745
             les_mean =     296.735229473755
             stat err =       0.000431030623
             autocorr =       1.141921900595
              std dev =       0.570433369390
             le_variance =       0.325394228914


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216557013745        initial
     1.4901e+06     1.4901e+07             1.1635e-10       -17.216557013745  <--
     5.9605e+06     5.9605e+07             2.9088e-11       -17.216557013745
     2.3842e+07     2.3842e+08             7.2719e-12       -17.216557013745

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 5.7306e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0920e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2936
    reference variance = 0.796075
====================================================
  Execution time = 3.9501e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2343e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0779e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322936459769
                                         uncertainty =       0.003651508481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322936459769
                                         uncertainty =       0.003651508481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402140945
  error estimate for blocks of size 2^( 2) =       0.000411589219
  error estimate for blocks of size 2^( 3) =       0.000420191175
  error estimate for blocks of size 2^( 4) =       0.000425771482
  error estimate for blocks of size 2^( 5) =       0.000429849759
  error estimate for blocks of size 2^( 6) =       0.000432602033
  error estimate for blocks of size 2^( 7) =       0.000433090212

      target function =                  N/A
              le_mean =     -17.216737889604
             les_mean =     296.739498076154
             stat err =       0.000430328371
             autocorr =       1.145099888658
              std dev =       0.568713177740
             le_variance =       0.323434678535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673788960e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216737889604       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216737889605       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216737889607       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216737889606       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216737889633       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216737889317       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216737889599       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 4.062715e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216737889604       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216737889604       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216737889605       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216737889605       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216737889181       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216737889538       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216737889107       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.015680e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216737889604       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216737889604       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216737889604       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216737889581       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216737892478       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216737891019       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216737885623       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 2.539193e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.700319 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0288e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814868e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775443e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.296801
====================================================
  Execution time = 3.9491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3034e-01
  Total weights = 2.0000e+06
  Execution time = 3.6139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330348681922
                                         uncertainty =       0.006754298814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330348681922
                                         uncertainty =       0.006754298814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406409131
  error estimate for blocks of size 2^( 2) =       0.000415704138
  error estimate for blocks of size 2^( 3) =       0.000423698856
  error estimate for blocks of size 2^( 4) =       0.000429989756
  error estimate for blocks of size 2^( 5) =       0.000433529185
  error estimate for blocks of size 2^( 6) =       0.000436228143
  error estimate for blocks of size 2^( 7) =       0.000437190459

      target function =                  N/A
              le_mean =     -17.216659471190
             les_mean =     296.743699945574
             stat err =       0.000434234386
             autocorr =       1.141619839209
              std dev =       0.574749305207
             le_variance =       0.330336763836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330348681540
                                         uncertainty =       0.006754298812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330348681540
                                         uncertainty =       0.006754298812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406409131
  error estimate for blocks of size 2^( 2) =       0.000415704137
  error estimate for blocks of size 2^( 3) =       0.000423698856
  error estimate for blocks of size 2^( 4) =       0.000429989755
  error estimate for blocks of size 2^( 5) =       0.000433529185
  error estimate for blocks of size 2^( 6) =       0.000436228143
  error estimate for blocks of size 2^( 7) =       0.000437190459

      target function =                  N/A
              le_mean =     -17.216659471191
             les_mean =     296.743699945245
             stat err =       0.000434234385
             autocorr =       1.141619839365
              std dev =       0.574749304875
             le_variance =       0.330336763455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330348681731
                                         uncertainty =       0.006754298813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330348681731
                                         uncertainty =       0.006754298813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406409131
  error estimate for blocks of size 2^( 2) =       0.000415704137
  error estimate for blocks of size 2^( 3) =       0.000423698856
  error estimate for blocks of size 2^( 4) =       0.000429989756
  error estimate for blocks of size 2^( 5) =       0.000433529185
  error estimate for blocks of size 2^( 6) =       0.000436228143
  error estimate for blocks of size 2^( 7) =       0.000437190459

      target function =                  N/A
              le_mean =     -17.216659471190
             les_mean =     296.743699945410
             stat err =       0.000434234385
             autocorr =       1.141619839289
              std dev =       0.574749305041
             le_variance =       0.330336763645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330348681898
                                         uncertainty =       0.006754298814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330348681898
                                         uncertainty =       0.006754298814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406409131
  error estimate for blocks of size 2^( 2) =       0.000415704138
  error estimate for blocks of size 2^( 3) =       0.000423698856
  error estimate for blocks of size 2^( 4) =       0.000429989756
  error estimate for blocks of size 2^( 5) =       0.000433529185
  error estimate for blocks of size 2^( 6) =       0.000436228143
  error estimate for blocks of size 2^( 7) =       0.000437190459

      target function =                  N/A
              le_mean =     -17.216659471190
             les_mean =     296.743699945554
             stat err =       0.000434234386
             autocorr =       1.141619839220
              std dev =       0.574749305187
             le_variance =       0.330336763812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216659471190        initial
     3.7253e+05     3.7253e+06             4.0627e-10       -17.216659471191  <--
     1.4901e+06     1.4901e+07             1.0157e-10       -17.216659471190
     5.9605e+06     5.9605e+07             2.5392e-11       -17.216659471190

*****************************************************************************
Applying the update for shift_i =   3.7253e+05     and shift_s =   3.7253e+06
*****************************************************************************

  Execution time = 5.7713e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814867e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775442e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0801e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2399
    reference variance = 0.152874
====================================================
  Execution time = 4.0297e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3406e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0798e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334091702680
                                         uncertainty =       0.010526189479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334091702680
                                         uncertainty =       0.010526189479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408695605
  error estimate for blocks of size 2^( 2) =       0.000417881647
  error estimate for blocks of size 2^( 3) =       0.000426297359
  error estimate for blocks of size 2^( 4) =       0.000431751963
  error estimate for blocks of size 2^( 5) =       0.000435061488
  error estimate for blocks of size 2^( 6) =       0.000436983686
  error estimate for blocks of size 2^( 7) =       0.000439729451

      target function =                  N/A
              le_mean =     -17.217344720850
             les_mean =     296.771023264263
             stat err =       0.000435881647
             autocorr =       1.137462878694
              std dev =       0.577982867150
             le_variance =       0.334064194719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721734472085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217344720850       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217344720859       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217344720848       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217344720850       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217344720838       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217344720851       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217344720831       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.732177e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217344720850       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217344720852       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217344720849       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217344720749       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217344721040       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217344720797       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217344720837       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.830467e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217344720850       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217344720850       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217344720850       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217344720850       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217344720850       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217344721076       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217344721157       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.707618e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.703430 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1103e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766900e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563874e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814867e-03 1 1  ON 34
eH1_5                 3.426035e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342878e-03 1 1  ON 44
eH2_5                 8.775442e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1876
    reference variance = 0.534676
====================================================
  Execution time = 4.0275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2127e-01
  Total weights = 2.0000e+06
  Execution time = 3.6708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321292066201
                                         uncertainty =       0.003919728367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321292066201
                                         uncertainty =       0.003919728367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400793325
  error estimate for blocks of size 2^( 2) =       0.000410337723
  error estimate for blocks of size 2^( 3) =       0.000417962217
  error estimate for blocks of size 2^( 4) =       0.000423997858
  error estimate for blocks of size 2^( 5) =       0.000427925408
  error estimate for blocks of size 2^( 6) =       0.000431334921
  error estimate for blocks of size 2^( 7) =       0.000431400663

      target function =                  N/A
              le_mean =     -17.216962537687
             les_mean =     296.745069442152
             stat err =       0.000428664712
             autocorr =       1.143916983272
              std dev =       0.566807355857
             le_variance =       0.321270578654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321292063196
                                         uncertainty =       0.003919728329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321292063196
                                         uncertainty =       0.003919728329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400793323
  error estimate for blocks of size 2^( 2) =       0.000410337721
  error estimate for blocks of size 2^( 3) =       0.000417962215
  error estimate for blocks of size 2^( 4) =       0.000423997856
  error estimate for blocks of size 2^( 5) =       0.000427925406
  error estimate for blocks of size 2^( 6) =       0.000431334919
  error estimate for blocks of size 2^( 7) =       0.000431400661

      target function =                  N/A
              le_mean =     -17.216962537706
             les_mean =     296.745069439790
             stat err =       0.000428664711
             autocorr =       1.143916985091
              std dev =       0.566807353206
             le_variance =       0.321270575648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321292064698
                                         uncertainty =       0.003919728348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321292064698
                                         uncertainty =       0.003919728348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400793324
  error estimate for blocks of size 2^( 2) =       0.000410337722
  error estimate for blocks of size 2^( 3) =       0.000417962216
  error estimate for blocks of size 2^( 4) =       0.000423997857
  error estimate for blocks of size 2^( 5) =       0.000427925407
  error estimate for blocks of size 2^( 6) =       0.000431334920
  error estimate for blocks of size 2^( 7) =       0.000431400662

      target function =                  N/A
              le_mean =     -17.216962537697
             les_mean =     296.745069440971
             stat err =       0.000428664711
             autocorr =       1.143916984177
              std dev =       0.566807354531
             le_variance =       0.321270577151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321292066014
                                         uncertainty =       0.003919728364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321292066014
                                         uncertainty =       0.003919728364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400793325
  error estimate for blocks of size 2^( 2) =       0.000410337723
  error estimate for blocks of size 2^( 3) =       0.000417962217
  error estimate for blocks of size 2^( 4) =       0.000423997858
  error estimate for blocks of size 2^( 5) =       0.000427925408
  error estimate for blocks of size 2^( 6) =       0.000431334921
  error estimate for blocks of size 2^( 7) =       0.000431400663

      target function =                  N/A
              le_mean =     -17.216962537689
             les_mean =     296.745069442005
             stat err =       0.000428664712
             autocorr =       1.143916983379
              std dev =       0.566807355691
             le_variance =       0.321270578466


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216962537687        initial
     9.3132e+04     9.3132e+05             2.7322e-09       -17.216962537706  <--
     3.7253e+05     3.7253e+06             6.8305e-10       -17.216962537697
     1.4901e+06     1.4901e+07             1.7076e-10       -17.216962537689

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 5.8483e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.900908e-01 1 1  ON 0
 uu_1                 2.766899e-02 1 1  ON 1
 uu_2                -6.712008e-02 1 1  ON 2
 uu_3                -1.233850e-01 1 1  ON 3
 uu_4                -1.599952e-01 1 1  ON 4
 uu_5                -1.724922e-01 1 1  ON 5
 uu_6                -1.594272e-01 1 1  ON 6
 uu_7                -1.136794e-01 1 1  ON 7
 uu_8                -3.711584e-02 1 1  ON 8
 uu_9                 1.619959e-01 1 1  ON 9
 ud_0                 3.445745e-01 1 1  ON 10
 ud_1                 8.858809e-02 1 1  ON 11
 ud_2                -1.688695e-02 1 1  ON 12
 ud_3                -7.711815e-02 1 1  ON 13
 ud_4                -1.286176e-01 1 1  ON 14
 ud_5                -1.681282e-01 1 1  ON 15
 ud_6                -1.818350e-01 1 1  ON 16
 ud_7                -1.593236e-01 1 1  ON 17
 ud_8                -9.915845e-02 1 1  ON 18
 ud_9                -8.563873e-03 1 1  ON 19
 eO_0                -9.170178e-01 1 1  ON 20
 eO_1                -5.998458e-01 1 1  ON 21
 eO_2                -1.934355e-01 1 1  ON 22
 eO_3                 7.456347e-02 1 1  ON 23
 eO_4                 2.040319e-01 1 1  ON 24
 eO_5                 2.942542e-01 1 1  ON 25
 eO_6                 3.344180e-01 1 1  ON 26
 eO_7                 5.024660e-01 1 1  ON 27
 eO_8                 1.937198e-01 1 1  ON 28
 eO_9                 6.108356e-02 1 1  ON 29
eH1_0                -2.104790e-01 1 1  ON 30
eH1_1                -1.324596e-01 1 1  ON 31
eH1_2                -9.144633e-02 1 1  ON 32
eH1_3                -5.413807e-02 1 1  ON 33
eH1_4                -7.814867e-03 1 1  ON 34
eH1_5                 3.426036e-03 1 1  ON 35
eH1_6                 4.134862e-02 1 1  ON 36
eH1_7                 6.448167e-02 1 1  ON 37
eH1_8                 1.799388e-01 1 1  ON 38
eH1_9                 1.209295e-01 1 1  ON 39
eH2_0                -2.062053e-01 1 1  ON 40
eH2_1                -1.275402e-01 1 1  ON 41
eH2_2                -8.640355e-02 1 1  ON 42
eH2_3                -4.935045e-02 1 1  ON 43
eH2_4                -3.342877e-03 1 1  ON 44
eH2_5                 8.775442e-03 1 1  ON 45
eH2_6                 4.709264e-02 1 1  ON 46
eH2_7                 4.599308e-02 1 1  ON 47
eH2_8                 1.982614e-01 1 1  ON 48
eH2_9                 1.200575e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0959e+02 secs
  Total Execution time = 4.4020e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
