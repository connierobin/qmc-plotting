Rank =    0  Free Memory = 80728 MB
Rank =    1  Free Memory = 80728 MB
Rank =    2  Free Memory = 80728 MB
Rank =    3  Free Memory = 80729 MB
Rank =    4  Free Memory = 80729 MB
Rank =    5  Free Memory = 80729 MB
Rank =    6  Free Memory = 80729 MB
Rank =    7  Free Memory = 80728 MB
Rank =    8  Free Memory = 80728 MB
Rank =    9  Free Memory = 80727 MB
Rank =   10  Free Memory = 80727 MB
Rank =   11  Free Memory = 80727 MB
Rank =   12  Free Memory = 80727 MB
Rank =   13  Free Memory = 80727 MB
Rank =   14  Free Memory = 80726 MB
Rank =   15  Free Memory = 80710 MB
Rank =   16  Free Memory = 80710 MB
Rank =   17  Free Memory = 80710 MB
Rank =   18  Free Memory = 80710 MB
Rank =   19  Free Memory = 80710 MB
Rank =   20  Free Memory = 80710 MB
Rank =   21  Free Memory = 80710 MB
Rank =   22  Free Memory = 80710 MB
Rank =   23  Free Memory = 80710 MB
Rank =   24  Free Memory = 80710 MB
Rank =   25  Free Memory = 80710 MB
Rank =   26  Free Memory = 80710 MB
Rank =   27  Free Memory = 80710 MB
Rank =   28  Free Memory = 80710 MB
Rank =   29  Free Memory = 80710 MB
Rank =   30  Free Memory = 80710 MB
Rank =   31  Free Memory = 80709 MB
Rank =   32  Free Memory = 74601 MB
Rank =   33  Free Memory = 74601 MB
Rank =   34  Free Memory = 74600 MB
Rank =   35  Free Memory = 74600 MB
Rank =   36  Free Memory = 74600 MB
Rank =   37  Free Memory = 74600 MB
Rank =   38  Free Memory = 74600 MB
Rank =   39  Free Memory = 74600 MB
Rank =   40  Free Memory = 74600 MB
Rank =   41  Free Memory = 74600 MB
Rank =   42  Free Memory = 74600 MB
Rank =   43  Free Memory = 74600 MB
Rank =   44  Free Memory = 74600 MB
Rank =   45  Free Memory = 74600 MB
Rank =   46  Free Memory = 74600 MB
Rank =   47  Free Memory = 74600 MB
Rank =   48  Free Memory = 74600 MB
Rank =   49  Free Memory = 74600 MB
Rank =   50  Free Memory = 74600 MB
Rank =   51  Free Memory = 74600 MB
Rank =   52  Free Memory = 74600 MB
Rank =   53  Free Memory = 74600 MB
Rank =   54  Free Memory = 74600 MB
Rank =   55  Free Memory = 74600 MB
Rank =   56  Free Memory = 74600 MB
Rank =   57  Free Memory = 74600 MB
Rank =   58  Free Memory = 74600 MB
Rank =   59  Free Memory = 74600 MB
Rank =   60  Free Memory = 74600 MB
Rank =   61  Free Memory = 74600 MB
Rank =   62  Free Memory = 74600 MB
Rank =   63  Free Memory = 74600 MB
Rank =   64  Free Memory = 86420 MB
Rank =   65  Free Memory = 86420 MB
Rank =   66  Free Memory = 86420 MB
Rank =   67  Free Memory = 86420 MB
Rank =   68  Free Memory = 86420 MB
Rank =   69  Free Memory = 86420 MB
Rank =   70  Free Memory = 86420 MB
Rank =   71  Free Memory = 86420 MB
Rank =   72  Free Memory = 86420 MB
Rank =   73  Free Memory = 86420 MB
Rank =   74  Free Memory = 86420 MB
Rank =   75  Free Memory = 86420 MB
Rank =   76  Free Memory = 86420 MB
Rank =   77  Free Memory = 86420 MB
Rank =   78  Free Memory = 86420 MB
Rank =   79  Free Memory = 86420 MB
Rank =   80  Free Memory = 86420 MB
Rank =   81  Free Memory = 86420 MB
Rank =   82  Free Memory = 86420 MB
Rank =   83  Free Memory = 86420 MB
Rank =   84  Free Memory = 86420 MB
Rank =   85  Free Memory = 86420 MB
Rank =   86  Free Memory = 86420 MB
Rank =   87  Free Memory = 86420 MB
Rank =   88  Free Memory = 86420 MB
Rank =   89  Free Memory = 86420 MB
Rank =   90  Free Memory = 86420 MB
Rank =   91  Free Memory = 86420 MB
Rank =   92  Free Memory = 86420 MB
Rank =   93  Free Memory = 86420 MB
Rank =   94  Free Memory = 86420 MB
Rank =   95  Free Memory = 86420 MB
Rank =   96  Free Memory = 86789 MB
Rank =   97  Free Memory = 86789 MB
Rank =   98  Free Memory = 86789 MB
Rank =   99  Free Memory = 86789 MB
Rank =  100  Free Memory = 86789 MB
Rank =  101  Free Memory = 86789 MB
Rank =  102  Free Memory = 86789 MB
Rank =  103  Free Memory = 86789 MB
Rank =  104  Free Memory = 86789 MB
Rank =  105  Free Memory = 86788 MB
Rank =  106  Free Memory = 86788 MB
Rank =  107  Free Memory = 86788 MB
Rank =  108  Free Memory = 86788 MB
Rank =  109  Free Memory = 86788 MB
Rank =  110  Free Memory = 86788 MB
Rank =  111  Free Memory = 86788 MB
Rank =  112  Free Memory = 86788 MB
Rank =  113  Free Memory = 86788 MB
Rank =  114  Free Memory = 86788 MB
Rank =  115  Free Memory = 86788 MB
Rank =  116  Free Memory = 86788 MB
Rank =  117  Free Memory = 86788 MB
Rank =  118  Free Memory = 86788 MB
Rank =  119  Free Memory = 86788 MB
Rank =  120  Free Memory = 86788 MB
Rank =  121  Free Memory = 86788 MB
Rank =  122  Free Memory = 86788 MB
Rank =  123  Free Memory = 86788 MB
Rank =  124  Free Memory = 86788 MB
Rank =  125  Free Memory = 86788 MB
Rank =  126  Free Memory = 86788 MB
Rank =  127  Free Memory = 86788 MB
  Input file(s): opt_h2o_gs_gvpabs_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvpabs_run001b.xml

  Project = H2O
  date    = 2023-03-24 01:49:54 PDT
  host    = n0019.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 50

  Range of prime numbers to use as seeds over processors and threads = 239-1069


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.735164e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.8272e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1671
    reference variance = 0.331273
====================================================
  Execution time = 2.0341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1977e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319628117022
                                         uncertainty =       0.009078841488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319628117022
                                         uncertainty =       0.009078841488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399857593
  error estimate for blocks of size 2^( 2) =       0.000411192778
  error estimate for blocks of size 2^( 3) =       0.000421668445
  error estimate for blocks of size 2^( 4) =       0.000428525330
  error estimate for blocks of size 2^( 5) =       0.000432590472
  error estimate for blocks of size 2^( 6) =       0.000434733299
  error estimate for blocks of size 2^( 7) =       0.000435224986

      target function =                  N/A
              le_mean =     -17.213973813325
             les_mean =     296.640666475458
             stat err =       0.000432768522
             autocorr =       1.171387628677
              std dev =       0.565484031167
             le_variance =       0.319772189505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721397381333e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213973813325       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214293872692       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214443038544       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214605385081       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214775821816       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214817557851       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214845707344       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214859672660       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214860817791       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214861320393       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214862117801       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214862235407       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214862181340       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.701639e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213973813325       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214113622176       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214176303249       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214243825591       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214316704476       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214331925784       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214335962563       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214337133681       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214337145244       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214337079894       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214337094068       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.466467e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213973813325       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214016794967       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214036260634       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214057562934       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214078920983       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214083221428       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214083981583       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214084061600       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214084052373       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214084015480       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214084016142       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.516797e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5935e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.927322e-01                 1 1 ON  0
uu_1  3.708489e-02                 1 1 ON  1
uu_2  -4.647170e-02                1 1 ON  2
uu_3  -9.438126e-02                1 1 ON  3
uu_4  -1.253142e-01                1 1 ON  4
uu_5  -1.326655e-01                1 1 ON  5
uu_6  -1.094641e-01                1 1 ON  6
uu_7  -3.348307e-02                1 1 ON  7
uu_8  1.030070e-01                 1 1 ON  8
uu_9  1.188832e-01                 1 1 ON  9
ud_0  3.198471e-01                 1 1 ON  10
ud_1  7.789702e-02                 1 1 ON  11
ud_2  -1.008755e-02                1 1 ON  12
ud_3  -5.815978e-02                1 1 ON  13
ud_4  -1.072935e-01                1 1 ON  14
ud_5  -1.487402e-01                1 1 ON  15
ud_6  -1.576944e-01                1 1 ON  16
ud_7  -1.081348e-01                1 1 ON  17
ud_8  9.565018e-03                 1 1 ON  18
ud_9  9.249041e-02                 1 1 ON  19
eO_0  -6.866359e-01                1 1 ON  20
eO_1  -4.052202e-01                1 1 ON  21
eO_2  -5.642124e-02                1 1 ON  22
eO_3  1.650692e-01                 1 1 ON  23
eO_4  2.643938e-01                 1 1 ON  24
eO_5  3.065914e-01                 1 1 ON  25
eO_6  2.481821e-01                 1 1 ON  26
eO_7  1.082426e-01                 1 1 ON  27
eO_8  2.729507e-02                 1 1 ON  28
eO_9  1.814265e-02                 1 1 ON  29
eH1_0 -1.760558e-01                1 1 ON  30
eH1_1 -9.843507e-02                1 1 ON  31
eH1_2 -6.249100e-02                1 1 ON  32
eH1_3 -2.842720e-02                1 1 ON  33
eH1_4 1.793820e-02                 1 1 ON  34
eH1_5 3.113315e-02                 1 1 ON  35
eH1_6 7.769054e-02                 1 1 ON  36
eH1_7 1.114244e-01                 1 1 ON  37
eH1_8 8.858844e-02                 1 1 ON  38
eH1_9 2.360581e-02                 1 1 ON  39
eH2_0 -1.777812e-01                1 1 ON  40
eH2_1 -1.002205e-01                1 1 ON  41
eH2_2 -6.447593e-02                1 1 ON  42
eH2_3 -2.991048e-02                1 1 ON  43
eH2_4 1.661063e-02                 1 1 ON  44
eH2_5 3.143609e-02                 1 1 ON  45
eH2_6 8.002139e-02                 1 1 ON  46
eH2_7 1.151580e-01                 1 1 ON  47
eH2_8 9.164796e-02                 1 1 ON  48
eH2_9 2.563650e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.0975
    reference variance = 0.193425
====================================================
  Execution time = 2.0325e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0447e-01
  Total weights = 2.0000e+06
  Execution time = 1.8195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303073304405
                                         uncertainty =       0.002613122755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303073304405
                                         uncertainty =       0.002613122755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389293596
  error estimate for blocks of size 2^( 2) =       0.000401146368
  error estimate for blocks of size 2^( 3) =       0.000411415506
  error estimate for blocks of size 2^( 4) =       0.000418986166
  error estimate for blocks of size 2^( 5) =       0.000422930873
  error estimate for blocks of size 2^( 6) =       0.000423937560
  error estimate for blocks of size 2^( 7) =       0.000424145858

      target function =                  N/A
              le_mean =     -17.214822137618
             les_mean =     296.653200085396
             stat err =       0.000422500114
             autocorr =       1.177874835002
              std dev =       0.550544282627
             le_variance =       0.303099007133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308405491159
                                         uncertainty =       0.002716926977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308405491159
                                         uncertainty =       0.002716926977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392706386
  error estimate for blocks of size 2^( 2) =       0.000403523976
  error estimate for blocks of size 2^( 3) =       0.000412944079
  error estimate for blocks of size 2^( 4) =       0.000420056191
  error estimate for blocks of size 2^( 5) =       0.000423778270
  error estimate for blocks of size 2^( 6) =       0.000424579419
  error estimate for blocks of size 2^( 7) =       0.000425115457

      target function =                  N/A
              le_mean =     -17.214914736844
             les_mean =     296.661725853798
             stat err =       0.000423382334
             autocorr =       1.162330245577
              std dev =       0.555370697103
             le_variance =       0.308436611200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306941802510
                                         uncertainty =       0.002695501740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306941802510
                                         uncertainty =       0.002695501740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391773270
  error estimate for blocks of size 2^( 2) =       0.000402783384
  error estimate for blocks of size 2^( 3) =       0.000412378013
  error estimate for blocks of size 2^( 4) =       0.000419593072
  error estimate for blocks of size 2^( 5) =       0.000423381596
  error estimate for blocks of size 2^( 6) =       0.000424198159
  error estimate for blocks of size 2^( 7) =       0.000424686280

      target function =                  N/A
              le_mean =     -17.214847936513
             les_mean =     296.657961914363
             stat err =       0.000422964777
             autocorr =       1.165571179480
              std dev =       0.554051072183
             le_variance =       0.306972590587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303333116482
                                         uncertainty =       0.002624712254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303333116482
                                         uncertainty =       0.002624712254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389460926
  error estimate for blocks of size 2^( 2) =       0.000401171838
  error estimate for blocks of size 2^( 3) =       0.000411330946
  error estimate for blocks of size 2^( 4) =       0.000418844237
  error estimate for blocks of size 2^( 5) =       0.000422766166
  error estimate for blocks of size 2^( 6) =       0.000423739415
  error estimate for blocks of size 2^( 7) =       0.000423989248

      target function =                  N/A
              le_mean =     -17.214784020319
             les_mean =     296.652148340373
             stat err =       0.000422334766
             autocorr =       1.175941949272
              std dev =       0.550780923611
             le_variance =       0.303359625813


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214822137618        initial
     2.5000e-01     2.5000e+00             1.7016e-02       -17.214914736844  <--
     1.0000e+00     1.0000e+01             5.4665e-03       -17.214847936513
     4.0000e+00     4.0000e+01             1.5168e-03       -17.214784020319

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9531e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.948965e-01 1 1  ON 0
 uu_1                 3.875985e-02 1 1  ON 1
 uu_2                -4.746537e-02 1 1  ON 2
 uu_3                -9.586274e-02 1 1  ON 3
 uu_4                -1.258463e-01 1 1  ON 4
 uu_5                -1.326452e-01 1 1  ON 5
 uu_6                -1.099327e-01 1 1  ON 6
 uu_7                -3.411921e-02 1 1  ON 7
 uu_8                 1.027811e-01 1 1  ON 8
 uu_9                 1.191091e-01 1 1  ON 9
 ud_0                 3.273658e-01 1 1  ON 10
 ud_1                 8.071476e-02 1 1  ON 11
 ud_2                -1.312475e-02 1 1  ON 12
 ud_3                -6.296703e-02 1 1  ON 13
 ud_4                -1.096418e-01 1 1  ON 14
 ud_5                -1.481472e-01 1 1  ON 15
 ud_6                -1.575076e-01 1 1  ON 16
 ud_7                -1.087328e-01 1 1  ON 17
 ud_8                 9.048817e-03 1 1  ON 18
 ud_9                 9.249902e-02 1 1  ON 19
 eO_0                -6.981858e-01 1 1  ON 20
 eO_1                -4.095618e-01 1 1  ON 21
 eO_2                -4.894602e-02 1 1  ON 22
 eO_3                 1.724075e-01 1 1  ON 23
 eO_4                 2.657976e-01 1 1  ON 24
 eO_5                 3.057689e-01 1 1  ON 25
 eO_6                 2.481908e-01 1 1  ON 26
 eO_7                 1.085955e-01 1 1  ON 27
 eO_8                 2.736858e-02 1 1  ON 28
 eO_9                 1.818336e-02 1 1  ON 29
eH1_0                -1.768123e-01 1 1  ON 30
eH1_1                -9.882525e-02 1 1  ON 31
eH1_2                -6.273414e-02 1 1  ON 32
eH1_3                -2.779942e-02 1 1  ON 33
eH1_4                 1.837529e-02 1 1  ON 34
eH1_5                 3.176293e-02 1 1  ON 35
eH1_6                 7.730077e-02 1 1  ON 36
eH1_7                 1.112230e-01 1 1  ON 37
eH1_8                 8.877808e-02 1 1  ON 38
eH1_9                 2.367447e-02 1 1  ON 39
eH2_0                -1.785789e-01 1 1  ON 40
eH2_1                -1.006713e-01 1 1  ON 41
eH2_2                -6.449483e-02 1 1  ON 42
eH2_3                -2.924564e-02 1 1  ON 43
eH2_4                 1.731503e-02 1 1  ON 44
eH2_5                 3.181027e-02 1 1  ON 45
eH2_6                 7.948216e-02 1 1  ON 46
eH2_7                 1.149219e-01 1 1  ON 47
eH2_8                 9.185428e-02 1 1  ON 48
eH2_9                 2.570634e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7132e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.142646
====================================================
  Execution time = 2.0095e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2051e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320418639576
                                         uncertainty =       0.005827313619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320418639576
                                         uncertainty =       0.005827313619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400316566
  error estimate for blocks of size 2^( 2) =       0.000410802368
  error estimate for blocks of size 2^( 3) =       0.000420544722
  error estimate for blocks of size 2^( 4) =       0.000426542639
  error estimate for blocks of size 2^( 5) =       0.000430024564
  error estimate for blocks of size 2^( 6) =       0.000432640896
  error estimate for blocks of size 2^( 7) =       0.000431521907

      target function =                  N/A
              le_mean =     -17.215073938183
             les_mean =     296.679277243666
             stat err =       0.000430182501
             autocorr =       1.154777610297
              std dev =       0.566133117582
             le_variance =       0.320506706823


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721507393818e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215073938183       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215162369967       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215241464125       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215331595592       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215349404262       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215382541289       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215437596934       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215461393023       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215463391235       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215473873029       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215475458632       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215477157591       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215477498143       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215478619579       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215477755601       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215477909723       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.834202e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215073938183       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215130484771       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215176282791       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215227805929       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215243095560       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215255287251       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215274194350       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215280446205       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215279289498       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215281073899       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215281208634       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215281027047       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.157056e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215073938183       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215097091496       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215115290358       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215134203882       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215140466071       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215144501365       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215148222216       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215148979757       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215148683736       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215148909728       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215148891908       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.644705e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5683e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.972963e-01 1 1  ON 0
 uu_1                 4.015853e-02 1 1  ON 1
 uu_2                -4.800613e-02 1 1  ON 2
 uu_3                -9.732648e-02 1 1  ON 3
 uu_4                -1.267544e-01 1 1  ON 4
 uu_5                -1.328607e-01 1 1  ON 5
 uu_6                -1.102822e-01 1 1  ON 6
 uu_7                -3.476545e-02 1 1  ON 7
 uu_8                 1.024587e-01 1 1  ON 8
 uu_9                 1.193664e-01 1 1  ON 9
 ud_0                 3.333463e-01 1 1  ON 10
 ud_1                 8.321921e-02 1 1  ON 11
 ud_2                -1.494048e-02 1 1  ON 12
 ud_3                -6.685543e-02 1 1  ON 13
 ud_4                -1.121960e-01 1 1  ON 14
 ud_5                -1.479512e-01 1 1  ON 15
 ud_6                -1.569361e-01 1 1  ON 16
 ud_7                -1.093440e-01 1 1  ON 17
 ud_8                 8.442678e-03 1 1  ON 18
 ud_9                 9.247988e-02 1 1  ON 19
 eO_0                -7.097563e-01 1 1  ON 20
 eO_1                -4.139641e-01 1 1  ON 21
 eO_2                -4.352578e-02 1 1  ON 22
 eO_3                 1.802726e-01 1 1  ON 23
 eO_4                 2.681798e-01 1 1  ON 24
 eO_5                 3.052255e-01 1 1  ON 25
 eO_6                 2.484392e-01 1 1  ON 26
 eO_7                 1.090675e-01 1 1  ON 27
 eO_8                 2.743530e-02 1 1  ON 28
 eO_9                 1.820774e-02 1 1  ON 29
eH1_0                -1.778149e-01 1 1  ON 30
eH1_1                -9.946553e-02 1 1  ON 31
eH1_2                -6.270688e-02 1 1  ON 32
eH1_3                -2.731796e-02 1 1  ON 33
eH1_4                 1.879797e-02 1 1  ON 34
eH1_5                 3.259204e-02 1 1  ON 35
eH1_6                 7.694454e-02 1 1  ON 36
eH1_7                 1.110631e-01 1 1  ON 37
eH1_8                 8.902937e-02 1 1  ON 38
eH1_9                 2.375156e-02 1 1  ON 39
eH2_0                -1.795626e-01 1 1  ON 40
eH2_1                -1.014688e-01 1 1  ON 41
eH2_2                -6.442603e-02 1 1  ON 42
eH2_3                -2.885371e-02 1 1  ON 43
eH2_4                 1.784198e-02 1 1  ON 44
eH2_5                 3.271551e-02 1 1  ON 45
eH2_6                 7.916358e-02 1 1  ON 46
eH2_7                 1.147316e-01 1 1  ON 47
eH2_8                 9.213015e-02 1 1  ON 48
eH2_9                 2.581197e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2467
    reference variance = 0.201078
====================================================
  Execution time = 1.9968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1037e-01
  Total weights = 2.0000e+06
  Execution time = 1.8230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306331457241
                                         uncertainty =       0.002739218487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306331457241
                                         uncertainty =       0.002739218487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391275118
  error estimate for blocks of size 2^( 2) =       0.000402028178
  error estimate for blocks of size 2^( 3) =       0.000411263670
  error estimate for blocks of size 2^( 4) =       0.000417556150
  error estimate for blocks of size 2^( 5) =       0.000421671876
  error estimate for blocks of size 2^( 6) =       0.000423885307
  error estimate for blocks of size 2^( 7) =       0.000423909181

      target function =                  N/A
              le_mean =     -17.215595327106
             les_mean =     296.682914748884
             stat err =       0.000421755629
             autocorr =       1.161869397630
              std dev =       0.553346577922
             le_variance =       0.306192435298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314743568347
                                         uncertainty =       0.002823757122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314743568347
                                         uncertainty =       0.002823757122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396610431
  error estimate for blocks of size 2^( 2) =       0.000406748074
  error estimate for blocks of size 2^( 3) =       0.000415418059
  error estimate for blocks of size 2^( 4) =       0.000421390205
  error estimate for blocks of size 2^( 5) =       0.000425396006
  error estimate for blocks of size 2^( 6) =       0.000427567423
  error estimate for blocks of size 2^( 7) =       0.000427644727

      target function =                  N/A
              le_mean =     -17.215541122260
             les_mean =     296.689455643226
             stat err =       0.000425499590
             autocorr =       1.150985964021
              std dev =       0.560891850795
             le_variance =       0.314599668289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315785074185
                                         uncertainty =       0.002823493667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315785074185
                                         uncertainty =       0.002823493667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397266319
  error estimate for blocks of size 2^( 2) =       0.000407392614
  error estimate for blocks of size 2^( 3) =       0.000416067967
  error estimate for blocks of size 2^( 4) =       0.000422052580
  error estimate for blocks of size 2^( 5) =       0.000426072807
  error estimate for blocks of size 2^( 6) =       0.000428250192
  error estimate for blocks of size 2^( 7) =       0.000428323869

      target function =                  N/A
              le_mean =     -17.215564451684
             les_mean =     296.691300288642
             stat err =       0.000426174862
             autocorr =       1.150832626248
              std dev =       0.561819416165
             le_variance =       0.315641056380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307823698889
                                         uncertainty =       0.002754225724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307823698889
                                         uncertainty =       0.002754225724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392226820
  error estimate for blocks of size 2^( 2) =       0.000402835809
  error estimate for blocks of size 2^( 3) =       0.000411948905
  error estimate for blocks of size 2^( 4) =       0.000418175891
  error estimate for blocks of size 2^( 5) =       0.000422270136
  error estimate for blocks of size 2^( 6) =       0.000424473383
  error estimate for blocks of size 2^( 7) =       0.000424505616

      target function =                  N/A
              le_mean =     -17.215534454286
             les_mean =     296.682310150213
             stat err =       0.000422356257
             autocorr =       1.159533470676
              std dev =       0.554692489007
             le_variance =       0.307683757360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215595327106        initial  <--
     6.2500e-02     6.2500e-01             2.8342e-02       -17.215541122260
     2.5000e-01     2.5000e+00             1.1571e-02       -17.215564451684
     1.0000e+00     1.0000e+01             3.6447e-03       -17.215534454286

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1588
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.948965e-01 1 1  ON 0
 uu_1                 3.875985e-02 1 1  ON 1
 uu_2                -4.746537e-02 1 1  ON 2
 uu_3                -9.586274e-02 1 1  ON 3
 uu_4                -1.258463e-01 1 1  ON 4
 uu_5                -1.326452e-01 1 1  ON 5
 uu_6                -1.099327e-01 1 1  ON 6
 uu_7                -3.411921e-02 1 1  ON 7
 uu_8                 1.027811e-01 1 1  ON 8
 uu_9                 1.191091e-01 1 1  ON 9
 ud_0                 3.273658e-01 1 1  ON 10
 ud_1                 8.071476e-02 1 1  ON 11
 ud_2                -1.312475e-02 1 1  ON 12
 ud_3                -6.296703e-02 1 1  ON 13
 ud_4                -1.096418e-01 1 1  ON 14
 ud_5                -1.481472e-01 1 1  ON 15
 ud_6                -1.575076e-01 1 1  ON 16
 ud_7                -1.087328e-01 1 1  ON 17
 ud_8                 9.048817e-03 1 1  ON 18
 ud_9                 9.249902e-02 1 1  ON 19
 eO_0                -6.981858e-01 1 1  ON 20
 eO_1                -4.095618e-01 1 1  ON 21
 eO_2                -4.894602e-02 1 1  ON 22
 eO_3                 1.724075e-01 1 1  ON 23
 eO_4                 2.657976e-01 1 1  ON 24
 eO_5                 3.057689e-01 1 1  ON 25
 eO_6                 2.481908e-01 1 1  ON 26
 eO_7                 1.085955e-01 1 1  ON 27
 eO_8                 2.736858e-02 1 1  ON 28
 eO_9                 1.818336e-02 1 1  ON 29
eH1_0                -1.768123e-01 1 1  ON 30
eH1_1                -9.882525e-02 1 1  ON 31
eH1_2                -6.273414e-02 1 1  ON 32
eH1_3                -2.779942e-02 1 1  ON 33
eH1_4                 1.837529e-02 1 1  ON 34
eH1_5                 3.176293e-02 1 1  ON 35
eH1_6                 7.730077e-02 1 1  ON 36
eH1_7                 1.112230e-01 1 1  ON 37
eH1_8                 8.877808e-02 1 1  ON 38
eH1_9                 2.367447e-02 1 1  ON 39
eH2_0                -1.785789e-01 1 1  ON 40
eH2_1                -1.006713e-01 1 1  ON 41
eH2_2                -6.449483e-02 1 1  ON 42
eH2_3                -2.924564e-02 1 1  ON 43
eH2_4                 1.731503e-02 1 1  ON 44
eH2_5                 3.181027e-02 1 1  ON 45
eH2_6                 7.948216e-02 1 1  ON 46
eH2_7                 1.149219e-01 1 1  ON 47
eH2_8                 9.185428e-02 1 1  ON 48
eH2_9                 2.570634e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7174e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.221
    reference variance = 0.298323
====================================================
  Execution time = 2.0140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1493e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314992329596
                                         uncertainty =       0.005649393306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314992329596
                                         uncertainty =       0.005649393306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396820490
  error estimate for blocks of size 2^( 2) =       0.000407013424
  error estimate for blocks of size 2^( 3) =       0.000416068256
  error estimate for blocks of size 2^( 4) =       0.000422827487
  error estimate for blocks of size 2^( 5) =       0.000428162524
  error estimate for blocks of size 2^( 6) =       0.000431960148
  error estimate for blocks of size 2^( 7) =       0.000433875403

      target function =                  N/A
              le_mean =     -17.215643262191
             les_mean =     296.693305776837
             stat err =       0.000429206391
             autocorr =       1.169887714947
              std dev =       0.561188919432
             le_variance =       0.314933003294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721564326219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215643262191       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215683635274       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215706166359       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215721409734       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215745826610       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215754979875       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215759174682       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215760489092       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215760907490       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215761162627       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215761231961       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.539534e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215643262191       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215656349524       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215664023393       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215668814876       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215676624849       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215678699110       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215679095217       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215679151098       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215679268732       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215679316415       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.559256e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215643262191       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215646796095       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215648913056       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215650214916       residual = 9.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215652311034       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215652789299       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215652835136       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215652829900       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215652854883       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215652864650       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.036013e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5645e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.951283e-01 1 1  ON 0
 uu_1                 3.898132e-02 1 1  ON 1
 uu_2                -4.761033e-02 1 1  ON 2
 uu_3                -9.604498e-02 1 1  ON 3
 uu_4                -1.259012e-01 1 1  ON 4
 uu_5                -1.326016e-01 1 1  ON 5
 uu_6                -1.099822e-01 1 1  ON 6
 uu_7                -3.419811e-02 1 1  ON 7
 uu_8                 1.027362e-01 1 1  ON 8
 uu_9                 1.191310e-01 1 1  ON 9
 ud_0                 3.283802e-01 1 1  ON 10
 ud_1                 8.110380e-02 1 1  ON 11
 ud_2                -1.356608e-02 1 1  ON 12
 ud_3                -6.362663e-02 1 1  ON 13
 ud_4                -1.099754e-01 1 1  ON 14
 ud_5                -1.480700e-01 1 1  ON 15
 ud_6                -1.574487e-01 1 1  ON 16
 ud_7                -1.088028e-01 1 1  ON 17
 ud_8                 8.979022e-03 1 1  ON 18
 ud_9                 9.250101e-02 1 1  ON 19
 eO_0                -6.997450e-01 1 1  ON 20
 eO_1                -4.100772e-01 1 1  ON 21
 eO_2                -4.793976e-02 1 1  ON 22
 eO_3                 1.733690e-01 1 1  ON 23
 eO_4                 2.659470e-01 1 1  ON 24
 eO_5                 3.056488e-01 1 1  ON 25
 eO_6                 2.482090e-01 1 1  ON 26
 eO_7                 1.086399e-01 1 1  ON 27
 eO_8                 2.737355e-02 1 1  ON 28
 eO_9                 1.818848e-02 1 1  ON 29
eH1_0                -1.769195e-01 1 1  ON 30
eH1_1                -9.889021e-02 1 1  ON 31
eH1_2                -6.276646e-02 1 1  ON 32
eH1_3                -2.773109e-02 1 1  ON 33
eH1_4                 1.847894e-02 1 1  ON 34
eH1_5                 3.185361e-02 1 1  ON 35
eH1_6                 7.723040e-02 1 1  ON 36
eH1_7                 1.111989e-01 1 1  ON 37
eH1_8                 8.880432e-02 1 1  ON 38
eH1_9                 2.368119e-02 1 1  ON 39
eH2_0                -1.786612e-01 1 1  ON 40
eH2_1                -1.007376e-01 1 1  ON 41
eH2_2                -6.449687e-02 1 1  ON 42
eH2_3                -2.917746e-02 1 1  ON 43
eH2_4                 1.738275e-02 1 1  ON 44
eH2_5                 3.187226e-02 1 1  ON 45
eH2_6                 7.941080e-02 1 1  ON 46
eH2_7                 1.149060e-01 1 1  ON 47
eH2_8                 9.188212e-02 1 1  ON 48
eH2_9                 2.571455e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2409
    reference variance = 0.305028
====================================================
  Execution time = 1.9678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1182e-01
  Total weights = 2.0000e+06
  Execution time = 1.8215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311125852433
                                         uncertainty =       0.003250065079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311125852433
                                         uncertainty =       0.003250065079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394413110
  error estimate for blocks of size 2^( 2) =       0.000404921844
  error estimate for blocks of size 2^( 3) =       0.000414168982
  error estimate for blocks of size 2^( 4) =       0.000421075017
  error estimate for blocks of size 2^( 5) =       0.000425139521
  error estimate for blocks of size 2^( 6) =       0.000428266085
  error estimate for blocks of size 2^( 7) =       0.000430997148

      target function =                  N/A
              le_mean =     -17.214962951408
             les_mean =     296.666072665220
             stat err =       0.000426369443
             autocorr =       1.168609628209
              std dev =       0.557784369108
             le_variance =       0.311123402421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428515238
                                         uncertainty =       0.003310266837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428515238
                                         uncertainty =       0.003310266837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395870263
  error estimate for blocks of size 2^( 2) =       0.000406155143
  error estimate for blocks of size 2^( 3) =       0.000415213074
  error estimate for blocks of size 2^( 4) =       0.000422000496
  error estimate for blocks of size 2^( 5) =       0.000426024105
  error estimate for blocks of size 2^( 6) =       0.000429127830
  error estimate for blocks of size 2^( 7) =       0.000431793625

      target function =                  N/A
              le_mean =     -17.214975540623
             les_mean =     296.668809238448
             stat err =       0.000427236514
             autocorr =       1.164745296692
              std dev =       0.559845095458
             le_variance =       0.313426530908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312554706915
                                         uncertainty =       0.003288852195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312554706915
                                         uncertainty =       0.003288852195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395317910
  error estimate for blocks of size 2^( 2) =       0.000405682944
  error estimate for blocks of size 2^( 3) =       0.000414811502
  error estimate for blocks of size 2^( 4) =       0.000421641413
  error estimate for blocks of size 2^( 5) =       0.000425682102
  error estimate for blocks of size 2^( 6) =       0.000428795944
  error estimate for blocks of size 2^( 7) =       0.000431490891

      target function =                  N/A
              le_mean =     -17.214964872421
             les_mean =     296.667567902559
             stat err =       0.000426902587
             autocorr =       1.166177324320
              std dev =       0.559063949966
             le_variance =       0.312552500152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311309936114
                                         uncertainty =       0.003255332260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311309936114
                                         uncertainty =       0.003255332260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394529793
  error estimate for blocks of size 2^( 2) =       0.000405018552
  error estimate for blocks of size 2^( 3) =       0.000414249413
  error estimate for blocks of size 2^( 4) =       0.000421144936
  error estimate for blocks of size 2^( 5) =       0.000425206246
  error estimate for blocks of size 2^( 6) =       0.000428331135
  error estimate for blocks of size 2^( 7) =       0.000431057648

      target function =                  N/A
              le_mean =     -17.214961857262
             les_mean =     296.666219106075
             stat err =       0.000426434991
             autocorr =       1.168277621451
              std dev =       0.557949383667
             le_variance =       0.311307514734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214962951408        initial
     6.2500e-01     6.2500e+00             5.5395e-03       -17.214975540623  <--
     2.5000e+00     2.5000e+01             1.5593e-03       -17.214964872421
     1.0000e+01     1.0000e+02             4.0360e-04       -17.214961857262

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.8891e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.958613e-01 1 1  ON 0
 uu_1                 3.946838e-02 1 1  ON 1
 uu_2                -4.787077e-02 1 1  ON 2
 uu_3                -9.651872e-02 1 1  ON 3
 uu_4                -1.261585e-01 1 1  ON 4
 uu_5                -1.325533e-01 1 1  ON 5
 uu_6                -1.100954e-01 1 1  ON 6
 uu_7                -3.441235e-02 1 1  ON 7
 uu_8                 1.026060e-01 1 1  ON 8
 uu_9                 1.191995e-01 1 1  ON 9
 ud_0                 3.306267e-01 1 1  ON 10
 ud_1                 8.194101e-02 1 1  ON 11
 ud_2                -1.435928e-02 1 1  ON 12
 ud_3                -6.515587e-02 1 1  ON 13
 ud_4                -1.109091e-01 1 1  ON 14
 ud_5                -1.479247e-01 1 1  ON 15
 ud_6                -1.571807e-01 1 1  ON 16
 ud_7                -1.089562e-01 1 1  ON 17
 ud_8                 8.781379e-03 1 1  ON 18
 ud_9                 9.251011e-02 1 1  ON 19
 eO_0                -7.037253e-01 1 1  ON 20
 eO_1                -4.114862e-01 1 1  ON 21
 eO_2                -4.579528e-02 1 1  ON 22
 eO_3                 1.759968e-01 1 1  ON 23
 eO_4                 2.665788e-01 1 1  ON 24
 eO_5                 3.053734e-01 1 1  ON 25
 eO_6                 2.482825e-01 1 1  ON 26
 eO_7                 1.087799e-01 1 1  ON 27
 eO_8                 2.738984e-02 1 1  ON 28
 eO_9                 1.820441e-02 1 1  ON 29
eH1_0                -1.772323e-01 1 1  ON 30
eH1_1                -9.913867e-02 1 1  ON 31
eH1_2                -6.278303e-02 1 1  ON 32
eH1_3                -2.758229e-02 1 1  ON 33
eH1_4                 1.871309e-02 1 1  ON 34
eH1_5                 3.215906e-02 1 1  ON 35
eH1_6                 7.706773e-02 1 1  ON 36
eH1_7                 1.111374e-01 1 1  ON 37
eH1_8                 8.888660e-02 1 1  ON 38
eH1_9                 2.370228e-02 1 1  ON 39
eH2_0                -1.789063e-01 1 1  ON 40
eH2_1                -1.009748e-01 1 1  ON 41
eH2_2                -6.444023e-02 1 1  ON 42
eH2_3                -2.902868e-02 1 1  ON 43
eH2_4                 1.752104e-02 1 1  ON 44
eH2_5                 3.208868e-02 1 1  ON 45
eH2_6                 7.924327e-02 1 1  ON 46
eH2_7                 1.148702e-01 1 1  ON 47
eH2_8                 9.196963e-02 1 1  ON 48
eH2_9                 2.574017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2425
    reference variance = 0.138163
====================================================
  Execution time = 2.0313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0871e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308842749082
                                         uncertainty =       0.004429609451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308842749082
                                         uncertainty =       0.004429609451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392880571
  error estimate for blocks of size 2^( 2) =       0.000403505418
  error estimate for blocks of size 2^( 3) =       0.000412575389
  error estimate for blocks of size 2^( 4) =       0.000418904015
  error estimate for blocks of size 2^( 5) =       0.000422824677
  error estimate for blocks of size 2^( 6) =       0.000424653529
  error estimate for blocks of size 2^( 7) =       0.000426673501

      target function =                  N/A
              le_mean =     -17.215474878996
             les_mean =     296.681285441630
             stat err =       0.000423263930
             autocorr =       1.160650373930
              std dev =       0.555617032367
             le_variance =       0.308710286656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721547487900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215474878996       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215517551145       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215564602624       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215600293751       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215620037818       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215640454868       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215650115389       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215653355040       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215652791391       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215651418224       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215652929531       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215653224376       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215653532611       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.375481e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215474878996       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215494643691       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215516470945       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215531132947       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215539821813       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215545219870       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215546340444       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215546873726       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215546676568       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215546459723       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215546469830       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.593550e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215474878996       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215481158872       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215488302287       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215492807942       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215495404045       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215496592817       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215496672299       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215496776283       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215496759159       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215496728891       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.278484e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6022e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.968632e-01 1 1  ON 0
 uu_1                 4.009495e-02 1 1  ON 1
 uu_2                -4.807668e-02 1 1  ON 2
 uu_3                -9.706751e-02 1 1  ON 3
 uu_4                -1.265434e-01 1 1  ON 4
 uu_5                -1.326567e-01 1 1  ON 5
 uu_6                -1.102736e-01 1 1  ON 6
 uu_7                -3.468138e-02 1 1  ON 7
 uu_8                 1.024966e-01 1 1  ON 8
 uu_9                 1.192871e-01 1 1  ON 9
 ud_0                 3.330529e-01 1 1  ON 10
 ud_1                 8.287176e-02 1 1  ON 11
 ud_2                -1.506111e-02 1 1  ON 12
 ud_3                -6.671478e-02 1 1  ON 13
 ud_4                -1.118754e-01 1 1  ON 14
 ud_5                -1.478631e-01 1 1  ON 15
 ud_6                -1.570692e-01 1 1  ON 16
 ud_7                -1.091110e-01 1 1  ON 17
 ud_8                 8.559915e-03 1 1  ON 18
 ud_9                 9.252241e-02 1 1  ON 19
 eO_0                -7.083189e-01 1 1  ON 20
 eO_1                -4.133308e-01 1 1  ON 21
 eO_2                -4.359396e-02 1 1  ON 22
 eO_3                 1.791735e-01 1 1  ON 23
 eO_4                 2.676181e-01 1 1  ON 24
 eO_5                 3.051056e-01 1 1  ON 25
 eO_6                 2.483400e-01 1 1  ON 26
 eO_7                 1.089598e-01 1 1  ON 27
 eO_8                 2.742489e-02 1 1  ON 28
 eO_9                 1.821701e-02 1 1  ON 29
eH1_0                -1.774894e-01 1 1  ON 30
eH1_1                -9.947704e-02 1 1  ON 31
eH1_2                -6.278298e-02 1 1  ON 32
eH1_3                -2.745011e-02 1 1  ON 33
eH1_4                 1.888734e-02 1 1  ON 34
eH1_5                 3.250445e-02 1 1  ON 35
eH1_6                 7.690975e-02 1 1  ON 36
eH1_7                 1.110703e-01 1 1  ON 37
eH1_8                 8.900792e-02 1 1  ON 38
eH1_9                 2.374130e-02 1 1  ON 39
eH2_0                -1.793299e-01 1 1  ON 40
eH2_1                -1.011438e-01 1 1  ON 41
eH2_2                -6.433776e-02 1 1  ON 42
eH2_3                -2.877857e-02 1 1  ON 43
eH2_4                 1.763368e-02 1 1  ON 44
eH2_5                 3.231013e-02 1 1  ON 45
eH2_6                 7.907441e-02 1 1  ON 46
eH2_7                 1.148075e-01 1 1  ON 47
eH2_8                 9.207039e-02 1 1  ON 48
eH2_9                 2.576809e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2773
    reference variance = 0.147433
====================================================
  Execution time = 1.9803e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3230e-01
  Total weights = 2.0000e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330046391302
                                         uncertainty =       0.014433342382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330046391302
                                         uncertainty =       0.014433342382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406402569
  error estimate for blocks of size 2^( 2) =       0.000416450829
  error estimate for blocks of size 2^( 3) =       0.000425895074
  error estimate for blocks of size 2^( 4) =       0.000432630505
  error estimate for blocks of size 2^( 5) =       0.000435675545
  error estimate for blocks of size 2^( 6) =       0.000436393994
  error estimate for blocks of size 2^( 7) =       0.000439054383

      target function =                  N/A
              le_mean =     -17.215751753761
             les_mean =     296.712434377398
             stat err =       0.000435938607
             autocorr =       1.150635516272
              std dev =       0.574740024205
             le_variance =       0.330326095423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334873626771
                                         uncertainty =       0.014763560347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334873626771
                                         uncertainty =       0.014763560347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409362718
  error estimate for blocks of size 2^( 2) =       0.000419115615
  error estimate for blocks of size 2^( 3) =       0.000428298263
  error estimate for blocks of size 2^( 4) =       0.000434879863
  error estimate for blocks of size 2^( 5) =       0.000437869077
  error estimate for blocks of size 2^( 6) =       0.000438443735
  error estimate for blocks of size 2^( 7) =       0.000441119885

      target function =                  N/A
              le_mean =     -17.215747721553
             les_mean =     296.717125115128
             stat err =       0.000438078140
             autocorr =       1.145213841973
              std dev =       0.578926308378
             le_variance =       0.335155670533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334160641381
                                         uncertainty =       0.014704775329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334160641381
                                         uncertainty =       0.014704775329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408926623
  error estimate for blocks of size 2^( 2) =       0.000418731464
  error estimate for blocks of size 2^( 3) =       0.000427966780
  error estimate for blocks of size 2^( 4) =       0.000434583204
  error estimate for blocks of size 2^( 5) =       0.000437589001
  error estimate for blocks of size 2^( 6) =       0.000438179926
  error estimate for blocks of size 2^( 7) =       0.000440855324

      target function =                  N/A
              le_mean =     -17.215737090855
             les_mean =     296.716045380656
             stat err =       0.000437801864
             autocorr =       1.146210649892
              std dev =       0.578309576636
             le_variance =       0.334441966429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648138947
                                         uncertainty =       0.014473598722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648138947
                                         uncertainty =       0.014473598722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406772710
  error estimate for blocks of size 2^( 2) =       0.000416780093
  error estimate for blocks of size 2^( 3) =       0.000426190178
  error estimate for blocks of size 2^( 4) =       0.000432906289
  error estimate for blocks of size 2^( 5) =       0.000435945428
  error estimate for blocks of size 2^( 6) =       0.000436643217
  error estimate for blocks of size 2^( 7) =       0.000439306424

      target function =                  N/A
              le_mean =     -17.215741996094
             les_mean =     296.712700386521
             stat err =       0.000436200340
             autocorr =       1.149921992601
              std dev =       0.575263483899
             le_variance =       0.330928075908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215751753761        initial  <--
     1.5625e-01     1.5625e+00             1.3755e-02       -17.215747721553
     6.2500e-01     6.2500e+00             4.5935e-03       -17.215737090855
     2.5000e+00     2.5000e+01             1.2785e-03       -17.215741996094

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9751
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.958613e-01 1 1  ON 0
 uu_1                 3.946838e-02 1 1  ON 1
 uu_2                -4.787077e-02 1 1  ON 2
 uu_3                -9.651872e-02 1 1  ON 3
 uu_4                -1.261585e-01 1 1  ON 4
 uu_5                -1.325533e-01 1 1  ON 5
 uu_6                -1.100954e-01 1 1  ON 6
 uu_7                -3.441235e-02 1 1  ON 7
 uu_8                 1.026060e-01 1 1  ON 8
 uu_9                 1.191995e-01 1 1  ON 9
 ud_0                 3.306267e-01 1 1  ON 10
 ud_1                 8.194101e-02 1 1  ON 11
 ud_2                -1.435928e-02 1 1  ON 12
 ud_3                -6.515587e-02 1 1  ON 13
 ud_4                -1.109091e-01 1 1  ON 14
 ud_5                -1.479247e-01 1 1  ON 15
 ud_6                -1.571807e-01 1 1  ON 16
 ud_7                -1.089562e-01 1 1  ON 17
 ud_8                 8.781379e-03 1 1  ON 18
 ud_9                 9.251011e-02 1 1  ON 19
 eO_0                -7.037253e-01 1 1  ON 20
 eO_1                -4.114862e-01 1 1  ON 21
 eO_2                -4.579528e-02 1 1  ON 22
 eO_3                 1.759968e-01 1 1  ON 23
 eO_4                 2.665788e-01 1 1  ON 24
 eO_5                 3.053734e-01 1 1  ON 25
 eO_6                 2.482825e-01 1 1  ON 26
 eO_7                 1.087799e-01 1 1  ON 27
 eO_8                 2.738984e-02 1 1  ON 28
 eO_9                 1.820441e-02 1 1  ON 29
eH1_0                -1.772323e-01 1 1  ON 30
eH1_1                -9.913867e-02 1 1  ON 31
eH1_2                -6.278303e-02 1 1  ON 32
eH1_3                -2.758229e-02 1 1  ON 33
eH1_4                 1.871309e-02 1 1  ON 34
eH1_5                 3.215906e-02 1 1  ON 35
eH1_6                 7.706773e-02 1 1  ON 36
eH1_7                 1.111374e-01 1 1  ON 37
eH1_8                 8.888660e-02 1 1  ON 38
eH1_9                 2.370228e-02 1 1  ON 39
eH2_0                -1.789063e-01 1 1  ON 40
eH2_1                -1.009748e-01 1 1  ON 41
eH2_2                -6.444023e-02 1 1  ON 42
eH2_3                -2.902868e-02 1 1  ON 43
eH2_4                 1.752104e-02 1 1  ON 44
eH2_5                 3.208868e-02 1 1  ON 45
eH2_6                 7.924327e-02 1 1  ON 46
eH2_7                 1.148702e-01 1 1  ON 47
eH2_8                 9.196963e-02 1 1  ON 48
eH2_9                 2.574017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5003e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2284
    reference variance = 0.42398
====================================================
  Execution time = 2.2490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2085e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320884400128
                                         uncertainty =       0.007401638145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320884400128
                                         uncertainty =       0.007401638145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400532414
  error estimate for blocks of size 2^( 2) =       0.000410909874
  error estimate for blocks of size 2^( 3) =       0.000419942194
  error estimate for blocks of size 2^( 4) =       0.000427029077
  error estimate for blocks of size 2^( 5) =       0.000430665731
  error estimate for blocks of size 2^( 6) =       0.000433749346
  error estimate for blocks of size 2^( 7) =       0.000434118365

      target function =                  N/A
              le_mean =     -17.215283310850
             les_mean =     296.686831741754
             stat err =       0.000431390630
             autocorr =       1.160021608367
              std dev =       0.566438372069
             le_variance =       0.320852429352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721528331085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215283310850       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215289911323       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215298793709       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215305059815       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215314147985       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215315166432       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215315599476       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215315310245       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215315443456       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215315465995       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.040864e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215283310850       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215285138562       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215287659729       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215289293077       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215291777980       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215291997599       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215292057943       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215291969706       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215291997019       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215292000223       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 5.354190e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215283310850       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215283780412       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215284433250       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215284846636       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215285481459       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215285534320       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215285545988       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215285523340       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215285529591       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215285530080       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.355698e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120820 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8063e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.959717e-01 1 1  ON 0
 uu_1                 3.953916e-02 1 1  ON 1
 uu_2                -4.790683e-02 1 1  ON 2
 uu_3                -9.658429e-02 1 1  ON 3
 uu_4                -1.261955e-01 1 1  ON 4
 uu_5                -1.325634e-01 1 1  ON 5
 uu_6                -1.101102e-01 1 1  ON 6
 uu_7                -3.444030e-02 1 1  ON 7
 uu_8                 1.025946e-01 1 1  ON 8
 uu_9                 1.192094e-01 1 1  ON 9
 ud_0                 3.309498e-01 1 1  ON 10
 ud_1                 8.205670e-02 1 1  ON 11
 ud_2                -1.447014e-02 1 1  ON 12
 ud_3                -6.536102e-02 1 1  ON 13
 ud_4                -1.110237e-01 1 1  ON 14
 ud_5                -1.479124e-01 1 1  ON 15
 ud_6                -1.571610e-01 1 1  ON 16
 ud_7                -1.089800e-01 1 1  ON 17
 ud_8                 8.754217e-03 1 1  ON 18
 ud_9                 9.251015e-02 1 1  ON 19
 eO_0                -7.042607e-01 1 1  ON 20
 eO_1                -4.116822e-01 1 1  ON 21
 eO_2                -4.550444e-02 1 1  ON 22
 eO_3                 1.763587e-01 1 1  ON 23
 eO_4                 2.666599e-01 1 1  ON 24
 eO_5                 3.053378e-01 1 1  ON 25
 eO_6                 2.482906e-01 1 1  ON 26
 eO_7                 1.087987e-01 1 1  ON 27
 eO_8                 2.739328e-02 1 1  ON 28
 eO_9                 1.820610e-02 1 1  ON 29
eH1_0                -1.772555e-01 1 1  ON 30
eH1_1                -9.915822e-02 1 1  ON 31
eH1_2                -6.280058e-02 1 1  ON 32
eH1_3                -2.756305e-02 1 1  ON 33
eH1_4                 1.873076e-02 1 1  ON 34
eH1_5                 3.218643e-02 1 1  ON 35
eH1_6                 7.705232e-02 1 1  ON 36
eH1_7                 1.111306e-01 1 1  ON 37
eH1_8                 8.889883e-02 1 1  ON 38
eH1_9                 2.370676e-02 1 1  ON 39
eH2_0                -1.789350e-01 1 1  ON 40
eH2_1                -1.009915e-01 1 1  ON 41
eH2_2                -6.443659e-02 1 1  ON 42
eH2_3                -2.900316e-02 1 1  ON 43
eH2_4                 1.754084e-02 1 1  ON 44
eH2_5                 3.210759e-02 1 1  ON 45
eH2_6                 7.921556e-02 1 1  ON 46
eH2_7                 1.148582e-01 1 1  ON 47
eH2_8                 9.198137e-02 1 1  ON 48
eH2_9                 2.574435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2333
    reference variance = 0.485386
====================================================
  Execution time = 1.9840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1518e-01
  Total weights = 2.0000e+06
  Execution time = 1.8242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314874290294
                                         uncertainty =       0.004574933178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314874290294
                                         uncertainty =       0.004574933178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396819390
  error estimate for blocks of size 2^( 2) =       0.000407367818
  error estimate for blocks of size 2^( 3) =       0.000416725455
  error estimate for blocks of size 2^( 4) =       0.000422685336
  error estimate for blocks of size 2^( 5) =       0.000425932002
  error estimate for blocks of size 2^( 6) =       0.000428648535
  error estimate for blocks of size 2^( 7) =       0.000429917078

      target function =                  N/A
              le_mean =     -17.216423194684
             les_mean =     296.720158718215
             stat err =       0.000426795738
             autocorr =       1.156789600670
              std dev =       0.561187363735
             le_variance =       0.314931257215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315766929866
                                         uncertainty =       0.004584589712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315766929866
                                         uncertainty =       0.004584589712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397381556
  error estimate for blocks of size 2^( 2) =       0.000407860504
  error estimate for blocks of size 2^( 3) =       0.000417162849
  error estimate for blocks of size 2^( 4) =       0.000423082824
  error estimate for blocks of size 2^( 5) =       0.000426330702
  error estimate for blocks of size 2^( 6) =       0.000429027159
  error estimate for blocks of size 2^( 7) =       0.000430328085

      target function =                  N/A
              le_mean =     -17.216424517942
             les_mean =     296.721097226520
             stat err =       0.000427192192
             autocorr =       1.155662978062
              std dev =       0.561982386249
             le_variance =       0.315824202455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315370471059
                                         uncertainty =       0.004580266497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315370471059
                                         uncertainty =       0.004580266497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397131980
  error estimate for blocks of size 2^( 2) =       0.000407641598
  error estimate for blocks of size 2^( 3) =       0.000416968648
  error estimate for blocks of size 2^( 4) =       0.000422906704
  error estimate for blocks of size 2^( 5) =       0.000426154115
  error estimate for blocks of size 2^( 6) =       0.000428859118
  error estimate for blocks of size 2^( 7) =       0.000430145627

      target function =                  N/A
              le_mean =     -17.216423039240
             les_mean =     296.720649727748
             stat err =       0.000427016391
             autocorr =       1.156163804946
              std dev =       0.561629432433
             le_variance =       0.315427619375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314937603267
                                         uncertainty =       0.004575618297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314937603267
                                         uncertainty =       0.004575618297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396859291
  error estimate for blocks of size 2^( 2) =       0.000407402674
  error estimate for blocks of size 2^( 3) =       0.000416756350
  error estimate for blocks of size 2^( 4) =       0.000422713417
  error estimate for blocks of size 2^( 5) =       0.000425960173
  error estimate for blocks of size 2^( 6) =       0.000428675203
  error estimate for blocks of size 2^( 7) =       0.000429946056

      target function =                  N/A
              le_mean =     -17.216423057008
             les_mean =     296.720217314336
             stat err =       0.000426823712
             autocorr =       1.156708623058
              std dev =       0.561243791899
             le_variance =       0.314994593945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216423194684        initial
     1.5625e+00     1.5625e+01             2.0409e-03       -17.216424517942  <--
     6.2500e+00     6.2500e+01             5.3542e-04       -17.216423039240
     2.5000e+01     2.5000e+02             1.3557e-04       -17.216423057008

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 3.1721e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.962976e-01 1 1  ON 0
 uu_1                 3.972418e-02 1 1  ON 1
 uu_2                -4.799043e-02 1 1  ON 2
 uu_3                -9.677065e-02 1 1  ON 3
 uu_4                -1.263195e-01 1 1  ON 4
 uu_5                -1.325938e-01 1 1  ON 5
 uu_6                -1.101484e-01 1 1  ON 6
 uu_7                -3.452008e-02 1 1  ON 7
 uu_8                 1.025616e-01 1 1  ON 8
 uu_9                 1.192390e-01 1 1  ON 9
 ud_0                 3.317920e-01 1 1  ON 10
 ud_1                 8.236380e-02 1 1  ON 11
 ud_2                -1.472998e-02 1 1  ON 12
 ud_3                -6.590745e-02 1 1  ON 13
 ud_4                -1.113616e-01 1 1  ON 14
 ud_5                -1.478823e-01 1 1  ON 15
 ud_6                -1.570881e-01 1 1  ON 16
 ud_7                -1.090424e-01 1 1  ON 17
 ud_8                 8.675690e-03 1 1  ON 18
 ud_9                 9.251067e-02 1 1  ON 19
 eO_0                -7.057662e-01 1 1  ON 20
 eO_1                -4.122415e-01 1 1  ON 21
 eO_2                -4.475515e-02 1 1  ON 22
 eO_3                 1.774104e-01 1 1  ON 23
 eO_4                 2.669206e-01 1 1  ON 24
 eO_5                 3.052401e-01 1 1  ON 25
 eO_6                 2.483167e-01 1 1  ON 26
 eO_7                 1.088550e-01 1 1  ON 27
 eO_8                 2.740358e-02 1 1  ON 28
 eO_9                 1.821114e-02 1 1  ON 29
eH1_0                -1.773267e-01 1 1  ON 30
eH1_1                -9.922562e-02 1 1  ON 31
eH1_2                -6.283723e-02 1 1  ON 32
eH1_3                -2.751726e-02 1 1  ON 33
eH1_4                 1.877627e-02 1 1  ON 34
eH1_5                 3.227480e-02 1 1  ON 35
eH1_6                 7.701234e-02 1 1  ON 36
eH1_7                 1.111120e-01 1 1  ON 37
eH1_8                 8.893537e-02 1 1  ON 38
eH1_9                 2.372010e-02 1 1  ON 39
eH2_0                -1.790206e-01 1 1  ON 40
eH2_1                -1.010465e-01 1 1  ON 41
eH2_2                -6.441621e-02 1 1  ON 42
eH2_3                -2.893812e-02 1 1  ON 43
eH2_4                 1.759287e-02 1 1  ON 44
eH2_5                 3.217068e-02 1 1  ON 45
eH2_6                 7.913868e-02 1 1  ON 46
eH2_7                 1.148238e-01 1 1  ON 47
eH2_8                 9.201644e-02 1 1  ON 48
eH2_9                 2.575681e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9789e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.291543
====================================================
  Execution time = 2.0405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307613006515
                                         uncertainty =       0.002801463650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307613006515
                                         uncertainty =       0.002801463650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392099386
  error estimate for blocks of size 2^( 2) =       0.000402162073
  error estimate for blocks of size 2^( 3) =       0.000411287201
  error estimate for blocks of size 2^( 4) =       0.000417674400
  error estimate for blocks of size 2^( 5) =       0.000422532343
  error estimate for blocks of size 2^( 6) =       0.000424045952
  error estimate for blocks of size 2^( 7) =       0.000425757029

      target function =                  N/A
              le_mean =     -17.215529430075
             les_mean =     296.681937261683
             stat err =       0.000422502431
             autocorr =       1.161090573468
              std dev =       0.554512270064
             le_variance =       0.307483857651


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721552943007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215529430075       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215541574694       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215561604080       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215578056600       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215582381849       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215593353979       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215599142060       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215599799974       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215598606846       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215598046656       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215597889660       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215598072187       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 6.450868e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215529430075       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215533551962       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215540511787       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215545799639       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215547656703       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215550261105       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215551241734       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215551212935       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215551040538       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215550953277       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.876758e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215529430075       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215530561715       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215532504047       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215533943085       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215534474896       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215535080489       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215535280314       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215535260982       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215535229901       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215535211624       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.914105e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6059e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.966664e-01 1 1  ON 0
 uu_1                 3.995820e-02 1 1  ON 1
 uu_2                -4.808542e-02 1 1  ON 2
 uu_3                -9.705868e-02 1 1  ON 3
 uu_4                -1.264799e-01 1 1  ON 4
 uu_5                -1.325960e-01 1 1  ON 5
 uu_6                -1.101425e-01 1 1  ON 6
 uu_7                -3.462829e-02 1 1  ON 7
 uu_8                 1.025147e-01 1 1  ON 8
 uu_9                 1.192775e-01 1 1  ON 9
 ud_0                 3.328230e-01 1 1  ON 10
 ud_1                 8.276656e-02 1 1  ON 11
 ud_2                -1.502539e-02 1 1  ON 12
 ud_3                -6.658647e-02 1 1  ON 13
 ud_4                -1.118078e-01 1 1  ON 14
 ud_5                -1.478321e-01 1 1  ON 15
 ud_6                -1.569990e-01 1 1  ON 16
 ud_7                -1.091364e-01 1 1  ON 17
 ud_8                 8.573506e-03 1 1  ON 18
 ud_9                 9.251476e-02 1 1  ON 19
 eO_0                -7.076429e-01 1 1  ON 20
 eO_1                -4.129824e-01 1 1  ON 21
 eO_2                -4.377118e-02 1 1  ON 22
 eO_3                 1.787088e-01 1 1  ON 23
 eO_4                 2.672272e-01 1 1  ON 24
 eO_5                 3.051409e-01 1 1  ON 25
 eO_6                 2.483456e-01 1 1  ON 26
 eO_7                 1.089286e-01 1 1  ON 27
 eO_8                 2.741787e-02 1 1  ON 28
 eO_9                 1.821816e-02 1 1  ON 29
eH1_0                -1.774437e-01 1 1  ON 30
eH1_1                -9.937700e-02 1 1  ON 31
eH1_2                -6.283150e-02 1 1  ON 32
eH1_3                -2.744599e-02 1 1  ON 33
eH1_4                 1.887117e-02 1 1  ON 34
eH1_5                 3.240019e-02 1 1  ON 35
eH1_6                 7.695638e-02 1 1  ON 36
eH1_7                 1.110849e-01 1 1  ON 37
eH1_8                 8.897263e-02 1 1  ON 38
eH1_9                 2.373306e-02 1 1  ON 39
eH2_0                -1.791260e-01 1 1  ON 40
eH2_1                -1.010742e-01 1 1  ON 41
eH2_2                -6.442275e-02 1 1  ON 42
eH2_3                -2.889379e-02 1 1  ON 43
eH2_4                 1.764905e-02 1 1  ON 44
eH2_5                 3.226011e-02 1 1  ON 45
eH2_6                 7.904212e-02 1 1  ON 46
eH2_7                 1.147971e-01 1 1  ON 47
eH2_8                 9.206339e-02 1 1  ON 48
eH2_9                 2.577538e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1895
    reference variance = 0.171166
====================================================
  Execution time = 2.0181e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1767e-01
  Total weights = 2.0000e+06
  Execution time = 1.8247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316944311885
                                         uncertainty =       0.003256780074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316944311885
                                         uncertainty =       0.003256780074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398042877
  error estimate for blocks of size 2^( 2) =       0.000408267426
  error estimate for blocks of size 2^( 3) =       0.000416691229
  error estimate for blocks of size 2^( 4) =       0.000423536858
  error estimate for blocks of size 2^( 5) =       0.000427227816
  error estimate for blocks of size 2^( 6) =       0.000430434945
  error estimate for blocks of size 2^( 7) =       0.000433138970

      target function =                  N/A
              le_mean =     -17.216270540974
             les_mean =     296.716847445444
             stat err =       0.000428584647
             autocorr =       1.159347171062
              std dev =       0.562917635076
             le_variance =       0.316876263880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319368241175
                                         uncertainty =       0.003283950882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319368241175
                                         uncertainty =       0.003283950882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399562059
  error estimate for blocks of size 2^( 2) =       0.000409630156
  error estimate for blocks of size 2^( 3) =       0.000417896624
  error estimate for blocks of size 2^( 4) =       0.000424685412
  error estimate for blocks of size 2^( 5) =       0.000428311435
  error estimate for blocks of size 2^( 6) =       0.000431473880
  error estimate for blocks of size 2^( 7) =       0.000434173221

      target function =                  N/A
              le_mean =     -17.216277783493
             les_mean =     296.719520236997
             stat err =       0.000429660987
             autocorr =       1.156334166891
              std dev =       0.565066083096
             le_variance =       0.319299678266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568553420
                                         uncertainty =       0.003274351512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568553420
                                         uncertainty =       0.003274351512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399061501
  error estimate for blocks of size 2^( 2) =       0.000409181295
  error estimate for blocks of size 2^( 3) =       0.000417502075
  error estimate for blocks of size 2^( 4) =       0.000424311289
  error estimate for blocks of size 2^( 5) =       0.000427957700
  error estimate for blocks of size 2^( 6) =       0.000431139326
  error estimate for blocks of size 2^( 7) =       0.000433842691

      target function =                  N/A
              le_mean =     -17.216270629122
             les_mean =     296.718474379717
             stat err =       0.000429312752
             autocorr =       1.157358517027
              std dev =       0.564358187495
             le_variance =       0.318500163793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163120931
                                         uncertainty =       0.003259156801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163120931
                                         uncertainty =       0.003259156801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398180252
  error estimate for blocks of size 2^( 2) =       0.000408389806
  error estimate for blocks of size 2^( 3) =       0.000416799112
  error estimate for blocks of size 2^( 4) =       0.000423639557
  error estimate for blocks of size 2^( 5) =       0.000427324155
  error estimate for blocks of size 2^( 6) =       0.000430527958
  error estimate for blocks of size 2^( 7) =       0.000433231971

      target function =                  N/A
              le_mean =     -17.216269320930
             les_mean =     296.717024198803
             stat err =       0.000428680910
             autocorr =       1.159067834444
              std dev =       0.563111912993
             le_variance =       0.317095026554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216270540974        initial
     3.9062e-01     3.9062e+00             6.4509e-03       -17.216277783493  <--
     1.5625e+00     1.5625e+01             1.8768e-03       -17.216270629122
     6.2500e+00     6.2500e+01             4.9141e-04       -17.216269320930

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9391e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.977024e-01 1 1  ON 0
 uu_1                 4.050450e-02 1 1  ON 1
 uu_2                -4.822029e-02 1 1  ON 2
 uu_3                -9.768865e-02 1 1  ON 3
 uu_4                -1.270211e-01 1 1  ON 4
 uu_5                -1.327566e-01 1 1  ON 5
 uu_6                -1.101154e-01 1 1  ON 6
 uu_7                -3.492178e-02 1 1  ON 7
 uu_8                 1.023822e-01 1 1  ON 8
 uu_9                 1.193972e-01 1 1  ON 9
 ud_0                 3.348935e-01 1 1  ON 10
 ud_1                 8.363851e-02 1 1  ON 11
 ud_2                -1.543501e-02 1 1  ON 12
 ud_3                -6.793836e-02 1 1  ON 13
 ud_4                -1.129271e-01 1 1  ON 14
 ud_5                -1.478772e-01 1 1  ON 15
 ud_6                -1.566649e-01 1 1  ON 16
 ud_7                -1.093371e-01 1 1  ON 17
 ud_8                 8.285271e-03 1 1  ON 18
 ud_9                 9.253093e-02 1 1  ON 19
 eO_0                -7.122170e-01 1 1  ON 20
 eO_1                -4.149197e-01 1 1  ON 21
 eO_2                -4.196339e-02 1 1  ON 22
 eO_3                 1.819824e-01 1 1  ON 23
 eO_4                 2.684030e-01 1 1  ON 24
 eO_5                 3.049740e-01 1 1  ON 25
 eO_6                 2.484570e-01 1 1  ON 26
 eO_7                 1.091593e-01 1 1  ON 27
 eO_8                 2.746290e-02 1 1  ON 28
 eO_9                 1.823981e-02 1 1  ON 29
eH1_0                -1.777924e-01 1 1  ON 30
eH1_1                -9.980329e-02 1 1  ON 31
eH1_2                -6.276521e-02 1 1  ON 32
eH1_3                -2.729332e-02 1 1  ON 33
eH1_4                 1.904135e-02 1 1  ON 34
eH1_5                 3.278003e-02 1 1  ON 35
eH1_6                 7.685819e-02 1 1  ON 36
eH1_7                 1.110197e-01 1 1  ON 37
eH1_8                 8.908953e-02 1 1  ON 38
eH1_9                 2.377332e-02 1 1  ON 39
eH2_0                -1.794067e-01 1 1  ON 40
eH2_1                -1.012581e-01 1 1  ON 41
eH2_2                -6.436183e-02 1 1  ON 42
eH2_3                -2.879074e-02 1 1  ON 43
eH2_4                 1.771285e-02 1 1  ON 44
eH2_5                 3.254592e-02 1 1  ON 45
eH2_6                 7.882898e-02 1 1  ON 46
eH2_7                 1.147340e-01 1 1  ON 47
eH2_8                 9.220995e-02 1 1  ON 48
eH2_9                 2.583289e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5456e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1926
    reference variance = 0.230761
====================================================
  Execution time = 2.0218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1650e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316365803481
                                         uncertainty =       0.004100285015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316365803481
                                         uncertainty =       0.004100285015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397805780
  error estimate for blocks of size 2^( 2) =       0.000407547534
  error estimate for blocks of size 2^( 3) =       0.000416325848
  error estimate for blocks of size 2^( 4) =       0.000422501213
  error estimate for blocks of size 2^( 5) =       0.000427815455
  error estimate for blocks of size 2^( 6) =       0.000430773871
  error estimate for blocks of size 2^( 7) =       0.000432046999

      target function =                  N/A
              le_mean =     -17.215562915763
             les_mean =     296.692105225391
             stat err =       0.000428284384
             autocorr =       1.159103726116
              std dev =       0.562582329115
             le_variance =       0.316498877033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721556291576e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215562915763       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215577366519       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215595226017       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215637596741       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215637608018       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215656631171       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215664721248       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215667167459       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215670953862       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215673637116       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215673535041       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215673868249       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215673895124       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215674105526       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.490934e-02

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215562915763       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215569917576       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215580448760       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215598965053       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215597617244       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215601281976       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215603285300       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215603614054       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215603877172       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215604270776       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215604097676       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.227624e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215562915763       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215565202527       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215569172072       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215574826918       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215574253755       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215574713339       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215575061453       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215575103867       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215575122918       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.499617e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129835 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5746e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.989766e-01 1 1  ON 0
 uu_1                 4.128485e-02 1 1  ON 1
 uu_2                -4.820724e-02 1 1  ON 2
 uu_3                -9.813053e-02 1 1  ON 3
 uu_4                -1.275680e-01 1 1  ON 4
 uu_5                -1.332294e-01 1 1  ON 5
 uu_6                -1.104612e-01 1 1  ON 6
 uu_7                -3.536737e-02 1 1  ON 7
 uu_8                 1.021776e-01 1 1  ON 8
 uu_9                 1.195721e-01 1 1  ON 9
 ud_0                 3.369388e-01 1 1  ON 10
 ud_1                 8.460557e-02 1 1  ON 11
 ud_2                -1.557769e-02 1 1  ON 12
 ud_3                -6.915693e-02 1 1  ON 13
 ud_4                -1.141006e-01 1 1  ON 14
 ud_5                -1.481291e-01 1 1  ON 15
 ud_6                -1.563898e-01 1 1  ON 16
 ud_7                -1.096429e-01 1 1  ON 17
 ud_8                 7.866456e-03 1 1  ON 18
 ud_9                 9.253385e-02 1 1  ON 19
 eO_0                -7.174447e-01 1 1  ON 20
 eO_1                -4.173946e-01 1 1  ON 21
 eO_2                -4.056355e-02 1 1  ON 22
 eO_3                 1.860814e-01 1 1  ON 23
 eO_4                 2.704871e-01 1 1  ON 24
 eO_5                 3.045762e-01 1 1  ON 25
 eO_6                 2.485540e-01 1 1  ON 26
 eO_7                 1.094694e-01 1 1  ON 27
 eO_8                 2.752070e-02 1 1  ON 28
 eO_9                 1.826465e-02 1 1  ON 29
eH1_0                -1.782311e-01 1 1  ON 30
eH1_1                -1.002493e-01 1 1  ON 31
eH1_2                -6.261164e-02 1 1  ON 32
eH1_3                -2.699115e-02 1 1  ON 33
eH1_4                 1.911716e-02 1 1  ON 34
eH1_5                 3.318429e-02 1 1  ON 35
eH1_6                 7.668236e-02 1 1  ON 36
eH1_7                 1.108739e-01 1 1  ON 37
eH1_8                 8.926722e-02 1 1  ON 38
eH1_9                 2.383316e-02 1 1  ON 39
eH2_0                -1.798086e-01 1 1  ON 40
eH2_1                -1.018019e-01 1 1  ON 41
eH2_2                -6.421078e-02 1 1  ON 42
eH2_3                -2.857655e-02 1 1  ON 43
eH2_4                 1.771409e-02 1 1  ON 44
eH2_5                 3.299493e-02 1 1  ON 45
eH2_6                 7.877341e-02 1 1  ON 46
eH2_7                 1.146295e-01 1 1  ON 47
eH2_8                 9.238912e-02 1 1  ON 48
eH2_9                 2.591733e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2685
    reference variance = 0.191044
====================================================
  Execution time = 1.9896e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1751e-01
  Total weights = 2.0000e+06
  Execution time = 1.8235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316067410262
                                         uncertainty =       0.003745408505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316067410262
                                         uncertainty =       0.003745408505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397497945
  error estimate for blocks of size 2^( 2) =       0.000407503501
  error estimate for blocks of size 2^( 3) =       0.000416181878
  error estimate for blocks of size 2^( 4) =       0.000423199320
  error estimate for blocks of size 2^( 5) =       0.000427799908
  error estimate for blocks of size 2^( 6) =       0.000428807158
  error estimate for blocks of size 2^( 7) =       0.000429246827

      target function =                  N/A
              le_mean =     -17.215890721233
             les_mean =     296.702902399935
             stat err =       0.000427263303
             autocorr =       1.155370865314
              std dev =       0.562146984800
             le_variance =       0.316009232519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319583205649
                                         uncertainty =       0.003776020765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319583205649
                                         uncertainty =       0.003776020765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399701553
  error estimate for blocks of size 2^( 2) =       0.000409516415
  error estimate for blocks of size 2^( 3) =       0.000418000367
  error estimate for blocks of size 2^( 4) =       0.000424887833
  error estimate for blocks of size 2^( 5) =       0.000429427059
  error estimate for blocks of size 2^( 6) =       0.000430464863
  error estimate for blocks of size 2^( 7) =       0.000430878763

      target function =                  N/A
              le_mean =     -17.215926690721
             les_mean =     296.707654323650
             stat err =       0.000428914630
             autocorr =       1.151516187724
              std dev =       0.565263357320
             le_variance =       0.319522663129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319175607653
                                         uncertainty =       0.003762193442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319175607653
                                         uncertainty =       0.003762193442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399446767
  error estimate for blocks of size 2^( 2) =       0.000409290902
  error estimate for blocks of size 2^( 3) =       0.000417811626
  error estimate for blocks of size 2^( 4) =       0.000424725223
  error estimate for blocks of size 2^( 5) =       0.000429274838
  error estimate for blocks of size 2^( 6) =       0.000430306665
  error estimate for blocks of size 2^( 7) =       0.000430734385

      target function =                  N/A
              le_mean =     -17.215915898296
             les_mean =     296.706875496788
             stat err =       0.000428760278
             autocorr =       1.152155949849
              std dev =       0.564903035170
             le_variance =       0.319115439144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316548577508
                                         uncertainty =       0.003747490871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316548577508
                                         uncertainty =       0.003747490871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397800254
  error estimate for blocks of size 2^( 2) =       0.000407777984
  error estimate for blocks of size 2^( 3) =       0.000416429958
  error estimate for blocks of size 2^( 4) =       0.000423430134
  error estimate for blocks of size 2^( 5) =       0.000428022110
  error estimate for blocks of size 2^( 6) =       0.000429032796
  error estimate for blocks of size 2^( 7) =       0.000429471336

      target function =                  N/A
              le_mean =     -17.215890015224
             les_mean =     296.703358942371
             stat err =       0.000427489094
             autocorr =       1.154835077498
              std dev =       0.562574514460
             le_variance =       0.316490084320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215890721233        initial
     9.7656e-02     9.7656e-01             1.4909e-02       -17.215926690721  <--
     3.9062e-01     3.9062e+00             5.2276e-03       -17.215915898296
     1.5625e+00     1.5625e+01             1.4996e-03       -17.215890015224

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.9114e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.015498e-01 1 1  ON 0
 uu_1                 4.290452e-02 1 1  ON 1
 uu_2                -4.766660e-02 1 1  ON 2
 uu_3                -9.867579e-02 1 1  ON 3
 uu_4                -1.288729e-01 1 1  ON 4
 uu_5                -1.345009e-01 1 1  ON 5
 uu_6                -1.113940e-01 1 1  ON 6
 uu_7                -3.660463e-02 1 1  ON 7
 uu_8                 1.015813e-01 1 1  ON 8
 uu_9                 1.200891e-01 1 1  ON 9
 ud_0                 3.398000e-01 1 1  ON 10
 ud_1                 8.635463e-02 1 1  ON 11
 ud_2                -1.523795e-02 1 1  ON 12
 ud_3                -7.038809e-02 1 1  ON 13
 ud_4                -1.160081e-01 1 1  ON 14
 ud_5                -1.492870e-01 1 1  ON 15
 ud_6                -1.559671e-01 1 1  ON 16
 ud_7                -1.102509e-01 1 1  ON 17
 ud_8                 6.727981e-03 1 1  ON 18
 ud_9                 9.254885e-02 1 1  ON 19
 eO_0                -7.271264e-01 1 1  ON 20
 eO_1                -4.229138e-01 1 1  ON 21
 eO_2                -3.997911e-02 1 1  ON 22
 eO_3                 1.929327e-01 1 1  ON 23
 eO_4                 2.768072e-01 1 1  ON 24
 eO_5                 3.043910e-01 1 1  ON 25
 eO_6                 2.489353e-01 1 1  ON 26
 eO_7                 1.103888e-01 1 1  ON 27
 eO_8                 2.769487e-02 1 1  ON 28
 eO_9                 1.833839e-02 1 1  ON 29
eH1_0                -1.791407e-01 1 1  ON 30
eH1_1                -1.010150e-01 1 1  ON 31
eH1_2                -6.240595e-02 1 1  ON 32
eH1_3                -2.660270e-02 1 1  ON 33
eH1_4                 1.919598e-02 1 1  ON 34
eH1_5                 3.382318e-02 1 1  ON 35
eH1_6                 7.656540e-02 1 1  ON 36
eH1_7                 1.105504e-01 1 1  ON 37
eH1_8                 8.979500e-02 1 1  ON 38
eH1_9                 2.401095e-02 1 1  ON 39
eH2_0                -1.807358e-01 1 1  ON 40
eH2_1                -1.027543e-01 1 1  ON 41
eH2_2                -6.408248e-02 1 1  ON 42
eH2_3                -2.830807e-02 1 1  ON 43
eH2_4                 1.763752e-02 1 1  ON 44
eH2_5                 3.367265e-02 1 1  ON 45
eH2_6                 7.898094e-02 1 1  ON 46
eH2_7                 1.144380e-01 1 1  ON 47
eH2_8                 9.292389e-02 1 1  ON 48
eH2_9                 2.616833e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.3095
    reference variance = 0.768906
====================================================
  Execution time = 2.0353e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317073896238
                                         uncertainty =       0.003454344468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317073896238
                                         uncertainty =       0.003454344468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398161631
  error estimate for blocks of size 2^( 2) =       0.000408113204
  error estimate for blocks of size 2^( 3) =       0.000416814269
  error estimate for blocks of size 2^( 4) =       0.000422831740
  error estimate for blocks of size 2^( 5) =       0.000426865800
  error estimate for blocks of size 2^( 6) =       0.000428983842
  error estimate for blocks of size 2^( 7) =       0.000430216373

      target function =                  N/A
              le_mean =     -17.215775735624
             les_mean =     296.699999388868
             stat err =       0.000427224439
             autocorr =       1.151312880139
              std dev =       0.563085577960
             le_variance =       0.317065368106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721577573562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215775735624       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215774561847       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215791630353       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215800557674       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215822080487       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215836984165       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215842351753       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215846122894       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215851134033       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215842354366       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215851818264       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215852051046       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215854102805       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215852887861       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215852840739       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215851484101       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215851446917       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215852828515       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215852373834       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215852571105       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 2.275812e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215775735624       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215774836730       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215788294212       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215792912665       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215805039886       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215811056633       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215811957014       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215814153667       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215814268656       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215811239479       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215813142236       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215813456477       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215813292600       residual = 9.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 9.182136e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215775735624       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215775271498       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215782135918       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215784323838       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215788377422       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215789446428       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215789145884       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215789762348       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215789665612       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215789311698       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.025130e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5917e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.042394e-01 1 1  ON 0
 uu_1                 4.412600e-02 1 1  ON 1
 uu_2                -4.733109e-02 1 1  ON 2
 uu_3                -9.924747e-02 1 1  ON 3
 uu_4                -1.303583e-01 1 1  ON 4
 uu_5                -1.356899e-01 1 1  ON 5
 uu_6                -1.120830e-01 1 1  ON 6
 uu_7                -3.768832e-02 1 1  ON 7
 uu_8                 1.007399e-01 1 1  ON 8
 uu_9                 1.207618e-01 1 1  ON 9
 ud_0                 3.422278e-01 1 1  ON 10
 ud_1                 8.799671e-02 1 1  ON 11
 ud_2                -1.506241e-02 1 1  ON 12
 ud_3                -7.136436e-02 1 1  ON 13
 ud_4                -1.176025e-01 1 1  ON 14
 ud_5                -1.508804e-01 1 1  ON 15
 ud_6                -1.549067e-01 1 1  ON 16
 ud_7                -1.104573e-01 1 1  ON 17
 ud_8                 4.986543e-03 1 1  ON 18
 ud_9                 9.246854e-02 1 1  ON 19
 eO_0                -7.363085e-01 1 1  ON 20
 eO_1                -4.284315e-01 1 1  ON 21
 eO_2                -4.044505e-02 1 1  ON 22
 eO_3                 1.977296e-01 1 1  ON 23
 eO_4                 2.835797e-01 1 1  ON 24
 eO_5                 3.052333e-01 1 1  ON 25
 eO_6                 2.501072e-01 1 1  ON 26
 eO_7                 1.116323e-01 1 1  ON 27
 eO_8                 2.778769e-02 1 1  ON 28
 eO_9                 1.844911e-02 1 1  ON 29
eH1_0                -1.801209e-01 1 1  ON 30
eH1_1                -1.020013e-01 1 1  ON 31
eH1_2                -6.232067e-02 1 1  ON 32
eH1_3                -2.678919e-02 1 1  ON 33
eH1_4                 1.927092e-02 1 1  ON 34
eH1_5                 3.455690e-02 1 1  ON 35
eH1_6                 7.687385e-02 1 1  ON 36
eH1_7                 1.105348e-01 1 1  ON 37
eH1_8                 9.049894e-02 1 1  ON 38
eH1_9                 2.415518e-02 1 1  ON 39
eH2_0                -1.817370e-01 1 1  ON 40
eH2_1                -1.031016e-01 1 1  ON 41
eH2_2                -6.395334e-02 1 1  ON 42
eH2_3                -2.794898e-02 1 1  ON 43
eH2_4                 1.760146e-02 1 1  ON 44
eH2_5                 3.362885e-02 1 1  ON 45
eH2_6                 7.894731e-02 1 1  ON 46
eH2_7                 1.143105e-01 1 1  ON 47
eH2_8                 9.372792e-02 1 1  ON 48
eH2_9                 2.640085e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.25
    reference variance = 0.242888
====================================================
  Execution time = 1.9871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1734e-01
  Total weights = 2.0000e+06
  Execution time = 1.8129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315409308439
                                         uncertainty =       0.003525148008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315409308439
                                         uncertainty =       0.003525148008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397056600
  error estimate for blocks of size 2^( 2) =       0.000407039786
  error estimate for blocks of size 2^( 3) =       0.000416204008
  error estimate for blocks of size 2^( 4) =       0.000422776912
  error estimate for blocks of size 2^( 5) =       0.000426834373
  error estimate for blocks of size 2^( 6) =       0.000428171737
  error estimate for blocks of size 2^( 7) =       0.000428104239

      target function =                  N/A
              le_mean =     -17.216553315284
             les_mean =     296.725015788077
             stat err =       0.000426471815
             autocorr =       1.153654674022
              std dev =       0.561522829210
             le_variance =       0.315307887723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319176243818
                                         uncertainty =       0.003580184231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319176243818
                                         uncertainty =       0.003580184231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399420562
  error estimate for blocks of size 2^( 2) =       0.000409238310
  error estimate for blocks of size 2^( 3) =       0.000418226067
  error estimate for blocks of size 2^( 4) =       0.000424664324
  error estimate for blocks of size 2^( 5) =       0.000428612568
  error estimate for blocks of size 2^( 6) =       0.000429845494
  error estimate for blocks of size 2^( 7) =       0.000429751489

      target function =                  N/A
              le_mean =     -17.216542343506
             les_mean =     296.728403677245
             stat err =       0.000428218469
             autocorr =       1.149396714765
              std dev =       0.564865976183
             le_variance =       0.319073571049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319627116430
                                         uncertainty =       0.003580551143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319627116430
                                         uncertainty =       0.003580551143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399702604
  error estimate for blocks of size 2^( 2) =       0.000409513899
  error estimate for blocks of size 2^( 3) =       0.000418505840
  error estimate for blocks of size 2^( 4) =       0.000424953017
  error estimate for blocks of size 2^( 5) =       0.000428908566
  error estimate for blocks of size 2^( 6) =       0.000430143735
  error estimate for blocks of size 2^( 7) =       0.000430062935

      target function =                  N/A
              le_mean =     -17.216541182511
             les_mean =     296.728814472232
             stat err =       0.000428517063
             autocorr =       1.149376424882
              std dev =       0.565264843160
             le_variance =       0.319524342912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316250966056
                                         uncertainty =       0.003535504666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316250966056
                                         uncertainty =       0.003535504666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397586005
  error estimate for blocks of size 2^( 2) =       0.000407530260
  error estimate for blocks of size 2^( 3) =       0.000416658501
  error estimate for blocks of size 2^( 4) =       0.000423206285
  error estimate for blocks of size 2^( 5) =       0.000427243578
  error estimate for blocks of size 2^( 6) =       0.000428559691
  error estimate for blocks of size 2^( 7) =       0.000428493089

      target function =                  N/A
              le_mean =     -17.216542054434
             les_mean =     296.725469417248
             stat err =       0.000426875661
             autocorr =       1.152764537823
              std dev =       0.562271520913
             le_variance =       0.316149263230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216553315284        initial  <--
     2.4414e-02     2.4414e-01             2.2758e-02       -17.216542343506
     9.7656e-02     9.7656e-01             9.1821e-03       -17.216541182511
     3.9062e-01     3.9062e+00             3.0251e-03       -17.216542054434

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0706
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.015498e-01 1 1  ON 0
 uu_1                 4.290452e-02 1 1  ON 1
 uu_2                -4.766660e-02 1 1  ON 2
 uu_3                -9.867579e-02 1 1  ON 3
 uu_4                -1.288729e-01 1 1  ON 4
 uu_5                -1.345009e-01 1 1  ON 5
 uu_6                -1.113940e-01 1 1  ON 6
 uu_7                -3.660463e-02 1 1  ON 7
 uu_8                 1.015813e-01 1 1  ON 8
 uu_9                 1.200891e-01 1 1  ON 9
 ud_0                 3.398000e-01 1 1  ON 10
 ud_1                 8.635463e-02 1 1  ON 11
 ud_2                -1.523795e-02 1 1  ON 12
 ud_3                -7.038809e-02 1 1  ON 13
 ud_4                -1.160081e-01 1 1  ON 14
 ud_5                -1.492870e-01 1 1  ON 15
 ud_6                -1.559671e-01 1 1  ON 16
 ud_7                -1.102509e-01 1 1  ON 17
 ud_8                 6.727981e-03 1 1  ON 18
 ud_9                 9.254885e-02 1 1  ON 19
 eO_0                -7.271264e-01 1 1  ON 20
 eO_1                -4.229138e-01 1 1  ON 21
 eO_2                -3.997911e-02 1 1  ON 22
 eO_3                 1.929327e-01 1 1  ON 23
 eO_4                 2.768072e-01 1 1  ON 24
 eO_5                 3.043910e-01 1 1  ON 25
 eO_6                 2.489353e-01 1 1  ON 26
 eO_7                 1.103888e-01 1 1  ON 27
 eO_8                 2.769487e-02 1 1  ON 28
 eO_9                 1.833839e-02 1 1  ON 29
eH1_0                -1.791407e-01 1 1  ON 30
eH1_1                -1.010150e-01 1 1  ON 31
eH1_2                -6.240595e-02 1 1  ON 32
eH1_3                -2.660270e-02 1 1  ON 33
eH1_4                 1.919598e-02 1 1  ON 34
eH1_5                 3.382318e-02 1 1  ON 35
eH1_6                 7.656540e-02 1 1  ON 36
eH1_7                 1.105504e-01 1 1  ON 37
eH1_8                 8.979500e-02 1 1  ON 38
eH1_9                 2.401095e-02 1 1  ON 39
eH2_0                -1.807358e-01 1 1  ON 40
eH2_1                -1.027543e-01 1 1  ON 41
eH2_2                -6.408248e-02 1 1  ON 42
eH2_3                -2.830807e-02 1 1  ON 43
eH2_4                 1.763752e-02 1 1  ON 44
eH2_5                 3.367265e-02 1 1  ON 45
eH2_6                 7.898094e-02 1 1  ON 46
eH2_7                 1.144380e-01 1 1  ON 47
eH2_8                 9.292389e-02 1 1  ON 48
eH2_9                 2.616833e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4993e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2279
    reference variance = 0.189939
====================================================
  Execution time = 2.0268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2366e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323773307738
                                         uncertainty =       0.008262970123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323773307738
                                         uncertainty =       0.008262970123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402280631
  error estimate for blocks of size 2^( 2) =       0.000412048784
  error estimate for blocks of size 2^( 3) =       0.000420446159
  error estimate for blocks of size 2^( 4) =       0.000426583350
  error estimate for blocks of size 2^( 5) =       0.000431457924
  error estimate for blocks of size 2^( 6) =       0.000432363230
  error estimate for blocks of size 2^( 7) =       0.000432223284

      target function =                  N/A
              le_mean =     -17.216418924643
             les_mean =     296.728739839543
             stat err =       0.000430656947
             autocorr =       1.146052911239
              std dev =       0.568910724598
             le_variance =       0.323659412562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641892464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216418924643       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216418678317       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216420912108       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216430335464       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216438198939       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216439534638       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216439521898       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216439065213       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216439181837       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216439092510       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216439272131       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 4.548917e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216418924643       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216418835819       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216419458490       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216422358857       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216424927158       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216425173805       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216425095497       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216424962993       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216424943424       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.348407e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216418924643       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216418899676       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216419051392       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216419812763       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216420484966       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216420558837       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216420540965       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216420520110       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 3.556208e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5860e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.019892e-01 1 1  ON 0
 uu_1                 4.308072e-02 1 1  ON 1
 uu_2                -4.761198e-02 1 1  ON 2
 uu_3                -9.882879e-02 1 1  ON 3
 uu_4                -1.291112e-01 1 1  ON 4
 uu_5                -1.345928e-01 1 1  ON 5
 uu_6                -1.115509e-01 1 1  ON 6
 uu_7                -3.673874e-02 1 1  ON 7
 uu_8                 1.015337e-01 1 1  ON 8
 uu_9                 1.201686e-01 1 1  ON 9
 ud_0                 3.402458e-01 1 1  ON 10
 ud_1                 8.655585e-02 1 1  ON 11
 ud_2                -1.527468e-02 1 1  ON 12
 ud_3                -7.062632e-02 1 1  ON 13
 ud_4                -1.162979e-01 1 1  ON 14
 ud_5                -1.493947e-01 1 1  ON 15
 ud_6                -1.558517e-01 1 1  ON 16
 ud_7                -1.102752e-01 1 1  ON 17
 ud_8                 6.600158e-03 1 1  ON 18
 ud_9                 9.255481e-02 1 1  ON 19
 eO_0                -7.284748e-01 1 1  ON 20
 eO_1                -4.235587e-01 1 1  ON 21
 eO_2                -3.977656e-02 1 1  ON 22
 eO_3                 1.937077e-01 1 1  ON 23
 eO_4                 2.775317e-01 1 1  ON 24
 eO_5                 3.044623e-01 1 1  ON 25
 eO_6                 2.490017e-01 1 1  ON 26
 eO_7                 1.105059e-01 1 1  ON 27
 eO_8                 2.771676e-02 1 1  ON 28
 eO_9                 1.834858e-02 1 1  ON 29
eH1_0                -1.792661e-01 1 1  ON 30
eH1_1                -1.011714e-01 1 1  ON 31
eH1_2                -6.244721e-02 1 1  ON 32
eH1_3                -2.657981e-02 1 1  ON 33
eH1_4                 1.927961e-02 1 1  ON 34
eH1_5                 3.397157e-02 1 1  ON 35
eH1_6                 7.657141e-02 1 1  ON 36
eH1_7                 1.105204e-01 1 1  ON 37
eH1_8                 8.985823e-02 1 1  ON 38
eH1_9                 2.403330e-02 1 1  ON 39
eH2_0                -1.808969e-01 1 1  ON 40
eH2_1                -1.029115e-01 1 1  ON 41
eH2_2                -6.404113e-02 1 1  ON 42
eH2_3                -2.823229e-02 1 1  ON 43
eH2_4                 1.776557e-02 1 1  ON 44
eH2_5                 3.367352e-02 1 1  ON 45
eH2_6                 7.894936e-02 1 1  ON 46
eH2_7                 1.144264e-01 1 1  ON 47
eH2_8                 9.300610e-02 1 1  ON 48
eH2_9                 2.619131e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2027
    reference variance = 0.182273
====================================================
  Execution time = 1.9818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2223e-01
  Total weights = 2.0000e+06
  Execution time = 1.8119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321861199672
                                         uncertainty =       0.004113988173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321861199672
                                         uncertainty =       0.004113988173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401130347
  error estimate for blocks of size 2^( 2) =       0.000410519010
  error estimate for blocks of size 2^( 3) =       0.000419668011
  error estimate for blocks of size 2^( 4) =       0.000425587160
  error estimate for blocks of size 2^( 5) =       0.000430004084
  error estimate for blocks of size 2^( 6) =       0.000431768730
  error estimate for blocks of size 2^( 7) =       0.000430423240

      target function =                  N/A
              le_mean =     -17.216672698167
             les_mean =     296.735629745657
             stat err =       0.000429445803
             autocorr =       1.146161160661
              std dev =       0.567283977164
             le_variance =       0.321811110747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323081364240
                                         uncertainty =       0.004129707555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323081364240
                                         uncertainty =       0.004129707555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401890189
  error estimate for blocks of size 2^( 2) =       0.000411225597
  error estimate for blocks of size 2^( 3) =       0.000420326442
  error estimate for blocks of size 2^( 4) =       0.000426206775
  error estimate for blocks of size 2^( 5) =       0.000430605932
  error estimate for blocks of size 2^( 6) =       0.000432374778
  error estimate for blocks of size 2^( 7) =       0.000430998267

      target function =                  N/A
              le_mean =     -17.216669022102
             les_mean =     296.736723503816
             stat err =       0.000430046438
             autocorr =       1.145027453938
              std dev =       0.568358556472
             le_variance =       0.323031448715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322712975590
                                         uncertainty =       0.004124813771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322712975590
                                         uncertainty =       0.004124813771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401660909
  error estimate for blocks of size 2^( 2) =       0.000411013263
  error estimate for blocks of size 2^( 3) =       0.000420130271
  error estimate for blocks of size 2^( 4) =       0.000426024673
  error estimate for blocks of size 2^( 5) =       0.000430430160
  error estimate for blocks of size 2^( 6) =       0.000432198589
  error estimate for blocks of size 2^( 7) =       0.000430833134

      target function =                  N/A
              le_mean =     -17.216670076297
             les_mean =     296.736391326384
             stat err =       0.000429871639
             autocorr =       1.145403361072
              std dev =       0.568034305001
             le_variance =       0.322662971658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321982474827
                                         uncertainty =       0.004115530638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321982474827
                                         uncertainty =       0.004115530638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401205929
  error estimate for blocks of size 2^( 2) =       0.000410589341
  error estimate for blocks of size 2^( 3) =       0.000419733778
  error estimate for blocks of size 2^( 4) =       0.000425649527
  error estimate for blocks of size 2^( 5) =       0.000430064857
  error estimate for blocks of size 2^( 6) =       0.000431830096
  error estimate for blocks of size 2^( 7) =       0.000430481735

      target function =                  N/A
              le_mean =     -17.216672124480
             les_mean =     296.735731276000
             stat err =       0.000429506554
             autocorr =       1.146053534567
              std dev =       0.567390866254
             le_variance =       0.321932395109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216672698167        initial  <--
     2.4414e-01     2.4414e+00             4.5489e-03       -17.216669022102
     9.7656e-01     9.7656e+00             1.3484e-03       -17.216670076297
     3.9062e+00     3.9062e+01             3.5562e-04       -17.216672124480

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9904
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.015498e-01 1 1  ON 0
 uu_1                 4.290452e-02 1 1  ON 1
 uu_2                -4.766660e-02 1 1  ON 2
 uu_3                -9.867579e-02 1 1  ON 3
 uu_4                -1.288729e-01 1 1  ON 4
 uu_5                -1.345009e-01 1 1  ON 5
 uu_6                -1.113940e-01 1 1  ON 6
 uu_7                -3.660463e-02 1 1  ON 7
 uu_8                 1.015813e-01 1 1  ON 8
 uu_9                 1.200891e-01 1 1  ON 9
 ud_0                 3.398000e-01 1 1  ON 10
 ud_1                 8.635463e-02 1 1  ON 11
 ud_2                -1.523795e-02 1 1  ON 12
 ud_3                -7.038809e-02 1 1  ON 13
 ud_4                -1.160081e-01 1 1  ON 14
 ud_5                -1.492870e-01 1 1  ON 15
 ud_6                -1.559671e-01 1 1  ON 16
 ud_7                -1.102509e-01 1 1  ON 17
 ud_8                 6.727981e-03 1 1  ON 18
 ud_9                 9.254885e-02 1 1  ON 19
 eO_0                -7.271264e-01 1 1  ON 20
 eO_1                -4.229138e-01 1 1  ON 21
 eO_2                -3.997911e-02 1 1  ON 22
 eO_3                 1.929327e-01 1 1  ON 23
 eO_4                 2.768072e-01 1 1  ON 24
 eO_5                 3.043910e-01 1 1  ON 25
 eO_6                 2.489353e-01 1 1  ON 26
 eO_7                 1.103888e-01 1 1  ON 27
 eO_8                 2.769487e-02 1 1  ON 28
 eO_9                 1.833839e-02 1 1  ON 29
eH1_0                -1.791407e-01 1 1  ON 30
eH1_1                -1.010150e-01 1 1  ON 31
eH1_2                -6.240595e-02 1 1  ON 32
eH1_3                -2.660270e-02 1 1  ON 33
eH1_4                 1.919598e-02 1 1  ON 34
eH1_5                 3.382318e-02 1 1  ON 35
eH1_6                 7.656540e-02 1 1  ON 36
eH1_7                 1.105504e-01 1 1  ON 37
eH1_8                 8.979500e-02 1 1  ON 38
eH1_9                 2.401095e-02 1 1  ON 39
eH2_0                -1.807358e-01 1 1  ON 40
eH2_1                -1.027543e-01 1 1  ON 41
eH2_2                -6.408248e-02 1 1  ON 42
eH2_3                -2.830807e-02 1 1  ON 43
eH2_4                 1.763752e-02 1 1  ON 44
eH2_5                 3.367265e-02 1 1  ON 45
eH2_6                 7.898094e-02 1 1  ON 46
eH2_7                 1.144380e-01 1 1  ON 47
eH2_8                 9.292389e-02 1 1  ON 48
eH2_9                 2.616833e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4856e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1772
    reference variance = 0.28525
====================================================
  Execution time = 2.0587e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1701e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316871242047
                                         uncertainty =       0.004494244938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316871242047
                                         uncertainty =       0.004494244938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398124339
  error estimate for blocks of size 2^( 2) =       0.000408303222
  error estimate for blocks of size 2^( 3) =       0.000416879749
  error estimate for blocks of size 2^( 4) =       0.000423250426
  error estimate for blocks of size 2^( 5) =       0.000428069850
  error estimate for blocks of size 2^( 6) =       0.000429716544
  error estimate for blocks of size 2^( 7) =       0.000432878346

      target function =                  N/A
              le_mean =     -17.215814816238
             les_mean =     296.701285607623
             stat err =       0.000428478791
             autocorr =       1.158300390190
              std dev =       0.563032840190
             le_variance =       0.317005979133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721581481624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215814816238       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215814619728       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215814984594       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215815555255       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215816926653       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215817196593       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215817190325       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215817100250       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 5.753998e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215814816238       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215814763983       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215814856441       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215814984495       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215815333060       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215815406736       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215815407371       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215815391228       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.469943e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215814816238       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215814802963       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215814826148       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215814857102       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215814944374       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215814963182       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215814963523       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215814959870       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 3.695192e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144485 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6562e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.015953e-01 1 1  ON 0
 uu_1                 4.291922e-02 1 1  ON 1
 uu_2                -4.766371e-02 1 1  ON 2
 uu_3                -9.869569e-02 1 1  ON 3
 uu_4                -1.288946e-01 1 1  ON 4
 uu_5                -1.345058e-01 1 1  ON 5
 uu_6                -1.114003e-01 1 1  ON 6
 uu_7                -3.662035e-02 1 1  ON 7
 uu_8                 1.015725e-01 1 1  ON 8
 uu_9                 1.200954e-01 1 1  ON 9
 ud_0                 3.398532e-01 1 1  ON 10
 ud_1                 8.638871e-02 1 1  ON 11
 ud_2                -1.524977e-02 1 1  ON 12
 ud_3                -7.041199e-02 1 1  ON 13
 ud_4                -1.160384e-01 1 1  ON 14
 ud_5                -1.492987e-01 1 1  ON 15
 ud_6                -1.559613e-01 1 1  ON 16
 ud_7                -1.102594e-01 1 1  ON 17
 ud_8                 6.714297e-03 1 1  ON 18
 ud_9                 9.254919e-02 1 1  ON 19
 eO_0                -7.272734e-01 1 1  ON 20
 eO_1                -4.229830e-01 1 1  ON 21
 eO_2                -3.995451e-02 1 1  ON 22
 eO_3                 1.930259e-01 1 1  ON 23
 eO_4                 2.768792e-01 1 1  ON 24
 eO_5                 3.043968e-01 1 1  ON 25
 eO_6                 2.489418e-01 1 1  ON 26
 eO_7                 1.103995e-01 1 1  ON 27
 eO_8                 2.769653e-02 1 1  ON 28
 eO_9                 1.833944e-02 1 1  ON 29
eH1_0                -1.791541e-01 1 1  ON 30
eH1_1                -1.010291e-01 1 1  ON 31
eH1_2                -6.239815e-02 1 1  ON 32
eH1_3                -2.661035e-02 1 1  ON 33
eH1_4                 1.920249e-02 1 1  ON 34
eH1_5                 3.383579e-02 1 1  ON 35
eH1_6                 7.656730e-02 1 1  ON 36
eH1_7                 1.105468e-01 1 1  ON 37
eH1_8                 8.980174e-02 1 1  ON 38
eH1_9                 2.401350e-02 1 1  ON 39
eH2_0                -1.807438e-01 1 1  ON 40
eH2_1                -1.027604e-01 1 1  ON 41
eH2_2                -6.408589e-02 1 1  ON 42
eH2_3                -2.830699e-02 1 1  ON 43
eH2_4                 1.764442e-02 1 1  ON 44
eH2_5                 3.367369e-02 1 1  ON 45
eH2_6                 7.898131e-02 1 1  ON 46
eH2_7                 1.144378e-01 1 1  ON 47
eH2_8                 9.292954e-02 1 1  ON 48
eH2_9                 2.616996e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1994
    reference variance = 0.236334
====================================================
  Execution time = 1.9908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1867e-01
  Total weights = 2.0000e+06
  Execution time = 1.8306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318681341990
                                         uncertainty =       0.004311326764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318681341990
                                         uncertainty =       0.004311326764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399134680
  error estimate for blocks of size 2^( 2) =       0.000409458260
  error estimate for blocks of size 2^( 3) =       0.000418268561
  error estimate for blocks of size 2^( 4) =       0.000424491117
  error estimate for blocks of size 2^( 5) =       0.000428334235
  error estimate for blocks of size 2^( 6) =       0.000430985427
  error estimate for blocks of size 2^( 7) =       0.000431730631

      target function =                  N/A
              le_mean =     -17.215794483013
             les_mean =     296.702196507088
             stat err =       0.000428885352
             autocorr =       1.154631762994
              std dev =       0.564461677213
             le_variance =       0.318616985042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318870389699
                                         uncertainty =       0.004313203780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318870389699
                                         uncertainty =       0.004313203780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399253034
  error estimate for blocks of size 2^( 2) =       0.000409568482
  error estimate for blocks of size 2^( 3) =       0.000418371066
  error estimate for blocks of size 2^( 4) =       0.000424588155
  error estimate for blocks of size 2^( 5) =       0.000428426723
  error estimate for blocks of size 2^( 6) =       0.000431077430
  error estimate for blocks of size 2^( 7) =       0.000431818804

      target function =                  N/A
              le_mean =     -17.215794625869
             les_mean =     296.702390410775
             stat err =       0.000428977778
             autocorr =       1.154444718413
              std dev =       0.564629055281
             le_variance =       0.318805970068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318780025154
                                         uncertainty =       0.004312293585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318780025154
                                         uncertainty =       0.004312293585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399196465
  error estimate for blocks of size 2^( 2) =       0.000409515786
  error estimate for blocks of size 2^( 3) =       0.000418322051
  error estimate for blocks of size 2^( 4) =       0.000424541734
  error estimate for blocks of size 2^( 5) =       0.000428382450
  error estimate for blocks of size 2^( 6) =       0.000431033442
  error estimate for blocks of size 2^( 7) =       0.000431776592

      target function =                  N/A
              le_mean =     -17.215794525915
             les_mean =     296.702296634573
             stat err =       0.000428933554
             autocorr =       1.154533845820
              std dev =       0.564549054924
             le_variance =       0.318715635415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318693802207
                                         uncertainty =       0.004311448136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318693802207
                                         uncertainty =       0.004311448136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399142482
  error estimate for blocks of size 2^( 2) =       0.000409465521
  error estimate for blocks of size 2^( 3) =       0.000418275311
  error estimate for blocks of size 2^( 4) =       0.000424497501
  error estimate for blocks of size 2^( 5) =       0.000428340314
  error estimate for blocks of size 2^( 6) =       0.000430991484
  error estimate for blocks of size 2^( 7) =       0.000431736426

      target function =                  N/A
              le_mean =     -17.215794484573
             les_mean =     296.702209016861
             stat err =       0.000428891431
             autocorr =       1.154619354821
              std dev =       0.564472710689
             le_variance =       0.318629441112


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215794483013        initial
     2.4414e+00     2.4414e+01             5.7540e-04       -17.215794625869  <--
     9.7656e+00     9.7656e+01             1.4699e-04       -17.215794525915
     3.9062e+01     3.9062e+02             3.6952e-05       -17.215794484573

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9240e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.017270e-01 1 1  ON 0
 uu_1                 4.296421e-02 1 1  ON 1
 uu_2                -4.765447e-02 1 1  ON 2
 uu_3                -9.875079e-02 1 1  ON 3
 uu_4                -1.289601e-01 1 1  ON 4
 uu_5                -1.345229e-01 1 1  ON 5
 uu_6                -1.114186e-01 1 1  ON 6
 uu_7                -3.666677e-02 1 1  ON 7
 uu_8                 1.015462e-01 1 1  ON 8
 uu_9                 1.201144e-01 1 1  ON 9
 ud_0                 3.400050e-01 1 1  ON 10
 ud_1                 8.648253e-02 1 1  ON 11
 ud_2                -1.527723e-02 1 1  ON 12
 ud_3                -7.047898e-02 1 1  ON 13
 ud_4                -1.161252e-01 1 1  ON 14
 ud_5                -1.493359e-01 1 1  ON 15
 ud_6                -1.559437e-01 1 1  ON 16
 ud_7                -1.102841e-01 1 1  ON 17
 ud_8                 6.673715e-03 1 1  ON 18
 ud_9                 9.255024e-02 1 1  ON 19
 eO_0                -7.277018e-01 1 1  ON 20
 eO_1                -4.231857e-01 1 1  ON 21
 eO_2                -3.989226e-02 1 1  ON 22
 eO_3                 1.932980e-01 1 1  ON 23
 eO_4                 2.770952e-01 1 1  ON 24
 eO_5                 3.044151e-01 1 1  ON 25
 eO_6                 2.489615e-01 1 1  ON 26
 eO_7                 1.104313e-01 1 1  ON 27
 eO_8                 2.770147e-02 1 1  ON 28
 eO_9                 1.834260e-02 1 1  ON 29
eH1_0                -1.791937e-01 1 1  ON 30
eH1_1                -1.010699e-01 1 1  ON 31
eH1_2                -6.237758e-02 1 1  ON 32
eH1_3                -2.663014e-02 1 1  ON 33
eH1_4                 1.921911e-02 1 1  ON 34
eH1_5                 3.387319e-02 1 1  ON 35
eH1_6                 7.657374e-02 1 1  ON 36
eH1_7                 1.105362e-01 1 1  ON 37
eH1_8                 8.982187e-02 1 1  ON 38
eH1_9                 2.402110e-02 1 1  ON 39
eH2_0                -1.807672e-01 1 1  ON 40
eH2_1                -1.027798e-01 1 1  ON 41
eH2_2                -6.409446e-02 1 1  ON 42
eH2_3                -2.830462e-02 1 1  ON 43
eH2_4                 1.766326e-02 1 1  ON 44
eH2_5                 3.367745e-02 1 1  ON 45
eH2_6                 7.898310e-02 1 1  ON 46
eH2_7                 1.144376e-01 1 1  ON 47
eH2_8                 9.294639e-02 1 1  ON 48
eH2_9                 2.617483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1959
    reference variance = 0.161309
====================================================
  Execution time = 2.2271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3251e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332612861736
                                         uncertainty =       0.010448006553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332612861736
                                         uncertainty =       0.010448006553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407744973
  error estimate for blocks of size 2^( 2) =       0.000417356026
  error estimate for blocks of size 2^( 3) =       0.000426172980
  error estimate for blocks of size 2^( 4) =       0.000432597848
  error estimate for blocks of size 2^( 5) =       0.000436694839
  error estimate for blocks of size 2^( 6) =       0.000439468002
  error estimate for blocks of size 2^( 7) =       0.000439903715

      target function =                  N/A
              le_mean =     -17.215508975954
             les_mean =     296.706261060246
             stat err =       0.000437166101
             autocorr =       1.149517868252
              std dev =       0.576638470220
             le_variance =       0.332511925337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721550897595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215508975954       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215510278946       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215514420659       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215516484035       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215516091964       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215516661427       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215516911803       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215516773748       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215517064221       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215517160888       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.071003e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215508975954       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215509371093       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215510594988       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215511160180       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215511038236       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215511152776       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215511156631       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215511128595       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215511180584       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 5.508215e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215508975954       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215509080296       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215509401293       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215509545702       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215509512258       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215509539427       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215509535928       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215509530867       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.397500e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7807e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.019470e-01 1 1  ON 0
 uu_1                 4.302071e-02 1 1  ON 1
 uu_2                -4.764436e-02 1 1  ON 2
 uu_3                -9.881691e-02 1 1  ON 3
 uu_4                -1.291082e-01 1 1  ON 4
 uu_5                -1.345597e-01 1 1  ON 5
 uu_6                -1.114138e-01 1 1  ON 6
 uu_7                -3.672147e-02 1 1  ON 7
 uu_8                 1.015050e-01 1 1  ON 8
 uu_9                 1.201378e-01 1 1  ON 9
 ud_0                 3.402296e-01 1 1  ON 10
 ud_1                 8.655631e-02 1 1  ON 11
 ud_2                -1.529387e-02 1 1  ON 12
 ud_3                -7.059663e-02 1 1  ON 13
 ud_4                -1.162341e-01 1 1  ON 14
 ud_5                -1.493879e-01 1 1  ON 15
 ud_6                -1.558993e-01 1 1  ON 16
 ud_7                -1.103089e-01 1 1  ON 17
 ud_8                 6.620622e-03 1 1  ON 18
 ud_9                 9.255283e-02 1 1  ON 19
 eO_0                -7.282526e-01 1 1  ON 20
 eO_1                -4.234974e-01 1 1  ON 21
 eO_2                -3.981007e-02 1 1  ON 22
 eO_3                 1.936642e-01 1 1  ON 23
 eO_4                 2.773836e-01 1 1  ON 24
 eO_5                 3.044429e-01 1 1  ON 25
 eO_6                 2.490000e-01 1 1  ON 26
 eO_7                 1.104775e-01 1 1  ON 27
 eO_8                 2.770813e-02 1 1  ON 28
 eO_9                 1.834706e-02 1 1  ON 29
eH1_0                -1.792118e-01 1 1  ON 30
eH1_1                -1.011489e-01 1 1  ON 31
eH1_2                -6.234849e-02 1 1  ON 32
eH1_3                -2.661441e-02 1 1  ON 33
eH1_4                 1.920783e-02 1 1  ON 34
eH1_5                 3.390064e-02 1 1  ON 35
eH1_6                 7.658756e-02 1 1  ON 36
eH1_7                 1.105246e-01 1 1  ON 37
eH1_8                 8.984656e-02 1 1  ON 38
eH1_9                 2.403012e-02 1 1  ON 39
eH2_0                -1.808508e-01 1 1  ON 40
eH2_1                -1.028289e-01 1 1  ON 41
eH2_2                -6.409325e-02 1 1  ON 42
eH2_3                -2.830229e-02 1 1  ON 43
eH2_4                 1.771356e-02 1 1  ON 44
eH2_5                 3.372652e-02 1 1  ON 45
eH2_6                 7.897816e-02 1 1  ON 46
eH2_7                 1.144270e-01 1 1  ON 47
eH2_8                 9.297729e-02 1 1  ON 48
eH2_9                 2.618319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2395
    reference variance = 0.407066
====================================================
  Execution time = 1.9874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1326e-01
  Total weights = 2.0000e+06
  Execution time = 1.9123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312987058408
                                         uncertainty =       0.002860239176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312987058408
                                         uncertainty =       0.002860239176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395635526
  error estimate for blocks of size 2^( 2) =       0.000405785990
  error estimate for blocks of size 2^( 3) =       0.000414836919
  error estimate for blocks of size 2^( 4) =       0.000420526545
  error estimate for blocks of size 2^( 5) =       0.000425115705
  error estimate for blocks of size 2^( 6) =       0.000427846092
  error estimate for blocks of size 2^( 7) =       0.000426861811

      target function =                  N/A
              le_mean =     -17.215470560034
             les_mean =     296.685481385015
             stat err =       0.000425087538
             autocorr =       1.154426223550
              std dev =       0.559513125984
             le_variance =       0.313054938148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662266308
                                         uncertainty =       0.002867834135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662266308
                                         uncertainty =       0.002867834135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396062055
  error estimate for blocks of size 2^( 2) =       0.000406184721
  error estimate for blocks of size 2^( 3) =       0.000415205033
  error estimate for blocks of size 2^( 4) =       0.000420871597
  error estimate for blocks of size 2^( 5) =       0.000425445702
  error estimate for blocks of size 2^( 6) =       0.000428174338
  error estimate for blocks of size 2^( 7) =       0.000427172774

      target function =                  N/A
              le_mean =     -17.215473750344
             les_mean =     296.686266594721
             stat err =       0.000425416103
             autocorr =       1.153722538026
              std dev =       0.560116329698
             le_variance =       0.313730302795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313403544358
                                         uncertainty =       0.002864940766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313403544358
                                         uncertainty =       0.002864940766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395898676
  error estimate for blocks of size 2^( 2) =       0.000406032536
  error estimate for blocks of size 2^( 3) =       0.000415065336
  error estimate for blocks of size 2^( 4) =       0.000420741375
  error estimate for blocks of size 2^( 5) =       0.000425322050
  error estimate for blocks of size 2^( 6) =       0.000428051605
  error estimate for blocks of size 2^( 7) =       0.000427057287

      target function =                  N/A
              le_mean =     -17.215472249293
             les_mean =     296.685956132849
             stat err =       0.000425293079
             autocorr =       1.154007235851
              std dev =       0.559885277014
             le_variance =       0.313471523418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313042805711
                                         uncertainty =       0.002860871957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313042805711
                                         uncertainty =       0.002860871957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395670759
  error estimate for blocks of size 2^( 2) =       0.000405818992
  error estimate for blocks of size 2^( 3) =       0.000414867521
  error estimate for blocks of size 2^( 4) =       0.000420555354
  error estimate for blocks of size 2^( 5) =       0.000425143398
  error estimate for blocks of size 2^( 6) =       0.000427873689
  error estimate for blocks of size 2^( 7) =       0.000426888088

      target function =                  N/A
              le_mean =     -17.215470746229
             les_mean =     296.685543556751
             stat err =       0.000425115132
             autocorr =       1.154370491083
              std dev =       0.559562953587
             le_variance =       0.313110699027


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215470560034        initial
     6.1035e-01     6.1035e+00             2.0710e-03       -17.215473750344  <--
     2.4414e+00     2.4414e+01             5.5082e-04       -17.215472249293
     9.7656e+00     9.7656e+01             1.3975e-04       -17.215470746229

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9201e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.025013e-01 1 1  ON 0
 uu_1                 4.320374e-02 1 1  ON 1
 uu_2                -4.759435e-02 1 1  ON 2
 uu_3                -9.898723e-02 1 1  ON 3
 uu_4                -1.294782e-01 1 1  ON 4
 uu_5                -1.347108e-01 1 1  ON 5
 uu_6                -1.114015e-01 1 1  ON 6
 uu_7                -3.687549e-02 1 1  ON 7
 uu_8                 1.013847e-01 1 1  ON 8
 uu_9                 1.202084e-01 1 1  ON 9
 ud_0                 3.407380e-01 1 1  ON 10
 ud_1                 8.676998e-02 1 1  ON 11
 ud_2                -1.530720e-02 1 1  ON 12
 ud_3                -7.085762e-02 1 1  ON 13
 ud_4                -1.165302e-01 1 1  ON 14
 ud_5                -1.495428e-01 1 1  ON 15
 ud_6                -1.557709e-01 1 1  ON 16
 ud_7                -1.103714e-01 1 1  ON 17
 ud_8                 6.466600e-03 1 1  ON 18
 ud_9                 9.256126e-02 1 1  ON 19
 eO_0                -7.297728e-01 1 1  ON 20
 eO_1                -4.243636e-01 1 1  ON 21
 eO_2                -3.968048e-02 1 1  ON 22
 eO_3                 1.946406e-01 1 1  ON 23
 eO_4                 2.782568e-01 1 1  ON 24
 eO_5                 3.045511e-01 1 1  ON 25
 eO_6                 2.491201e-01 1 1  ON 26
 eO_7                 1.106165e-01 1 1  ON 27
 eO_8                 2.772828e-02 1 1  ON 28
 eO_9                 1.836045e-02 1 1  ON 29
eH1_0                -1.792731e-01 1 1  ON 30
eH1_1                -1.013421e-01 1 1  ON 31
eH1_2                -6.229457e-02 1 1  ON 32
eH1_3                -2.657325e-02 1 1  ON 33
eH1_4                 1.917555e-02 1 1  ON 34
eH1_5                 3.397084e-02 1 1  ON 35
eH1_6                 7.663795e-02 1 1  ON 36
eH1_7                 1.104939e-01 1 1  ON 37
eH1_8                 8.992094e-02 1 1  ON 38
eH1_9                 2.405721e-02 1 1  ON 39
eH2_0                -1.810790e-01 1 1  ON 40
eH2_1                -1.029737e-01 1 1  ON 41
eH2_2                -6.409350e-02 1 1  ON 42
eH2_3                -2.828898e-02 1 1  ON 43
eH2_4                 1.782300e-02 1 1  ON 44
eH2_5                 3.386994e-02 1 1  ON 45
eH2_6                 7.897696e-02 1 1  ON 46
eH2_7                 1.143993e-01 1 1  ON 47
eH2_8                 9.307019e-02 1 1  ON 48
eH2_9                 2.620835e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7024e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2074
    reference variance = 0.16973
====================================================
  Execution time = 2.0384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1846e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318477816024
                                         uncertainty =       0.003860408276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318477816024
                                         uncertainty =       0.003860408276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399036223
  error estimate for blocks of size 2^( 2) =       0.000408455918
  error estimate for blocks of size 2^( 3) =       0.000417365227
  error estimate for blocks of size 2^( 4) =       0.000423013687
  error estimate for blocks of size 2^( 5) =       0.000426628825
  error estimate for blocks of size 2^( 6) =       0.000428798960
  error estimate for blocks of size 2^( 7) =       0.000430309441

      target function =                  N/A
              le_mean =     -17.216314856509
             les_mean =     296.719956894216
             stat err =       0.000427187728
             autocorr =       1.146074615735
              std dev =       0.564322438867
             le_variance =       0.318459815009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631485651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216314856509       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319827450       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216326237589       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216342658398       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216342494483       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216343053069       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216342534850       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216343461589       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216342993446       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216344189308       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216344585981       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216344547253       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 5.997514e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216314856509       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216316845743       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216319413338       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216324282756       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216324377907       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216324158799       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216324145477       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216324137057       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216324149592       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216324368593       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 1.859135e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216314856509       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315441696       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216316205044       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216317346598       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216317506955       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216317454795       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216317358231       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216317396017       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 5.014740e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151408 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6071e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.031190e-01 1 1  ON 0
 uu_1                 4.347814e-02 1 1  ON 1
 uu_2                -4.748755e-02 1 1  ON 2
 uu_3                -9.912665e-02 1 1  ON 3
 uu_4                -1.297353e-01 1 1  ON 4
 uu_5                -1.348946e-01 1 1  ON 5
 uu_6                -1.116128e-01 1 1  ON 6
 uu_7                -3.720255e-02 1 1  ON 7
 uu_8                 1.012920e-01 1 1  ON 8
 uu_9                 1.203302e-01 1 1  ON 9
 ud_0                 3.412769e-01 1 1  ON 10
 ud_1                 8.707539e-02 1 1  ON 11
 ud_2                -1.522892e-02 1 1  ON 12
 ud_3                -7.110191e-02 1 1  ON 13
 ud_4                -1.169102e-01 1 1  ON 14
 ud_5                -1.498586e-01 1 1  ON 15
 ud_6                -1.555669e-01 1 1  ON 16
 ud_7                -1.104398e-01 1 1  ON 17
 ud_8                 6.256211e-03 1 1  ON 18
 ud_9                 9.257056e-02 1 1  ON 19
 eO_0                -7.316319e-01 1 1  ON 20
 eO_1                -4.253142e-01 1 1  ON 21
 eO_2                -3.952049e-02 1 1  ON 22
 eO_3                 1.957806e-01 1 1  ON 23
 eO_4                 2.793189e-01 1 1  ON 24
 eO_5                 3.046281e-01 1 1  ON 25
 eO_6                 2.492276e-01 1 1  ON 26
 eO_7                 1.108241e-01 1 1  ON 27
 eO_8                 2.776819e-02 1 1  ON 28
 eO_9                 1.837051e-02 1 1  ON 29
eH1_0                -1.796196e-01 1 1  ON 30
eH1_1                -1.014748e-01 1 1  ON 31
eH1_2                -6.224776e-02 1 1  ON 32
eH1_3                -2.664879e-02 1 1  ON 33
eH1_4                 1.922945e-02 1 1  ON 34
eH1_5                 3.430227e-02 1 1  ON 35
eH1_6                 7.668103e-02 1 1  ON 36
eH1_7                 1.104280e-01 1 1  ON 37
eH1_8                 9.002842e-02 1 1  ON 38
eH1_9                 2.408423e-02 1 1  ON 39
eH2_0                -1.812583e-01 1 1  ON 40
eH2_1                -1.030566e-01 1 1  ON 41
eH2_2                -6.400673e-02 1 1  ON 42
eH2_3                -2.826678e-02 1 1  ON 43
eH2_4                 1.777071e-02 1 1  ON 44
eH2_5                 3.394198e-02 1 1  ON 45
eH2_6                 7.896382e-02 1 1  ON 46
eH2_7                 1.143870e-01 1 1  ON 47
eH2_8                 9.318807e-02 1 1  ON 48
eH2_9                 2.624121e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2467
    reference variance = 0.191837
====================================================
  Execution time = 1.9906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2141e-01
  Total weights = 2.0000e+06
  Execution time = 1.8265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321013564582
                                         uncertainty =       0.004866369672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321013564582
                                         uncertainty =       0.004866369672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400595020
  error estimate for blocks of size 2^( 2) =       0.000410161834
  error estimate for blocks of size 2^( 3) =       0.000418744601
  error estimate for blocks of size 2^( 4) =       0.000425345137
  error estimate for blocks of size 2^( 5) =       0.000428990014
  error estimate for blocks of size 2^( 6) =       0.000431857000
  error estimate for blocks of size 2^( 7) =       0.000432607127

      target function =                  N/A
              le_mean =     -17.216243546085
             les_mean =     296.719994417510
             stat err =       0.000429699820
             autocorr =       1.150586438216
              std dev =       0.566526910109
             le_variance =       0.320952739878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322297954813
                                         uncertainty =       0.004891150112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322297954813
                                         uncertainty =       0.004891150112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401395050
  error estimate for blocks of size 2^( 2) =       0.000410914586
  error estimate for blocks of size 2^( 3) =       0.000419448235
  error estimate for blocks of size 2^( 4) =       0.000426015602
  error estimate for blocks of size 2^( 5) =       0.000429652670
  error estimate for blocks of size 2^( 6) =       0.000432524634
  error estimate for blocks of size 2^( 7) =       0.000433250423

      target function =                  N/A
              le_mean =     -17.216251540225
             les_mean =     296.721552906879
             stat err =       0.000430360832
             autocorr =       1.149533026051
              std dev =       0.567658323015
             le_variance =       0.322235971688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321930291963
                                         uncertainty =       0.004883123853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321930291963
                                         uncertainty =       0.004883123853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401166207
  error estimate for blocks of size 2^( 2) =       0.000410700522
  error estimate for blocks of size 2^( 3) =       0.000419251121
  error estimate for blocks of size 2^( 4) =       0.000425830071
  error estimate for blocks of size 2^( 5) =       0.000429469781
  error estimate for blocks of size 2^( 6) =       0.000432339333
  error estimate for blocks of size 2^( 7) =       0.000433074899

      target function =                  N/A
              le_mean =     -17.216247337399
             les_mean =     296.721040872413
             stat err =       0.000430178521
             autocorr =       1.149870043965
              std dev =       0.567334690319
             le_variance =       0.321868650839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321146555667
                                         uncertainty =       0.004868870478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321146555667
                                         uncertainty =       0.004868870478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400677935
  error estimate for blocks of size 2^( 2) =       0.000410239908
  error estimate for blocks of size 2^( 3) =       0.000418818175
  error estimate for blocks of size 2^( 4) =       0.000425415615
  error estimate for blocks of size 2^( 5) =       0.000429059847
  error estimate for blocks of size 2^( 6) =       0.000431927484
  error estimate for blocks of size 2^( 7) =       0.000432675596

      target function =                  N/A
              le_mean =     -17.216243690330
             les_mean =     296.720132259181
             stat err =       0.000429769636
             autocorr =       1.150484052517
              std dev =       0.566644169548
             le_variance =       0.321085614883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216243546085        initial
     1.5259e-01     1.5259e+00             5.9975e-03       -17.216251540225  <--
     6.1035e-01     6.1035e+00             1.8591e-03       -17.216247337399
     2.4414e+00     2.4414e+01             5.0147e-04       -17.216243690330

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9342e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.044273e-01 1 1  ON 0
 uu_1                 4.424995e-02 1 1  ON 1
 uu_2                -4.711805e-02 1 1  ON 2
 uu_3                -9.925803e-02 1 1  ON 3
 uu_4                -1.302921e-01 1 1  ON 4
 uu_5                -1.355101e-01 1 1  ON 5
 uu_6                -1.121814e-01 1 1  ON 6
 uu_7                -3.812536e-02 1 1  ON 7
 uu_8                 1.010178e-01 1 1  ON 8
 uu_9                 1.206842e-01 1 1  ON 9
 ud_0                 3.423249e-01 1 1  ON 10
 ud_1                 8.775904e-02 1 1  ON 11
 ud_2                -1.497560e-02 1 1  ON 12
 ud_3                -7.143341e-02 1 1  ON 13
 ud_4                -1.176205e-01 1 1  ON 14
 ud_5                -1.506277e-01 1 1  ON 15
 ud_6                -1.552535e-01 1 1  ON 16
 ud_7                -1.106084e-01 1 1  ON 17
 ud_8                 5.666986e-03 1 1  ON 18
 ud_9                 9.259866e-02 1 1  ON 19
 eO_0                -7.357703e-01 1 1  ON 20
 eO_1                -4.277967e-01 1 1  ON 21
 eO_2                -3.966385e-02 1 1  ON 22
 eO_3                 1.980018e-01 1 1  ON 23
 eO_4                 2.823369e-01 1 1  ON 24
 eO_5                 3.050522e-01 1 1  ON 25
 eO_6                 2.495603e-01 1 1  ON 26
 eO_7                 1.114298e-01 1 1  ON 27
 eO_8                 2.788515e-02 1 1  ON 28
 eO_9                 1.839994e-02 1 1  ON 29
eH1_0                -1.803778e-01 1 1  ON 30
eH1_1                -1.018536e-01 1 1  ON 31
eH1_2                -6.225677e-02 1 1  ON 32
eH1_3                -2.672981e-02 1 1  ON 33
eH1_4                 1.925915e-02 1 1  ON 34
eH1_5                 3.502379e-02 1 1  ON 35
eH1_6                 7.689314e-02 1 1  ON 36
eH1_7                 1.102666e-01 1 1  ON 37
eH1_8                 9.034305e-02 1 1  ON 38
eH1_9                 2.416317e-02 1 1  ON 39
eH2_0                -1.816531e-01 1 1  ON 40
eH2_1                -1.032785e-01 1 1  ON 41
eH2_2                -6.387350e-02 1 1  ON 42
eH2_3                -2.818976e-02 1 1  ON 43
eH2_4                 1.762383e-02 1 1  ON 44
eH2_5                 3.402616e-02 1 1  ON 45
eH2_6                 7.898562e-02 1 1  ON 46
eH2_7                 1.143706e-01 1 1  ON 47
eH2_8                 9.353212e-02 1 1  ON 48
eH2_9                 2.633736e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2263
    reference variance = 0.214709
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 4.0680e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406914677198
                                         uncertainty =       0.088875778155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406914677198
                                         uncertainty =       0.088875778155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000450996569
  error estimate for blocks of size 2^( 2) =       0.000459825297
  error estimate for blocks of size 2^( 3) =       0.000468551470
  error estimate for blocks of size 2^( 4) =       0.000474765412
  error estimate for blocks of size 2^( 5) =       0.000478965376
  error estimate for blocks of size 2^( 6) =       0.000480423807
  error estimate for blocks of size 2^( 7) =       0.000481777203

      target function =                  N/A
              le_mean =     -17.215793236101
             les_mean =     296.790332354730
             stat err =       0.000478982949
             autocorr =       1.127959826728
              std dev =       0.637805464041
             le_variance =       0.406795809961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721579323610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215793236101       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215794299112       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215796346337       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215798217615       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215804351346       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215814714218       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215815868511       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215816641169       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215819110412       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215819014620       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215818917712       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215817654337       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215818484919       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215818485761       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215818819537       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215818685396       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 1.307306e-02

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215793236101       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215793938295       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215795482703       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215794822481       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215800344604       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215801685929       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215802269594       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215802373844       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215802582236       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215802468530       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215802345371       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215802135702       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 4.559161e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215793236101       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215793533929       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215794280586       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215793481181       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215794031430       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215795376335       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215795487245       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215795533267       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215795524730       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 1.368736e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6030e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.056834e-01 1 1  ON 0
 uu_1                 4.475103e-02 1 1  ON 1
 uu_2                -4.693745e-02 1 1  ON 2
 uu_3                -9.948813e-02 1 1  ON 3
 uu_4                -1.307780e-01 1 1  ON 4
 uu_5                -1.363653e-01 1 1  ON 5
 uu_6                -1.123935e-01 1 1  ON 6
 uu_7                -3.856482e-02 1 1  ON 7
 uu_8                 1.004816e-01 1 1  ON 8
 uu_9                 1.210684e-01 1 1  ON 9
 ud_0                 3.432988e-01 1 1  ON 10
 ud_1                 8.874605e-02 1 1  ON 11
 ud_2                -1.462315e-02 1 1  ON 12
 ud_3                -7.158079e-02 1 1  ON 13
 ud_4                -1.186039e-01 1 1  ON 14
 ud_5                -1.513189e-01 1 1  ON 15
 ud_6                -1.549202e-01 1 1  ON 16
 ud_7                -1.107857e-01 1 1  ON 17
 ud_8                 4.681373e-03 1 1  ON 18
 ud_9                 9.260029e-02 1 1  ON 19
 eO_0                -7.403295e-01 1 1  ON 20
 eO_1                -4.308980e-01 1 1  ON 21
 eO_2                -4.063456e-02 1 1  ON 22
 eO_3                 1.999646e-01 1 1  ON 23
 eO_4                 2.858136e-01 1 1  ON 24
 eO_5                 3.066019e-01 1 1  ON 25
 eO_6                 2.503808e-01 1 1  ON 26
 eO_7                 1.121335e-01 1 1  ON 27
 eO_8                 2.793446e-02 1 1  ON 28
 eO_9                 1.844040e-02 1 1  ON 29
eH1_0                -1.811244e-01 1 1  ON 30
eH1_1                -1.023256e-01 1 1  ON 31
eH1_2                -6.254199e-02 1 1  ON 32
eH1_3                -2.659936e-02 1 1  ON 33
eH1_4                 1.943963e-02 1 1  ON 34
eH1_5                 3.529673e-02 1 1  ON 35
eH1_6                 7.723717e-02 1 1  ON 36
eH1_7                 1.102673e-01 1 1  ON 37
eH1_8                 9.081975e-02 1 1  ON 38
eH1_9                 2.425608e-02 1 1  ON 39
eH2_0                -1.818827e-01 1 1  ON 40
eH2_1                -1.041364e-01 1 1  ON 41
eH2_2                -6.417561e-02 1 1  ON 42
eH2_3                -2.811847e-02 1 1  ON 43
eH2_4                 1.774552e-02 1 1  ON 44
eH2_5                 3.473299e-02 1 1  ON 45
eH2_6                 7.911416e-02 1 1  ON 46
eH2_7                 1.141823e-01 1 1  ON 47
eH2_8                 9.391044e-02 1 1  ON 48
eH2_9                 2.645898e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.3028
    reference variance = 0.200962
====================================================
  Execution time = 1.9966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2402e-01
  Total weights = 2.0000e+06
  Execution time = 1.8346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323343849971
                                         uncertainty =       0.005264068387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323343849971
                                         uncertainty =       0.005264068387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402072160
  error estimate for blocks of size 2^( 2) =       0.000411426114
  error estimate for blocks of size 2^( 3) =       0.000420220604
  error estimate for blocks of size 2^( 4) =       0.000426275952
  error estimate for blocks of size 2^( 5) =       0.000430140579
  error estimate for blocks of size 2^( 6) =       0.000431743619
  error estimate for blocks of size 2^( 7) =       0.000433110109

      target function =                  N/A
              le_mean =     -17.217173179291
             les_mean =     296.754376168289
             stat err =       0.000430317565
             autocorr =       1.145434183766
              std dev =       0.568615902218
             le_variance =       0.323324044255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325032311523
                                         uncertainty =       0.005279446392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325032311523
                                         uncertainty =       0.005279446392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403120849
  error estimate for blocks of size 2^( 2) =       0.000412411029
  error estimate for blocks of size 2^( 3) =       0.000421127441
  error estimate for blocks of size 2^( 4) =       0.000427107306
  error estimate for blocks of size 2^( 5) =       0.000430943230
  error estimate for blocks of size 2^( 6) =       0.000432534052
  error estimate for blocks of size 2^( 7) =       0.000433857342

      target function =                  N/A
              le_mean =     -17.217163585648
             les_mean =     296.755734610526
             stat err =       0.000431110482
             autocorr =       1.143685579565
              std dev =       0.570098972155
             le_variance =       0.325012838052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324763515764
                                         uncertainty =       0.005277116662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324763515764
                                         uncertainty =       0.005277116662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402954147
  error estimate for blocks of size 2^( 2) =       0.000412258505
  error estimate for blocks of size 2^( 3) =       0.000420994117
  error estimate for blocks of size 2^( 4) =       0.000426989992
  error estimate for blocks of size 2^( 5) =       0.000430839659
  error estimate for blocks of size 2^( 6) =       0.000432437703
  error estimate for blocks of size 2^( 7) =       0.000433767719

      target function =                  N/A
              le_mean =     -17.217161040981
             les_mean =     296.755378237209
             stat err =       0.000431008768
             autocorr =       1.144092009475
              std dev =       0.569863219117
             le_variance =       0.324744088502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323557006560
                                         uncertainty =       0.005265660483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323557006560
                                         uncertainty =       0.005265660483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402204727
  error estimate for blocks of size 2^( 2) =       0.000411550506
  error estimate for blocks of size 2^( 3) =       0.000420335674
  error estimate for blocks of size 2^( 4) =       0.000426381255
  error estimate for blocks of size 2^( 5) =       0.000430244693
  error estimate for blocks of size 2^( 6) =       0.000431848376
  error estimate for blocks of size 2^( 7) =       0.000433207721

      target function =                  N/A
              le_mean =     -17.217168900071
             les_mean =     296.754442056995
             stat err =       0.000430420511
             autocorr =       1.145226995135
              std dev =       0.568803380067
             le_variance =       0.323537285175


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217173179291        initial  <--
     3.8147e-02     3.8147e-01             1.3073e-02       -17.217163585648
     1.5259e-01     1.5259e+00             4.5592e-03       -17.217161040981
     6.1035e-01     6.1035e+00             1.3687e-03       -17.217168900071

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3670
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.044273e-01 1 1  ON 0
 uu_1                 4.424995e-02 1 1  ON 1
 uu_2                -4.711805e-02 1 1  ON 2
 uu_3                -9.925803e-02 1 1  ON 3
 uu_4                -1.302921e-01 1 1  ON 4
 uu_5                -1.355101e-01 1 1  ON 5
 uu_6                -1.121814e-01 1 1  ON 6
 uu_7                -3.812536e-02 1 1  ON 7
 uu_8                 1.010178e-01 1 1  ON 8
 uu_9                 1.206842e-01 1 1  ON 9
 ud_0                 3.423249e-01 1 1  ON 10
 ud_1                 8.775904e-02 1 1  ON 11
 ud_2                -1.497560e-02 1 1  ON 12
 ud_3                -7.143341e-02 1 1  ON 13
 ud_4                -1.176205e-01 1 1  ON 14
 ud_5                -1.506277e-01 1 1  ON 15
 ud_6                -1.552535e-01 1 1  ON 16
 ud_7                -1.106084e-01 1 1  ON 17
 ud_8                 5.666986e-03 1 1  ON 18
 ud_9                 9.259866e-02 1 1  ON 19
 eO_0                -7.357703e-01 1 1  ON 20
 eO_1                -4.277967e-01 1 1  ON 21
 eO_2                -3.966385e-02 1 1  ON 22
 eO_3                 1.980018e-01 1 1  ON 23
 eO_4                 2.823369e-01 1 1  ON 24
 eO_5                 3.050522e-01 1 1  ON 25
 eO_6                 2.495603e-01 1 1  ON 26
 eO_7                 1.114298e-01 1 1  ON 27
 eO_8                 2.788515e-02 1 1  ON 28
 eO_9                 1.839994e-02 1 1  ON 29
eH1_0                -1.803778e-01 1 1  ON 30
eH1_1                -1.018536e-01 1 1  ON 31
eH1_2                -6.225677e-02 1 1  ON 32
eH1_3                -2.672981e-02 1 1  ON 33
eH1_4                 1.925915e-02 1 1  ON 34
eH1_5                 3.502379e-02 1 1  ON 35
eH1_6                 7.689314e-02 1 1  ON 36
eH1_7                 1.102666e-01 1 1  ON 37
eH1_8                 9.034305e-02 1 1  ON 38
eH1_9                 2.416317e-02 1 1  ON 39
eH2_0                -1.816531e-01 1 1  ON 40
eH2_1                -1.032785e-01 1 1  ON 41
eH2_2                -6.387350e-02 1 1  ON 42
eH2_3                -2.818976e-02 1 1  ON 43
eH2_4                 1.762383e-02 1 1  ON 44
eH2_5                 3.402616e-02 1 1  ON 45
eH2_6                 7.898562e-02 1 1  ON 46
eH2_7                 1.143706e-01 1 1  ON 47
eH2_8                 9.353212e-02 1 1  ON 48
eH2_9                 2.633736e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5402e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1734
    reference variance = 0.285335
====================================================
  Execution time = 2.0255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316200530728
                                         uncertainty =       0.002831700065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316200530728
                                         uncertainty =       0.002831700065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397909490
  error estimate for blocks of size 2^( 2) =       0.000407925036
  error estimate for blocks of size 2^( 3) =       0.000416783128
  error estimate for blocks of size 2^( 4) =       0.000423777154
  error estimate for blocks of size 2^( 5) =       0.000427819388
  error estimate for blocks of size 2^( 6) =       0.000428815598
  error estimate for blocks of size 2^( 7) =       0.000430663093

      target function =                  N/A
              le_mean =     -17.215899592885
             les_mean =     296.703862558935
             stat err =       0.000427768808
             autocorr =       1.155712026781
              std dev =       0.562728997810
             le_variance =       0.316663924977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721589959288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899592885       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215903149084       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215908115516       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215909935947       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215906976663       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215907400329       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215907917997       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215907853716       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215907996169       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 2.170811e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899592885       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215900770646       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215901834161       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215902936830       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215902152734       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215902189184       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215902235806       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215902192288       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 5.914402e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899592885       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215899913341       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215900166223       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215900498000       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215900322957       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215900320429       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215900323279       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215900316897       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 1.515660e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6019e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.046002e-01 1 1  ON 0
 uu_1                 4.432665e-02 1 1  ON 1
 uu_2                -4.706588e-02 1 1  ON 2
 uu_3                -9.928629e-02 1 1  ON 3
 uu_4                -1.304100e-01 1 1  ON 4
 uu_5                -1.355862e-01 1 1  ON 5
 uu_6                -1.122420e-01 1 1  ON 6
 uu_7                -3.822439e-02 1 1  ON 7
 uu_8                 1.009777e-01 1 1  ON 8
 uu_9                 1.207387e-01 1 1  ON 9
 ud_0                 3.424035e-01 1 1  ON 10
 ud_1                 8.786888e-02 1 1  ON 11
 ud_2                -1.498019e-02 1 1  ON 12
 ud_3                -7.147827e-02 1 1  ON 13
 ud_4                -1.177736e-01 1 1  ON 14
 ud_5                -1.507771e-01 1 1  ON 15
 ud_6                -1.551885e-01 1 1  ON 16
 ud_7                -1.105601e-01 1 1  ON 17
 ud_8                 5.636828e-03 1 1  ON 18
 ud_9                 9.262103e-02 1 1  ON 19
 eO_0                -7.363617e-01 1 1  ON 20
 eO_1                -4.281466e-01 1 1  ON 21
 eO_2                -3.972103e-02 1 1  ON 22
 eO_3                 1.983739e-01 1 1  ON 23
 eO_4                 2.827130e-01 1 1  ON 24
 eO_5                 3.051116e-01 1 1  ON 25
 eO_6                 2.496307e-01 1 1  ON 26
 eO_7                 1.115146e-01 1 1  ON 27
 eO_8                 2.790398e-02 1 1  ON 28
 eO_9                 1.840896e-02 1 1  ON 29
eH1_0                -1.804660e-01 1 1  ON 30
eH1_1                -1.019361e-01 1 1  ON 31
eH1_2                -6.228367e-02 1 1  ON 32
eH1_3                -2.675202e-02 1 1  ON 33
eH1_4                 1.929475e-02 1 1  ON 34
eH1_5                 3.512535e-02 1 1  ON 35
eH1_6                 7.689714e-02 1 1  ON 36
eH1_7                 1.102697e-01 1 1  ON 37
eH1_8                 9.039463e-02 1 1  ON 38
eH1_9                 2.418010e-02 1 1  ON 39
eH2_0                -1.817853e-01 1 1  ON 40
eH2_1                -1.033511e-01 1 1  ON 41
eH2_2                -6.386444e-02 1 1  ON 42
eH2_3                -2.813261e-02 1 1  ON 43
eH2_4                 1.771089e-02 1 1  ON 44
eH2_5                 3.402969e-02 1 1  ON 45
eH2_6                 7.897141e-02 1 1  ON 46
eH2_7                 1.143522e-01 1 1  ON 47
eH2_8                 9.358099e-02 1 1  ON 48
eH2_9                 2.635747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1657
    reference variance = 0.227723
====================================================
  Execution time = 1.9672e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2485e-01
  Total weights = 2.0000e+06
  Execution time = 1.8433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324653398347
                                         uncertainty =       0.012408744809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324653398347
                                         uncertainty =       0.012408744809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402977383
  error estimate for blocks of size 2^( 2) =       0.000412949980
  error estimate for blocks of size 2^( 3) =       0.000421765227
  error estimate for blocks of size 2^( 4) =       0.000429069247
  error estimate for blocks of size 2^( 5) =       0.000433129392
  error estimate for blocks of size 2^( 6) =       0.000434921027
  error estimate for blocks of size 2^( 7) =       0.000436677965

      target function =                  N/A
              le_mean =     -17.216337491666
             les_mean =     296.727058006261
             stat err =       0.000433449408
             autocorr =       1.156952381675
              std dev =       0.569896079731
             le_variance =       0.324781541692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324962648347
                                         uncertainty =       0.012415060084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324962648347
                                         uncertainty =       0.012415060084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403169250
  error estimate for blocks of size 2^( 2) =       0.000413127290
  error estimate for blocks of size 2^( 3) =       0.000421924116
  error estimate for blocks of size 2^( 4) =       0.000429215795
  error estimate for blocks of size 2^( 5) =       0.000433266693
  error estimate for blocks of size 2^( 6) =       0.000435054954
  error estimate for blocks of size 2^( 7) =       0.000436820368

      target function =                  N/A
              le_mean =     -17.216339694210
             les_mean =     296.727443192987
             stat err =       0.000433589452
             autocorr =       1.156598474456
              std dev =       0.570167421980
             le_variance =       0.325090889088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324799022719
                                         uncertainty =       0.012412439636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324799022719
                                         uncertainty =       0.012412439636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403067729
  error estimate for blocks of size 2^( 2) =       0.000413032559
  error estimate for blocks of size 2^( 3) =       0.000421837989
  error estimate for blocks of size 2^( 4) =       0.000429135638
  error estimate for blocks of size 2^( 5) =       0.000433190521
  error estimate for blocks of size 2^( 6) =       0.000434980711
  error estimate for blocks of size 2^( 7) =       0.000436743454

      target function =                  N/A
              le_mean =     -17.216338776429
             les_mean =     296.727247890474
             stat err =       0.000433512581
             autocorr =       1.156770898987
              std dev =       0.570023848763
             le_variance =       0.324927188159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324669354038
                                         uncertainty =       0.012409229494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324669354038
                                         uncertainty =       0.012409229494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402987280
  error estimate for blocks of size 2^( 2) =       0.000412958916
  error estimate for blocks of size 2^( 3) =       0.000421772925
  error estimate for blocks of size 2^( 4) =       0.000429076137
  error estimate for blocks of size 2^( 5) =       0.000433135589
  error estimate for blocks of size 2^( 6) =       0.000434927016
  error estimate for blocks of size 2^( 7) =       0.000436684805

      target function =                  N/A
              le_mean =     -17.216337632573
             les_mean =     296.727078812558
             stat err =       0.000433455887
             autocorr =       1.156930135217
              std dev =       0.569910077301
             le_variance =       0.324797496209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216337491666        initial
     3.8147e-01     3.8147e+00             2.1708e-03       -17.216339694210  <--
     1.5259e+00     1.5259e+01             5.9144e-04       -17.216338776429
     6.1035e+00     6.1035e+01             1.5157e-04       -17.216337632573

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.9073e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.050673e-01 1 1  ON 0
 uu_1                 4.457205e-02 1 1  ON 1
 uu_2                -4.691981e-02 1 1  ON 2
 uu_3                -9.936106e-02 1 1  ON 3
 uu_4                -1.306733e-01 1 1  ON 4
 uu_5                -1.358466e-01 1 1  ON 5
 uu_6                -1.124405e-01 1 1  ON 6
 uu_7                -3.852201e-02 1 1  ON 7
 uu_8                 1.008562e-01 1 1  ON 8
 uu_9                 1.209004e-01 1 1  ON 9
 ud_0                 3.426617e-01 1 1  ON 10
 ud_1                 8.811228e-02 1 1  ON 11
 ud_2                -1.495851e-02 1 1  ON 12
 ud_3                -7.160831e-02 1 1  ON 13
 ud_4                -1.181459e-01 1 1  ON 14
 ud_5                -1.511944e-01 1 1  ON 15
 ud_6                -1.550722e-01 1 1  ON 16
 ud_7                -1.104302e-01 1 1  ON 17
 ud_8                 5.547999e-03 1 1  ON 18
 ud_9                 9.268761e-02 1 1  ON 19
 eO_0                -7.379411e-01 1 1  ON 20
 eO_1                -4.291536e-01 1 1  ON 21
 eO_2                -3.992077e-02 1 1  ON 22
 eO_3                 1.992722e-01 1 1  ON 23
 eO_4                 2.838334e-01 1 1  ON 24
 eO_5                 3.053122e-01 1 1  ON 25
 eO_6                 2.498391e-01 1 1  ON 26
 eO_7                 1.117669e-01 1 1  ON 27
 eO_8                 2.796006e-02 1 1  ON 28
 eO_9                 1.843582e-02 1 1  ON 29
eH1_0                -1.807001e-01 1 1  ON 30
eH1_1                -1.021423e-01 1 1  ON 31
eH1_2                -6.237698e-02 1 1  ON 32
eH1_3                -2.679269e-02 1 1  ON 33
eH1_4                 1.934842e-02 1 1  ON 34
eH1_5                 3.538629e-02 1 1  ON 35
eH1_6                 7.692060e-02 1 1  ON 36
eH1_7                 1.102813e-01 1 1  ON 37
eH1_8                 9.054810e-02 1 1  ON 38
eH1_9                 2.423047e-02 1 1  ON 39
eH2_0                -1.821015e-01 1 1  ON 40
eH2_1                -1.035065e-01 1 1  ON 41
eH2_2                -6.384834e-02 1 1  ON 42
eH2_3                -2.802137e-02 1 1  ON 43
eH2_4                 1.789204e-02 1 1  ON 44
eH2_5                 3.404246e-02 1 1  ON 45
eH2_6                 7.893785e-02 1 1  ON 46
eH2_7                 1.142969e-01 1 1  ON 47
eH2_8                 9.372616e-02 1 1  ON 48
eH2_9                 2.641737e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5097e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1393
    reference variance = 0.292928
====================================================
  Execution time = 2.0171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1584e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315880131919
                                         uncertainty =       0.003205262920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315880131919
                                         uncertainty =       0.003205262920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397393065
  error estimate for blocks of size 2^( 2) =       0.000407080679
  error estimate for blocks of size 2^( 3) =       0.000416204095
  error estimate for blocks of size 2^( 4) =       0.000422475941
  error estimate for blocks of size 2^( 5) =       0.000426270526
  error estimate for blocks of size 2^( 6) =       0.000428391102
  error estimate for blocks of size 2^( 7) =       0.000429967880

      target function =                  N/A
              le_mean =     -17.216092163465
             les_mean =     296.709671718920
             stat err =       0.000426776362
             autocorr =       1.153347415940
              std dev =       0.561998661838
             le_variance =       0.315842495907


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721609216347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216092163465       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216089662976       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216093505855       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216096226188       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216102703240       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216108982231       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216109204774       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216109241682       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216110136120       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216109378997       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216109886937       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216110327143       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 6.039721e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216092163465       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216090849719       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216091986122       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216093184234       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216096017102       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216097281134       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216097054293       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216097203940       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216097072583       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216097169743       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 1.749299e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216092163465       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216091710202       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216091947866       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216092372615       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216093287255       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216093461876       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216093384048       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216093416585       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 4.490960e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5688e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.054091e-01 1 1  ON 0
 uu_1                 4.497653e-02 1 1  ON 1
 uu_2                -4.663109e-02 1 1  ON 2
 uu_3                -9.930865e-02 1 1  ON 3
 uu_4                -1.308552e-01 1 1  ON 4
 uu_5                -1.360989e-01 1 1  ON 5
 uu_6                -1.126990e-01 1 1  ON 6
 uu_7                -3.893173e-02 1 1  ON 7
 uu_8                 1.006740e-01 1 1  ON 8
 uu_9                 1.209991e-01 1 1  ON 9
 ud_0                 3.431154e-01 1 1  ON 10
 ud_1                 8.849824e-02 1 1  ON 11
 ud_2                -1.473691e-02 1 1  ON 12
 ud_3                -7.155514e-02 1 1  ON 13
 ud_4                -1.182151e-01 1 1  ON 14
 ud_5                -1.513229e-01 1 1  ON 15
 ud_6                -1.553576e-01 1 1  ON 16
 ud_7                -1.106622e-01 1 1  ON 17
 ud_8                 5.137023e-03 1 1  ON 18
 ud_9                 9.261793e-02 1 1  ON 19
 eO_0                -7.395823e-01 1 1  ON 20
 eO_1                -4.304178e-01 1 1  ON 21
 eO_2                -4.046409e-02 1 1  ON 22
 eO_3                 2.001593e-01 1 1  ON 23
 eO_4                 2.855827e-01 1 1  ON 24
 eO_5                 3.056675e-01 1 1  ON 25
 eO_6                 2.499833e-01 1 1  ON 26
 eO_7                 1.120402e-01 1 1  ON 27
 eO_8                 2.799189e-02 1 1  ON 28
 eO_9                 1.844031e-02 1 1  ON 29
eH1_0                -1.810669e-01 1 1  ON 30
eH1_1                -1.022031e-01 1 1  ON 31
eH1_2                -6.238649e-02 1 1  ON 32
eH1_3                -2.667891e-02 1 1  ON 33
eH1_4                 1.922418e-02 1 1  ON 34
eH1_5                 3.537694e-02 1 1  ON 35
eH1_6                 7.713406e-02 1 1  ON 36
eH1_7                 1.102868e-01 1 1  ON 37
eH1_8                 9.072827e-02 1 1  ON 38
eH1_9                 2.428022e-02 1 1  ON 39
eH2_0                -1.822446e-01 1 1  ON 40
eH2_1                -1.036333e-01 1 1  ON 41
eH2_2                -6.388771e-02 1 1  ON 42
eH2_3                -2.792519e-02 1 1  ON 43
eH2_4                 1.781055e-02 1 1  ON 44
eH2_5                 3.423592e-02 1 1  ON 45
eH2_6                 7.891475e-02 1 1  ON 46
eH2_7                 1.142297e-01 1 1  ON 47
eH2_8                 9.387909e-02 1 1  ON 48
eH2_9                 2.644910e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2397
    reference variance = 0.356854
====================================================
  Execution time = 2.2066e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2018e-01
  Total weights = 2.0000e+06
  Execution time = 1.8230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319980766703
                                         uncertainty =       0.004082598065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319980766703
                                         uncertainty =       0.004082598065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399991412
  error estimate for blocks of size 2^( 2) =       0.000409551894
  error estimate for blocks of size 2^( 3) =       0.000417925015
  error estimate for blocks of size 2^( 4) =       0.000424164360
  error estimate for blocks of size 2^( 5) =       0.000427636447
  error estimate for blocks of size 2^( 6) =       0.000430050433
  error estimate for blocks of size 2^( 7) =       0.000430289661

      target function =                  N/A
              le_mean =     -17.216582998410
             les_mean =     296.730716239725
             stat err =       0.000428035225
             autocorr =       1.145137636795
              std dev =       0.565673279011
             le_variance =       0.319986258588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320590601167
                                         uncertainty =       0.004094980323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320590601167
                                         uncertainty =       0.004094980323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400372266
  error estimate for blocks of size 2^( 2) =       0.000409904039
  error estimate for blocks of size 2^( 3) =       0.000418236080
  error estimate for blocks of size 2^( 4) =       0.000424447693
  error estimate for blocks of size 2^( 5) =       0.000427902202
  error estimate for blocks of size 2^( 6) =       0.000430301694
  error estimate for blocks of size 2^( 7) =       0.000430547851

      target function =                  N/A
              le_mean =     -17.216582056426
             les_mean =     296.731293448202
             stat err =       0.000428299860
             autocorr =       1.144373762946
              std dev =       0.566211888651
             le_variance =       0.320595902850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320365734588
                                         uncertainty =       0.004092318635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320365734588
                                         uncertainty =       0.004092318635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400231902
  error estimate for blocks of size 2^( 2) =       0.000409772547
  error estimate for blocks of size 2^( 3) =       0.000418119633
  error estimate for blocks of size 2^( 4) =       0.000424341568
  error estimate for blocks of size 2^( 5) =       0.000427803277
  error estimate for blocks of size 2^( 6) =       0.000430206608
  error estimate for blocks of size 2^( 7) =       0.000430453707

      target function =                  N/A
              le_mean =     -17.216581475957
             les_mean =     296.731048708842
             stat err =       0.000428201290
             autocorr =       1.144649539312
              std dev =       0.566013383893
             le_variance =       0.320371150746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320028857603
                                         uncertainty =       0.004084038478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320028857603
                                         uncertainty =       0.004084038478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400021466
  error estimate for blocks of size 2^( 2) =       0.000409579107
  error estimate for blocks of size 2^( 3) =       0.000417948657
  error estimate for blocks of size 2^( 4) =       0.000424185595
  error estimate for blocks of size 2^( 5) =       0.000427656152
  error estimate for blocks of size 2^( 6) =       0.000430068637
  error estimate for blocks of size 2^( 7) =       0.000430309455

      target function =                  N/A
              le_mean =     -17.216582488477
             les_mean =     296.730746768712
             stat err =       0.000428054960
             autocorr =       1.145071151775
              std dev =       0.565715782176
             le_variance =       0.320034346203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216582998410        initial  <--
     9.5367e-02     9.5367e-01             6.0397e-03       -17.216582056426
     3.8147e-01     3.8147e+00             1.7493e-03       -17.216581475957
     1.5259e+00     1.5259e+01             4.4910e-04       -17.216582488477

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4578
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.050673e-01 1 1  ON 0
 uu_1                 4.457205e-02 1 1  ON 1
 uu_2                -4.691981e-02 1 1  ON 2
 uu_3                -9.936106e-02 1 1  ON 3
 uu_4                -1.306733e-01 1 1  ON 4
 uu_5                -1.358466e-01 1 1  ON 5
 uu_6                -1.124405e-01 1 1  ON 6
 uu_7                -3.852201e-02 1 1  ON 7
 uu_8                 1.008562e-01 1 1  ON 8
 uu_9                 1.209004e-01 1 1  ON 9
 ud_0                 3.426617e-01 1 1  ON 10
 ud_1                 8.811228e-02 1 1  ON 11
 ud_2                -1.495851e-02 1 1  ON 12
 ud_3                -7.160831e-02 1 1  ON 13
 ud_4                -1.181459e-01 1 1  ON 14
 ud_5                -1.511944e-01 1 1  ON 15
 ud_6                -1.550722e-01 1 1  ON 16
 ud_7                -1.104302e-01 1 1  ON 17
 ud_8                 5.547999e-03 1 1  ON 18
 ud_9                 9.268761e-02 1 1  ON 19
 eO_0                -7.379411e-01 1 1  ON 20
 eO_1                -4.291536e-01 1 1  ON 21
 eO_2                -3.992077e-02 1 1  ON 22
 eO_3                 1.992722e-01 1 1  ON 23
 eO_4                 2.838334e-01 1 1  ON 24
 eO_5                 3.053122e-01 1 1  ON 25
 eO_6                 2.498391e-01 1 1  ON 26
 eO_7                 1.117669e-01 1 1  ON 27
 eO_8                 2.796006e-02 1 1  ON 28
 eO_9                 1.843582e-02 1 1  ON 29
eH1_0                -1.807001e-01 1 1  ON 30
eH1_1                -1.021423e-01 1 1  ON 31
eH1_2                -6.237698e-02 1 1  ON 32
eH1_3                -2.679269e-02 1 1  ON 33
eH1_4                 1.934842e-02 1 1  ON 34
eH1_5                 3.538629e-02 1 1  ON 35
eH1_6                 7.692060e-02 1 1  ON 36
eH1_7                 1.102813e-01 1 1  ON 37
eH1_8                 9.054810e-02 1 1  ON 38
eH1_9                 2.423047e-02 1 1  ON 39
eH2_0                -1.821015e-01 1 1  ON 40
eH2_1                -1.035065e-01 1 1  ON 41
eH2_2                -6.384834e-02 1 1  ON 42
eH2_3                -2.802137e-02 1 1  ON 43
eH2_4                 1.789204e-02 1 1  ON 44
eH2_5                 3.404246e-02 1 1  ON 45
eH2_6                 7.893785e-02 1 1  ON 46
eH2_7                 1.142969e-01 1 1  ON 47
eH2_8                 9.372616e-02 1 1  ON 48
eH2_9                 2.641737e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2422
    reference variance = 0.277697
====================================================
  Execution time = 2.0202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1953e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319461280957
                                         uncertainty =       0.003192333005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319461280957
                                         uncertainty =       0.003192333005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399706705
  error estimate for blocks of size 2^( 2) =       0.000409702451
  error estimate for blocks of size 2^( 3) =       0.000418500154
  error estimate for blocks of size 2^( 4) =       0.000425050810
  error estimate for blocks of size 2^( 5) =       0.000428356612
  error estimate for blocks of size 2^( 6) =       0.000428856113
  error estimate for blocks of size 2^( 7) =       0.000428557035

      target function =                  N/A
              le_mean =     -17.216575702493
             les_mean =     296.730009659622
             stat err =       0.000427705143
             autocorr =       1.145001557592
              std dev =       0.565270642892
             le_variance =       0.319530899715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657570249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216575702493       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216575727301       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216576564161       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216578129622       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216578238403       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216578123631       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216578057339       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216578214959       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 7.238108e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216575702493       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216575710310       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216575911313       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216576290603       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216576322240       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216576323871       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216576304525       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216576336067       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.845652e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216575702493       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216575704583       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216575754020       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216575847211       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216575854328       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216575857241       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216575852988       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216575860279       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 4.632261e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5749e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.051393e-01 1 1  ON 0
 uu_1                 4.460844e-02 1 1  ON 1
 uu_2                -4.691438e-02 1 1  ON 2
 uu_3                -9.937102e-02 1 1  ON 3
 uu_4                -1.307001e-01 1 1  ON 4
 uu_5                -1.358654e-01 1 1  ON 5
 uu_6                -1.124672e-01 1 1  ON 6
 uu_7                -3.855246e-02 1 1  ON 7
 uu_8                 1.008317e-01 1 1  ON 8
 uu_9                 1.209111e-01 1 1  ON 9
 ud_0                 3.426853e-01 1 1  ON 10
 ud_1                 8.814795e-02 1 1  ON 11
 ud_2                -1.491809e-02 1 1  ON 12
 ud_3                -7.161974e-02 1 1  ON 13
 ud_4                -1.181748e-01 1 1  ON 14
 ud_5                -1.511930e-01 1 1  ON 15
 ud_6                -1.550880e-01 1 1  ON 16
 ud_7                -1.104451e-01 1 1  ON 17
 ud_8                 5.508310e-03 1 1  ON 18
 ud_9                 9.268479e-02 1 1  ON 19
 eO_0                -7.381257e-01 1 1  ON 20
 eO_1                -4.292988e-01 1 1  ON 21
 eO_2                -3.994732e-02 1 1  ON 22
 eO_3                 1.993744e-01 1 1  ON 23
 eO_4                 2.839933e-01 1 1  ON 24
 eO_5                 3.053555e-01 1 1  ON 25
 eO_6                 2.498561e-01 1 1  ON 26
 eO_7                 1.117945e-01 1 1  ON 27
 eO_8                 2.796340e-02 1 1  ON 28
 eO_9                 1.843761e-02 1 1  ON 29
eH1_0                -1.807114e-01 1 1  ON 30
eH1_1                -1.021836e-01 1 1  ON 31
eH1_2                -6.238686e-02 1 1  ON 32
eH1_3                -2.678586e-02 1 1  ON 33
eH1_4                 1.932707e-02 1 1  ON 34
eH1_5                 3.542042e-02 1 1  ON 35
eH1_6                 7.693750e-02 1 1  ON 36
eH1_7                 1.102812e-01 1 1  ON 37
eH1_8                 9.056743e-02 1 1  ON 38
eH1_9                 2.423610e-02 1 1  ON 39
eH2_0                -1.821304e-01 1 1  ON 40
eH2_1                -1.035274e-01 1 1  ON 41
eH2_2                -6.383025e-02 1 1  ON 42
eH2_3                -2.799330e-02 1 1  ON 43
eH2_4                 1.789128e-02 1 1  ON 44
eH2_5                 3.403456e-02 1 1  ON 45
eH2_6                 7.892819e-02 1 1  ON 46
eH2_7                 1.142931e-01 1 1  ON 47
eH2_8                 9.374589e-02 1 1  ON 48
eH2_9                 2.642215e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2784
    reference variance = 0.17047
====================================================
  Execution time = 2.2167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3525e-01
  Total weights = 2.0000e+06
  Execution time = 1.8227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335377939267
                                         uncertainty =       0.008250410324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335377939267
                                         uncertainty =       0.008250410324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409415772
  error estimate for blocks of size 2^( 2) =       0.000418863265
  error estimate for blocks of size 2^( 3) =       0.000426871828
  error estimate for blocks of size 2^( 4) =       0.000433384607
  error estimate for blocks of size 2^( 5) =       0.000437198994
  error estimate for blocks of size 2^( 6) =       0.000439152651
  error estimate for blocks of size 2^( 7) =       0.000440139619

      target function =                  N/A
              le_mean =     -17.215366236736
             les_mean =     296.704077045727
             stat err =       0.000437468968
             autocorr =       1.141735131834
              std dev =       0.579001337129
             le_variance =       0.335242548397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335432457346
                                         uncertainty =       0.008251258547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335432457346
                                         uncertainty =       0.008251258547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409449058
  error estimate for blocks of size 2^( 2) =       0.000418893800
  error estimate for blocks of size 2^( 3) =       0.000426899048
  error estimate for blocks of size 2^( 4) =       0.000433408092
  error estimate for blocks of size 2^( 5) =       0.000437218848
  error estimate for blocks of size 2^( 6) =       0.000439169844
  error estimate for blocks of size 2^( 7) =       0.000440160122

      target function =                  N/A
              le_mean =     -17.215366015382
             les_mean =     296.704123938229
             stat err =       0.000437489226
             autocorr =       1.141655235255
              std dev =       0.579048411034
             le_variance =       0.335297062321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335394733654
                                         uncertainty =       0.008250859138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335394733654
                                         uncertainty =       0.008250859138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409426026
  error estimate for blocks of size 2^( 2) =       0.000418872451
  error estimate for blocks of size 2^( 3) =       0.000426879660
  error estimate for blocks of size 2^( 4) =       0.000433390647
  error estimate for blocks of size 2^( 5) =       0.000437202912
  error estimate for blocks of size 2^( 6) =       0.000439155442
  error estimate for blocks of size 2^( 7) =       0.000440144793

      target function =                  N/A
              le_mean =     -17.215366177724
             les_mean =     296.704091807696
             stat err =       0.000437473448
             autocorr =       1.141701327213
              std dev =       0.579015839328
             le_variance =       0.335259342193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335379552615
                                         uncertainty =       0.008250470349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335379552615
                                         uncertainty =       0.008250470349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409416757
  error estimate for blocks of size 2^( 2) =       0.000418864130
  error estimate for blocks of size 2^( 3) =       0.000426872536
  error estimate for blocks of size 2^( 4) =       0.000433385095
  error estimate for blocks of size 2^( 5) =       0.000437199203
  error estimate for blocks of size 2^( 6) =       0.000439152729
  error estimate for blocks of size 2^( 7) =       0.000440140027

      target function =                  N/A
              le_mean =     -17.215366228193
             les_mean =     296.704078364872
             stat err =       0.000437469264
             autocorr =       1.141731182923
              std dev =       0.579002730288
             le_variance =       0.335244161681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215366236736        initial  <--
     9.5367e-01     9.5367e+00             7.2381e-04       -17.215366015382
     3.8147e+00     3.8147e+01             1.8457e-04       -17.215366177724
     1.5259e+01     1.5259e+02             4.6323e-05       -17.215366228193

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5606
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.050673e-01 1 1  ON 0
 uu_1                 4.457205e-02 1 1  ON 1
 uu_2                -4.691981e-02 1 1  ON 2
 uu_3                -9.936106e-02 1 1  ON 3
 uu_4                -1.306733e-01 1 1  ON 4
 uu_5                -1.358466e-01 1 1  ON 5
 uu_6                -1.124405e-01 1 1  ON 6
 uu_7                -3.852201e-02 1 1  ON 7
 uu_8                 1.008562e-01 1 1  ON 8
 uu_9                 1.209004e-01 1 1  ON 9
 ud_0                 3.426617e-01 1 1  ON 10
 ud_1                 8.811228e-02 1 1  ON 11
 ud_2                -1.495851e-02 1 1  ON 12
 ud_3                -7.160831e-02 1 1  ON 13
 ud_4                -1.181459e-01 1 1  ON 14
 ud_5                -1.511944e-01 1 1  ON 15
 ud_6                -1.550722e-01 1 1  ON 16
 ud_7                -1.104302e-01 1 1  ON 17
 ud_8                 5.547999e-03 1 1  ON 18
 ud_9                 9.268761e-02 1 1  ON 19
 eO_0                -7.379411e-01 1 1  ON 20
 eO_1                -4.291536e-01 1 1  ON 21
 eO_2                -3.992077e-02 1 1  ON 22
 eO_3                 1.992722e-01 1 1  ON 23
 eO_4                 2.838334e-01 1 1  ON 24
 eO_5                 3.053122e-01 1 1  ON 25
 eO_6                 2.498391e-01 1 1  ON 26
 eO_7                 1.117669e-01 1 1  ON 27
 eO_8                 2.796006e-02 1 1  ON 28
 eO_9                 1.843582e-02 1 1  ON 29
eH1_0                -1.807001e-01 1 1  ON 30
eH1_1                -1.021423e-01 1 1  ON 31
eH1_2                -6.237698e-02 1 1  ON 32
eH1_3                -2.679269e-02 1 1  ON 33
eH1_4                 1.934842e-02 1 1  ON 34
eH1_5                 3.538629e-02 1 1  ON 35
eH1_6                 7.692060e-02 1 1  ON 36
eH1_7                 1.102813e-01 1 1  ON 37
eH1_8                 9.054810e-02 1 1  ON 38
eH1_9                 2.423047e-02 1 1  ON 39
eH2_0                -1.821015e-01 1 1  ON 40
eH2_1                -1.035065e-01 1 1  ON 41
eH2_2                -6.384834e-02 1 1  ON 42
eH2_3                -2.802137e-02 1 1  ON 43
eH2_4                 1.789204e-02 1 1  ON 44
eH2_5                 3.404246e-02 1 1  ON 45
eH2_6                 7.893785e-02 1 1  ON 46
eH2_7                 1.142969e-01 1 1  ON 47
eH2_8                 9.372616e-02 1 1  ON 48
eH2_9                 2.641737e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7315e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1643
    reference variance = 0.173723
====================================================
  Execution time = 2.0169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2328e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323353491329
                                         uncertainty =       0.005186946291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323353491329
                                         uncertainty =       0.005186946291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402045598
  error estimate for blocks of size 2^( 2) =       0.000412069065
  error estimate for blocks of size 2^( 3) =       0.000420975073
  error estimate for blocks of size 2^( 4) =       0.000427271593
  error estimate for blocks of size 2^( 5) =       0.000430723980
  error estimate for blocks of size 2^( 6) =       0.000432500274
  error estimate for blocks of size 2^( 7) =       0.000432855766

      target function =                  N/A
              le_mean =     -17.215726969272
             les_mean =     296.704536243885
             stat err =       0.000430837903
             autocorr =       1.148357697358
              std dev =       0.568578336724
             le_variance =       0.323281324992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721572696927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215726969272       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215727007215       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215726972980       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215727036057       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215727034197       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215727008060       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215727049825       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 7.696213e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215726969272       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215726978889       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215726970022       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215726984913       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215726984791       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215726978130       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215726988344       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.931661e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215726969272       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215726971685       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215726969448       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215726973117       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215726973105       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215726971432       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215726973970       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 4.833961e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168658 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5809e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.050704e-01 1 1  ON 0
 uu_1                 4.457809e-02 1 1  ON 1
 uu_2                -4.691891e-02 1 1  ON 2
 uu_3                -9.935961e-02 1 1  ON 3
 uu_4                -1.306752e-01 1 1  ON 4
 uu_5                -1.358509e-01 1 1  ON 5
 uu_6                -1.124439e-01 1 1  ON 6
 uu_7                -3.852626e-02 1 1  ON 7
 uu_8                 1.008537e-01 1 1  ON 8
 uu_9                 1.209024e-01 1 1  ON 9
 ud_0                 3.426683e-01 1 1  ON 10
 ud_1                 8.811377e-02 1 1  ON 11
 ud_2                -1.495696e-02 1 1  ON 12
 ud_3                -7.160949e-02 1 1  ON 13
 ud_4                -1.181491e-01 1 1  ON 14
 ud_5                -1.511967e-01 1 1  ON 15
 ud_6                -1.550730e-01 1 1  ON 16
 ud_7                -1.104314e-01 1 1  ON 17
 ud_8                 5.544652e-03 1 1  ON 18
 ud_9                 9.268778e-02 1 1  ON 19
 eO_0                -7.379604e-01 1 1  ON 20
 eO_1                -4.291675e-01 1 1  ON 21
 eO_2                -3.992584e-02 1 1  ON 22
 eO_3                 1.992840e-01 1 1  ON 23
 eO_4                 2.838516e-01 1 1  ON 24
 eO_5                 3.053145e-01 1 1  ON 25
 eO_6                 2.498406e-01 1 1  ON 26
 eO_7                 1.117699e-01 1 1  ON 27
 eO_8                 2.796061e-02 1 1  ON 28
 eO_9                 1.843624e-02 1 1  ON 29
eH1_0                -1.807021e-01 1 1  ON 30
eH1_1                -1.021412e-01 1 1  ON 31
eH1_2                -6.238054e-02 1 1  ON 32
eH1_3                -2.678983e-02 1 1  ON 33
eH1_4                 1.934539e-02 1 1  ON 34
eH1_5                 3.538648e-02 1 1  ON 35
eH1_6                 7.692246e-02 1 1  ON 36
eH1_7                 1.102814e-01 1 1  ON 37
eH1_8                 9.054987e-02 1 1  ON 38
eH1_9                 2.423095e-02 1 1  ON 39
eH2_0                -1.821020e-01 1 1  ON 40
eH2_1                -1.035081e-01 1 1  ON 41
eH2_2                -6.384780e-02 1 1  ON 42
eH2_3                -2.802284e-02 1 1  ON 43
eH2_4                 1.789167e-02 1 1  ON 44
eH2_5                 3.404491e-02 1 1  ON 45
eH2_6                 7.893737e-02 1 1  ON 46
eH2_7                 1.142956e-01 1 1  ON 47
eH2_8                 9.372735e-02 1 1  ON 48
eH2_9                 2.641816e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.25
    reference variance = 0.153202
====================================================
  Execution time = 1.9870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1352e-01
  Total weights = 2.0000e+06
  Execution time = 1.8165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313566360294
                                         uncertainty =       0.002445712747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313566360294
                                         uncertainty =       0.002445712747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395924237
  error estimate for blocks of size 2^( 2) =       0.000405999728
  error estimate for blocks of size 2^( 3) =       0.000415135104
  error estimate for blocks of size 2^( 4) =       0.000421376281
  error estimate for blocks of size 2^( 5) =       0.000424875170
  error estimate for blocks of size 2^( 6) =       0.000426409123
  error estimate for blocks of size 2^( 7) =       0.000428540791

      target function =                  N/A
              le_mean =     -17.216257093796
             les_mean =     296.713020165535
             stat err =       0.000425300341
             autocorr =       1.153897643228
              std dev =       0.559921425383
             le_variance =       0.313512002603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313587919015
                                         uncertainty =       0.002446006361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313587919015
                                         uncertainty =       0.002446006361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395937847
  error estimate for blocks of size 2^( 2) =       0.000406012655
  error estimate for blocks of size 2^( 3) =       0.000415147326
  error estimate for blocks of size 2^( 4) =       0.000421387865
  error estimate for blocks of size 2^( 5) =       0.000424886372
  error estimate for blocks of size 2^( 6) =       0.000426420153
  error estimate for blocks of size 2^( 7) =       0.000428551947

      target function =                  N/A
              le_mean =     -17.216257287781
             les_mean =     296.713048399507
             stat err =       0.000425311584
             autocorr =       1.153879319037
              std dev =       0.559940672941
             le_variance =       0.313533557214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313577386468
                                         uncertainty =       0.002445863181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313577386468
                                         uncertainty =       0.002445863181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395931198
  error estimate for blocks of size 2^( 2) =       0.000406006342
  error estimate for blocks of size 2^( 3) =       0.000415141362
  error estimate for blocks of size 2^( 4) =       0.000421382215
  error estimate for blocks of size 2^( 5) =       0.000424880913
  error estimate for blocks of size 2^( 6) =       0.000426414780
  error estimate for blocks of size 2^( 7) =       0.000428546517

      target function =                  N/A
              le_mean =     -17.216257193082
             les_mean =     296.713034608262
             stat err =       0.000425306106
             autocorr =       1.153888349556
              std dev =       0.559931269590
             le_variance =       0.313523026664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313567746376
                                         uncertainty =       0.002445731670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313567746376
                                         uncertainty =       0.002445731670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395925112
  error estimate for blocks of size 2^( 2) =       0.000406000559
  error estimate for blocks of size 2^( 3) =       0.000415135891
  error estimate for blocks of size 2^( 4) =       0.000421377028
  error estimate for blocks of size 2^( 5) =       0.000424875893
  error estimate for blocks of size 2^( 6) =       0.000426409835
  error estimate for blocks of size 2^( 7) =       0.000428541511

      target function =                  N/A
              le_mean =     -17.216257106247
             les_mean =     296.713021980057
             stat err =       0.000425301067
             autocorr =       1.153896477074
              std dev =       0.559922662890
             le_variance =       0.313513388418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216257093796        initial
     9.5367e+00     9.5367e+01             7.6962e-05       -17.216257287781  <--
     3.8147e+01     3.8147e+02             1.9317e-05       -17.216257193082
     1.5259e+02     1.5259e+03             4.8340e-06       -17.216257106247

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 2.9297e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.050798e-01 1 1  ON 0
 uu_1                 4.459582e-02 1 1  ON 1
 uu_2                -4.691599e-02 1 1  ON 2
 uu_3                -9.935542e-02 1 1  ON 3
 uu_4                -1.306809e-01 1 1  ON 4
 uu_5                -1.358634e-01 1 1  ON 5
 uu_6                -1.124541e-01 1 1  ON 6
 uu_7                -3.853898e-02 1 1  ON 7
 uu_8                 1.008462e-01 1 1  ON 8
 uu_9                 1.209083e-01 1 1  ON 9
 ud_0                 3.426876e-01 1 1  ON 10
 ud_1                 8.811855e-02 1 1  ON 11
 ud_2                -1.495240e-02 1 1  ON 12
 ud_3                -7.161287e-02 1 1  ON 13
 ud_4                -1.181585e-01 1 1  ON 14
 ud_5                -1.512034e-01 1 1  ON 15
 ud_6                -1.550753e-01 1 1  ON 16
 ud_7                -1.104352e-01 1 1  ON 17
 ud_8                 5.534643e-03 1 1  ON 18
 ud_9                 9.268826e-02 1 1  ON 19
 eO_0                -7.380181e-01 1 1  ON 20
 eO_1                -4.292091e-01 1 1  ON 21
 eO_2                -3.994100e-02 1 1  ON 22
 eO_3                 1.993192e-01 1 1  ON 23
 eO_4                 2.839062e-01 1 1  ON 24
 eO_5                 3.053216e-01 1 1  ON 25
 eO_6                 2.498453e-01 1 1  ON 26
 eO_7                 1.117790e-01 1 1  ON 27
 eO_8                 2.796223e-02 1 1  ON 28
 eO_9                 1.843749e-02 1 1  ON 29
eH1_0                -1.807079e-01 1 1  ON 30
eH1_1                -1.021379e-01 1 1  ON 31
eH1_2                -6.239091e-02 1 1  ON 32
eH1_3                -2.678150e-02 1 1  ON 33
eH1_4                 1.933638e-02 1 1  ON 34
eH1_5                 3.538703e-02 1 1  ON 35
eH1_6                 7.692804e-02 1 1  ON 36
eH1_7                 1.102819e-01 1 1  ON 37
eH1_8                 9.055516e-02 1 1  ON 38
eH1_9                 2.423240e-02 1 1  ON 39
eH2_0                -1.821032e-01 1 1  ON 40
eH2_1                -1.035128e-01 1 1  ON 41
eH2_2                -6.384633e-02 1 1  ON 42
eH2_3                -2.802704e-02 1 1  ON 43
eH2_4                 1.789051e-02 1 1  ON 44
eH2_5                 3.405223e-02 1 1  ON 45
eH2_6                 7.893594e-02 1 1  ON 46
eH2_7                 1.142915e-01 1 1  ON 47
eH2_8                 9.373092e-02 1 1  ON 48
eH2_9                 2.642053e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2831
    reference variance = 0.238283
====================================================
  Execution time = 2.0407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1670e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316602247593
                                         uncertainty =       0.002686047686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316602247593
                                         uncertainty =       0.002686047686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397932217
  error estimate for blocks of size 2^( 2) =       0.000407368201
  error estimate for blocks of size 2^( 3) =       0.000415752034
  error estimate for blocks of size 2^( 4) =       0.000422668707
  error estimate for blocks of size 2^( 5) =       0.000426671273
  error estimate for blocks of size 2^( 6) =       0.000428100124
  error estimate for blocks of size 2^( 7) =       0.000428697972

      target function =                  N/A
              le_mean =     -17.216722244341
             les_mean =     296.732224778630
             stat err =       0.000426534519
             autocorr =       1.148920994979
              std dev =       0.562761137790
             le_variance =       0.316700098207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672224434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722244341       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722329579       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216723015149       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216723416242       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216723503562       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216723653465       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216723625331       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216723607619       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 3.388638e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722244341       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722267167       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216722444451       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216722548814       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722571327       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216722606729       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216722599859       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216722595583       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 8.701883e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722244341       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722250151       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216722294871       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216722321237       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722326919       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216722335638       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216722333952       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 2.194409e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171198 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5964e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.050819e-01 1 1  ON 0
 uu_1                 4.461685e-02 1 1  ON 1
 uu_2                -4.690762e-02 1 1  ON 2
 uu_3                -9.935135e-02 1 1  ON 3
 uu_4                -1.306907e-01 1 1  ON 4
 uu_5                -1.358760e-01 1 1  ON 5
 uu_6                -1.124559e-01 1 1  ON 6
 uu_7                -3.855284e-02 1 1  ON 7
 uu_8                 1.008379e-01 1 1  ON 8
 uu_9                 1.209138e-01 1 1  ON 9
 ud_0                 3.427018e-01 1 1  ON 10
 ud_1                 8.813227e-02 1 1  ON 11
 ud_2                -1.494947e-02 1 1  ON 12
 ud_3                -7.161040e-02 1 1  ON 13
 ud_4                -1.181736e-01 1 1  ON 14
 ud_5                -1.512052e-01 1 1  ON 15
 ud_6                -1.550714e-01 1 1  ON 16
 ud_7                -1.104409e-01 1 1  ON 17
 ud_8                 5.517839e-03 1 1  ON 18
 ud_9                 9.268691e-02 1 1  ON 19
 eO_0                -7.381051e-01 1 1  ON 20
 eO_1                -4.292542e-01 1 1  ON 21
 eO_2                -3.995563e-02 1 1  ON 22
 eO_3                 1.993590e-01 1 1  ON 23
 eO_4                 2.839705e-01 1 1  ON 24
 eO_5                 3.053376e-01 1 1  ON 25
 eO_6                 2.498572e-01 1 1  ON 26
 eO_7                 1.117911e-01 1 1  ON 27
 eO_8                 2.796396e-02 1 1  ON 28
 eO_9                 1.843799e-02 1 1  ON 29
eH1_0                -1.807220e-01 1 1  ON 30
eH1_1                -1.021484e-01 1 1  ON 31
eH1_2                -6.239079e-02 1 1  ON 32
eH1_3                -2.677028e-02 1 1  ON 33
eH1_4                 1.932934e-02 1 1  ON 34
eH1_5                 3.539321e-02 1 1  ON 35
eH1_6                 7.693216e-02 1 1  ON 36
eH1_7                 1.102835e-01 1 1  ON 37
eH1_8                 9.056144e-02 1 1  ON 38
eH1_9                 2.423418e-02 1 1  ON 39
eH2_0                -1.821225e-01 1 1  ON 40
eH2_1                -1.035218e-01 1 1  ON 41
eH2_2                -6.384230e-02 1 1  ON 42
eH2_3                -2.801687e-02 1 1  ON 43
eH2_4                 1.789475e-02 1 1  ON 44
eH2_5                 3.405593e-02 1 1  ON 45
eH2_6                 7.893495e-02 1 1  ON 46
eH2_7                 1.142884e-01 1 1  ON 47
eH2_8                 9.373853e-02 1 1  ON 48
eH2_9                 2.642254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2907
    reference variance = 0.25069
====================================================
  Execution time = 2.0068e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2527e-01
  Total weights = 2.0000e+06
  Execution time = 1.8262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324930234923
                                         uncertainty =       0.004162034613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324930234923
                                         uncertainty =       0.004162034613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403273556
  error estimate for blocks of size 2^( 2) =       0.000412866974
  error estimate for blocks of size 2^( 3) =       0.000421335934
  error estimate for blocks of size 2^( 4) =       0.000427768176
  error estimate for blocks of size 2^( 5) =       0.000431969906
  error estimate for blocks of size 2^( 6) =       0.000434769488
  error estimate for blocks of size 2^( 7) =       0.000437178907

      target function =                  N/A
              le_mean =     -17.216952286733
             les_mean =     296.748705002268
             stat err =       0.000432921619
             autocorr =       1.152441951984
              std dev =       0.570314931644
             le_variance =       0.325259121256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324961398312
                                         uncertainty =       0.004162748816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324961398312
                                         uncertainty =       0.004162748816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403292851
  error estimate for blocks of size 2^( 2) =       0.000412884076
  error estimate for blocks of size 2^( 3) =       0.000421350935
  error estimate for blocks of size 2^( 4) =       0.000427782033
  error estimate for blocks of size 2^( 5) =       0.000431981883
  error estimate for blocks of size 2^( 6) =       0.000434781240
  error estimate for blocks of size 2^( 7) =       0.000437191911

      target function =                  N/A
              le_mean =     -17.216952488254
             les_mean =     296.748743067325
             stat err =       0.000432934267
             autocorr =       1.152399010012
              std dev =       0.570342219360
             le_variance =       0.325290247184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324945394981
                                         uncertainty =       0.004162391487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324945394981
                                         uncertainty =       0.004162391487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403282941
  error estimate for blocks of size 2^( 2) =       0.000412875216
  error estimate for blocks of size 2^( 3) =       0.000421343096
  error estimate for blocks of size 2^( 4) =       0.000427774757
  error estimate for blocks of size 2^( 5) =       0.000431975491
  error estimate for blocks of size 2^( 6) =       0.000434774929
  error estimate for blocks of size 2^( 7) =       0.000437185000

      target function =                  N/A
              le_mean =     -17.216952380588
             les_mean =     296.748723374472
             stat err =       0.000432927544
             autocorr =       1.152419853403
              std dev =       0.570328205236
             le_variance =       0.325274261687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324932036425
                                         uncertainty =       0.004162081534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324932036425
                                         uncertainty =       0.004162081534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403274671
  error estimate for blocks of size 2^( 2) =       0.000412867946
  error estimate for blocks of size 2^( 3) =       0.000421336768
  error estimate for blocks of size 2^( 4) =       0.000427768937
  error estimate for blocks of size 2^( 5) =       0.000431970539
  error estimate for blocks of size 2^( 6) =       0.000434770103
  error estimate for blocks of size 2^( 7) =       0.000437179599

      target function =                  N/A
              le_mean =     -17.216952299281
             les_mean =     296.748707233390
             stat err =       0.000432922294
             autocorr =       1.152439173187
              std dev =       0.570316508890
             le_variance =       0.325260920312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216952286733        initial
     2.3842e+00     2.3842e+01             3.3886e-04       -17.216952488254  <--
     9.5367e+00     9.5367e+01             8.7019e-05       -17.216952380588
     3.8147e+01     3.8147e+02             2.1944e-05       -17.216952299281

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.9451e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.050944e-01 1 1  ON 0
 uu_1                 4.467656e-02 1 1  ON 1
 uu_2                -4.688317e-02 1 1  ON 2
 uu_3                -9.934107e-02 1 1  ON 3
 uu_4                -1.307199e-01 1 1  ON 4
 uu_5                -1.359136e-01 1 1  ON 5
 uu_6                -1.124623e-01 1 1  ON 6
 uu_7                -3.859422e-02 1 1  ON 7
 uu_8                 1.008131e-01 1 1  ON 8
 uu_9                 1.209299e-01 1 1  ON 9
 ud_0                 3.427456e-01 1 1  ON 10
 ud_1                 8.817240e-02 1 1  ON 11
 ud_2                -1.493848e-02 1 1  ON 12
 ud_3                -7.160578e-02 1 1  ON 13
 ud_4                -1.182151e-01 1 1  ON 14
 ud_5                -1.512139e-01 1 1  ON 15
 ud_6                -1.550603e-01 1 1  ON 16
 ud_7                -1.104579e-01 1 1  ON 17
 ud_8                 5.467789e-03 1 1  ON 18
 ud_9                 9.268286e-02 1 1  ON 19
 eO_0                -7.383569e-01 1 1  ON 20
 eO_1                -4.293930e-01 1 1  ON 21
 eO_2                -3.999899e-02 1 1  ON 22
 eO_3                 1.994752e-01 1 1  ON 23
 eO_4                 2.841617e-01 1 1  ON 24
 eO_5                 3.053857e-01 1 1  ON 25
 eO_6                 2.498925e-01 1 1  ON 26
 eO_7                 1.118272e-01 1 1  ON 27
 eO_8                 2.796912e-02 1 1  ON 28
 eO_9                 1.843948e-02 1 1  ON 29
eH1_0                -1.807630e-01 1 1  ON 30
eH1_1                -1.021782e-01 1 1  ON 31
eH1_2                -6.239029e-02 1 1  ON 32
eH1_3                -2.673960e-02 1 1  ON 33
eH1_4                 1.930992e-02 1 1  ON 34
eH1_5                 3.541050e-02 1 1  ON 35
eH1_6                 7.694443e-02 1 1  ON 36
eH1_7                 1.102880e-01 1 1  ON 37
eH1_8                 9.058011e-02 1 1  ON 38
eH1_9                 2.423945e-02 1 1  ON 39
eH2_0                -1.821786e-01 1 1  ON 40
eH2_1                -1.035469e-01 1 1  ON 41
eH2_2                -6.383130e-02 1 1  ON 42
eH2_3                -2.798787e-02 1 1  ON 43
eH2_4                 1.790731e-02 1 1  ON 44
eH2_5                 3.406628e-02 1 1  ON 45
eH2_6                 7.893203e-02 1 1  ON 46
eH2_7                 1.142790e-01 1 1  ON 47
eH2_8                 9.376116e-02 1 1  ON 48
eH2_9                 2.642850e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.0786
    reference variance = 0.191234
====================================================
  Execution time = 2.0396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3551e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335591127257
                                         uncertainty =       0.012143941403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335591127257
                                         uncertainty =       0.012143941403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409579964
  error estimate for blocks of size 2^( 2) =       0.000419185265
  error estimate for blocks of size 2^( 3) =       0.000427760053
  error estimate for blocks of size 2^( 4) =       0.000434181682
  error estimate for blocks of size 2^( 5) =       0.000438118642
  error estimate for blocks of size 2^( 6) =       0.000440068207
  error estimate for blocks of size 2^( 7) =       0.000443081879

      target function =                  N/A
              le_mean =     -17.216731727058
             les_mean =     296.751362688161
             stat err =       0.000438862602
             autocorr =       1.148100062211
              std dev =       0.579233540494
             le_variance =       0.335511494433


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673172706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731727058       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216732686176       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216732672714       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733235679       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216734011412       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216734851498       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216734907514       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216735028653       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216735093224       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 1.131260e-03

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731727058       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216732049961       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216732030747       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216732178540       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216732377964       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216732513505       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216732528651       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216732573797       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 3.022892e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731727058       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731815444       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731810399       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216731848211       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216731897441       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216731922925       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216731926890       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 7.689247e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6040e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.051349e-01 1 1  ON 0
 uu_1                 4.473462e-02 1 1  ON 1
 uu_2                -4.686523e-02 1 1  ON 2
 uu_3                -9.933715e-02 1 1  ON 3
 uu_4                -1.307625e-01 1 1  ON 4
 uu_5                -1.359997e-01 1 1  ON 5
 uu_6                -1.124825e-01 1 1  ON 6
 uu_7                -3.862275e-02 1 1  ON 7
 uu_8                 1.007911e-01 1 1  ON 8
 uu_9                 1.209639e-01 1 1  ON 9
 ud_0                 3.427452e-01 1 1  ON 10
 ud_1                 8.824446e-02 1 1  ON 11
 ud_2                -1.497779e-02 1 1  ON 12
 ud_3                -7.161807e-02 1 1  ON 13
 ud_4                -1.182957e-01 1 1  ON 14
 ud_5                -1.512350e-01 1 1  ON 15
 ud_6                -1.550168e-01 1 1  ON 16
 ud_7                -1.104255e-01 1 1  ON 17
 ud_8                 5.433489e-03 1 1  ON 18
 ud_9                 9.269092e-02 1 1  ON 19
 eO_0                -7.386592e-01 1 1  ON 20
 eO_1                -4.295727e-01 1 1  ON 21
 eO_2                -4.006568e-02 1 1  ON 22
 eO_3                 1.996279e-01 1 1  ON 23
 eO_4                 2.843760e-01 1 1  ON 24
 eO_5                 3.054372e-01 1 1  ON 25
 eO_6                 2.499417e-01 1 1  ON 26
 eO_7                 1.118894e-01 1 1  ON 27
 eO_8                 2.797850e-02 1 1  ON 28
 eO_9                 1.844403e-02 1 1  ON 29
eH1_0                -1.807722e-01 1 1  ON 30
eH1_1                -1.022095e-01 1 1  ON 31
eH1_2                -6.241021e-02 1 1  ON 32
eH1_3                -2.676682e-02 1 1  ON 33
eH1_4                 1.931291e-02 1 1  ON 34
eH1_5                 3.541052e-02 1 1  ON 35
eH1_6                 7.697170e-02 1 1  ON 36
eH1_7                 1.102896e-01 1 1  ON 37
eH1_8                 9.061393e-02 1 1  ON 38
eH1_9                 2.425257e-02 1 1  ON 39
eH2_0                -1.821972e-01 1 1  ON 40
eH2_1                -1.035518e-01 1 1  ON 41
eH2_2                -6.385996e-02 1 1  ON 42
eH2_3                -2.800616e-02 1 1  ON 43
eH2_4                 1.785986e-02 1 1  ON 44
eH2_5                 3.410008e-02 1 1  ON 45
eH2_6                 7.896258e-02 1 1  ON 46
eH2_7                 1.142872e-01 1 1  ON 47
eH2_8                 9.379196e-02 1 1  ON 48
eH2_9                 2.644143e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2151
    reference variance = 0.173148
====================================================
  Execution time = 1.9894e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3253e-01
  Total weights = 2.0000e+06
  Execution time = 1.8166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332318912922
                                         uncertainty =       0.011850912427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332318912922
                                         uncertainty =       0.011850912427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407740624
  error estimate for blocks of size 2^( 2) =       0.000416833078
  error estimate for blocks of size 2^( 3) =       0.000425795021
  error estimate for blocks of size 2^( 4) =       0.000432196055
  error estimate for blocks of size 2^( 5) =       0.000436491544
  error estimate for blocks of size 2^( 6) =       0.000438559622
  error estimate for blocks of size 2^( 7) =       0.000438294095

      target function =                  N/A
              le_mean =     -17.216560007450
             les_mean =     296.742443157135
             stat err =       0.000436385329
             autocorr =       1.145439923489
              std dev =       0.576632320694
             le_variance =       0.332504833268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332445805292
                                         uncertainty =       0.011853754461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332445805292
                                         uncertainty =       0.011853754461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407818221
  error estimate for blocks of size 2^( 2) =       0.000416904524
  error estimate for blocks of size 2^( 3) =       0.000425858922
  error estimate for blocks of size 2^( 4) =       0.000432253688
  error estimate for blocks of size 2^( 5) =       0.000436543427
  error estimate for blocks of size 2^( 6) =       0.000438614329
  error estimate for blocks of size 2^( 7) =       0.000438349299

      target function =                  N/A
              le_mean =     -17.216560875735
             les_mean =     296.742599624602
             stat err =       0.000436440186
             autocorr =       1.145291959518
              std dev =       0.576742059366
             le_variance =       0.332631403041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332364999632
                                         uncertainty =       0.011852633184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332364999632
                                         uncertainty =       0.011852633184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407768731
  error estimate for blocks of size 2^( 2) =       0.000416858065
  error estimate for blocks of size 2^( 3) =       0.000425816143
  error estimate for blocks of size 2^( 4) =       0.000432213763
  error estimate for blocks of size 2^( 5) =       0.000436505545
  error estimate for blocks of size 2^( 6) =       0.000438576827
  error estimate for blocks of size 2^( 7) =       0.000438312120

      target function =                  N/A
              le_mean =     -17.216560580328
             les_mean =     296.742508725636
             stat err =       0.000436402064
             autocorr =       1.145369864529
              std dev =       0.576672069543
             le_variance =       0.332550675791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332321558072
                                         uncertainty =       0.011851088492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332321558072
                                         uncertainty =       0.011851088492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407742223
  error estimate for blocks of size 2^( 2) =       0.000416834323
  error estimate for blocks of size 2^( 3) =       0.000425795816
  error estimate for blocks of size 2^( 4) =       0.000432196448
  error estimate for blocks of size 2^( 5) =       0.000436491427
  error estimate for blocks of size 2^( 6) =       0.000438560073
  error estimate for blocks of size 2^( 7) =       0.000438294735

      target function =                  N/A
              le_mean =     -17.216560069274
             les_mean =     296.742447893276
             stat err =       0.000436385671
             autocorr =       1.145432735460
              std dev =       0.576634581518
             le_variance =       0.332507440603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216560007450        initial
     5.9605e-01     5.9605e+00             1.1313e-03       -17.216560875735  <--
     2.3842e+00     2.3842e+01             3.0229e-04       -17.216560580328
     9.5367e+00     9.5367e+01             7.6892e-05       -17.216560069274

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 2.9271e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.052824e-01 1 1  ON 0
 uu_1                 4.487831e-02 1 1  ON 1
 uu_2                -4.680403e-02 1 1  ON 2
 uu_3                -9.934089e-02 1 1  ON 3
 uu_4                -1.308791e-01 1 1  ON 4
 uu_5                -1.362364e-01 1 1  ON 5
 uu_6                -1.125584e-01 1 1  ON 6
 uu_7                -3.871043e-02 1 1  ON 7
 uu_8                 1.007261e-01 1 1  ON 8
 uu_9                 1.210645e-01 1 1  ON 9
 ud_0                 3.428071e-01 1 1  ON 10
 ud_1                 8.837481e-02 1 1  ON 11
 ud_2                -1.503109e-02 1 1  ON 12
 ud_3                -7.169213e-02 1 1  ON 13
 ud_4                -1.184911e-01 1 1  ON 14
 ud_5                -1.513303e-01 1 1  ON 15
 ud_6                -1.549063e-01 1 1  ON 16
 ud_7                -1.103291e-01 1 1  ON 17
 ud_8                 5.333610e-03 1 1  ON 18
 ud_9                 9.271494e-02 1 1  ON 19
 eO_0                -7.394882e-01 1 1  ON 20
 eO_1                -4.301100e-01 1 1  ON 21
 eO_2                -4.026570e-02 1 1  ON 22
 eO_3                 2.000246e-01 1 1  ON 23
 eO_4                 2.850027e-01 1 1  ON 24
 eO_5                 3.055948e-01 1 1  ON 25
 eO_6                 2.500870e-01 1 1  ON 26
 eO_7                 1.120735e-01 1 1  ON 27
 eO_8                 2.800635e-02 1 1  ON 28
 eO_9                 1.845749e-02 1 1  ON 29
eH1_0                -1.808014e-01 1 1  ON 30
eH1_1                -1.022977e-01 1 1  ON 31
eH1_2                -6.246493e-02 1 1  ON 32
eH1_3                -2.683400e-02 1 1  ON 33
eH1_4                 1.930611e-02 1 1  ON 34
eH1_5                 3.540452e-02 1 1  ON 35
eH1_6                 7.705360e-02 1 1  ON 36
eH1_7                 1.102947e-01 1 1  ON 37
eH1_8                 9.071393e-02 1 1  ON 38
eH1_9                 2.429142e-02 1 1  ON 39
eH2_0                -1.822468e-01 1 1  ON 40
eH2_1                -1.035893e-01 1 1  ON 41
eH2_2                -6.393218e-02 1 1  ON 42
eH2_3                -2.805697e-02 1 1  ON 43
eH2_4                 1.773775e-02 1 1  ON 44
eH2_5                 3.418215e-02 1 1  ON 45
eH2_6                 7.905328e-02 1 1  ON 46
eH2_7                 1.143125e-01 1 1  ON 47
eH2_8                 9.388311e-02 1 1  ON 48
eH2_9                 2.647969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.281
    reference variance = 0.357789
====================================================
  Execution time = 1.9989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2203e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862058043
                                         uncertainty =       0.003953653840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862058043
                                         uncertainty =       0.003953653840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401264308
  error estimate for blocks of size 2^( 2) =       0.000410726044
  error estimate for blocks of size 2^( 3) =       0.000419259468
  error estimate for blocks of size 2^( 4) =       0.000425316473
  error estimate for blocks of size 2^( 5) =       0.000430229178
  error estimate for blocks of size 2^( 6) =       0.000433174052
  error estimate for blocks of size 2^( 7) =       0.000435557629

      target function =                  N/A
              le_mean =     -17.215580885651
             les_mean =     296.698251159390
             stat err =       0.000431069333
             autocorr =       1.154072763418
              std dev =       0.567473426702
             le_variance =       0.322026090013


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721558088565e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215580885651       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215582448261       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215585666740       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215592120222       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215589956625       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215589565819       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215590669261       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215591321729       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215591382540       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215591669229       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215591478604       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 3.901037e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215580885651       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215581604078       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215583039267       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215585049742       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215584623657       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215583818150       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215584097843       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215584124069       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215584175198       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 1.135515e-03

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215580885651       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215581112932       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215581595292       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215582094242       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215582023039       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215581772361       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215581788086       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215581801016       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 2.976974e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5512e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.055960e-01 1 1  ON 0
 uu_1                 4.516914e-02 1 1  ON 1
 uu_2                -4.674355e-02 1 1  ON 2
 uu_3                -9.938239e-02 1 1  ON 3
 uu_4                -1.310145e-01 1 1  ON 4
 uu_5                -1.364331e-01 1 1  ON 5
 uu_6                -1.126888e-01 1 1  ON 6
 uu_7                -3.889276e-02 1 1  ON 7
 uu_8                 1.005960e-01 1 1  ON 8
 uu_9                 1.211326e-01 1 1  ON 9
 ud_0                 3.430175e-01 1 1  ON 10
 ud_1                 8.850128e-02 1 1  ON 11
 ud_2                -1.490760e-02 1 1  ON 12
 ud_3                -7.178506e-02 1 1  ON 13
 ud_4                -1.186224e-01 1 1  ON 14
 ud_5                -1.513729e-01 1 1  ON 15
 ud_6                -1.548415e-01 1 1  ON 16
 ud_7                -1.104368e-01 1 1  ON 17
 ud_8                 5.108835e-03 1 1  ON 18
 ud_9                 9.271780e-02 1 1  ON 19
 eO_0                -7.406237e-01 1 1  ON 20
 eO_1                -4.309323e-01 1 1  ON 21
 eO_2                -4.042325e-02 1 1  ON 22
 eO_3                 2.005515e-01 1 1  ON 23
 eO_4                 2.859839e-01 1 1  ON 24
 eO_5                 3.058204e-01 1 1  ON 25
 eO_6                 2.502371e-01 1 1  ON 26
 eO_7                 1.122613e-01 1 1  ON 27
 eO_8                 2.803484e-02 1 1  ON 28
 eO_9                 1.846865e-02 1 1  ON 29
eH1_0                -1.809670e-01 1 1  ON 30
eH1_1                -1.022561e-01 1 1  ON 31
eH1_2                -6.254760e-02 1 1  ON 32
eH1_3                -2.678880e-02 1 1  ON 33
eH1_4                 1.928569e-02 1 1  ON 34
eH1_5                 3.537899e-02 1 1  ON 35
eH1_6                 7.715991e-02 1 1  ON 36
eH1_7                 1.102612e-01 1 1  ON 37
eH1_8                 9.080990e-02 1 1  ON 38
eH1_9                 2.432116e-02 1 1  ON 39
eH2_0                -1.822988e-01 1 1  ON 40
eH2_1                -1.036960e-01 1 1  ON 41
eH2_2                -6.384507e-02 1 1  ON 42
eH2_3                -2.799100e-02 1 1  ON 43
eH2_4                 1.766198e-02 1 1  ON 44
eH2_5                 3.418083e-02 1 1  ON 45
eH2_6                 7.906977e-02 1 1  ON 46
eH2_7                 1.142519e-01 1 1  ON 47
eH2_8                 9.397537e-02 1 1  ON 48
eH2_9                 2.650922e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1826
    reference variance = 0.235268
====================================================
  Execution time = 1.9913e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2217e-01
  Total weights = 2.0000e+06
  Execution time = 1.8248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322109541467
                                         uncertainty =       0.006614775111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322109541467
                                         uncertainty =       0.006614775111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401241814
  error estimate for blocks of size 2^( 2) =       0.000410489419
  error estimate for blocks of size 2^( 3) =       0.000419538830
  error estimate for blocks of size 2^( 4) =       0.000425665660
  error estimate for blocks of size 2^( 5) =       0.000428564849
  error estimate for blocks of size 2^( 6) =       0.000430011093
  error estimate for blocks of size 2^( 7) =       0.000431148672

      target function =                  N/A
              le_mean =     -17.216344858371
             les_mean =     296.724520108304
             stat err =       0.000428847568
             autocorr =       1.142335130443
              std dev =       0.567441615456
             le_variance =       0.321989986952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322674814181
                                         uncertainty =       0.006636555825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322674814181
                                         uncertainty =       0.006636555825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401593721
  error estimate for blocks of size 2^( 2) =       0.000410818777
  error estimate for blocks of size 2^( 3) =       0.000419842199
  error estimate for blocks of size 2^( 4) =       0.000425950824
  error estimate for blocks of size 2^( 5) =       0.000428832891
  error estimate for blocks of size 2^( 6) =       0.000430273432
  error estimate for blocks of size 2^( 7) =       0.000431422276

      target function =                  N/A
              le_mean =     -17.216345556717
             les_mean =     296.725109200266
             stat err =       0.000429119856
             autocorr =       1.141782528450
              std dev =       0.567939286607
             le_variance =       0.322555033272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322470789596
                                         uncertainty =       0.006628790490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322470789596
                                         uncertainty =       0.006628790490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401466744
  error estimate for blocks of size 2^( 2) =       0.000410700873
  error estimate for blocks of size 2^( 3) =       0.000419734687
  error estimate for blocks of size 2^( 4) =       0.000425851889
  error estimate for blocks of size 2^( 5) =       0.000428740753
  error estimate for blocks of size 2^( 6) =       0.000430182934
  error estimate for blocks of size 2^( 7) =       0.000431328964

      target function =                  N/A
              le_mean =     -17.216344285072
             les_mean =     296.724861473261
             stat err =       0.000429026135
             autocorr =       1.142005898214
              std dev =       0.567759713540
             le_variance =       0.322351092319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322159660860
                                         uncertainty =       0.006616793778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322159660860
                                         uncertainty =       0.006616793778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401273028
  error estimate for blocks of size 2^( 2) =       0.000410518770
  error estimate for blocks of size 2^( 3) =       0.000419566027
  error estimate for blocks of size 2^( 4) =       0.000425691701
  error estimate for blocks of size 2^( 5) =       0.000428589510
  error estimate for blocks of size 2^( 6) =       0.000430035026
  error estimate for blocks of size 2^( 7) =       0.000431173749

      target function =                  N/A
              le_mean =     -17.216344542244
             les_mean =     296.724559322507
             stat err =       0.000428872496
             autocorr =       1.142290205028
              std dev =       0.567485758665
             le_variance =       0.322040086288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216344858371        initial
     1.4901e-01     1.4901e+00             3.9010e-03       -17.216345556717  <--
     5.9605e-01     5.9605e+00             1.1355e-03       -17.216344285072
     2.3842e+00     2.3842e+01             2.9770e-04       -17.216344542244

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 2.9306e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.063697e-01 1 1  ON 0
 uu_1                 4.577266e-02 1 1  ON 1
 uu_2                -4.646466e-02 1 1  ON 2
 uu_3                -9.941196e-02 1 1  ON 3
 uu_4                -1.313377e-01 1 1  ON 4
 uu_5                -1.369427e-01 1 1  ON 5
 uu_6                -1.130426e-01 1 1  ON 6
 uu_7                -3.940045e-02 1 1  ON 7
 uu_8                 1.002185e-01 1 1  ON 8
 uu_9                 1.213325e-01 1 1  ON 9
 ud_0                 3.435335e-01 1 1  ON 10
 ud_1                 8.889935e-02 1 1  ON 11
 ud_2                -1.465837e-02 1 1  ON 12
 ud_3                -7.184125e-02 1 1  ON 13
 ud_4                -1.188875e-01 1 1  ON 14
 ud_5                -1.516432e-01 1 1  ON 15
 ud_6                -1.547255e-01 1 1  ON 16
 ud_7                -1.107000e-01 1 1  ON 17
 ud_8                 4.466710e-03 1 1  ON 18
 ud_9                 9.272615e-02 1 1  ON 19
 eO_0                -7.433892e-01 1 1  ON 20
 eO_1                -4.330461e-01 1 1  ON 21
 eO_2                -4.109784e-02 1 1  ON 22
 eO_3                 2.014945e-01 1 1  ON 23
 eO_4                 2.886193e-01 1 1  ON 24
 eO_5                 3.066376e-01 1 1  ON 25
 eO_6                 2.507126e-01 1 1  ON 26
 eO_7                 1.128157e-01 1 1  ON 27
 eO_8                 2.811893e-02 1 1  ON 28
 eO_9                 1.850136e-02 1 1  ON 29
eH1_0                -1.812720e-01 1 1  ON 30
eH1_1                -1.023343e-01 1 1  ON 31
eH1_2                -6.266206e-02 1 1  ON 32
eH1_3                -2.675733e-02 1 1  ON 33
eH1_4                 1.923654e-02 1 1  ON 34
eH1_5                 3.523732e-02 1 1  ON 35
eH1_6                 7.749169e-02 1 1  ON 36
eH1_7                 1.101880e-01 1 1  ON 37
eH1_8                 9.109470e-02 1 1  ON 38
eH1_9                 2.440879e-02 1 1  ON 39
eH2_0                -1.824322e-01 1 1  ON 40
eH2_1                -1.038605e-01 1 1  ON 41
eH2_2                -6.375485e-02 1 1  ON 42
eH2_3                -2.787366e-02 1 1  ON 43
eH2_4                 1.758755e-02 1 1  ON 44
eH2_5                 3.405885e-02 1 1  ON 45
eH2_6                 7.913574e-02 1 1  ON 46
eH2_7                 1.140971e-01 1 1  ON 47
eH2_8                 9.424883e-02 1 1  ON 48
eH2_9                 2.659626e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4824e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1702
    reference variance = 0.284304
====================================================
  Execution time = 2.2252e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2417e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324216180655
                                         uncertainty =       0.004550932787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324216180655
                                         uncertainty =       0.004550932787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402595152
  error estimate for blocks of size 2^( 2) =       0.000412515436
  error estimate for blocks of size 2^( 3) =       0.000421220103
  error estimate for blocks of size 2^( 4) =       0.000427506419
  error estimate for blocks of size 2^( 5) =       0.000431353745
  error estimate for blocks of size 2^( 6) =       0.000434182616
  error estimate for blocks of size 2^( 7) =       0.000433865318

      target function =                  N/A
              le_mean =     -17.216508347033
             les_mean =     296.732325214978
             stat err =       0.000431727024
             autocorr =       1.149956431897
              std dev =       0.569355524788
             le_variance =       0.324165713607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650834703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508347033       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216511396193       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216510114135       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216507348526       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216513475434       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216525824948       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216533407865       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216534188051       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216533528022       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216531552822       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216530304690       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216531308419       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216530977264       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216531527599       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-02 is 9.596147e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508347033       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216510364229       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216509433723       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216508034893       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216510690492       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216516488855       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216517274370       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216516859178       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216516660030       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216516131575       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216515991442       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 3.016295e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508347033       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216509204040       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216508813767       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216508578096       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216509184846       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216510547073       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216510542874       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216510525712       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 8.228232e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7817e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.067683e-01 1 1  ON 0
 uu_1                 4.606305e-02 1 1  ON 1
 uu_2                -4.604083e-02 1 1  ON 2
 uu_3                -9.928143e-02 1 1  ON 3
 uu_4                -1.315587e-01 1 1  ON 4
 uu_5                -1.373857e-01 1 1  ON 5
 uu_6                -1.134511e-01 1 1  ON 6
 uu_7                -3.980730e-02 1 1  ON 7
 uu_8                 9.984579e-02 1 1  ON 8
 uu_9                 1.216356e-01 1 1  ON 9
 ud_0                 3.443212e-01 1 1  ON 10
 ud_1                 8.952174e-02 1 1  ON 11
 ud_2                -1.437008e-02 1 1  ON 12
 ud_3                -7.179513e-02 1 1  ON 13
 ud_4                -1.190894e-01 1 1  ON 14
 ud_5                -1.521438e-01 1 1  ON 15
 ud_6                -1.552871e-01 1 1  ON 16
 ud_7                -1.108410e-01 1 1  ON 17
 ud_8                 3.931745e-03 1 1  ON 18
 ud_9                 9.268923e-02 1 1  ON 19
 eO_0                -7.463640e-01 1 1  ON 20
 eO_1                -4.356898e-01 1 1  ON 21
 eO_2                -4.257477e-02 1 1  ON 22
 eO_3                 2.021848e-01 1 1  ON 23
 eO_4                 2.916356e-01 1 1  ON 24
 eO_5                 3.083247e-01 1 1  ON 25
 eO_6                 2.514482e-01 1 1  ON 26
 eO_7                 1.136415e-01 1 1  ON 27
 eO_8                 2.823175e-02 1 1  ON 28
 eO_9                 1.851477e-02 1 1  ON 29
eH1_0                -1.811893e-01 1 1  ON 30
eH1_1                -1.026836e-01 1 1  ON 31
eH1_2                -6.254415e-02 1 1  ON 32
eH1_3                -2.654453e-02 1 1  ON 33
eH1_4                 1.901840e-02 1 1  ON 34
eH1_5                 3.457367e-02 1 1  ON 35
eH1_6                 7.773475e-02 1 1  ON 36
eH1_7                 1.101339e-01 1 1  ON 37
eH1_8                 9.154823e-02 1 1  ON 38
eH1_9                 2.456121e-02 1 1  ON 39
eH2_0                -1.828799e-01 1 1  ON 40
eH2_1                -1.041668e-01 1 1  ON 41
eH2_2                -6.393940e-02 1 1  ON 42
eH2_3                -2.787838e-02 1 1  ON 43
eH2_4                 1.779664e-02 1 1  ON 44
eH2_5                 3.380263e-02 1 1  ON 45
eH2_6                 7.948019e-02 1 1  ON 46
eH2_7                 1.141854e-01 1 1  ON 47
eH2_8                 9.462941e-02 1 1  ON 48
eH2_9                 2.673031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2497
    reference variance = 0.227824
====================================================
  Execution time = 1.9783e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1523e-01
  Total weights = 2.0000e+06
  Execution time = 1.8242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315017208977
                                         uncertainty =       0.003263093582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315017208977
                                         uncertainty =       0.003263093582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396835686
  error estimate for blocks of size 2^( 2) =       0.000406502658
  error estimate for blocks of size 2^( 3) =       0.000415276871
  error estimate for blocks of size 2^( 4) =       0.000422125211
  error estimate for blocks of size 2^( 5) =       0.000426872228
  error estimate for blocks of size 2^( 6) =       0.000428181480
  error estimate for blocks of size 2^( 7) =       0.000429285738

      target function =                  N/A
              le_mean =     -17.215650742347
             les_mean =     296.693587447807
             stat err =       0.000426616164
             autocorr =       1.155721452666
              std dev =       0.561210408696
             le_variance =       0.314957122829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315728388336
                                         uncertainty =       0.003269107110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315728388336
                                         uncertainty =       0.003269107110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397283323
  error estimate for blocks of size 2^( 2) =       0.000406913236
  error estimate for blocks of size 2^( 3) =       0.000415644343
  error estimate for blocks of size 2^( 4) =       0.000422454942
  error estimate for blocks of size 2^( 5) =       0.000427184392
  error estimate for blocks of size 2^( 6) =       0.000428479043
  error estimate for blocks of size 2^( 7) =       0.000429585582

      target function =                  N/A
              le_mean =     -17.215656656113
             les_mean =     296.694502020794
             stat err =       0.000426925989
             autocorr =       1.154793997146
              std dev =       0.561843463494
             le_variance =       0.315668077471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315575546165
                                         uncertainty =       0.003269107088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315575546165
                                         uncertainty =       0.003269107088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397187233
  error estimate for blocks of size 2^( 2) =       0.000406825030
  error estimate for blocks of size 2^( 3) =       0.000415569285
  error estimate for blocks of size 2^( 4) =       0.000422387749
  error estimate for blocks of size 2^( 5) =       0.000427124542
  error estimate for blocks of size 2^( 6) =       0.000428418285
  error estimate for blocks of size 2^( 7) =       0.000429526498

      target function =                  N/A
              le_mean =     -17.215654534447
             les_mean =     296.694276288554
             stat err =       0.000426864269
             autocorr =       1.155018776621
              std dev =       0.561707572391
             le_variance =       0.315515396882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315096914829
                                         uncertainty =       0.003264102556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315096914829
                                         uncertainty =       0.003264102556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396885901
  error estimate for blocks of size 2^( 2) =       0.000406547860
  error estimate for blocks of size 2^( 3) =       0.000415317414
  error estimate for blocks of size 2^( 4) =       0.000422159804
  error estimate for blocks of size 2^( 5) =       0.000426905434
  error estimate for blocks of size 2^( 6) =       0.000428211123
  error estimate for blocks of size 2^( 7) =       0.000429316332

      target function =                  N/A
              le_mean =     -17.215650526604
             les_mean =     296.693659733254
             stat err =       0.000426648173
             autocorr =       1.155602409809
              std dev =       0.561281423719
             le_variance =       0.315036836612


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215650742347        initial
     3.7253e-02     3.7253e-01             9.5961e-03       -17.215656656113  <--
     1.4901e-01     1.4901e+00             3.0163e-03       -17.215654534447
     5.9605e-01     5.9605e+00             8.2282e-04       -17.215650526604

*****************************************************************************
Applying the update for shift_i =   3.7253e-02     and shift_s =   3.7253e-01
*****************************************************************************

  Execution time = 3.1895e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.076864e-01 1 1  ON 0
 uu_1                 4.705109e-02 1 1  ON 1
 uu_2                -4.532124e-02 1 1  ON 2
 uu_3                -9.894774e-02 1 1  ON 3
 uu_4                -1.319102e-01 1 1  ON 4
 uu_5                -1.382922e-01 1 1  ON 5
 uu_6                -1.146994e-01 1 1  ON 6
 uu_7                -4.097536e-02 1 1  ON 7
 uu_8                 9.872693e-02 1 1  ON 8
 uu_9                 1.225427e-01 1 1  ON 9
 ud_0                 3.456504e-01 1 1  ON 10
 ud_1                 9.070314e-02 1 1  ON 11
 ud_2                -1.351463e-02 1 1  ON 12
 ud_3                -7.140565e-02 1 1  ON 13
 ud_4                -1.193014e-01 1 1  ON 14
 ud_5                -1.530561e-01 1 1  ON 15
 ud_6                -1.564487e-01 1 1  ON 16
 ud_7                -1.113258e-01 1 1  ON 17
 ud_8                 2.357899e-03 1 1  ON 18
 ud_9                 9.257601e-02 1 1  ON 19
 eO_0                -7.529854e-01 1 1  ON 20
 eO_1                -4.415314e-01 1 1  ON 21
 eO_2                -4.639522e-02 1 1  ON 22
 eO_3                 2.020117e-01 1 1  ON 23
 eO_4                 2.968040e-01 1 1  ON 24
 eO_5                 3.140640e-01 1 1  ON 25
 eO_6                 2.540591e-01 1 1  ON 26
 eO_7                 1.161585e-01 1 1  ON 27
 eO_8                 2.857051e-02 1 1  ON 28
 eO_9                 1.855482e-02 1 1  ON 29
eH1_0                -1.813099e-01 1 1  ON 30
eH1_1                -1.030620e-01 1 1  ON 31
eH1_2                -6.265036e-02 1 1  ON 32
eH1_3                -2.655825e-02 1 1  ON 33
eH1_4                 1.877796e-02 1 1  ON 34
eH1_5                 3.313590e-02 1 1  ON 35
eH1_6                 7.815714e-02 1 1  ON 36
eH1_7                 1.100808e-01 1 1  ON 37
eH1_8                 9.294507e-02 1 1  ON 38
eH1_9                 2.502303e-02 1 1  ON 39
eH2_0                -1.835201e-01 1 1  ON 40
eH2_1                -1.047553e-01 1 1  ON 41
eH2_2                -6.433831e-02 1 1  ON 42
eH2_3                -2.808667e-02 1 1  ON 43
eH2_4                 1.783661e-02 1 1  ON 44
eH2_5                 3.271409e-02 1 1  ON 45
eH2_6                 8.023244e-02 1 1  ON 46
eH2_7                 1.146005e-01 1 1  ON 47
eH2_8                 9.581119e-02 1 1  ON 48
eH2_9                 2.713618e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9717e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2819
    reference variance = 0.239931
====================================================
  Execution time = 2.0187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1489e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314953819039
                                         uncertainty =       0.002505258071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314953819039
                                         uncertainty =       0.002505258071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396792786
  error estimate for blocks of size 2^( 2) =       0.000406444288
  error estimate for blocks of size 2^( 3) =       0.000414852702
  error estimate for blocks of size 2^( 4) =       0.000421772250
  error estimate for blocks of size 2^( 5) =       0.000425682497
  error estimate for blocks of size 2^( 6) =       0.000427826973
  error estimate for blocks of size 2^( 7) =       0.000430753314

      target function =                  N/A
              le_mean =     -17.215664495747
             les_mean =     296.693992903350
             stat err =       0.000426508759
             autocorr =       1.155389382539
              std dev =       0.561149739957
             le_variance =       0.314889030654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721566449575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-03, overlap shift 9.3132e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215664495747       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215666653983       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215663545098       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215671643195       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215673370557       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215675974092       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215679506188       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215676580064       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215679307429       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215675729180       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215681804405       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215679597161       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215685176822       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215684420422       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215686623779       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215686032436       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215685518209       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215685945085       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215685542455       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215686089685       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215686202009       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215686454040       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215687138380       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-03 is 2.053937e-02

solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215664495747       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215666392218       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215663728214       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215671022367       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215671308359       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215673056588       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215674043679       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215672040101       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215673186408       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215671373164       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215673305025       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215672847054       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215673460375       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215673637674       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-02 is 7.003812e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215664495747       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215665772706       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215664223052       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215667742213       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215669191281       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215668101400       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215668330460       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215667822342       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215668048648       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215667668598       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 2.171376e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5921e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.094309e-01 1 1  ON 0
 uu_1                 4.827791e-02 1 1  ON 1
 uu_2                -4.459538e-02 1 1  ON 2
 uu_3                -9.858813e-02 1 1  ON 3
 uu_4                -1.321737e-01 1 1  ON 4
 uu_5                -1.395243e-01 1 1  ON 5
 uu_6                -1.168596e-01 1 1  ON 6
 uu_7                -4.385206e-02 1 1  ON 7
 uu_8                 9.697200e-02 1 1  ON 8
 uu_9                 1.242254e-01 1 1  ON 9
 ud_0                 3.461879e-01 1 1  ON 10
 ud_1                 9.116769e-02 1 1  ON 11
 ud_2                -1.312976e-02 1 1  ON 12
 ud_3                -7.138190e-02 1 1  ON 13
 ud_4                -1.197726e-01 1 1  ON 14
 ud_5                -1.540427e-01 1 1  ON 15
 ud_6                -1.569439e-01 1 1  ON 16
 ud_7                -1.110665e-01 1 1  ON 17
 ud_8                -3.721799e-04 1 1  ON 18
 ud_9                 9.318007e-02 1 1  ON 19
 eO_0                -7.599892e-01 1 1  ON 20
 eO_1                -4.473743e-01 1 1  ON 21
 eO_2                -5.022560e-02 1 1  ON 22
 eO_3                 2.007162e-01 1 1  ON 23
 eO_4                 3.009256e-01 1 1  ON 24
 eO_5                 3.197322e-01 1 1  ON 25
 eO_6                 2.579303e-01 1 1  ON 26
 eO_7                 1.193532e-01 1 1  ON 27
 eO_8                 2.910023e-02 1 1  ON 28
 eO_9                 1.886344e-02 1 1  ON 29
eH1_0                -1.819258e-01 1 1  ON 30
eH1_1                -1.037437e-01 1 1  ON 31
eH1_2                -6.322384e-02 1 1  ON 32
eH1_3                -2.736454e-02 1 1  ON 33
eH1_4                 1.761273e-02 1 1  ON 34
eH1_5                 3.211008e-02 1 1  ON 35
eH1_6                 7.920707e-02 1 1  ON 36
eH1_7                 1.107833e-01 1 1  ON 37
eH1_8                 9.500298e-02 1 1  ON 38
eH1_9                 2.577089e-02 1 1  ON 39
eH2_0                -1.838684e-01 1 1  ON 40
eH2_1                -1.046900e-01 1 1  ON 41
eH2_2                -6.429466e-02 1 1  ON 42
eH2_3                -2.816544e-02 1 1  ON 43
eH2_4                 1.652886e-02 1 1  ON 44
eH2_5                 3.232395e-02 1 1  ON 45
eH2_6                 7.889854e-02 1 1  ON 46
eH2_7                 1.150087e-01 1 1  ON 47
eH2_8                 9.791039e-02 1 1  ON 48
eH2_9                 2.769378e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1846
    reference variance = 0.223602
====================================================
  Execution time = 1.9775e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2238e-01
  Total weights = 2.0000e+06
  Execution time = 1.9128e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321585925733
                                         uncertainty =       0.003483060596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321585925733
                                         uncertainty =       0.003483060596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401150353
  error estimate for blocks of size 2^( 2) =       0.000410635161
  error estimate for blocks of size 2^( 3) =       0.000419106163
  error estimate for blocks of size 2^( 4) =       0.000425082296
  error estimate for blocks of size 2^( 5) =       0.000429430159
  error estimate for blocks of size 2^( 6) =       0.000432748330
  error estimate for blocks of size 2^( 7) =       0.000432482985

      target function =                  N/A
              le_mean =     -17.216312384461
             les_mean =     296.723255169861
             stat err =       0.000429935942
             autocorr =       1.148664368340
              std dev =       0.567312269784
             le_variance =       0.321843211447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322775233112
                                         uncertainty =       0.003502427650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322775233112
                                         uncertainty =       0.003502427650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401891781
  error estimate for blocks of size 2^( 2) =       0.000411340414
  error estimate for blocks of size 2^( 3) =       0.000419750084
  error estimate for blocks of size 2^( 4) =       0.000425660426
  error estimate for blocks of size 2^( 5) =       0.000429965019
  error estimate for blocks of size 2^( 6) =       0.000433259969
  error estimate for blocks of size 2^( 7) =       0.000432951090

      target function =                  N/A
              le_mean =     -17.216311102404
             les_mean =     296.724401820143
             stat err =       0.000430459126
             autocorr =       1.147217043690
              std dev =       0.568360806985
             le_variance =       0.323034006917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322678310972
                                         uncertainty =       0.003500243686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322678310972
                                         uncertainty =       0.003500243686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401832163
  error estimate for blocks of size 2^( 2) =       0.000411292303
  error estimate for blocks of size 2^( 3) =       0.000419720563
  error estimate for blocks of size 2^( 4) =       0.000425648022
  error estimate for blocks of size 2^( 5) =       0.000429956968
  error estimate for blocks of size 2^( 6) =       0.000433250409
  error estimate for blocks of size 2^( 7) =       0.000432926422

      target function =                  N/A
              le_mean =     -17.216311076458
             les_mean =     296.724305094440
             stat err =       0.000430445455
             autocorr =       1.147484593158
              std dev =       0.568276494807
             le_variance =       0.322938174550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321807418703
                                         uncertainty =       0.003486320418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321807418703
                                         uncertainty =       0.003486320418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401288909
  error estimate for blocks of size 2^( 2) =       0.000410768527
  error estimate for blocks of size 2^( 3) =       0.000419231908
  error estimate for blocks of size 2^( 4) =       0.000425199185
  error estimate for blocks of size 2^( 5) =       0.000429538198
  error estimate for blocks of size 2^( 6) =       0.000432851339
  error estimate for blocks of size 2^( 7) =       0.000432569872

      target function =                  N/A
              le_mean =     -17.216309552360
             les_mean =     296.723380019015
             stat err =       0.000430039648
             autocorr =       1.148425117222
              std dev =       0.567508217888
             le_variance =       0.322065577370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216312384461        initial  <--
     9.3132e-03     9.3132e-02             2.0539e-02       -17.216311102404
     3.7253e-02     3.7253e-01             7.0038e-03       -17.216311076458
     1.4901e-01     1.4901e+00             2.1714e-03       -17.216309552360

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2577
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.076864e-01 1 1  ON 0
 uu_1                 4.705109e-02 1 1  ON 1
 uu_2                -4.532124e-02 1 1  ON 2
 uu_3                -9.894774e-02 1 1  ON 3
 uu_4                -1.319102e-01 1 1  ON 4
 uu_5                -1.382922e-01 1 1  ON 5
 uu_6                -1.146994e-01 1 1  ON 6
 uu_7                -4.097536e-02 1 1  ON 7
 uu_8                 9.872693e-02 1 1  ON 8
 uu_9                 1.225427e-01 1 1  ON 9
 ud_0                 3.456504e-01 1 1  ON 10
 ud_1                 9.070314e-02 1 1  ON 11
 ud_2                -1.351463e-02 1 1  ON 12
 ud_3                -7.140565e-02 1 1  ON 13
 ud_4                -1.193014e-01 1 1  ON 14
 ud_5                -1.530561e-01 1 1  ON 15
 ud_6                -1.564487e-01 1 1  ON 16
 ud_7                -1.113258e-01 1 1  ON 17
 ud_8                 2.357899e-03 1 1  ON 18
 ud_9                 9.257601e-02 1 1  ON 19
 eO_0                -7.529854e-01 1 1  ON 20
 eO_1                -4.415314e-01 1 1  ON 21
 eO_2                -4.639522e-02 1 1  ON 22
 eO_3                 2.020117e-01 1 1  ON 23
 eO_4                 2.968040e-01 1 1  ON 24
 eO_5                 3.140640e-01 1 1  ON 25
 eO_6                 2.540591e-01 1 1  ON 26
 eO_7                 1.161585e-01 1 1  ON 27
 eO_8                 2.857051e-02 1 1  ON 28
 eO_9                 1.855482e-02 1 1  ON 29
eH1_0                -1.813099e-01 1 1  ON 30
eH1_1                -1.030620e-01 1 1  ON 31
eH1_2                -6.265036e-02 1 1  ON 32
eH1_3                -2.655825e-02 1 1  ON 33
eH1_4                 1.877796e-02 1 1  ON 34
eH1_5                 3.313590e-02 1 1  ON 35
eH1_6                 7.815714e-02 1 1  ON 36
eH1_7                 1.100808e-01 1 1  ON 37
eH1_8                 9.294507e-02 1 1  ON 38
eH1_9                 2.502303e-02 1 1  ON 39
eH2_0                -1.835201e-01 1 1  ON 40
eH2_1                -1.047553e-01 1 1  ON 41
eH2_2                -6.433831e-02 1 1  ON 42
eH2_3                -2.808667e-02 1 1  ON 43
eH2_4                 1.783661e-02 1 1  ON 44
eH2_5                 3.271409e-02 1 1  ON 45
eH2_6                 8.023244e-02 1 1  ON 46
eH2_7                 1.146005e-01 1 1  ON 47
eH2_8                 9.581119e-02 1 1  ON 48
eH2_9                 2.713618e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5184e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.182
    reference variance = 0.255329
====================================================
  Execution time = 2.0330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1719e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316895839802
                                         uncertainty =       0.003657069222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316895839802
                                         uncertainty =       0.003657069222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398237502
  error estimate for blocks of size 2^( 2) =       0.000408115742
  error estimate for blocks of size 2^( 3) =       0.000416694672
  error estimate for blocks of size 2^( 4) =       0.000422280348
  error estimate for blocks of size 2^( 5) =       0.000425706859
  error estimate for blocks of size 2^( 6) =       0.000427189086
  error estimate for blocks of size 2^( 7) =       0.000429377710

      target function =                  N/A
              le_mean =     -17.216856230212
             les_mean =     296.737324509047
             stat err =       0.000426138501
             autocorr =       1.145030981205
              std dev =       0.563192876258
             le_variance =       0.317186215867


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685623021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856230212       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857831319       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216861275823       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216861844184       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216864701471       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216864915103       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216866104782       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216865875052       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216866452909       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216867112593       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216866865041       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216867081184       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-02 is 3.678442e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856230212       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216856959404       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216858624004       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216858637889       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216859948372       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216860122863       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216860194133       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216859957689       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216860100873       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216860157874       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 1.151004e-03

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856230212       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216856459642       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216857018149       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216856969652       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216857408452       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216857491505       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216857440866       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216857394966       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 3.233699e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195768 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5962e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.081372e-01 1 1  ON 0
 uu_1                 4.725752e-02 1 1  ON 1
 uu_2                -4.527336e-02 1 1  ON 2
 uu_3                -9.891016e-02 1 1  ON 3
 uu_4                -1.319768e-01 1 1  ON 4
 uu_5                -1.385125e-01 1 1  ON 5
 uu_6                -1.149869e-01 1 1  ON 6
 uu_7                -4.126709e-02 1 1  ON 7
 uu_8                 9.854832e-02 1 1  ON 8
 uu_9                 1.226749e-01 1 1  ON 9
 ud_0                 3.458508e-01 1 1  ON 10
 ud_1                 9.101940e-02 1 1  ON 11
 ud_2                -1.330071e-02 1 1  ON 12
 ud_3                -7.124348e-02 1 1  ON 13
 ud_4                -1.194035e-01 1 1  ON 14
 ud_5                -1.532873e-01 1 1  ON 15
 ud_6                -1.565833e-01 1 1  ON 16
 ud_7                -1.115016e-01 1 1  ON 17
 ud_8                 2.039748e-03 1 1  ON 18
 ud_9                 9.254041e-02 1 1  ON 19
 eO_0                -7.541364e-01 1 1  ON 20
 eO_1                -4.420985e-01 1 1  ON 21
 eO_2                -4.676579e-02 1 1  ON 22
 eO_3                 2.024287e-01 1 1  ON 23
 eO_4                 2.974906e-01 1 1  ON 24
 eO_5                 3.144221e-01 1 1  ON 25
 eO_6                 2.543194e-01 1 1  ON 26
 eO_7                 1.164603e-01 1 1  ON 27
 eO_8                 2.861097e-02 1 1  ON 28
 eO_9                 1.856859e-02 1 1  ON 29
eH1_0                -1.814882e-01 1 1  ON 30
eH1_1                -1.030368e-01 1 1  ON 31
eH1_2                -6.276905e-02 1 1  ON 32
eH1_3                -2.663996e-02 1 1  ON 33
eH1_4                 1.879800e-02 1 1  ON 34
eH1_5                 3.320753e-02 1 1  ON 35
eH1_6                 7.824114e-02 1 1  ON 36
eH1_7                 1.100673e-01 1 1  ON 37
eH1_8                 9.308437e-02 1 1  ON 38
eH1_9                 2.506317e-02 1 1  ON 39
eH2_0                -1.835874e-01 1 1  ON 40
eH2_1                -1.045777e-01 1 1  ON 41
eH2_2                -6.432619e-02 1 1  ON 42
eH2_3                -2.816310e-02 1 1  ON 43
eH2_4                 1.758023e-02 1 1  ON 44
eH2_5                 3.291245e-02 1 1  ON 45
eH2_6                 8.017497e-02 1 1  ON 46
eH2_7                 1.144733e-01 1 1  ON 47
eH2_8                 9.595546e-02 1 1  ON 48
eH2_9                 2.717931e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2767
    reference variance = 0.171
====================================================
  Execution time = 1.9588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1625e-01
  Total weights = 2.0000e+06
  Execution time = 1.8249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315875843568
                                         uncertainty =       0.002403097440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315875843568
                                         uncertainty =       0.002403097440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397567950
  error estimate for blocks of size 2^( 2) =       0.000407765928
  error estimate for blocks of size 2^( 3) =       0.000416731119
  error estimate for blocks of size 2^( 4) =       0.000422016387
  error estimate for blocks of size 2^( 5) =       0.000425090121
  error estimate for blocks of size 2^( 6) =       0.000427869986
  error estimate for blocks of size 2^( 7) =       0.000428464897

      target function =                  N/A
              le_mean =     -17.216568833239
             les_mean =     296.726362781428
             stat err =       0.000425860348
             autocorr =       1.147391624878
              std dev =       0.562245986946
             le_variance =       0.316120549836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316332033599
                                         uncertainty =       0.002406751053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316332033599
                                         uncertainty =       0.002406751053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397854804
  error estimate for blocks of size 2^( 2) =       0.000408042615
  error estimate for blocks of size 2^( 3) =       0.000416986290
  error estimate for blocks of size 2^( 4) =       0.000422250219
  error estimate for blocks of size 2^( 5) =       0.000425317144
  error estimate for blocks of size 2^( 6) =       0.000428090870
  error estimate for blocks of size 2^( 7) =       0.000428673951

      target function =                  N/A
              le_mean =     -17.216570986716
             les_mean =     296.726893272180
             stat err =       0.000426083046
             autocorr =       1.146936292500
              std dev =       0.562651659401
             le_variance =       0.316576889826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316135337433
                                         uncertainty =       0.002405213172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316135337433
                                         uncertainty =       0.002405213172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397731081
  error estimate for blocks of size 2^( 2) =       0.000407925257
  error estimate for blocks of size 2^( 3) =       0.000416877155
  error estimate for blocks of size 2^( 4) =       0.000422148477
  error estimate for blocks of size 2^( 5) =       0.000425218353
  error estimate for blocks of size 2^( 6) =       0.000427993745
  error estimate for blocks of size 2^( 7) =       0.000428585693

      target function =                  N/A
              le_mean =     -17.216571274631
             les_mean =     296.726706322062
             stat err =       0.000425986567
             autocorr =       1.147130289897
              std dev =       0.562476689130
             le_variance =       0.316380025814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315902700346
                                         uncertainty =       0.002403324001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315902700346
                                         uncertainty =       0.002403324001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397584830
  error estimate for blocks of size 2^( 2) =       0.000407782562
  error estimate for blocks of size 2^( 3) =       0.000416745895
  error estimate for blocks of size 2^( 4) =       0.000422029090
  error estimate for blocks of size 2^( 5) =       0.000425102418
  error estimate for blocks of size 2^( 6) =       0.000427881231
  error estimate for blocks of size 2^( 7) =       0.000428475999

      target function =                  N/A
              le_mean =     -17.216569187008
             les_mean =     296.726401807030
             stat err =       0.000425872184
             autocorr =       1.147357978171
              std dev =       0.562269858747
             le_variance =       0.316147394055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216568833239        initial
     9.3132e-02     9.3132e-01             3.6784e-03       -17.216570986716
     3.7253e-01     3.7253e+00             1.1510e-03       -17.216571274631  <--
     1.4901e+00     1.4901e+01             3.2337e-04       -17.216569187008

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 2.8986e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.081372e-01 1 1  ON 0
 uu_1                 4.725752e-02 1 1  ON 1
 uu_2                -4.527336e-02 1 1  ON 2
 uu_3                -9.891016e-02 1 1  ON 3
 uu_4                -1.319768e-01 1 1  ON 4
 uu_5                -1.385125e-01 1 1  ON 5
 uu_6                -1.149869e-01 1 1  ON 6
 uu_7                -4.126709e-02 1 1  ON 7
 uu_8                 9.854832e-02 1 1  ON 8
 uu_9                 1.226749e-01 1 1  ON 9
 ud_0                 3.458508e-01 1 1  ON 10
 ud_1                 9.101940e-02 1 1  ON 11
 ud_2                -1.330071e-02 1 1  ON 12
 ud_3                -7.124348e-02 1 1  ON 13
 ud_4                -1.194035e-01 1 1  ON 14
 ud_5                -1.532873e-01 1 1  ON 15
 ud_6                -1.565833e-01 1 1  ON 16
 ud_7                -1.115016e-01 1 1  ON 17
 ud_8                 2.039748e-03 1 1  ON 18
 ud_9                 9.254041e-02 1 1  ON 19
 eO_0                -7.541364e-01 1 1  ON 20
 eO_1                -4.420985e-01 1 1  ON 21
 eO_2                -4.676579e-02 1 1  ON 22
 eO_3                 2.024287e-01 1 1  ON 23
 eO_4                 2.974906e-01 1 1  ON 24
 eO_5                 3.144221e-01 1 1  ON 25
 eO_6                 2.543194e-01 1 1  ON 26
 eO_7                 1.164603e-01 1 1  ON 27
 eO_8                 2.861097e-02 1 1  ON 28
 eO_9                 1.856859e-02 1 1  ON 29
eH1_0                -1.814882e-01 1 1  ON 30
eH1_1                -1.030368e-01 1 1  ON 31
eH1_2                -6.276905e-02 1 1  ON 32
eH1_3                -2.663996e-02 1 1  ON 33
eH1_4                 1.879800e-02 1 1  ON 34
eH1_5                 3.320753e-02 1 1  ON 35
eH1_6                 7.824114e-02 1 1  ON 36
eH1_7                 1.100673e-01 1 1  ON 37
eH1_8                 9.308437e-02 1 1  ON 38
eH1_9                 2.506317e-02 1 1  ON 39
eH2_0                -1.835874e-01 1 1  ON 40
eH2_1                -1.045777e-01 1 1  ON 41
eH2_2                -6.432619e-02 1 1  ON 42
eH2_3                -2.816310e-02 1 1  ON 43
eH2_4                 1.758023e-02 1 1  ON 44
eH2_5                 3.291245e-02 1 1  ON 45
eH2_6                 8.017497e-02 1 1  ON 46
eH2_7                 1.144733e-01 1 1  ON 47
eH2_8                 9.595546e-02 1 1  ON 48
eH2_9                 2.717931e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4953e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2384
    reference variance = 0.245381
====================================================
  Execution time = 2.0270e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1797e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318024565296
                                         uncertainty =       0.003207464882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318024565296
                                         uncertainty =       0.003207464882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398727974
  error estimate for blocks of size 2^( 2) =       0.000408497377
  error estimate for blocks of size 2^( 3) =       0.000417195666
  error estimate for blocks of size 2^( 4) =       0.000424261822
  error estimate for blocks of size 2^( 5) =       0.000428119523
  error estimate for blocks of size 2^( 6) =       0.000431431815
  error estimate for blocks of size 2^( 7) =       0.000431886991

      target function =                  N/A
              le_mean =     -17.216006221079
             les_mean =     296.708838040085
             stat err =       0.000428925038
             autocorr =       1.157202555479
              std dev =       0.563886508834
             le_variance =       0.317967994845


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721600622108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216006221079       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216007356045       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216008919341       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216008644557       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216009522258       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216010816739       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216009888015       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216010015586       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216010549343       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216010934515       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216011059802       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216011082364       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-02 is 2.760358e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216006221079       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216006838357       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216007256482       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216007611245       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216007673069       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216008050614       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216007849852       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216007754991       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216007814089       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 7.328626e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216006221079       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216006439623       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216006496400       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216006682442       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216006706994       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216006782098       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216006767120       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216006733254       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.794592e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199495 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5800e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.085247e-01 1 1  ON 0
 uu_1                 4.718613e-02 1 1  ON 1
 uu_2                -4.531732e-02 1 1  ON 2
 uu_3                -9.897898e-02 1 1  ON 3
 uu_4                -1.321063e-01 1 1  ON 4
 uu_5                -1.386424e-01 1 1  ON 5
 uu_6                -1.147537e-01 1 1  ON 6
 uu_7                -4.147975e-02 1 1  ON 7
 uu_8                 9.833188e-02 1 1  ON 8
 uu_9                 1.227884e-01 1 1  ON 9
 ud_0                 3.461712e-01 1 1  ON 10
 ud_1                 9.107899e-02 1 1  ON 11
 ud_2                -1.322204e-02 1 1  ON 12
 ud_3                -7.127164e-02 1 1  ON 13
 ud_4                -1.195209e-01 1 1  ON 14
 ud_5                -1.536305e-01 1 1  ON 15
 ud_6                -1.563584e-01 1 1  ON 16
 ud_7                -1.114589e-01 1 1  ON 17
 ud_8                 1.731631e-03 1 1  ON 18
 ud_9                 9.248488e-02 1 1  ON 19
 eO_0                -7.548693e-01 1 1  ON 20
 eO_1                -4.427277e-01 1 1  ON 21
 eO_2                -4.722628e-02 1 1  ON 22
 eO_3                 2.023315e-01 1 1  ON 23
 eO_4                 2.978437e-01 1 1  ON 24
 eO_5                 3.151418e-01 1 1  ON 25
 eO_6                 2.548024e-01 1 1  ON 26
 eO_7                 1.167693e-01 1 1  ON 27
 eO_8                 2.864842e-02 1 1  ON 28
 eO_9                 1.857603e-02 1 1  ON 29
eH1_0                -1.817344e-01 1 1  ON 30
eH1_1                -1.030567e-01 1 1  ON 31
eH1_2                -6.280963e-02 1 1  ON 32
eH1_3                -2.666741e-02 1 1  ON 33
eH1_4                 1.880704e-02 1 1  ON 34
eH1_5                 3.311133e-02 1 1  ON 35
eH1_6                 7.824749e-02 1 1  ON 36
eH1_7                 1.101852e-01 1 1  ON 37
eH1_8                 9.331668e-02 1 1  ON 38
eH1_9                 2.511399e-02 1 1  ON 39
eH2_0                -1.837126e-01 1 1  ON 40
eH2_1                -1.046762e-01 1 1  ON 41
eH2_2                -6.443072e-02 1 1  ON 42
eH2_3                -2.830815e-02 1 1  ON 43
eH2_4                 1.778808e-02 1 1  ON 44
eH2_5                 3.284014e-02 1 1  ON 45
eH2_6                 8.017427e-02 1 1  ON 46
eH2_7                 1.145149e-01 1 1  ON 47
eH2_8                 9.617910e-02 1 1  ON 48
eH2_9                 2.724063e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2495
    reference variance = 0.239228
====================================================
  Execution time = 1.9691e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2424e-01
  Total weights = 2.0000e+06
  Execution time = 1.8242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323823370957
                                         uncertainty =       0.003889815475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323823370957
                                         uncertainty =       0.003889815475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402456852
  error estimate for blocks of size 2^( 2) =       0.000411839981
  error estimate for blocks of size 2^( 3) =       0.000420525631
  error estimate for blocks of size 2^( 4) =       0.000427495607
  error estimate for blocks of size 2^( 5) =       0.000432166326
  error estimate for blocks of size 2^( 6) =       0.000434279975
  error estimate for blocks of size 2^( 7) =       0.000436867470

      target function =                  N/A
              le_mean =     -17.216493769227
             les_mean =     296.731600579258
             stat err =       0.000432702345
             autocorr =       1.155952118012
              std dev =       0.569159938325
             le_variance =       0.323943035394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324402242975
                                         uncertainty =       0.003895743149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324402242975
                                         uncertainty =       0.003895743149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402816581
  error estimate for blocks of size 2^( 2) =       0.000412185799
  error estimate for blocks of size 2^( 3) =       0.000420853591
  error estimate for blocks of size 2^( 4) =       0.000427806811
  error estimate for blocks of size 2^( 5) =       0.000432467262
  error estimate for blocks of size 2^( 6) =       0.000434575087
  error estimate for blocks of size 2^( 7) =       0.000437156986

      target function =                  N/A
              le_mean =     -17.216489219187
             les_mean =     296.732023267738
             stat err =       0.000433001537
             autocorr =       1.155484695370
              std dev =       0.569668671788
             le_variance =       0.324522395617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324419684623
                                         uncertainty =       0.003896305624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324419684623
                                         uncertainty =       0.003896305624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402827290
  error estimate for blocks of size 2^( 2) =       0.000412197846
  error estimate for blocks of size 2^( 3) =       0.000420868827
  error estimate for blocks of size 2^( 4) =       0.000427825023
  error estimate for blocks of size 2^( 5) =       0.000432487466
  error estimate for blocks of size 2^( 6) =       0.000434593700
  error estimate for blocks of size 2^( 7) =       0.000437175371

      target function =                  N/A
              le_mean =     -17.216489862431
             les_mean =     296.732062672129
             stat err =       0.000433020390
             autocorr =       1.155523876954
              std dev =       0.569683816882
             le_variance =       0.324539651218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323939956152
                                         uncertainty =       0.003891266293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323939956152
                                         uncertainty =       0.003891266293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402529284
  error estimate for blocks of size 2^( 2) =       0.000411909992
  error estimate for blocks of size 2^( 3) =       0.000420593116
  error estimate for blocks of size 2^( 4) =       0.000427560750
  error estimate for blocks of size 2^( 5) =       0.000432229990
  error estimate for blocks of size 2^( 6) =       0.000434341970
  error estimate for blocks of size 2^( 7) =       0.000436928357

      target function =                  N/A
              le_mean =     -17.216492996997
             les_mean =     296.731690603321
             stat err =       0.000432765267
             autocorr =       1.155872238426
              std dev =       0.569262373343
             le_variance =       0.324059649704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216493769227        initial  <--
     9.3132e-02     9.3132e-01             2.7604e-03       -17.216489219187
     3.7253e-01     3.7253e+00             7.3286e-04       -17.216489862431
     1.4901e+00     1.4901e+01             1.7946e-04       -17.216492996997

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0611
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.081372e-01 1 1  ON 0
 uu_1                 4.725752e-02 1 1  ON 1
 uu_2                -4.527336e-02 1 1  ON 2
 uu_3                -9.891016e-02 1 1  ON 3
 uu_4                -1.319768e-01 1 1  ON 4
 uu_5                -1.385125e-01 1 1  ON 5
 uu_6                -1.149869e-01 1 1  ON 6
 uu_7                -4.126709e-02 1 1  ON 7
 uu_8                 9.854832e-02 1 1  ON 8
 uu_9                 1.226749e-01 1 1  ON 9
 ud_0                 3.458508e-01 1 1  ON 10
 ud_1                 9.101940e-02 1 1  ON 11
 ud_2                -1.330071e-02 1 1  ON 12
 ud_3                -7.124348e-02 1 1  ON 13
 ud_4                -1.194035e-01 1 1  ON 14
 ud_5                -1.532873e-01 1 1  ON 15
 ud_6                -1.565833e-01 1 1  ON 16
 ud_7                -1.115016e-01 1 1  ON 17
 ud_8                 2.039748e-03 1 1  ON 18
 ud_9                 9.254041e-02 1 1  ON 19
 eO_0                -7.541364e-01 1 1  ON 20
 eO_1                -4.420985e-01 1 1  ON 21
 eO_2                -4.676579e-02 1 1  ON 22
 eO_3                 2.024287e-01 1 1  ON 23
 eO_4                 2.974906e-01 1 1  ON 24
 eO_5                 3.144221e-01 1 1  ON 25
 eO_6                 2.543194e-01 1 1  ON 26
 eO_7                 1.164603e-01 1 1  ON 27
 eO_8                 2.861097e-02 1 1  ON 28
 eO_9                 1.856859e-02 1 1  ON 29
eH1_0                -1.814882e-01 1 1  ON 30
eH1_1                -1.030368e-01 1 1  ON 31
eH1_2                -6.276905e-02 1 1  ON 32
eH1_3                -2.663996e-02 1 1  ON 33
eH1_4                 1.879800e-02 1 1  ON 34
eH1_5                 3.320753e-02 1 1  ON 35
eH1_6                 7.824114e-02 1 1  ON 36
eH1_7                 1.100673e-01 1 1  ON 37
eH1_8                 9.308437e-02 1 1  ON 38
eH1_9                 2.506317e-02 1 1  ON 39
eH2_0                -1.835874e-01 1 1  ON 40
eH2_1                -1.045777e-01 1 1  ON 41
eH2_2                -6.432619e-02 1 1  ON 42
eH2_3                -2.816310e-02 1 1  ON 43
eH2_4                 1.758023e-02 1 1  ON 44
eH2_5                 3.291245e-02 1 1  ON 45
eH2_6                 8.017497e-02 1 1  ON 46
eH2_7                 1.144733e-01 1 1  ON 47
eH2_8                 9.595546e-02 1 1  ON 48
eH2_9                 2.717931e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4866e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2249
    reference variance = 0.355165
====================================================
  Execution time = 2.0153e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2441e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324429084165
                                         uncertainty =       0.003237176921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324429084165
                                         uncertainty =       0.003237176921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402746429
  error estimate for blocks of size 2^( 2) =       0.000412437455
  error estimate for blocks of size 2^( 3) =       0.000420715169
  error estimate for blocks of size 2^( 4) =       0.000427369576
  error estimate for blocks of size 2^( 5) =       0.000431202447
  error estimate for blocks of size 2^( 6) =       0.000434831645
  error estimate for blocks of size 2^( 7) =       0.000435280975

      target function =                  N/A
              le_mean =     -17.216682708480
             les_mean =     296.738572693737
             stat err =       0.000432171161
             autocorr =       1.151458179622
              std dev =       0.569569461487
             le_variance =       0.324409371459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668270848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216682708480       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216682717861       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216682508357       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216682491432       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216682665370       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216683062839       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216683268688       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 3.524133e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216682708480       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216682711156       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216682640801       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216682627818       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216682661284       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216682740953       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216682773050       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 8.938776e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216682708480       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216682709174       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216682690139       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216682686090       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216682693376       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216682711213       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216682718071       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.243831e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5702e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.081515e-01 1 1  ON 0
 uu_1                 4.727374e-02 1 1  ON 1
 uu_2                -4.525067e-02 1 1  ON 2
 uu_3                -9.890443e-02 1 1  ON 3
 uu_4                -1.319984e-01 1 1  ON 4
 uu_5                -1.385396e-01 1 1  ON 5
 uu_6                -1.150049e-01 1 1  ON 6
 uu_7                -4.128047e-02 1 1  ON 7
 uu_8                 9.853476e-02 1 1  ON 8
 uu_9                 1.226882e-01 1 1  ON 9
 ud_0                 3.458856e-01 1 1  ON 10
 ud_1                 9.100440e-02 1 1  ON 11
 ud_2                -1.329009e-02 1 1  ON 12
 ud_3                -7.123262e-02 1 1  ON 13
 ud_4                -1.194083e-01 1 1  ON 14
 ud_5                -1.532989e-01 1 1  ON 15
 ud_6                -1.565871e-01 1 1  ON 16
 ud_7                -1.115101e-01 1 1  ON 17
 ud_8                 2.011205e-03 1 1  ON 18
 ud_9                 9.253605e-02 1 1  ON 19
 eO_0                -7.542202e-01 1 1  ON 20
 eO_1                -4.421693e-01 1 1  ON 21
 eO_2                -4.683047e-02 1 1  ON 22
 eO_3                 2.024245e-01 1 1  ON 23
 eO_4                 2.975800e-01 1 1  ON 24
 eO_5                 3.144804e-01 1 1  ON 25
 eO_6                 2.543550e-01 1 1  ON 26
 eO_7                 1.164930e-01 1 1  ON 27
 eO_8                 2.861322e-02 1 1  ON 28
 eO_9                 1.857041e-02 1 1  ON 29
eH1_0                -1.814951e-01 1 1  ON 30
eH1_1                -1.030163e-01 1 1  ON 31
eH1_2                -6.279197e-02 1 1  ON 32
eH1_3                -2.664331e-02 1 1  ON 33
eH1_4                 1.878912e-02 1 1  ON 34
eH1_5                 3.321586e-02 1 1  ON 35
eH1_6                 7.823446e-02 1 1  ON 36
eH1_7                 1.100598e-01 1 1  ON 37
eH1_8                 9.310271e-02 1 1  ON 38
eH1_9                 2.507038e-02 1 1  ON 39
eH2_0                -1.835850e-01 1 1  ON 40
eH2_1                -1.046066e-01 1 1  ON 41
eH2_2                -6.434182e-02 1 1  ON 42
eH2_3                -2.816995e-02 1 1  ON 43
eH2_4                 1.757788e-02 1 1  ON 44
eH2_5                 3.292968e-02 1 1  ON 45
eH2_6                 8.018277e-02 1 1  ON 46
eH2_7                 1.144762e-01 1 1  ON 47
eH2_8                 9.597239e-02 1 1  ON 48
eH2_9                 2.718314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.155
    reference variance = 0.366673
====================================================
  Execution time = 1.9627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1649e-01
  Total weights = 2.0000e+06
  Execution time = 1.8174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316133480658
                                         uncertainty =       0.003625069014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316133480658
                                         uncertainty =       0.003625069014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397778522
  error estimate for blocks of size 2^( 2) =       0.000407235404
  error estimate for blocks of size 2^( 3) =       0.000415897745
  error estimate for blocks of size 2^( 4) =       0.000422223898
  error estimate for blocks of size 2^( 5) =       0.000426597918
  error estimate for blocks of size 2^( 6) =       0.000427601687
  error estimate for blocks of size 2^( 7) =       0.000430998374

      target function =                  N/A
              le_mean =     -17.216447326609
             les_mean =     296.722513896990
             stat err =       0.000426855469
             autocorr =       1.151540034292
              std dev =       0.562543780796
             le_variance =       0.316455505313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316216757462
                                         uncertainty =       0.003626393700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316216757462
                                         uncertainty =       0.003626393700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397830990
  error estimate for blocks of size 2^( 2) =       0.000407285526
  error estimate for blocks of size 2^( 3) =       0.000415944834
  error estimate for blocks of size 2^( 4) =       0.000422269545
  error estimate for blocks of size 2^( 5) =       0.000426641982
  error estimate for blocks of size 2^( 6) =       0.000427645426
  error estimate for blocks of size 2^( 7) =       0.000431043733

      target function =                  N/A
              le_mean =     -17.216447169917
             les_mean =     296.722591989105
             stat err =       0.000426900172
             autocorr =       1.151477453439
              std dev =       0.562617981258
             le_variance =       0.316538992835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316193934506
                                         uncertainty =       0.003625998087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316193934506
                                         uncertainty =       0.003625998087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397816594
  error estimate for blocks of size 2^( 2) =       0.000407271753
  error estimate for blocks of size 2^( 3) =       0.000415932099
  error estimate for blocks of size 2^( 4) =       0.000422257404
  error estimate for blocks of size 2^( 5) =       0.000426630243
  error estimate for blocks of size 2^( 6) =       0.000427633862
  error estimate for blocks of size 2^( 7) =       0.000431031630

      target function =                  N/A
              le_mean =     -17.216447209684
             les_mean =     296.722570450014
             stat err =       0.000426888285
             autocorr =       1.151496664145
              std dev =       0.562597622147
             le_variance =       0.316516084445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316141880489
                                         uncertainty =       0.003625197683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316141880489
                                         uncertainty =       0.003625197683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397783812
  error estimate for blocks of size 2^( 2) =       0.000407240455
  error estimate for blocks of size 2^( 3) =       0.000415902528
  error estimate for blocks of size 2^( 4) =       0.000422228571
  error estimate for blocks of size 2^( 5) =       0.000426602426
  error estimate for blocks of size 2^( 6) =       0.000427606184
  error estimate for blocks of size 2^( 7) =       0.000431003018

      target function =                  N/A
              le_mean =     -17.216447307083
             les_mean =     296.722521641185
             stat err =       0.000426860050
             autocorr =       1.151534121293
              std dev =       0.562551261534
             le_variance =       0.316463921854


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216447326609        initial  <--
     9.3132e-01     9.3132e+00             3.5241e-04       -17.216447169917
     3.7253e+00     3.7253e+01             8.9388e-05       -17.216447209684
     1.4901e+01     1.4901e+02             2.2438e-05       -17.216447307083

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9862
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.081372e-01 1 1  ON 0
 uu_1                 4.725752e-02 1 1  ON 1
 uu_2                -4.527336e-02 1 1  ON 2
 uu_3                -9.891016e-02 1 1  ON 3
 uu_4                -1.319768e-01 1 1  ON 4
 uu_5                -1.385125e-01 1 1  ON 5
 uu_6                -1.149869e-01 1 1  ON 6
 uu_7                -4.126709e-02 1 1  ON 7
 uu_8                 9.854832e-02 1 1  ON 8
 uu_9                 1.226749e-01 1 1  ON 9
 ud_0                 3.458508e-01 1 1  ON 10
 ud_1                 9.101940e-02 1 1  ON 11
 ud_2                -1.330071e-02 1 1  ON 12
 ud_3                -7.124348e-02 1 1  ON 13
 ud_4                -1.194035e-01 1 1  ON 14
 ud_5                -1.532873e-01 1 1  ON 15
 ud_6                -1.565833e-01 1 1  ON 16
 ud_7                -1.115016e-01 1 1  ON 17
 ud_8                 2.039748e-03 1 1  ON 18
 ud_9                 9.254041e-02 1 1  ON 19
 eO_0                -7.541364e-01 1 1  ON 20
 eO_1                -4.420985e-01 1 1  ON 21
 eO_2                -4.676579e-02 1 1  ON 22
 eO_3                 2.024287e-01 1 1  ON 23
 eO_4                 2.974906e-01 1 1  ON 24
 eO_5                 3.144221e-01 1 1  ON 25
 eO_6                 2.543194e-01 1 1  ON 26
 eO_7                 1.164603e-01 1 1  ON 27
 eO_8                 2.861097e-02 1 1  ON 28
 eO_9                 1.856859e-02 1 1  ON 29
eH1_0                -1.814882e-01 1 1  ON 30
eH1_1                -1.030368e-01 1 1  ON 31
eH1_2                -6.276905e-02 1 1  ON 32
eH1_3                -2.663996e-02 1 1  ON 33
eH1_4                 1.879800e-02 1 1  ON 34
eH1_5                 3.320753e-02 1 1  ON 35
eH1_6                 7.824114e-02 1 1  ON 36
eH1_7                 1.100673e-01 1 1  ON 37
eH1_8                 9.308437e-02 1 1  ON 38
eH1_9                 2.506317e-02 1 1  ON 39
eH2_0                -1.835874e-01 1 1  ON 40
eH2_1                -1.045777e-01 1 1  ON 41
eH2_2                -6.432619e-02 1 1  ON 42
eH2_3                -2.816310e-02 1 1  ON 43
eH2_4                 1.758023e-02 1 1  ON 44
eH2_5                 3.291245e-02 1 1  ON 45
eH2_6                 8.017497e-02 1 1  ON 46
eH2_7                 1.144733e-01 1 1  ON 47
eH2_8                 9.595546e-02 1 1  ON 48
eH2_9                 2.717931e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1417
    reference variance = 0.136447
====================================================
  Execution time = 2.0548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2978e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329667893308
                                         uncertainty =       0.007453667470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329667893308
                                         uncertainty =       0.007453667470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406066939
  error estimate for blocks of size 2^( 2) =       0.000415319315
  error estimate for blocks of size 2^( 3) =       0.000423734753
  error estimate for blocks of size 2^( 4) =       0.000429148557
  error estimate for blocks of size 2^( 5) =       0.000432375489
  error estimate for blocks of size 2^( 6) =       0.000432883743
  error estimate for blocks of size 2^( 7) =       0.000432273056

      target function =                  N/A
              le_mean =     -17.216680766150
             les_mean =     296.743877156634
             stat err =       0.000431670211
             autocorr =       1.130079238253
              std dev =       0.574265372449
             le_variance =       0.329780717994


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668076615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216680766150       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216680765667       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216680823867       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216680870998       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216680891885       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216680878789       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216680904378       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.913805e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216680766150       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216680766027       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216680780858       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216680792905       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216680798358       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216680794948       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216680801226       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 7.308713e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216680766150       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216680766119       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216680769845       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216680772875       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216680774253       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216680773392       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216680774953       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.828701e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6123e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.081414e-01 1 1  ON 0
 uu_1                 4.725978e-02 1 1  ON 1
 uu_2                -4.527302e-02 1 1  ON 2
 uu_3                -9.891142e-02 1 1  ON 3
 uu_4                -1.319770e-01 1 1  ON 4
 uu_5                -1.385159e-01 1 1  ON 5
 uu_6                -1.149892e-01 1 1  ON 6
 uu_7                -4.126901e-02 1 1  ON 7
 uu_8                 9.854643e-02 1 1  ON 8
 uu_9                 1.226767e-01 1 1  ON 9
 ud_0                 3.458517e-01 1 1  ON 10
 ud_1                 9.101749e-02 1 1  ON 11
 ud_2                -1.329901e-02 1 1  ON 12
 ud_3                -7.124499e-02 1 1  ON 13
 ud_4                -1.194039e-01 1 1  ON 14
 ud_5                -1.532881e-01 1 1  ON 15
 ud_6                -1.565811e-01 1 1  ON 16
 ud_7                -1.115019e-01 1 1  ON 17
 ud_8                 2.037585e-03 1 1  ON 18
 ud_9                 9.254087e-02 1 1  ON 19
 eO_0                -7.541437e-01 1 1  ON 20
 eO_1                -4.421041e-01 1 1  ON 21
 eO_2                -4.677042e-02 1 1  ON 22
 eO_3                 2.024271e-01 1 1  ON 23
 eO_4                 2.974976e-01 1 1  ON 24
 eO_5                 3.144255e-01 1 1  ON 25
 eO_6                 2.543231e-01 1 1  ON 26
 eO_7                 1.164641e-01 1 1  ON 27
 eO_8                 2.861171e-02 1 1  ON 28
 eO_9                 1.856892e-02 1 1  ON 29
eH1_0                -1.814893e-01 1 1  ON 30
eH1_1                -1.030381e-01 1 1  ON 31
eH1_2                -6.277041e-02 1 1  ON 32
eH1_3                -2.663769e-02 1 1  ON 33
eH1_4                 1.879779e-02 1 1  ON 34
eH1_5                 3.320600e-02 1 1  ON 35
eH1_6                 7.824095e-02 1 1  ON 36
eH1_7                 1.100677e-01 1 1  ON 37
eH1_8                 9.308635e-02 1 1  ON 38
eH1_9                 2.506385e-02 1 1  ON 39
eH2_0                -1.835873e-01 1 1  ON 40
eH2_1                -1.045809e-01 1 1  ON 41
eH2_2                -6.432707e-02 1 1  ON 42
eH2_3                -2.816168e-02 1 1  ON 43
eH2_4                 1.757888e-02 1 1  ON 44
eH2_5                 3.291229e-02 1 1  ON 45
eH2_6                 8.017455e-02 1 1  ON 46
eH2_7                 1.144739e-01 1 1  ON 47
eH2_8                 9.595815e-02 1 1  ON 48
eH2_9                 2.718009e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2691
    reference variance = 0.339442
====================================================
  Execution time = 2.1875e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2580e-01
  Total weights = 2.0000e+06
  Execution time = 1.8196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325803359835
                                         uncertainty =       0.010295210114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325803359835
                                         uncertainty =       0.010295210114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403608962
  error estimate for blocks of size 2^( 2) =       0.000413158850
  error estimate for blocks of size 2^( 3) =       0.000422290682
  error estimate for blocks of size 2^( 4) =       0.000428088445
  error estimate for blocks of size 2^( 5) =       0.000431230565
  error estimate for blocks of size 2^( 6) =       0.000434692232
  error estimate for blocks of size 2^( 7) =       0.000434538262

      target function =                  N/A
              le_mean =     -17.216929465818
             les_mean =     296.748460456474
             stat err =       0.000432137376
             autocorr =       1.146362733005
              std dev =       0.570789267966
             le_variance =       0.325800388426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325811378617
                                         uncertainty =       0.010296205816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325811378617
                                         uncertainty =       0.010296205816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403613929
  error estimate for blocks of size 2^( 2) =       0.000413163683
  error estimate for blocks of size 2^( 3) =       0.000422295320
  error estimate for blocks of size 2^( 4) =       0.000428092853
  error estimate for blocks of size 2^( 5) =       0.000431234909
  error estimate for blocks of size 2^( 6) =       0.000434696409
  error estimate for blocks of size 2^( 7) =       0.000434542502

      target function =                  N/A
              le_mean =     -17.216929503907
             les_mean =     296.748469786365
             stat err =       0.000432141668
             autocorr =       1.146357291951
              std dev =       0.570796291818
             le_variance =       0.325808406754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325807499914
                                         uncertainty =       0.010295736359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325807499914
                                         uncertainty =       0.010295736359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403611526
  error estimate for blocks of size 2^( 2) =       0.000413161347
  error estimate for blocks of size 2^( 3) =       0.000422293079
  error estimate for blocks of size 2^( 4) =       0.000428090723
  error estimate for blocks of size 2^( 5) =       0.000431232810
  error estimate for blocks of size 2^( 6) =       0.000434694392
  error estimate for blocks of size 2^( 7) =       0.000434540455

      target function =                  N/A
              le_mean =     -17.216929483902
             les_mean =     296.748465218973
             stat err =       0.000432139595
             autocorr =       1.146359939813
              std dev =       0.570792894323
             le_variance =       0.325804528210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325803881419
                                         uncertainty =       0.010295276841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325803881419
                                         uncertainty =       0.010295276841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403609285
  error estimate for blocks of size 2^( 2) =       0.000413159165
  error estimate for blocks of size 2^( 3) =       0.000422290984
  error estimate for blocks of size 2^( 4) =       0.000428088732
  error estimate for blocks of size 2^( 5) =       0.000431230848
  error estimate for blocks of size 2^( 6) =       0.000434692504
  error estimate for blocks of size 2^( 7) =       0.000434538539

      target function =                  N/A
              le_mean =     -17.216929468024
             les_mean =     296.748461053992
             stat err =       0.000432137656
             autocorr =       1.146362381427
              std dev =       0.570789724829
             le_variance =       0.325800909970


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216929465818        initial
     9.3132e+00     9.3132e+01             2.9138e-05       -17.216929503907  <--
     3.7253e+01     3.7253e+02             7.3087e-06       -17.216929483902
     1.4901e+02     1.4901e+03             1.8287e-06       -17.216929468024

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 3.1214e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.081539e-01 1 1  ON 0
 uu_1                 4.726639e-02 1 1  ON 1
 uu_2                -4.527194e-02 1 1  ON 2
 uu_3                -9.891508e-02 1 1  ON 3
 uu_4                -1.319777e-01 1 1  ON 4
 uu_5                -1.385260e-01 1 1  ON 5
 uu_6                -1.149961e-01 1 1  ON 6
 uu_7                -4.127476e-02 1 1  ON 7
 uu_8                 9.854080e-02 1 1  ON 8
 uu_9                 1.226821e-01 1 1  ON 9
 ud_0                 3.458540e-01 1 1  ON 10
 ud_1                 9.101218e-02 1 1  ON 11
 ud_2                -1.329430e-02 1 1  ON 12
 ud_3                -7.124924e-02 1 1  ON 13
 ud_4                -1.194051e-01 1 1  ON 14
 ud_5                -1.532906e-01 1 1  ON 15
 ud_6                -1.565746e-01 1 1  ON 16
 ud_7                -1.115028e-01 1 1  ON 17
 ud_8                 2.031112e-03 1 1  ON 18
 ud_9                 9.254227e-02 1 1  ON 19
 eO_0                -7.541655e-01 1 1  ON 20
 eO_1                -4.421210e-01 1 1  ON 21
 eO_2                -4.678424e-02 1 1  ON 22
 eO_3                 2.024222e-01 1 1  ON 23
 eO_4                 2.975185e-01 1 1  ON 24
 eO_5                 3.144360e-01 1 1  ON 25
 eO_6                 2.543341e-01 1 1  ON 26
 eO_7                 1.164753e-01 1 1  ON 27
 eO_8                 2.861391e-02 1 1  ON 28
 eO_9                 1.856991e-02 1 1  ON 29
eH1_0                -1.814927e-01 1 1  ON 30
eH1_1                -1.030419e-01 1 1  ON 31
eH1_2                -6.277435e-02 1 1  ON 32
eH1_3                -2.663108e-02 1 1  ON 33
eH1_4                 1.879726e-02 1 1  ON 34
eH1_5                 3.320141e-02 1 1  ON 35
eH1_6                 7.824036e-02 1 1  ON 36
eH1_7                 1.100689e-01 1 1  ON 37
eH1_8                 9.309225e-02 1 1  ON 38
eH1_9                 2.506587e-02 1 1  ON 39
eH2_0                -1.835869e-01 1 1  ON 40
eH2_1                -1.045903e-01 1 1  ON 41
eH2_2                -6.432969e-02 1 1  ON 42
eH2_3                -2.815758e-02 1 1  ON 43
eH2_4                 1.757495e-02 1 1  ON 44
eH2_5                 3.291178e-02 1 1  ON 45
eH2_6                 8.017330e-02 1 1  ON 46
eH2_7                 1.144760e-01 1 1  ON 47
eH2_8                 9.596622e-02 1 1  ON 48
eH2_9                 2.718244e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2503
    reference variance = 0.255457
====================================================
  Execution time = 2.1413e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4243e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342341621474
                                         uncertainty =       0.019487918523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342341621474
                                         uncertainty =       0.019487918523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413780876
  error estimate for blocks of size 2^( 2) =       0.000422902642
  error estimate for blocks of size 2^( 3) =       0.000431065507
  error estimate for blocks of size 2^( 4) =       0.000437280502
  error estimate for blocks of size 2^( 5) =       0.000440437606
  error estimate for blocks of size 2^( 6) =       0.000444228990
  error estimate for blocks of size 2^( 7) =       0.000445237321

      target function =                  N/A
              le_mean =     -17.216920207455
             les_mean =     296.764770485849
             stat err =       0.000441796105
             autocorr =       1.139994968816
              std dev =       0.585174527128
             le_variance =       0.342429227199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692020745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216920207455       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216920520559       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216920629037       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216920456239       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216920649103       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216920636077       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216920626388       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216920615196       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.447287e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216920207455       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216920290337       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216920323812       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216920283804       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216920342708       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216920331462       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216920326518       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216920323887       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 3.644793e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216920207455       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216920228485       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216920237322       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216920227589       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216920243212       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216920239820       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216920238361       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 8.928580e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7279e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.081827e-01 1 1  ON 0
 uu_1                 4.726297e-02 1 1  ON 1
 uu_2                -4.526911e-02 1 1  ON 2
 uu_3                -9.891404e-02 1 1  ON 3
 uu_4                -1.319814e-01 1 1  ON 4
 uu_5                -1.385214e-01 1 1  ON 5
 uu_6                -1.150112e-01 1 1  ON 6
 uu_7                -4.129208e-02 1 1  ON 7
 uu_8                 9.853406e-02 1 1  ON 8
 uu_9                 1.226867e-01 1 1  ON 9
 ud_0                 3.458572e-01 1 1  ON 10
 ud_1                 9.101831e-02 1 1  ON 11
 ud_2                -1.327815e-02 1 1  ON 12
 ud_3                -7.124649e-02 1 1  ON 13
 ud_4                -1.194072e-01 1 1  ON 14
 ud_5                -1.532953e-01 1 1  ON 15
 ud_6                -1.565832e-01 1 1  ON 16
 ud_7                -1.115093e-01 1 1  ON 17
 ud_8                 2.018551e-03 1 1  ON 18
 ud_9                 9.254334e-02 1 1  ON 19
 eO_0                -7.542020e-01 1 1  ON 20
 eO_1                -4.421451e-01 1 1  ON 21
 eO_2                -4.680441e-02 1 1  ON 22
 eO_3                 2.024286e-01 1 1  ON 23
 eO_4                 2.975425e-01 1 1  ON 24
 eO_5                 3.144594e-01 1 1  ON 25
 eO_6                 2.543451e-01 1 1  ON 26
 eO_7                 1.164888e-01 1 1  ON 27
 eO_8                 2.861597e-02 1 1  ON 28
 eO_9                 1.857000e-02 1 1  ON 29
eH1_0                -1.814974e-01 1 1  ON 30
eH1_1                -1.030466e-01 1 1  ON 31
eH1_2                -6.277540e-02 1 1  ON 32
eH1_3                -2.662574e-02 1 1  ON 33
eH1_4                 1.878444e-02 1 1  ON 34
eH1_5                 3.320401e-02 1 1  ON 35
eH1_6                 7.824663e-02 1 1  ON 36
eH1_7                 1.100703e-01 1 1  ON 37
eH1_8                 9.309785e-02 1 1  ON 38
eH1_9                 2.506739e-02 1 1  ON 39
eH2_0                -1.835805e-01 1 1  ON 40
eH2_1                -1.045796e-01 1 1  ON 41
eH2_2                -6.433283e-02 1 1  ON 42
eH2_3                -2.816973e-02 1 1  ON 43
eH2_4                 1.756922e-02 1 1  ON 44
eH2_5                 3.290514e-02 1 1  ON 45
eH2_6                 8.017312e-02 1 1  ON 46
eH2_7                 1.144770e-01 1 1  ON 47
eH2_8                 9.597338e-02 1 1  ON 48
eH2_9                 2.718468e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.323
    reference variance = 0.650946
====================================================
  Execution time = 1.9801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1158e-01
  Total weights = 2.0000e+06
  Execution time = 1.8243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311467925019
                                         uncertainty =       0.002167452140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311467925019
                                         uncertainty =       0.002167452140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394701147
  error estimate for blocks of size 2^( 2) =       0.000404439456
  error estimate for blocks of size 2^( 3) =       0.000413482805
  error estimate for blocks of size 2^( 4) =       0.000419968736
  error estimate for blocks of size 2^( 5) =       0.000424138312
  error estimate for blocks of size 2^( 6) =       0.000426135613
  error estimate for blocks of size 2^( 7) =       0.000426053762

      target function =                  N/A
              le_mean =     -17.215776749195
             les_mean =     296.694546913690
             stat err =       0.000424074106
             autocorr =       1.154374520580
              std dev =       0.558191715581
             le_variance =       0.311577991343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311468383489
                                         uncertainty =       0.002167497864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311468383489
                                         uncertainty =       0.002167497864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394701435
  error estimate for blocks of size 2^( 2) =       0.000404440579
  error estimate for blocks of size 2^( 3) =       0.000413484300
  error estimate for blocks of size 2^( 4) =       0.000419970143
  error estimate for blocks of size 2^( 5) =       0.000424139178
  error estimate for blocks of size 2^( 6) =       0.000426137954
  error estimate for blocks of size 2^( 7) =       0.000426054194

      target function =                  N/A
              le_mean =     -17.215776553289
             les_mean =     296.694540622287
             stat err =       0.000424075367
             autocorr =       1.154379706535
              std dev =       0.558192122228
             le_variance =       0.311578445318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311466360941
                                         uncertainty =       0.002167463042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311466360941
                                         uncertainty =       0.002167463042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394700154
  error estimate for blocks of size 2^( 2) =       0.000404438989
  error estimate for blocks of size 2^( 3) =       0.000413482608
  error estimate for blocks of size 2^( 4) =       0.000419968530
  error estimate for blocks of size 2^( 5) =       0.000424137803
  error estimate for blocks of size 2^( 6) =       0.000426135918
  error estimate for blocks of size 2^( 7) =       0.000426052953

      target function =                  N/A
              le_mean =     -17.215776639151
             les_mean =     296.694541556504
             stat err =       0.000424073801
             autocorr =       1.154378671426
              std dev =       0.558190310890
             le_variance =       0.311576423171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311467479694
                                         uncertainty =       0.002167451054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311467479694
                                         uncertainty =       0.002167451054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394700865
  error estimate for blocks of size 2^( 2) =       0.000404439252
  error estimate for blocks of size 2^( 3) =       0.000413482643
  error estimate for blocks of size 2^( 4) =       0.000419968575
  error estimate for blocks of size 2^( 5) =       0.000424138107
  error estimate for blocks of size 2^( 6) =       0.000426135516
  error estimate for blocks of size 2^( 7) =       0.000426053513

      target function =                  N/A
              le_mean =     -17.215776732455
             les_mean =     296.694545891236
             stat err =       0.000424073928
             autocorr =       1.154375203606
              std dev =       0.558191316031
             le_variance =       0.311577545292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215776749195        initial  <--
     2.3283e+00     2.3283e+01             1.4473e-04       -17.215776553289
     9.3132e+00     9.3132e+01             3.6448e-05       -17.215776639151
     3.7253e+01     3.7253e+02             8.9286e-06       -17.215776732455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2186
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.081539e-01 1 1  ON 0
 uu_1                 4.726639e-02 1 1  ON 1
 uu_2                -4.527194e-02 1 1  ON 2
 uu_3                -9.891508e-02 1 1  ON 3
 uu_4                -1.319777e-01 1 1  ON 4
 uu_5                -1.385260e-01 1 1  ON 5
 uu_6                -1.149961e-01 1 1  ON 6
 uu_7                -4.127476e-02 1 1  ON 7
 uu_8                 9.854080e-02 1 1  ON 8
 uu_9                 1.226821e-01 1 1  ON 9
 ud_0                 3.458540e-01 1 1  ON 10
 ud_1                 9.101218e-02 1 1  ON 11
 ud_2                -1.329430e-02 1 1  ON 12
 ud_3                -7.124924e-02 1 1  ON 13
 ud_4                -1.194051e-01 1 1  ON 14
 ud_5                -1.532906e-01 1 1  ON 15
 ud_6                -1.565746e-01 1 1  ON 16
 ud_7                -1.115028e-01 1 1  ON 17
 ud_8                 2.031112e-03 1 1  ON 18
 ud_9                 9.254227e-02 1 1  ON 19
 eO_0                -7.541655e-01 1 1  ON 20
 eO_1                -4.421210e-01 1 1  ON 21
 eO_2                -4.678424e-02 1 1  ON 22
 eO_3                 2.024222e-01 1 1  ON 23
 eO_4                 2.975185e-01 1 1  ON 24
 eO_5                 3.144360e-01 1 1  ON 25
 eO_6                 2.543341e-01 1 1  ON 26
 eO_7                 1.164753e-01 1 1  ON 27
 eO_8                 2.861391e-02 1 1  ON 28
 eO_9                 1.856991e-02 1 1  ON 29
eH1_0                -1.814927e-01 1 1  ON 30
eH1_1                -1.030419e-01 1 1  ON 31
eH1_2                -6.277435e-02 1 1  ON 32
eH1_3                -2.663108e-02 1 1  ON 33
eH1_4                 1.879726e-02 1 1  ON 34
eH1_5                 3.320141e-02 1 1  ON 35
eH1_6                 7.824036e-02 1 1  ON 36
eH1_7                 1.100689e-01 1 1  ON 37
eH1_8                 9.309225e-02 1 1  ON 38
eH1_9                 2.506587e-02 1 1  ON 39
eH2_0                -1.835869e-01 1 1  ON 40
eH2_1                -1.045903e-01 1 1  ON 41
eH2_2                -6.432969e-02 1 1  ON 42
eH2_3                -2.815758e-02 1 1  ON 43
eH2_4                 1.757495e-02 1 1  ON 44
eH2_5                 3.291178e-02 1 1  ON 45
eH2_6                 8.017330e-02 1 1  ON 46
eH2_7                 1.144760e-01 1 1  ON 47
eH2_8                 9.596622e-02 1 1  ON 48
eH2_9                 2.718244e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6503e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1877
    reference variance = 0.171716
====================================================
  Execution time = 2.0235e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2987e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329884401080
                                         uncertainty =       0.007393432097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329884401080
                                         uncertainty =       0.007393432097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406122196
  error estimate for blocks of size 2^( 2) =       0.000415704325
  error estimate for blocks of size 2^( 3) =       0.000423800028
  error estimate for blocks of size 2^( 4) =       0.000430298849
  error estimate for blocks of size 2^( 5) =       0.000434072985
  error estimate for blocks of size 2^( 6) =       0.000437191028
  error estimate for blocks of size 2^( 7) =       0.000439806527

      target function =                  N/A
              le_mean =     -17.216386073311
             les_mean =     296.733819737328
             stat err =       0.000435342347
             autocorr =       1.149075001370
              std dev =       0.574343518258
             le_variance =       0.329870476965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638607331e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216386073311       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216386105485       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216386125736       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216386134529       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216386145632       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216386147274       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216386146834       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 1.584492e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216386073311       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216386081422       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216386086532       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216386088773       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216386091552       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216386091998       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216386091902       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 3.977113e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216386073311       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216386075343       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216386076624       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216386077187       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216386077881       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216386077995       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216386077973       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 9.952817e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208957 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5756e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.081567e-01 1 1  ON 0
 uu_1                 4.726630e-02 1 1  ON 1
 uu_2                -4.527138e-02 1 1  ON 2
 uu_3                -9.891528e-02 1 1  ON 3
 uu_4                -1.319785e-01 1 1  ON 4
 uu_5                -1.385269e-01 1 1  ON 5
 uu_6                -1.149963e-01 1 1  ON 6
 uu_7                -4.127611e-02 1 1  ON 7
 uu_8                 9.853975e-02 1 1  ON 8
 uu_9                 1.226825e-01 1 1  ON 9
 ud_0                 3.458551e-01 1 1  ON 10
 ud_1                 9.101201e-02 1 1  ON 11
 ud_2                -1.329255e-02 1 1  ON 12
 ud_3                -7.124866e-02 1 1  ON 13
 ud_4                -1.194069e-01 1 1  ON 14
 ud_5                -1.532906e-01 1 1  ON 15
 ud_6                -1.565748e-01 1 1  ON 16
 ud_7                -1.115032e-01 1 1  ON 17
 ud_8                 2.029700e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541679e-01 1 1  ON 20
 eO_1                -4.421250e-01 1 1  ON 21
 eO_2                -4.678586e-02 1 1  ON 22
 eO_3                 2.024221e-01 1 1  ON 23
 eO_4                 2.975217e-01 1 1  ON 24
 eO_5                 3.144382e-01 1 1  ON 25
 eO_6                 2.543353e-01 1 1  ON 26
 eO_7                 1.164765e-01 1 1  ON 27
 eO_8                 2.861407e-02 1 1  ON 28
 eO_9                 1.856997e-02 1 1  ON 29
eH1_0                -1.814933e-01 1 1  ON 30
eH1_1                -1.030429e-01 1 1  ON 31
eH1_2                -6.277522e-02 1 1  ON 32
eH1_3                -2.663151e-02 1 1  ON 33
eH1_4                 1.879750e-02 1 1  ON 34
eH1_5                 3.320227e-02 1 1  ON 35
eH1_6                 7.824110e-02 1 1  ON 36
eH1_7                 1.100690e-01 1 1  ON 37
eH1_8                 9.309299e-02 1 1  ON 38
eH1_9                 2.506607e-02 1 1  ON 39
eH2_0                -1.835857e-01 1 1  ON 40
eH2_1                -1.045908e-01 1 1  ON 41
eH2_2                -6.432966e-02 1 1  ON 42
eH2_3                -2.815847e-02 1 1  ON 43
eH2_4                 1.757569e-02 1 1  ON 44
eH2_5                 3.291161e-02 1 1  ON 45
eH2_6                 8.017256e-02 1 1  ON 46
eH2_7                 1.144754e-01 1 1  ON 47
eH2_8                 9.596672e-02 1 1  ON 48
eH2_9                 2.718269e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2102
    reference variance = 0.1868
====================================================
  Execution time = 1.9670e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1768e-01
  Total weights = 2.0000e+06
  Execution time = 1.8241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317692633896
                                         uncertainty =       0.003071375672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317692633896
                                         uncertainty =       0.003071375672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398546062
  error estimate for blocks of size 2^( 2) =       0.000408451463
  error estimate for blocks of size 2^( 3) =       0.000416474288
  error estimate for blocks of size 2^( 4) =       0.000422525927
  error estimate for blocks of size 2^( 5) =       0.000426677531
  error estimate for blocks of size 2^( 6) =       0.000427633356
  error estimate for blocks of size 2^( 7) =       0.000429129934

      target function =                  N/A
              le_mean =     -17.216444560289
             les_mean =     296.723641065250
             stat err =       0.000426491687
             autocorr =       1.145154533947
              std dev =       0.563629245672
             le_variance =       0.317677926577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317694601200
                                         uncertainty =       0.003071377724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317694601200
                                         uncertainty =       0.003071377724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398547295
  error estimate for blocks of size 2^( 2) =       0.000408452735
  error estimate for blocks of size 2^( 3) =       0.000416475510
  error estimate for blocks of size 2^( 4) =       0.000422527065
  error estimate for blocks of size 2^( 5) =       0.000426678645
  error estimate for blocks of size 2^( 6) =       0.000427634553
  error estimate for blocks of size 2^( 7) =       0.000429130787

      target function =                  N/A
              le_mean =     -17.216444625822
             les_mean =     296.723645288365
             stat err =       0.000426492762
             autocorr =       1.145153220699
              std dev =       0.563630990284
             le_variance =       0.317679893209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317693636025
                                         uncertainty =       0.003071376799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317693636025
                                         uncertainty =       0.003071376799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398546690
  error estimate for blocks of size 2^( 2) =       0.000408452111
  error estimate for blocks of size 2^( 3) =       0.000416474911
  error estimate for blocks of size 2^( 4) =       0.000422526507
  error estimate for blocks of size 2^( 5) =       0.000426678099
  error estimate for blocks of size 2^( 6) =       0.000427633966
  error estimate for blocks of size 2^( 7) =       0.000429130371

      target function =                  N/A
              le_mean =     -17.216444593763
             les_mean =     296.723643219654
             stat err =       0.000426492236
             autocorr =       1.145153870483
              std dev =       0.563630134383
             le_variance =       0.317678928384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317692759690
                                         uncertainty =       0.003071375816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317692759690
                                         uncertainty =       0.003071375816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398546141
  error estimate for blocks of size 2^( 2) =       0.000408451545
  error estimate for blocks of size 2^( 3) =       0.000416474366
  error estimate for blocks of size 2^( 4) =       0.000422526000
  error estimate for blocks of size 2^( 5) =       0.000426677602
  error estimate for blocks of size 2^( 6) =       0.000427633433
  error estimate for blocks of size 2^( 7) =       0.000429129989

      target function =                  N/A
              le_mean =     -17.216444564488
             les_mean =     296.723641335597
             stat err =       0.000426491756
             autocorr =       1.145154450784
              std dev =       0.563629357229
             le_variance =       0.317678052331


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216444560289        initial
     2.3283e+01     2.3283e+02             1.5845e-05       -17.216444625822  <--
     9.3132e+01     9.3132e+02             3.9771e-06       -17.216444593763
     3.7253e+02     3.7253e+03             9.9528e-07       -17.216444564488

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 2.9040e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.081652e-01 1 1  ON 0
 uu_1                 4.726603e-02 1 1  ON 1
 uu_2                -4.526969e-02 1 1  ON 2
 uu_3                -9.891590e-02 1 1  ON 3
 uu_4                -1.319808e-01 1 1  ON 4
 uu_5                -1.385297e-01 1 1  ON 5
 uu_6                -1.149967e-01 1 1  ON 6
 uu_7                -4.128015e-02 1 1  ON 7
 uu_8                 9.853661e-02 1 1  ON 8
 uu_9                 1.226840e-01 1 1  ON 9
 ud_0                 3.458583e-01 1 1  ON 10
 ud_1                 9.101160e-02 1 1  ON 11
 ud_2                -1.328739e-02 1 1  ON 12
 ud_3                -7.124692e-02 1 1  ON 13
 ud_4                -1.194120e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565753e-01 1 1  ON 16
 ud_7                -1.115045e-01 1 1  ON 17
 ud_8                 2.025470e-03 1 1  ON 18
 ud_9                 9.254202e-02 1 1  ON 19
 eO_0                -7.541750e-01 1 1  ON 20
 eO_1                -4.421369e-01 1 1  ON 21
 eO_2                -4.679069e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975312e-01 1 1  ON 24
 eO_5                 3.144448e-01 1 1  ON 25
 eO_6                 2.543389e-01 1 1  ON 26
 eO_7                 1.164801e-01 1 1  ON 27
 eO_8                 2.861456e-02 1 1  ON 28
 eO_9                 1.857014e-02 1 1  ON 29
eH1_0                -1.814951e-01 1 1  ON 30
eH1_1                -1.030460e-01 1 1  ON 31
eH1_2                -6.277782e-02 1 1  ON 32
eH1_3                -2.663280e-02 1 1  ON 33
eH1_4                 1.879822e-02 1 1  ON 34
eH1_5                 3.320484e-02 1 1  ON 35
eH1_6                 7.824334e-02 1 1  ON 36
eH1_7                 1.100694e-01 1 1  ON 37
eH1_8                 9.309520e-02 1 1  ON 38
eH1_9                 2.506664e-02 1 1  ON 39
eH2_0                -1.835821e-01 1 1  ON 40
eH2_1                -1.045923e-01 1 1  ON 41
eH2_2                -6.432958e-02 1 1  ON 42
eH2_3                -2.816108e-02 1 1  ON 43
eH2_4                 1.757788e-02 1 1  ON 44
eH2_5                 3.291110e-02 1 1  ON 45
eH2_6                 8.017036e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596821e-02 1 1  ON 48
eH2_9                 2.718343e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4801e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1633
    reference variance = 0.123857
====================================================
  Execution time = 2.0096e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3160e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331710107218
                                         uncertainty =       0.009586140139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331710107218
                                         uncertainty =       0.009586140139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407183995
  error estimate for blocks of size 2^( 2) =       0.000416537996
  error estimate for blocks of size 2^( 3) =       0.000425042439
  error estimate for blocks of size 2^( 4) =       0.000431707647
  error estimate for blocks of size 2^( 5) =       0.000434811978
  error estimate for blocks of size 2^( 6) =       0.000436735450
  error estimate for blocks of size 2^( 7) =       0.000436400458

      target function =                  N/A
              le_mean =     -17.216546000092
             les_mean =     296.741053618474
             stat err =       0.000434913883
             autocorr =       1.140841065867
              std dev =       0.575845127598
             le_variance =       0.331597610978


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654600009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546000092       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546083119       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546161892       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546223798       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546162061       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546164727       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216546164762       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216546171473       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 7.065171e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546000092       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546021653       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546042236       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546057571       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546042832       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546043526       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216546043011       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216546044578       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 1.790249e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546000092       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546005535       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546010741       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546014564       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546010929       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546011101       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216546010940       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216546011325       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 4.491482e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5650e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.081663e-01 1 1  ON 0
 uu_1                 4.726985e-02 1 1  ON 1
 uu_2                -4.527171e-02 1 1  ON 2
 uu_3                -9.891272e-02 1 1  ON 3
 uu_4                -1.319820e-01 1 1  ON 4
 uu_5                -1.385256e-01 1 1  ON 5
 uu_6                -1.149976e-01 1 1  ON 6
 uu_7                -4.128638e-02 1 1  ON 7
 uu_8                 9.853192e-02 1 1  ON 8
 uu_9                 1.226853e-01 1 1  ON 9
 ud_0                 3.458650e-01 1 1  ON 10
 ud_1                 9.101446e-02 1 1  ON 11
 ud_2                -1.328204e-02 1 1  ON 12
 ud_3                -7.124534e-02 1 1  ON 13
 ud_4                -1.194141e-01 1 1  ON 14
 ud_5                -1.532941e-01 1 1  ON 15
 ud_6                -1.565791e-01 1 1  ON 16
 ud_7                -1.115084e-01 1 1  ON 17
 ud_8                 2.019909e-03 1 1  ON 18
 ud_9                 9.254234e-02 1 1  ON 19
 eO_0                -7.541929e-01 1 1  ON 20
 eO_1                -4.421446e-01 1 1  ON 21
 eO_2                -4.679731e-02 1 1  ON 22
 eO_3                 2.024227e-01 1 1  ON 23
 eO_4                 2.975407e-01 1 1  ON 24
 eO_5                 3.144568e-01 1 1  ON 25
 eO_6                 2.543438e-01 1 1  ON 26
 eO_7                 1.164843e-01 1 1  ON 27
 eO_8                 2.861505e-02 1 1  ON 28
 eO_9                 1.857021e-02 1 1  ON 29
eH1_0                -1.814953e-01 1 1  ON 30
eH1_1                -1.030509e-01 1 1  ON 31
eH1_2                -6.277480e-02 1 1  ON 32
eH1_3                -2.663327e-02 1 1  ON 33
eH1_4                 1.879806e-02 1 1  ON 34
eH1_5                 3.320237e-02 1 1  ON 35
eH1_6                 7.824472e-02 1 1  ON 36
eH1_7                 1.100696e-01 1 1  ON 37
eH1_8                 9.309791e-02 1 1  ON 38
eH1_9                 2.506744e-02 1 1  ON 39
eH2_0                -1.835844e-01 1 1  ON 40
eH2_1                -1.045916e-01 1 1  ON 41
eH2_2                -6.433648e-02 1 1  ON 42
eH2_3                -2.815591e-02 1 1  ON 43
eH2_4                 1.757666e-02 1 1  ON 44
eH2_5                 3.291125e-02 1 1  ON 45
eH2_6                 8.017075e-02 1 1  ON 46
eH2_7                 1.144744e-01 1 1  ON 47
eH2_8                 9.597089e-02 1 1  ON 48
eH2_9                 2.718400e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2215
    reference variance = 0.232178
====================================================
  Execution time = 1.9983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2173e-01
  Total weights = 2.0000e+06
  Execution time = 1.8181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657349158
                                         uncertainty =       0.003463782144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657349158
                                         uncertainty =       0.003463782144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401075374
  error estimate for blocks of size 2^( 2) =       0.000410662461
  error estimate for blocks of size 2^( 3) =       0.000419419280
  error estimate for blocks of size 2^( 4) =       0.000425994998
  error estimate for blocks of size 2^( 5) =       0.000429683600
  error estimate for blocks of size 2^( 6) =       0.000431619466
  error estimate for blocks of size 2^( 7) =       0.000433222188

      target function =                  N/A
              le_mean =     -17.216722291733
             les_mean =     296.737249221375
             stat err =       0.000430130063
             autocorr =       1.150131770670
              std dev =       0.567206233715
             le_variance =       0.321722911565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321671850190
                                         uncertainty =       0.003463951080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321671850190
                                         uncertainty =       0.003463951080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401084417
  error estimate for blocks of size 2^( 2) =       0.000410671109
  error estimate for blocks of size 2^( 3) =       0.000419427320
  error estimate for blocks of size 2^( 4) =       0.000426003068
  error estimate for blocks of size 2^( 5) =       0.000429691638
  error estimate for blocks of size 2^( 6) =       0.000431627575
  error estimate for blocks of size 2^( 7) =       0.000433230248

      target function =                  N/A
              le_mean =     -17.216722195916
             les_mean =     296.737260429167
             stat err =       0.000430138133
             autocorr =       1.150123064802
              std dev =       0.567219021811
             le_variance =       0.321737418704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321664906872
                                         uncertainty =       0.003463871278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321664906872
                                         uncertainty =       0.003463871278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401080087
  error estimate for blocks of size 2^( 2) =       0.000410666972
  error estimate for blocks of size 2^( 3) =       0.000419423478
  error estimate for blocks of size 2^( 4) =       0.000425999213
  error estimate for blocks of size 2^( 5) =       0.000429687802
  error estimate for blocks of size 2^( 6) =       0.000431623706
  error estimate for blocks of size 2^( 7) =       0.000433226399

      target function =                  N/A
              le_mean =     -17.216722237902
             les_mean =     296.737254928780
             stat err =       0.000430134280
             autocorr =       1.150127294974
              std dev =       0.567212898822
             le_variance =       0.321730472591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321658303736
                                         uncertainty =       0.003463793447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321658303736
                                         uncertainty =       0.003463793447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401075969
  error estimate for blocks of size 2^( 2) =       0.000410663031
  error estimate for blocks of size 2^( 3) =       0.000419419811
  error estimate for blocks of size 2^( 4) =       0.000425995530
  error estimate for blocks of size 2^( 5) =       0.000429684131
  error estimate for blocks of size 2^( 6) =       0.000431620002
  error estimate for blocks of size 2^( 7) =       0.000433222720

      target function =                  N/A
              le_mean =     -17.216722284716
             les_mean =     296.737249934748
             stat err =       0.000430130596
             autocorr =       1.150131206795
              std dev =       0.567207075560
             le_variance =       0.321723866566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216722291733        initial  <--
     5.8208e+00     5.8208e+01             7.0652e-05       -17.216722195916
     2.3283e+01     2.3283e+02             1.7902e-05       -17.216722237902
     9.3132e+01     9.3132e+02             4.4915e-06       -17.216722284716

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3550
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.081652e-01 1 1  ON 0
 uu_1                 4.726603e-02 1 1  ON 1
 uu_2                -4.526969e-02 1 1  ON 2
 uu_3                -9.891590e-02 1 1  ON 3
 uu_4                -1.319808e-01 1 1  ON 4
 uu_5                -1.385297e-01 1 1  ON 5
 uu_6                -1.149967e-01 1 1  ON 6
 uu_7                -4.128015e-02 1 1  ON 7
 uu_8                 9.853661e-02 1 1  ON 8
 uu_9                 1.226840e-01 1 1  ON 9
 ud_0                 3.458583e-01 1 1  ON 10
 ud_1                 9.101160e-02 1 1  ON 11
 ud_2                -1.328739e-02 1 1  ON 12
 ud_3                -7.124692e-02 1 1  ON 13
 ud_4                -1.194120e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565753e-01 1 1  ON 16
 ud_7                -1.115045e-01 1 1  ON 17
 ud_8                 2.025470e-03 1 1  ON 18
 ud_9                 9.254202e-02 1 1  ON 19
 eO_0                -7.541750e-01 1 1  ON 20
 eO_1                -4.421369e-01 1 1  ON 21
 eO_2                -4.679069e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975312e-01 1 1  ON 24
 eO_5                 3.144448e-01 1 1  ON 25
 eO_6                 2.543389e-01 1 1  ON 26
 eO_7                 1.164801e-01 1 1  ON 27
 eO_8                 2.861456e-02 1 1  ON 28
 eO_9                 1.857014e-02 1 1  ON 29
eH1_0                -1.814951e-01 1 1  ON 30
eH1_1                -1.030460e-01 1 1  ON 31
eH1_2                -6.277782e-02 1 1  ON 32
eH1_3                -2.663280e-02 1 1  ON 33
eH1_4                 1.879822e-02 1 1  ON 34
eH1_5                 3.320484e-02 1 1  ON 35
eH1_6                 7.824334e-02 1 1  ON 36
eH1_7                 1.100694e-01 1 1  ON 37
eH1_8                 9.309520e-02 1 1  ON 38
eH1_9                 2.506664e-02 1 1  ON 39
eH2_0                -1.835821e-01 1 1  ON 40
eH2_1                -1.045923e-01 1 1  ON 41
eH2_2                -6.432958e-02 1 1  ON 42
eH2_3                -2.816108e-02 1 1  ON 43
eH2_4                 1.757788e-02 1 1  ON 44
eH2_5                 3.291110e-02 1 1  ON 45
eH2_6                 8.017036e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596821e-02 1 1  ON 48
eH2_9                 2.718343e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2473
    reference variance = 0.145712
====================================================
  Execution time = 2.0248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2140e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321499022936
                                         uncertainty =       0.004047065131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321499022936
                                         uncertainty =       0.004047065131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400874172
  error estimate for blocks of size 2^( 2) =       0.000410316532
  error estimate for blocks of size 2^( 3) =       0.000419178597
  error estimate for blocks of size 2^( 4) =       0.000425702262
  error estimate for blocks of size 2^( 5) =       0.000428972891
  error estimate for blocks of size 2^( 6) =       0.000430435074
  error estimate for blocks of size 2^( 7) =       0.000432549779

      target function =                  N/A
              le_mean =     -17.216043232473
             les_mean =     296.713544624965
             stat err =       0.000429415001
             autocorr =       1.147461896938
              std dev =       0.566921690617
             le_variance =       0.321400203292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604323247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216043232473       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216043237436       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216043223669       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216043220271       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216043229052       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216043227560       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216043229734       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 7.115251e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216043232473       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216043233716       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216043230252       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216043229400       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216043231590       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216043231215       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216043231757       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.779840e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216043232473       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216043232784       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216043231916       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216043231703       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216043232251       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216043232157       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216043232291       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 4.450243e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5913e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.081657e-01 1 1  ON 0
 uu_1                 4.726666e-02 1 1  ON 1
 uu_2                -4.526973e-02 1 1  ON 2
 uu_3                -9.891570e-02 1 1  ON 3
 uu_4                -1.319812e-01 1 1  ON 4
 uu_5                -1.385299e-01 1 1  ON 5
 uu_6                -1.149973e-01 1 1  ON 6
 uu_7                -4.128069e-02 1 1  ON 7
 uu_8                 9.853642e-02 1 1  ON 8
 uu_9                 1.226843e-01 1 1  ON 9
 ud_0                 3.458586e-01 1 1  ON 10
 ud_1                 9.101165e-02 1 1  ON 11
 ud_2                -1.328717e-02 1 1  ON 12
 ud_3                -7.124704e-02 1 1  ON 13
 ud_4                -1.194121e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565755e-01 1 1  ON 16
 ud_7                -1.115045e-01 1 1  ON 17
 ud_8                 2.025111e-03 1 1  ON 18
 ud_9                 9.254207e-02 1 1  ON 19
 eO_0                -7.541768e-01 1 1  ON 20
 eO_1                -4.421378e-01 1 1  ON 21
 eO_2                -4.679114e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975321e-01 1 1  ON 24
 eO_5                 3.144459e-01 1 1  ON 25
 eO_6                 2.543393e-01 1 1  ON 26
 eO_7                 1.164806e-01 1 1  ON 27
 eO_8                 2.861470e-02 1 1  ON 28
 eO_9                 1.857019e-02 1 1  ON 29
eH1_0                -1.814952e-01 1 1  ON 30
eH1_1                -1.030461e-01 1 1  ON 31
eH1_2                -6.277791e-02 1 1  ON 32
eH1_3                -2.663315e-02 1 1  ON 33
eH1_4                 1.879829e-02 1 1  ON 34
eH1_5                 3.320497e-02 1 1  ON 35
eH1_6                 7.824337e-02 1 1  ON 36
eH1_7                 1.100693e-01 1 1  ON 37
eH1_8                 9.309554e-02 1 1  ON 38
eH1_9                 2.506677e-02 1 1  ON 39
eH2_0                -1.835821e-01 1 1  ON 40
eH2_1                -1.045922e-01 1 1  ON 41
eH2_2                -6.432954e-02 1 1  ON 42
eH2_3                -2.816117e-02 1 1  ON 43
eH2_4                 1.757802e-02 1 1  ON 44
eH2_5                 3.291070e-02 1 1  ON 45
eH2_6                 8.017026e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596845e-02 1 1  ON 48
eH2_9                 2.718352e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.3001
    reference variance = 0.27336
====================================================
  Execution time = 1.9697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2812e-01
  Total weights = 2.0000e+06
  Execution time = 1.8188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328166386114
                                         uncertainty =       0.004676340683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328166386114
                                         uncertainty =       0.004676340683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405040726
  error estimate for blocks of size 2^( 2) =       0.000414562171
  error estimate for blocks of size 2^( 3) =       0.000423346844
  error estimate for blocks of size 2^( 4) =       0.000430262462
  error estimate for blocks of size 2^( 5) =       0.000434090514
  error estimate for blocks of size 2^( 6) =       0.000435220941
  error estimate for blocks of size 2^( 7) =       0.000435652737

      target function =                  N/A
              le_mean =     -17.216563789673
             les_mean =     296.738184538488
             stat err =       0.000433806663
             autocorr =       1.147083552413
              std dev =       0.572814087362
             le_variance =       0.328115978681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328167860162
                                         uncertainty =       0.004676365344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328167860162
                                         uncertainty =       0.004676365344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405041635
  error estimate for blocks of size 2^( 2) =       0.000414563045
  error estimate for blocks of size 2^( 3) =       0.000423347677
  error estimate for blocks of size 2^( 4) =       0.000430263288
  error estimate for blocks of size 2^( 5) =       0.000434091343
  error estimate for blocks of size 2^( 6) =       0.000435221781
  error estimate for blocks of size 2^( 7) =       0.000435653630

      target function =                  N/A
              le_mean =     -17.216563791449
             les_mean =     296.738186073191
             stat err =       0.000433807510
             autocorr =       1.147082880512
              std dev =       0.572815373594
             le_variance =       0.328117452226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328167125473
                                         uncertainty =       0.004676353055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328167125473
                                         uncertainty =       0.004676353055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405041182
  error estimate for blocks of size 2^( 2) =       0.000414562609
  error estimate for blocks of size 2^( 3) =       0.000423347262
  error estimate for blocks of size 2^( 4) =       0.000430262876
  error estimate for blocks of size 2^( 5) =       0.000434090930
  error estimate for blocks of size 2^( 6) =       0.000435221363
  error estimate for blocks of size 2^( 7) =       0.000435653185

      target function =                  N/A
              le_mean =     -17.216563790554
             les_mean =     296.738185307936
             stat err =       0.000433807089
             autocorr =       1.147083216663
              std dev =       0.572814732516
             le_variance =       0.328116717787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328166478604
                                         uncertainty =       0.004676342231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328166478604
                                         uncertainty =       0.004676342231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405040783
  error estimate for blocks of size 2^( 2) =       0.000414562226
  error estimate for blocks of size 2^( 3) =       0.000423346896
  error estimate for blocks of size 2^( 4) =       0.000430262514
  error estimate for blocks of size 2^( 5) =       0.000434090566
  error estimate for blocks of size 2^( 6) =       0.000435220993
  error estimate for blocks of size 2^( 7) =       0.000435652793

      target function =                  N/A
              le_mean =     -17.216563789782
             les_mean =     296.738184634720
             stat err =       0.000433806717
             autocorr =       1.147083510444
              std dev =       0.572814168068
             le_variance =       0.328116071139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216563789673        initial
     5.8208e+01     5.8208e+02             7.1153e-06       -17.216563791449  <--
     2.3283e+02     2.3283e+03             1.7798e-06       -17.216563790554
     9.3132e+02     9.3132e+03             4.4502e-07       -17.216563789782

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.9102e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024035e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421406e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506716e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5020e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2325
    reference variance = 0.291092
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2332e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323448040381
                                         uncertainty =       0.004017649293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323448040381
                                         uncertainty =       0.004017649293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402068738
  error estimate for blocks of size 2^( 2) =       0.000411625839
  error estimate for blocks of size 2^( 3) =       0.000420201102
  error estimate for blocks of size 2^( 4) =       0.000427086452
  error estimate for blocks of size 2^( 5) =       0.000431275809
  error estimate for blocks of size 2^( 6) =       0.000433331977
  error estimate for blocks of size 2^( 7) =       0.000435825105

      target function =                  N/A
              le_mean =     -17.216770545641
             les_mean =     296.740506399591
             stat err =       0.000431879836
             autocorr =       1.153785937333
              std dev =       0.568611062150
             le_variance =       0.323318540000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677054564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216770545641       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216770580208       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216770604014       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216770623125       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216770661383       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216770663042       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216770658160       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 2.564530e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216770545641       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216770554410       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216770560427       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216770565294       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216770574907       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216770575429       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216770574154       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 6.429987e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216770545641       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216770547841       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216770549350       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216770550572       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216770552979       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216770553116       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216770552794       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.608660e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5863e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.081681e-01 1 1  ON 0
 uu_1                 4.727049e-02 1 1  ON 1
 uu_2                -4.526740e-02 1 1  ON 2
 uu_3                -9.891469e-02 1 1  ON 3
 uu_4                -1.319816e-01 1 1  ON 4
 uu_5                -1.385330e-01 1 1  ON 5
 uu_6                -1.150003e-01 1 1  ON 6
 uu_7                -4.128490e-02 1 1  ON 7
 uu_8                 9.853419e-02 1 1  ON 8
 uu_9                 1.226856e-01 1 1  ON 9
 ud_0                 3.458613e-01 1 1  ON 10
 ud_1                 9.101066e-02 1 1  ON 11
 ud_2                -1.328389e-02 1 1  ON 12
 ud_3                -7.124753e-02 1 1  ON 13
 ud_4                -1.194109e-01 1 1  ON 14
 ud_5                -1.532904e-01 1 1  ON 15
 ud_6                -1.565775e-01 1 1  ON 16
 ud_7                -1.115066e-01 1 1  ON 17
 ud_8                 2.021456e-03 1 1  ON 18
 ud_9                 9.254200e-02 1 1  ON 19
 eO_0                -7.541886e-01 1 1  ON 20
 eO_1                -4.421439e-01 1 1  ON 21
 eO_2                -4.679521e-02 1 1  ON 22
 eO_3                 2.024233e-01 1 1  ON 23
 eO_4                 2.975393e-01 1 1  ON 24
 eO_5                 3.144523e-01 1 1  ON 25
 eO_6                 2.543419e-01 1 1  ON 26
 eO_7                 1.164838e-01 1 1  ON 27
 eO_8                 2.861534e-02 1 1  ON 28
 eO_9                 1.857043e-02 1 1  ON 29
eH1_0                -1.814968e-01 1 1  ON 30
eH1_1                -1.030447e-01 1 1  ON 31
eH1_2                -6.277814e-02 1 1  ON 32
eH1_3                -2.663548e-02 1 1  ON 33
eH1_4                 1.879872e-02 1 1  ON 34
eH1_5                 3.320595e-02 1 1  ON 35
eH1_6                 7.824310e-02 1 1  ON 36
eH1_7                 1.100684e-01 1 1  ON 37
eH1_8                 9.309730e-02 1 1  ON 38
eH1_9                 2.506737e-02 1 1  ON 39
eH2_0                -1.835813e-01 1 1  ON 40
eH2_1                -1.045912e-01 1 1  ON 41
eH2_2                -6.432985e-02 1 1  ON 42
eH2_3                -2.816210e-02 1 1  ON 43
eH2_4                 1.757763e-02 1 1  ON 44
eH2_5                 3.290834e-02 1 1  ON 45
eH2_6                 8.016998e-02 1 1  ON 46
eH2_7                 1.144738e-01 1 1  ON 47
eH2_8                 9.597014e-02 1 1  ON 48
eH2_9                 2.718396e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1589
    reference variance = 0.25929
====================================================
  Execution time = 1.9697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1374e-01
  Total weights = 2.0000e+06
  Execution time = 1.8276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313826223692
                                         uncertainty =       0.002716455849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313826223692
                                         uncertainty =       0.002716455849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396069855
  error estimate for blocks of size 2^( 2) =       0.000405563883
  error estimate for blocks of size 2^( 3) =       0.000414006870
  error estimate for blocks of size 2^( 4) =       0.000419627292
  error estimate for blocks of size 2^( 5) =       0.000423821827
  error estimate for blocks of size 2^( 6) =       0.000426240493
  error estimate for blocks of size 2^( 7) =       0.000427544809

      target function =                  N/A
              le_mean =     -17.216706527667
             les_mean =     296.728726162740
             stat err =       0.000424308605
             autocorr =       1.147678117243
              std dev =       0.560127360325
             le_variance =       0.313742659785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313827938992
                                         uncertainty =       0.002716434686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313827938992
                                         uncertainty =       0.002716434686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396070934
  error estimate for blocks of size 2^( 2) =       0.000405564970
  error estimate for blocks of size 2^( 3) =       0.000414007855
  error estimate for blocks of size 2^( 4) =       0.000419628251
  error estimate for blocks of size 2^( 5) =       0.000423822740
  error estimate for blocks of size 2^( 6) =       0.000426241495
  error estimate for blocks of size 2^( 7) =       0.000427545616

      target function =                  N/A
              le_mean =     -17.216706506944
             les_mean =     296.728727159379
             stat err =       0.000424309525
             autocorr =       1.147676838636
              std dev =       0.560128886960
             le_variance =       0.313744370007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313827091573
                                         uncertainty =       0.002716444714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313827091573
                                         uncertainty =       0.002716444714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396070401
  error estimate for blocks of size 2^( 2) =       0.000405564434
  error estimate for blocks of size 2^( 3) =       0.000414007371
  error estimate for blocks of size 2^( 4) =       0.000419627780
  error estimate for blocks of size 2^( 5) =       0.000423822293
  error estimate for blocks of size 2^( 6) =       0.000426241003
  error estimate for blocks of size 2^( 7) =       0.000427545217

      target function =                  N/A
              le_mean =     -17.216706516696
             les_mean =     296.728726650173
             stat err =       0.000424309073
             autocorr =       1.147677484718
              std dev =       0.560128132677
             le_variance =       0.313743525017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313826332349
                                         uncertainty =       0.002716454439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313826332349
                                         uncertainty =       0.002716454439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396069923
  error estimate for blocks of size 2^( 2) =       0.000405563952
  error estimate for blocks of size 2^( 3) =       0.000414006933
  error estimate for blocks of size 2^( 4) =       0.000419627353
  error estimate for blocks of size 2^( 5) =       0.000423821885
  error estimate for blocks of size 2^( 6) =       0.000426240557
  error estimate for blocks of size 2^( 7) =       0.000427544860

      target function =                  N/A
              le_mean =     -17.216706526259
             les_mean =     296.728726222576
             stat err =       0.000424308664
             autocorr =       1.147678038391
              std dev =       0.560127457019
             le_variance =       0.313742768107


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216706527667        initial  <--
     1.4552e+01     1.4552e+02             2.5645e-05       -17.216706506944
     5.8208e+01     5.8208e+02             6.4300e-06       -17.216706516696
     2.3283e+02     2.3283e+03             1.6087e-06       -17.216706526259

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.5404
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024035e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421406e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506716e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8409e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1991
    reference variance = 0.271745
====================================================
  Execution time = 1.9985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2202e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322046365430
                                         uncertainty =       0.003282222188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322046365430
                                         uncertainty =       0.003282222188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401262416
  error estimate for blocks of size 2^( 2) =       0.000410844438
  error estimate for blocks of size 2^( 3) =       0.000419581506
  error estimate for blocks of size 2^( 4) =       0.000425809267
  error estimate for blocks of size 2^( 5) =       0.000428455258
  error estimate for blocks of size 2^( 6) =       0.000431462424
  error estimate for blocks of size 2^( 7) =       0.000432030902

      target function =                  N/A
              le_mean =     -17.216383291017
             les_mean =     296.725876514858
             stat err =       0.000429439463
             autocorr =       1.145372982712
              std dev =       0.567470750502
             le_variance =       0.322023052676


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638329102e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383291017       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383287553       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383286167       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383283991       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383283392       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383284558       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216383285404       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 2.428059e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383291017       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383290149       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383289802       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383289256       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383289105       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383289395       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216383289607       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 6.070818e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383291017       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383290800       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383290713       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383290576       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383290528       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383290617       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216383290663       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.517746e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5409e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.081673e-01 1 1  ON 0
 uu_1                 4.726864e-02 1 1  ON 1
 uu_2                -4.526979e-02 1 1  ON 2
 uu_3                -9.891508e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385308e-01 1 1  ON 5
 uu_6                -1.149989e-01 1 1  ON 6
 uu_7                -4.128243e-02 1 1  ON 7
 uu_8                 9.853576e-02 1 1  ON 8
 uu_9                 1.226852e-01 1 1  ON 9
 ud_0                 3.458598e-01 1 1  ON 10
 ud_1                 9.101156e-02 1 1  ON 11
 ud_2                -1.328629e-02 1 1  ON 12
 ud_3                -7.124751e-02 1 1  ON 13
 ud_4                -1.194123e-01 1 1  ON 14
 ud_5                -1.532909e-01 1 1  ON 15
 ud_6                -1.565762e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.023882e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541828e-01 1 1  ON 20
 eO_1                -4.421410e-01 1 1  ON 21
 eO_2                -4.679266e-02 1 1  ON 22
 eO_3                 2.024217e-01 1 1  ON 23
 eO_4                 2.975353e-01 1 1  ON 24
 eO_5                 3.144495e-01 1 1  ON 25
 eO_6                 2.543408e-01 1 1  ON 26
 eO_7                 1.164823e-01 1 1  ON 27
 eO_8                 2.861517e-02 1 1  ON 28
 eO_9                 1.857034e-02 1 1  ON 29
eH1_0                -1.814957e-01 1 1  ON 30
eH1_1                -1.030463e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663412e-02 1 1  ON 33
eH1_4                 1.879857e-02 1 1  ON 34
eH1_5                 3.320518e-02 1 1  ON 35
eH1_6                 7.824342e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309667e-02 1 1  ON 38
eH1_9                 2.506719e-02 1 1  ON 39
eH2_0                -1.835823e-01 1 1  ON 40
eH2_1                -1.045922e-01 1 1  ON 41
eH2_2                -6.432928e-02 1 1  ON 42
eH2_3                -2.816147e-02 1 1  ON 43
eH2_4                 1.757861e-02 1 1  ON 44
eH2_5                 3.290942e-02 1 1  ON 45
eH2_6                 8.016989e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596930e-02 1 1  ON 48
eH2_9                 2.718383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 0.160999
====================================================
  Execution time = 2.1798e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2151e-01
  Total weights = 2.0000e+06
  Execution time = 1.8232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321448789372
                                         uncertainty =       0.003223435178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321448789372
                                         uncertainty =       0.003223435178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400943340
  error estimate for blocks of size 2^( 2) =       0.000410760763
  error estimate for blocks of size 2^( 3) =       0.000419212601
  error estimate for blocks of size 2^( 4) =       0.000425581264
  error estimate for blocks of size 2^( 5) =       0.000429564015
  error estimate for blocks of size 2^( 6) =       0.000430381966
  error estimate for blocks of size 2^( 7) =       0.000431564463

      target function =                  N/A
              le_mean =     -17.216588598870
             les_mean =     296.732433946290
             stat err =       0.000429272927
             autocorr =       1.146307122069
              std dev =       0.567019509648
             le_variance =       0.321511124321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321449844587
                                         uncertainty =       0.003223449184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321449844587
                                         uncertainty =       0.003223449184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400943998
  error estimate for blocks of size 2^( 2) =       0.000410761402
  error estimate for blocks of size 2^( 3) =       0.000419213229
  error estimate for blocks of size 2^( 4) =       0.000425581892
  error estimate for blocks of size 2^( 5) =       0.000429564647
  error estimate for blocks of size 2^( 6) =       0.000430382594
  error estimate for blocks of size 2^( 7) =       0.000431565055

      target function =                  N/A
              le_mean =     -17.216588592660
             les_mean =     296.732434787412
             stat err =       0.000429273547
             autocorr =       1.146306672191
              std dev =       0.567020439880
             le_variance =       0.321512179241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321449318248
                                         uncertainty =       0.003223442200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321449318248
                                         uncertainty =       0.003223442200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400943670
  error estimate for blocks of size 2^( 2) =       0.000410761083
  error estimate for blocks of size 2^( 3) =       0.000419212916
  error estimate for blocks of size 2^( 4) =       0.000425581579
  error estimate for blocks of size 2^( 5) =       0.000429564331
  error estimate for blocks of size 2^( 6) =       0.000430382281
  error estimate for blocks of size 2^( 7) =       0.000431564760

      target function =                  N/A
              le_mean =     -17.216588595746
             les_mean =     296.732434367477
             stat err =       0.000429273238
             autocorr =       1.146306896759
              std dev =       0.567019975882
             le_variance =       0.321511653049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321448855518
                                         uncertainty =       0.003223436056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321448855518
                                         uncertainty =       0.003223436056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400943382
  error estimate for blocks of size 2^( 2) =       0.000410760803
  error estimate for blocks of size 2^( 3) =       0.000419212640
  error estimate for blocks of size 2^( 4) =       0.000425581304
  error estimate for blocks of size 2^( 5) =       0.000429564054
  error estimate for blocks of size 2^( 6) =       0.000430382005
  error estimate for blocks of size 2^( 7) =       0.000431564500

      target function =                  N/A
              le_mean =     -17.216588598478
             les_mean =     296.732433998949
             stat err =       0.000429272966
             autocorr =       1.146307093891
              std dev =       0.567019567960
             le_variance =       0.321511190450


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216588598870        initial  <--
     1.4552e+02     1.4552e+03             2.4281e-06       -17.216588592660
     5.8208e+02     5.8208e+03             6.0708e-07       -17.216588595746
     2.3283e+03     2.3283e+04             1.5177e-07       -17.216588598478

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1595
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024035e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421406e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506716e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6624e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.282417
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1856e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318519753236
                                         uncertainty =       0.003484291161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318519753236
                                         uncertainty =       0.003484291161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399097480
  error estimate for blocks of size 2^( 2) =       0.000408483743
  error estimate for blocks of size 2^( 3) =       0.000416473067
  error estimate for blocks of size 2^( 4) =       0.000423337698
  error estimate for blocks of size 2^( 5) =       0.000427559864
  error estimate for blocks of size 2^( 6) =       0.000428703619
  error estimate for blocks of size 2^( 7) =       0.000427906050

      target function =                  N/A
              le_mean =     -17.216660750341
             les_mean =     296.731964830166
             stat err =       0.000426876808
             autocorr =       1.144055646418
              std dev =       0.564409068941
             le_variance =       0.318557597103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666075034e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660750341       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216660750052       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216660749853       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216660750217       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216660750615       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216660750433       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216660750346       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 2.246246e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660750341       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216660750269       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216660750219       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216660750310       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216660750406       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216660750364       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216660750342       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 5.615839e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660750341       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216660750323       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216660750311       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216660750328       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216660750358       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216660750350       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216660750348       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.403974e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5681e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726854e-02 1 1  ON 1
 uu_2                -4.526983e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128234e-02 1 1  ON 7
 uu_8                 9.853584e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101179e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124743e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024014e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679249e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543407e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277822e-02 1 1  ON 32
eH1_3                -2.663419e-02 1 1  ON 33
eH1_4                 1.879849e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309658e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757846e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016996e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596919e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2452
    reference variance = 0.533872
====================================================
  Execution time = 1.9758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2144e-01
  Total weights = 2.0000e+06
  Execution time = 1.8239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321398841636
                                         uncertainty =       0.003703299869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321398841636
                                         uncertainty =       0.003703299869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400896189
  error estimate for blocks of size 2^( 2) =       0.000410356062
  error estimate for blocks of size 2^( 3) =       0.000419285025
  error estimate for blocks of size 2^( 4) =       0.000424955327
  error estimate for blocks of size 2^( 5) =       0.000427738415
  error estimate for blocks of size 2^( 6) =       0.000428957055
  error estimate for blocks of size 2^( 7) =       0.000432527806

      target function =                  N/A
              le_mean =     -17.216436291478
             les_mean =     296.727113926944
             stat err =       0.000428544651
             autocorr =       1.142689667417
              std dev =       0.566952827970
             le_variance =       0.321435509144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321398920005
                                         uncertainty =       0.003703300639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321398920005
                                         uncertainty =       0.003703300639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400896238
  error estimate for blocks of size 2^( 2) =       0.000410356109
  error estimate for blocks of size 2^( 3) =       0.000419285070
  error estimate for blocks of size 2^( 4) =       0.000424955371
  error estimate for blocks of size 2^( 5) =       0.000427738458
  error estimate for blocks of size 2^( 6) =       0.000428957097
  error estimate for blocks of size 2^( 7) =       0.000432527852

      target function =                  N/A
              le_mean =     -17.216436291426
             les_mean =     296.727114003595
             stat err =       0.000428544695
             autocorr =       1.142689624637
              std dev =       0.566952897149
             le_variance =       0.321435587585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321398880829
                                         uncertainty =       0.003703300254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321398880829
                                         uncertainty =       0.003703300254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400896214
  error estimate for blocks of size 2^( 2) =       0.000410356086
  error estimate for blocks of size 2^( 3) =       0.000419285047
  error estimate for blocks of size 2^( 4) =       0.000424955349
  error estimate for blocks of size 2^( 5) =       0.000427738437
  error estimate for blocks of size 2^( 6) =       0.000428957076
  error estimate for blocks of size 2^( 7) =       0.000432527829

      target function =                  N/A
              le_mean =     -17.216436291452
             les_mean =     296.727113965278
             stat err =       0.000428544673
             autocorr =       1.142689646019
              std dev =       0.566952862567
             le_variance =       0.321435548373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321398846535
                                         uncertainty =       0.003703299918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321398846535
                                         uncertainty =       0.003703299918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400896192
  error estimate for blocks of size 2^( 2) =       0.000410356065
  error estimate for blocks of size 2^( 3) =       0.000419285027
  error estimate for blocks of size 2^( 4) =       0.000424955330
  error estimate for blocks of size 2^( 5) =       0.000427738418
  error estimate for blocks of size 2^( 6) =       0.000428957057
  error estimate for blocks of size 2^( 7) =       0.000432527809

      target function =                  N/A
              le_mean =     -17.216436291475
             les_mean =     296.727113931736
             stat err =       0.000428544653
             autocorr =       1.142689664741
              std dev =       0.566952832295
             le_variance =       0.321435514048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216436291478        initial  <--
     1.4552e+03     1.4552e+04             2.2462e-07       -17.216436291426
     5.8208e+03     5.8208e+04             5.6158e-08       -17.216436291452
     2.3283e+04     2.3283e+05             1.4040e-08       -17.216436291475

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2114
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024035e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421406e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506716e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4898e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1849
    reference variance = 0.251622
====================================================
  Execution time = 2.0279e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292912867
                                         uncertainty =       0.004625584066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292912867
                                         uncertainty =       0.004625584066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401538049
  error estimate for blocks of size 2^( 2) =       0.000411128841
  error estimate for blocks of size 2^( 3) =       0.000419914105
  error estimate for blocks of size 2^( 4) =       0.000426222252
  error estimate for blocks of size 2^( 5) =       0.000430072846
  error estimate for blocks of size 2^( 6) =       0.000432185383
  error estimate for blocks of size 2^( 7) =       0.000434010426

      target function =                  N/A
              le_mean =     -17.216040604383
             les_mean =     296.714519540852
             stat err =       0.000430622727
             autocorr =       1.150112923869
              std dev =       0.567860555360
             le_variance =       0.322465610333


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604060438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216040604383       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216040604377       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216040604383       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216040604430       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216040604461       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216040604454       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216040604479       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.250336e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216040604383       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216040604381       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216040604383       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216040604390       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216040604372       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216040604430       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216040604401       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 5.625870e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216040604383       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216040604382       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216040604383       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216040604386       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216040604418       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216040604384       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216040604288       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.406469e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5774e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726853e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124742e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024033e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1536
    reference variance = 0.29732
====================================================
  Execution time = 1.9908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1835e-01
  Total weights = 2.0000e+06
  Execution time = 1.8253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318455903957
                                         uncertainty =       0.003263428987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318455903957
                                         uncertainty =       0.003263428987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398969086
  error estimate for blocks of size 2^( 2) =       0.000408387485
  error estimate for blocks of size 2^( 3) =       0.000416888711
  error estimate for blocks of size 2^( 4) =       0.000422946917
  error estimate for blocks of size 2^( 5) =       0.000427380089
  error estimate for blocks of size 2^( 6) =       0.000428727432
  error estimate for blocks of size 2^( 7) =       0.000431523487

      target function =                  N/A
              le_mean =     -17.215842111551
             les_mean =     296.703572113308
             stat err =       0.000427644481
             autocorr =       1.148913289505
              std dev =       0.564227491899
             le_variance =       0.318352662615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318455914338
                                         uncertainty =       0.003263429156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318455914338
                                         uncertainty =       0.003263429156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398969092
  error estimate for blocks of size 2^( 2) =       0.000408387491
  error estimate for blocks of size 2^( 3) =       0.000416888717
  error estimate for blocks of size 2^( 4) =       0.000422946923
  error estimate for blocks of size 2^( 5) =       0.000427380094
  error estimate for blocks of size 2^( 6) =       0.000428727438
  error estimate for blocks of size 2^( 7) =       0.000431523492

      target function =                  N/A
              le_mean =     -17.215842111535
             les_mean =     296.703572123107
             stat err =       0.000427644487
             autocorr =       1.148913282498
              std dev =       0.564227501090
             le_variance =       0.318352672987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318455909148
                                         uncertainty =       0.003263429071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318455909148
                                         uncertainty =       0.003263429071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398969089
  error estimate for blocks of size 2^( 2) =       0.000408387488
  error estimate for blocks of size 2^( 3) =       0.000416888714
  error estimate for blocks of size 2^( 4) =       0.000422946920
  error estimate for blocks of size 2^( 5) =       0.000427380092
  error estimate for blocks of size 2^( 6) =       0.000428727435
  error estimate for blocks of size 2^( 7) =       0.000431523490

      target function =                  N/A
              le_mean =     -17.215842111543
             les_mean =     296.703572118208
             stat err =       0.000427644484
             autocorr =       1.148913286013
              std dev =       0.564227496495
             le_variance =       0.318352667801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318455904606
                                         uncertainty =       0.003263428997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318455904606
                                         uncertainty =       0.003263428997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398969086
  error estimate for blocks of size 2^( 2) =       0.000408387485
  error estimate for blocks of size 2^( 3) =       0.000416888711
  error estimate for blocks of size 2^( 4) =       0.000422946918
  error estimate for blocks of size 2^( 5) =       0.000427380089
  error estimate for blocks of size 2^( 6) =       0.000428727433
  error estimate for blocks of size 2^( 7) =       0.000431523487

      target function =                  N/A
              le_mean =     -17.215842111550
             les_mean =     296.703572113920
             stat err =       0.000427644482
             autocorr =       1.148913289092
              std dev =       0.564227492474
             le_variance =       0.318352663263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215842111551        initial  <--
     1.4552e+04     1.4552e+05             2.2503e-08       -17.215842111535
     5.8208e+04     5.8208e+05             5.6259e-09       -17.215842111543
     2.3283e+05     2.3283e+06             1.4065e-09       -17.215842111550

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2933
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024035e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421406e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506716e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5073e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2627
    reference variance = 0.194572
====================================================
  Execution time = 2.0062e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2328e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323297757701
                                         uncertainty =       0.004727348103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323297757701
                                         uncertainty =       0.004727348103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402045702
  error estimate for blocks of size 2^( 2) =       0.000411917474
  error estimate for blocks of size 2^( 3) =       0.000420402315
  error estimate for blocks of size 2^( 4) =       0.000427309021
  error estimate for blocks of size 2^( 5) =       0.000432225409
  error estimate for blocks of size 2^( 6) =       0.000435418814
  error estimate for blocks of size 2^( 7) =       0.000437237636

      target function =                  N/A
              le_mean =     -17.215771841533
             les_mean =     296.706081430332
             stat err =       0.000433047720
             autocorr =       1.160167422842
              std dev =       0.568578483799
             le_variance =       0.323281492240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721577184153e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215771841533       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215771841534       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215771841536       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215771841514       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215771841517       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215771841536       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215771841464       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.167883e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215771841533       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215771841533       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215771841534       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215771841442       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215771841778       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215771841229       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215771841588       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 5.419706e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215771841533       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215771841533       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215771841534       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215771842109       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215771841762       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215771841876       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215771842230       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.354926e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5676e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024035e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421406e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506716e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.3398
    reference variance = 0.550222
====================================================
  Execution time = 1.9755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1833e-01
  Total weights = 2.0000e+06
  Execution time = 1.8078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238594694
                                         uncertainty =       0.002752611023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238594694
                                         uncertainty =       0.002752611023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398957416
  error estimate for blocks of size 2^( 2) =       0.000409047382
  error estimate for blocks of size 2^( 3) =       0.000417310576
  error estimate for blocks of size 2^( 4) =       0.000424134457
  error estimate for blocks of size 2^( 5) =       0.000428317743
  error estimate for blocks of size 2^( 6) =       0.000430834077
  error estimate for blocks of size 2^( 7) =       0.000433983748

      target function =                  N/A
              le_mean =     -17.216291368377
             les_mean =     296.719022360938
             stat err =       0.000429317506
             autocorr =       1.157988142093
              std dev =       0.564210988251
             le_variance =       0.318334039264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238594462
                                         uncertainty =       0.002752611021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238594462
                                         uncertainty =       0.002752611021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398957416
  error estimate for blocks of size 2^( 2) =       0.000409047381
  error estimate for blocks of size 2^( 3) =       0.000417310575
  error estimate for blocks of size 2^( 4) =       0.000424134457
  error estimate for blocks of size 2^( 5) =       0.000428317743
  error estimate for blocks of size 2^( 6) =       0.000430834077
  error estimate for blocks of size 2^( 7) =       0.000433983748

      target function =                  N/A
              le_mean =     -17.216291368387
             les_mean =     296.719022361050
             stat err =       0.000429317506
             autocorr =       1.157988142173
              std dev =       0.564210988045
             le_variance =       0.318334039031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238594578
                                         uncertainty =       0.002752611022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238594578
                                         uncertainty =       0.002752611022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398957416
  error estimate for blocks of size 2^( 2) =       0.000409047381
  error estimate for blocks of size 2^( 3) =       0.000417310575
  error estimate for blocks of size 2^( 4) =       0.000424134457
  error estimate for blocks of size 2^( 5) =       0.000428317743
  error estimate for blocks of size 2^( 6) =       0.000430834077
  error estimate for blocks of size 2^( 7) =       0.000433983748

      target function =                  N/A
              le_mean =     -17.216291368382
             les_mean =     296.719022360994
             stat err =       0.000429317506
             autocorr =       1.157988142135
              std dev =       0.564210988148
             le_variance =       0.318334039147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238594680
                                         uncertainty =       0.002752611023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238594680
                                         uncertainty =       0.002752611023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398957416
  error estimate for blocks of size 2^( 2) =       0.000409047381
  error estimate for blocks of size 2^( 3) =       0.000417310576
  error estimate for blocks of size 2^( 4) =       0.000424134457
  error estimate for blocks of size 2^( 5) =       0.000428317743
  error estimate for blocks of size 2^( 6) =       0.000430834077
  error estimate for blocks of size 2^( 7) =       0.000433983748

      target function =                  N/A
              le_mean =     -17.216291368377
             les_mean =     296.719022360945
             stat err =       0.000429317506
             autocorr =       1.157988142097
              std dev =       0.564210988238
             le_variance =       0.318334039249


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216291368377        initial
     1.4552e+05     1.4552e+06             2.1679e-09       -17.216291368387  <--
     5.8208e+05     5.8208e+06             5.4197e-10       -17.216291368382
     2.3283e+06     2.3283e+07             1.3549e-10       -17.216291368377

*****************************************************************************
Applying the update for shift_i =   1.4552e+05     and shift_s =   1.4552e+06
*****************************************************************************

  Execution time = 2.9158e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024034e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421406e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506716e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757845e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2437
    reference variance = 0.562547
====================================================
  Execution time = 2.0081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1424e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314316029972
                                         uncertainty =       0.002348726563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314316029972
                                         uncertainty =       0.002348726563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396385228
  error estimate for blocks of size 2^( 2) =       0.000406199648
  error estimate for blocks of size 2^( 3) =       0.000414807478
  error estimate for blocks of size 2^( 4) =       0.000421777614
  error estimate for blocks of size 2^( 5) =       0.000426783887
  error estimate for blocks of size 2^( 6) =       0.000427976382
  error estimate for blocks of size 2^( 7) =       0.000429153444

      target function =                  N/A
              le_mean =     -17.215878060411
             les_mean =     296.700699731813
             stat err =       0.000426422832
             autocorr =       1.157300064645
              std dev =       0.560573365411
             le_variance =       0.314242498009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721587806041e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215878060411       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215878060415       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215878060376       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215878060359       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215878060350       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215878060412       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215878060374       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 7.722758e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215878060411       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215878060412       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215878060402       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215878060458       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215878060433       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215878060375       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215878060396       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.930690e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215878060411       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215878060411       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215878060408       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215878060207       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215878060417       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215878060405       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215878060337       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 4.826725e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5603e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024033e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757845e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2039
    reference variance = 0.230617
====================================================
  Execution time = 2.0159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2765e-01
  Total weights = 2.0000e+06
  Execution time = 1.8122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680625204
                                         uncertainty =       0.005548370932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680625204
                                         uncertainty =       0.005548370932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404752844
  error estimate for blocks of size 2^( 2) =       0.000414097009
  error estimate for blocks of size 2^( 3) =       0.000422500475
  error estimate for blocks of size 2^( 4) =       0.000428516015
  error estimate for blocks of size 2^( 5) =       0.000433247173
  error estimate for blocks of size 2^( 6) =       0.000434855321
  error estimate for blocks of size 2^( 7) =       0.000436967536

      target function =                  N/A
              le_mean =     -17.215765557234
             les_mean =     296.710233287847
             stat err =       0.000433396511
             autocorr =       1.146544730778
              std dev =       0.572406961884
             le_variance =       0.327649730013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680625610
                                         uncertainty =       0.005548370911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680625610
                                         uncertainty =       0.005548370911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404752845
  error estimate for blocks of size 2^( 2) =       0.000414097010
  error estimate for blocks of size 2^( 3) =       0.000422500475
  error estimate for blocks of size 2^( 4) =       0.000428516015
  error estimate for blocks of size 2^( 5) =       0.000433247173
  error estimate for blocks of size 2^( 6) =       0.000434855321
  error estimate for blocks of size 2^( 7) =       0.000436967536

      target function =                  N/A
              le_mean =     -17.215765557203
             les_mean =     296.710233287183
             stat err =       0.000433396511
             autocorr =       1.146544731089
              std dev =       0.572406962238
             le_variance =       0.327649730419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680625407
                                         uncertainty =       0.005548370922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680625407
                                         uncertainty =       0.005548370922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404752844
  error estimate for blocks of size 2^( 2) =       0.000414097009
  error estimate for blocks of size 2^( 3) =       0.000422500475
  error estimate for blocks of size 2^( 4) =       0.000428516015
  error estimate for blocks of size 2^( 5) =       0.000433247173
  error estimate for blocks of size 2^( 6) =       0.000434855321
  error estimate for blocks of size 2^( 7) =       0.000436967536

      target function =                  N/A
              le_mean =     -17.215765557219
             les_mean =     296.710233287515
             stat err =       0.000433396511
             autocorr =       1.146544730929
              std dev =       0.572406962061
             le_variance =       0.327649730216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680625230
                                         uncertainty =       0.005548370931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680625230
                                         uncertainty =       0.005548370931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404752844
  error estimate for blocks of size 2^( 2) =       0.000414097009
  error estimate for blocks of size 2^( 3) =       0.000422500475
  error estimate for blocks of size 2^( 4) =       0.000428516015
  error estimate for blocks of size 2^( 5) =       0.000433247173
  error estimate for blocks of size 2^( 6) =       0.000434855321
  error estimate for blocks of size 2^( 7) =       0.000436967536

      target function =                  N/A
              le_mean =     -17.215765557232
             les_mean =     296.710233287806
             stat err =       0.000433396511
             autocorr =       1.146544730796
              std dev =       0.572406961906
             le_variance =       0.327649730038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215765557234        initial  <--
     3.6380e+04     3.6380e+05             7.7228e-09       -17.215765557203
     1.4552e+05     1.4552e+06             1.9307e-09       -17.215765557219
     5.8208e+05     5.8208e+06             4.8267e-10       -17.215765557232

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5365
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024034e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421406e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506716e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757845e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.3068
    reference variance = 0.254711
====================================================
  Execution time = 2.2104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2853e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328613713108
                                         uncertainty =       0.008594919771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328613713108
                                         uncertainty =       0.008594919771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405295824
  error estimate for blocks of size 2^( 2) =       0.000414824143
  error estimate for blocks of size 2^( 3) =       0.000423633403
  error estimate for blocks of size 2^( 4) =       0.000430008215
  error estimate for blocks of size 2^( 5) =       0.000433824768
  error estimate for blocks of size 2^( 6) =       0.000436189569
  error estimate for blocks of size 2^( 7) =       0.000437861943

      target function =                  N/A
              le_mean =     -17.216502929612
             les_mean =     296.736502371309
             stat err =       0.000434471124
             autocorr =       1.149152261289
              std dev =       0.573174851350
             le_variance =       0.328529410220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650292961e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502929612       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502929612       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502929611       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502929671       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502929718       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502929624       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502929584       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 9.788021e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502929612       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502929612       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502929612       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502929612       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502929613       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502929919       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502929160       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 2.447005e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502929612       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502929612       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502929612       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502929612       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502929851       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502929374       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502926913       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 6.117513e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7649e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024034e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421406e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506716e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.675936
====================================================
  Execution time = 1.9660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2366e-01
  Total weights = 2.0000e+06
  Execution time = 1.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323734174081
                                         uncertainty =       0.005185641184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323734174081
                                         uncertainty =       0.005185641184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402284147
  error estimate for blocks of size 2^( 2) =       0.000411926741
  error estimate for blocks of size 2^( 3) =       0.000420191574
  error estimate for blocks of size 2^( 4) =       0.000427201540
  error estimate for blocks of size 2^( 5) =       0.000430675291
  error estimate for blocks of size 2^( 6) =       0.000432740829
  error estimate for blocks of size 2^( 7) =       0.000435282085

      target function =                  N/A
              le_mean =     -17.215289899087
             les_mean =     296.689871217644
             stat err =       0.000431474936
             autocorr =       1.150390559906
              std dev =       0.568915696642
             le_variance =       0.323665069885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323734174356
                                         uncertainty =       0.005185641189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323734174356
                                         uncertainty =       0.005185641189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402284147
  error estimate for blocks of size 2^( 2) =       0.000411926741
  error estimate for blocks of size 2^( 3) =       0.000420191574
  error estimate for blocks of size 2^( 4) =       0.000427201540
  error estimate for blocks of size 2^( 5) =       0.000430675291
  error estimate for blocks of size 2^( 6) =       0.000432740829
  error estimate for blocks of size 2^( 7) =       0.000435282085

      target function =                  N/A
              le_mean =     -17.215289899087
             les_mean =     296.689871217947
             stat err =       0.000431474936
             autocorr =       1.150390559698
              std dev =       0.568915696883
             le_variance =       0.323665070160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323734174219
                                         uncertainty =       0.005185641186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323734174219
                                         uncertainty =       0.005185641186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402284147
  error estimate for blocks of size 2^( 2) =       0.000411926741
  error estimate for blocks of size 2^( 3) =       0.000420191574
  error estimate for blocks of size 2^( 4) =       0.000427201540
  error estimate for blocks of size 2^( 5) =       0.000430675291
  error estimate for blocks of size 2^( 6) =       0.000432740829
  error estimate for blocks of size 2^( 7) =       0.000435282085

      target function =                  N/A
              le_mean =     -17.215289899087
             les_mean =     296.689871217796
             stat err =       0.000431474936
             autocorr =       1.150390559804
              std dev =       0.568915696762
             le_variance =       0.323665070023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323734174099
                                         uncertainty =       0.005185641184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323734174099
                                         uncertainty =       0.005185641184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402284147
  error estimate for blocks of size 2^( 2) =       0.000411926741
  error estimate for blocks of size 2^( 3) =       0.000420191574
  error estimate for blocks of size 2^( 4) =       0.000427201540
  error estimate for blocks of size 2^( 5) =       0.000430675291
  error estimate for blocks of size 2^( 6) =       0.000432740829
  error estimate for blocks of size 2^( 7) =       0.000435282085

      target function =                  N/A
              le_mean =     -17.215289899087
             les_mean =     296.689871217663
             stat err =       0.000431474936
             autocorr =       1.150390559891
              std dev =       0.568915696657
             le_variance =       0.323665069902


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215289899087        initial
     3.6380e+05     3.6380e+06             9.7880e-10       -17.215289899087  <--
     1.4552e+06     1.4552e+07             2.4470e-10       -17.215289899087
     5.8208e+06     5.8208e+07             6.1175e-11       -17.215289899087

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 2.9067e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024034e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2647
    reference variance = 0.346078
====================================================
  Execution time = 2.2151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2153e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321558744067
                                         uncertainty =       0.003311725705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321558744067
                                         uncertainty =       0.003311725705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400956967
  error estimate for blocks of size 2^( 2) =       0.000410465862
  error estimate for blocks of size 2^( 3) =       0.000419191437
  error estimate for blocks of size 2^( 4) =       0.000425306801
  error estimate for blocks of size 2^( 5) =       0.000429796688
  error estimate for blocks of size 2^( 6) =       0.000431764268
  error estimate for blocks of size 2^( 7) =       0.000433546861

      target function =                  N/A
              le_mean =     -17.216838530699
             les_mean =     296.741061810168
             stat err =       0.000430103655
             autocorr =       1.150669859501
              std dev =       0.567038780674
             le_variance =       0.321532978788


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683853070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838530699       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838530704       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216838530692       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216838530694       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216838530701       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216838530678       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216838530767       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 4.509199e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838530699       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838530700       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216838530697       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216838530748       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216838530730       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216838530641       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216838530859       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 1.127300e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838530699       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838530699       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216838530698       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216838530071       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216838530314       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216838529718       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216838529655       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 2.818251e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7695e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024034e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2184
    reference variance = 0.16535
====================================================
  Execution time = 1.9824e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2678e-01
  Total weights = 2.0000e+06
  Execution time = 1.8227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326887983933
                                         uncertainty =       0.004268251585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326887983933
                                         uncertainty =       0.004268251585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404218268
  error estimate for blocks of size 2^( 2) =       0.000413709230
  error estimate for blocks of size 2^( 3) =       0.000422049328
  error estimate for blocks of size 2^( 4) =       0.000428153209
  error estimate for blocks of size 2^( 5) =       0.000432965063
  error estimate for blocks of size 2^( 6) =       0.000435568509
  error estimate for blocks of size 2^( 7) =       0.000437604250

      target function =                  N/A
              le_mean =     -17.216317274318
             les_mean =     296.728365143253
             stat err =       0.000433572758
             autocorr =       1.150514507139
              std dev =       0.571650957020
             le_variance =       0.326784816662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326887983694
                                         uncertainty =       0.004268251580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326887983694
                                         uncertainty =       0.004268251580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404218268
  error estimate for blocks of size 2^( 2) =       0.000413709230
  error estimate for blocks of size 2^( 3) =       0.000422049328
  error estimate for blocks of size 2^( 4) =       0.000428153208
  error estimate for blocks of size 2^( 5) =       0.000432965063
  error estimate for blocks of size 2^( 6) =       0.000435568509
  error estimate for blocks of size 2^( 7) =       0.000437604250

      target function =                  N/A
              le_mean =     -17.216317274319
             les_mean =     296.728365143047
             stat err =       0.000433572758
             autocorr =       1.150514507571
              std dev =       0.571650956812
             le_variance =       0.326784816424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326887983813
                                         uncertainty =       0.004268251583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326887983813
                                         uncertainty =       0.004268251583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404218268
  error estimate for blocks of size 2^( 2) =       0.000413709230
  error estimate for blocks of size 2^( 3) =       0.000422049328
  error estimate for blocks of size 2^( 4) =       0.000428153208
  error estimate for blocks of size 2^( 5) =       0.000432965063
  error estimate for blocks of size 2^( 6) =       0.000435568509
  error estimate for blocks of size 2^( 7) =       0.000437604250

      target function =                  N/A
              le_mean =     -17.216317274319
             les_mean =     296.728365143150
             stat err =       0.000433572758
             autocorr =       1.150514507363
              std dev =       0.571650956916
             le_variance =       0.326784816543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326887983918
                                         uncertainty =       0.004268251585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326887983918
                                         uncertainty =       0.004268251585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404218268
  error estimate for blocks of size 2^( 2) =       0.000413709230
  error estimate for blocks of size 2^( 3) =       0.000422049328
  error estimate for blocks of size 2^( 4) =       0.000428153208
  error estimate for blocks of size 2^( 5) =       0.000432965063
  error estimate for blocks of size 2^( 6) =       0.000435568509
  error estimate for blocks of size 2^( 7) =       0.000437604250

      target function =                  N/A
              le_mean =     -17.216317274318
             les_mean =     296.728365143240
             stat err =       0.000433572758
             autocorr =       1.150514507171
              std dev =       0.571650957007
             le_variance =       0.326784816647


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216317274318        initial
     9.0949e+04     9.0949e+05             4.5092e-09       -17.216317274319  <--
     3.6380e+05     3.6380e+06             1.1273e-09       -17.216317274319
     1.4552e+06     1.4552e+07             2.8183e-10       -17.216317274318

*****************************************************************************
Applying the update for shift_i =   9.0949e+04     and shift_s =   9.0949e+05
*****************************************************************************

  Execution time = 2.9032e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726852e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124741e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024033e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2146
    reference variance = 0.222714
====================================================
  Execution time = 2.0505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1875e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318778169845
                                         uncertainty =       0.003423574110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318778169845
                                         uncertainty =       0.003423574110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399217315
  error estimate for blocks of size 2^( 2) =       0.000408939482
  error estimate for blocks of size 2^( 3) =       0.000417231534
  error estimate for blocks of size 2^( 4) =       0.000423184879
  error estimate for blocks of size 2^( 5) =       0.000427104247
  error estimate for blocks of size 2^( 6) =       0.000429067330
  error estimate for blocks of size 2^( 7) =       0.000429948832

      target function =                  N/A
              le_mean =     -17.216566142963
             les_mean =     296.728898525607
             stat err =       0.000427326322
             autocorr =       1.145778186315
              std dev =       0.564578541889
             le_variance =       0.318748929961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656614296e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566142963       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566142962       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566142968       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566142976       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216566143014       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566143017       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566143021       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.390731e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566142963       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566142963       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566142964       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566142929       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216566142985       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566142987       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566143045       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 3.476828e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566142963       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566142963       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566142963       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566142964       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216566142966       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566142761       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566142852       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 8.692070e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234273 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6110e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726853e-02 1 1  ON 1
 uu_2                -4.526984e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128232e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124742e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532907e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024032e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679247e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814955e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432942e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596917e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2201
    reference variance = 0.272153
====================================================
  Execution time = 1.9867e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1922e-01
  Total weights = 2.0000e+06
  Execution time = 1.8192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319240154103
                                         uncertainty =       0.004187801291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319240154103
                                         uncertainty =       0.004187801291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399511752
  error estimate for blocks of size 2^( 2) =       0.000409171514
  error estimate for blocks of size 2^( 3) =       0.000417162263
  error estimate for blocks of size 2^( 4) =       0.000424020128
  error estimate for blocks of size 2^( 5) =       0.000427473033
  error estimate for blocks of size 2^( 6) =       0.000430296341
  error estimate for blocks of size 2^( 7) =       0.000431554535

      target function =                  N/A
              le_mean =     -17.216137565328
             les_mean =     296.714611788098
             stat err =       0.000428336009
             autocorr =       1.149502857362
              std dev =       0.564994937503
             le_variance =       0.319219279405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319240158367
                                         uncertainty =       0.004187801314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319240158367
                                         uncertainty =       0.004187801314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399511754
  error estimate for blocks of size 2^( 2) =       0.000409171517
  error estimate for blocks of size 2^( 3) =       0.000417162265
  error estimate for blocks of size 2^( 4) =       0.000424020131
  error estimate for blocks of size 2^( 5) =       0.000427473035
  error estimate for blocks of size 2^( 6) =       0.000430296343
  error estimate for blocks of size 2^( 7) =       0.000431554538

      target function =                  N/A
              le_mean =     -17.216137565334
             les_mean =     296.714611792546
             stat err =       0.000428336012
             autocorr =       1.149502854502
              std dev =       0.564994941275
             le_variance =       0.319219283667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319240156235
                                         uncertainty =       0.004187801303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319240156235
                                         uncertainty =       0.004187801303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399511753
  error estimate for blocks of size 2^( 2) =       0.000409171515
  error estimate for blocks of size 2^( 3) =       0.000417162264
  error estimate for blocks of size 2^( 4) =       0.000424020129
  error estimate for blocks of size 2^( 5) =       0.000427473034
  error estimate for blocks of size 2^( 6) =       0.000430296342
  error estimate for blocks of size 2^( 7) =       0.000431554537

      target function =                  N/A
              le_mean =     -17.216137565331
             les_mean =     296.714611790322
             stat err =       0.000428336011
             autocorr =       1.149502855931
              std dev =       0.564994939389
             le_variance =       0.319219281536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319240154370
                                         uncertainty =       0.004187801293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319240154370
                                         uncertainty =       0.004187801293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399511752
  error estimate for blocks of size 2^( 2) =       0.000409171514
  error estimate for blocks of size 2^( 3) =       0.000417162263
  error estimate for blocks of size 2^( 4) =       0.000424020128
  error estimate for blocks of size 2^( 5) =       0.000427473033
  error estimate for blocks of size 2^( 6) =       0.000430296341
  error estimate for blocks of size 2^( 7) =       0.000431554535

      target function =                  N/A
              le_mean =     -17.216137565328
             les_mean =     296.714611788376
             stat err =       0.000428336009
             autocorr =       1.149502857178
              std dev =       0.564994937739
             le_variance =       0.319219279671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216137565328        initial
     2.2737e+04     2.2737e+05             1.3907e-08       -17.216137565334  <--
     9.0949e+04     9.0949e+05             3.4768e-09       -17.216137565331
     3.6380e+05     3.6380e+06             8.6921e-10       -17.216137565328

*****************************************************************************
Applying the update for shift_i =   2.2737e+04     and shift_s =   2.2737e+05
*****************************************************************************

  Execution time = 2.9040e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726853e-02 1 1  ON 1
 uu_2                -4.526983e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128233e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124742e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532908e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024027e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679248e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814956e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432943e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596918e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.182
    reference variance = 0.235688
====================================================
  Execution time = 1.9956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2033e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320395121604
                                         uncertainty =       0.002694841431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320395121604
                                         uncertainty =       0.002694841431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400206078
  error estimate for blocks of size 2^( 2) =       0.000409956383
  error estimate for blocks of size 2^( 3) =       0.000418374604
  error estimate for blocks of size 2^( 4) =       0.000424308657
  error estimate for blocks of size 2^( 5) =       0.000428051340
  error estimate for blocks of size 2^( 6) =       0.000429259349
  error estimate for blocks of size 2^( 7) =       0.000430525141

      target function =                  N/A
              le_mean =     -17.216154429969
             les_mean =     296.716303006111
             stat err =       0.000428036122
             autocorr =       1.143914278764
              std dev =       0.565976863254
             le_variance =       0.320329809739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721615442997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216154429969       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216154429959       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216154430033       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216154430180       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216154430148       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216154430135       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216154430142       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+03 is 5.843166e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216154429969       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216154429966       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216154429985       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216154430020       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216154430015       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216154430007       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216154429994       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.460797e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216154429969       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216154429968       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216154429973       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216154429982       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216154429980       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216154429979       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216154430005       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 3.651995e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5557e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726853e-02 1 1  ON 1
 uu_2                -4.526983e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128233e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328651e-02 1 1  ON 12
 ud_3                -7.124742e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532908e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024021e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679248e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814956e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879851e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824349e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432943e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290947e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596918e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1913
    reference variance = 0.222506
====================================================
  Execution time = 1.9705e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2207e-01
  Total weights = 2.0000e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322192384839
                                         uncertainty =       0.003500888240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322192384839
                                         uncertainty =       0.003500888240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401292137
  error estimate for blocks of size 2^( 2) =       0.000410553857
  error estimate for blocks of size 2^( 3) =       0.000418938454
  error estimate for blocks of size 2^( 4) =       0.000425045244
  error estimate for blocks of size 2^( 5) =       0.000429192296
  error estimate for blocks of size 2^( 6) =       0.000430545394
  error estimate for blocks of size 2^( 7) =       0.000433177105

      target function =                  N/A
              le_mean =     -17.215960640953
             les_mean =     296.711371388667
             stat err =       0.000429490010
             autocorr =       1.145472934297
              std dev =       0.567512782985
             le_variance =       0.322070758852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322192415806
                                         uncertainty =       0.003500888836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322192415806
                                         uncertainty =       0.003500888836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401292157
  error estimate for blocks of size 2^( 2) =       0.000410553875
  error estimate for blocks of size 2^( 3) =       0.000418938472
  error estimate for blocks of size 2^( 4) =       0.000425045262
  error estimate for blocks of size 2^( 5) =       0.000429192313
  error estimate for blocks of size 2^( 6) =       0.000430545411
  error estimate for blocks of size 2^( 7) =       0.000433177122

      target function =                  N/A
              le_mean =     -17.215960640716
             les_mean =     296.711371411444
             stat err =       0.000429490027
             autocorr =       1.145472915956
              std dev =       0.567512810245
             le_variance =       0.322070789792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322192400323
                                         uncertainty =       0.003500888538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322192400323
                                         uncertainty =       0.003500888538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401292147
  error estimate for blocks of size 2^( 2) =       0.000410553866
  error estimate for blocks of size 2^( 3) =       0.000418938463
  error estimate for blocks of size 2^( 4) =       0.000425045253
  error estimate for blocks of size 2^( 5) =       0.000429192305
  error estimate for blocks of size 2^( 6) =       0.000430545403
  error estimate for blocks of size 2^( 7) =       0.000433177113

      target function =                  N/A
              le_mean =     -17.215960640835
             les_mean =     296.711371400056
             stat err =       0.000429490018
             autocorr =       1.145472925119
              std dev =       0.567512796616
             le_variance =       0.322070774323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322192386774
                                         uncertainty =       0.003500888277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322192386774
                                         uncertainty =       0.003500888277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401292138
  error estimate for blocks of size 2^( 2) =       0.000410553858
  error estimate for blocks of size 2^( 3) =       0.000418938455
  error estimate for blocks of size 2^( 4) =       0.000425045246
  error estimate for blocks of size 2^( 5) =       0.000429192297
  error estimate for blocks of size 2^( 6) =       0.000430545395
  error estimate for blocks of size 2^( 7) =       0.000433177106

      target function =                  N/A
              le_mean =     -17.215960640938
             les_mean =     296.711371390091
             stat err =       0.000429490011
             autocorr =       1.145472933143
              std dev =       0.567512784689
             le_variance =       0.322070760786


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215960640953        initial  <--
     5.6843e+03     5.6843e+04             5.8432e-08       -17.215960640716
     2.2737e+04     2.2737e+05             1.4608e-08       -17.215960640835
     9.0949e+04     9.0949e+05             3.6520e-09       -17.215960640938

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9389
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726853e-02 1 1  ON 1
 uu_2                -4.526983e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128233e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124742e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532908e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024027e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679248e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814956e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432943e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596918e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4501e+01 secs
  Total Execution time = 2.2303e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
