Rank =    0  Free Memory = 77578 MB
Rank =    1  Free Memory = 77578 MB
Rank =    2  Free Memory = 77578 MB
Rank =    3  Free Memory = 77577 MB
Rank =    4  Free Memory = 77577 MB
Rank =    5  Free Memory = 77576 MB
Rank =    6  Free Memory = 77576 MB
Rank =    7  Free Memory = 77576 MB
Rank =    8  Free Memory = 77576 MB
Rank =    9  Free Memory = 77576 MB
Rank =   10  Free Memory = 77576 MB
Rank =   11  Free Memory = 77576 MB
Rank =   12  Free Memory = 77576 MB
Rank =   13  Free Memory = 77576 MB
Rank =   14  Free Memory = 77576 MB
Rank =   15  Free Memory = 77562 MB
Rank =   16  Free Memory = 77561 MB
Rank =   17  Free Memory = 77561 MB
Rank =   18  Free Memory = 77561 MB
Rank =   19  Free Memory = 77561 MB
Rank =   20  Free Memory = 77561 MB
Rank =   21  Free Memory = 77561 MB
Rank =   22  Free Memory = 77561 MB
Rank =   23  Free Memory = 77561 MB
Rank =   24  Free Memory = 77561 MB
Rank =   25  Free Memory = 77561 MB
Rank =   26  Free Memory = 77561 MB
Rank =   27  Free Memory = 77561 MB
Rank =   28  Free Memory = 77561 MB
Rank =   29  Free Memory = 77561 MB
Rank =   30  Free Memory = 77561 MB
Rank =   31  Free Memory = 77561 MB
Rank =   32  Free Memory = 86286 MB
Rank =   33  Free Memory = 86286 MB
Rank =   34  Free Memory = 86286 MB
Rank =   35  Free Memory = 86286 MB
Rank =   36  Free Memory = 86286 MB
Rank =   37  Free Memory = 86285 MB
Rank =   38  Free Memory = 86285 MB
Rank =   39  Free Memory = 86285 MB
Rank =   40  Free Memory = 86285 MB
Rank =   41  Free Memory = 86285 MB
Rank =   42  Free Memory = 86285 MB
Rank =   43  Free Memory = 86285 MB
Rank =   44  Free Memory = 86285 MB
Rank =   45  Free Memory = 86285 MB
Rank =   46  Free Memory = 86285 MB
Rank =   47  Free Memory = 86285 MB
Rank =   48  Free Memory = 86285 MB
Rank =   49  Free Memory = 86285 MB
Rank =   50  Free Memory = 86285 MB
Rank =   51  Free Memory = 86285 MB
Rank =   52  Free Memory = 86285 MB
Rank =   53  Free Memory = 86285 MB
Rank =   54  Free Memory = 86285 MB
Rank =   55  Free Memory = 86285 MB
Rank =   56  Free Memory = 86285 MB
Rank =   57  Free Memory = 86285 MB
Rank =   58  Free Memory = 86285 MB
Rank =   59  Free Memory = 86285 MB
Rank =   60  Free Memory = 86285 MB
Rank =   61  Free Memory = 86285 MB
Rank =   62  Free Memory = 86285 MB
Rank =   63  Free Memory = 86285 MB
Rank =   64  Free Memory = 86680 MB
Rank =   65  Free Memory = 86679 MB
Rank =   66  Free Memory = 86679 MB
Rank =   67  Free Memory = 86679 MB
Rank =   68  Free Memory = 86679 MB
Rank =   69  Free Memory = 86679 MB
Rank =   70  Free Memory = 86679 MB
Rank =   71  Free Memory = 86679 MB
Rank =   72  Free Memory = 86679 MB
Rank =   73  Free Memory = 86679 MB
Rank =   74  Free Memory = 86679 MB
Rank =   75  Free Memory = 86679 MB
Rank =   76  Free Memory = 86679 MB
Rank =   77  Free Memory = 86679 MB
Rank =   78  Free Memory = 86679 MB
Rank =   79  Free Memory = 86679 MB
Rank =   80  Free Memory = 86679 MB
Rank =   81  Free Memory = 86679 MB
Rank =   82  Free Memory = 86679 MB
Rank =   83  Free Memory = 86679 MB
Rank =   84  Free Memory = 86679 MB
Rank =   85  Free Memory = 86678 MB
Rank =   86  Free Memory = 86678 MB
Rank =   87  Free Memory = 86678 MB
Rank =   88  Free Memory = 86678 MB
Rank =   89  Free Memory = 86678 MB
Rank =   90  Free Memory = 86678 MB
Rank =   91  Free Memory = 86678 MB
Rank =   92  Free Memory = 86678 MB
Rank =   93  Free Memory = 86678 MB
Rank =   94  Free Memory = 86678 MB
Rank =   95  Free Memory = 86678 MB
Rank =   96  Free Memory = 86677 MB
Rank =   97  Free Memory = 86677 MB
Rank =   98  Free Memory = 86677 MB
Rank =   99  Free Memory = 86677 MB
Rank =  100  Free Memory = 86677 MB
Rank =  101  Free Memory = 86677 MB
Rank =  102  Free Memory = 86677 MB
Rank =  103  Free Memory = 86677 MB
Rank =  104  Free Memory = 86677 MB
Rank =  105  Free Memory = 86677 MB
Rank =  106  Free Memory = 86677 MB
Rank =  107  Free Memory = 86677 MB
Rank =  108  Free Memory = 86677 MB
Rank =  109  Free Memory = 86677 MB
Rank =  110  Free Memory = 86677 MB
Rank =  111  Free Memory = 86677 MB
Rank =  112  Free Memory = 86677 MB
Rank =  113  Free Memory = 86677 MB
Rank =  114  Free Memory = 86676 MB
Rank =  115  Free Memory = 86676 MB
Rank =  116  Free Memory = 86676 MB
Rank =  117  Free Memory = 86676 MB
Rank =  118  Free Memory = 86676 MB
Rank =  119  Free Memory = 86676 MB
Rank =  120  Free Memory = 86676 MB
Rank =  121  Free Memory = 86676 MB
Rank =  122  Free Memory = 86676 MB
Rank =  123  Free Memory = 86676 MB
Rank =  124  Free Memory = 86676 MB
Rank =  125  Free Memory = 86676 MB
Rank =  126  Free Memory = 86676 MB
Rank =  127  Free Memory = 86676 MB
  Input file(s): opt_h2o_gs_gvptt_run003j.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run003j.xml

  Project = H2O
  date    = 2023-04-10 18:25:07 PDT
  host    = n0016.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 755

  Range of prime numbers to use as seeds over processors and threads = 5749-6871


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.156930e-01    1         1  ON     0
     uu_1                 5.262018e-02    1         1  ON     1
     uu_2                -4.278172e-02    1         1  ON     2
     uu_3                -9.884287e-02    1         1  ON     3
     uu_4                -1.337053e-01    1         1  ON     4
     uu_5                -1.423938e-01    1         1  ON     5
     uu_6                -1.201307e-01    1         1  ON     6
     uu_7                -5.137652e-02    1         1  ON     7
     uu_8                 9.089112e-02    1         1  ON     8
     uu_9                 1.284472e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.554887e-01    1         1  ON     0
     ud_1                 9.681213e-02    1         1  ON     1
     ud_2                -1.286580e-02    1         1  ON     2
     ud_3                -7.434678e-02    1         1  ON     3
     ud_4                -1.230091e-01    1         1  ON     4
     ud_5                -1.556256e-01    1         1  ON     5
     ud_6                -1.583008e-01    1         1  ON     6
     ud_7                -1.120634e-01    1         1  ON     7
     ud_8                -8.227022e-03    1         1  ON     8
     ud_9                 9.246268e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.892370e-01    1         1  ON     0
     eO_1                -4.676657e-01    1         1  ON     1
     eO_2                -5.565518e-02    1         1  ON     2
     eO_3                 2.073244e-01    1         1  ON     3
     eO_4                 3.123492e-01    1         1  ON     4
     eO_5                 3.338853e-01    1         1  ON     5
     eO_6                 2.676231e-01    1         1  ON     6
     eO_7                 1.297992e-01    1         1  ON     7
     eO_8                 3.111769e-02    1         1  ON     8
     eO_9                 1.924250e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.844740e-01    1         1  ON     0
     eH1_1                -1.056872e-01    1         1  ON     1
     eH1_2                -6.402021e-02    1         1  ON     2
     eH1_3                -2.669409e-02    1         1  ON     3
     eH1_4                 1.879061e-02    1         1  ON     4
     eH1_5                 3.146874e-02    1         1  ON     5
     eH1_6                 7.771135e-02    1         1  ON     6
     eH1_7                 1.090684e-01    1         1  ON     7
     eH1_8                 1.002796e-01    1         1  ON     8
     eH1_9                 2.728791e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.851347e-01    1         1  ON     0
     eH2_1                -1.062665e-01    1         1  ON     1
     eH2_2                -6.452697e-02    1         1  ON     2
     eH2_3                -2.738208e-02    1         1  ON     3
     eH2_4                 1.762627e-02    1         1  ON     4
     eH2_5                 3.021967e-02    1         1  ON     5
     eH2_6                 7.594590e-02    1         1  ON     6
     eH2_7                 1.132114e-01    1         1  ON     7
     eH2_8                 1.041100e-01    1         1  ON     8
     eH2_9                 2.922316e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.698801e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 8.7734e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2339
    reference variance = 0.185111
====================================================
  Execution time = 3.3067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2838e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328378643191
                                         uncertainty =       0.009011147987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328378643191
                                         uncertainty =       0.009011147987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405203668
  error estimate for blocks of size 2^( 2) =       0.000414267084
  error estimate for blocks of size 2^( 3) =       0.000422614796
  error estimate for blocks of size 2^( 4) =       0.000428204614
  error estimate for blocks of size 2^( 5) =       0.000433229532
  error estimate for blocks of size 2^( 6) =       0.000434784207
  error estimate for blocks of size 2^( 7) =       0.000435099307

      target function =                  N/A
              le_mean =     -17.217169851686
             les_mean =     296.759317563383
             stat err =       0.000432829415
             autocorr =       1.141003031532
              std dev =       0.573044523387
             le_variance =       0.328380025784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721716985169e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217169851686       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217170900948       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217170298135       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217170094174       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217170913242       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217170727659       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217170743855       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217171164844       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217171214160       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217171177359       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.356574e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217169851686       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217170265368       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217169999665       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217169874659       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217170190694       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217170185080       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217170189732       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217170246996       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.045925e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217169851686       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217169972541       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217169891239       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217169849614       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217169933742       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217169932664       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217169937758       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217169947450       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.081463e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2266e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.156329e-01                 1 1 ON  0
uu_1  5.270760e-02                 1 1 ON  1
uu_2  -4.279663e-02                1 1 ON  2
uu_3  -9.882561e-02                1 1 ON  3
uu_4  -1.337507e-01                1 1 ON  4
uu_5  -1.423709e-01                1 1 ON  5
uu_6  -1.201396e-01                1 1 ON  6
uu_7  -5.144057e-02                1 1 ON  7
uu_8  9.080916e-02                 1 1 ON  8
uu_9  1.284998e-01                 1 1 ON  9
ud_0  3.557463e-01                 1 1 ON  10
ud_1  9.692374e-02                 1 1 ON  11
ud_2  -1.300938e-02                1 1 ON  12
ud_3  -7.445921e-02                1 1 ON  13
ud_4  -1.230691e-01                1 1 ON  14
ud_5  -1.556525e-01                1 1 ON  15
ud_6  -1.583368e-01                1 1 ON  16
ud_7  -1.120846e-01                1 1 ON  17
ud_8  -8.277673e-03                1 1 ON  18
ud_9  9.247192e-02                 1 1 ON  19
eO_0  -7.896416e-01                1 1 ON  20
eO_1  -4.679073e-01                1 1 ON  21
eO_2  -5.547092e-02                1 1 ON  22
eO_3  2.074513e-01                 1 1 ON  23
eO_4  3.123271e-01                 1 1 ON  24
eO_5  3.339334e-01                 1 1 ON  25
eO_6  2.677699e-01                 1 1 ON  26
eO_7  1.299226e-01                 1 1 ON  27
eO_8  3.113517e-02                 1 1 ON  28
eO_9  1.925366e-02                 1 1 ON  29
eH1_0 -1.844702e-01                1 1 ON  30
eH1_1 -1.056904e-01                1 1 ON  31
eH1_2 -6.404737e-02                1 1 ON  32
eH1_3 -2.674103e-02                1 1 ON  33
eH1_4 1.881692e-02                 1 1 ON  34
eH1_5 3.143932e-02                 1 1 ON  35
eH1_6 7.766630e-02                 1 1 ON  36
eH1_7 1.090865e-01                 1 1 ON  37
eH1_8 1.003496e-01                 1 1 ON  38
eH1_9 2.731029e-02                 1 1 ON  39
eH2_0 -1.851818e-01                1 1 ON  40
eH2_1 -1.062265e-01                1 1 ON  41
eH2_2 -6.463737e-02                1 1 ON  42
eH2_3 -2.745223e-02                1 1 ON  43
eH2_4 1.771194e-02                 1 1 ON  44
eH2_5 3.028738e-02                 1 1 ON  45
eH2_6 7.589370e-02                 1 1 ON  46
eH2_7 1.131954e-01                 1 1 ON  47
eH2_8 1.041787e-01                 1 1 ON  48
eH2_9 2.924576e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2279
    reference variance = 0.326876
====================================================
  Execution time = 3.2158e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2350e-01
  Total weights = 2.0000e+06
  Execution time = 3.0288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265278979
                                         uncertainty =       0.005888732036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265278979
                                         uncertainty =       0.005888732036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402001230
  error estimate for blocks of size 2^( 2) =       0.000411500537
  error estimate for blocks of size 2^( 3) =       0.000420651190
  error estimate for blocks of size 2^( 4) =       0.000426902188
  error estimate for blocks of size 2^( 5) =       0.000430317698
  error estimate for blocks of size 2^( 6) =       0.000433055663
  error estimate for blocks of size 2^( 7) =       0.000432384363

      target function =                  N/A
              le_mean =     -17.217427005437
             les_mean =     296.763002504519
             stat err =       0.000430664978
             autocorr =       1.147689339384
              std dev =       0.568515592185
             le_variance =       0.323209978557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323986824067
                                         uncertainty =       0.005904882234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323986824067
                                         uncertainty =       0.005904882234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402449628
  error estimate for blocks of size 2^( 2) =       0.000411926434
  error estimate for blocks of size 2^( 3) =       0.000421058147
  error estimate for blocks of size 2^( 4) =       0.000427293133
  error estimate for blocks of size 2^( 5) =       0.000430692036
  error estimate for blocks of size 2^( 6) =       0.000433429580
  error estimate for blocks of size 2^( 7) =       0.000432762466

      target function =                  N/A
              le_mean =     -17.217422336979
             les_mean =     296.763563173981
             stat err =       0.000431044304
             autocorr =       1.147151454849
              std dev =       0.569149721996
             le_variance =       0.323931406048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323849856577
                                         uncertainty =       0.005901318209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323849856577
                                         uncertainty =       0.005901318209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402364563
  error estimate for blocks of size 2^( 2) =       0.000411844375
  error estimate for blocks of size 2^( 3) =       0.000420979130
  error estimate for blocks of size 2^( 4) =       0.000427218351
  error estimate for blocks of size 2^( 5) =       0.000430620355
  error estimate for blocks of size 2^( 6) =       0.000433358499
  error estimate for blocks of size 2^( 7) =       0.000432691404

      target function =                  N/A
              le_mean =     -17.217422562354
             les_mean =     296.763434011649
             stat err =       0.000430972152
             autocorr =       1.147252382022
              std dev =       0.569029421812
             le_variance =       0.323794482887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323351025194
                                         uncertainty =       0.005890585348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323351025194
                                         uncertainty =       0.005890585348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402054545
  error estimate for blocks of size 2^( 2) =       0.000411550863
  error estimate for blocks of size 2^( 3) =       0.000420699111
  error estimate for blocks of size 2^( 4) =       0.000426948395
  error estimate for blocks of size 2^( 5) =       0.000430361919
  error estimate for blocks of size 2^( 6) =       0.000433099933
  error estimate for blocks of size 2^( 7) =       0.000432429208

      target function =                  N/A
              le_mean =     -17.217426155706
             les_mean =     296.763058979435
             stat err =       0.000430709864
             autocorr =       1.147624163620
              std dev =       0.568590989985
             le_variance =       0.323295713892


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217427005437        initial  <--
     2.5000e-01     2.5000e+00             1.3566e-03       -17.217422336979
     1.0000e+00     1.0000e+01             4.0459e-04       -17.217422562354
     4.0000e+00     4.0000e+01             1.0815e-04       -17.217426155706

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.3200
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9943e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.17
    reference variance = 0.248799
====================================================
  Execution time = 3.2256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1617e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316192539984
                                         uncertainty =       0.003354736963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316192539984
                                         uncertainty =       0.003354736963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397596940
  error estimate for blocks of size 2^( 2) =       0.000407556634
  error estimate for blocks of size 2^( 3) =       0.000416336374
  error estimate for blocks of size 2^( 4) =       0.000422653707
  error estimate for blocks of size 2^( 5) =       0.000427055417
  error estimate for blocks of size 2^( 6) =       0.000428742241
  error estimate for blocks of size 2^( 7) =       0.000432789044

      target function =                  N/A
              le_mean =     -17.216715439360
             les_mean =     296.731457015564
             stat err =       0.000427810102
             autocorr =       1.157753238344
              std dev =       0.562286985223
             le_variance =       0.316166653751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671543936e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216715439360       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216715653281       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216715951524       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216715976012       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216715949317       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216716175488       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216716136631       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216716126289       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.841287e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216715439360       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216715498562       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216715576568       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216715586769       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216715576653       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216715626543       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216715627759       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216715619829       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.751481e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216715439360       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216715454567       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216715474278       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216715477128       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216715474393       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216715486308       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216715487209       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216715485133       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.198627e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1247e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.156842e-01 1 1  ON 0
 uu_1                 5.263343e-02 1 1  ON 1
 uu_2                -4.277544e-02 1 1  ON 2
 uu_3                -9.884443e-02 1 1  ON 3
 uu_4                -1.336954e-01 1 1  ON 4
 uu_5                -1.424079e-01 1 1  ON 5
 uu_6                -1.201413e-01 1 1  ON 6
 uu_7                -5.137786e-02 1 1  ON 7
 uu_8                 9.088571e-02 1 1  ON 8
 uu_9                 1.284520e-01 1 1  ON 9
 ud_0                 3.555073e-01 1 1  ON 10
 ud_1                 9.682692e-02 1 1  ON 11
 ud_2                -1.288448e-02 1 1  ON 12
 ud_3                -7.436155e-02 1 1  ON 13
 ud_4                -1.230093e-01 1 1  ON 14
 ud_5                -1.556200e-01 1 1  ON 15
 ud_6                -1.583007e-01 1 1  ON 16
 ud_7                -1.120703e-01 1 1  ON 17
 ud_8                -8.235780e-03 1 1  ON 18
 ud_9                 9.246364e-02 1 1  ON 19
 eO_0                -7.892846e-01 1 1  ON 20
 eO_1                -4.676886e-01 1 1  ON 21
 eO_2                -5.563607e-02 1 1  ON 22
 eO_3                 2.073342e-01 1 1  ON 23
 eO_4                 3.123541e-01 1 1  ON 24
 eO_5                 3.338930e-01 1 1  ON 25
 eO_6                 2.676345e-01 1 1  ON 26
 eO_7                 1.298126e-01 1 1  ON 27
 eO_8                 3.111995e-02 1 1  ON 28
 eO_9                 1.924301e-02 1 1  ON 29
eH1_0                -1.844780e-01 1 1  ON 30
eH1_1                -1.056914e-01 1 1  ON 31
eH1_2                -6.401671e-02 1 1  ON 32
eH1_3                -2.668950e-02 1 1  ON 33
eH1_4                 1.879669e-02 1 1  ON 34
eH1_5                 3.146343e-02 1 1  ON 35
eH1_6                 7.770331e-02 1 1  ON 36
eH1_7                 1.090650e-01 1 1  ON 37
eH1_8                 1.002871e-01 1 1  ON 38
eH1_9                 2.729061e-02 1 1  ON 39
eH2_0                -1.851404e-01 1 1  ON 40
eH2_1                -1.062661e-01 1 1  ON 41
eH2_2                -6.452882e-02 1 1  ON 42
eH2_3                -2.738194e-02 1 1  ON 43
eH2_4                 1.763290e-02 1 1  ON 44
eH2_5                 3.021805e-02 1 1  ON 45
eH2_6                 7.593983e-02 1 1  ON 46
eH2_7                 1.132086e-01 1 1  ON 47
eH2_8                 1.041172e-01 1 1  ON 48
eH2_9                 2.922561e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2147
    reference variance = 0.317998
====================================================
  Execution time = 3.1779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1897e-01
  Total weights = 2.0000e+06
  Execution time = 3.0061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318960793392
                                         uncertainty =       0.003996942630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318960793392
                                         uncertainty =       0.003996942630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399343131
  error estimate for blocks of size 2^( 2) =       0.000408870085
  error estimate for blocks of size 2^( 3) =       0.000417628641
  error estimate for blocks of size 2^( 4) =       0.000423716296
  error estimate for blocks of size 2^( 5) =       0.000426679495
  error estimate for blocks of size 2^( 6) =       0.000428622689
  error estimate for blocks of size 2^( 7) =       0.000428766211

      target function =                  N/A
              le_mean =     -17.216409571160
             les_mean =     296.723708235786
             stat err =       0.000426946172
             autocorr =       1.143019950447
              std dev =       0.564756472592
             le_variance =       0.318949873335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319035028917
                                         uncertainty =       0.003997302868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319035028917
                                         uncertainty =       0.003997302868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399389596
  error estimate for blocks of size 2^( 2) =       0.000408912220
  error estimate for blocks of size 2^( 3) =       0.000417666931
  error estimate for blocks of size 2^( 4) =       0.000423752438
  error estimate for blocks of size 2^( 5) =       0.000426713751
  error estimate for blocks of size 2^( 6) =       0.000428655679
  error estimate for blocks of size 2^( 7) =       0.000428798510

      target function =                  N/A
              le_mean =     -17.216409861808
             les_mean =     296.723792469670
             stat err =       0.000426980095
             autocorr =       1.142935606234
              std dev =       0.564822183890
             le_variance =       0.319024099415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318999497706
                                         uncertainty =       0.003997098719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318999497706
                                         uncertainty =       0.003997098719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399367358
  error estimate for blocks of size 2^( 2) =       0.000408891949
  error estimate for blocks of size 2^( 3) =       0.000417648433
  error estimate for blocks of size 2^( 4) =       0.000423734930
  error estimate for blocks of size 2^( 5) =       0.000426697091
  error estimate for blocks of size 2^( 6) =       0.000428639584
  error estimate for blocks of size 2^( 7) =       0.000428782766

      target function =                  N/A
              le_mean =     -17.216409712487
             les_mean =     296.723751801345
             stat err =       0.000426963593
             autocorr =       1.142974545214
              std dev =       0.564790733472
             le_variance =       0.318988572616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318965669051
                                         uncertainty =       0.003996961165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318965669051
                                         uncertainty =       0.003996961165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399346183
  error estimate for blocks of size 2^( 2) =       0.000408872834
  error estimate for blocks of size 2^( 3) =       0.000417631125
  error estimate for blocks of size 2^( 4) =       0.000423718632
  error estimate for blocks of size 2^( 5) =       0.000426681697
  error estimate for blocks of size 2^( 6) =       0.000428624800
  error estimate for blocks of size 2^( 7) =       0.000428768280

      target function =                  N/A
              le_mean =     -17.216409587488
             les_mean =     296.723713673036
             stat err =       0.000426948352
             autocorr =       1.143014152026
              std dev =       0.564760788612
             le_variance =       0.318954748353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216409571160        initial
     2.5000e+00     2.5000e+01             1.8413e-04       -17.216409861808  <--
     1.0000e+01     1.0000e+02             4.7515e-05       -17.216409712487
     4.0000e+01     4.0000e+02             1.1986e-05       -17.216409587488

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.6952e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.156640e-01 1 1  ON 0
 uu_1                 5.267033e-02 1 1  ON 1
 uu_2                -4.275901e-02 1 1  ON 2
 uu_3                -9.884712e-02 1 1  ON 3
 uu_4                -1.336717e-01 1 1  ON 4
 uu_5                -1.424461e-01 1 1  ON 5
 uu_6                -1.201730e-01 1 1  ON 6
 uu_7                -5.138232e-02 1 1  ON 7
 uu_8                 9.086940e-02 1 1  ON 8
 uu_9                 1.284665e-01 1 1  ON 9
 ud_0                 3.555606e-01 1 1  ON 10
 ud_1                 9.686437e-02 1 1  ON 11
 ud_2                -1.293154e-02 1 1  ON 12
 ud_3                -7.440345e-02 1 1  ON 13
 ud_4                -1.230116e-01 1 1  ON 14
 ud_5                -1.556042e-01 1 1  ON 15
 ud_6                -1.582999e-01 1 1  ON 16
 ud_7                -1.120908e-01 1 1  ON 17
 ud_8                -8.262095e-03 1 1  ON 18
 ud_9                 9.246651e-02 1 1  ON 19
 eO_0                -7.894212e-01 1 1  ON 20
 eO_1                -4.677552e-01 1 1  ON 21
 eO_2                -5.558860e-02 1 1  ON 22
 eO_3                 2.073637e-01 1 1  ON 23
 eO_4                 3.123704e-01 1 1  ON 24
 eO_5                 3.339165e-01 1 1  ON 25
 eO_6                 2.676686e-01 1 1  ON 26
 eO_7                 1.298528e-01 1 1  ON 27
 eO_8                 3.112670e-02 1 1  ON 28
 eO_9                 1.924454e-02 1 1  ON 29
eH1_0                -1.844897e-01 1 1  ON 30
eH1_1                -1.057026e-01 1 1  ON 31
eH1_2                -6.400652e-02 1 1  ON 32
eH1_3                -2.667757e-02 1 1  ON 33
eH1_4                 1.881402e-02 1 1  ON 34
eH1_5                 3.144842e-02 1 1  ON 35
eH1_6                 7.767935e-02 1 1  ON 36
eH1_7                 1.090548e-01 1 1  ON 37
eH1_8                 1.003095e-01 1 1  ON 38
eH1_9                 2.729870e-02 1 1  ON 39
eH2_0                -1.851572e-01 1 1  ON 40
eH2_1                -1.062666e-01 1 1  ON 41
eH2_2                -6.453349e-02 1 1  ON 42
eH2_3                -2.738086e-02 1 1  ON 43
eH2_4                 1.765159e-02 1 1  ON 44
eH2_5                 3.021397e-02 1 1  ON 45
eH2_6                 7.592181e-02 1 1  ON 46
eH2_7                 1.132003e-01 1 1  ON 47
eH2_8                 1.041387e-01 1 1  ON 48
eH2_9                 2.923297e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8407e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.172
    reference variance = 0.25941
====================================================
  Execution time = 3.2796e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315266065707
                                         uncertainty =       0.003612006045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315266065707
                                         uncertainty =       0.003612006045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397019600
  error estimate for blocks of size 2^( 2) =       0.000406953578
  error estimate for blocks of size 2^( 3) =       0.000416067801
  error estimate for blocks of size 2^( 4) =       0.000422845993
  error estimate for blocks of size 2^( 5) =       0.000426709408
  error estimate for blocks of size 2^( 6) =       0.000428115607
  error estimate for blocks of size 2^( 7) =       0.000431162989

      target function =                  N/A
              le_mean =     -17.216102783046
             les_mean =     296.709444004598
             stat err =       0.000427208499
             autocorr =       1.157859526072
              std dev =       0.561470503057
             le_variance =       0.315249125804


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721610278305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216102783046       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216103277092       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216103496399       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216103581917       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216102352074       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216102678635       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216102967862       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216103124976       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216103122437       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.671655e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216102783046       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216102940618       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216103021071       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216103098020       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216102755347       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216102843589       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216102865829       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216102888916       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.503334e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216102783046       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216102825356       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216102848047       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216102873659       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216102789391       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216102809657       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216102811005       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216102815010       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.810271e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1869e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.157023e-01 1 1  ON 0
 uu_1                 5.268891e-02 1 1  ON 1
 uu_2                -4.275639e-02 1 1  ON 2
 uu_3                -9.887200e-02 1 1  ON 3
 uu_4                -1.336782e-01 1 1  ON 4
 uu_5                -1.424420e-01 1 1  ON 5
 uu_6                -1.202107e-01 1 1  ON 6
 uu_7                -5.141785e-02 1 1  ON 7
 uu_8                 9.084887e-02 1 1  ON 8
 uu_9                 1.284918e-01 1 1  ON 9
 ud_0                 3.556742e-01 1 1  ON 10
 ud_1                 9.691471e-02 1 1  ON 11
 ud_2                -1.301175e-02 1 1  ON 12
 ud_3                -7.448909e-02 1 1  ON 13
 ud_4                -1.230144e-01 1 1  ON 14
 ud_5                -1.556088e-01 1 1  ON 15
 ud_6                -1.582770e-01 1 1  ON 16
 ud_7                -1.121069e-01 1 1  ON 17
 ud_8                -8.291565e-03 1 1  ON 18
 ud_9                 9.246904e-02 1 1  ON 19
 eO_0                -7.895715e-01 1 1  ON 20
 eO_1                -4.678517e-01 1 1  ON 21
 eO_2                -5.550793e-02 1 1  ON 22
 eO_3                 2.073648e-01 1 1  ON 23
 eO_4                 3.123605e-01 1 1  ON 24
 eO_5                 3.339602e-01 1 1  ON 25
 eO_6                 2.677313e-01 1 1  ON 26
 eO_7                 1.299032e-01 1 1  ON 27
 eO_8                 3.113506e-02 1 1  ON 28
 eO_9                 1.924960e-02 1 1  ON 29
eH1_0                -1.844959e-01 1 1  ON 30
eH1_1                -1.056780e-01 1 1  ON 31
eH1_2                -6.403006e-02 1 1  ON 32
eH1_3                -2.668038e-02 1 1  ON 33
eH1_4                 1.883921e-02 1 1  ON 34
eH1_5                 3.141756e-02 1 1  ON 35
eH1_6                 7.764455e-02 1 1  ON 36
eH1_7                 1.090544e-01 1 1  ON 37
eH1_8                 1.003431e-01 1 1  ON 38
eH1_9                 2.730942e-02 1 1  ON 39
eH2_0                -1.851535e-01 1 1  ON 40
eH2_1                -1.062950e-01 1 1  ON 41
eH2_2                -6.451702e-02 1 1  ON 42
eH2_3                -2.739752e-02 1 1  ON 43
eH2_4                 1.767865e-02 1 1  ON 44
eH2_5                 3.017812e-02 1 1  ON 45
eH2_6                 7.591480e-02 1 1  ON 46
eH2_7                 1.132031e-01 1 1  ON 47
eH2_8                 1.041651e-01 1 1  ON 48
eH2_9                 2.924058e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.3061
    reference variance = 0.801996
====================================================
  Execution time = 3.2288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2286e-01
  Total weights = 2.0000e+06
  Execution time = 3.0178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322708269756
                                         uncertainty =       0.004427219557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322708269756
                                         uncertainty =       0.004427219557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401694660
  error estimate for blocks of size 2^( 2) =       0.000411107806
  error estimate for blocks of size 2^( 3) =       0.000420052509
  error estimate for blocks of size 2^( 4) =       0.000425906781
  error estimate for blocks of size 2^( 5) =       0.000429709726
  error estimate for blocks of size 2^( 6) =       0.000432088206
  error estimate for blocks of size 2^( 7) =       0.000432115757

      target function =                  N/A
              le_mean =     -17.216471668734
             les_mean =     296.729613758794
             stat err =       0.000429955118
             autocorr =       1.145655721416
              std dev =       0.568082036196
             le_variance =       0.322717199849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323146941417
                                         uncertainty =       0.004433083882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323146941417
                                         uncertainty =       0.004433083882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401967693
  error estimate for blocks of size 2^( 2) =       0.000411365293
  error estimate for blocks of size 2^( 3) =       0.000420296113
  error estimate for blocks of size 2^( 4) =       0.000426138393
  error estimate for blocks of size 2^( 5) =       0.000429933744
  error estimate for blocks of size 2^( 6) =       0.000432297925
  error estimate for blocks of size 2^( 7) =       0.000432315990

      target function =                  N/A
              le_mean =     -17.216472409890
             les_mean =     296.730078131552
             stat err =       0.000430171513
             autocorr =       1.145251831889
              std dev =       0.568468163247
             le_variance =       0.323156052626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322989328489
                                         uncertainty =       0.004430930140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322989328489
                                         uncertainty =       0.004430930140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401869618
  error estimate for blocks of size 2^( 2) =       0.000411272355
  error estimate for blocks of size 2^( 3) =       0.000420207826
  error estimate for blocks of size 2^( 4) =       0.000426054206
  error estimate for blocks of size 2^( 5) =       0.000429852312
  error estimate for blocks of size 2^( 6) =       0.000432221931
  error estimate for blocks of size 2^( 7) =       0.000432242022

      target function =                  N/A
              le_mean =     -17.216471986051
             les_mean =     296.729905865235
             stat err =       0.000430092618
             autocorr =       1.145390633157
              std dev =       0.568329464541
             le_variance =       0.322998380266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745482409
                                         uncertainty =       0.004427707970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745482409
                                         uncertainty =       0.004427707970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401717830
  error estimate for blocks of size 2^( 2) =       0.000411129554
  error estimate for blocks of size 2^( 3) =       0.000420072998
  error estimate for blocks of size 2^( 4) =       0.000425926201
  error estimate for blocks of size 2^( 5) =       0.000429728484
  error estimate for blocks of size 2^( 6) =       0.000432105776
  error estimate for blocks of size 2^( 7) =       0.000432132258

      target function =                  N/A
              le_mean =     -17.216471672994
             les_mean =     296.729651135161
             stat err =       0.000429973180
             autocorr =       1.145619817167
              std dev =       0.568114803137
             le_variance =       0.322754429544


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216471668734        initial
     6.2500e-01     6.2500e+00             5.6717e-04       -17.216472409890  <--
     2.5000e+00     2.5000e+01             1.5033e-04       -17.216471986051
     1.0000e+01     1.0000e+02             3.8103e-05       -17.216471672994

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.7460e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.158056e-01 1 1  ON 0
 uu_1                 5.273491e-02 1 1  ON 1
 uu_2                -4.275554e-02 1 1  ON 2
 uu_3                -9.891961e-02 1 1  ON 3
 uu_4                -1.337083e-01 1 1  ON 4
 uu_5                -1.424346e-01 1 1  ON 5
 uu_6                -1.203116e-01 1 1  ON 6
 uu_7                -5.151914e-02 1 1  ON 7
 uu_8                 9.078908e-02 1 1  ON 8
 uu_9                 1.285669e-01 1 1  ON 9
 ud_0                 3.559104e-01 1 1  ON 10
 ud_1                 9.700664e-02 1 1  ON 11
 ud_2                -1.315806e-02 1 1  ON 12
 ud_3                -7.468327e-02 1 1  ON 13
 ud_4                -1.230511e-01 1 1  ON 14
 ud_5                -1.556096e-01 1 1  ON 15
 ud_6                -1.581980e-01 1 1  ON 16
 ud_7                -1.121466e-01 1 1  ON 17
 ud_8                -8.376470e-03 1 1  ON 18
 ud_9                 9.247690e-02 1 1  ON 19
 eO_0                -7.899883e-01 1 1  ON 20
 eO_1                -4.680842e-01 1 1  ON 21
 eO_2                -5.538206e-02 1 1  ON 22
 eO_3                 2.073772e-01 1 1  ON 23
 eO_4                 3.123433e-01 1 1  ON 24
 eO_5                 3.340959e-01 1 1  ON 25
 eO_6                 2.679199e-01 1 1  ON 26
 eO_7                 1.300534e-01 1 1  ON 27
 eO_8                 3.115994e-02 1 1  ON 28
 eO_9                 1.926460e-02 1 1  ON 29
eH1_0                -1.845135e-01 1 1  ON 30
eH1_1                -1.056373e-01 1 1  ON 31
eH1_2                -6.407206e-02 1 1  ON 32
eH1_3                -2.669093e-02 1 1  ON 33
eH1_4                 1.889884e-02 1 1  ON 34
eH1_5                 3.134069e-02 1 1  ON 35
eH1_6                 7.754580e-02 1 1  ON 36
eH1_7                 1.090544e-01 1 1  ON 37
eH1_8                 1.004429e-01 1 1  ON 38
eH1_9                 2.734127e-02 1 1  ON 39
eH2_0                -1.851528e-01 1 1  ON 40
eH2_1                -1.063613e-01 1 1  ON 41
eH2_2                -6.448437e-02 1 1  ON 42
eH2_3                -2.743822e-02 1 1  ON 43
eH2_4                 1.774085e-02 1 1  ON 44
eH2_5                 3.008521e-02 1 1  ON 45
eH2_6                 7.589714e-02 1 1  ON 46
eH2_7                 1.132125e-01 1 1  ON 47
eH2_8                 1.042439e-01 1 1  ON 48
eH2_9                 2.926320e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9544e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1517
    reference variance = 0.233222
====================================================
  Execution time = 3.2520e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2092e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320773292091
                                         uncertainty =       0.003469295239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320773292091
                                         uncertainty =       0.003469295239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400576208
  error estimate for blocks of size 2^( 2) =       0.000410188452
  error estimate for blocks of size 2^( 3) =       0.000418188992
  error estimate for blocks of size 2^( 4) =       0.000424160245
  error estimate for blocks of size 2^( 5) =       0.000427715616
  error estimate for blocks of size 2^( 6) =       0.000428779344
  error estimate for blocks of size 2^( 7) =       0.000430155770

      target function =                  N/A
              le_mean =     -17.216816010772
             les_mean =     296.739675984859
             stat err =       0.000427702743
             autocorr =       1.140023412124
              std dev =       0.566500305867
             le_variance =       0.320922596547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721681601077e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216816010772       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216815035367       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216814793701       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216813492455       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216814469776       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216815020377       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216814473995       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216814924326       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216815324492       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216815534730       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216815168563       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.864567e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216816010772       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216815513205       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216815442373       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216815018810       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216815370306       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216815675208       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216815386514       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216815461239       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216815539024       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.499582e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216816010772       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216815842649       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216815822182       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216815739864       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216815858981       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216815934584       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216815872786       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216815878622       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.926398e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255328 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1522e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.157057e-01 1 1  ON 0
 uu_1                 5.291731e-02 1 1  ON 1
 uu_2                -4.267442e-02 1 1  ON 2
 uu_3                -9.888925e-02 1 1  ON 3
 uu_4                -1.335663e-01 1 1  ON 4
 uu_5                -1.424286e-01 1 1  ON 5
 uu_6                -1.205382e-01 1 1  ON 6
 uu_7                -5.164636e-02 1 1  ON 7
 uu_8                 9.064761e-02 1 1  ON 8
 uu_9                 1.286188e-01 1 1  ON 9
 ud_0                 3.560602e-01 1 1  ON 10
 ud_1                 9.721479e-02 1 1  ON 11
 ud_2                -1.321863e-02 1 1  ON 12
 ud_3                -7.472929e-02 1 1  ON 13
 ud_4                -1.230550e-01 1 1  ON 14
 ud_5                -1.555318e-01 1 1  ON 15
 ud_6                -1.582018e-01 1 1  ON 16
 ud_7                -1.123459e-01 1 1  ON 17
 ud_8                -8.562870e-03 1 1  ON 18
 ud_9                 9.245594e-02 1 1  ON 19
 eO_0                -7.906383e-01 1 1  ON 20
 eO_1                -4.682150e-01 1 1  ON 21
 eO_2                -5.526753e-02 1 1  ON 22
 eO_3                 2.074339e-01 1 1  ON 23
 eO_4                 3.125090e-01 1 1  ON 24
 eO_5                 3.341857e-01 1 1  ON 25
 eO_6                 2.680702e-01 1 1  ON 26
 eO_7                 1.302141e-01 1 1  ON 27
 eO_8                 3.118200e-02 1 1  ON 28
 eO_9                 1.927619e-02 1 1  ON 29
eH1_0                -1.845416e-01 1 1  ON 30
eH1_1                -1.055334e-01 1 1  ON 31
eH1_2                -6.402836e-02 1 1  ON 32
eH1_3                -2.669208e-02 1 1  ON 33
eH1_4                 1.887964e-02 1 1  ON 34
eH1_5                 3.133251e-02 1 1  ON 35
eH1_6                 7.737060e-02 1 1  ON 36
eH1_7                 1.089971e-01 1 1  ON 37
eH1_8                 1.005428e-01 1 1  ON 38
eH1_9                 2.737085e-02 1 1  ON 39
eH2_0                -1.851631e-01 1 1  ON 40
eH2_1                -1.064361e-01 1 1  ON 41
eH2_2                -6.459944e-02 1 1  ON 42
eH2_3                -2.740522e-02 1 1  ON 43
eH2_4                 1.785225e-02 1 1  ON 44
eH2_5                 3.013849e-02 1 1  ON 45
eH2_6                 7.582558e-02 1 1  ON 46
eH2_7                 1.131614e-01 1 1  ON 47
eH2_8                 1.043393e-01 1 1  ON 48
eH2_9                 2.928562e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2137
    reference variance = 0.23665
====================================================
  Execution time = 3.1871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1799e-01
  Total weights = 2.0000e+06
  Execution time = 3.0027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813757841
                                         uncertainty =       0.003021855170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813757841
                                         uncertainty =       0.003021855170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398657091
  error estimate for blocks of size 2^( 2) =       0.000408482819
  error estimate for blocks of size 2^( 3) =       0.000417607597
  error estimate for blocks of size 2^( 4) =       0.000423532051
  error estimate for blocks of size 2^( 5) =       0.000429085221
  error estimate for blocks of size 2^( 6) =       0.000431735204
  error estimate for blocks of size 2^( 7) =       0.000433936975

      target function =                  N/A
              le_mean =     -17.216412855287
             les_mean =     296.722726396926
             stat err =       0.000429572363
             autocorr =       1.161110836723
              std dev =       0.563786264611
             le_variance =       0.317854952164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318208616165
                                         uncertainty =       0.003027294481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318208616165
                                         uncertainty =       0.003027294481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398904961
  error estimate for blocks of size 2^( 2) =       0.000408712872
  error estimate for blocks of size 2^( 3) =       0.000417819372
  error estimate for blocks of size 2^( 4) =       0.000423728906
  error estimate for blocks of size 2^( 5) =       0.000429268911
  error estimate for blocks of size 2^( 6) =       0.000431921986
  error estimate for blocks of size 2^( 7) =       0.000434134732

      target function =                  N/A
              le_mean =     -17.216413128093
             les_mean =     296.723131174611
             stat err =       0.000429763634
             autocorr =       1.160701245301
              std dev =       0.564136806609
             le_variance =       0.318250336570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318080304479
                                         uncertainty =       0.003026135129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318080304479
                                         uncertainty =       0.003026135129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398824549
  error estimate for blocks of size 2^( 2) =       0.000408635476
  error estimate for blocks of size 2^( 3) =       0.000417744745
  error estimate for blocks of size 2^( 4) =       0.000423658147
  error estimate for blocks of size 2^( 5) =       0.000429200190
  error estimate for blocks of size 2^( 6) =       0.000431854540
  error estimate for blocks of size 2^( 7) =       0.000434066888

      target function =                  N/A
              le_mean =     -17.216412992028
             les_mean =     296.722998194642
             stat err =       0.000429694941
             autocorr =       1.160798174605
              std dev =       0.564023086085
             le_variance =       0.318122041637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846430881
                                         uncertainty =       0.003022473662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846430881
                                         uncertainty =       0.003022473662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398677638
  error estimate for blocks of size 2^( 2) =       0.000408501042
  error estimate for blocks of size 2^( 3) =       0.000417623298
  error estimate for blocks of size 2^( 4) =       0.000423546142
  error estimate for blocks of size 2^( 5) =       0.000429097522
  error estimate for blocks of size 2^( 6) =       0.000431748239
  error estimate for blocks of size 2^( 7) =       0.000433951823

      target function =                  N/A
              le_mean =     -17.216412708993
             les_mean =     296.722754126048
             stat err =       0.000429585932
             autocorr =       1.161064500033
              std dev =       0.563815323154
             le_variance =       0.317887718623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216412855287        initial
     1.5625e-01     1.5625e+00             1.8646e-03       -17.216413128093  <--
     6.2500e-01     6.2500e+00             6.4996e-04       -17.216412992028
     2.5000e+00     2.5000e+01             1.9264e-04       -17.216412708993

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.7013e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.158602e-01 1 1  ON 0
 uu_1                 5.321644e-02 1 1  ON 1
 uu_2                -4.248862e-02 1 1  ON 2
 uu_3                -9.879146e-02 1 1  ON 3
 uu_4                -1.334403e-01 1 1  ON 4
 uu_5                -1.424469e-01 1 1  ON 5
 uu_6                -1.210519e-01 1 1  ON 6
 uu_7                -5.200607e-02 1 1  ON 7
 uu_8                 9.022643e-02 1 1  ON 8
 uu_9                 1.287703e-01 1 1  ON 9
 ud_0                 3.564418e-01 1 1  ON 10
 ud_1                 9.751761e-02 1 1  ON 11
 ud_2                -1.314460e-02 1 1  ON 12
 ud_3                -7.474540e-02 1 1  ON 13
 ud_4                -1.230578e-01 1 1  ON 14
 ud_5                -1.554569e-01 1 1  ON 15
 ud_6                -1.581393e-01 1 1  ON 16
 ud_7                -1.128669e-01 1 1  ON 17
 ud_8                -9.106006e-03 1 1  ON 18
 ud_9                 9.239193e-02 1 1  ON 19
 eO_0                -7.918529e-01 1 1  ON 20
 eO_1                -4.688235e-01 1 1  ON 21
 eO_2                -5.538638e-02 1 1  ON 22
 eO_3                 2.075248e-01 1 1  ON 23
 eO_4                 3.129900e-01 1 1  ON 24
 eO_5                 3.344996e-01 1 1  ON 25
 eO_6                 2.685257e-01 1 1  ON 26
 eO_7                 1.306886e-01 1 1  ON 27
 eO_8                 3.124658e-02 1 1  ON 28
 eO_9                 1.931017e-02 1 1  ON 29
eH1_0                -1.845202e-01 1 1  ON 30
eH1_1                -1.053607e-01 1 1  ON 31
eH1_2                -6.393229e-02 1 1  ON 32
eH1_3                -2.670017e-02 1 1  ON 33
eH1_4                 1.884967e-02 1 1  ON 34
eH1_5                 3.130673e-02 1 1  ON 35
eH1_6                 7.688915e-02 1 1  ON 36
eH1_7                 1.088350e-01 1 1  ON 37
eH1_8                 1.008371e-01 1 1  ON 38
eH1_9                 2.745786e-02 1 1  ON 39
eH2_0                -1.852486e-01 1 1  ON 40
eH2_1                -1.065995e-01 1 1  ON 41
eH2_2                -6.473966e-02 1 1  ON 42
eH2_3                -2.740844e-02 1 1  ON 43
eH2_4                 1.802534e-02 1 1  ON 44
eH2_5                 3.030397e-02 1 1  ON 45
eH2_6                 7.565314e-02 1 1  ON 46
eH2_7                 1.130191e-01 1 1  ON 47
eH2_8                 1.046207e-01 1 1  ON 48
eH2_9                 2.935153e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8686e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1931
    reference variance = 0.296867
====================================================
  Execution time = 3.3141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1779e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0441e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317856568488
                                         uncertainty =       0.002912569805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317856568488
                                         uncertainty =       0.002912569805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398616821
  error estimate for blocks of size 2^( 2) =       0.000408282121
  error estimate for blocks of size 2^( 3) =       0.000416648982
  error estimate for blocks of size 2^( 4) =       0.000423133655
  error estimate for blocks of size 2^( 5) =       0.000426750914
  error estimate for blocks of size 2^( 6) =       0.000428661039
  error estimate for blocks of size 2^( 7) =       0.000430394117

      target function =                  N/A
              le_mean =     -17.217266144003
             les_mean =     296.752044054564
             stat err =       0.000427234931
             autocorr =       1.148741379557
              std dev =       0.563729314501
             le_variance =       0.317790740028


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721726614400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217266144003       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217266192897       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217265971930       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217266230171       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217267051743       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217272212560       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217273926039       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217271945190       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217271313659       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217270530297       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217271415537       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217271667555       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217271173485       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.128390e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217266144003       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217266181943       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217266128703       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217266342229       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217266627833       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217269273411       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217269509367       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217268569914       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217268233717       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217268218601       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217268279181       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.302516e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217266144003       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217266164012       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217266181640       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217266426552       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217266538280       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217267264163       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217267224496       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217266993435       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.612748e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2200e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.160486e-01 1 1  ON 0
 uu_1                 5.335123e-02 1 1  ON 1
 uu_2                -4.258926e-02 1 1  ON 2
 uu_3                -9.879970e-02 1 1  ON 3
 uu_4                -1.337631e-01 1 1  ON 4
 uu_5                -1.424258e-01 1 1  ON 5
 uu_6                -1.209501e-01 1 1  ON 6
 uu_7                -5.208724e-02 1 1  ON 7
 uu_8                 8.981116e-02 1 1  ON 8
 uu_9                 1.289922e-01 1 1  ON 9
 ud_0                 3.568328e-01 1 1  ON 10
 ud_1                 9.764458e-02 1 1  ON 11
 ud_2                -1.300505e-02 1 1  ON 12
 ud_3                -7.481397e-02 1 1  ON 13
 ud_4                -1.233005e-01 1 1  ON 14
 ud_5                -1.553541e-01 1 1  ON 15
 ud_6                -1.579506e-01 1 1  ON 16
 ud_7                -1.132460e-01 1 1  ON 17
 ud_8                -9.621276e-03 1 1  ON 18
 ud_9                 9.236132e-02 1 1  ON 19
 eO_0                -7.931554e-01 1 1  ON 20
 eO_1                -4.698884e-01 1 1  ON 21
 eO_2                -5.564070e-02 1 1  ON 22
 eO_3                 2.075629e-01 1 1  ON 23
 eO_4                 3.131888e-01 1 1  ON 24
 eO_5                 3.351280e-01 1 1  ON 25
 eO_6                 2.692736e-01 1 1  ON 26
 eO_7                 1.315501e-01 1 1  ON 27
 eO_8                 3.135472e-02 1 1  ON 28
 eO_9                 1.933838e-02 1 1  ON 29
eH1_0                -1.844890e-01 1 1  ON 30
eH1_1                -1.057392e-01 1 1  ON 31
eH1_2                -6.373488e-02 1 1  ON 32
eH1_3                -2.664524e-02 1 1  ON 33
eH1_4                 1.866861e-02 1 1  ON 34
eH1_5                 3.127580e-02 1 1  ON 35
eH1_6                 7.675680e-02 1 1  ON 36
eH1_7                 1.087254e-01 1 1  ON 37
eH1_8                 1.012598e-01 1 1  ON 38
eH1_9                 2.757833e-02 1 1  ON 39
eH2_0                -1.857604e-01 1 1  ON 40
eH2_1                -1.065054e-01 1 1  ON 41
eH2_2                -6.476860e-02 1 1  ON 42
eH2_3                -2.764395e-02 1 1  ON 43
eH2_4                 1.807659e-02 1 1  ON 44
eH2_5                 3.053809e-02 1 1  ON 45
eH2_6                 7.550991e-02 1 1  ON 46
eH2_7                 1.129559e-01 1 1  ON 47
eH2_8                 1.050645e-01 1 1  ON 48
eH2_9                 2.948401e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1838
    reference variance = 0.167729
====================================================
  Execution time = 3.1662e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2159e-01
  Total weights = 2.0000e+06
  Execution time = 3.0074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321349986133
                                         uncertainty =       0.004797956422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321349986133
                                         uncertainty =       0.004797956422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400823950
  error estimate for blocks of size 2^( 2) =       0.000410616707
  error estimate for blocks of size 2^( 3) =       0.000419159050
  error estimate for blocks of size 2^( 4) =       0.000426012876
  error estimate for blocks of size 2^( 5) =       0.000430127200
  error estimate for blocks of size 2^( 6) =       0.000430594314
  error estimate for blocks of size 2^( 7) =       0.000431372817

      target function =                  N/A
              le_mean =     -17.217183375741
             les_mean =     296.752722910556
             stat err =       0.000429526802
             autocorr =       1.148347183944
              std dev =       0.566850665817
             le_variance =       0.321319677337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321905260586
                                         uncertainty =       0.004801181386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321905260586
                                         uncertainty =       0.004801181386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401170363
  error estimate for blocks of size 2^( 2) =       0.000410946114
  error estimate for blocks of size 2^( 3) =       0.000419472713
  error estimate for blocks of size 2^( 4) =       0.000426316577
  error estimate for blocks of size 2^( 5) =       0.000430423806
  error estimate for blocks of size 2^( 6) =       0.000430889283
  error estimate for blocks of size 2^( 7) =       0.000431689220

      target function =                  N/A
              le_mean =     -17.217183509016
             les_mean =     296.753283142085
             stat err =       0.000429829722
             autocorr =       1.147982328594
              std dev =       0.567340567818
             le_variance =       0.321875319892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321899557758
                                         uncertainty =       0.004801097306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321899557758
                                         uncertainty =       0.004801097306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401166931
  error estimate for blocks of size 2^( 2) =       0.000410943736
  error estimate for blocks of size 2^( 3) =       0.000419474217
  error estimate for blocks of size 2^( 4) =       0.000426323084
  error estimate for blocks of size 2^( 5) =       0.000430434012
  error estimate for blocks of size 2^( 6) =       0.000430904407
  error estimate for blocks of size 2^( 7) =       0.000431705264

      target function =                  N/A
              le_mean =     -17.217183076816
             les_mean =     296.753262752235
             stat err =       0.000429841692
             autocorr =       1.148065911905
              std dev =       0.567335714169
             le_variance =       0.321869812572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321468946550
                                         uncertainty =       0.004798911984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321468946550
                                         uncertainty =       0.004798911984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400898236
  error estimate for blocks of size 2^( 2) =       0.000410687059
  error estimate for blocks of size 2^( 3) =       0.000419227014
  error estimate for blocks of size 2^( 4) =       0.000426080424
  error estimate for blocks of size 2^( 5) =       0.000430195231
  error estimate for blocks of size 2^( 6) =       0.000430663542
  error estimate for blocks of size 2^( 7) =       0.000431447306

      target function =                  N/A
              le_mean =     -17.217182557184
             les_mean =     296.752813837932
             stat err =       0.000429596626
             autocorr =       1.148294892511
              std dev =       0.566955722474
             le_variance =       0.321438791246


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217183375741        initial
     3.9062e-02     3.9062e-01             4.1284e-03       -17.217183509016  <--
     1.5625e-01     1.5625e+00             1.3025e-03       -17.217183076816
     6.2500e-01     6.2500e+00             3.6127e-04       -17.217182557184

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 4.6807e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.163493e-01 1 1  ON 0
 uu_1                 5.361185e-02 1 1  ON 1
 uu_2                -4.248857e-02 1 1  ON 2
 uu_3                -9.879516e-02 1 1  ON 3
 uu_4                -1.339500e-01 1 1  ON 4
 uu_5                -1.427564e-01 1 1  ON 5
 uu_6                -1.211370e-01 1 1  ON 6
 uu_7                -5.230230e-02 1 1  ON 7
 uu_8                 8.865629e-02 1 1  ON 8
 uu_9                 1.296412e-01 1 1  ON 9
 ud_0                 3.574828e-01 1 1  ON 10
 ud_1                 9.812511e-02 1 1  ON 11
 ud_2                -1.262826e-02 1 1  ON 12
 ud_3                -7.462188e-02 1 1  ON 13
 ud_4                -1.233130e-01 1 1  ON 14
 ud_5                -1.554344e-01 1 1  ON 15
 ud_6                -1.579719e-01 1 1  ON 16
 ud_7                -1.141617e-01 1 1  ON 17
 ud_8                -1.104055e-02 1 1  ON 18
 ud_9                 9.227351e-02 1 1  ON 19
 eO_0                -7.959813e-01 1 1  ON 20
 eO_1                -4.722770e-01 1 1  ON 21
 eO_2                -5.716935e-02 1 1  ON 22
 eO_3                 2.068273e-01 1 1  ON 23
 eO_4                 3.136906e-01 1 1  ON 24
 eO_5                 3.369308e-01 1 1  ON 25
 eO_6                 2.714757e-01 1 1  ON 26
 eO_7                 1.340869e-01 1 1  ON 27
 eO_8                 3.167644e-02 1 1  ON 28
 eO_9                 1.942066e-02 1 1  ON 29
eH1_0                -1.846556e-01 1 1  ON 30
eH1_1                -1.059939e-01 1 1  ON 31
eH1_2                -6.372749e-02 1 1  ON 32
eH1_3                -2.669076e-02 1 1  ON 33
eH1_4                 1.848407e-02 1 1  ON 34
eH1_5                 3.104271e-02 1 1  ON 35
eH1_6                 7.633827e-02 1 1  ON 36
eH1_7                 1.084102e-01 1 1  ON 37
eH1_8                 1.024989e-01 1 1  ON 38
eH1_9                 2.793299e-02 1 1  ON 39
eH2_0                -1.863403e-01 1 1  ON 40
eH2_1                -1.067854e-01 1 1  ON 41
eH2_2                -6.499888e-02 1 1  ON 42
eH2_3                -2.793959e-02 1 1  ON 43
eH2_4                 1.790280e-02 1 1  ON 44
eH2_5                 3.081264e-02 1 1  ON 45
eH2_6                 7.517563e-02 1 1  ON 46
eH2_7                 1.128068e-01 1 1  ON 47
eH2_8                 1.063648e-01 1 1  ON 48
eH2_9                 2.987307e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9304e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2688
    reference variance = 0.377951
====================================================
  Execution time = 3.2285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110876838
                                         uncertainty =       0.004218867597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110876838
                                         uncertainty =       0.004218867597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398842710
  error estimate for blocks of size 2^( 2) =       0.000408798986
  error estimate for blocks of size 2^( 3) =       0.000417043669
  error estimate for blocks of size 2^( 4) =       0.000423277550
  error estimate for blocks of size 2^( 5) =       0.000428276936
  error estimate for blocks of size 2^( 6) =       0.000430251794
  error estimate for blocks of size 2^( 7) =       0.000429742615

      target function =                  N/A
              le_mean =     -17.216719473091
             les_mean =     296.733580270403
             stat err =       0.000427887224
             autocorr =       1.150946989824
              std dev =       0.564048769489
             le_variance =       0.318151014362


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671947309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719473091       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719034485       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216720317656       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216720178346       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722189925       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216724754206       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216725254822       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216728215827       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216728059867       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216725646622       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216729718897       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216729339407       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216732070628       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216734631805       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216735633744       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216736039987       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216734833875       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216735197855       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216735357346       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.425787e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719473091       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719072276       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216720269721       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216719897928       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216721505970       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216723633648       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216723675304       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216724847313       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216723989173       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216723194334       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216724001605       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216723861109       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216724412484       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 3.429433e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719473091       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719175008       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216719932444       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216719624119       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216720503211       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216721593273       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216721341187       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216721327072       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216721067213       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216721101087       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 8.568858e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268123 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1314e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.168197e-01 1 1  ON 0
 uu_1                 5.408988e-02 1 1  ON 1
 uu_2                -4.209719e-02 1 1  ON 2
 uu_3                -9.862779e-02 1 1  ON 3
 uu_4                -1.341598e-01 1 1  ON 4
 uu_5                -1.434356e-01 1 1  ON 5
 uu_6                -1.223268e-01 1 1  ON 6
 uu_7                -5.276493e-02 1 1  ON 7
 uu_8                 8.725867e-02 1 1  ON 8
 uu_9                 1.307686e-01 1 1  ON 9
 ud_0                 3.578667e-01 1 1  ON 10
 ud_1                 9.864642e-02 1 1  ON 11
 ud_2                -1.228290e-02 1 1  ON 12
 ud_3                -7.424738e-02 1 1  ON 13
 ud_4                -1.226780e-01 1 1  ON 14
 ud_5                -1.551188e-01 1 1  ON 15
 ud_6                -1.578091e-01 1 1  ON 16
 ud_7                -1.152763e-01 1 1  ON 17
 ud_8                -1.356979e-02 1 1  ON 18
 ud_9                 9.192338e-02 1 1  ON 19
 eO_0                -7.990496e-01 1 1  ON 20
 eO_1                -4.751256e-01 1 1  ON 21
 eO_2                -5.962790e-02 1 1  ON 22
 eO_3                 2.054807e-01 1 1  ON 23
 eO_4                 3.134143e-01 1 1  ON 24
 eO_5                 3.394015e-01 1 1  ON 25
 eO_6                 2.748683e-01 1 1  ON 26
 eO_7                 1.375164e-01 1 1  ON 27
 eO_8                 3.218924e-02 1 1  ON 28
 eO_9                 1.955327e-02 1 1  ON 29
eH1_0                -1.854398e-01 1 1  ON 30
eH1_1                -1.059918e-01 1 1  ON 31
eH1_2                -6.404332e-02 1 1  ON 32
eH1_3                -2.667390e-02 1 1  ON 33
eH1_4                 1.888824e-02 1 1  ON 34
eH1_5                 3.087081e-02 1 1  ON 35
eH1_6                 7.516959e-02 1 1  ON 36
eH1_7                 1.078431e-01 1 1  ON 37
eH1_8                 1.041783e-01 1 1  ON 38
eH1_9                 2.870698e-02 1 1  ON 39
eH2_0                -1.858782e-01 1 1  ON 40
eH2_1                -1.073258e-01 1 1  ON 41
eH2_2                -6.516330e-02 1 1  ON 42
eH2_3                -2.833338e-02 1 1  ON 43
eH2_4                 1.714531e-02 1 1  ON 44
eH2_5                 2.954978e-02 1 1  ON 45
eH2_6                 7.561784e-02 1 1  ON 46
eH2_7                 1.127887e-01 1 1  ON 47
eH2_8                 1.080649e-01 1 1  ON 48
eH2_9                 3.029355e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2797
    reference variance = 0.198177
====================================================
  Execution time = 3.2168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2242e-01
  Total weights = 2.0000e+06
  Execution time = 3.0002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322394312612
                                         uncertainty =       0.003715390102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322394312612
                                         uncertainty =       0.003715390102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401474981
  error estimate for blocks of size 2^( 2) =       0.000411211838
  error estimate for blocks of size 2^( 3) =       0.000419935335
  error estimate for blocks of size 2^( 4) =       0.000426423388
  error estimate for blocks of size 2^( 5) =       0.000430060105
  error estimate for blocks of size 2^( 6) =       0.000432701880
  error estimate for blocks of size 2^( 7) =       0.000432009129

      target function =                  N/A
              le_mean =     -17.216609262565
             les_mean =     296.733998659125
             stat err =       0.000430298625
             autocorr =       1.148743178543
              std dev =       0.567771362848
             le_variance =       0.322364320470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322659502769
                                         uncertainty =       0.003717599608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322659502769
                                         uncertainty =       0.003717599608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401640026
  error estimate for blocks of size 2^( 2) =       0.000411359259
  error estimate for blocks of size 2^( 3) =       0.000420063275
  error estimate for blocks of size 2^( 4) =       0.000426529573
  error estimate for blocks of size 2^( 5) =       0.000430149707
  error estimate for blocks of size 2^( 6) =       0.000432788081
  error estimate for blocks of size 2^( 7) =       0.000432087391

      target function =                  N/A
              le_mean =     -17.216614776264
             les_mean =     296.734453614091
             stat err =       0.000430388688
             autocorr =       1.148279794495
              std dev =       0.568004772114
             le_variance =       0.322629421144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322517493741
                                         uncertainty =       0.003716792108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322517493741
                                         uncertainty =       0.003716792108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401551553
  error estimate for blocks of size 2^( 2) =       0.000411275552
  error estimate for blocks of size 2^( 3) =       0.000419987263
  error estimate for blocks of size 2^( 4) =       0.000426460983
  error estimate for blocks of size 2^( 5) =       0.000430085470
  error estimate for blocks of size 2^( 6) =       0.000432726829
  error estimate for blocks of size 2^( 7) =       0.000432025185

      target function =                  N/A
              le_mean =     -17.216613448231
             les_mean =     296.734265764088
             stat err =       0.000430324617
             autocorr =       1.148443836724
              std dev =       0.567879652322
             le_variance =       0.322487299521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322394553464
                                         uncertainty =       0.003716052689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322394553464
                                         uncertainty =       0.003716052689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401475083
  error estimate for blocks of size 2^( 2) =       0.000411208714
  error estimate for blocks of size 2^( 3) =       0.000419930388
  error estimate for blocks of size 2^( 4) =       0.000426416000
  error estimate for blocks of size 2^( 5) =       0.000430050473
  error estimate for blocks of size 2^( 6) =       0.000432691934
  error estimate for blocks of size 2^( 7) =       0.000431995845

      target function =                  N/A
              le_mean =     -17.216609069566
             les_mean =     296.733992177342
             stat err =       0.000430288563
             autocorr =       1.148688869148
              std dev =       0.567771507076
             le_variance =       0.322364484247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216609262565        initial
     9.7656e-03     9.7656e-02             1.4258e-02       -17.216614776264  <--
     3.9062e-02     3.9062e-01             3.4294e-03       -17.216613448231
     1.5625e-01     1.5625e+00             8.5689e-04       -17.216609069566

*****************************************************************************
Applying the update for shift_i =   9.7656e-03     and shift_s =   9.7656e-02
*****************************************************************************

  Execution time = 4.7298e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.172449e-01 1 1  ON 0
 uu_1                 5.443376e-02 1 1  ON 1
 uu_2                -4.187021e-02 1 1  ON 2
 uu_3                -9.861392e-02 1 1  ON 3
 uu_4                -1.343697e-01 1 1  ON 4
 uu_5                -1.442494e-01 1 1  ON 5
 uu_6                -1.240965e-01 1 1  ON 6
 uu_7                -5.448291e-02 1 1  ON 7
 uu_8                 8.329688e-02 1 1  ON 8
 uu_9                 1.342062e-01 1 1  ON 9
 ud_0                 3.592565e-01 1 1  ON 10
 ud_1                 9.999565e-02 1 1  ON 11
 ud_2                -1.106580e-02 1 1  ON 12
 ud_3                -7.319151e-02 1 1  ON 13
 ud_4                -1.218233e-01 1 1  ON 14
 ud_5                -1.547769e-01 1 1  ON 15
 ud_6                -1.585532e-01 1 1  ON 16
 ud_7                -1.169341e-01 1 1  ON 17
 ud_8                -2.008416e-02 1 1  ON 18
 ud_9                 9.080331e-02 1 1  ON 19
 eO_0                -8.064412e-01 1 1  ON 20
 eO_1                -4.822154e-01 1 1  ON 21
 eO_2                -6.580870e-02 1 1  ON 22
 eO_3                 2.007443e-01 1 1  ON 23
 eO_4                 3.110095e-01 1 1  ON 24
 eO_5                 3.438878e-01 1 1  ON 25
 eO_6                 2.850880e-01 1 1  ON 26
 eO_7                 1.483448e-01 1 1  ON 27
 eO_8                 3.386779e-02 1 1  ON 28
 eO_9                 1.996071e-02 1 1  ON 29
eH1_0                -1.864729e-01 1 1  ON 30
eH1_1                -1.066924e-01 1 1  ON 31
eH1_2                -6.473522e-02 1 1  ON 32
eH1_3                -2.720691e-02 1 1  ON 33
eH1_4                 1.839757e-02 1 1  ON 34
eH1_5                 3.062612e-02 1 1  ON 35
eH1_6                 7.269577e-02 1 1  ON 36
eH1_7                 1.060517e-01 1 1  ON 37
eH1_8                 1.093076e-01 1 1  ON 38
eH1_9                 3.112488e-02 1 1  ON 39
eH2_0                -1.865781e-01 1 1  ON 40
eH2_1                -1.083579e-01 1 1  ON 41
eH2_2                -6.606695e-02 1 1  ON 42
eH2_3                -2.922085e-02 1 1  ON 43
eH2_4                 1.613447e-02 1 1  ON 44
eH2_5                 2.841754e-02 1 1  ON 45
eH2_6                 7.473708e-02 1 1  ON 46
eH2_7                 1.123699e-01 1 1  ON 47
eH2_8                 1.133529e-01 1 1  ON 48
eH2_9                 3.162535e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8655e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2689
    reference variance = 0.175655
====================================================
  Execution time = 3.2222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1909e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319164659133
                                         uncertainty =       0.002954289340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319164659133
                                         uncertainty =       0.002954289340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399428418
  error estimate for blocks of size 2^( 2) =       0.000408913345
  error estimate for blocks of size 2^( 3) =       0.000417606038
  error estimate for blocks of size 2^( 4) =       0.000423726075
  error estimate for blocks of size 2^( 5) =       0.000428006024
  error estimate for blocks of size 2^( 6) =       0.000430848803
  error estimate for blocks of size 2^( 7) =       0.000431485251

      target function =                  N/A
              le_mean =     -17.216403509114
             les_mean =     296.723635751133
             stat err =       0.000428516538
             autocorr =       1.150952115493
              std dev =       0.564877085777
             le_variance =       0.319086122036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640350911e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-03, overlap shift 2.4414e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216403509114       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216403434227       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216404513528       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216407604406       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216409428172       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216414497986       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216419212387       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216416086520       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216414095722       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216418861557       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216421580765       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216423518209       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216427280177       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216432500178       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216431566159       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216433235174       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216434474675       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216434986361       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216437793732       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216437410566       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216436347505       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216436721224       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216435596892       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216435694095       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-03 is 5.495975e-02

solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216403509114       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216403436369       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216404520310       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216407433334       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216409110801       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216413877582       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216417995979       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216414816236       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216413068136       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216416210089       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216417214079       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216417308441       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216418759204       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216420089785       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216419134734       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216419425486       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216419769890       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216419725118       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216420157631       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216419873076       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.394039e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216403509114       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216403443835       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216404547696       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216406873753       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216408131000       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216411995473       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216414557627       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216411645262       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216410647915       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216411709416       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216411847532       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216411630441       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 3.185687e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1220e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.170833e-01 1 1  ON 0
 uu_1                 5.409115e-02 1 1  ON 1
 uu_2                -4.219095e-02 1 1  ON 2
 uu_3                -9.906982e-02 1 1  ON 3
 uu_4                -1.349971e-01 1 1  ON 4
 uu_5                -1.450910e-01 1 1  ON 5
 uu_6                -1.256468e-01 1 1  ON 6
 uu_7                -5.786663e-02 1 1  ON 7
 uu_8                 7.682880e-02 1 1  ON 8
 uu_9                 1.390629e-01 1 1  ON 9
 ud_0                 3.606669e-01 1 1  ON 10
 ud_1                 1.013796e-01 1 1  ON 11
 ud_2                -9.834039e-03 1 1  ON 12
 ud_3                -7.243053e-02 1 1  ON 13
 ud_4                -1.214492e-01 1 1  ON 14
 ud_5                -1.552629e-01 1 1  ON 15
 ud_6                -1.598614e-01 1 1  ON 16
 ud_7                -1.175721e-01 1 1  ON 17
 ud_8                -2.774630e-02 1 1  ON 18
 ud_9                 8.868331e-02 1 1  ON 19
 eO_0                -8.145358e-01 1 1  ON 20
 eO_1                -4.903152e-01 1 1  ON 21
 eO_2                -7.370766e-02 1 1  ON 22
 eO_3                 1.949992e-01 1 1  ON 23
 eO_4                 3.084783e-01 1 1  ON 24
 eO_5                 3.481997e-01 1 1  ON 25
 eO_6                 2.950755e-01 1 1  ON 26
 eO_7                 1.622852e-01 1 1  ON 27
 eO_8                 3.629161e-02 1 1  ON 28
 eO_9                 2.050168e-02 1 1  ON 29
eH1_0                -1.875128e-01 1 1  ON 30
eH1_1                -1.089830e-01 1 1  ON 31
eH1_2                -6.730682e-02 1 1  ON 32
eH1_3                -2.956334e-02 1 1  ON 33
eH1_4                 1.624588e-02 1 1  ON 34
eH1_5                 2.858646e-02 1 1  ON 35
eH1_6                 7.246057e-02 1 1  ON 36
eH1_7                 1.070497e-01 1 1  ON 37
eH1_8                 1.174612e-01 1 1  ON 38
eH1_9                 3.399654e-02 1 1  ON 39
eH2_0                -1.873390e-01 1 1  ON 40
eH2_1                -1.081149e-01 1 1  ON 41
eH2_2                -6.654506e-02 1 1  ON 42
eH2_3                -2.883148e-02 1 1  ON 43
eH2_4                 1.764601e-02 1 1  ON 44
eH2_5                 3.013599e-02 1 1  ON 45
eH2_6                 7.057972e-02 1 1  ON 46
eH2_7                 1.060192e-01 1 1  ON 47
eH2_8                 1.179233e-01 1 1  ON 48
eH2_9                 3.382271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2142
    reference variance = 0.160993
====================================================
  Execution time = 3.1562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2418e-01
  Total weights = 2.0000e+06
  Execution time = 2.9987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323755999898
                                         uncertainty =       0.004913261122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323755999898
                                         uncertainty =       0.004913261122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402429756
  error estimate for blocks of size 2^( 2) =       0.000411923002
  error estimate for blocks of size 2^( 3) =       0.000421066397
  error estimate for blocks of size 2^( 4) =       0.000428307874
  error estimate for blocks of size 2^( 5) =       0.000431534411
  error estimate for blocks of size 2^( 6) =       0.000434578859
  error estimate for blocks of size 2^( 7) =       0.000437661471

      target function =                  N/A
              le_mean =     -17.216900461668
             les_mean =     296.745560761951
             stat err =       0.000433020654
             autocorr =       1.157809350127
              std dev =       0.569121618739
             le_variance =       0.323899416916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324422153064
                                         uncertainty =       0.004916011297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324422153064
                                         uncertainty =       0.004916011297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402844460
  error estimate for blocks of size 2^( 2) =       0.000412310917
  error estimate for blocks of size 2^( 3) =       0.000421402032
  error estimate for blocks of size 2^( 4) =       0.000428590978
  error estimate for blocks of size 2^( 5) =       0.000431787824
  error estimate for blocks of size 2^( 6) =       0.000434792136
  error estimate for blocks of size 2^( 7) =       0.000437842480

      target function =                  N/A
              le_mean =     -17.216903917959
             les_mean =     296.746347675982
             stat err =       0.000433253355
             autocorr =       1.156668948353
              std dev =       0.569708098962
             le_variance =       0.324567318023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324349908195
                                         uncertainty =       0.004913584741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324349908195
                                         uncertainty =       0.004913584741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402799233
  error estimate for blocks of size 2^( 2) =       0.000412278084
  error estimate for blocks of size 2^( 3) =       0.000421386588
  error estimate for blocks of size 2^( 4) =       0.000428596053
  error estimate for blocks of size 2^( 5) =       0.000431802299
  error estimate for blocks of size 2^( 6) =       0.000434807864
  error estimate for blocks of size 2^( 7) =       0.000437847181

      target function =                  N/A
              le_mean =     -17.216903765705
             les_mean =     296.746269559679
             stat err =       0.000433263349
             autocorr =       1.156982086702
              std dev =       0.569644138364
             le_variance =       0.324494444372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323931540547
                                         uncertainty =       0.004913597099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323931540547
                                         uncertainty =       0.004913597099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402538901
  error estimate for blocks of size 2^( 2) =       0.000412028901
  error estimate for blocks of size 2^( 3) =       0.000421163364
  error estimate for blocks of size 2^( 4) =       0.000428397430
  error estimate for blocks of size 2^( 5) =       0.000431620144
  error estimate for blocks of size 2^( 6) =       0.000434653064
  error estimate for blocks of size 2^( 7) =       0.000437718697

      target function =                  N/A
              le_mean =     -17.216898534153
             les_mean =     296.745670107720
             stat err =       0.000433097334
             autocorr =       1.157591438842
              std dev =       0.569275973884
             le_variance =       0.324075134441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216900461668        initial
     2.4414e-03     2.4414e-02             5.4960e-02       -17.216903917959  <--
     9.7656e-03     9.7656e-02             1.3940e-02       -17.216903765705
     3.9062e-02     3.9062e-01             3.1857e-03       -17.216898534153

*****************************************************************************
Applying the update for shift_i =   2.4414e-03     and shift_s =   2.4414e-02
*****************************************************************************

  Execution time = 4.6674e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.157549e-01 1 1  ON 0
 uu_1                 5.274325e-02 1 1  ON 1
 uu_2                -4.372659e-02 1 1  ON 2
 uu_3                -1.009114e-01 1 1  ON 3
 uu_4                -1.373205e-01 1 1  ON 4
 uu_5                -1.483076e-01 1 1  ON 5
 uu_6                -1.306203e-01 1 1  ON 6
 uu_7                -6.524423e-02 1 1  ON 7
 uu_8                 6.044679e-02 1 1  ON 8
 uu_9                 1.524320e-01 1 1  ON 9
 ud_0                 3.630955e-01 1 1  ON 10
 ud_1                 1.037091e-01 1 1  ON 11
 ud_2                -7.710579e-03 1 1  ON 12
 ud_3                -7.071157e-02 1 1  ON 13
 ud_4                -1.203435e-01 1 1  ON 14
 ud_5                -1.551521e-01 1 1  ON 15
 ud_6                -1.621506e-01 1 1  ON 16
 ud_7                -1.221934e-01 1 1  ON 17
 ud_8                -4.486113e-02 1 1  ON 18
 ud_9                 8.264619e-02 1 1  ON 19
 eO_0                -8.346084e-01 1 1  ON 20
 eO_1                -5.099133e-01 1 1  ON 21
 eO_2                -9.196336e-02 1 1  ON 22
 eO_3                 1.796236e-01 1 1  ON 23
 eO_4                 2.987467e-01 1 1  ON 24
 eO_5                 3.514055e-01 1 1  ON 25
 eO_6                 3.213064e-01 1 1  ON 26
 eO_7                 2.033045e-01 1 1  ON 27
 eO_8                 4.397677e-02 1 1  ON 28
 eO_9                 2.204177e-02 1 1  ON 29
eH1_0                -1.922194e-01 1 1  ON 30
eH1_1                -1.138877e-01 1 1  ON 31
eH1_2                -7.217093e-02 1 1  ON 32
eH1_3                -3.412811e-02 1 1  ON 33
eH1_4                 1.179633e-02 1 1  ON 34
eH1_5                 2.526046e-02 1 1  ON 35
eH1_6                 6.526132e-02 1 1  ON 36
eH1_7                 1.072405e-01 1 1  ON 37
eH1_8                 1.406996e-01 1 1  ON 38
eH1_9                 4.259134e-02 1 1  ON 39
eH2_0                -1.879243e-01 1 1  ON 40
eH2_1                -1.085703e-01 1 1  ON 41
eH2_2                -6.706849e-02 1 1  ON 42
eH2_3                -2.899056e-02 1 1  ON 43
eH2_4                 1.782423e-02 1 1  ON 44
eH2_5                 3.003238e-02 1 1  ON 45
eH2_6                 6.663351e-02 1 1  ON 46
eH2_7                 8.929043e-02 1 1  ON 47
eH2_8                 1.305805e-01 1 1  ON 48
eH2_9                 4.023053e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2475
    reference variance = 0.262815
====================================================
  Execution time = 3.2212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2485e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324794872985
                                         uncertainty =       0.004316167454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324794872985
                                         uncertainty =       0.004316167454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403020927
  error estimate for blocks of size 2^( 2) =       0.000412220256
  error estimate for blocks of size 2^( 3) =       0.000420488745
  error estimate for blocks of size 2^( 4) =       0.000426094877
  error estimate for blocks of size 2^( 5) =       0.000429048471
  error estimate for blocks of size 2^( 6) =       0.000430468940
  error estimate for blocks of size 2^( 7) =       0.000433006523

      target function =                  N/A
              le_mean =     -17.217124003624
             les_mean =     296.754210528266
             stat err =       0.000429654703
             autocorr =       1.136537959019
              std dev =       0.569957660278
             le_variance =       0.324851734510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712400362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-04, overlap shift 6.1035e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217124003624       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217124258668       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217124252728       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217126397373       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217132578384       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217133186255       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217133613377       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217133750556       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217134872581       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217133100556       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217133461375       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217142743131       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217144725917       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217145207167       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217147786663       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217145625227       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217144822682       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217149712853       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217150487021       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217156039897       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217161677046       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217162142809       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217160439286       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217165172486       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217165658783       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.217166265110       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.217167486394       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.217170133926       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.217169639209       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-04 is 1.949991e-01

solving harmonic davidson linear method for identity shift 2.4414e-03, overlap shift 2.4414e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217124003624       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217124255515       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217124236949       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217126346525       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217132459320       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217133067141       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217133455661       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217133573040       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217134627124       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217132896450       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217133217456       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217140799553       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217142101205       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217142296533       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217143577081       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217141800875       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217140799038       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217143645356       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217143833407       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217145830981       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217147882646       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217147475439       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217146441205       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217147813831       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217147639371       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-03 is 4.958390e-02

solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217124003624       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217124243644       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217124179059       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217126156783       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217132015403       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217132621266       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217132873324       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217132921975       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217133751490       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217132192565       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217132438957       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217136542427       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217136871612       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217136867451       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217137049669       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217136294745       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217135616364       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217136490007       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217136574883       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217136849594       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.268139e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1237e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.142961e-01 1 1  ON 0
 uu_1                 5.070307e-02 1 1  ON 1
 uu_2                -4.580840e-02 1 1  ON 2
 uu_3                -1.026693e-01 1 1  ON 3
 uu_4                -1.387728e-01 1 1  ON 4
 uu_5                -1.498679e-01 1 1  ON 5
 uu_6                -1.354747e-01 1 1  ON 6
 uu_7                -7.825799e-02 1 1  ON 7
 uu_8                 4.791154e-02 1 1  ON 8
 uu_9                 1.680667e-01 1 1  ON 9
 ud_0                 3.610314e-01 1 1  ON 10
 ud_1                 1.014770e-01 1 1  ON 11
 ud_2                -9.910102e-03 1 1  ON 12
 ud_3                -7.261417e-02 1 1  ON 13
 ud_4                -1.224608e-01 1 1  ON 14
 ud_5                -1.572709e-01 1 1  ON 15
 ud_6                -1.664107e-01 1 1  ON 16
 ud_7                -1.292534e-01 1 1  ON 17
 ud_8                -4.086835e-02 1 1  ON 18
 ud_9                 8.507531e-02 1 1  ON 19
 eO_0                -8.478465e-01 1 1  ON 20
 eO_1                -5.228714e-01 1 1  ON 21
 eO_2                -1.049692e-01 1 1  ON 22
 eO_3                 1.658830e-01 1 1  ON 23
 eO_4                 2.821464e-01 1 1  ON 24
 eO_5                 3.401541e-01 1 1  ON 25
 eO_6                 3.343050e-01 1 1  ON 26
 eO_7                 2.528884e-01 1 1  ON 27
 eO_8                 5.717146e-02 1 1  ON 28
 eO_9                 2.561587e-02 1 1  ON 29
eH1_0                -1.959284e-01 1 1  ON 30
eH1_1                -1.155702e-01 1 1  ON 31
eH1_2                -7.333059e-02 1 1  ON 32
eH1_3                -3.643293e-02 1 1  ON 33
eH1_4                 9.338570e-03 1 1  ON 34
eH1_5                 2.231323e-02 1 1  ON 35
eH1_6                 6.091181e-02 1 1  ON 36
eH1_7                 8.992652e-02 1 1  ON 37
eH1_8                 1.618565e-01 1 1  ON 38
eH1_9                 5.269775e-02 1 1  ON 39
eH2_0                -1.930145e-01 1 1  ON 40
eH2_1                -1.140760e-01 1 1  ON 41
eH2_2                -7.197059e-02 1 1  ON 42
eH2_3                -3.406621e-02 1 1  ON 43
eH2_4                 1.130364e-02 1 1  ON 44
eH2_5                 2.392230e-02 1 1  ON 45
eH2_6                 7.138316e-02 1 1  ON 46
eH2_7                 8.437268e-02 1 1  ON 47
eH2_8                 1.514768e-01 1 1  ON 48
eH2_9                 4.993371e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2437
    reference variance = 0.426234
====================================================
  Execution time = 3.2733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1783e-01
  Total weights = 2.0000e+06
  Execution time = 2.9932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317829624978
                                         uncertainty =       0.003328917784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317829624978
                                         uncertainty =       0.003328917784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398655452
  error estimate for blocks of size 2^( 2) =       0.000408340917
  error estimate for blocks of size 2^( 3) =       0.000416818017
  error estimate for blocks of size 2^( 4) =       0.000423314806
  error estimate for blocks of size 2^( 5) =       0.000427142743
  error estimate for blocks of size 2^( 6) =       0.000427926689
  error estimate for blocks of size 2^( 7) =       0.000428000572

      target function =                  N/A
              le_mean =     -17.217267587789
             les_mean =     296.752155369148
             stat err =       0.000426596203
             autocorr =       1.145087187448
              std dev =       0.563783946683
             le_variance =       0.317852338537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318268914555
                                         uncertainty =       0.003330050411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318268914555
                                         uncertainty =       0.003330050411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398930923
  error estimate for blocks of size 2^( 2) =       0.000408600864
  error estimate for blocks of size 2^( 3) =       0.000417050426
  error estimate for blocks of size 2^( 4) =       0.000423499286
  error estimate for blocks of size 2^( 5) =       0.000427289325
  error estimate for blocks of size 2^( 6) =       0.000427993277
  error estimate for blocks of size 2^( 7) =       0.000428159696

      target function =                  N/A
              le_mean =     -17.217300794889
             les_mean =     296.753738265589
             stat err =       0.000426735396
             autocorr =       1.144252658857
              std dev =       0.564173522097
             le_variance =       0.318291763036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868622223
                                         uncertainty =       0.003328813214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868622223
                                         uncertainty =       0.003328813214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398679928
  error estimate for blocks of size 2^( 2) =       0.000408357713
  error estimate for blocks of size 2^( 3) =       0.000416839224
  error estimate for blocks of size 2^( 4) =       0.000423331779
  error estimate for blocks of size 2^( 5) =       0.000427134789
  error estimate for blocks of size 2^( 6) =       0.000427864064
  error estimate for blocks of size 2^( 7) =       0.000428033194

      target function =                  N/A
              le_mean =     -17.217272901527
             les_mean =     296.752377376229
             stat err =       0.000426590957
             autocorr =       1.144918432007
              std dev =       0.563818560827
             le_variance =       0.317891369533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317840198683
                                         uncertainty =       0.003329612815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317840198683
                                         uncertainty =       0.003329612815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398662076
  error estimate for blocks of size 2^( 2) =       0.000408342074
  error estimate for blocks of size 2^( 3) =       0.000416820999
  error estimate for blocks of size 2^( 4) =       0.000423322980
  error estimate for blocks of size 2^( 5) =       0.000427147315
  error estimate for blocks of size 2^( 6) =       0.000427922353
  error estimate for blocks of size 2^( 7) =       0.000428019524

      target function =                  N/A
              le_mean =     -17.217259253543
             les_mean =     296.751878947085
             stat err =       0.000426603043
             autocorr =       1.145085853551
              std dev =       0.563793315241
             le_variance =       0.317862902311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217267587789        initial
     6.1035e-04     6.1035e-03             1.9500e-01       -17.217300794889  <--
     2.4414e-03     2.4414e-02             4.9584e-02       -17.217272901527
     9.7656e-03     9.7656e-02             1.2681e-02       -17.217259253543

*****************************************************************************
Applying the update for shift_i =   6.1035e-04     and shift_s =   6.1035e-03
*****************************************************************************

  Execution time = 4.7827e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.093403e-01 1 1  ON 0
 uu_1                 4.516592e-02 1 1  ON 1
 uu_2                -5.159562e-02 1 1  ON 2
 uu_3                -1.087309e-01 1 1  ON 3
 uu_4                -1.452689e-01 1 1  ON 4
 uu_5                -1.577231e-01 1 1  ON 5
 uu_6                -1.474311e-01 1 1  ON 6
 uu_7                -1.019197e-01 1 1  ON 7
 uu_8                -9.549069e-04 1 1  ON 8
 uu_9                 2.082208e-01 1 1  ON 9
 ud_0                 3.596736e-01 1 1  ON 10
 ud_1                 9.998709e-02 1 1  ON 11
 ud_2                -1.155625e-02 1 1  ON 12
 ud_3                -7.439163e-02 1 1  ON 13
 ud_4                -1.248141e-01 1 1  ON 14
 ud_5                -1.605704e-01 1 1  ON 15
 ud_6                -1.727716e-01 1 1  ON 16
 ud_7                -1.431511e-01 1 1  ON 17
 ud_8                -6.364911e-02 1 1  ON 18
 ud_9                 8.341973e-02 1 1  ON 19
 eO_0                -8.942736e-01 1 1  ON 20
 eO_1                -5.684062e-01 1 1  ON 21
 eO_2                -1.490044e-01 1 1  ON 22
 eO_3                 1.246845e-01 1 1  ON 23
 eO_4                 2.459269e-01 1 1  ON 24
 eO_5                 3.269932e-01 1 1  ON 25
 eO_6                 3.575952e-01 1 1  ON 26
 eO_7                 3.983036e-01 1 1  ON 27
 eO_8                 9.882403e-02 1 1  ON 28
 eO_9                 3.716120e-02 1 1  ON 29
eH1_0                -2.040139e-01 1 1  ON 30
eH1_1                -1.223508e-01 1 1  ON 31
eH1_2                -7.982715e-02 1 1  ON 32
eH1_3                -4.331238e-02 1 1  ON 33
eH1_4                 2.350591e-03 1 1  ON 34
eH1_5                 1.406110e-02 1 1  ON 35
eH1_6                 4.524430e-02 1 1  ON 36
eH1_7                 4.468497e-02 1 1  ON 37
eH1_8                 2.203165e-01 1 1  ON 38
eH1_9                 8.337254e-02 1 1  ON 39
eH2_0                -2.047724e-01 1 1  ON 40
eH2_1                -1.257634e-01 1 1  ON 41
eH2_2                -8.324748e-02 1 1  ON 42
eH2_3                -4.526763e-02 1 1  ON 43
eH2_4                -3.118899e-04 1 1  ON 44
eH2_5                 1.116023e-02 1 1  ON 45
eH2_6                 6.408660e-02 1 1  ON 46
eH2_7                 6.369960e-02 1 1  ON 47
eH2_8                 2.107163e-01 1 1  ON 48
eH2_9                 7.992078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9269e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2226
    reference variance = 0.35053
====================================================
  Execution time = 3.2511e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1814e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318192243708
                                         uncertainty =       0.003352033257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318192243708
                                         uncertainty =       0.003352033257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398833786
  error estimate for blocks of size 2^( 2) =       0.000408378662
  error estimate for blocks of size 2^( 3) =       0.000417386296
  error estimate for blocks of size 2^( 4) =       0.000423134480
  error estimate for blocks of size 2^( 5) =       0.000427337578
  error estimate for blocks of size 2^( 6) =       0.000429205313
  error estimate for blocks of size 2^( 7) =       0.000431386372

      target function =                  N/A
              le_mean =     -17.217875813997
             les_mean =     296.773384164105
             stat err =       0.000427765936
             autocorr =       1.150346071286
              std dev =       0.564036148612
             le_variance =       0.318136776941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721787581400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-04, overlap shift 1.5259e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217875813997       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217874610027       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217879476111       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217881392276       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217884960428       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217884982125       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217887143242       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217887264357       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217889738116       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217896198862       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217900721994       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217895878747       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217899484214       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217897482667       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217896959659       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217896764732       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217895165750       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217894430596       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217894724324       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217895533079       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217896437044       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217895652552       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217894908631       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217895860861       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217897654573       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.217896595007       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.217899809973       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.217898881333       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.217899689664       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-04 is 7.176711e-02

solving harmonic davidson linear method for identity shift 6.1035e-04, overlap shift 6.1035e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217875813997       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217874611956       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217879468575       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217881383242       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217884947738       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217884971844       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217887120837       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217887222574       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217889679338       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217896034562       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217900317412       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217895577551       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217899029719       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217897085848       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217896574560       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217896379860       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217894904164       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217894197631       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217894489621       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217895242460       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217895963325       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217895329340       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217894706506       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217895483007       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217896866180       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.217896031061       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.217897917971       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.217897230284       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-04 is 4.228445e-02

solving harmonic davidson linear method for identity shift 2.4414e-03, overlap shift 2.4414e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217875813997       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217874619610       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217879438687       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217881347370       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217884897476       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217884930979       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217887032669       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217887059502       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217889454135       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217895410990       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217898844936       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217894518371       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217897448180       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217895707271       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217895251425       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217895068543       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217893965454       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217893375620       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217893649903       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217894231988       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217894542348       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217894245124       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217893891664       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-03 is 1.619475e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1493e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.020639e-01 1 1  ON 0
 uu_1                 3.961060e-02 1 1  ON 1
 uu_2                -5.709888e-02 1 1  ON 2
 uu_3                -1.145809e-01 1 1  ON 3
 uu_4                -1.515667e-01 1 1  ON 4
 uu_5                -1.636605e-01 1 1  ON 5
 uu_6                -1.501961e-01 1 1  ON 6
 uu_7                -9.724742e-02 1 1  ON 7
 uu_8                -2.099888e-04 1 1  ON 8
 uu_9                 1.905843e-01 1 1  ON 9
 ud_0                 3.645266e-01 1 1  ON 10
 ud_1                 1.054096e-01 1 1  ON 11
 ud_2                -6.076925e-03 1 1  ON 12
 ud_3                -6.901098e-02 1 1  ON 13
 ud_4                -1.190437e-01 1 1  ON 14
 ud_5                -1.554276e-01 1 1  ON 15
 ud_6                -1.654645e-01 1 1  ON 16
 ud_7                -1.397865e-01 1 1  ON 17
 ud_8                -8.409275e-02 1 1  ON 18
 ud_9                 4.113529e-02 1 1  ON 19
 eO_0                -8.979444e-01 1 1  ON 20
 eO_1                -5.719496e-01 1 1  ON 21
 eO_2                -1.523917e-01 1 1  ON 22
 eO_3                 1.218491e-01 1 1  ON 23
 eO_4                 2.451255e-01 1 1  ON 24
 eO_5                 3.189120e-01 1 1  ON 25
 eO_6                 3.292968e-01 1 1  ON 26
 eO_7                 4.209062e-01 1 1  ON 27
 eO_8                 1.201615e-01 1 1  ON 28
 eO_9                 4.110709e-02 1 1  ON 29
eH1_0                -2.070292e-01 1 1  ON 30
eH1_1                -1.283494e-01 1 1  ON 31
eH1_2                -8.570165e-02 1 1  ON 32
eH1_3                -4.775256e-02 1 1  ON 33
eH1_4                -2.047505e-03 1 1  ON 34
eH1_5                 9.582073e-03 1 1  ON 35
eH1_6                 5.752295e-02 1 1  ON 36
eH1_7                 6.056426e-02 1 1  ON 37
eH1_8                 2.089158e-01 1 1  ON 38
eH1_9                 9.167161e-02 1 1  ON 39
eH2_0                -2.046079e-01 1 1  ON 40
eH2_1                -1.249074e-01 1 1  ON 41
eH2_2                -8.299634e-02 1 1  ON 42
eH2_3                -4.564125e-02 1 1  ON 43
eH2_4                -7.550372e-04 1 1  ON 44
eH2_5                 9.082321e-03 1 1  ON 45
eH2_6                 5.034706e-02 1 1  ON 46
eH2_7                 5.716126e-02 1 1  ON 47
eH2_8                 2.136840e-01 1 1  ON 48
eH2_9                 9.010840e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.229
    reference variance = 0.197392
====================================================
  Execution time = 3.1935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3087e-01
  Total weights = 2.0000e+06
  Execution time = 2.9938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331617946653
                                         uncertainty =       0.006205296115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331617946653
                                         uncertainty =       0.006205296115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407148582
  error estimate for blocks of size 2^( 2) =       0.000416818763
  error estimate for blocks of size 2^( 3) =       0.000425587242
  error estimate for blocks of size 2^( 4) =       0.000431106449
  error estimate for blocks of size 2^( 5) =       0.000435531682
  error estimate for blocks of size 2^( 6) =       0.000436699439
  error estimate for blocks of size 2^( 7) =       0.000436961215

      target function =                  N/A
              le_mean =     -17.217124929246
             les_mean =     296.760930599298
             stat err =       0.000435074696
             autocorr =       1.141883502056
              std dev =       0.575795046692
             le_variance =       0.331539935795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330840622684
                                         uncertainty =       0.006213914598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330840622684
                                         uncertainty =       0.006213914598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406670937
  error estimate for blocks of size 2^( 2) =       0.000416350070
  error estimate for blocks of size 2^( 3) =       0.000425131774
  error estimate for blocks of size 2^( 4) =       0.000430667367
  error estimate for blocks of size 2^( 5) =       0.000435095652
  error estimate for blocks of size 2^( 6) =       0.000436285593
  error estimate for blocks of size 2^( 7) =       0.000436492617

      target function =                  N/A
              le_mean =     -17.217088242088
             les_mean =     296.758889873259
             stat err =       0.000434635307
             autocorr =       1.142256746334
              std dev =       0.575119555228
             le_variance =       0.330762502806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330460301609
                                         uncertainty =       0.006226624120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330460301609
                                         uncertainty =       0.006226624120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406436998
  error estimate for blocks of size 2^( 2) =       0.000416140502
  error estimate for blocks of size 2^( 3) =       0.000424944690
  error estimate for blocks of size 2^( 4) =       0.000430511504
  error estimate for blocks of size 2^( 5) =       0.000434946709
  error estimate for blocks of size 2^( 6) =       0.000436145363
  error estimate for blocks of size 2^( 7) =       0.000436339476

      target function =                  N/A
              le_mean =     -17.217094980177
             les_mean =     296.758741457870
             stat err =       0.000434485763
             autocorr =       1.142785260780
              std dev =       0.574788714781
             le_variance =       0.330382066639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331077377714
                                         uncertainty =       0.006215607069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331077377714
                                         uncertainty =       0.006215607069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406816463
  error estimate for blocks of size 2^( 2) =       0.000416491888
  error estimate for blocks of size 2^( 3) =       0.000425263035
  error estimate for blocks of size 2^( 4) =       0.000430798136
  error estimate for blocks of size 2^( 5) =       0.000435223918
  error estimate for blocks of size 2^( 6) =       0.000436398080
  error estimate for blocks of size 2^( 7) =       0.000436646176

      target function =                  N/A
              le_mean =     -17.217091084248
             les_mean =     296.759224506957
             stat err =       0.000434766577
             autocorr =       1.142129270093
              std dev =       0.575325359408
             le_variance =       0.330999269178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217124929246        initial  <--
     1.5259e-04     1.5259e-03             7.1767e-02       -17.217088242088
     6.1035e-04     6.1035e-03             4.2284e-02       -17.217094980177
     2.4414e-03     2.4414e-02             1.6195e-02       -17.217091084248

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.9800
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.093403e-01 1 1  ON 0
 uu_1                 4.516592e-02 1 1  ON 1
 uu_2                -5.159562e-02 1 1  ON 2
 uu_3                -1.087309e-01 1 1  ON 3
 uu_4                -1.452689e-01 1 1  ON 4
 uu_5                -1.577231e-01 1 1  ON 5
 uu_6                -1.474311e-01 1 1  ON 6
 uu_7                -1.019197e-01 1 1  ON 7
 uu_8                -9.549069e-04 1 1  ON 8
 uu_9                 2.082208e-01 1 1  ON 9
 ud_0                 3.596736e-01 1 1  ON 10
 ud_1                 9.998709e-02 1 1  ON 11
 ud_2                -1.155625e-02 1 1  ON 12
 ud_3                -7.439163e-02 1 1  ON 13
 ud_4                -1.248141e-01 1 1  ON 14
 ud_5                -1.605704e-01 1 1  ON 15
 ud_6                -1.727716e-01 1 1  ON 16
 ud_7                -1.431511e-01 1 1  ON 17
 ud_8                -6.364911e-02 1 1  ON 18
 ud_9                 8.341973e-02 1 1  ON 19
 eO_0                -8.942736e-01 1 1  ON 20
 eO_1                -5.684062e-01 1 1  ON 21
 eO_2                -1.490044e-01 1 1  ON 22
 eO_3                 1.246845e-01 1 1  ON 23
 eO_4                 2.459269e-01 1 1  ON 24
 eO_5                 3.269932e-01 1 1  ON 25
 eO_6                 3.575952e-01 1 1  ON 26
 eO_7                 3.983036e-01 1 1  ON 27
 eO_8                 9.882403e-02 1 1  ON 28
 eO_9                 3.716120e-02 1 1  ON 29
eH1_0                -2.040139e-01 1 1  ON 30
eH1_1                -1.223508e-01 1 1  ON 31
eH1_2                -7.982715e-02 1 1  ON 32
eH1_3                -4.331238e-02 1 1  ON 33
eH1_4                 2.350591e-03 1 1  ON 34
eH1_5                 1.406110e-02 1 1  ON 35
eH1_6                 4.524430e-02 1 1  ON 36
eH1_7                 4.468497e-02 1 1  ON 37
eH1_8                 2.203165e-01 1 1  ON 38
eH1_9                 8.337254e-02 1 1  ON 39
eH2_0                -2.047724e-01 1 1  ON 40
eH2_1                -1.257634e-01 1 1  ON 41
eH2_2                -8.324748e-02 1 1  ON 42
eH2_3                -4.526763e-02 1 1  ON 43
eH2_4                -3.118899e-04 1 1  ON 44
eH2_5                 1.116023e-02 1 1  ON 45
eH2_6                 6.408660e-02 1 1  ON 46
eH2_7                 6.369960e-02 1 1  ON 47
eH2_8                 2.107163e-01 1 1  ON 48
eH2_9                 7.992078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8721e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2299
    reference variance = 0.185146
====================================================
  Execution time = 3.2311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1831e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318381729253
                                         uncertainty =       0.003780453910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318381729253
                                         uncertainty =       0.003780453910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398942506
  error estimate for blocks of size 2^( 2) =       0.000408679320
  error estimate for blocks of size 2^( 3) =       0.000416902699
  error estimate for blocks of size 2^( 4) =       0.000423181170
  error estimate for blocks of size 2^( 5) =       0.000427607020
  error estimate for blocks of size 2^( 6) =       0.000428515419
  error estimate for blocks of size 2^( 7) =       0.000430513802

      target function =                  N/A
              le_mean =     -17.216029079327
             les_mean =     296.709967346590
             stat err =       0.000427454353
             autocorr =       1.148044879582
              std dev =       0.564189901989
             le_variance =       0.318310245506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721602907933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216029079327       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216030363071       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216037425279       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216038558441       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216038820761       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216039906439       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216046157434       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216044195054       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216043353477       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216046971256       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216049547620       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216048415316       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216046868904       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216044540398       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216046584273       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216048311527       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216048087056       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216048743298       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216048352898       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216047659992       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216048363782       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216047485980       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216049911312       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216051092559       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216051422819       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-03 is 2.097829e-02

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216029079327       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216030320725       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216037194355       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216038225590       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216038403407       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216039350243       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216045198402       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216043164818       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216042420012       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216045667423       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216047467119       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216046443108       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216045116091       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216043480336       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216045080180       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216046007831       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216045847489       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216046122385       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216045845309       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216045515104       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 1.035260e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216029079327       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216030176020       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216036406340       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216037115733       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216037054666       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216037588887       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216042201611       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216040127038       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216039712384       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216041965237       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216042517647       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216041892968       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216041163873       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 4.427976e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346084 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1278e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.073756e-01 1 1  ON 0
 uu_1                 4.374145e-02 1 1  ON 1
 uu_2                -5.316289e-02 1 1  ON 2
 uu_3                -1.106568e-01 1 1  ON 3
 uu_4                -1.474106e-01 1 1  ON 4
 uu_5                -1.595319e-01 1 1  ON 5
 uu_6                -1.460210e-01 1 1  ON 6
 uu_7                -9.601076e-02 1 1  ON 7
 uu_8                -1.394835e-03 1 1  ON 8
 uu_9                 2.066991e-01 1 1  ON 9
 ud_0                 3.604315e-01 1 1  ON 10
 ud_1                 1.008657e-01 1 1  ON 11
 ud_2                -1.087336e-02 1 1  ON 12
 ud_3                -7.381464e-02 1 1  ON 13
 ud_4                -1.239487e-01 1 1  ON 14
 ud_5                -1.593126e-01 1 1  ON 15
 ud_6                -1.699730e-01 1 1  ON 16
 ud_7                -1.426361e-01 1 1  ON 17
 ud_8                -7.186123e-02 1 1  ON 18
 ud_9                 7.872734e-02 1 1  ON 19
 eO_0                -8.964273e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.497056e-01 1 1  ON 22
 eO_3                 1.246149e-01 1 1  ON 23
 eO_4                 2.500283e-01 1 1  ON 24
 eO_5                 3.252193e-01 1 1  ON 25
 eO_6                 3.531983e-01 1 1  ON 26
 eO_7                 4.011066e-01 1 1  ON 27
 eO_8                 1.013813e-01 1 1  ON 28
 eO_9                 3.820216e-02 1 1  ON 29
eH1_0                -2.030477e-01 1 1  ON 30
eH1_1                -1.237419e-01 1 1  ON 31
eH1_2                -8.173807e-02 1 1  ON 32
eH1_3                -4.455303e-02 1 1  ON 33
eH1_4                 8.048008e-04 1 1  ON 34
eH1_5                 1.139243e-02 1 1  ON 35
eH1_6                 4.987158e-02 1 1  ON 36
eH1_7                 4.760476e-02 1 1  ON 37
eH1_8                 2.188042e-01 1 1  ON 38
eH1_9                 8.400573e-02 1 1  ON 39
eH2_0                -2.034372e-01 1 1  ON 40
eH2_1                -1.236043e-01 1 1  ON 41
eH2_2                -8.156588e-02 1 1  ON 42
eH2_3                -4.466278e-02 1 1  ON 43
eH2_4                 8.467103e-04 1 1  ON 44
eH2_5                 1.162974e-02 1 1  ON 45
eH2_6                 5.373400e-02 1 1  ON 46
eH2_7                 6.393279e-02 1 1  ON 47
eH2_8                 2.111660e-01 1 1  ON 48
eH2_9                 8.148409e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1943
    reference variance = 0.204242
====================================================
  Execution time = 3.1878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3483e-01
  Total weights = 2.0000e+06
  Execution time = 2.9843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334736924993
                                         uncertainty =       0.009362101584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334736924993
                                         uncertainty =       0.009362101584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409051110
  error estimate for blocks of size 2^( 2) =       0.000418362462
  error estimate for blocks of size 2^( 3) =       0.000426589726
  error estimate for blocks of size 2^( 4) =       0.000433035457
  error estimate for blocks of size 2^( 5) =       0.000437717398
  error estimate for blocks of size 2^( 6) =       0.000439754378
  error estimate for blocks of size 2^( 7) =       0.000441298265

      target function =                  N/A
              le_mean =     -17.216990814060
             les_mean =     296.759418144531
             stat err =       0.000437951374
             autocorr =       1.146295630210
              std dev =       0.578485626820
             le_variance =       0.334645620438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334950521724
                                         uncertainty =       0.009373812168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334950521724
                                         uncertainty =       0.009373812168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409181804
  error estimate for blocks of size 2^( 2) =       0.000418477133
  error estimate for blocks of size 2^( 3) =       0.000426682435
  error estimate for blocks of size 2^( 4) =       0.000433097894
  error estimate for blocks of size 2^( 5) =       0.000437768106
  error estimate for blocks of size 2^( 6) =       0.000439790877
  error estimate for blocks of size 2^( 7) =       0.000441352011

      target function =                  N/A
              le_mean =     -17.216987689235
             les_mean =     296.759524420665
             stat err =       0.000438002222
             autocorr =       1.145829509876
              std dev =       0.578670456157
             le_variance =       0.334859496829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335176174626
                                         uncertainty =       0.009379113651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335176174626
                                         uncertainty =       0.009379113651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409319720
  error estimate for blocks of size 2^( 2) =       0.000418616000
  error estimate for blocks of size 2^( 3) =       0.000426821634
  error estimate for blocks of size 2^( 4) =       0.000433234070
  error estimate for blocks of size 2^( 5) =       0.000437895165
  error estimate for blocks of size 2^( 6) =       0.000439916649
  error estimate for blocks of size 2^( 7) =       0.000441489091

      target function =                  N/A
              le_mean =     -17.216998420560
             les_mean =     296.760119712690
             stat err =       0.000438133744
             autocorr =       1.145745255932
              std dev =       0.578865499622
             le_variance =       0.335085266652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334937286798
                                         uncertainty =       0.009370285874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334937286798
                                         uncertainty =       0.009370285874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409173562
  error estimate for blocks of size 2^( 2) =       0.000418472805
  error estimate for blocks of size 2^( 3) =       0.000426688005
  error estimate for blocks of size 2^( 4) =       0.000433118559
  error estimate for blocks of size 2^( 5) =       0.000437787221
  error estimate for blocks of size 2^( 6) =       0.000439815659
  error estimate for blocks of size 2^( 7) =       0.000441371809

      target function =                  N/A
              le_mean =     -17.216983636312
             les_mean =     296.759371372879
             stat err =       0.000438023312
             autocorr =       1.145986023135
              std dev =       0.578658800386
             le_variance =       0.334846007264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216990814060        initial
     1.5259e-03     1.5259e-02             2.0978e-02       -17.216987689235
     6.1035e-03     6.1035e-02             1.0353e-02       -17.216998420560  <--
     2.4414e-02     2.4414e-01             4.4280e-03       -17.216983636312

*****************************************************************************
Applying the update for shift_i =   6.1035e-03     and shift_s =   6.1035e-02
*****************************************************************************

  Execution time = 4.6925e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.073756e-01 1 1  ON 0
 uu_1                 4.374145e-02 1 1  ON 1
 uu_2                -5.316289e-02 1 1  ON 2
 uu_3                -1.106568e-01 1 1  ON 3
 uu_4                -1.474106e-01 1 1  ON 4
 uu_5                -1.595319e-01 1 1  ON 5
 uu_6                -1.460210e-01 1 1  ON 6
 uu_7                -9.601076e-02 1 1  ON 7
 uu_8                -1.394835e-03 1 1  ON 8
 uu_9                 2.066991e-01 1 1  ON 9
 ud_0                 3.604315e-01 1 1  ON 10
 ud_1                 1.008657e-01 1 1  ON 11
 ud_2                -1.087336e-02 1 1  ON 12
 ud_3                -7.381464e-02 1 1  ON 13
 ud_4                -1.239487e-01 1 1  ON 14
 ud_5                -1.593126e-01 1 1  ON 15
 ud_6                -1.699730e-01 1 1  ON 16
 ud_7                -1.426361e-01 1 1  ON 17
 ud_8                -7.186123e-02 1 1  ON 18
 ud_9                 7.872734e-02 1 1  ON 19
 eO_0                -8.964273e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.497056e-01 1 1  ON 22
 eO_3                 1.246149e-01 1 1  ON 23
 eO_4                 2.500283e-01 1 1  ON 24
 eO_5                 3.252193e-01 1 1  ON 25
 eO_6                 3.531983e-01 1 1  ON 26
 eO_7                 4.011066e-01 1 1  ON 27
 eO_8                 1.013813e-01 1 1  ON 28
 eO_9                 3.820216e-02 1 1  ON 29
eH1_0                -2.030477e-01 1 1  ON 30
eH1_1                -1.237419e-01 1 1  ON 31
eH1_2                -8.173807e-02 1 1  ON 32
eH1_3                -4.455303e-02 1 1  ON 33
eH1_4                 8.048008e-04 1 1  ON 34
eH1_5                 1.139243e-02 1 1  ON 35
eH1_6                 4.987158e-02 1 1  ON 36
eH1_7                 4.760476e-02 1 1  ON 37
eH1_8                 2.188042e-01 1 1  ON 38
eH1_9                 8.400573e-02 1 1  ON 39
eH2_0                -2.034372e-01 1 1  ON 40
eH2_1                -1.236043e-01 1 1  ON 41
eH2_2                -8.156588e-02 1 1  ON 42
eH2_3                -4.466278e-02 1 1  ON 43
eH2_4                 8.467103e-04 1 1  ON 44
eH2_5                 1.162974e-02 1 1  ON 45
eH2_6                 5.373400e-02 1 1  ON 46
eH2_7                 6.393279e-02 1 1  ON 47
eH2_8                 2.111660e-01 1 1  ON 48
eH2_9                 8.148409e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8332e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2258
    reference variance = 0.146834
====================================================
  Execution time = 3.2717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324533295108
                                         uncertainty =       0.005065870079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324533295108
                                         uncertainty =       0.005065870079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402813548
  error estimate for blocks of size 2^( 2) =       0.000412273897
  error estimate for blocks of size 2^( 3) =       0.000420802905
  error estimate for blocks of size 2^( 4) =       0.000426721298
  error estimate for blocks of size 2^( 5) =       0.000430641782
  error estimate for blocks of size 2^( 6) =       0.000432855614
  error estimate for blocks of size 2^( 7) =       0.000434394392

      target function =                  N/A
              le_mean =     -17.216923605962
             les_mean =     296.746975800788
             stat err =       0.000431153271
             autocorr =       1.145658634595
              std dev =       0.569664383239
             le_variance =       0.324517509531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692360596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216923605962       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216922397446       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216921914420       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216922558936       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216922879823       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216922607650       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216922108944       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216923430462       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216924086128       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216925515847       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216924971194       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216924894347       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216925044255       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216926136204       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216927567995       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216925893953       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216926824424       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216927570078       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216927580547       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216929029815       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216929562549       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216929349374       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-03 is 1.673852e-02

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216923605962       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216922421332       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216921939738       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216922571153       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216922900719       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216922640089       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216922175252       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216923407111       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216924012523       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216925265779       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216924726733       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216924634161       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216924733395       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216925525826       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216926302819       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216925196344       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216925458745       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216925837936       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 4.891386e-03

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216923605962       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216922508127       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216922032669       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216922616415       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216922969517       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216922748105       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216922389116       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216923342909       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216923802814       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216924581650       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216924140728       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216924035545       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.679391e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.357170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1764e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.060118e-01 1 1  ON 0
 uu_1                 4.265900e-02 1 1  ON 1
 uu_2                -5.399735e-02 1 1  ON 2
 uu_3                -1.114940e-01 1 1  ON 3
 uu_4                -1.482659e-01 1 1  ON 4
 uu_5                -1.607267e-01 1 1  ON 5
 uu_6                -1.472055e-01 1 1  ON 6
 uu_7                -9.412317e-02 1 1  ON 7
 uu_8                -1.100104e-03 1 1  ON 8
 uu_9                 2.047847e-01 1 1  ON 9
 ud_0                 3.600858e-01 1 1  ON 10
 ud_1                 1.006027e-01 1 1  ON 11
 ud_2                -1.103685e-02 1 1  ON 12
 ud_3                -7.406293e-02 1 1  ON 13
 ud_4                -1.244174e-01 1 1  ON 14
 ud_5                -1.601794e-01 1 1  ON 15
 ud_6                -1.708396e-01 1 1  ON 16
 ud_7                -1.399270e-01 1 1  ON 17
 ud_8                -7.449786e-02 1 1  ON 18
 ud_9                 7.664083e-02 1 1  ON 19
 eO_0                -8.967822e-01 1 1  ON 20
 eO_1                -5.706583e-01 1 1  ON 21
 eO_2                -1.510704e-01 1 1  ON 22
 eO_3                 1.236982e-01 1 1  ON 23
 eO_4                 2.493749e-01 1 1  ON 24
 eO_5                 3.255683e-01 1 1  ON 25
 eO_6                 3.483069e-01 1 1  ON 26
 eO_7                 4.037592e-01 1 1  ON 27
 eO_8                 1.048552e-01 1 1  ON 28
 eO_9                 3.947562e-02 1 1  ON 29
eH1_0                -2.028064e-01 1 1  ON 30
eH1_1                -1.241248e-01 1 1  ON 31
eH1_2                -8.205123e-02 1 1  ON 32
eH1_3                -4.458977e-02 1 1  ON 33
eH1_4                 1.217697e-03 1 1  ON 34
eH1_5                 1.335940e-02 1 1  ON 35
eH1_6                 4.710753e-02 1 1  ON 36
eH1_7                 4.759129e-02 1 1  ON 37
eH1_8                 2.172812e-01 1 1  ON 38
eH1_9                 8.551788e-02 1 1  ON 39
eH2_0                -2.037621e-01 1 1  ON 40
eH2_1                -1.253084e-01 1 1  ON 41
eH2_2                -8.317835e-02 1 1  ON 42
eH2_3                -4.553902e-02 1 1  ON 43
eH2_4                 1.736597e-04 1 1  ON 44
eH2_5                 1.260051e-02 1 1  ON 45
eH2_6                 5.287140e-02 1 1  ON 46
eH2_7                 6.476030e-02 1 1  ON 47
eH2_8                 2.120994e-01 1 1  ON 48
eH2_9                 8.335046e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2219
    reference variance = 0.258353
====================================================
  Execution time = 3.1525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2009e-01
  Total weights = 2.0000e+06
  Execution time = 2.9927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265314882
                                         uncertainty =       0.003498931290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265314882
                                         uncertainty =       0.003498931290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400156761
  error estimate for blocks of size 2^( 2) =       0.000409261959
  error estimate for blocks of size 2^( 3) =       0.000418374440
  error estimate for blocks of size 2^( 4) =       0.000423976746
  error estimate for blocks of size 2^( 5) =       0.000427338774
  error estimate for blocks of size 2^( 6) =       0.000428486026
  error estimate for blocks of size 2^( 7) =       0.000428855270

      target function =                  N/A
              le_mean =     -17.216514807616
             les_mean =     296.728632828245
             stat err =       0.000427164204
             autocorr =       1.139539502697
              std dev =       0.565907119151
             le_variance =       0.320250867506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320168086118
                                         uncertainty =       0.003494871879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320168086118
                                         uncertainty =       0.003494871879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400096074
  error estimate for blocks of size 2^( 2) =       0.000409193231
  error estimate for blocks of size 2^( 3) =       0.000418305258
  error estimate for blocks of size 2^( 4) =       0.000423904216
  error estimate for blocks of size 2^( 5) =       0.000427253284
  error estimate for blocks of size 2^( 6) =       0.000428403249
  error estimate for blocks of size 2^( 7) =       0.000428778437

      target function =                  N/A
              le_mean =     -17.216512338690
             les_mean =     296.728450685259
             stat err =       0.000427084797
             autocorr =       1.139461467298
              std dev =       0.565821294295
             le_variance =       0.320153737078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319969181899
                                         uncertainty =       0.003490444360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319969181899
                                         uncertainty =       0.003490444360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399971866
  error estimate for blocks of size 2^( 2) =       0.000409070805
  error estimate for blocks of size 2^( 3) =       0.000418185070
  error estimate for blocks of size 2^( 4) =       0.000423784329
  error estimate for blocks of size 2^( 5) =       0.000427128700
  error estimate for blocks of size 2^( 6) =       0.000428279957
  error estimate for blocks of size 2^( 7) =       0.000428652409

      target function =                  N/A
              le_mean =     -17.216511094851
             les_mean =     296.728209105598
             stat err =       0.000426961349
             autocorr =       1.139510249070
              std dev =       0.565645636824
             le_variance =       0.319954986457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320157142834
                                         uncertainty =       0.003495557871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320157142834
                                         uncertainty =       0.003495557871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400089249
  error estimate for blocks of size 2^( 2) =       0.000409191348
  error estimate for blocks of size 2^( 3) =       0.000418301749
  error estimate for blocks of size 2^( 4) =       0.000423900608
  error estimate for blocks of size 2^( 5) =       0.000427256052
  error estimate for blocks of size 2^( 6) =       0.000428401623
  error estimate for blocks of size 2^( 7) =       0.000428771248

      target function =                  N/A
              le_mean =     -17.216511135018
             les_mean =     296.728398316602
             stat err =       0.000427082383
             autocorr =       1.139487462957
              std dev =       0.565811642213
             le_variance =       0.320142814463


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216514807616        initial  <--
     1.5259e-03     1.5259e-02             1.6739e-02       -17.216512338690
     6.1035e-03     6.1035e-02             4.8914e-03       -17.216511094851
     2.4414e-02     2.4414e-01             1.6794e-03       -17.216511135018

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.7455
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.073756e-01 1 1  ON 0
 uu_1                 4.374145e-02 1 1  ON 1
 uu_2                -5.316289e-02 1 1  ON 2
 uu_3                -1.106568e-01 1 1  ON 3
 uu_4                -1.474106e-01 1 1  ON 4
 uu_5                -1.595319e-01 1 1  ON 5
 uu_6                -1.460210e-01 1 1  ON 6
 uu_7                -9.601076e-02 1 1  ON 7
 uu_8                -1.394835e-03 1 1  ON 8
 uu_9                 2.066991e-01 1 1  ON 9
 ud_0                 3.604315e-01 1 1  ON 10
 ud_1                 1.008657e-01 1 1  ON 11
 ud_2                -1.087336e-02 1 1  ON 12
 ud_3                -7.381464e-02 1 1  ON 13
 ud_4                -1.239487e-01 1 1  ON 14
 ud_5                -1.593126e-01 1 1  ON 15
 ud_6                -1.699730e-01 1 1  ON 16
 ud_7                -1.426361e-01 1 1  ON 17
 ud_8                -7.186123e-02 1 1  ON 18
 ud_9                 7.872734e-02 1 1  ON 19
 eO_0                -8.964273e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.497056e-01 1 1  ON 22
 eO_3                 1.246149e-01 1 1  ON 23
 eO_4                 2.500283e-01 1 1  ON 24
 eO_5                 3.252193e-01 1 1  ON 25
 eO_6                 3.531983e-01 1 1  ON 26
 eO_7                 4.011066e-01 1 1  ON 27
 eO_8                 1.013813e-01 1 1  ON 28
 eO_9                 3.820216e-02 1 1  ON 29
eH1_0                -2.030477e-01 1 1  ON 30
eH1_1                -1.237419e-01 1 1  ON 31
eH1_2                -8.173807e-02 1 1  ON 32
eH1_3                -4.455303e-02 1 1  ON 33
eH1_4                 8.048008e-04 1 1  ON 34
eH1_5                 1.139243e-02 1 1  ON 35
eH1_6                 4.987158e-02 1 1  ON 36
eH1_7                 4.760476e-02 1 1  ON 37
eH1_8                 2.188042e-01 1 1  ON 38
eH1_9                 8.400573e-02 1 1  ON 39
eH2_0                -2.034372e-01 1 1  ON 40
eH2_1                -1.236043e-01 1 1  ON 41
eH2_2                -8.156588e-02 1 1  ON 42
eH2_3                -4.466278e-02 1 1  ON 43
eH2_4                 8.467103e-04 1 1  ON 44
eH2_5                 1.162974e-02 1 1  ON 45
eH2_6                 5.373400e-02 1 1  ON 46
eH2_7                 6.393279e-02 1 1  ON 47
eH2_8                 2.111660e-01 1 1  ON 48
eH2_9                 8.148409e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1965e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1883
    reference variance = 0.195206
====================================================
  Execution time = 3.2497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1904e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319126476428
                                         uncertainty =       0.002782657508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319126476428
                                         uncertainty =       0.002782657508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399397574
  error estimate for blocks of size 2^( 2) =       0.000408896518
  error estimate for blocks of size 2^( 3) =       0.000417031956
  error estimate for blocks of size 2^( 4) =       0.000423332700
  error estimate for blocks of size 2^( 5) =       0.000426813706
  error estimate for blocks of size 2^( 6) =       0.000428739266
  error estimate for blocks of size 2^( 7) =       0.000430589821

      target function =                  N/A
              le_mean =     -17.217045407653
             les_mean =     296.745689253261
             stat err =       0.000427368873
             autocorr =       1.144972172545
              std dev =       0.564833465356
             le_variance =       0.319036843586


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704540765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217045407653       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217048297395       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217051537917       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217051831120       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217051131020       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217051549081       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217052229655       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217050155611       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217050957513       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217052507668       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217052640751       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217053630142       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217054208309       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217053805530       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217053647918       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217054260407       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217053838055       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 4.831725e-03

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217045407653       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217047799505       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217050472602       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217050815975       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217050330451       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217050714917       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217051077902       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217049634641       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217050203426       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217050783453       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217050902974       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217050998142       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 1.505477e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217045407653       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217046823635       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217048504738       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217048895969       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217048772158       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217049087121       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217049090447       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217048499193       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217048659832       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 5.581130e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1448e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.073312e-01 1 1  ON 0
 uu_1                 4.365246e-02 1 1  ON 1
 uu_2                -5.318007e-02 1 1  ON 2
 uu_3                -1.106707e-01 1 1  ON 3
 uu_4                -1.477152e-01 1 1  ON 4
 uu_5                -1.600215e-01 1 1  ON 5
 uu_6                -1.460328e-01 1 1  ON 6
 uu_7                -9.552003e-02 1 1  ON 7
 uu_8                -1.447755e-03 1 1  ON 8
 uu_9                 2.064047e-01 1 1  ON 9
 ud_0                 3.606993e-01 1 1  ON 10
 ud_1                 1.010642e-01 1 1  ON 11
 ud_2                -1.039166e-02 1 1  ON 12
 ud_3                -7.353254e-02 1 1  ON 13
 ud_4                -1.236381e-01 1 1  ON 14
 ud_5                -1.593261e-01 1 1  ON 15
 ud_6                -1.699876e-01 1 1  ON 16
 ud_7                -1.427627e-01 1 1  ON 17
 ud_8                -7.315045e-02 1 1  ON 18
 ud_9                 7.803192e-02 1 1  ON 19
 eO_0                -8.963084e-01 1 1  ON 20
 eO_1                -5.701360e-01 1 1  ON 21
 eO_2                -1.504406e-01 1 1  ON 22
 eO_3                 1.243815e-01 1 1  ON 23
 eO_4                 2.497241e-01 1 1  ON 24
 eO_5                 3.254374e-01 1 1  ON 25
 eO_6                 3.532044e-01 1 1  ON 26
 eO_7                 4.014952e-01 1 1  ON 27
 eO_8                 1.015965e-01 1 1  ON 28
 eO_9                 3.826460e-02 1 1  ON 29
eH1_0                -2.040928e-01 1 1  ON 30
eH1_1                -1.244852e-01 1 1  ON 31
eH1_2                -8.240804e-02 1 1  ON 32
eH1_3                -4.502753e-02 1 1  ON 33
eH1_4                 3.996778e-04 1 1  ON 34
eH1_5                 1.289791e-02 1 1  ON 35
eH1_6                 5.090040e-02 1 1  ON 36
eH1_7                 4.830125e-02 1 1  ON 37
eH1_8                 2.188146e-01 1 1  ON 38
eH1_9                 8.404622e-02 1 1  ON 39
eH2_0                -2.041088e-01 1 1  ON 40
eH2_1                -1.245567e-01 1 1  ON 41
eH2_2                -8.260865e-02 1 1  ON 42
eH2_3                -4.460648e-02 1 1  ON 43
eH2_4                 1.111726e-03 1 1  ON 44
eH2_5                 1.276371e-02 1 1  ON 45
eH2_6                 5.441269e-02 1 1  ON 46
eH2_7                 6.415077e-02 1 1  ON 47
eH2_8                 2.111996e-01 1 1  ON 48
eH2_9                 8.160328e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1261
    reference variance = 0.380693
====================================================
  Execution time = 3.1779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3420e-01
  Total weights = 2.0000e+06
  Execution time = 2.9855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334359006121
                                         uncertainty =       0.008150045513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334359006121
                                         uncertainty =       0.008150045513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408835757
  error estimate for blocks of size 2^( 2) =       0.000418416505
  error estimate for blocks of size 2^( 3) =       0.000426696840
  error estimate for blocks of size 2^( 4) =       0.000433478926
  error estimate for blocks of size 2^( 5) =       0.000437443736
  error estimate for blocks of size 2^( 6) =       0.000438488949
  error estimate for blocks of size 2^( 7) =       0.000439613914

      target function =                  N/A
              le_mean =     -17.216815539742
             les_mean =     296.753030514573
             stat err =       0.000437256381
             autocorr =       1.143864462367
              std dev =       0.578181072164
             le_variance =       0.334293352209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334292494139
                                         uncertainty =       0.008136772231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334292494139
                                         uncertainty =       0.008136772231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408795115
  error estimate for blocks of size 2^( 2) =       0.000418374953
  error estimate for blocks of size 2^( 3) =       0.000426658589
  error estimate for blocks of size 2^( 4) =       0.000433435828
  error estimate for blocks of size 2^( 5) =       0.000437401697
  error estimate for blocks of size 2^( 6) =       0.000438444015
  error estimate for blocks of size 2^( 7) =       0.000439555362

      target function =                  N/A
              le_mean =     -17.216812271677
             les_mean =     296.752851523343
             stat err =       0.000437209225
             autocorr =       1.143845160554
              std dev =       0.578123596028
             le_variance =       0.334226892285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334189871270
                                         uncertainty =       0.008133369802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334189871270
                                         uncertainty =       0.008133369802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408732427
  error estimate for blocks of size 2^( 2) =       0.000418315547
  error estimate for blocks of size 2^( 3) =       0.000426607348
  error estimate for blocks of size 2^( 4) =       0.000433386331
  error estimate for blocks of size 2^( 5) =       0.000437351279
  error estimate for blocks of size 2^( 6) =       0.000438389594
  error estimate for blocks of size 2^( 7) =       0.000439482789

      target function =                  N/A
              le_mean =     -17.216814298026
             les_mean =     296.752818799816
             stat err =       0.000437152498
             autocorr =       1.143899159432
              std dev =       0.578034941992
             le_variance =       0.334124394164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334313117980
                                         uncertainty =       0.008147920010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334313117980
                                         uncertainty =       0.008147920010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408807740
  error estimate for blocks of size 2^( 2) =       0.000418388629
  error estimate for blocks of size 2^( 3) =       0.000426672327
  error estimate for blocks of size 2^( 4) =       0.000433452381
  error estimate for blocks of size 2^( 5) =       0.000437416031
  error estimate for blocks of size 2^( 6) =       0.000438458586
  error estimate for blocks of size 2^( 7) =       0.000439572028

      target function =                  N/A
              le_mean =     -17.216813290393
             les_mean =     296.752907245259
             stat err =       0.000437224757
             autocorr =       1.143855777786
              std dev =       0.578141449929
             le_variance =       0.334247536127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216815539742        initial  <--
     1.5259e-02     1.5259e-01             4.8317e-03       -17.216812271677
     6.1035e-02     6.1035e-01             1.5055e-03       -17.216814298026
     2.4414e-01     2.4414e+00             5.5811e-04       -17.216813290393

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8329
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.073756e-01 1 1  ON 0
 uu_1                 4.374145e-02 1 1  ON 1
 uu_2                -5.316289e-02 1 1  ON 2
 uu_3                -1.106568e-01 1 1  ON 3
 uu_4                -1.474106e-01 1 1  ON 4
 uu_5                -1.595319e-01 1 1  ON 5
 uu_6                -1.460210e-01 1 1  ON 6
 uu_7                -9.601076e-02 1 1  ON 7
 uu_8                -1.394835e-03 1 1  ON 8
 uu_9                 2.066991e-01 1 1  ON 9
 ud_0                 3.604315e-01 1 1  ON 10
 ud_1                 1.008657e-01 1 1  ON 11
 ud_2                -1.087336e-02 1 1  ON 12
 ud_3                -7.381464e-02 1 1  ON 13
 ud_4                -1.239487e-01 1 1  ON 14
 ud_5                -1.593126e-01 1 1  ON 15
 ud_6                -1.699730e-01 1 1  ON 16
 ud_7                -1.426361e-01 1 1  ON 17
 ud_8                -7.186123e-02 1 1  ON 18
 ud_9                 7.872734e-02 1 1  ON 19
 eO_0                -8.964273e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.497056e-01 1 1  ON 22
 eO_3                 1.246149e-01 1 1  ON 23
 eO_4                 2.500283e-01 1 1  ON 24
 eO_5                 3.252193e-01 1 1  ON 25
 eO_6                 3.531983e-01 1 1  ON 26
 eO_7                 4.011066e-01 1 1  ON 27
 eO_8                 1.013813e-01 1 1  ON 28
 eO_9                 3.820216e-02 1 1  ON 29
eH1_0                -2.030477e-01 1 1  ON 30
eH1_1                -1.237419e-01 1 1  ON 31
eH1_2                -8.173807e-02 1 1  ON 32
eH1_3                -4.455303e-02 1 1  ON 33
eH1_4                 8.048008e-04 1 1  ON 34
eH1_5                 1.139243e-02 1 1  ON 35
eH1_6                 4.987158e-02 1 1  ON 36
eH1_7                 4.760476e-02 1 1  ON 37
eH1_8                 2.188042e-01 1 1  ON 38
eH1_9                 8.400573e-02 1 1  ON 39
eH2_0                -2.034372e-01 1 1  ON 40
eH2_1                -1.236043e-01 1 1  ON 41
eH2_2                -8.156588e-02 1 1  ON 42
eH2_3                -4.466278e-02 1 1  ON 43
eH2_4                 8.467103e-04 1 1  ON 44
eH2_5                 1.162974e-02 1 1  ON 45
eH2_6                 5.373400e-02 1 1  ON 46
eH2_7                 6.393279e-02 1 1  ON 47
eH2_8                 2.111660e-01 1 1  ON 48
eH2_9                 8.148409e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8480e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2107
    reference variance = 0.307313
====================================================
  Execution time = 3.2213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2223e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322300773284
                                         uncertainty =       0.003406968802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322300773284
                                         uncertainty =       0.003406968802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401389897
  error estimate for blocks of size 2^( 2) =       0.000410931171
  error estimate for blocks of size 2^( 3) =       0.000419213730
  error estimate for blocks of size 2^( 4) =       0.000425179212
  error estimate for blocks of size 2^( 5) =       0.000428940924
  error estimate for blocks of size 2^( 6) =       0.000431411636
  error estimate for blocks of size 2^( 7) =       0.000433952745

      target function =                  N/A
              le_mean =     -17.216769507061
             les_mean =     296.739379796916
             stat err =       0.000429871129
             autocorr =       1.146947879528
              std dev =       0.567651036088
             le_variance =       0.322227698772


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676950706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216769507061       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216770276895       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216770860340       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216770194679       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216770863763       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216771938292       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216771800951       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216771289594       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216771336019       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216771327003       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 5.679661e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216769507061       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216769868431       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216770186627       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216769856132       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216770193186       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216770564143       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216770548051       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216770423242       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.333202e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216769507061       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216769622798       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216769733498       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216769629960       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216769758482       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216769857609       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216769856287       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 6.872099e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1159e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.072513e-01 1 1  ON 0
 uu_1                 4.381225e-02 1 1  ON 1
 uu_2                -5.312537e-02 1 1  ON 2
 uu_3                -1.106118e-01 1 1  ON 3
 uu_4                -1.473981e-01 1 1  ON 4
 uu_5                -1.597652e-01 1 1  ON 5
 uu_6                -1.460127e-01 1 1  ON 6
 uu_7                -9.589399e-02 1 1  ON 7
 uu_8                -1.366749e-03 1 1  ON 8
 uu_9                 2.066787e-01 1 1  ON 9
 ud_0                 3.603785e-01 1 1  ON 10
 ud_1                 1.007878e-01 1 1  ON 11
 ud_2                -1.084526e-02 1 1  ON 12
 ud_3                -7.385903e-02 1 1  ON 13
 ud_4                -1.238020e-01 1 1  ON 14
 ud_5                -1.593485e-01 1 1  ON 15
 ud_6                -1.699564e-01 1 1  ON 16
 ud_7                -1.426317e-01 1 1  ON 17
 ud_8                -7.188698e-02 1 1  ON 18
 ud_9                 7.871603e-02 1 1  ON 19
 eO_0                -8.962953e-01 1 1  ON 20
 eO_1                -5.702830e-01 1 1  ON 21
 eO_2                -1.497249e-01 1 1  ON 22
 eO_3                 1.244375e-01 1 1  ON 23
 eO_4                 2.499701e-01 1 1  ON 24
 eO_5                 3.252778e-01 1 1  ON 25
 eO_6                 3.531742e-01 1 1  ON 26
 eO_7                 4.011469e-01 1 1  ON 27
 eO_8                 1.014264e-01 1 1  ON 28
 eO_9                 3.821261e-02 1 1  ON 29
eH1_0                -2.029139e-01 1 1  ON 30
eH1_1                -1.238709e-01 1 1  ON 31
eH1_2                -8.182437e-02 1 1  ON 32
eH1_3                -4.454703e-02 1 1  ON 33
eH1_4                 7.326724e-04 1 1  ON 34
eH1_5                 1.147190e-02 1 1  ON 35
eH1_6                 4.989938e-02 1 1  ON 36
eH1_7                 4.761357e-02 1 1  ON 37
eH1_8                 2.187976e-01 1 1  ON 38
eH1_9                 8.402706e-02 1 1  ON 39
eH2_0                -2.032591e-01 1 1  ON 40
eH2_1                -1.237639e-01 1 1  ON 41
eH2_2                -8.170325e-02 1 1  ON 42
eH2_3                -4.459908e-02 1 1  ON 43
eH2_4                 9.498836e-04 1 1  ON 44
eH2_5                 1.155278e-02 1 1  ON 45
eH2_6                 5.367436e-02 1 1  ON 46
eH2_7                 6.398308e-02 1 1  ON 47
eH2_8                 2.111808e-01 1 1  ON 48
eH2_9                 8.149874e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.3162
    reference variance = 0.484061
====================================================
  Execution time = 3.1721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2232e-01
  Total weights = 2.0000e+06
  Execution time = 2.9862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322411995291
                                         uncertainty =       0.004003431283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322411995291
                                         uncertainty =       0.004003431283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401478696
  error estimate for blocks of size 2^( 2) =       0.000410797825
  error estimate for blocks of size 2^( 3) =       0.000418733230
  error estimate for blocks of size 2^( 4) =       0.000425214306
  error estimate for blocks of size 2^( 5) =       0.000429561441
  error estimate for blocks of size 2^( 6) =       0.000432526568
  error estimate for blocks of size 2^( 7) =       0.000432299401

      target function =                  N/A
              le_mean =     -17.216657922500
             les_mean =     296.735680146567
             stat err =       0.000429900429
             autocorr =       1.146596855435
              std dev =       0.567776617488
             le_variance =       0.322370287366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322278084775
                                         uncertainty =       0.004002135799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322278084775
                                         uncertainty =       0.004002135799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401395304
  error estimate for blocks of size 2^( 2) =       0.000410715516
  error estimate for blocks of size 2^( 3) =       0.000418649940
  error estimate for blocks of size 2^( 4) =       0.000425131090
  error estimate for blocks of size 2^( 5) =       0.000429479947
  error estimate for blocks of size 2^( 6) =       0.000432442886
  error estimate for blocks of size 2^( 7) =       0.000432217562

      target function =                  N/A
              le_mean =     -17.216655165144
             les_mean =     296.735451293731
             stat err =       0.000429817871
             autocorr =       1.146632808624
              std dev =       0.567658682099
             le_variance =       0.322236379362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322305772626
                                         uncertainty =       0.004002587265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322305772626
                                         uncertainty =       0.004002587265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401412551
  error estimate for blocks of size 2^( 2) =       0.000410732534
  error estimate for blocks of size 2^( 3) =       0.000418666009
  error estimate for blocks of size 2^( 4) =       0.000425146607
  error estimate for blocks of size 2^( 5) =       0.000429496019
  error estimate for blocks of size 2^( 6) =       0.000432459296
  error estimate for blocks of size 2^( 7) =       0.000432231986

      target function =                  N/A
              le_mean =     -17.216655725923
             les_mean =     296.735498295850
             stat err =       0.000429833477
             autocorr =       1.146617535192
              std dev =       0.567683073563
             le_variance =       0.322264072010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322396296763
                                         uncertainty =       0.004003381116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322396296763
                                         uncertainty =       0.004003381116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401468924
  error estimate for blocks of size 2^( 2) =       0.000410788217
  error estimate for blocks of size 2^( 3) =       0.000418723190
  error estimate for blocks of size 2^( 4) =       0.000425204231
  error estimate for blocks of size 2^( 5) =       0.000429552001
  error estimate for blocks of size 2^( 6) =       0.000432516717
  error estimate for blocks of size 2^( 7) =       0.000432289420

      target function =                  N/A
              le_mean =     -17.216657552300
             les_mean =     296.735651705184
             stat err =       0.000429890592
             autocorr =       1.146600205093
              std dev =       0.567762796605
             le_variance =       0.322354593209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216657922500        initial  <--
     1.5259e-01     1.5259e+00             5.6797e-04       -17.216655165144
     6.1035e-01     6.1035e+00             2.3332e-04       -17.216655725923
     2.4414e+00     2.4414e+01             6.8721e-05       -17.216657552300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.7863
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.073756e-01 1 1  ON 0
 uu_1                 4.374145e-02 1 1  ON 1
 uu_2                -5.316289e-02 1 1  ON 2
 uu_3                -1.106568e-01 1 1  ON 3
 uu_4                -1.474106e-01 1 1  ON 4
 uu_5                -1.595319e-01 1 1  ON 5
 uu_6                -1.460210e-01 1 1  ON 6
 uu_7                -9.601076e-02 1 1  ON 7
 uu_8                -1.394835e-03 1 1  ON 8
 uu_9                 2.066991e-01 1 1  ON 9
 ud_0                 3.604315e-01 1 1  ON 10
 ud_1                 1.008657e-01 1 1  ON 11
 ud_2                -1.087336e-02 1 1  ON 12
 ud_3                -7.381464e-02 1 1  ON 13
 ud_4                -1.239487e-01 1 1  ON 14
 ud_5                -1.593126e-01 1 1  ON 15
 ud_6                -1.699730e-01 1 1  ON 16
 ud_7                -1.426361e-01 1 1  ON 17
 ud_8                -7.186123e-02 1 1  ON 18
 ud_9                 7.872734e-02 1 1  ON 19
 eO_0                -8.964273e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.497056e-01 1 1  ON 22
 eO_3                 1.246149e-01 1 1  ON 23
 eO_4                 2.500283e-01 1 1  ON 24
 eO_5                 3.252193e-01 1 1  ON 25
 eO_6                 3.531983e-01 1 1  ON 26
 eO_7                 4.011066e-01 1 1  ON 27
 eO_8                 1.013813e-01 1 1  ON 28
 eO_9                 3.820216e-02 1 1  ON 29
eH1_0                -2.030477e-01 1 1  ON 30
eH1_1                -1.237419e-01 1 1  ON 31
eH1_2                -8.173807e-02 1 1  ON 32
eH1_3                -4.455303e-02 1 1  ON 33
eH1_4                 8.048008e-04 1 1  ON 34
eH1_5                 1.139243e-02 1 1  ON 35
eH1_6                 4.987158e-02 1 1  ON 36
eH1_7                 4.760476e-02 1 1  ON 37
eH1_8                 2.188042e-01 1 1  ON 38
eH1_9                 8.400573e-02 1 1  ON 39
eH2_0                -2.034372e-01 1 1  ON 40
eH2_1                -1.236043e-01 1 1  ON 41
eH2_2                -8.156588e-02 1 1  ON 42
eH2_3                -4.466278e-02 1 1  ON 43
eH2_4                 8.467103e-04 1 1  ON 44
eH2_5                 1.162974e-02 1 1  ON 45
eH2_6                 5.373400e-02 1 1  ON 46
eH2_7                 6.393279e-02 1 1  ON 47
eH2_8                 2.111660e-01 1 1  ON 48
eH2_9                 8.148409e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8108e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2485
    reference variance = 0.322182
====================================================
  Execution time = 3.2480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1657e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316547125696
                                         uncertainty =       0.002561807980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316547125696
                                         uncertainty =       0.002561807980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397852043
  error estimate for blocks of size 2^( 2) =       0.000407335721
  error estimate for blocks of size 2^( 3) =       0.000415703760
  error estimate for blocks of size 2^( 4) =       0.000421862515
  error estimate for blocks of size 2^( 5) =       0.000425868049
  error estimate for blocks of size 2^( 6) =       0.000428139289
  error estimate for blocks of size 2^( 7) =       0.000430944962

      target function =                  N/A
              le_mean =     -17.216577071668
             les_mean =     296.727098403088
             stat err =       0.000426703704
             autocorr =       1.150296079214
              std dev =       0.562647755417
             le_variance =       0.316572496676


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657707167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216577071668       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216577264608       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216577534682       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216577685989       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216577527651       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216577544244       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216577457837       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 9.593628e-05

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216577071668       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216577126631       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216577199938       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216577244265       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216577195735       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216577199377       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216577178960       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.712963e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216577071668       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216577085906       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216577104656       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216577116254       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216577103308       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216577104086       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216577099101       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 7.017184e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1445e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.073738e-01 1 1  ON 0
 uu_1                 4.374347e-02 1 1  ON 1
 uu_2                -5.315258e-02 1 1  ON 2
 uu_3                -1.106552e-01 1 1  ON 3
 uu_4                -1.473966e-01 1 1  ON 4
 uu_5                -1.595250e-01 1 1  ON 5
 uu_6                -1.460351e-01 1 1  ON 6
 uu_7                -9.602313e-02 1 1  ON 7
 uu_8                -1.403323e-03 1 1  ON 8
 uu_9                 2.066956e-01 1 1  ON 9
 ud_0                 3.604209e-01 1 1  ON 10
 ud_1                 1.008717e-01 1 1  ON 11
 ud_2                -1.085656e-02 1 1  ON 12
 ud_3                -7.381442e-02 1 1  ON 13
 ud_4                -1.239389e-01 1 1  ON 14
 ud_5                -1.593260e-01 1 1  ON 15
 ud_6                -1.699625e-01 1 1  ON 16
 ud_7                -1.426440e-01 1 1  ON 17
 ud_8                -7.187129e-02 1 1  ON 18
 ud_9                 7.872219e-02 1 1  ON 19
 eO_0                -8.964189e-01 1 1  ON 20
 eO_1                -5.702666e-01 1 1  ON 21
 eO_2                -1.497205e-01 1 1  ON 22
 eO_3                 1.246202e-01 1 1  ON 23
 eO_4                 2.500222e-01 1 1  ON 24
 eO_5                 3.252235e-01 1 1  ON 25
 eO_6                 3.531946e-01 1 1  ON 26
 eO_7                 4.011060e-01 1 1  ON 27
 eO_8                 1.013842e-01 1 1  ON 28
 eO_9                 3.820319e-02 1 1  ON 29
eH1_0                -2.030454e-01 1 1  ON 30
eH1_1                -1.237491e-01 1 1  ON 31
eH1_2                -8.175168e-02 1 1  ON 32
eH1_3                -4.454471e-02 1 1  ON 33
eH1_4                 8.169669e-04 1 1  ON 34
eH1_5                 1.139130e-02 1 1  ON 35
eH1_6                 4.986972e-02 1 1  ON 36
eH1_7                 4.760595e-02 1 1  ON 37
eH1_8                 2.188017e-01 1 1  ON 38
eH1_9                 8.400721e-02 1 1  ON 39
eH2_0                -2.034283e-01 1 1  ON 40
eH2_1                -1.236174e-01 1 1  ON 41
eH2_2                -8.158480e-02 1 1  ON 42
eH2_3                -4.463565e-02 1 1  ON 43
eH2_4                 8.425470e-04 1 1  ON 44
eH2_5                 1.163273e-02 1 1  ON 45
eH2_6                 5.373226e-02 1 1  ON 46
eH2_7                 6.393237e-02 1 1  ON 47
eH2_8                 2.111635e-01 1 1  ON 48
eH2_9                 8.148528e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2102
    reference variance = 0.183678
====================================================
  Execution time = 3.1747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2363e-01
  Total weights = 2.0000e+06
  Execution time = 2.9831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713967589
                                         uncertainty =       0.004485796197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713967589
                                         uncertainty =       0.004485796197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402275191
  error estimate for blocks of size 2^( 2) =       0.000411706724
  error estimate for blocks of size 2^( 3) =       0.000420682221
  error estimate for blocks of size 2^( 4) =       0.000426305265
  error estimate for blocks of size 2^( 5) =       0.000431236730
  error estimate for blocks of size 2^( 6) =       0.000431781925
  error estimate for blocks of size 2^( 7) =       0.000435594169

      target function =                  N/A
              le_mean =     -17.216852111593
             les_mean =     296.743647129427
             stat err =       0.000431229522
             autocorr =       1.149133460915
              std dev =       0.568903031091
             le_variance =       0.323650658784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323647576507
                                         uncertainty =       0.004485070904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323647576507
                                         uncertainty =       0.004485070904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402233918
  error estimate for blocks of size 2^( 2) =       0.000411666615
  error estimate for blocks of size 2^( 3) =       0.000420642813
  error estimate for blocks of size 2^( 4) =       0.000426266178
  error estimate for blocks of size 2^( 5) =       0.000431196468
  error estimate for blocks of size 2^( 6) =       0.000431740721
  error estimate for blocks of size 2^( 7) =       0.000435552422

      target function =                  N/A
              le_mean =     -17.216852821694
             les_mean =     296.743605171501
             stat err =       0.000431188947
             autocorr =       1.149153017299
              std dev =       0.568844661941
             le_variance =       0.323584249419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323673600549
                                         uncertainty =       0.004485325851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323673600549
                                         uncertainty =       0.004485325851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402250098
  error estimate for blocks of size 2^( 2) =       0.000411682358
  error estimate for blocks of size 2^( 3) =       0.000420658297
  error estimate for blocks of size 2^( 4) =       0.000426281568
  error estimate for blocks of size 2^( 5) =       0.000431212319
  error estimate for blocks of size 2^( 6) =       0.000431757014
  error estimate for blocks of size 2^( 7) =       0.000435569014

      target function =                  N/A
              le_mean =     -17.216852522526
             les_mean =     296.743620902719
             stat err =       0.000431204979
             autocorr =       1.149146019133
              std dev =       0.568867543562
             le_variance =       0.323610282118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323708623670
                                         uncertainty =       0.004485733008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323708623670
                                         uncertainty =       0.004485733008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402271869
  error estimate for blocks of size 2^( 2) =       0.000411703499
  error estimate for blocks of size 2^( 3) =       0.000420679054
  error estimate for blocks of size 2^( 4) =       0.000426302129
  error estimate for blocks of size 2^( 5) =       0.000431233500
  error estimate for blocks of size 2^( 6) =       0.000431778632
  error estimate for blocks of size 2^( 7) =       0.000435590846

      target function =                  N/A
              le_mean =     -17.216852163969
             les_mean =     296.743643587796
             stat err =       0.000431226277
             autocorr =       1.149135142763
              std dev =       0.568898333314
             le_variance =       0.323645313648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216852111593        initial
     1.5259e+00     1.5259e+01             9.5936e-05       -17.216852821694  <--
     6.1035e+00     6.1035e+01             2.7130e-05       -17.216852522526
     2.4414e+01     2.4414e+02             7.0172e-06       -17.216852163969

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 4.6787e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.073713e-01 1 1  ON 0
 uu_1                 4.375086e-02 1 1  ON 1
 uu_2                -5.312612e-02 1 1  ON 2
 uu_3                -1.106471e-01 1 1  ON 3
 uu_4                -1.473620e-01 1 1  ON 4
 uu_5                -1.595041e-01 1 1  ON 5
 uu_6                -1.460753e-01 1 1  ON 6
 uu_7                -9.605886e-02 1 1  ON 7
 uu_8                -1.427510e-03 1 1  ON 8
 uu_9                 2.066859e-01 1 1  ON 9
 ud_0                 3.603997e-01 1 1  ON 10
 ud_1                 1.008892e-01 1 1  ON 11
 ud_2                -1.081596e-02 1 1  ON 12
 ud_3                -7.381013e-02 1 1  ON 13
 ud_4                -1.239167e-01 1 1  ON 14
 ud_5                -1.593608e-01 1 1  ON 15
 ud_6                -1.699350e-01 1 1  ON 16
 ud_7                -1.426672e-01 1 1  ON 17
 ud_8                -7.189991e-02 1 1  ON 18
 ud_9                 7.870760e-02 1 1  ON 19
 eO_0                -8.963916e-01 1 1  ON 20
 eO_1                -5.702619e-01 1 1  ON 21
 eO_2                -1.497590e-01 1 1  ON 22
 eO_3                 1.246334e-01 1 1  ON 23
 eO_4                 2.500049e-01 1 1  ON 24
 eO_5                 3.252349e-01 1 1  ON 25
 eO_6                 3.531838e-01 1 1  ON 26
 eO_7                 4.011041e-01 1 1  ON 27
 eO_8                 1.013924e-01 1 1  ON 28
 eO_9                 3.820606e-02 1 1  ON 29
eH1_0                -2.030398e-01 1 1  ON 30
eH1_1                -1.237702e-01 1 1  ON 31
eH1_2                -8.178678e-02 1 1  ON 32
eH1_3                -4.452437e-02 1 1  ON 33
eH1_4                 8.528322e-04 1 1  ON 34
eH1_5                 1.138875e-02 1 1  ON 35
eH1_6                 4.986423e-02 1 1  ON 36
eH1_7                 4.760906e-02 1 1  ON 37
eH1_8                 2.187943e-01 1 1  ON 38
eH1_9                 8.401137e-02 1 1  ON 39
eH2_0                -2.034051e-01 1 1  ON 40
eH2_1                -1.236530e-01 1 1  ON 41
eH2_2                -8.163281e-02 1 1  ON 42
eH2_3                -4.456684e-02 1 1  ON 43
eH2_4                 8.355167e-04 1 1  ON 44
eH2_5                 1.164015e-02 1 1  ON 45
eH2_6                 5.372667e-02 1 1  ON 46
eH2_7                 6.393090e-02 1 1  ON 47
eH2_8                 2.111561e-01 1 1  ON 48
eH2_9                 8.148860e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8396e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1711
    reference variance = 0.330479
====================================================
  Execution time = 3.2919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2537e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325511848122
                                         uncertainty =       0.004927481788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325511848122
                                         uncertainty =       0.004927481788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403342614
  error estimate for blocks of size 2^( 2) =       0.000412649931
  error estimate for blocks of size 2^( 3) =       0.000421310148
  error estimate for blocks of size 2^( 4) =       0.000427663705
  error estimate for blocks of size 2^( 5) =       0.000431597265
  error estimate for blocks of size 2^( 6) =       0.000432010383
  error estimate for blocks of size 2^( 7) =       0.000431879385

      target function =                  N/A
              le_mean =     -17.217133209930
             les_mean =     296.755046334170
             stat err =       0.000430787684
             autocorr =       1.140718121902
              std dev =       0.570412594856
             le_variance =       0.325370528370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721713320993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217133209930       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217132986067       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217132264575       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217131640009       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217131385906       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217131560063       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217131421596       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217131510256       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 3.185017e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217133209930       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217133134779       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217132908123       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217132681318       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217132637711       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217132638789       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217132630621       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 9.517279e-05

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217133209930       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217133189381       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217133128022       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217133064065       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217133061039       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217133052344       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.734840e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.370544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1915e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.072895e-01 1 1  ON 0
 uu_1                 4.374469e-02 1 1  ON 1
 uu_2                -5.311714e-02 1 1  ON 2
 uu_3                -1.106280e-01 1 1  ON 3
 uu_4                -1.473679e-01 1 1  ON 4
 uu_5                -1.594930e-01 1 1  ON 5
 uu_6                -1.460616e-01 1 1  ON 6
 uu_7                -9.604461e-02 1 1  ON 7
 uu_8                -1.430813e-03 1 1  ON 8
 uu_9                 2.066762e-01 1 1  ON 9
 ud_0                 3.603743e-01 1 1  ON 10
 ud_1                 1.008754e-01 1 1  ON 11
 ud_2                -1.077856e-02 1 1  ON 12
 ud_3                -7.379591e-02 1 1  ON 13
 ud_4                -1.238917e-01 1 1  ON 14
 ud_5                -1.593579e-01 1 1  ON 15
 ud_6                -1.699496e-01 1 1  ON 16
 ud_7                -1.426892e-01 1 1  ON 17
 ud_8                -7.192951e-02 1 1  ON 18
 ud_9                 7.869064e-02 1 1  ON 19
 eO_0                -8.964035e-01 1 1  ON 20
 eO_1                -5.701901e-01 1 1  ON 21
 eO_2                -1.498542e-01 1 1  ON 22
 eO_3                 1.246325e-01 1 1  ON 23
 eO_4                 2.499885e-01 1 1  ON 24
 eO_5                 3.252494e-01 1 1  ON 25
 eO_6                 3.531798e-01 1 1  ON 26
 eO_7                 4.011233e-01 1 1  ON 27
 eO_8                 1.014050e-01 1 1  ON 28
 eO_9                 3.820948e-02 1 1  ON 29
eH1_0                -2.030316e-01 1 1  ON 30
eH1_1                -1.238061e-01 1 1  ON 31
eH1_2                -8.182240e-02 1 1  ON 32
eH1_3                -4.454624e-02 1 1  ON 33
eH1_4                 8.251060e-04 1 1  ON 34
eH1_5                 1.143539e-02 1 1  ON 35
eH1_6                 4.987763e-02 1 1  ON 36
eH1_7                 4.764183e-02 1 1  ON 37
eH1_8                 2.187998e-01 1 1  ON 38
eH1_9                 8.401995e-02 1 1  ON 39
eH2_0                -2.033693e-01 1 1  ON 40
eH2_1                -1.236430e-01 1 1  ON 41
eH2_2                -8.170062e-02 1 1  ON 42
eH2_3                -4.456452e-02 1 1  ON 43
eH2_4                 9.283033e-04 1 1  ON 44
eH2_5                 1.159048e-02 1 1  ON 45
eH2_6                 5.368503e-02 1 1  ON 46
eH2_7                 6.392943e-02 1 1  ON 47
eH2_8                 2.111617e-01 1 1  ON 48
eH2_9                 8.149648e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2943
    reference variance = 0.333216
====================================================
  Execution time = 3.8625e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3100e-01
  Total weights = 2.0000e+06
  Execution time = 2.9852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330197273778
                                         uncertainty =       0.006010931610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330197273778
                                         uncertainty =       0.006010931610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406847412
  error estimate for blocks of size 2^( 2) =       0.000416241025
  error estimate for blocks of size 2^( 3) =       0.000425230732
  error estimate for blocks of size 2^( 4) =       0.000431638253
  error estimate for blocks of size 2^( 5) =       0.000435380984
  error estimate for blocks of size 2^( 6) =       0.000438601888
  error estimate for blocks of size 2^( 7) =       0.000439244800

      target function =                  N/A
              le_mean =     -17.216586853800
             les_mean =     296.741912362258
             stat err =       0.000436216481
             autocorr =       1.149584830178
              std dev =       0.575369127889
             le_variance =       0.331049633328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330072048742
                                         uncertainty =       0.006009078920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330072048742
                                         uncertainty =       0.006009078920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406770338
  error estimate for blocks of size 2^( 2) =       0.000416167155
  error estimate for blocks of size 2^( 3) =       0.000425158788
  error estimate for blocks of size 2^( 4) =       0.000431565521
  error estimate for blocks of size 2^( 5) =       0.000435310047
  error estimate for blocks of size 2^( 6) =       0.000438532065
  error estimate for blocks of size 2^( 7) =       0.000439180153

      target function =                  N/A
              le_mean =     -17.216585255512
             les_mean =     296.741731910736
             stat err =       0.000436146946
             autocorr =       1.149653907370
              std dev =       0.575260128884
             le_variance =       0.330924215884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330106374883
                                         uncertainty =       0.006009592877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330106374883
                                         uncertainty =       0.006009592877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406791457
  error estimate for blocks of size 2^( 2) =       0.000416187728
  error estimate for blocks of size 2^( 3) =       0.000425179019
  error estimate for blocks of size 2^( 4) =       0.000431585960
  error estimate for blocks of size 2^( 5) =       0.000435329808
  error estimate for blocks of size 2^( 6) =       0.000438551650
  error estimate for blocks of size 2^( 7) =       0.000439197679

      target function =                  N/A
              le_mean =     -17.216585212026
             les_mean =     296.741764776962
             stat err =       0.000436166274
             autocorr =       1.149636423527
              std dev =       0.575289996007
             le_variance =       0.330958579506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330184217138
                                         uncertainty =       0.006010738903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330184217138
                                         uncertainty =       0.006010738903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406839375
  error estimate for blocks of size 2^( 2) =       0.000416233401
  error estimate for blocks of size 2^( 3) =       0.000425223340
  error estimate for blocks of size 2^( 4) =       0.000431630762
  error estimate for blocks of size 2^( 5) =       0.000435373612
  error estimate for blocks of size 2^( 6) =       0.000438594694
  error estimate for blocks of size 2^( 7) =       0.000439238000

      target function =                  N/A
              le_mean =     -17.216586562405
             les_mean =     296.741889249725
             stat err =       0.000436209267
             autocorr =       1.149592224607
              std dev =       0.575357762158
             le_variance =       0.331036554476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216586853800        initial  <--
     3.8147e-01     3.8147e+00             3.1850e-04       -17.216585255512
     1.5259e+00     1.5259e+01             9.5173e-05       -17.216585212026
     6.1035e+00     6.1035e+01             2.7348e-05       -17.216586562405

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6950
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.073713e-01 1 1  ON 0
 uu_1                 4.375086e-02 1 1  ON 1
 uu_2                -5.312612e-02 1 1  ON 2
 uu_3                -1.106471e-01 1 1  ON 3
 uu_4                -1.473620e-01 1 1  ON 4
 uu_5                -1.595041e-01 1 1  ON 5
 uu_6                -1.460753e-01 1 1  ON 6
 uu_7                -9.605886e-02 1 1  ON 7
 uu_8                -1.427510e-03 1 1  ON 8
 uu_9                 2.066859e-01 1 1  ON 9
 ud_0                 3.603997e-01 1 1  ON 10
 ud_1                 1.008892e-01 1 1  ON 11
 ud_2                -1.081596e-02 1 1  ON 12
 ud_3                -7.381013e-02 1 1  ON 13
 ud_4                -1.239167e-01 1 1  ON 14
 ud_5                -1.593608e-01 1 1  ON 15
 ud_6                -1.699350e-01 1 1  ON 16
 ud_7                -1.426672e-01 1 1  ON 17
 ud_8                -7.189991e-02 1 1  ON 18
 ud_9                 7.870760e-02 1 1  ON 19
 eO_0                -8.963916e-01 1 1  ON 20
 eO_1                -5.702619e-01 1 1  ON 21
 eO_2                -1.497590e-01 1 1  ON 22
 eO_3                 1.246334e-01 1 1  ON 23
 eO_4                 2.500049e-01 1 1  ON 24
 eO_5                 3.252349e-01 1 1  ON 25
 eO_6                 3.531838e-01 1 1  ON 26
 eO_7                 4.011041e-01 1 1  ON 27
 eO_8                 1.013924e-01 1 1  ON 28
 eO_9                 3.820606e-02 1 1  ON 29
eH1_0                -2.030398e-01 1 1  ON 30
eH1_1                -1.237702e-01 1 1  ON 31
eH1_2                -8.178678e-02 1 1  ON 32
eH1_3                -4.452437e-02 1 1  ON 33
eH1_4                 8.528322e-04 1 1  ON 34
eH1_5                 1.138875e-02 1 1  ON 35
eH1_6                 4.986423e-02 1 1  ON 36
eH1_7                 4.760906e-02 1 1  ON 37
eH1_8                 2.187943e-01 1 1  ON 38
eH1_9                 8.401137e-02 1 1  ON 39
eH2_0                -2.034051e-01 1 1  ON 40
eH2_1                -1.236530e-01 1 1  ON 41
eH2_2                -8.163281e-02 1 1  ON 42
eH2_3                -4.456684e-02 1 1  ON 43
eH2_4                 8.355167e-04 1 1  ON 44
eH2_5                 1.164015e-02 1 1  ON 45
eH2_6                 5.372667e-02 1 1  ON 46
eH2_7                 6.393090e-02 1 1  ON 47
eH2_8                 2.111561e-01 1 1  ON 48
eH2_9                 8.148860e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2908
    reference variance = 0.363398
====================================================
  Execution time = 3.2498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2054e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320492972958
                                         uncertainty =       0.004124793542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320492972958
                                         uncertainty =       0.004124793542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400338232
  error estimate for blocks of size 2^( 2) =       0.000409803130
  error estimate for blocks of size 2^( 3) =       0.000417921744
  error estimate for blocks of size 2^( 4) =       0.000424768425
  error estimate for blocks of size 2^( 5) =       0.000429592398
  error estimate for blocks of size 2^( 6) =       0.000432576300
  error estimate for blocks of size 2^( 7) =       0.000432459609

      target function =                  N/A
              le_mean =     -17.216577071481
             les_mean =     296.731067298508
             stat err =       0.000429849183
             autocorr =       1.152863998318
              std dev =       0.566163757688
             le_variance =       0.320541400519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657707148e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216577071481       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216576981386       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216576844383       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216576864045       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216576861838       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216576853622       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216576848122       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 3.020599e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216577071481       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216577048177       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216577011038       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216577014939       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216577013523       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216577009872       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216577008622       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 7.688044e-06

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216577071481       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216577065605       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216577056122       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216577057022       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216577056593       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216577055564       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216577055248       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.963906e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.372832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1494e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.073704e-01 1 1  ON 0
 uu_1                 4.374865e-02 1 1  ON 1
 uu_2                -5.311843e-02 1 1  ON 2
 uu_3                -1.106474e-01 1 1  ON 3
 uu_4                -1.473596e-01 1 1  ON 4
 uu_5                -1.595044e-01 1 1  ON 5
 uu_6                -1.460781e-01 1 1  ON 6
 uu_7                -9.606156e-02 1 1  ON 7
 uu_8                -1.429025e-03 1 1  ON 8
 uu_9                 2.066847e-01 1 1  ON 9
 ud_0                 3.603994e-01 1 1  ON 10
 ud_1                 1.008919e-01 1 1  ON 11
 ud_2                -1.081209e-02 1 1  ON 12
 ud_3                -7.380971e-02 1 1  ON 13
 ud_4                -1.239126e-01 1 1  ON 14
 ud_5                -1.593616e-01 1 1  ON 15
 ud_6                -1.699389e-01 1 1  ON 16
 ud_7                -1.426687e-01 1 1  ON 17
 ud_8                -7.190361e-02 1 1  ON 18
 ud_9                 7.870536e-02 1 1  ON 19
 eO_0                -8.963845e-01 1 1  ON 20
 eO_1                -5.702607e-01 1 1  ON 21
 eO_2                -1.497659e-01 1 1  ON 22
 eO_3                 1.246321e-01 1 1  ON 23
 eO_4                 2.500052e-01 1 1  ON 24
 eO_5                 3.252369e-01 1 1  ON 25
 eO_6                 3.531804e-01 1 1  ON 26
 eO_7                 4.011037e-01 1 1  ON 27
 eO_8                 1.013933e-01 1 1  ON 28
 eO_9                 3.820644e-02 1 1  ON 29
eH1_0                -2.030434e-01 1 1  ON 30
eH1_1                -1.237733e-01 1 1  ON 31
eH1_2                -8.178940e-02 1 1  ON 32
eH1_3                -4.452345e-02 1 1  ON 33
eH1_4                 8.547761e-04 1 1  ON 34
eH1_5                 1.139163e-02 1 1  ON 35
eH1_6                 4.986617e-02 1 1  ON 36
eH1_7                 4.761129e-02 1 1  ON 37
eH1_8                 2.187938e-01 1 1  ON 38
eH1_9                 8.401128e-02 1 1  ON 39
eH2_0                -2.034006e-01 1 1  ON 40
eH2_1                -1.236583e-01 1 1  ON 41
eH2_2                -8.163871e-02 1 1  ON 42
eH2_3                -4.455931e-02 1 1  ON 43
eH2_4                 8.430993e-04 1 1  ON 44
eH2_5                 1.163886e-02 1 1  ON 45
eH2_6                 5.372260e-02 1 1  ON 46
eH2_7                 6.392796e-02 1 1  ON 47
eH2_8                 2.111551e-01 1 1  ON 48
eH2_9                 8.148908e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2369
    reference variance = 0.373439
====================================================
  Execution time = 3.1564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1657e-01
  Total weights = 2.0000e+06
  Execution time = 2.9868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316569711174
                                         uncertainty =       0.002487958334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316569711174
                                         uncertainty =       0.002487958334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397853405
  error estimate for blocks of size 2^( 2) =       0.000407967780
  error estimate for blocks of size 2^( 3) =       0.000416162680
  error estimate for blocks of size 2^( 4) =       0.000422541225
  error estimate for blocks of size 2^( 5) =       0.000426384465
  error estimate for blocks of size 2^( 6) =       0.000428792454
  error estimate for blocks of size 2^( 7) =       0.000431883858

      target function =                  N/A
              le_mean =     -17.216596308142
             les_mean =     296.727762942669
             stat err =       0.000427400501
             autocorr =       1.154048059217
              std dev =       0.562649680909
             le_variance =       0.316574663427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316549788720
                                         uncertainty =       0.002487711242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316549788720
                                         uncertainty =       0.002487711242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397840883
  error estimate for blocks of size 2^( 2) =       0.000407955477
  error estimate for blocks of size 2^( 3) =       0.000416150621
  error estimate for blocks of size 2^( 4) =       0.000422529315
  error estimate for blocks of size 2^( 5) =       0.000426373153
  error estimate for blocks of size 2^( 6) =       0.000428781689
  error estimate for blocks of size 2^( 7) =       0.000431872815

      target function =                  N/A
              le_mean =     -17.216596305467
             les_mean =     296.727742923511
             stat err =       0.000427389243
             autocorr =       1.154059907414
              std dev =       0.562631972413
             le_variance =       0.316554736382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316558776081
                                         uncertainty =       0.002487824325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316558776081
                                         uncertainty =       0.002487824325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397846532
  error estimate for blocks of size 2^( 2) =       0.000407961032
  error estimate for blocks of size 2^( 3) =       0.000416156077
  error estimate for blocks of size 2^( 4) =       0.000422534713
  error estimate for blocks of size 2^( 5) =       0.000426378288
  error estimate for blocks of size 2^( 6) =       0.000428786572
  error estimate for blocks of size 2^( 7) =       0.000431877825

      target function =                  N/A
              le_mean =     -17.216596304510
             les_mean =     296.727751879571
             stat err =       0.000427394350
             autocorr =       1.154054716096
              std dev =       0.562639960709
             le_variance =       0.316563725387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316568308185
                                         uncertainty =       0.002487941210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316568308185
                                         uncertainty =       0.002487941210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397852523
  error estimate for blocks of size 2^( 2) =       0.000407966915
  error estimate for blocks of size 2^( 3) =       0.000416161834
  error estimate for blocks of size 2^( 4) =       0.000422540390
  error estimate for blocks of size 2^( 5) =       0.000426383673
  error estimate for blocks of size 2^( 6) =       0.000428791700
  error estimate for blocks of size 2^( 7) =       0.000431883085

      target function =                  N/A
              le_mean =     -17.216596307473
             les_mean =     296.727761516267
             stat err =       0.000427399712
             autocorr =       1.154048917727
              std dev =       0.562648433790
             le_variance =       0.316573260046


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216596308142        initial  <--
     3.8147e+00     3.8147e+01             3.0206e-05       -17.216596305467
     1.5259e+01     1.5259e+02             7.6880e-06       -17.216596304510
     6.1035e+01     6.1035e+02             1.9639e-06       -17.216596307473

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.6238
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.073713e-01 1 1  ON 0
 uu_1                 4.375086e-02 1 1  ON 1
 uu_2                -5.312612e-02 1 1  ON 2
 uu_3                -1.106471e-01 1 1  ON 3
 uu_4                -1.473620e-01 1 1  ON 4
 uu_5                -1.595041e-01 1 1  ON 5
 uu_6                -1.460753e-01 1 1  ON 6
 uu_7                -9.605886e-02 1 1  ON 7
 uu_8                -1.427510e-03 1 1  ON 8
 uu_9                 2.066859e-01 1 1  ON 9
 ud_0                 3.603997e-01 1 1  ON 10
 ud_1                 1.008892e-01 1 1  ON 11
 ud_2                -1.081596e-02 1 1  ON 12
 ud_3                -7.381013e-02 1 1  ON 13
 ud_4                -1.239167e-01 1 1  ON 14
 ud_5                -1.593608e-01 1 1  ON 15
 ud_6                -1.699350e-01 1 1  ON 16
 ud_7                -1.426672e-01 1 1  ON 17
 ud_8                -7.189991e-02 1 1  ON 18
 ud_9                 7.870760e-02 1 1  ON 19
 eO_0                -8.963916e-01 1 1  ON 20
 eO_1                -5.702619e-01 1 1  ON 21
 eO_2                -1.497590e-01 1 1  ON 22
 eO_3                 1.246334e-01 1 1  ON 23
 eO_4                 2.500049e-01 1 1  ON 24
 eO_5                 3.252349e-01 1 1  ON 25
 eO_6                 3.531838e-01 1 1  ON 26
 eO_7                 4.011041e-01 1 1  ON 27
 eO_8                 1.013924e-01 1 1  ON 28
 eO_9                 3.820606e-02 1 1  ON 29
eH1_0                -2.030398e-01 1 1  ON 30
eH1_1                -1.237702e-01 1 1  ON 31
eH1_2                -8.178678e-02 1 1  ON 32
eH1_3                -4.452437e-02 1 1  ON 33
eH1_4                 8.528322e-04 1 1  ON 34
eH1_5                 1.138875e-02 1 1  ON 35
eH1_6                 4.986423e-02 1 1  ON 36
eH1_7                 4.760906e-02 1 1  ON 37
eH1_8                 2.187943e-01 1 1  ON 38
eH1_9                 8.401137e-02 1 1  ON 39
eH2_0                -2.034051e-01 1 1  ON 40
eH2_1                -1.236530e-01 1 1  ON 41
eH2_2                -8.163281e-02 1 1  ON 42
eH2_3                -4.456684e-02 1 1  ON 43
eH2_4                 8.355167e-04 1 1  ON 44
eH2_5                 1.164015e-02 1 1  ON 45
eH2_6                 5.372667e-02 1 1  ON 46
eH2_7                 6.393090e-02 1 1  ON 47
eH2_8                 2.111561e-01 1 1  ON 48
eH2_9                 8.148860e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8204e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2669
    reference variance = 0.236882
====================================================
  Execution time = 3.2295e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320793476198
                                         uncertainty =       0.003161529487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320793476198
                                         uncertainty =       0.003161529487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400459673
  error estimate for blocks of size 2^( 2) =       0.000410018025
  error estimate for blocks of size 2^( 3) =       0.000418047394
  error estimate for blocks of size 2^( 4) =       0.000423873259
  error estimate for blocks of size 2^( 5) =       0.000428676617
  error estimate for blocks of size 2^( 6) =       0.000429511681
  error estimate for blocks of size 2^( 7) =       0.000432734104

      target function =                  N/A
              le_mean =     -17.216969926056
             les_mean =     296.744789173175
             stat err =       0.000428698915
             autocorr =       1.146006794982
              std dev =       0.566335500242
             le_variance =       0.320735898834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696992606e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216969926056       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216969922689       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216969915484       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216969916325       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216969909390       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216969909432       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216969915043       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 3.153793e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216969926056       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216969925209       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216969923403       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216969923615       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216969921850       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216969921874       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216969923257       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 7.930960e-07

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216969926056       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216969925844       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216969925392       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216969925445       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216969925002       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216969925009       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216969925353       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 1.985669e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1247e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.073712e-01 1 1  ON 0
 uu_1                 4.375129e-02 1 1  ON 1
 uu_2                -5.312597e-02 1 1  ON 2
 uu_3                -1.106469e-01 1 1  ON 3
 uu_4                -1.473623e-01 1 1  ON 4
 uu_5                -1.595043e-01 1 1  ON 5
 uu_6                -1.460752e-01 1 1  ON 6
 uu_7                -9.605912e-02 1 1  ON 7
 uu_8                -1.427708e-03 1 1  ON 8
 uu_9                 2.066857e-01 1 1  ON 9
 ud_0                 3.603998e-01 1 1  ON 10
 ud_1                 1.008888e-01 1 1  ON 11
 ud_2                -1.081525e-02 1 1  ON 12
 ud_3                -7.381037e-02 1 1  ON 13
 ud_4                -1.239161e-01 1 1  ON 14
 ud_5                -1.593604e-01 1 1  ON 15
 ud_6                -1.699354e-01 1 1  ON 16
 ud_7                -1.426676e-01 1 1  ON 17
 ud_8                -7.190031e-02 1 1  ON 18
 ud_9                 7.870732e-02 1 1  ON 19
 eO_0                -8.963912e-01 1 1  ON 20
 eO_1                -5.702616e-01 1 1  ON 21
 eO_2                -1.497593e-01 1 1  ON 22
 eO_3                 1.246331e-01 1 1  ON 23
 eO_4                 2.500046e-01 1 1  ON 24
 eO_5                 3.252351e-01 1 1  ON 25
 eO_6                 3.531836e-01 1 1  ON 26
 eO_7                 4.011041e-01 1 1  ON 27
 eO_8                 1.013925e-01 1 1  ON 28
 eO_9                 3.820609e-02 1 1  ON 29
eH1_0                -2.030395e-01 1 1  ON 30
eH1_1                -1.237707e-01 1 1  ON 31
eH1_2                -8.178728e-02 1 1  ON 32
eH1_3                -4.452425e-02 1 1  ON 33
eH1_4                 8.524519e-04 1 1  ON 34
eH1_5                 1.138889e-02 1 1  ON 35
eH1_6                 4.986468e-02 1 1  ON 36
eH1_7                 4.760931e-02 1 1  ON 37
eH1_8                 2.187942e-01 1 1  ON 38
eH1_9                 8.401146e-02 1 1  ON 39
eH2_0                -2.034047e-01 1 1  ON 40
eH2_1                -1.236534e-01 1 1  ON 41
eH2_2                -8.163361e-02 1 1  ON 42
eH2_3                -4.456609e-02 1 1  ON 43
eH2_4                 8.358363e-04 1 1  ON 44
eH2_5                 1.164035e-02 1 1  ON 45
eH2_6                 5.372638e-02 1 1  ON 46
eH2_7                 6.393072e-02 1 1  ON 47
eH2_8                 2.111561e-01 1 1  ON 48
eH2_9                 8.148863e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1301
    reference variance = 0.280795
====================================================
  Execution time = 3.1990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2337e-01
  Total weights = 2.0000e+06
  Execution time = 2.9818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323430445100
                                         uncertainty =       0.006816655260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323430445100
                                         uncertainty =       0.006816655260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402100456
  error estimate for blocks of size 2^( 2) =       0.000411591230
  error estimate for blocks of size 2^( 3) =       0.000420029193
  error estimate for blocks of size 2^( 4) =       0.000425827148
  error estimate for blocks of size 2^( 5) =       0.000430265725
  error estimate for blocks of size 2^( 6) =       0.000432307280
  error estimate for blocks of size 2^( 7) =       0.000433766309

      target function =                  N/A
              le_mean =     -17.216117675073
             les_mean =     296.718077193294
             stat err =       0.000430541616
             autocorr =       1.146465900368
              std dev =       0.568655917937
             le_variance =       0.323369553004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323430026199
                                         uncertainty =       0.006816625669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323430026199
                                         uncertainty =       0.006816625669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402100195
  error estimate for blocks of size 2^( 2) =       0.000411590962
  error estimate for blocks of size 2^( 3) =       0.000420028947
  error estimate for blocks of size 2^( 4) =       0.000425826931
  error estimate for blocks of size 2^( 5) =       0.000430265503
  error estimate for blocks of size 2^( 6) =       0.000432307030
  error estimate for blocks of size 2^( 7) =       0.000433765990

      target function =                  N/A
              le_mean =     -17.216117682255
             les_mean =     296.718077020943
             stat err =       0.000430541364
             autocorr =       1.146466045031
              std dev =       0.568655548979
             le_variance =       0.323369133384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323430235483
                                         uncertainty =       0.006816640455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323430235483
                                         uncertainty =       0.006816640455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402100325
  error estimate for blocks of size 2^( 2) =       0.000411591096
  error estimate for blocks of size 2^( 3) =       0.000420029070
  error estimate for blocks of size 2^( 4) =       0.000425827040
  error estimate for blocks of size 2^( 5) =       0.000430265614
  error estimate for blocks of size 2^( 6) =       0.000432307156
  error estimate for blocks of size 2^( 7) =       0.000433766150

      target function =                  N/A
              le_mean =     -17.216117678656
             les_mean =     296.718077106651
             stat err =       0.000430541490
             autocorr =       1.146465974754
              std dev =       0.568655733306
             le_variance =       0.323369343021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323430418876
                                         uncertainty =       0.006816653409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323430418876
                                         uncertainty =       0.006816653409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402100439
  error estimate for blocks of size 2^( 2) =       0.000411591213
  error estimate for blocks of size 2^( 3) =       0.000420029178
  error estimate for blocks of size 2^( 4) =       0.000425827135
  error estimate for blocks of size 2^( 5) =       0.000430265711
  error estimate for blocks of size 2^( 6) =       0.000432307265
  error estimate for blocks of size 2^( 7) =       0.000433766290

      target function =                  N/A
              le_mean =     -17.216117675519
             les_mean =     296.718077182370
             stat err =       0.000430541600
             autocorr =       1.146465909738
              std dev =       0.568655894838
             le_variance =       0.323369526734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216117675073        initial
     3.8147e+01     3.8147e+02             3.1538e-06       -17.216117682255  <--
     1.5259e+02     1.5259e+03             7.9310e-07       -17.216117678656
     6.1035e+02     6.1035e+03             1.9857e-07       -17.216117675519

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 4.7029e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.073708e-01 1 1  ON 0
 uu_1                 4.375255e-02 1 1  ON 1
 uu_2                -5.312555e-02 1 1  ON 2
 uu_3                -1.106463e-01 1 1  ON 3
 uu_4                -1.473630e-01 1 1  ON 4
 uu_5                -1.595051e-01 1 1  ON 5
 uu_6                -1.460748e-01 1 1  ON 6
 uu_7                -9.605988e-02 1 1  ON 7
 uu_8                -1.428301e-03 1 1  ON 8
 uu_9                 2.066852e-01 1 1  ON 9
 ud_0                 3.604001e-01 1 1  ON 10
 ud_1                 1.008875e-01 1 1  ON 11
 ud_2                -1.081315e-02 1 1  ON 12
 ud_3                -7.381108e-02 1 1  ON 13
 ud_4                -1.239144e-01 1 1  ON 14
 ud_5                -1.593593e-01 1 1  ON 15
 ud_6                -1.699366e-01 1 1  ON 16
 ud_7                -1.426686e-01 1 1  ON 17
 ud_8                -7.190153e-02 1 1  ON 18
 ud_9                 7.870647e-02 1 1  ON 19
 eO_0                -8.963901e-01 1 1  ON 20
 eO_1                -5.702608e-01 1 1  ON 21
 eO_2                -1.497601e-01 1 1  ON 22
 eO_3                 1.246324e-01 1 1  ON 23
 eO_4                 2.500035e-01 1 1  ON 24
 eO_5                 3.252358e-01 1 1  ON 25
 eO_6                 3.531829e-01 1 1  ON 26
 eO_7                 4.011042e-01 1 1  ON 27
 eO_8                 1.013929e-01 1 1  ON 28
 eO_9                 3.820618e-02 1 1  ON 29
eH1_0                -2.030386e-01 1 1  ON 30
eH1_1                -1.237721e-01 1 1  ON 31
eH1_2                -8.178878e-02 1 1  ON 32
eH1_3                -4.452388e-02 1 1  ON 33
eH1_4                 8.513193e-04 1 1  ON 34
eH1_5                 1.138934e-02 1 1  ON 35
eH1_6                 4.986603e-02 1 1  ON 36
eH1_7                 4.761003e-02 1 1  ON 37
eH1_8                 2.187939e-01 1 1  ON 38
eH1_9                 8.401171e-02 1 1  ON 39
eH2_0                -2.034037e-01 1 1  ON 40
eH2_1                -1.236545e-01 1 1  ON 41
eH2_2                -8.163597e-02 1 1  ON 42
eH2_3                -4.456383e-02 1 1  ON 43
eH2_4                 8.367998e-04 1 1  ON 44
eH2_5                 1.164095e-02 1 1  ON 45
eH2_6                 5.372548e-02 1 1  ON 46
eH2_7                 6.393018e-02 1 1  ON 47
eH2_8                 2.111560e-01 1 1  ON 48
eH2_9                 8.148871e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8347e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.288
    reference variance = 0.171141
====================================================
  Execution time = 3.2526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2214e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322208117287
                                         uncertainty =       0.005756185404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322208117287
                                         uncertainty =       0.005756185404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401335539
  error estimate for blocks of size 2^( 2) =       0.000410535356
  error estimate for blocks of size 2^( 3) =       0.000418660316
  error estimate for blocks of size 2^( 4) =       0.000424806145
  error estimate for blocks of size 2^( 5) =       0.000428221560
  error estimate for blocks of size 2^( 6) =       0.000429562596
  error estimate for blocks of size 2^( 7) =       0.000429660922

      target function =                  N/A
              le_mean =     -17.216288972133
             les_mean =     296.722746240297
             stat err =       0.000428062806
             autocorr =       1.137626631168
              std dev =       0.567574162014
             le_variance =       0.322140429386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628897213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216288972133       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216289001733       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216289002912       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216288976245       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216289000091       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216288992629       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216288991541       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.475394e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216288972133       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216288979630       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288979985       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216288973310       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216288979406       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216288977526       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216288977247       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 3.697631e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216288972133       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216288974013       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288974106       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216288972437       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216288973970       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216288973499       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216288973428       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 9.249408e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.377266 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1506e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.073687e-01 1 1  ON 0
 uu_1                 4.375359e-02 1 1  ON 1
 uu_2                -5.312415e-02 1 1  ON 2
 uu_3                -1.106451e-01 1 1  ON 3
 uu_4                -1.473619e-01 1 1  ON 4
 uu_5                -1.595071e-01 1 1  ON 5
 uu_6                -1.460749e-01 1 1  ON 6
 uu_7                -9.605942e-02 1 1  ON 7
 uu_8                -1.429137e-03 1 1  ON 8
 uu_9                 2.066844e-01 1 1  ON 9
 ud_0                 3.603993e-01 1 1  ON 10
 ud_1                 1.008882e-01 1 1  ON 11
 ud_2                -1.081133e-02 1 1  ON 12
 ud_3                -7.381288e-02 1 1  ON 13
 ud_4                -1.239140e-01 1 1  ON 14
 ud_5                -1.593590e-01 1 1  ON 15
 ud_6                -1.699354e-01 1 1  ON 16
 ud_7                -1.426677e-01 1 1  ON 17
 ud_8                -7.190320e-02 1 1  ON 18
 ud_9                 7.870493e-02 1 1  ON 19
 eO_0                -8.963893e-01 1 1  ON 20
 eO_1                -5.702605e-01 1 1  ON 21
 eO_2                -1.497612e-01 1 1  ON 22
 eO_3                 1.246323e-01 1 1  ON 23
 eO_4                 2.500027e-01 1 1  ON 24
 eO_5                 3.252357e-01 1 1  ON 25
 eO_6                 3.531829e-01 1 1  ON 26
 eO_7                 4.011049e-01 1 1  ON 27
 eO_8                 1.013931e-01 1 1  ON 28
 eO_9                 3.820614e-02 1 1  ON 29
eH1_0                -2.030379e-01 1 1  ON 30
eH1_1                -1.237733e-01 1 1  ON 31
eH1_2                -8.179047e-02 1 1  ON 32
eH1_3                -4.452305e-02 1 1  ON 33
eH1_4                 8.513269e-04 1 1  ON 34
eH1_5                 1.138965e-02 1 1  ON 35
eH1_6                 4.986672e-02 1 1  ON 36
eH1_7                 4.761077e-02 1 1  ON 37
eH1_8                 2.187936e-01 1 1  ON 38
eH1_9                 8.401169e-02 1 1  ON 39
eH2_0                -2.034039e-01 1 1  ON 40
eH2_1                -1.236581e-01 1 1  ON 41
eH2_2                -8.163700e-02 1 1  ON 42
eH2_3                -4.456092e-02 1 1  ON 43
eH2_4                 8.404974e-04 1 1  ON 44
eH2_5                 1.164133e-02 1 1  ON 45
eH2_6                 5.372334e-02 1 1  ON 46
eH2_7                 6.392980e-02 1 1  ON 47
eH2_8                 2.111560e-01 1 1  ON 48
eH2_9                 8.148894e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1897
    reference variance = 0.184995
====================================================
  Execution time = 3.2601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2723e-01
  Total weights = 2.0000e+06
  Execution time = 2.9873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327168051856
                                         uncertainty =       0.005854056302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327168051856
                                         uncertainty =       0.005854056302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404494418
  error estimate for blocks of size 2^( 2) =       0.000413640690
  error estimate for blocks of size 2^( 3) =       0.000422507948
  error estimate for blocks of size 2^( 4) =       0.000429381916
  error estimate for blocks of size 2^( 5) =       0.000433362773
  error estimate for blocks of size 2^( 6) =       0.000434345609
  error estimate for blocks of size 2^( 7) =       0.000435340228

      target function =                  N/A
              le_mean =     -17.216428304302
             les_mean =     296.732634861883
             stat err =       0.000433107631
             autocorr =       1.146480326839
              std dev =       0.572041491779
             le_variance =       0.327231468317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327158048378
                                         uncertainty =       0.005853700884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327158048378
                                         uncertainty =       0.005853700884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404488233
  error estimate for blocks of size 2^( 2) =       0.000413634718
  error estimate for blocks of size 2^( 3) =       0.000422502012
  error estimate for blocks of size 2^( 4) =       0.000429376021
  error estimate for blocks of size 2^( 5) =       0.000433357105
  error estimate for blocks of size 2^( 6) =       0.000434340146
  error estimate for blocks of size 2^( 7) =       0.000435334766

      target function =                  N/A
              le_mean =     -17.216428314080
             les_mean =     296.732625191135
             stat err =       0.000433102010
             autocorr =       1.146485626434
              std dev =       0.572032744604
             le_variance =       0.327221460899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327162848492
                                         uncertainty =       0.005853873464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327162848492
                                         uncertainty =       0.005853873464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404491201
  error estimate for blocks of size 2^( 2) =       0.000413637585
  error estimate for blocks of size 2^( 3) =       0.000422504863
  error estimate for blocks of size 2^( 4) =       0.000429378854
  error estimate for blocks of size 2^( 5) =       0.000433359829
  error estimate for blocks of size 2^( 6) =       0.000434342774
  error estimate for blocks of size 2^( 7) =       0.000435337393

      target function =                  N/A
              le_mean =     -17.216428309351
             les_mean =     296.732629830248
             stat err =       0.000433104713
             autocorr =       1.146483112599
              std dev =       0.572036941858
             le_variance =       0.327226262850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327167394653
                                         uncertainty =       0.005854033280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327167394653
                                         uncertainty =       0.005854033280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404494012
  error estimate for blocks of size 2^( 2) =       0.000413640298
  error estimate for blocks of size 2^( 3) =       0.000422507559
  error estimate for blocks of size 2^( 4) =       0.000429381529
  error estimate for blocks of size 2^( 5) =       0.000433362401
  error estimate for blocks of size 2^( 6) =       0.000434345251
  error estimate for blocks of size 2^( 7) =       0.000435339871

      target function =                  N/A
              le_mean =     -17.216428304917
             les_mean =     296.732634225574
             stat err =       0.000433107263
             autocorr =       1.146480679464
              std dev =       0.572040917108
             le_variance =       0.327230810846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216428304302        initial
     9.5367e+00     9.5367e+01             1.4754e-05       -17.216428314080  <--
     3.8147e+01     3.8147e+02             3.6976e-06       -17.216428309351
     1.5259e+02     1.5259e+03             9.2494e-07       -17.216428304917

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.7665e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.073625e-01 1 1  ON 0
 uu_1                 4.375671e-02 1 1  ON 1
 uu_2                -5.312010e-02 1 1  ON 2
 uu_3                -1.106417e-01 1 1  ON 3
 uu_4                -1.473586e-01 1 1  ON 4
 uu_5                -1.595131e-01 1 1  ON 5
 uu_6                -1.460752e-01 1 1  ON 6
 uu_7                -9.605806e-02 1 1  ON 7
 uu_8                -1.431610e-03 1 1  ON 8
 uu_9                 2.066820e-01 1 1  ON 9
 ud_0                 3.603971e-01 1 1  ON 10
 ud_1                 1.008901e-01 1 1  ON 11
 ud_2                -1.080616e-02 1 1  ON 12
 ud_3                -7.381796e-02 1 1  ON 13
 ud_4                -1.239128e-01 1 1  ON 14
 ud_5                -1.593584e-01 1 1  ON 15
 ud_6                -1.699322e-01 1 1  ON 16
 ud_7                -1.426650e-01 1 1  ON 17
 ud_8                -7.190812e-02 1 1  ON 18
 ud_9                 7.870040e-02 1 1  ON 19
 eO_0                -8.963865e-01 1 1  ON 20
 eO_1                -5.702596e-01 1 1  ON 21
 eO_2                -1.497645e-01 1 1  ON 22
 eO_3                 1.246319e-01 1 1  ON 23
 eO_4                 2.500002e-01 1 1  ON 24
 eO_5                 3.252353e-01 1 1  ON 25
 eO_6                 3.531832e-01 1 1  ON 26
 eO_7                 4.011068e-01 1 1  ON 27
 eO_8                 1.013939e-01 1 1  ON 28
 eO_9                 3.820604e-02 1 1  ON 29
eH1_0                -2.030362e-01 1 1  ON 30
eH1_1                -1.237771e-01 1 1  ON 31
eH1_2                -8.179540e-02 1 1  ON 32
eH1_3                -4.452063e-02 1 1  ON 33
eH1_4                 8.514099e-04 1 1  ON 34
eH1_5                 1.139056e-02 1 1  ON 35
eH1_6                 4.986875e-02 1 1  ON 36
eH1_7                 4.761294e-02 1 1  ON 37
eH1_8                 2.187928e-01 1 1  ON 38
eH1_9                 8.401164e-02 1 1  ON 39
eH2_0                -2.034044e-01 1 1  ON 40
eH2_1                -1.236686e-01 1 1  ON 41
eH2_2                -8.163998e-02 1 1  ON 42
eH2_3                -4.455243e-02 1 1  ON 43
eH2_4                 8.515537e-04 1 1  ON 44
eH2_5                 1.164246e-02 1 1  ON 45
eH2_6                 5.371700e-02 1 1  ON 46
eH2_7                 6.392867e-02 1 1  ON 47
eH2_8                 2.111560e-01 1 1  ON 48
eH2_9                 8.148960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9284e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2132
    reference variance = 0.247038
====================================================
  Execution time = 3.2288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2438e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324406284544
                                         uncertainty =       0.005817479305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324406284544
                                         uncertainty =       0.005817479305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402731205
  error estimate for blocks of size 2^( 2) =       0.000412179610
  error estimate for blocks of size 2^( 3) =       0.000420082447
  error estimate for blocks of size 2^( 4) =       0.000425959382
  error estimate for blocks of size 2^( 5) =       0.000429924745
  error estimate for blocks of size 2^( 6) =       0.000431489217
  error estimate for blocks of size 2^( 7) =       0.000431546118

      target function =                  N/A
              le_mean =     -17.216698385894
             les_mean =     296.739087995830
             stat err =       0.000429729866
             autocorr =       1.138572032159
              std dev =       0.569547932288
             le_variance =       0.324384847173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669838589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216698385894       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216698377551       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216698294280       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216698413251       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216698376552       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216698386523       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216698413367       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 5.611338e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216698385894       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216698383702       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216698361373       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216698391835       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216698382494       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216698385327       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.397554e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216698385894       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216698385339       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216698379653       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216698387306       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216698384944       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216698385698       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 3.531705e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.379287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1252e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.073597e-01 1 1  ON 0
 uu_1                 4.375835e-02 1 1  ON 1
 uu_2                -5.312065e-02 1 1  ON 2
 uu_3                -1.106386e-01 1 1  ON 3
 uu_4                -1.473644e-01 1 1  ON 4
 uu_5                -1.595064e-01 1 1  ON 5
 uu_6                -1.460781e-01 1 1  ON 6
 uu_7                -9.605997e-02 1 1  ON 7
 uu_8                -1.431753e-03 1 1  ON 8
 uu_9                 2.066809e-01 1 1  ON 9
 ud_0                 3.603921e-01 1 1  ON 10
 ud_1                 1.008936e-01 1 1  ON 11
 ud_2                -1.080615e-02 1 1  ON 12
 ud_3                -7.380954e-02 1 1  ON 13
 ud_4                -1.239020e-01 1 1  ON 14
 ud_5                -1.593617e-01 1 1  ON 15
 ud_6                -1.699361e-01 1 1  ON 16
 ud_7                -1.426727e-01 1 1  ON 17
 ud_8                -7.191227e-02 1 1  ON 18
 ud_9                 7.869879e-02 1 1  ON 19
 eO_0                -8.963852e-01 1 1  ON 20
 eO_1                -5.702508e-01 1 1  ON 21
 eO_2                -1.497693e-01 1 1  ON 22
 eO_3                 1.246179e-01 1 1  ON 23
 eO_4                 2.500040e-01 1 1  ON 24
 eO_5                 3.252391e-01 1 1  ON 25
 eO_6                 3.531799e-01 1 1  ON 26
 eO_7                 4.011082e-01 1 1  ON 27
 eO_8                 1.013958e-01 1 1  ON 28
 eO_9                 3.820647e-02 1 1  ON 29
eH1_0                -2.030479e-01 1 1  ON 30
eH1_1                -1.237874e-01 1 1  ON 31
eH1_2                -8.179410e-02 1 1  ON 32
eH1_3                -4.452408e-02 1 1  ON 33
eH1_4                 8.508595e-04 1 1  ON 34
eH1_5                 1.139683e-02 1 1  ON 35
eH1_6                 4.988068e-02 1 1  ON 36
eH1_7                 4.761815e-02 1 1  ON 37
eH1_8                 2.187927e-01 1 1  ON 38
eH1_9                 8.401253e-02 1 1  ON 39
eH2_0                -2.033990e-01 1 1  ON 40
eH2_1                -1.236763e-01 1 1  ON 41
eH2_2                -8.165098e-02 1 1  ON 42
eH2_3                -4.454841e-02 1 1  ON 43
eH2_4                 8.545697e-04 1 1  ON 44
eH2_5                 1.164771e-02 1 1  ON 45
eH2_6                 5.371693e-02 1 1  ON 46
eH2_7                 6.392841e-02 1 1  ON 47
eH2_8                 2.111560e-01 1 1  ON 48
eH2_9                 8.149043e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1278
    reference variance = 0.299537
====================================================
  Execution time = 3.2087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1433e-01
  Total weights = 2.0000e+06
  Execution time = 2.9873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314421381408
                                         uncertainty =       0.002481248595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314421381408
                                         uncertainty =       0.002481248595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396443190
  error estimate for blocks of size 2^( 2) =       0.000406108179
  error estimate for blocks of size 2^( 3) =       0.000414876312
  error estimate for blocks of size 2^( 4) =       0.000421116439
  error estimate for blocks of size 2^( 5) =       0.000424360423
  error estimate for blocks of size 2^( 6) =       0.000426147108
  error estimate for blocks of size 2^( 7) =       0.000425079775

      target function =                  N/A
              le_mean =     -17.216471510184
             les_mean =     296.721225509169
             stat err =       0.000424175936
             autocorr =       1.144801343768
              std dev =       0.560655335614
             le_variance =       0.314334405352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314402441314
                                         uncertainty =       0.002481153440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314402441314
                                         uncertainty =       0.002481153440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396431247
  error estimate for blocks of size 2^( 2) =       0.000406096172
  error estimate for blocks of size 2^( 3) =       0.000414864628
  error estimate for blocks of size 2^( 4) =       0.000421105112
  error estimate for blocks of size 2^( 5) =       0.000424349980
  error estimate for blocks of size 2^( 6) =       0.000426136141
  error estimate for blocks of size 2^( 7) =       0.000425067899

      target function =                  N/A
              le_mean =     -17.216471322317
             les_mean =     296.721200102355
             stat err =       0.000424164783
             autocorr =       1.144810113990
              std dev =       0.560638446194
             le_variance =       0.314315467350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314411340189
                                         uncertainty =       0.002481198659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314411340189
                                         uncertainty =       0.002481198659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396436858
  error estimate for blocks of size 2^( 2) =       0.000406101774
  error estimate for blocks of size 2^( 3) =       0.000414870067
  error estimate for blocks of size 2^( 4) =       0.000421110370
  error estimate for blocks of size 2^( 5) =       0.000424354846
  error estimate for blocks of size 2^( 6) =       0.000426141155
  error estimate for blocks of size 2^( 7) =       0.000425073300

      target function =                  N/A
              le_mean =     -17.216471384839
             les_mean =     296.721211152293
             stat err =       0.000424169918
             autocorr =       1.144805427963
              std dev =       0.560646380947
             le_variance =       0.314324364469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314420104331
                                         uncertainty =       0.002481242297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314420104331
                                         uncertainty =       0.002481242297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396442384
  error estimate for blocks of size 2^( 2) =       0.000406107364
  error estimate for blocks of size 2^( 3) =       0.000414875517
  error estimate for blocks of size 2^( 4) =       0.000421115666
  error estimate for blocks of size 2^( 5) =       0.000424359712
  error estimate for blocks of size 2^( 6) =       0.000426146348
  error estimate for blocks of size 2^( 7) =       0.000425078948

      target function =                  N/A
              le_mean =     -17.216471493842
             les_mean =     296.721223669404
             stat err =       0.000424175168
             autocorr =       1.144801850888
              std dev =       0.560654196731
             le_variance =       0.314333128312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216471510184        initial  <--
     2.3842e+00     2.3842e+01             5.6113e-05       -17.216471322317
     9.5367e+00     9.5367e+01             1.3976e-05       -17.216471384839
     3.8147e+01     3.8147e+02             3.5317e-06       -17.216471493842

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.1537
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.073625e-01 1 1  ON 0
 uu_1                 4.375671e-02 1 1  ON 1
 uu_2                -5.312010e-02 1 1  ON 2
 uu_3                -1.106417e-01 1 1  ON 3
 uu_4                -1.473586e-01 1 1  ON 4
 uu_5                -1.595131e-01 1 1  ON 5
 uu_6                -1.460752e-01 1 1  ON 6
 uu_7                -9.605806e-02 1 1  ON 7
 uu_8                -1.431610e-03 1 1  ON 8
 uu_9                 2.066820e-01 1 1  ON 9
 ud_0                 3.603971e-01 1 1  ON 10
 ud_1                 1.008901e-01 1 1  ON 11
 ud_2                -1.080616e-02 1 1  ON 12
 ud_3                -7.381796e-02 1 1  ON 13
 ud_4                -1.239128e-01 1 1  ON 14
 ud_5                -1.593584e-01 1 1  ON 15
 ud_6                -1.699322e-01 1 1  ON 16
 ud_7                -1.426650e-01 1 1  ON 17
 ud_8                -7.190812e-02 1 1  ON 18
 ud_9                 7.870040e-02 1 1  ON 19
 eO_0                -8.963865e-01 1 1  ON 20
 eO_1                -5.702596e-01 1 1  ON 21
 eO_2                -1.497645e-01 1 1  ON 22
 eO_3                 1.246319e-01 1 1  ON 23
 eO_4                 2.500002e-01 1 1  ON 24
 eO_5                 3.252353e-01 1 1  ON 25
 eO_6                 3.531832e-01 1 1  ON 26
 eO_7                 4.011068e-01 1 1  ON 27
 eO_8                 1.013939e-01 1 1  ON 28
 eO_9                 3.820604e-02 1 1  ON 29
eH1_0                -2.030362e-01 1 1  ON 30
eH1_1                -1.237771e-01 1 1  ON 31
eH1_2                -8.179540e-02 1 1  ON 32
eH1_3                -4.452063e-02 1 1  ON 33
eH1_4                 8.514099e-04 1 1  ON 34
eH1_5                 1.139056e-02 1 1  ON 35
eH1_6                 4.986875e-02 1 1  ON 36
eH1_7                 4.761294e-02 1 1  ON 37
eH1_8                 2.187928e-01 1 1  ON 38
eH1_9                 8.401164e-02 1 1  ON 39
eH2_0                -2.034044e-01 1 1  ON 40
eH2_1                -1.236686e-01 1 1  ON 41
eH2_2                -8.163998e-02 1 1  ON 42
eH2_3                -4.455243e-02 1 1  ON 43
eH2_4                 8.515537e-04 1 1  ON 44
eH2_5                 1.164246e-02 1 1  ON 45
eH2_6                 5.371700e-02 1 1  ON 46
eH2_7                 6.392867e-02 1 1  ON 47
eH2_8                 2.111560e-01 1 1  ON 48
eH2_9                 8.148960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.242111
====================================================
  Execution time = 3.2641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1778e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317636712282
                                         uncertainty =       0.005030005421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317636712282
                                         uncertainty =       0.005030005421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398610692
  error estimate for blocks of size 2^( 2) =       0.000408428734
  error estimate for blocks of size 2^( 3) =       0.000417311999
  error estimate for blocks of size 2^( 4) =       0.000423246297
  error estimate for blocks of size 2^( 5) =       0.000426915259
  error estimate for blocks of size 2^( 6) =       0.000429305501
  error estimate for blocks of size 2^( 7) =       0.000431720765

      target function =                  N/A
              le_mean =     -17.216803887829
             les_mean =     296.736116920191
             stat err =       0.000427796955
             autocorr =       1.151801108171
              std dev =       0.563720646339
             le_variance =       0.317780967109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680388783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216803887829       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803897430       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803891314       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803878231       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216803880570       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216803878481       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216803882715       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 6.488833e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216803887829       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803890252       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803888712       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803885404       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216803885998       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216803885467       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216803886509       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.637176e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216803887829       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803888437       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803888051       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803887221       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216803887371       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216803887237       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216803887497       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.102428e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381575 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1600e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.073609e-01 1 1  ON 0
 uu_1                 4.375715e-02 1 1  ON 1
 uu_2                -5.311953e-02 1 1  ON 2
 uu_3                -1.106412e-01 1 1  ON 3
 uu_4                -1.473595e-01 1 1  ON 4
 uu_5                -1.595123e-01 1 1  ON 5
 uu_6                -1.460752e-01 1 1  ON 6
 uu_7                -9.605816e-02 1 1  ON 7
 uu_8                -1.431560e-03 1 1  ON 8
 uu_9                 2.066819e-01 1 1  ON 9
 ud_0                 3.603971e-01 1 1  ON 10
 ud_1                 1.008896e-01 1 1  ON 11
 ud_2                -1.080472e-02 1 1  ON 12
 ud_3                -7.381798e-02 1 1  ON 13
 ud_4                -1.239127e-01 1 1  ON 14
 ud_5                -1.593579e-01 1 1  ON 15
 ud_6                -1.699327e-01 1 1  ON 16
 ud_7                -1.426654e-01 1 1  ON 17
 ud_8                -7.190844e-02 1 1  ON 18
 ud_9                 7.870008e-02 1 1  ON 19
 eO_0                -8.963870e-01 1 1  ON 20
 eO_1                -5.702595e-01 1 1  ON 21
 eO_2                -1.497649e-01 1 1  ON 22
 eO_3                 1.246324e-01 1 1  ON 23
 eO_4                 2.500004e-01 1 1  ON 24
 eO_5                 3.252352e-01 1 1  ON 25
 eO_6                 3.531827e-01 1 1  ON 26
 eO_7                 4.011070e-01 1 1  ON 27
 eO_8                 1.013942e-01 1 1  ON 28
 eO_9                 3.820607e-02 1 1  ON 29
eH1_0                -2.030365e-01 1 1  ON 30
eH1_1                -1.237775e-01 1 1  ON 31
eH1_2                -8.179628e-02 1 1  ON 32
eH1_3                -4.452176e-02 1 1  ON 33
eH1_4                 8.524688e-04 1 1  ON 34
eH1_5                 1.139158e-02 1 1  ON 35
eH1_6                 4.986926e-02 1 1  ON 36
eH1_7                 4.761304e-02 1 1  ON 37
eH1_8                 2.187926e-01 1 1  ON 38
eH1_9                 8.401176e-02 1 1  ON 39
eH2_0                -2.034045e-01 1 1  ON 40
eH2_1                -1.236689e-01 1 1  ON 41
eH2_2                -8.164069e-02 1 1  ON 42
eH2_3                -4.455286e-02 1 1  ON 43
eH2_4                 8.521137e-04 1 1  ON 44
eH2_5                 1.164296e-02 1 1  ON 45
eH2_6                 5.371716e-02 1 1  ON 46
eH2_7                 6.392883e-02 1 1  ON 47
eH2_8                 2.111560e-01 1 1  ON 48
eH2_9                 8.148970e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1798
    reference variance = 0.391735
====================================================
  Execution time = 3.2003e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1709e-01
  Total weights = 2.0000e+06
  Execution time = 2.9817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317104568595
                                         uncertainty =       0.003717212401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317104568595
                                         uncertainty =       0.003717212401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398175980
  error estimate for blocks of size 2^( 2) =       0.000407743075
  error estimate for blocks of size 2^( 3) =       0.000415909543
  error estimate for blocks of size 2^( 4) =       0.000421239277
  error estimate for blocks of size 2^( 5) =       0.000424824298
  error estimate for blocks of size 2^( 6) =       0.000427976267
  error estimate for blocks of size 2^( 7) =       0.000427296580

      target function =                  N/A
              le_mean =     -17.217067162824
             les_mean =     296.744489752735
             stat err =       0.000425334105
             autocorr =       1.141064780420
              std dev =       0.563105871124
             le_variance =       0.317088222094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317100328304
                                         uncertainty =       0.003717062434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317100328304
                                         uncertainty =       0.003717062434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398173317
  error estimate for blocks of size 2^( 2) =       0.000407740620
  error estimate for blocks of size 2^( 3) =       0.000415907218
  error estimate for blocks of size 2^( 4) =       0.000421236971
  error estimate for blocks of size 2^( 5) =       0.000424822010
  error estimate for blocks of size 2^( 6) =       0.000427974017
  error estimate for blocks of size 2^( 7) =       0.000427294317

      target function =                  N/A
              le_mean =     -17.217067171674
             les_mean =     296.744485816370
             stat err =       0.000425331829
             autocorr =       1.141067826416
              std dev =       0.563102105289
             le_variance =       0.317083980981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317102424602
                                         uncertainty =       0.003717136063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317102424602
                                         uncertainty =       0.003717136063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398174634
  error estimate for blocks of size 2^( 2) =       0.000407741834
  error estimate for blocks of size 2^( 3) =       0.000415908368
  error estimate for blocks of size 2^( 4) =       0.000421238111
  error estimate for blocks of size 2^( 5) =       0.000424823142
  error estimate for blocks of size 2^( 6) =       0.000427975130
  error estimate for blocks of size 2^( 7) =       0.000427295436

      target function =                  N/A
              le_mean =     -17.217067167112
             les_mean =     296.744487755958
             stat err =       0.000425332955
             autocorr =       1.141066322468
              std dev =       0.563103967016
             le_variance =       0.317086077670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317104299790
                                         uncertainty =       0.003717202815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317104299790
                                         uncertainty =       0.003717202815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398175811
  error estimate for blocks of size 2^( 2) =       0.000407742919
  error estimate for blocks of size 2^( 3) =       0.000415909396
  error estimate for blocks of size 2^( 4) =       0.000421239130
  error estimate for blocks of size 2^( 5) =       0.000424824153
  error estimate for blocks of size 2^( 6) =       0.000427976125
  error estimate for blocks of size 2^( 7) =       0.000427296436

      target function =                  N/A
              le_mean =     -17.217067163350
             les_mean =     296.744489501979
             stat err =       0.000425333961
             autocorr =       1.141064973770
              std dev =       0.563105632395
             le_variance =       0.317087953235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217067162824        initial
     2.3842e+01     2.3842e+02             6.4888e-06       -17.217067171674  <--
     9.5367e+01     9.5367e+02             1.6372e-06       -17.217067167112
     3.8147e+02     3.8147e+03             4.1024e-07       -17.217067163350

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 4.7039e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.073561e-01 1 1  ON 0
 uu_1                 4.375847e-02 1 1  ON 1
 uu_2                -5.311786e-02 1 1  ON 2
 uu_3                -1.106397e-01 1 1  ON 3
 uu_4                -1.473623e-01 1 1  ON 4
 uu_5                -1.595099e-01 1 1  ON 5
 uu_6                -1.460751e-01 1 1  ON 6
 uu_7                -9.605844e-02 1 1  ON 7
 uu_8                -1.431409e-03 1 1  ON 8
 uu_9                 2.066814e-01 1 1  ON 9
 ud_0                 3.603968e-01 1 1  ON 10
 ud_1                 1.008884e-01 1 1  ON 11
 ud_2                -1.080050e-02 1 1  ON 12
 ud_3                -7.381799e-02 1 1  ON 13
 ud_4                -1.239127e-01 1 1  ON 14
 ud_5                -1.593566e-01 1 1  ON 15
 ud_6                -1.699345e-01 1 1  ON 16
 ud_7                -1.426668e-01 1 1  ON 17
 ud_8                -7.190939e-02 1 1  ON 18
 ud_9                 7.869912e-02 1 1  ON 19
 eO_0                -8.963882e-01 1 1  ON 20
 eO_1                -5.702592e-01 1 1  ON 21
 eO_2                -1.497661e-01 1 1  ON 22
 eO_3                 1.246340e-01 1 1  ON 23
 eO_4                 2.500008e-01 1 1  ON 24
 eO_5                 3.252351e-01 1 1  ON 25
 eO_6                 3.531813e-01 1 1  ON 26
 eO_7                 4.011077e-01 1 1  ON 27
 eO_8                 1.013950e-01 1 1  ON 28
 eO_9                 3.820616e-02 1 1  ON 29
eH1_0                -2.030375e-01 1 1  ON 30
eH1_1                -1.237786e-01 1 1  ON 31
eH1_2                -8.179893e-02 1 1  ON 32
eH1_3                -4.452510e-02 1 1  ON 33
eH1_4                 8.556247e-04 1 1  ON 34
eH1_5                 1.139463e-02 1 1  ON 35
eH1_6                 4.987079e-02 1 1  ON 36
eH1_7                 4.761335e-02 1 1  ON 37
eH1_8                 2.187922e-01 1 1  ON 38
eH1_9                 8.401212e-02 1 1  ON 39
eH2_0                -2.034049e-01 1 1  ON 40
eH2_1                -1.236697e-01 1 1  ON 41
eH2_2                -8.164283e-02 1 1  ON 42
eH2_3                -4.455412e-02 1 1  ON 43
eH2_4                 8.537868e-04 1 1  ON 44
eH2_5                 1.164446e-02 1 1  ON 45
eH2_6                 5.371765e-02 1 1  ON 46
eH2_7                 6.392933e-02 1 1  ON 47
eH2_8                 2.111560e-01 1 1  ON 48
eH2_9                 8.148998e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8979e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.255
    reference variance = 0.379554
====================================================
  Execution time = 3.2819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320747684458
                                         uncertainty =       0.003893504856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320747684458
                                         uncertainty =       0.003893504856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400462878
  error estimate for blocks of size 2^( 2) =       0.000409756425
  error estimate for blocks of size 2^( 3) =       0.000418119710
  error estimate for blocks of size 2^( 4) =       0.000424633336
  error estimate for blocks of size 2^( 5) =       0.000428056455
  error estimate for blocks of size 2^( 6) =       0.000429429546
  error estimate for blocks of size 2^( 7) =       0.000428961427

      target function =                  N/A
              le_mean =     -17.216594071007
             les_mean =     296.731852279037
             stat err =       0.000427770191
             autocorr =       1.141028537624
              std dev =       0.566340033538
             le_variance =       0.320741033587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659407101e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216594071007       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216594063311       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216594160158       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216594254653       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216594160452       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216594179117       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.507240e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216594071007       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216594069026       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216594093902       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216594118825       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216594094590       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216594099452       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 6.457084e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216594071007       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216594070508       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216594076770       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216594083087       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216594076986       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216594078214       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.626546e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383479 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1779e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.073579e-01 1 1  ON 0
 uu_1                 4.375478e-02 1 1  ON 1
 uu_2                -5.311630e-02 1 1  ON 2
 uu_3                -1.106379e-01 1 1  ON 3
 uu_4                -1.473650e-01 1 1  ON 4
 uu_5                -1.595072e-01 1 1  ON 5
 uu_6                -1.460754e-01 1 1  ON 6
 uu_7                -9.605946e-02 1 1  ON 7
 uu_8                -1.432159e-03 1 1  ON 8
 uu_9                 2.066809e-01 1 1  ON 9
 ud_0                 3.603955e-01 1 1  ON 10
 ud_1                 1.008883e-01 1 1  ON 11
 ud_2                -1.079914e-02 1 1  ON 12
 ud_3                -7.381761e-02 1 1  ON 13
 ud_4                -1.239117e-01 1 1  ON 14
 ud_5                -1.593566e-01 1 1  ON 15
 ud_6                -1.699328e-01 1 1  ON 16
 ud_7                -1.426677e-01 1 1  ON 17
 ud_8                -7.191089e-02 1 1  ON 18
 ud_9                 7.869780e-02 1 1  ON 19
 eO_0                -8.963867e-01 1 1  ON 20
 eO_1                -5.702616e-01 1 1  ON 21
 eO_2                -1.497665e-01 1 1  ON 22
 eO_3                 1.246341e-01 1 1  ON 23
 eO_4                 2.499992e-01 1 1  ON 24
 eO_5                 3.252370e-01 1 1  ON 25
 eO_6                 3.531808e-01 1 1  ON 26
 eO_7                 4.011082e-01 1 1  ON 27
 eO_8                 1.013956e-01 1 1  ON 28
 eO_9                 3.820632e-02 1 1  ON 29
eH1_0                -2.030406e-01 1 1  ON 30
eH1_1                -1.237778e-01 1 1  ON 31
eH1_2                -8.179828e-02 1 1  ON 32
eH1_3                -4.452498e-02 1 1  ON 33
eH1_4                 8.576100e-04 1 1  ON 34
eH1_5                 1.139452e-02 1 1  ON 35
eH1_6                 4.986979e-02 1 1  ON 36
eH1_7                 4.761357e-02 1 1  ON 37
eH1_8                 2.187920e-01 1 1  ON 38
eH1_9                 8.401250e-02 1 1  ON 39
eH2_0                -2.034034e-01 1 1  ON 40
eH2_1                -1.236745e-01 1 1  ON 41
eH2_2                -8.164343e-02 1 1  ON 42
eH2_3                -4.454767e-02 1 1  ON 43
eH2_4                 8.498610e-04 1 1  ON 44
eH2_5                 1.164379e-02 1 1  ON 45
eH2_6                 5.371939e-02 1 1  ON 46
eH2_7                 6.392995e-02 1 1  ON 47
eH2_8                 2.111555e-01 1 1  ON 48
eH2_9                 8.149007e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2029
    reference variance = 0.181109
====================================================
  Execution time = 3.2020e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2283e-01
  Total weights = 2.0000e+06
  Execution time = 2.9921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322689150182
                                         uncertainty =       0.003705444832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322689150182
                                         uncertainty =       0.003705444832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401765149
  error estimate for blocks of size 2^( 2) =       0.000411037896
  error estimate for blocks of size 2^( 3) =       0.000420317422
  error estimate for blocks of size 2^( 4) =       0.000425702495
  error estimate for blocks of size 2^( 5) =       0.000430083525
  error estimate for blocks of size 2^( 6) =       0.000431226974
  error estimate for blocks of size 2^( 7) =       0.000432174076

      target function =                  N/A
              le_mean =     -17.217381222623
             les_mean =     296.761046474217
             stat err =       0.000429796768
             autocorr =       1.144410323401
              std dev =       0.568181723126
             le_variance =       0.322830470494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322676974122
                                         uncertainty =       0.003705457383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322676974122
                                         uncertainty =       0.003705457383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401757580
  error estimate for blocks of size 2^( 2) =       0.000411030615
  error estimate for blocks of size 2^( 3) =       0.000420310231
  error estimate for blocks of size 2^( 4) =       0.000425695540
  error estimate for blocks of size 2^( 5) =       0.000430076164
  error estimate for blocks of size 2^( 6) =       0.000431219203
  error estimate for blocks of size 2^( 7) =       0.000432166024

      target function =                  N/A
              le_mean =     -17.217381132078
             les_mean =     296.761031191847
             stat err =       0.000429789233
             autocorr =       1.144413320052
              std dev =       0.568171018296
             le_variance =       0.322818306031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322682780083
                                         uncertainty =       0.003705449952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322682780083
                                         uncertainty =       0.003705449952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401761189
  error estimate for blocks of size 2^( 2) =       0.000411034088
  error estimate for blocks of size 2^( 3) =       0.000420313661
  error estimate for blocks of size 2^( 4) =       0.000425698858
  error estimate for blocks of size 2^( 5) =       0.000430079676
  error estimate for blocks of size 2^( 6) =       0.000431222910
  error estimate for blocks of size 2^( 7) =       0.000432169866

      target function =                  N/A
              le_mean =     -17.217381174163
             les_mean =     296.761038441586
             stat err =       0.000429792827
             autocorr =       1.144411898927
              std dev =       0.568176122839
             le_variance =       0.322824106565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322688344026
                                         uncertainty =       0.003705445431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322688344026
                                         uncertainty =       0.003705445431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401764648
  error estimate for blocks of size 2^( 2) =       0.000411037414
  error estimate for blocks of size 2^( 3) =       0.000420316946
  error estimate for blocks of size 2^( 4) =       0.000425702035
  error estimate for blocks of size 2^( 5) =       0.000430083038
  error estimate for blocks of size 2^( 6) =       0.000431226460
  error estimate for blocks of size 2^( 7) =       0.000432173544

      target function =                  N/A
              le_mean =     -17.217381216388
             les_mean =     296.761045454127
             stat err =       0.000429796269
             autocorr =       1.144410522710
              std dev =       0.568181014397
             le_variance =       0.322829665121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217381222623        initial  <--
     5.9605e+00     5.9605e+01             2.5072e-05       -17.217381132078
     2.3842e+01     2.3842e+02             6.4571e-06       -17.217381174163
     9.5367e+01     9.5367e+02             1.6265e-06       -17.217381216388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.3652
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.073561e-01 1 1  ON 0
 uu_1                 4.375847e-02 1 1  ON 1
 uu_2                -5.311786e-02 1 1  ON 2
 uu_3                -1.106397e-01 1 1  ON 3
 uu_4                -1.473623e-01 1 1  ON 4
 uu_5                -1.595099e-01 1 1  ON 5
 uu_6                -1.460751e-01 1 1  ON 6
 uu_7                -9.605844e-02 1 1  ON 7
 uu_8                -1.431409e-03 1 1  ON 8
 uu_9                 2.066814e-01 1 1  ON 9
 ud_0                 3.603968e-01 1 1  ON 10
 ud_1                 1.008884e-01 1 1  ON 11
 ud_2                -1.080050e-02 1 1  ON 12
 ud_3                -7.381799e-02 1 1  ON 13
 ud_4                -1.239127e-01 1 1  ON 14
 ud_5                -1.593566e-01 1 1  ON 15
 ud_6                -1.699345e-01 1 1  ON 16
 ud_7                -1.426668e-01 1 1  ON 17
 ud_8                -7.190939e-02 1 1  ON 18
 ud_9                 7.869912e-02 1 1  ON 19
 eO_0                -8.963882e-01 1 1  ON 20
 eO_1                -5.702592e-01 1 1  ON 21
 eO_2                -1.497661e-01 1 1  ON 22
 eO_3                 1.246340e-01 1 1  ON 23
 eO_4                 2.500008e-01 1 1  ON 24
 eO_5                 3.252351e-01 1 1  ON 25
 eO_6                 3.531813e-01 1 1  ON 26
 eO_7                 4.011077e-01 1 1  ON 27
 eO_8                 1.013950e-01 1 1  ON 28
 eO_9                 3.820616e-02 1 1  ON 29
eH1_0                -2.030375e-01 1 1  ON 30
eH1_1                -1.237786e-01 1 1  ON 31
eH1_2                -8.179893e-02 1 1  ON 32
eH1_3                -4.452510e-02 1 1  ON 33
eH1_4                 8.556247e-04 1 1  ON 34
eH1_5                 1.139463e-02 1 1  ON 35
eH1_6                 4.987079e-02 1 1  ON 36
eH1_7                 4.761335e-02 1 1  ON 37
eH1_8                 2.187922e-01 1 1  ON 38
eH1_9                 8.401212e-02 1 1  ON 39
eH2_0                -2.034049e-01 1 1  ON 40
eH2_1                -1.236697e-01 1 1  ON 41
eH2_2                -8.164283e-02 1 1  ON 42
eH2_3                -4.455412e-02 1 1  ON 43
eH2_4                 8.537868e-04 1 1  ON 44
eH2_5                 1.164446e-02 1 1  ON 45
eH2_6                 5.371765e-02 1 1  ON 46
eH2_7                 6.392933e-02 1 1  ON 47
eH2_8                 2.111560e-01 1 1  ON 48
eH2_9                 8.148998e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1567
    reference variance = 0.255735
====================================================
  Execution time = 3.2346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2791e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327993210490
                                         uncertainty =       0.006496616195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327993210490
                                         uncertainty =       0.006496616195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404912819
  error estimate for blocks of size 2^( 2) =       0.000414436802
  error estimate for blocks of size 2^( 3) =       0.000422426899
  error estimate for blocks of size 2^( 4) =       0.000428263268
  error estimate for blocks of size 2^( 5) =       0.000431406694
  error estimate for blocks of size 2^( 6) =       0.000434259972
  error estimate for blocks of size 2^( 7) =       0.000435964246

      target function =                  N/A
              le_mean =     -17.217127510724
             les_mean =     296.757388338400
             stat err =       0.000432473545
             autocorr =       1.140764610768
              std dev =       0.572633200065
             le_variance =       0.327908781817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712751072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217127510724       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217127514761       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217127518105       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217127517578       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217127511416       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217127514135       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217127514485       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.951594e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217127510724       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217127511736       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217127512579       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217127512448       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217127510900       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217127511583       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217127511673       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 7.407509e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217127510724       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217127510977       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217127511188       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217127511155       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217127510768       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217127510939       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217127510961       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.853675e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389493 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1317e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.073558e-01 1 1  ON 0
 uu_1                 4.375830e-02 1 1  ON 1
 uu_2                -5.311727e-02 1 1  ON 2
 uu_3                -1.106398e-01 1 1  ON 3
 uu_4                -1.473622e-01 1 1  ON 4
 uu_5                -1.595098e-01 1 1  ON 5
 uu_6                -1.460751e-01 1 1  ON 6
 uu_7                -9.605838e-02 1 1  ON 7
 uu_8                -1.431534e-03 1 1  ON 8
 uu_9                 2.066813e-01 1 1  ON 9
 ud_0                 3.603970e-01 1 1  ON 10
 ud_1                 1.008881e-01 1 1  ON 11
 ud_2                -1.080008e-02 1 1  ON 12
 ud_3                -7.381798e-02 1 1  ON 13
 ud_4                -1.239123e-01 1 1  ON 14
 ud_5                -1.593566e-01 1 1  ON 15
 ud_6                -1.699345e-01 1 1  ON 16
 ud_7                -1.426669e-01 1 1  ON 17
 ud_8                -7.190975e-02 1 1  ON 18
 ud_9                 7.869889e-02 1 1  ON 19
 eO_0                -8.963881e-01 1 1  ON 20
 eO_1                -5.702589e-01 1 1  ON 21
 eO_2                -1.497669e-01 1 1  ON 22
 eO_3                 1.246342e-01 1 1  ON 23
 eO_4                 2.500008e-01 1 1  ON 24
 eO_5                 3.252352e-01 1 1  ON 25
 eO_6                 3.531812e-01 1 1  ON 26
 eO_7                 4.011077e-01 1 1  ON 27
 eO_8                 1.013950e-01 1 1  ON 28
 eO_9                 3.820615e-02 1 1  ON 29
eH1_0                -2.030372e-01 1 1  ON 30
eH1_1                -1.237790e-01 1 1  ON 31
eH1_2                -8.179956e-02 1 1  ON 32
eH1_3                -4.452483e-02 1 1  ON 33
eH1_4                 8.558344e-04 1 1  ON 34
eH1_5                 1.139472e-02 1 1  ON 35
eH1_6                 4.987084e-02 1 1  ON 36
eH1_7                 4.761349e-02 1 1  ON 37
eH1_8                 2.187921e-01 1 1  ON 38
eH1_9                 8.401213e-02 1 1  ON 39
eH2_0                -2.034047e-01 1 1  ON 40
eH2_1                -1.236699e-01 1 1  ON 41
eH2_2                -8.164315e-02 1 1  ON 42
eH2_3                -4.455391e-02 1 1  ON 43
eH2_4                 8.537692e-04 1 1  ON 44
eH2_5                 1.164479e-02 1 1  ON 45
eH2_6                 5.371760e-02 1 1  ON 46
eH2_7                 6.392924e-02 1 1  ON 47
eH2_8                 2.111559e-01 1 1  ON 48
eH2_9                 8.148999e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.203
    reference variance = 0.261122
====================================================
  Execution time = 3.1747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2535e-01
  Total weights = 2.0000e+06
  Execution time = 2.9877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325328055110
                                         uncertainty =       0.005222239500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325328055110
                                         uncertainty =       0.005222239500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403328046
  error estimate for blocks of size 2^( 2) =       0.000412736161
  error estimate for blocks of size 2^( 3) =       0.000421172349
  error estimate for blocks of size 2^( 4) =       0.000427258395
  error estimate for blocks of size 2^( 5) =       0.000431387959
  error estimate for blocks of size 2^( 6) =       0.000435203713
  error estimate for blocks of size 2^( 7) =       0.000436267530

      target function =                  N/A
              le_mean =     -17.215841853888
             les_mean =     296.710557600407
             stat err =       0.000432529399
             autocorr =       1.150043902669
              std dev =       0.570391992413
             le_variance =       0.325347025009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325327522621
                                         uncertainty =       0.005222239257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325327522621
                                         uncertainty =       0.005222239257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403327716
  error estimate for blocks of size 2^( 2) =       0.000412735839
  error estimate for blocks of size 2^( 3) =       0.000421172003
  error estimate for blocks of size 2^( 4) =       0.000427258075
  error estimate for blocks of size 2^( 5) =       0.000431387693
  error estimate for blocks of size 2^( 6) =       0.000435203419
  error estimate for blocks of size 2^( 7) =       0.000436267286

      target function =                  N/A
              le_mean =     -17.215841856354
             les_mean =     296.710557153066
             stat err =       0.000432529119
             autocorr =       1.150044291855
              std dev =       0.570391525850
             le_variance =       0.325346492761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325327787751
                                         uncertainty =       0.005222239368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325327787751
                                         uncertainty =       0.005222239368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403327880
  error estimate for blocks of size 2^( 2) =       0.000412736000
  error estimate for blocks of size 2^( 3) =       0.000421172175
  error estimate for blocks of size 2^( 4) =       0.000427258235
  error estimate for blocks of size 2^( 5) =       0.000431387826
  error estimate for blocks of size 2^( 6) =       0.000435203565
  error estimate for blocks of size 2^( 7) =       0.000436267408

      target function =                  N/A
              le_mean =     -17.215841855116
             les_mean =     296.710557375477
             stat err =       0.000432529258
             autocorr =       1.150044098322
              std dev =       0.570391758155
             le_variance =       0.325346757772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325328021644
                                         uncertainty =       0.005222239483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325328021644
                                         uncertainty =       0.005222239483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403328025
  error estimate for blocks of size 2^( 2) =       0.000412736141
  error estimate for blocks of size 2^( 3) =       0.000421172327
  error estimate for blocks of size 2^( 4) =       0.000427258375
  error estimate for blocks of size 2^( 5) =       0.000431387942
  error estimate for blocks of size 2^( 6) =       0.000435203694
  error estimate for blocks of size 2^( 7) =       0.000436267515

      target function =                  N/A
              le_mean =     -17.215841854040
             les_mean =     296.710557572198
             stat err =       0.000432529382
             autocorr =       1.150043927151
              std dev =       0.570391963090
             le_variance =       0.325346991558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215841853888        initial
     5.9605e+01     5.9605e+02             2.9516e-06       -17.215841856354  <--
     2.3842e+02     2.3842e+03             7.4075e-07       -17.215841855116
     9.5367e+02     9.5367e+03             1.8537e-07       -17.215841854040

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 4.6816e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.073549e-01 1 1  ON 0
 uu_1                 4.375780e-02 1 1  ON 1
 uu_2                -5.311551e-02 1 1  ON 2
 uu_3                -1.106402e-01 1 1  ON 3
 uu_4                -1.473621e-01 1 1  ON 4
 uu_5                -1.595093e-01 1 1  ON 5
 uu_6                -1.460753e-01 1 1  ON 6
 uu_7                -9.605820e-02 1 1  ON 7
 uu_8                -1.431909e-03 1 1  ON 8
 uu_9                 2.066809e-01 1 1  ON 9
 ud_0                 3.603976e-01 1 1  ON 10
 ud_1                 1.008872e-01 1 1  ON 11
 ud_2                -1.079883e-02 1 1  ON 12
 ud_3                -7.381795e-02 1 1  ON 13
 ud_4                -1.239110e-01 1 1  ON 14
 ud_5                -1.593565e-01 1 1  ON 15
 ud_6                -1.699348e-01 1 1  ON 16
 ud_7                -1.426672e-01 1 1  ON 17
 ud_8                -7.191084e-02 1 1  ON 18
 ud_9                 7.869820e-02 1 1  ON 19
 eO_0                -8.963879e-01 1 1  ON 20
 eO_1                -5.702581e-01 1 1  ON 21
 eO_2                -1.497691e-01 1 1  ON 22
 eO_3                 1.246350e-01 1 1  ON 23
 eO_4                 2.500009e-01 1 1  ON 24
 eO_5                 3.252355e-01 1 1  ON 25
 eO_6                 3.531811e-01 1 1  ON 26
 eO_7                 4.011079e-01 1 1  ON 27
 eO_8                 1.013951e-01 1 1  ON 28
 eO_9                 3.820611e-02 1 1  ON 29
eH1_0                -2.030362e-01 1 1  ON 30
eH1_1                -1.237803e-01 1 1  ON 31
eH1_2                -8.180143e-02 1 1  ON 32
eH1_3                -4.452403e-02 1 1  ON 33
eH1_4                 8.564641e-04 1 1  ON 34
eH1_5                 1.139497e-02 1 1  ON 35
eH1_6                 4.987098e-02 1 1  ON 36
eH1_7                 4.761389e-02 1 1  ON 37
eH1_8                 2.187920e-01 1 1  ON 38
eH1_9                 8.401216e-02 1 1  ON 39
eH2_0                -2.034043e-01 1 1  ON 40
eH2_1                -1.236704e-01 1 1  ON 41
eH2_2                -8.164413e-02 1 1  ON 42
eH2_3                -4.455329e-02 1 1  ON 43
eH2_4                 8.537187e-04 1 1  ON 44
eH2_5                 1.164579e-02 1 1  ON 45
eH2_6                 5.371745e-02 1 1  ON 46
eH2_7                 6.392896e-02 1 1  ON 47
eH2_8                 2.111558e-01 1 1  ON 48
eH2_9                 8.149004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1542
    reference variance = 0.229119
====================================================
  Execution time = 3.2239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2211e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153310778
                                         uncertainty =       0.002996735471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153310778
                                         uncertainty =       0.002996735471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401317332
  error estimate for blocks of size 2^( 2) =       0.000411001551
  error estimate for blocks of size 2^( 3) =       0.000419692447
  error estimate for blocks of size 2^( 4) =       0.000426048926
  error estimate for blocks of size 2^( 5) =       0.000429497381
  error estimate for blocks of size 2^( 6) =       0.000432674963
  error estimate for blocks of size 2^( 7) =       0.000436008478

      target function =                  N/A
              le_mean =     -17.216387870678
             les_mean =     296.726122354873
             stat err =       0.000431057437
             autocorr =       1.153704141291
              std dev =       0.567548414059
             le_variance =       0.322111202301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638787068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216387870678       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387898619       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216387922995       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216387930274       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216387922530       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216387934647       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216387924653       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 9.582149e-06

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216387870678       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387877726       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216387883909       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216387885728       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216387883634       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216387886650       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216387884191       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.424460e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216387870678       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387872444       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216387873995       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216387874450       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216387873916       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216387874669       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216387874057       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 6.079570e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395546 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1258e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.073539e-01 1 1  ON 0
 uu_1                 4.375780e-02 1 1  ON 1
 uu_2                -5.311374e-02 1 1  ON 2
 uu_3                -1.106409e-01 1 1  ON 3
 uu_4                -1.473633e-01 1 1  ON 4
 uu_5                -1.595103e-01 1 1  ON 5
 uu_6                -1.460758e-01 1 1  ON 6
 uu_7                -9.605777e-02 1 1  ON 7
 uu_8                -1.431684e-03 1 1  ON 8
 uu_9                 2.066810e-01 1 1  ON 9
 ud_0                 3.603980e-01 1 1  ON 10
 ud_1                 1.008850e-01 1 1  ON 11
 ud_2                -1.079940e-02 1 1  ON 12
 ud_3                -7.381861e-02 1 1  ON 13
 ud_4                -1.239106e-01 1 1  ON 14
 ud_5                -1.593568e-01 1 1  ON 15
 ud_6                -1.699350e-01 1 1  ON 16
 ud_7                -1.426657e-01 1 1  ON 17
 ud_8                -7.191058e-02 1 1  ON 18
 ud_9                 7.869814e-02 1 1  ON 19
 eO_0                -8.963863e-01 1 1  ON 20
 eO_1                -5.702591e-01 1 1  ON 21
 eO_2                -1.497707e-01 1 1  ON 22
 eO_3                 1.246347e-01 1 1  ON 23
 eO_4                 2.500004e-01 1 1  ON 24
 eO_5                 3.252358e-01 1 1  ON 25
 eO_6                 3.531809e-01 1 1  ON 26
 eO_7                 4.011084e-01 1 1  ON 27
 eO_8                 1.013956e-01 1 1  ON 28
 eO_9                 3.820628e-02 1 1  ON 29
eH1_0                -2.030357e-01 1 1  ON 30
eH1_1                -1.237824e-01 1 1  ON 31
eH1_2                -8.180281e-02 1 1  ON 32
eH1_3                -4.452406e-02 1 1  ON 33
eH1_4                 8.575320e-04 1 1  ON 34
eH1_5                 1.139539e-02 1 1  ON 35
eH1_6                 4.987099e-02 1 1  ON 36
eH1_7                 4.761468e-02 1 1  ON 37
eH1_8                 2.187922e-01 1 1  ON 38
eH1_9                 8.401245e-02 1 1  ON 39
eH2_0                -2.034043e-01 1 1  ON 40
eH2_1                -1.236715e-01 1 1  ON 41
eH2_2                -8.164655e-02 1 1  ON 42
eH2_3                -4.455175e-02 1 1  ON 43
eH2_4                 8.551787e-04 1 1  ON 44
eH2_5                 1.164609e-02 1 1  ON 45
eH2_6                 5.371736e-02 1 1  ON 46
eH2_7                 6.392873e-02 1 1  ON 47
eH2_8                 2.111557e-01 1 1  ON 48
eH2_9                 8.149035e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2312
    reference variance = 0.197267
====================================================
  Execution time = 3.1594e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2406e-01
  Total weights = 2.0000e+06
  Execution time = 2.9819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324118274759
                                         uncertainty =       0.004156488055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324118274759
                                         uncertainty =       0.004156488055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402530431
  error estimate for blocks of size 2^( 2) =       0.000412145231
  error estimate for blocks of size 2^( 3) =       0.000420365769
  error estimate for blocks of size 2^( 4) =       0.000426249489
  error estimate for blocks of size 2^( 5) =       0.000431339615
  error estimate for blocks of size 2^( 6) =       0.000434071119
  error estimate for blocks of size 2^( 7) =       0.000435783503

      target function =                  N/A
              le_mean =     -17.216875822991
             les_mean =     296.744874438185
             stat err =       0.000431860931
             autocorr =       1.151039950514
              std dev =       0.569263994938
             le_variance =       0.324061495933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324121035181
                                         uncertainty =       0.004156503170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324121035181
                                         uncertainty =       0.004156503170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402532148
  error estimate for blocks of size 2^( 2) =       0.000412146837
  error estimate for blocks of size 2^( 3) =       0.000420367304
  error estimate for blocks of size 2^( 4) =       0.000426250990
  error estimate for blocks of size 2^( 5) =       0.000431340993
  error estimate for blocks of size 2^( 6) =       0.000434072382
  error estimate for blocks of size 2^( 7) =       0.000435784920

      target function =                  N/A
              le_mean =     -17.216875815038
             les_mean =     296.744876928213
             stat err =       0.000431862321
             autocorr =       1.151037542372
              std dev =       0.569266422514
             le_variance =       0.324064259802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324119707162
                                         uncertainty =       0.004156496055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324119707162
                                         uncertainty =       0.004156496055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402531322
  error estimate for blocks of size 2^( 2) =       0.000412146065
  error estimate for blocks of size 2^( 3) =       0.000420366567
  error estimate for blocks of size 2^( 4) =       0.000426250270
  error estimate for blocks of size 2^( 5) =       0.000431340332
  error estimate for blocks of size 2^( 6) =       0.000434071778
  error estimate for blocks of size 2^( 7) =       0.000435784242

      target function =                  N/A
              le_mean =     -17.216875818952
             les_mean =     296.744875733276
             stat err =       0.000431861656
             autocorr =       1.151038716534
              std dev =       0.569265254586
             le_variance =       0.324062930079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324118455383
                                         uncertainty =       0.004156489069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324118455383
                                         uncertainty =       0.004156489069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402530543
  error estimate for blocks of size 2^( 2) =       0.000412145337
  error estimate for blocks of size 2^( 3) =       0.000420365870
  error estimate for blocks of size 2^( 4) =       0.000426249587
  error estimate for blocks of size 2^( 5) =       0.000431339705
  error estimate for blocks of size 2^( 6) =       0.000434071202
  error estimate for blocks of size 2^( 7) =       0.000435783596

      target function =                  N/A
              le_mean =     -17.216875822472
             les_mean =     296.744874601149
             stat err =       0.000431861023
             autocorr =       1.151039795279
              std dev =       0.569264153777
             le_variance =       0.324061676776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216875822991        initial  <--
     1.4901e+01     1.4901e+02             9.5821e-06       -17.216875815038
     5.9605e+01     5.9605e+02             2.4245e-06       -17.216875818952
     2.3842e+02     2.3842e+03             6.0796e-07       -17.216875822472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.6468
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.073549e-01 1 1  ON 0
 uu_1                 4.375780e-02 1 1  ON 1
 uu_2                -5.311551e-02 1 1  ON 2
 uu_3                -1.106402e-01 1 1  ON 3
 uu_4                -1.473621e-01 1 1  ON 4
 uu_5                -1.595093e-01 1 1  ON 5
 uu_6                -1.460753e-01 1 1  ON 6
 uu_7                -9.605820e-02 1 1  ON 7
 uu_8                -1.431909e-03 1 1  ON 8
 uu_9                 2.066809e-01 1 1  ON 9
 ud_0                 3.603976e-01 1 1  ON 10
 ud_1                 1.008872e-01 1 1  ON 11
 ud_2                -1.079883e-02 1 1  ON 12
 ud_3                -7.381795e-02 1 1  ON 13
 ud_4                -1.239110e-01 1 1  ON 14
 ud_5                -1.593565e-01 1 1  ON 15
 ud_6                -1.699348e-01 1 1  ON 16
 ud_7                -1.426672e-01 1 1  ON 17
 ud_8                -7.191084e-02 1 1  ON 18
 ud_9                 7.869820e-02 1 1  ON 19
 eO_0                -8.963879e-01 1 1  ON 20
 eO_1                -5.702581e-01 1 1  ON 21
 eO_2                -1.497691e-01 1 1  ON 22
 eO_3                 1.246350e-01 1 1  ON 23
 eO_4                 2.500009e-01 1 1  ON 24
 eO_5                 3.252355e-01 1 1  ON 25
 eO_6                 3.531811e-01 1 1  ON 26
 eO_7                 4.011079e-01 1 1  ON 27
 eO_8                 1.013951e-01 1 1  ON 28
 eO_9                 3.820611e-02 1 1  ON 29
eH1_0                -2.030362e-01 1 1  ON 30
eH1_1                -1.237803e-01 1 1  ON 31
eH1_2                -8.180143e-02 1 1  ON 32
eH1_3                -4.452403e-02 1 1  ON 33
eH1_4                 8.564641e-04 1 1  ON 34
eH1_5                 1.139497e-02 1 1  ON 35
eH1_6                 4.987098e-02 1 1  ON 36
eH1_7                 4.761389e-02 1 1  ON 37
eH1_8                 2.187920e-01 1 1  ON 38
eH1_9                 8.401216e-02 1 1  ON 39
eH2_0                -2.034043e-01 1 1  ON 40
eH2_1                -1.236704e-01 1 1  ON 41
eH2_2                -8.164413e-02 1 1  ON 42
eH2_3                -4.455329e-02 1 1  ON 43
eH2_4                 8.537187e-04 1 1  ON 44
eH2_5                 1.164579e-02 1 1  ON 45
eH2_6                 5.371745e-02 1 1  ON 46
eH2_7                 6.392896e-02 1 1  ON 47
eH2_8                 2.111558e-01 1 1  ON 48
eH2_9                 8.149004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8524e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2552
    reference variance = 0.294247
====================================================
  Execution time = 3.2508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2253e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322503839686
                                         uncertainty =       0.004120991190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322503839686
                                         uncertainty =       0.004120991190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401575653
  error estimate for blocks of size 2^( 2) =       0.000411117493
  error estimate for blocks of size 2^( 3) =       0.000419447336
  error estimate for blocks of size 2^( 4) =       0.000425948614
  error estimate for blocks of size 2^( 5) =       0.000429706687
  error estimate for blocks of size 2^( 6) =       0.000432231042
  error estimate for blocks of size 2^( 7) =       0.000433606321

      target function =                  N/A
              le_mean =     -17.217164938705
             les_mean =     296.753294375109
             stat err =       0.000430373166
             autocorr =       1.148565116735
              std dev =       0.567913734482
             le_variance =       0.322526009814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716493870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217164938705       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217164944443       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217164946619       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217164946991       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217164946889       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217164946859       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217164947422       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.499857e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217164938705       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217164940142       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217164940686       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217164940780       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217164940754       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217164940747       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217164940889       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.753186e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217164938705       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217164939064       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217164939200       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217164939224       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217164939218       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217164939218       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217164939255       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 9.385185e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.401522 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1468e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.073548e-01 1 1  ON 0
 uu_1                 4.375767e-02 1 1  ON 1
 uu_2                -5.311542e-02 1 1  ON 2
 uu_3                -1.106402e-01 1 1  ON 3
 uu_4                -1.473620e-01 1 1  ON 4
 uu_5                -1.595093e-01 1 1  ON 5
 uu_6                -1.460753e-01 1 1  ON 6
 uu_7                -9.605818e-02 1 1  ON 7
 uu_8                -1.431953e-03 1 1  ON 8
 uu_9                 2.066808e-01 1 1  ON 9
 ud_0                 3.603976e-01 1 1  ON 10
 ud_1                 1.008871e-01 1 1  ON 11
 ud_2                -1.079875e-02 1 1  ON 12
 ud_3                -7.381809e-02 1 1  ON 13
 ud_4                -1.239111e-01 1 1  ON 14
 ud_5                -1.593565e-01 1 1  ON 15
 ud_6                -1.699346e-01 1 1  ON 16
 ud_7                -1.426671e-01 1 1  ON 17
 ud_8                -7.191087e-02 1 1  ON 18
 ud_9                 7.869815e-02 1 1  ON 19
 eO_0                -8.963877e-01 1 1  ON 20
 eO_1                -5.702581e-01 1 1  ON 21
 eO_2                -1.497692e-01 1 1  ON 22
 eO_3                 1.246349e-01 1 1  ON 23
 eO_4                 2.500008e-01 1 1  ON 24
 eO_5                 3.252355e-01 1 1  ON 25
 eO_6                 3.531811e-01 1 1  ON 26
 eO_7                 4.011079e-01 1 1  ON 27
 eO_8                 1.013951e-01 1 1  ON 28
 eO_9                 3.820612e-02 1 1  ON 29
eH1_0                -2.030363e-01 1 1  ON 30
eH1_1                -1.237804e-01 1 1  ON 31
eH1_2                -8.180133e-02 1 1  ON 32
eH1_3                -4.452385e-02 1 1  ON 33
eH1_4                 8.565416e-04 1 1  ON 34
eH1_5                 1.139482e-02 1 1  ON 35
eH1_6                 4.987094e-02 1 1  ON 36
eH1_7                 4.761394e-02 1 1  ON 37
eH1_8                 2.187920e-01 1 1  ON 38
eH1_9                 8.401218e-02 1 1  ON 39
eH2_0                -2.034043e-01 1 1  ON 40
eH2_1                -1.236707e-01 1 1  ON 41
eH2_2                -8.164415e-02 1 1  ON 42
eH2_3                -4.455321e-02 1 1  ON 43
eH2_4                 8.538925e-04 1 1  ON 44
eH2_5                 1.164591e-02 1 1  ON 45
eH2_6                 5.371748e-02 1 1  ON 46
eH2_7                 6.392897e-02 1 1  ON 47
eH2_8                 2.111558e-01 1 1  ON 48
eH2_9                 8.149004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2887
    reference variance = 0.392628
====================================================
  Execution time = 3.2582e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3241e-01
  Total weights = 2.0000e+06
  Execution time = 2.9866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332397856855
                                         uncertainty =       0.008513183830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332397856855
                                         uncertainty =       0.008513183830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407682781
  error estimate for blocks of size 2^( 2) =       0.000416606419
  error estimate for blocks of size 2^( 3) =       0.000424422887
  error estimate for blocks of size 2^( 4) =       0.000430719210
  error estimate for blocks of size 2^( 5) =       0.000434939568
  error estimate for blocks of size 2^( 6) =       0.000435826133
  error estimate for blocks of size 2^( 7) =       0.000436632173

      target function =                  N/A
              le_mean =     -17.216799461735
             les_mean =     296.750594039661
             stat err =       0.000434529271
             autocorr =       1.136039247507
              std dev =       0.576550518391
             le_variance =       0.332410500257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332397478786
                                         uncertainty =       0.008513154172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332397478786
                                         uncertainty =       0.008513154172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407682549
  error estimate for blocks of size 2^( 2) =       0.000416606193
  error estimate for blocks of size 2^( 3) =       0.000424422670
  error estimate for blocks of size 2^( 4) =       0.000430718993
  error estimate for blocks of size 2^( 5) =       0.000434939353
  error estimate for blocks of size 2^( 6) =       0.000435825946
  error estimate for blocks of size 2^( 7) =       0.000436631953

      target function =                  N/A
              le_mean =     -17.216799471714
             les_mean =     296.750594005215
             stat err =       0.000434529061
             autocorr =       1.136039443177
              std dev =       0.576550190530
             le_variance =       0.332410122200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332397667575
                                         uncertainty =       0.008513168964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332397667575
                                         uncertainty =       0.008513168964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407682665
  error estimate for blocks of size 2^( 2) =       0.000416606306
  error estimate for blocks of size 2^( 3) =       0.000424422778
  error estimate for blocks of size 2^( 4) =       0.000430719101
  error estimate for blocks of size 2^( 5) =       0.000434939460
  error estimate for blocks of size 2^( 6) =       0.000435826039
  error estimate for blocks of size 2^( 7) =       0.000436632063

      target function =                  N/A
              le_mean =     -17.216799466740
             les_mean =     296.750594022728
             stat err =       0.000434529166
             autocorr =       1.136039345503
              std dev =       0.576550354248
             le_variance =       0.332410310983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332397833187
                                         uncertainty =       0.008513181970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332397833187
                                         uncertainty =       0.008513181970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407682767
  error estimate for blocks of size 2^( 2) =       0.000416606405
  error estimate for blocks of size 2^( 3) =       0.000424422873
  error estimate for blocks of size 2^( 4) =       0.000430719196
  error estimate for blocks of size 2^( 5) =       0.000434939554
  error estimate for blocks of size 2^( 6) =       0.000435826121
  error estimate for blocks of size 2^( 7) =       0.000436632159

      target function =                  N/A
              le_mean =     -17.216799462361
             les_mean =     296.750594037549
             stat err =       0.000434529258
             autocorr =       1.136039259758
              std dev =       0.576550497865
             le_variance =       0.332410476589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216799461735        initial
     1.4901e+02     1.4901e+03             1.4999e-06       -17.216799471714  <--
     5.9605e+02     5.9605e+03             3.7532e-07       -17.216799466740
     2.3842e+03     2.3842e+04             9.3852e-08       -17.216799462361

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 4.7636e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.073547e-01 1 1  ON 0
 uu_1                 4.375726e-02 1 1  ON 1
 uu_2                -5.311517e-02 1 1  ON 2
 uu_3                -1.106401e-01 1 1  ON 3
 uu_4                -1.473618e-01 1 1  ON 4
 uu_5                -1.595094e-01 1 1  ON 5
 uu_6                -1.460754e-01 1 1  ON 6
 uu_7                -9.605812e-02 1 1  ON 7
 uu_8                -1.432087e-03 1 1  ON 8
 uu_9                 2.066807e-01 1 1  ON 9
 ud_0                 3.603979e-01 1 1  ON 10
 ud_1                 1.008869e-01 1 1  ON 11
 ud_2                -1.079854e-02 1 1  ON 12
 ud_3                -7.381850e-02 1 1  ON 13
 ud_4                -1.239113e-01 1 1  ON 14
 ud_5                -1.593566e-01 1 1  ON 15
 ud_6                -1.699343e-01 1 1  ON 16
 ud_7                -1.426668e-01 1 1  ON 17
 ud_8                -7.191096e-02 1 1  ON 18
 ud_9                 7.869799e-02 1 1  ON 19
 eO_0                -8.963872e-01 1 1  ON 20
 eO_1                -5.702582e-01 1 1  ON 21
 eO_2                -1.497695e-01 1 1  ON 22
 eO_3                 1.246345e-01 1 1  ON 23
 eO_4                 2.500006e-01 1 1  ON 24
 eO_5                 3.252356e-01 1 1  ON 25
 eO_6                 3.531811e-01 1 1  ON 26
 eO_7                 4.011081e-01 1 1  ON 27
 eO_8                 1.013952e-01 1 1  ON 28
 eO_9                 3.820614e-02 1 1  ON 29
eH1_0                -2.030367e-01 1 1  ON 30
eH1_1                -1.237808e-01 1 1  ON 31
eH1_2                -8.180103e-02 1 1  ON 32
eH1_3                -4.452333e-02 1 1  ON 33
eH1_4                 8.567741e-04 1 1  ON 34
eH1_5                 1.139439e-02 1 1  ON 35
eH1_6                 4.987084e-02 1 1  ON 36
eH1_7                 4.761411e-02 1 1  ON 37
eH1_8                 2.187920e-01 1 1  ON 38
eH1_9                 8.401223e-02 1 1  ON 39
eH2_0                -2.034045e-01 1 1  ON 40
eH2_1                -1.236719e-01 1 1  ON 41
eH2_2                -8.164424e-02 1 1  ON 42
eH2_3                -4.455296e-02 1 1  ON 43
eH2_4                 8.544139e-04 1 1  ON 44
eH2_5                 1.164630e-02 1 1  ON 45
eH2_6                 5.371758e-02 1 1  ON 46
eH2_7                 6.392900e-02 1 1  ON 47
eH2_8                 2.111558e-01 1 1  ON 48
eH2_9                 8.149007e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9402e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.314691
====================================================
  Execution time = 3.3205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2506e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136298002
                                         uncertainty =       0.005695567618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136298002
                                         uncertainty =       0.005695567618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403151719
  error estimate for blocks of size 2^( 2) =       0.000412804030
  error estimate for blocks of size 2^( 3) =       0.000421363694
  error estimate for blocks of size 2^( 4) =       0.000428275424
  error estimate for blocks of size 2^( 5) =       0.000431905605
  error estimate for blocks of size 2^( 6) =       0.000433587985
  error estimate for blocks of size 2^( 7) =       0.000436057006

      target function =                  N/A
              le_mean =     -17.217582149980
             les_mean =     296.770197545951
             stat err =       0.000432456505
             autocorr =       1.150662172545
              std dev =       0.570142628784
             le_variance =       0.325062617157


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721758214998e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217582149980       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217582146601       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217582154505       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217582164084       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217582168686       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217582167668       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217582167619       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.404286e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217582149980       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217582149131       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217582151121       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217582153544       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217582154719       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217582154456       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217582154440       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 8.542243e-07

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217582149980       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217582149768       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217582150266       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217582150874       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217582151170       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217582151103       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217582151099       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.137547e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.403729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2168e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.073544e-01 1 1  ON 0
 uu_1                 4.375746e-02 1 1  ON 1
 uu_2                -5.311511e-02 1 1  ON 2
 uu_3                -1.106405e-01 1 1  ON 3
 uu_4                -1.473617e-01 1 1  ON 4
 uu_5                -1.595092e-01 1 1  ON 5
 uu_6                -1.460756e-01 1 1  ON 6
 uu_7                -9.605791e-02 1 1  ON 7
 uu_8                -1.432104e-03 1 1  ON 8
 uu_9                 2.066806e-01 1 1  ON 9
 ud_0                 3.603982e-01 1 1  ON 10
 ud_1                 1.008863e-01 1 1  ON 11
 ud_2                -1.079770e-02 1 1  ON 12
 ud_3                -7.381878e-02 1 1  ON 13
 ud_4                -1.239112e-01 1 1  ON 14
 ud_5                -1.593570e-01 1 1  ON 15
 ud_6                -1.699344e-01 1 1  ON 16
 ud_7                -1.426667e-01 1 1  ON 17
 ud_8                -7.191112e-02 1 1  ON 18
 ud_9                 7.869786e-02 1 1  ON 19
 eO_0                -8.963878e-01 1 1  ON 20
 eO_1                -5.702578e-01 1 1  ON 21
 eO_2                -1.497699e-01 1 1  ON 22
 eO_3                 1.246349e-01 1 1  ON 23
 eO_4                 2.500008e-01 1 1  ON 24
 eO_5                 3.252354e-01 1 1  ON 25
 eO_6                 3.531809e-01 1 1  ON 26
 eO_7                 4.011083e-01 1 1  ON 27
 eO_8                 1.013954e-01 1 1  ON 28
 eO_9                 3.820617e-02 1 1  ON 29
eH1_0                -2.030372e-01 1 1  ON 30
eH1_1                -1.237805e-01 1 1  ON 31
eH1_2                -8.180146e-02 1 1  ON 32
eH1_3                -4.452329e-02 1 1  ON 33
eH1_4                 8.565992e-04 1 1  ON 34
eH1_5                 1.139421e-02 1 1  ON 35
eH1_6                 4.987124e-02 1 1  ON 36
eH1_7                 4.761451e-02 1 1  ON 37
eH1_8                 2.187920e-01 1 1  ON 38
eH1_9                 8.401231e-02 1 1  ON 39
eH2_0                -2.034038e-01 1 1  ON 40
eH2_1                -1.236727e-01 1 1  ON 41
eH2_2                -8.164451e-02 1 1  ON 42
eH2_3                -4.455256e-02 1 1  ON 43
eH2_4                 8.545908e-04 1 1  ON 44
eH2_5                 1.164660e-02 1 1  ON 45
eH2_6                 5.371703e-02 1 1  ON 46
eH2_7                 6.392895e-02 1 1  ON 47
eH2_8                 2.111558e-01 1 1  ON 48
eH2_9                 8.149016e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2524
    reference variance = 1.12072
====================================================
  Execution time = 3.1898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1518e-01
  Total weights = 2.0000e+06
  Execution time = 2.9860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315182974365
                                         uncertainty =       0.002681464753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315182974365
                                         uncertainty =       0.002681464753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396979122
  error estimate for blocks of size 2^( 2) =       0.000406184814
  error estimate for blocks of size 2^( 3) =       0.000414400201
  error estimate for blocks of size 2^( 4) =       0.000420817058
  error estimate for blocks of size 2^( 5) =       0.000424659440
  error estimate for blocks of size 2^( 6) =       0.000427223214
  error estimate for blocks of size 2^( 7) =       0.000428621235

      target function =                  N/A
              le_mean =     -17.216980179784
             les_mean =     296.739591200817
             stat err =       0.000425330237
             autocorr =       1.147934691916
              std dev =       0.561413258956
             le_variance =       0.315184847332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315183467303
                                         uncertainty =       0.002681470729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315183467303
                                         uncertainty =       0.002681470729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396979433
  error estimate for blocks of size 2^( 2) =       0.000406185130
  error estimate for blocks of size 2^( 3) =       0.000414400490
  error estimate for blocks of size 2^( 4) =       0.000420817358
  error estimate for blocks of size 2^( 5) =       0.000424659757
  error estimate for blocks of size 2^( 6) =       0.000427223477
  error estimate for blocks of size 2^( 7) =       0.000428621570

      target function =                  N/A
              le_mean =     -17.216980184776
             les_mean =     296.739591866082
             stat err =       0.000425330541
             autocorr =       1.147934534730
              std dev =       0.561413698345
             le_variance =       0.315185340689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315183222619
                                         uncertainty =       0.002681467799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315183222619
                                         uncertainty =       0.002681467799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396979279
  error estimate for blocks of size 2^( 2) =       0.000406184973
  error estimate for blocks of size 2^( 3) =       0.000414400347
  error estimate for blocks of size 2^( 4) =       0.000420817209
  error estimate for blocks of size 2^( 5) =       0.000424659600
  error estimate for blocks of size 2^( 6) =       0.000427223347
  error estimate for blocks of size 2^( 7) =       0.000428621404

      target function =                  N/A
              le_mean =     -17.216980182329
             les_mean =     296.739591536926
             stat err =       0.000425330390
             autocorr =       1.147934614307
              std dev =       0.561413480240
             le_variance =       0.315185095796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315183005429
                                         uncertainty =       0.002681465135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315183005429
                                         uncertainty =       0.002681465135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396979142
  error estimate for blocks of size 2^( 2) =       0.000406184834
  error estimate for blocks of size 2^( 3) =       0.000414400220
  error estimate for blocks of size 2^( 4) =       0.000420817077
  error estimate for blocks of size 2^( 5) =       0.000424659460
  error estimate for blocks of size 2^( 6) =       0.000427223231
  error estimate for blocks of size 2^( 7) =       0.000428621256

      target function =                  N/A
              le_mean =     -17.216980180101
             les_mean =     296.739591242838
             stat err =       0.000425330256
             autocorr =       1.147934682241
              std dev =       0.561413286646
             le_variance =       0.315184878423


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216980179784        initial
     3.7253e+01     3.7253e+02             3.4043e-06       -17.216980184776  <--
     1.4901e+02     1.4901e+03             8.5422e-07       -17.216980182329
     5.9605e+02     5.9605e+03             2.1375e-07       -17.216980180101

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 4.6978e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.073536e-01 1 1  ON 0
 uu_1                 4.375807e-02 1 1  ON 1
 uu_2                -5.311496e-02 1 1  ON 2
 uu_3                -1.106416e-01 1 1  ON 3
 uu_4                -1.473613e-01 1 1  ON 4
 uu_5                -1.595088e-01 1 1  ON 5
 uu_6                -1.460763e-01 1 1  ON 6
 uu_7                -9.605730e-02 1 1  ON 7
 uu_8                -1.432157e-03 1 1  ON 8
 uu_9                 2.066804e-01 1 1  ON 9
 ud_0                 3.603991e-01 1 1  ON 10
 ud_1                 1.008846e-01 1 1  ON 11
 ud_2                -1.079522e-02 1 1  ON 12
 ud_3                -7.381958e-02 1 1  ON 13
 ud_4                -1.239107e-01 1 1  ON 14
 ud_5                -1.593582e-01 1 1  ON 15
 ud_6                -1.699348e-01 1 1  ON 16
 ud_7                -1.426662e-01 1 1  ON 17
 ud_8                -7.191160e-02 1 1  ON 18
 ud_9                 7.869746e-02 1 1  ON 19
 eO_0                -8.963898e-01 1 1  ON 20
 eO_1                -5.702564e-01 1 1  ON 21
 eO_2                -1.497709e-01 1 1  ON 22
 eO_3                 1.246361e-01 1 1  ON 23
 eO_4                 2.500014e-01 1 1  ON 24
 eO_5                 3.252349e-01 1 1  ON 25
 eO_6                 3.531802e-01 1 1  ON 26
 eO_7                 4.011088e-01 1 1  ON 27
 eO_8                 1.013958e-01 1 1  ON 28
 eO_9                 3.820627e-02 1 1  ON 29
eH1_0                -2.030388e-01 1 1  ON 30
eH1_1                -1.237795e-01 1 1  ON 31
eH1_2                -8.180275e-02 1 1  ON 32
eH1_3                -4.452319e-02 1 1  ON 33
eH1_4                 8.560789e-04 1 1  ON 34
eH1_5                 1.139364e-02 1 1  ON 35
eH1_6                 4.987244e-02 1 1  ON 36
eH1_7                 4.761570e-02 1 1  ON 37
eH1_8                 2.187922e-01 1 1  ON 38
eH1_9                 8.401252e-02 1 1  ON 39
eH2_0                -2.034017e-01 1 1  ON 40
eH2_1                -1.236753e-01 1 1  ON 41
eH2_2                -8.164531e-02 1 1  ON 42
eH2_3                -4.455135e-02 1 1  ON 43
eH2_4                 8.551259e-04 1 1  ON 44
eH2_5                 1.164752e-02 1 1  ON 45
eH2_6                 5.371538e-02 1 1  ON 46
eH2_7                 6.392879e-02 1 1  ON 47
eH2_8                 2.111559e-01 1 1  ON 48
eH2_9                 8.149042e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2307
    reference variance = 0.18576
====================================================
  Execution time = 3.2625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2141e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321422307039
                                         uncertainty =       0.003572229337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321422307039
                                         uncertainty =       0.003572229337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400879613
  error estimate for blocks of size 2^( 2) =       0.000410194060
  error estimate for blocks of size 2^( 3) =       0.000418519561
  error estimate for blocks of size 2^( 4) =       0.000424061615
  error estimate for blocks of size 2^( 5) =       0.000427185756
  error estimate for blocks of size 2^( 6) =       0.000428143662
  error estimate for blocks of size 2^( 7) =       0.000428601995

      target function =                  N/A
              le_mean =     -17.217186106390
             les_mean =     296.752906189603
             stat err =       0.000426998257
             autocorr =       1.134551628573
              std dev =       0.566929385588
             le_variance =       0.321408928243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718610639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217186106390       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217186141635       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217186184227       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217186197941       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217186252113       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217186259718       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217186262743       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.679923e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217186106390       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217186115361       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217186126365       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217186130080       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217186144245       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217186146166       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217186147141       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 4.297343e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217186106390       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217186108643       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217186111417       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217186112365       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217186115948       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217186116430       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217186116688       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.080642e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1659e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.073519e-01 1 1  ON 0
 uu_1                 4.375873e-02 1 1  ON 1
 uu_2                -5.311412e-02 1 1  ON 2
 uu_3                -1.106413e-01 1 1  ON 3
 uu_4                -1.473617e-01 1 1  ON 4
 uu_5                -1.595083e-01 1 1  ON 5
 uu_6                -1.460770e-01 1 1  ON 6
 uu_7                -9.605760e-02 1 1  ON 7
 uu_8                -1.431743e-03 1 1  ON 8
 uu_9                 2.066802e-01 1 1  ON 9
 ud_0                 3.604012e-01 1 1  ON 10
 ud_1                 1.008824e-01 1 1  ON 11
 ud_2                -1.079307e-02 1 1  ON 12
 ud_3                -7.382074e-02 1 1  ON 13
 ud_4                -1.239102e-01 1 1  ON 14
 ud_5                -1.593602e-01 1 1  ON 15
 ud_6                -1.699353e-01 1 1  ON 16
 ud_7                -1.426645e-01 1 1  ON 17
 ud_8                -7.191206e-02 1 1  ON 18
 ud_9                 7.869693e-02 1 1  ON 19
 eO_0                -8.963908e-01 1 1  ON 20
 eO_1                -5.702538e-01 1 1  ON 21
 eO_2                -1.497712e-01 1 1  ON 22
 eO_3                 1.246345e-01 1 1  ON 23
 eO_4                 2.500004e-01 1 1  ON 24
 eO_5                 3.252353e-01 1 1  ON 25
 eO_6                 3.531797e-01 1 1  ON 26
 eO_7                 4.011095e-01 1 1  ON 27
 eO_8                 1.013963e-01 1 1  ON 28
 eO_9                 3.820635e-02 1 1  ON 29
eH1_0                -2.030408e-01 1 1  ON 30
eH1_1                -1.237809e-01 1 1  ON 31
eH1_2                -8.180282e-02 1 1  ON 32
eH1_3                -4.452531e-02 1 1  ON 33
eH1_4                 8.600903e-04 1 1  ON 34
eH1_5                 1.139242e-02 1 1  ON 35
eH1_6                 4.987357e-02 1 1  ON 36
eH1_7                 4.761705e-02 1 1  ON 37
eH1_8                 2.187922e-01 1 1  ON 38
eH1_9                 8.401277e-02 1 1  ON 39
eH2_0                -2.033994e-01 1 1  ON 40
eH2_1                -1.236768e-01 1 1  ON 41
eH2_2                -8.164961e-02 1 1  ON 42
eH2_3                -4.454772e-02 1 1  ON 43
eH2_4                 8.544598e-04 1 1  ON 44
eH2_5                 1.164916e-02 1 1  ON 45
eH2_6                 5.371477e-02 1 1  ON 46
eH2_7                 6.392805e-02 1 1  ON 47
eH2_8                 2.111557e-01 1 1  ON 48
eH2_9                 8.149073e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.356849
====================================================
  Execution time = 3.2203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1481e-01
  Total weights = 2.0000e+06
  Execution time = 2.9893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314811235388
                                         uncertainty =       0.002179292682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314811235388
                                         uncertainty =       0.002179292682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396741865
  error estimate for blocks of size 2^( 2) =       0.000406355345
  error estimate for blocks of size 2^( 3) =       0.000414952761
  error estimate for blocks of size 2^( 4) =       0.000421962475
  error estimate for blocks of size 2^( 5) =       0.000425482837
  error estimate for blocks of size 2^( 6) =       0.000427991716
  error estimate for blocks of size 2^( 7) =       0.000429237450

      target function =                  N/A
              le_mean =     -17.216137840359
             les_mean =     296.710210195205
             stat err =       0.000426168619
             autocorr =       1.153843412510
              std dev =       0.561077725768
             le_variance =       0.314808214353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314816392656
                                         uncertainty =       0.002179321289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314816392656
                                         uncertainty =       0.002179321289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396745116
  error estimate for blocks of size 2^( 2) =       0.000406358290
  error estimate for blocks of size 2^( 3) =       0.000414955351
  error estimate for blocks of size 2^( 4) =       0.000421964823
  error estimate for blocks of size 2^( 5) =       0.000425485010
  error estimate for blocks of size 2^( 6) =       0.000427993742
  error estimate for blocks of size 2^( 7) =       0.000429239577

      target function =                  N/A
              le_mean =     -17.216138005702
             les_mean =     296.710221048248
             stat err =       0.000426170788
             autocorr =       1.153836243917
              std dev =       0.561082323976
             le_variance =       0.314813374278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314813896065
                                         uncertainty =       0.002179307394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314813896065
                                         uncertainty =       0.002179307394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396743542
  error estimate for blocks of size 2^( 2) =       0.000406356865
  error estimate for blocks of size 2^( 3) =       0.000414954098
  error estimate for blocks of size 2^( 4) =       0.000421963689
  error estimate for blocks of size 2^( 5) =       0.000425483961
  error estimate for blocks of size 2^( 6) =       0.000427992763
  error estimate for blocks of size 2^( 7) =       0.000429238557

      target function =                  N/A
              le_mean =     -17.216137926072
             les_mean =     296.710215808486
             stat err =       0.000426169742
             autocorr =       1.153839737173
              std dev =       0.561080097973
             le_variance =       0.314810876342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314811570322
                                         uncertainty =       0.002179294535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314811570322
                                         uncertainty =       0.002179294535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396742076
  error estimate for blocks of size 2^( 2) =       0.000406355536
  error estimate for blocks of size 2^( 3) =       0.000414952929
  error estimate for blocks of size 2^( 4) =       0.000421962628
  error estimate for blocks of size 2^( 5) =       0.000425482979
  error estimate for blocks of size 2^( 6) =       0.000427991847
  error estimate for blocks of size 2^( 7) =       0.000429237590

      target function =                  N/A
              le_mean =     -17.216137851136
             les_mean =     296.710210901348
             stat err =       0.000426168761
             autocorr =       1.153842950070
              std dev =       0.561078024387
             le_variance =       0.314808549449


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216137840359        initial
     9.3132e+00     9.3132e+01             1.6799e-05       -17.216138005702  <--
     3.7253e+01     3.7253e+02             4.2973e-06       -17.216137926072
     1.4901e+02     1.4901e+03             1.0806e-06       -17.216137851136

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 4.7283e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.073471e-01 1 1  ON 0
 uu_1                 4.376070e-02 1 1  ON 1
 uu_2                -5.311173e-02 1 1  ON 2
 uu_3                -1.106407e-01 1 1  ON 3
 uu_4                -1.473629e-01 1 1  ON 4
 uu_5                -1.595069e-01 1 1  ON 5
 uu_6                -1.460790e-01 1 1  ON 6
 uu_7                -9.605850e-02 1 1  ON 7
 uu_8                -1.430519e-03 1 1  ON 8
 uu_9                 2.066796e-01 1 1  ON 9
 ud_0                 3.604073e-01 1 1  ON 10
 ud_1                 1.008763e-01 1 1  ON 11
 ud_2                -1.078703e-02 1 1  ON 12
 ud_3                -7.382395e-02 1 1  ON 13
 ud_4                -1.239091e-01 1 1  ON 14
 ud_5                -1.593661e-01 1 1  ON 15
 ud_6                -1.699367e-01 1 1  ON 16
 ud_7                -1.426597e-01 1 1  ON 17
 ud_8                -7.191345e-02 1 1  ON 18
 ud_9                 7.869538e-02 1 1  ON 19
 eO_0                -8.963938e-01 1 1  ON 20
 eO_1                -5.702465e-01 1 1  ON 21
 eO_2                -1.497719e-01 1 1  ON 22
 eO_3                 1.246299e-01 1 1  ON 23
 eO_4                 2.499977e-01 1 1  ON 24
 eO_5                 3.252363e-01 1 1  ON 25
 eO_6                 3.531784e-01 1 1  ON 26
 eO_7                 4.011118e-01 1 1  ON 27
 eO_8                 1.013978e-01 1 1  ON 28
 eO_9                 3.820658e-02 1 1  ON 29
eH1_0                -2.030466e-01 1 1  ON 30
eH1_1                -1.237851e-01 1 1  ON 31
eH1_2                -8.180309e-02 1 1  ON 32
eH1_3                -4.453153e-02 1 1  ON 33
eH1_4                 8.719736e-04 1 1  ON 34
eH1_5                 1.138884e-02 1 1  ON 35
eH1_6                 4.987689e-02 1 1  ON 36
eH1_7                 4.762104e-02 1 1  ON 37
eH1_8                 2.187923e-01 1 1  ON 38
eH1_9                 8.401351e-02 1 1  ON 39
eH2_0                -2.033927e-01 1 1  ON 40
eH2_1                -1.236814e-01 1 1  ON 41
eH2_2                -8.166211e-02 1 1  ON 42
eH2_3                -4.453722e-02 1 1  ON 43
eH2_4                 8.526554e-04 1 1  ON 44
eH2_5                 1.165399e-02 1 1  ON 45
eH2_6                 5.371298e-02 1 1  ON 46
eH2_7                 6.392585e-02 1 1  ON 47
eH2_8                 2.111553e-01 1 1  ON 48
eH2_9                 8.149164e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9201e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1614
    reference variance = 0.482512
====================================================
  Execution time = 3.2333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2011e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320148634924
                                         uncertainty =       0.003410958404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320148634924
                                         uncertainty =       0.003410958404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400068720
  error estimate for blocks of size 2^( 2) =       0.000409709863
  error estimate for blocks of size 2^( 3) =       0.000418221945
  error estimate for blocks of size 2^( 4) =       0.000424758577
  error estimate for blocks of size 2^( 5) =       0.000428404026
  error estimate for blocks of size 2^( 6) =       0.000429309139
  error estimate for blocks of size 2^( 7) =       0.000430241716

      target function =                  N/A
              le_mean =     -17.217189593109
             les_mean =     296.751727287098
             stat err =       0.000428178365
             autocorr =       1.145460832777
              std dev =       0.565782610275
             le_variance =       0.320109962090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718959311e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217189593109       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217189458887       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217189382794       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217189562515       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217189470648       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217189562045       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217189529590       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 5.401286e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217189593109       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217189557682       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217189533703       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217189579006       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217189552528       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217189572499       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217189567695       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.516107e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217189593109       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217189584127       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217189577758       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217189589088       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217189582151       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217189586880       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217189585892       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.912032e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.408214 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1273e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.073432e-01 1 1  ON 0
 uu_1                 4.376122e-02 1 1  ON 1
 uu_2                -5.310289e-02 1 1  ON 2
 uu_3                -1.106411e-01 1 1  ON 3
 uu_4                -1.473674e-01 1 1  ON 4
 uu_5                -1.595083e-01 1 1  ON 5
 uu_6                -1.460812e-01 1 1  ON 6
 uu_7                -9.605885e-02 1 1  ON 7
 uu_8                -1.430632e-03 1 1  ON 8
 uu_9                 2.066783e-01 1 1  ON 9
 ud_0                 3.604045e-01 1 1  ON 10
 ud_1                 1.008747e-01 1 1  ON 11
 ud_2                -1.078400e-02 1 1  ON 12
 ud_3                -7.382703e-02 1 1  ON 13
 ud_4                -1.238972e-01 1 1  ON 14
 ud_5                -1.593738e-01 1 1  ON 15
 ud_6                -1.699356e-01 1 1  ON 16
 ud_7                -1.426583e-01 1 1  ON 17
 ud_8                -7.191708e-02 1 1  ON 18
 ud_9                 7.869211e-02 1 1  ON 19
 eO_0                -8.964028e-01 1 1  ON 20
 eO_1                -5.702314e-01 1 1  ON 21
 eO_2                -1.497818e-01 1 1  ON 22
 eO_3                 1.246254e-01 1 1  ON 23
 eO_4                 2.500011e-01 1 1  ON 24
 eO_5                 3.252374e-01 1 1  ON 25
 eO_6                 3.531760e-01 1 1  ON 26
 eO_7                 4.011140e-01 1 1  ON 27
 eO_8                 1.014003e-01 1 1  ON 28
 eO_9                 3.820721e-02 1 1  ON 29
eH1_0                -2.030399e-01 1 1  ON 30
eH1_1                -1.237891e-01 1 1  ON 31
eH1_2                -8.181116e-02 1 1  ON 32
eH1_3                -4.452728e-02 1 1  ON 33
eH1_4                 8.741599e-04 1 1  ON 34
eH1_5                 1.138306e-02 1 1  ON 35
eH1_6                 4.987706e-02 1 1  ON 36
eH1_7                 4.762532e-02 1 1  ON 37
eH1_8                 2.187915e-01 1 1  ON 38
eH1_9                 8.401365e-02 1 1  ON 39
eH2_0                -2.033935e-01 1 1  ON 40
eH2_1                -1.236853e-01 1 1  ON 41
eH2_2                -8.166916e-02 1 1  ON 42
eH2_3                -4.453076e-02 1 1  ON 43
eH2_4                 8.582511e-04 1 1  ON 44
eH2_5                 1.165569e-02 1 1  ON 45
eH2_6                 5.371120e-02 1 1  ON 46
eH2_7                 6.392329e-02 1 1  ON 47
eH2_8                 2.111551e-01 1 1  ON 48
eH2_9                 8.149331e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.177
    reference variance = 0.234841
====================================================
  Execution time = 3.1808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1935e-01
  Total weights = 2.0000e+06
  Execution time = 2.9892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319254810011
                                         uncertainty =       0.002921100635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319254810011
                                         uncertainty =       0.002921100635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399596954
  error estimate for blocks of size 2^( 2) =       0.000408808564
  error estimate for blocks of size 2^( 3) =       0.000417216753
  error estimate for blocks of size 2^( 4) =       0.000423375701
  error estimate for blocks of size 2^( 5) =       0.000427271814
  error estimate for blocks of size 2^( 6) =       0.000429589646
  error estimate for blocks of size 2^( 7) =       0.000429912447

      target function =                  N/A
              le_mean =     -17.216671345767
             les_mean =     296.733127520455
             stat err =       0.000427537402
             autocorr =       1.144732170991
              std dev =       0.565115432449
             le_variance =       0.319355451993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319246237299
                                         uncertainty =       0.002921013056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319246237299
                                         uncertainty =       0.002921013056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399591598
  error estimate for blocks of size 2^( 2) =       0.000408802881
  error estimate for blocks of size 2^( 3) =       0.000417210395
  error estimate for blocks of size 2^( 4) =       0.000423368575
  error estimate for blocks of size 2^( 5) =       0.000427264327
  error estimate for blocks of size 2^( 6) =       0.000429583112
  error estimate for blocks of size 2^( 7) =       0.000429906694

      target function =                  N/A
              le_mean =     -17.216670869543
             les_mean =     296.733102561294
             stat err =       0.000427530677
             autocorr =       1.144726848642
              std dev =       0.565107857660
             le_variance =       0.319346890789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319249001431
                                         uncertainty =       0.002921043435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319249001431
                                         uncertainty =       0.002921043435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399593324
  error estimate for blocks of size 2^( 2) =       0.000408804780
  error estimate for blocks of size 2^( 3) =       0.000417212619
  error estimate for blocks of size 2^( 4) =       0.000423371144
  error estimate for blocks of size 2^( 5) =       0.000427267067
  error estimate for blocks of size 2^( 6) =       0.000429585459
  error estimate for blocks of size 2^( 7) =       0.000429908714

      target function =                  N/A
              le_mean =     -17.216671058054
             les_mean =     296.733111810834
             stat err =       0.000427533096
             autocorr =       1.144729912785
              std dev =       0.565110298337
             le_variance =       0.319349649287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319254016030
                                         uncertainty =       0.002921092927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319254016030
                                         uncertainty =       0.002921092927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399596458
  error estimate for blocks of size 2^( 2) =       0.000408808049
  error estimate for blocks of size 2^( 3) =       0.000417216194
  error estimate for blocks of size 2^( 4) =       0.000423375087
  error estimate for blocks of size 2^( 5) =       0.000427271176
  error estimate for blocks of size 2^( 6) =       0.000429589082
  error estimate for blocks of size 2^( 7) =       0.000429911942

      target function =                  N/A
              le_mean =     -17.216671307375
             les_mean =     296.733125405249
             stat err =       0.000427536822
             autocorr =       1.144731909197
              std dev =       0.565114730606
             le_variance =       0.319354658747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216671345767        initial  <--
     2.3283e+00     2.3283e+01             5.4013e-05       -17.216670869543
     9.3132e+00     9.3132e+01             1.5161e-05       -17.216671058054
     3.7253e+01     3.7253e+02             3.9120e-06       -17.216671307375

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8764
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.073471e-01 1 1  ON 0
 uu_1                 4.376070e-02 1 1  ON 1
 uu_2                -5.311173e-02 1 1  ON 2
 uu_3                -1.106407e-01 1 1  ON 3
 uu_4                -1.473629e-01 1 1  ON 4
 uu_5                -1.595069e-01 1 1  ON 5
 uu_6                -1.460790e-01 1 1  ON 6
 uu_7                -9.605850e-02 1 1  ON 7
 uu_8                -1.430519e-03 1 1  ON 8
 uu_9                 2.066796e-01 1 1  ON 9
 ud_0                 3.604073e-01 1 1  ON 10
 ud_1                 1.008763e-01 1 1  ON 11
 ud_2                -1.078703e-02 1 1  ON 12
 ud_3                -7.382395e-02 1 1  ON 13
 ud_4                -1.239091e-01 1 1  ON 14
 ud_5                -1.593661e-01 1 1  ON 15
 ud_6                -1.699367e-01 1 1  ON 16
 ud_7                -1.426597e-01 1 1  ON 17
 ud_8                -7.191345e-02 1 1  ON 18
 ud_9                 7.869538e-02 1 1  ON 19
 eO_0                -8.963938e-01 1 1  ON 20
 eO_1                -5.702465e-01 1 1  ON 21
 eO_2                -1.497719e-01 1 1  ON 22
 eO_3                 1.246299e-01 1 1  ON 23
 eO_4                 2.499977e-01 1 1  ON 24
 eO_5                 3.252363e-01 1 1  ON 25
 eO_6                 3.531784e-01 1 1  ON 26
 eO_7                 4.011118e-01 1 1  ON 27
 eO_8                 1.013978e-01 1 1  ON 28
 eO_9                 3.820658e-02 1 1  ON 29
eH1_0                -2.030466e-01 1 1  ON 30
eH1_1                -1.237851e-01 1 1  ON 31
eH1_2                -8.180309e-02 1 1  ON 32
eH1_3                -4.453153e-02 1 1  ON 33
eH1_4                 8.719736e-04 1 1  ON 34
eH1_5                 1.138884e-02 1 1  ON 35
eH1_6                 4.987689e-02 1 1  ON 36
eH1_7                 4.762104e-02 1 1  ON 37
eH1_8                 2.187923e-01 1 1  ON 38
eH1_9                 8.401351e-02 1 1  ON 39
eH2_0                -2.033927e-01 1 1  ON 40
eH2_1                -1.236814e-01 1 1  ON 41
eH2_2                -8.166211e-02 1 1  ON 42
eH2_3                -4.453722e-02 1 1  ON 43
eH2_4                 8.526554e-04 1 1  ON 44
eH2_5                 1.165399e-02 1 1  ON 45
eH2_6                 5.371298e-02 1 1  ON 46
eH2_7                 6.392585e-02 1 1  ON 47
eH2_8                 2.111553e-01 1 1  ON 48
eH2_9                 8.149164e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1457
    reference variance = 0.536605
====================================================
  Execution time = 3.2306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322313294526
                                         uncertainty =       0.003389957818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322313294526
                                         uncertainty =       0.003389957818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401482299
  error estimate for blocks of size 2^( 2) =       0.000410954164
  error estimate for blocks of size 2^( 3) =       0.000419940601
  error estimate for blocks of size 2^( 4) =       0.000426115076
  error estimate for blocks of size 2^( 5) =       0.000430722066
  error estimate for blocks of size 2^( 6) =       0.000432699333
  error estimate for blocks of size 2^( 7) =       0.000433730849

      target function =                  N/A
              le_mean =     -17.216537204319
             les_mean =     296.731529219860
             stat err =       0.000430816831
             autocorr =       1.151469709409
              std dev =       0.567781712764
             le_variance =       0.322376073349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653720432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216537204319       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216537225784       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216537255929       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216537263200       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216537276108       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216537278699       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 5.840793e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216537204319       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216537209742       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216537217339       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216537219271       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216537222631       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216537223283       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.485663e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216537204319       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216537205678       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216537207581       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216537208072       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216537208920       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216537209084       residual = 6.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 3.730510e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1272e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.073466e-01 1 1  ON 0
 uu_1                 4.376096e-02 1 1  ON 1
 uu_2                -5.311101e-02 1 1  ON 2
 uu_3                -1.106411e-01 1 1  ON 3
 uu_4                -1.473633e-01 1 1  ON 4
 uu_5                -1.595062e-01 1 1  ON 5
 uu_6                -1.460794e-01 1 1  ON 6
 uu_7                -9.605865e-02 1 1  ON 7
 uu_8                -1.430520e-03 1 1  ON 8
 uu_9                 2.066794e-01 1 1  ON 9
 ud_0                 3.604076e-01 1 1  ON 10
 ud_1                 1.008752e-01 1 1  ON 11
 ud_2                -1.078555e-02 1 1  ON 12
 ud_3                -7.382407e-02 1 1  ON 13
 ud_4                -1.239092e-01 1 1  ON 14
 ud_5                -1.593667e-01 1 1  ON 15
 ud_6                -1.699362e-01 1 1  ON 16
 ud_7                -1.426595e-01 1 1  ON 17
 ud_8                -7.191400e-02 1 1  ON 18
 ud_9                 7.869503e-02 1 1  ON 19
 eO_0                -8.963925e-01 1 1  ON 20
 eO_1                -5.702471e-01 1 1  ON 21
 eO_2                -1.497730e-01 1 1  ON 22
 eO_3                 1.246306e-01 1 1  ON 23
 eO_4                 2.499974e-01 1 1  ON 24
 eO_5                 3.252362e-01 1 1  ON 25
 eO_6                 3.531782e-01 1 1  ON 26
 eO_7                 4.011119e-01 1 1  ON 27
 eO_8                 1.013980e-01 1 1  ON 28
 eO_9                 3.820661e-02 1 1  ON 29
eH1_0                -2.030459e-01 1 1  ON 30
eH1_1                -1.237858e-01 1 1  ON 31
eH1_2                -8.180388e-02 1 1  ON 32
eH1_3                -4.453127e-02 1 1  ON 33
eH1_4                 8.727705e-04 1 1  ON 34
eH1_5                 1.138878e-02 1 1  ON 35
eH1_6                 4.987652e-02 1 1  ON 36
eH1_7                 4.762109e-02 1 1  ON 37
eH1_8                 2.187922e-01 1 1  ON 38
eH1_9                 8.401361e-02 1 1  ON 39
eH2_0                -2.033930e-01 1 1  ON 40
eH2_1                -1.236818e-01 1 1  ON 41
eH2_2                -8.166293e-02 1 1  ON 42
eH2_3                -4.453653e-02 1 1  ON 43
eH2_4                 8.533760e-04 1 1  ON 44
eH2_5                 1.165406e-02 1 1  ON 45
eH2_6                 5.371253e-02 1 1  ON 46
eH2_7                 6.392603e-02 1 1  ON 47
eH2_8                 2.111555e-01 1 1  ON 48
eH2_9                 8.149173e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2659
    reference variance = 0.308345
====================================================
  Execution time = 3.2660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1630e-01
  Total weights = 2.0000e+06
  Execution time = 2.9875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316333900807
                                         uncertainty =       0.002982591211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316333900807
                                         uncertainty =       0.002982591211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397680687
  error estimate for blocks of size 2^( 2) =       0.000407161582
  error estimate for blocks of size 2^( 3) =       0.000415504274
  error estimate for blocks of size 2^( 4) =       0.000421309016
  error estimate for blocks of size 2^( 5) =       0.000424460759
  error estimate for blocks of size 2^( 6) =       0.000426004054
  error estimate for blocks of size 2^( 7) =       0.000426299961

      target function =                  N/A
              le_mean =     -17.217054685891
             les_mean =     296.743271755708
             stat err =       0.000424518447
             autocorr =       1.139525726912
              std dev =       0.562405420404
             le_variance =       0.316299856900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316332081494
                                         uncertainty =       0.002982502193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316332081494
                                         uncertainty =       0.002982502193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397679542
  error estimate for blocks of size 2^( 2) =       0.000407160516
  error estimate for blocks of size 2^( 3) =       0.000415503262
  error estimate for blocks of size 2^( 4) =       0.000421308050
  error estimate for blocks of size 2^( 5) =       0.000424459833
  error estimate for blocks of size 2^( 6) =       0.000426002960
  error estimate for blocks of size 2^( 7) =       0.000426299065

      target function =                  N/A
              le_mean =     -17.217054707277
             les_mean =     296.743270671368
             stat err =       0.000424517477
             autocorr =       1.139527076138
              std dev =       0.562403801692
             le_variance =       0.316298036158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316332980096
                                         uncertainty =       0.002982545990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316332980096
                                         uncertainty =       0.002982545990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397680107
  error estimate for blocks of size 2^( 2) =       0.000407161043
  error estimate for blocks of size 2^( 3) =       0.000415503763
  error estimate for blocks of size 2^( 4) =       0.000421308528
  error estimate for blocks of size 2^( 5) =       0.000424460291
  error estimate for blocks of size 2^( 6) =       0.000426003501
  error estimate for blocks of size 2^( 7) =       0.000426299508

      target function =                  N/A
              le_mean =     -17.217054696497
             les_mean =     296.743271199479
             stat err =       0.000424517957
             autocorr =       1.139526413247
              std dev =       0.562404601197
             le_variance =       0.316298935447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316333785306
                                         uncertainty =       0.002982585535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316333785306
                                         uncertainty =       0.002982585535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397680614
  error estimate for blocks of size 2^( 2) =       0.000407161514
  error estimate for blocks of size 2^( 3) =       0.000415504210
  error estimate for blocks of size 2^( 4) =       0.000421308954
  error estimate for blocks of size 2^( 5) =       0.000424460700
  error estimate for blocks of size 2^( 6) =       0.000426003985
  error estimate for blocks of size 2^( 7) =       0.000426299904

      target function =                  N/A
              le_mean =     -17.217054687208
             les_mean =     296.743271685473
             stat err =       0.000424518386
             autocorr =       1.139525813082
              std dev =       0.562405317636
             le_variance =       0.316299741306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217054685891        initial
     2.3283e+01     2.3283e+02             5.8408e-06       -17.217054707277  <--
     9.3132e+01     9.3132e+02             1.4857e-06       -17.217054696497
     3.7253e+02     3.7253e+03             3.7305e-07       -17.217054687208

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 4.7707e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.073452e-01 1 1  ON 0
 uu_1                 4.376175e-02 1 1  ON 1
 uu_2                -5.310892e-02 1 1  ON 2
 uu_3                -1.106424e-01 1 1  ON 3
 uu_4                -1.473645e-01 1 1  ON 4
 uu_5                -1.595039e-01 1 1  ON 5
 uu_6                -1.460805e-01 1 1  ON 6
 uu_7                -9.605909e-02 1 1  ON 7
 uu_8                -1.430521e-03 1 1  ON 8
 uu_9                 2.066788e-01 1 1  ON 9
 ud_0                 3.604084e-01 1 1  ON 10
 ud_1                 1.008722e-01 1 1  ON 11
 ud_2                -1.078119e-02 1 1  ON 12
 ud_3                -7.382437e-02 1 1  ON 13
 ud_4                -1.239093e-01 1 1  ON 14
 ud_5                -1.593685e-01 1 1  ON 15
 ud_6                -1.699347e-01 1 1  ON 16
 ud_7                -1.426591e-01 1 1  ON 17
 ud_8                -7.191565e-02 1 1  ON 18
 ud_9                 7.869399e-02 1 1  ON 19
 eO_0                -8.963887e-01 1 1  ON 20
 eO_1                -5.702488e-01 1 1  ON 21
 eO_2                -1.497763e-01 1 1  ON 22
 eO_3                 1.246327e-01 1 1  ON 23
 eO_4                 2.499964e-01 1 1  ON 24
 eO_5                 3.252358e-01 1 1  ON 25
 eO_6                 3.531778e-01 1 1  ON 26
 eO_7                 4.011122e-01 1 1  ON 27
 eO_8                 1.013984e-01 1 1  ON 28
 eO_9                 3.820672e-02 1 1  ON 29
eH1_0                -2.030438e-01 1 1  ON 30
eH1_1                -1.237877e-01 1 1  ON 31
eH1_2                -8.180625e-02 1 1  ON 32
eH1_3                -4.453050e-02 1 1  ON 33
eH1_4                 8.751475e-04 1 1  ON 34
eH1_5                 1.138857e-02 1 1  ON 35
eH1_6                 4.987542e-02 1 1  ON 36
eH1_7                 4.762126e-02 1 1  ON 37
eH1_8                 2.187919e-01 1 1  ON 38
eH1_9                 8.401390e-02 1 1  ON 39
eH2_0                -2.033937e-01 1 1  ON 40
eH2_1                -1.236828e-01 1 1  ON 41
eH2_2                -8.166539e-02 1 1  ON 42
eH2_3                -4.453451e-02 1 1  ON 43
eH2_4                 8.555300e-04 1 1  ON 44
eH2_5                 1.165428e-02 1 1  ON 45
eH2_6                 5.371117e-02 1 1  ON 46
eH2_7                 6.392654e-02 1 1  ON 47
eH2_8                 2.111558e-01 1 1  ON 48
eH2_9                 8.149199e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.199
    reference variance = 0.251115
====================================================
  Execution time = 3.2198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2990e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329805933985
                                         uncertainty =       0.007254130898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329805933985
                                         uncertainty =       0.007254130898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406140070
  error estimate for blocks of size 2^( 2) =       0.000415928772
  error estimate for blocks of size 2^( 3) =       0.000424700154
  error estimate for blocks of size 2^( 4) =       0.000430083456
  error estimate for blocks of size 2^( 5) =       0.000433636984
  error estimate for blocks of size 2^( 6) =       0.000436217019
  error estimate for blocks of size 2^( 7) =       0.000436767842

      target function =                  N/A
              le_mean =     -17.217025585422
             les_mean =     296.755869356795
             stat err =       0.000434176325
             autocorr =       1.142827279387
              std dev =       0.574368794986
             le_variance =       0.329899512654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702558542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217025585422       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217025764559       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217025830469       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217025816646       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217025800899       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217025803328       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217025794343       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.250886e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217025585422       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217025631666       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217025649168       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217025646448       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217025641488       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217025641901       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 5.527952e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217025585422       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217025597078       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217025601522       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217025600895       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217025599583       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217025599672       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.399175e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.412091 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1133e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.073397e-01 1 1  ON 0
 uu_1                 4.376165e-02 1 1  ON 1
 uu_2                -5.310344e-02 1 1  ON 2
 uu_3                -1.106406e-01 1 1  ON 3
 uu_4                -1.473682e-01 1 1  ON 4
 uu_5                -1.595048e-01 1 1  ON 5
 uu_6                -1.460807e-01 1 1  ON 6
 uu_7                -9.605790e-02 1 1  ON 7
 uu_8                -1.429273e-03 1 1  ON 8
 uu_9                 2.066784e-01 1 1  ON 9
 ud_0                 3.604029e-01 1 1  ON 10
 ud_1                 1.008739e-01 1 1  ON 11
 ud_2                -1.078256e-02 1 1  ON 12
 ud_3                -7.382111e-02 1 1  ON 13
 ud_4                -1.239088e-01 1 1  ON 14
 ud_5                -1.593724e-01 1 1  ON 15
 ud_6                -1.699310e-01 1 1  ON 16
 ud_7                -1.426575e-01 1 1  ON 17
 ud_8                -7.191597e-02 1 1  ON 18
 ud_9                 7.869328e-02 1 1  ON 19
 eO_0                -8.963916e-01 1 1  ON 20
 eO_1                -5.702463e-01 1 1  ON 21
 eO_2                -1.497808e-01 1 1  ON 22
 eO_3                 1.246358e-01 1 1  ON 23
 eO_4                 2.499960e-01 1 1  ON 24
 eO_5                 3.252358e-01 1 1  ON 25
 eO_6                 3.531776e-01 1 1  ON 26
 eO_7                 4.011134e-01 1 1  ON 27
 eO_8                 1.013992e-01 1 1  ON 28
 eO_9                 3.820683e-02 1 1  ON 29
eH1_0                -2.030434e-01 1 1  ON 30
eH1_1                -1.237831e-01 1 1  ON 31
eH1_2                -8.181060e-02 1 1  ON 32
eH1_3                -4.453159e-02 1 1  ON 33
eH1_4                 8.729151e-04 1 1  ON 34
eH1_5                 1.138897e-02 1 1  ON 35
eH1_6                 4.987537e-02 1 1  ON 36
eH1_7                 4.762285e-02 1 1  ON 37
eH1_8                 2.187924e-01 1 1  ON 38
eH1_9                 8.401407e-02 1 1  ON 39
eH2_0                -2.033886e-01 1 1  ON 40
eH2_1                -1.236864e-01 1 1  ON 41
eH2_2                -8.166981e-02 1 1  ON 42
eH2_3                -4.453385e-02 1 1  ON 43
eH2_4                 8.537208e-04 1 1  ON 44
eH2_5                 1.165629e-02 1 1  ON 45
eH2_6                 5.371213e-02 1 1  ON 46
eH2_7                 6.392694e-02 1 1  ON 47
eH2_8                 2.111558e-01 1 1  ON 48
eH2_9                 8.149232e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2804
    reference variance = 0.244913
====================================================
  Execution time = 3.2383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1670e-01
  Total weights = 2.0000e+06
  Execution time = 2.9873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316753397690
                                         uncertainty =       0.002851126992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316753397690
                                         uncertainty =       0.002851126992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397936914
  error estimate for blocks of size 2^( 2) =       0.000407469691
  error estimate for blocks of size 2^( 3) =       0.000415349953
  error estimate for blocks of size 2^( 4) =       0.000421966118
  error estimate for blocks of size 2^( 5) =       0.000425393866
  error estimate for blocks of size 2^( 6) =       0.000426832655
  error estimate for blocks of size 2^( 7) =       0.000428695062

      target function =                  N/A
              le_mean =     -17.216779919561
             les_mean =     296.734218215736
             stat err =       0.000425721925
             autocorr =       1.144520507826
              std dev =       0.562767781133
             le_variance =       0.316707575481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316732777230
                                         uncertainty =       0.002850875239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316732777230
                                         uncertainty =       0.002850875239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397923955
  error estimate for blocks of size 2^( 2) =       0.000407456971
  error estimate for blocks of size 2^( 3) =       0.000415337497
  error estimate for blocks of size 2^( 4) =       0.000421953985
  error estimate for blocks of size 2^( 5) =       0.000425381808
  error estimate for blocks of size 2^( 6) =       0.000426820992
  error estimate for blocks of size 2^( 7) =       0.000428683822

      target function =                  N/A
              le_mean =     -17.216780044546
             les_mean =     296.734201892048
             stat err =       0.000425710152
             autocorr =       1.144531750052
              std dev =       0.562749454110
             le_variance =       0.316686948101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316742913180
                                         uncertainty =       0.002850995985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316742913180
                                         uncertainty =       0.002850995985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397930325
  error estimate for blocks of size 2^( 2) =       0.000407463228
  error estimate for blocks of size 2^( 3) =       0.000415343618
  error estimate for blocks of size 2^( 4) =       0.000421959947
  error estimate for blocks of size 2^( 5) =       0.000425387718
  error estimate for blocks of size 2^( 6) =       0.000426826699
  error estimate for blocks of size 2^( 7) =       0.000428689317

      target function =                  N/A
              le_mean =     -17.216779985977
             les_mean =     296.734210014949
             stat err =       0.000425715920
             autocorr =       1.144526121970
              std dev =       0.562758463058
             le_variance =       0.316697087743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316752067666
                                         uncertainty =       0.002851110353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316752067666
                                         uncertainty =       0.002851110353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397936078
  error estimate for blocks of size 2^( 2) =       0.000407468871
  error estimate for blocks of size 2^( 3) =       0.000415349149
  error estimate for blocks of size 2^( 4) =       0.000421965335
  error estimate for blocks of size 2^( 5) =       0.000425393086
  error estimate for blocks of size 2^( 6) =       0.000426831899
  error estimate for blocks of size 2^( 7) =       0.000428694333

      target function =                  N/A
              le_mean =     -17.216779927770
             les_mean =     296.734217167944
             stat err =       0.000425721163
             autocorr =       1.144521219236
              std dev =       0.562766599084
             le_variance =       0.316706245044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216779919561        initial
     5.8208e+00     5.8208e+01             2.2509e-05       -17.216780044546  <--
     2.3283e+01     2.3283e+02             5.5280e-06       -17.216779985977
     9.3132e+01     9.3132e+02             1.3992e-06       -17.216779927770

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 4.7455e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.073227e-01 1 1  ON 0
 uu_1                 4.376291e-02 1 1  ON 1
 uu_2                -5.308756e-02 1 1  ON 2
 uu_3                -1.106357e-01 1 1  ON 3
 uu_4                -1.473792e-01 1 1  ON 4
 uu_5                -1.595076e-01 1 1  ON 5
 uu_6                -1.460820e-01 1 1  ON 6
 uu_7                -9.605406e-02 1 1  ON 7
 uu_8                -1.424975e-03 1 1  ON 8
 uu_9                 2.066769e-01 1 1  ON 9
 ud_0                 3.603869e-01 1 1  ON 10
 ud_1                 1.008776e-01 1 1  ON 11
 ud_2                -1.078644e-02 1 1  ON 12
 ud_3                -7.381132e-02 1 1  ON 13
 ud_4                -1.239070e-01 1 1  ON 14
 ud_5                -1.593843e-01 1 1  ON 15
 ud_6                -1.699192e-01 1 1  ON 16
 ud_7                -1.426524e-01 1 1  ON 17
 ud_8                -7.191722e-02 1 1  ON 18
 ud_9                 7.869074e-02 1 1  ON 19
 eO_0                -8.963996e-01 1 1  ON 20
 eO_1                -5.702407e-01 1 1  ON 21
 eO_2                -1.497932e-01 1 1  ON 22
 eO_3                 1.246452e-01 1 1  ON 23
 eO_4                 2.499946e-01 1 1  ON 24
 eO_5                 3.252360e-01 1 1  ON 25
 eO_6                 3.531768e-01 1 1  ON 26
 eO_7                 4.011174e-01 1 1  ON 27
 eO_8                 1.014019e-01 1 1  ON 28
 eO_9                 3.820723e-02 1 1  ON 29
eH1_0                -2.030432e-01 1 1  ON 30
eH1_1                -1.237719e-01 1 1  ON 31
eH1_2                -8.182142e-02 1 1  ON 32
eH1_3                -4.453438e-02 1 1  ON 33
eH1_4                 8.658374e-04 1 1  ON 34
eH1_5                 1.139023e-02 1 1  ON 35
eH1_6                 4.987507e-02 1 1  ON 36
eH1_7                 4.762834e-02 1 1  ON 37
eH1_8                 2.187943e-01 1 1  ON 38
eH1_9                 8.401466e-02 1 1  ON 39
eH2_0                -2.033726e-01 1 1  ON 40
eH2_1                -1.236983e-01 1 1  ON 41
eH2_2                -8.168129e-02 1 1  ON 42
eH2_3                -4.453275e-02 1 1  ON 43
eH2_4                 8.474529e-04 1 1  ON 44
eH2_5                 1.166215e-02 1 1  ON 45
eH2_6                 5.371517e-02 1 1  ON 46
eH2_7                 6.392827e-02 1 1  ON 47
eH2_8                 2.111558e-01 1 1  ON 48
eH2_9                 8.149349e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2542
    reference variance = 0.448289
====================================================
  Execution time = 3.1954e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1369e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313702961252
                                         uncertainty =       0.003481016135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313702961252
                                         uncertainty =       0.003481016135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396037847
  error estimate for blocks of size 2^( 2) =       0.000405620424
  error estimate for blocks of size 2^( 3) =       0.000413850571
  error estimate for blocks of size 2^( 4) =       0.000419633050
  error estimate for blocks of size 2^( 5) =       0.000424975137
  error estimate for blocks of size 2^( 6) =       0.000426984689
  error estimate for blocks of size 2^( 7) =       0.000428809781

      target function =                  N/A
              le_mean =     -17.216007219022
             les_mean =     296.704596361680
             stat err =       0.000425100664
             autocorr =       1.152153078854
              std dev =       0.560082094984
             le_variance =       0.313691953121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721600721902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216007219022       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216007058889       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216007085985       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216007139817       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216007267118       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216007341661       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216007369885       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 8.962146e-05

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216007219022       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216007175502       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216007185760       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216007190598       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216007236345       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216007263248       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216007270625       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.457693e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216007219022       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216007207900       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216007210709       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216007211575       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216007223871       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216007231334       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216007233206       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 6.313701e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.414327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0881e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.073221e-01 1 1  ON 0
 uu_1                 4.375901e-02 1 1  ON 1
 uu_2                -5.308143e-02 1 1  ON 2
 uu_3                -1.106273e-01 1 1  ON 3
 uu_4                -1.473733e-01 1 1  ON 4
 uu_5                -1.595043e-01 1 1  ON 5
 uu_6                -1.460922e-01 1 1  ON 6
 uu_7                -9.605859e-02 1 1  ON 7
 uu_8                -1.430502e-03 1 1  ON 8
 uu_9                 2.066729e-01 1 1  ON 9
 ud_0                 3.604098e-01 1 1  ON 10
 ud_1                 1.008650e-01 1 1  ON 11
 ud_2                -1.077979e-02 1 1  ON 12
 ud_3                -7.381349e-02 1 1  ON 13
 ud_4                -1.239082e-01 1 1  ON 14
 ud_5                -1.593885e-01 1 1  ON 15
 ud_6                -1.699203e-01 1 1  ON 16
 ud_7                -1.426504e-01 1 1  ON 17
 ud_8                -7.192522e-02 1 1  ON 18
 ud_9                 7.868514e-02 1 1  ON 19
 eO_0                -8.963807e-01 1 1  ON 20
 eO_1                -5.702396e-01 1 1  ON 21
 eO_2                -1.498178e-01 1 1  ON 22
 eO_3                 1.246392e-01 1 1  ON 23
 eO_4                 2.499976e-01 1 1  ON 24
 eO_5                 3.252391e-01 1 1  ON 25
 eO_6                 3.531760e-01 1 1  ON 26
 eO_7                 4.011195e-01 1 1  ON 27
 eO_8                 1.014041e-01 1 1  ON 28
 eO_9                 3.820800e-02 1 1  ON 29
eH1_0                -2.030471e-01 1 1  ON 30
eH1_1                -1.237883e-01 1 1  ON 31
eH1_2                -8.182877e-02 1 1  ON 32
eH1_3                -4.453155e-02 1 1  ON 33
eH1_4                 8.728223e-04 1 1  ON 34
eH1_5                 1.139691e-02 1 1  ON 35
eH1_6                 4.988477e-02 1 1  ON 36
eH1_7                 4.763113e-02 1 1  ON 37
eH1_8                 2.187907e-01 1 1  ON 38
eH1_9                 8.401566e-02 1 1  ON 39
eH2_0                -2.033689e-01 1 1  ON 40
eH2_1                -1.237174e-01 1 1  ON 41
eH2_2                -8.168716e-02 1 1  ON 42
eH2_3                -4.450987e-02 1 1  ON 43
eH2_4                 8.701180e-04 1 1  ON 44
eH2_5                 1.166061e-02 1 1  ON 45
eH2_6                 5.369982e-02 1 1  ON 46
eH2_7                 6.392251e-02 1 1  ON 47
eH2_8                 2.111538e-01 1 1  ON 48
eH2_9                 8.149396e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2129
    reference variance = 0.223173
====================================================
  Execution time = 3.1839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2032e-01
  Total weights = 2.0000e+06
  Execution time = 2.9903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320328775611
                                         uncertainty =       0.003314799639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320328775611
                                         uncertainty =       0.003314799639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400193092
  error estimate for blocks of size 2^( 2) =       0.000409513796
  error estimate for blocks of size 2^( 3) =       0.000417769246
  error estimate for blocks of size 2^( 4) =       0.000423608556
  error estimate for blocks of size 2^( 5) =       0.000427269762
  error estimate for blocks of size 2^( 6) =       0.000428049840
  error estimate for blocks of size 2^( 7) =       0.000427418947

      target function =                  N/A
              le_mean =     -17.216777790326
             les_mean =     296.737746343059
             stat err =       0.000426586776
             autocorr =       1.136254462847
              std dev =       0.565958498272
             le_variance =       0.320309021766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320368585093
                                         uncertainty =       0.003315712128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320368585093
                                         uncertainty =       0.003315712128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400217973
  error estimate for blocks of size 2^( 2) =       0.000409537203
  error estimate for blocks of size 2^( 3) =       0.000417791703
  error estimate for blocks of size 2^( 4) =       0.000423630803
  error estimate for blocks of size 2^( 5) =       0.000427291364
  error estimate for blocks of size 2^( 6) =       0.000428070997
  error estimate for blocks of size 2^( 7) =       0.000427440570

      target function =                  N/A
              le_mean =     -17.216778119250
             les_mean =     296.737797499618
             stat err =       0.000426608434
             autocorr =       1.136228548266
              std dev =       0.565993685737
             le_variance =       0.320348852294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320356236040
                                         uncertainty =       0.003315374256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320356236040
                                         uncertainty =       0.003315374256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400210254
  error estimate for blocks of size 2^( 2) =       0.000409530009
  error estimate for blocks of size 2^( 3) =       0.000417784821
  error estimate for blocks of size 2^( 4) =       0.000423623956
  error estimate for blocks of size 2^( 5) =       0.000427284681
  error estimate for blocks of size 2^( 6) =       0.000428064432
  error estimate for blocks of size 2^( 7) =       0.000427433893

      target function =                  N/A
              le_mean =     -17.216777950079
             les_mean =     296.737779316390
             stat err =       0.000426601741
             autocorr =       1.136236727997
              std dev =       0.565982768483
             le_variance =       0.320336494220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320332505459
                                         uncertainty =       0.003314876257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320332505459
                                         uncertainty =       0.003314876257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400195423
  error estimate for blocks of size 2^( 2) =       0.000409516000
  error estimate for blocks of size 2^( 3) =       0.000417771364
  error estimate for blocks of size 2^( 4) =       0.000423610649
  error estimate for blocks of size 2^( 5) =       0.000427271788
  error estimate for blocks of size 2^( 6) =       0.000428051821
  error estimate for blocks of size 2^( 7) =       0.000427420977

      target function =                  N/A
              le_mean =     -17.216777809037
             les_mean =     296.737750718772
             stat err =       0.000426588809
             autocorr =       1.136252052186
              std dev =       0.565961794801
             le_variance =       0.320312753175


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216777790326        initial
     1.4552e+00     1.4552e+01             8.9621e-05       -17.216778119250  <--
     5.8208e+00     5.8208e+01             2.4577e-05       -17.216777950079
     2.3283e+01     2.3283e+02             6.3137e-06       -17.216777809037

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 4.6928e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.073193e-01 1 1  ON 0
 uu_1                 4.375005e-02 1 1  ON 1
 uu_2                -5.306567e-02 1 1  ON 2
 uu_3                -1.106046e-01 1 1  ON 3
 uu_4                -1.473558e-01 1 1  ON 4
 uu_5                -1.594934e-01 1 1  ON 5
 uu_6                -1.461205e-01 1 1  ON 6
 uu_7                -9.607164e-02 1 1  ON 7
 uu_8                -1.446446e-03 1 1  ON 8
 uu_9                 2.066613e-01 1 1  ON 9
 ud_0                 3.604601e-01 1 1  ON 10
 ud_1                 1.008407e-01 1 1  ON 11
 ud_2                -1.076332e-02 1 1  ON 12
 ud_3                -7.381640e-02 1 1  ON 13
 ud_4                -1.239107e-01 1 1  ON 14
 ud_5                -1.593994e-01 1 1  ON 15
 ud_6                -1.699228e-01 1 1  ON 16
 ud_7                -1.426444e-01 1 1  ON 17
 ud_8                -7.194822e-02 1 1  ON 18
 ud_9                 7.866901e-02 1 1  ON 19
 eO_0                -8.963297e-01 1 1  ON 20
 eO_1                -5.702385e-01 1 1  ON 21
 eO_2                -1.498828e-01 1 1  ON 22
 eO_3                 1.246209e-01 1 1  ON 23
 eO_4                 2.500064e-01 1 1  ON 24
 eO_5                 3.252483e-01 1 1  ON 25
 eO_6                 3.531737e-01 1 1  ON 26
 eO_7                 4.011254e-01 1 1  ON 27
 eO_8                 1.014104e-01 1 1  ON 28
 eO_9                 3.821022e-02 1 1  ON 29
eH1_0                -2.030590e-01 1 1  ON 30
eH1_1                -1.238322e-01 1 1  ON 31
eH1_2                -8.185096e-02 1 1  ON 32
eH1_3                -4.452639e-02 1 1  ON 33
eH1_4                 8.938566e-04 1 1  ON 34
eH1_5                 1.141640e-02 1 1  ON 35
eH1_6                 4.991297e-02 1 1  ON 36
eH1_7                 4.763923e-02 1 1  ON 37
eH1_8                 2.187802e-01 1 1  ON 38
eH1_9                 8.401853e-02 1 1  ON 39
eH2_0                -2.033600e-01 1 1  ON 40
eH2_1                -1.237674e-01 1 1  ON 41
eH2_2                -8.170203e-02 1 1  ON 42
eH2_3                -4.445096e-02 1 1  ON 43
eH2_4                 9.370305e-04 1 1  ON 44
eH2_5                 1.165656e-02 1 1  ON 45
eH2_6                 5.365553e-02 1 1  ON 46
eH2_7                 6.390585e-02 1 1  ON 47
eH2_8                 2.111477e-01 1 1  ON 48
eH2_9                 8.149533e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8030e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1767
    reference variance = 0.229867
====================================================
  Execution time = 3.2210e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1686e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760978572
                                         uncertainty =       0.004189904223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760978572
                                         uncertainty =       0.004189904223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398031649
  error estimate for blocks of size 2^( 2) =       0.000407631643
  error estimate for blocks of size 2^( 3) =       0.000416055517
  error estimate for blocks of size 2^( 4) =       0.000422806644
  error estimate for blocks of size 2^( 5) =       0.000427093857
  error estimate for blocks of size 2^( 6) =       0.000429363691
  error estimate for blocks of size 2^( 7) =       0.000430671374

      target function =                  N/A
              le_mean =     -17.216492113729
             les_mean =     296.724458930126
             stat err =       0.000427483892
             autocorr =       1.153464673598
              std dev =       0.562901755602
             le_variance =       0.316858386460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649211373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492113729       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216493160482       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216493961066       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216493623845       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216493882079       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216494021845       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216493796077       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e-01 is 2.874721e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492113729       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492519438       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216492839241       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216492779355       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216492901567       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216492963818       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 8.598631e-05

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492113729       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492231338       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216492326149       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216492318101       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216492362194       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216492381346       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.305663e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1138e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.072969e-01 1 1  ON 0
 uu_1                 4.376348e-02 1 1  ON 1
 uu_2                -5.306843e-02 1 1  ON 2
 uu_3                -1.106078e-01 1 1  ON 3
 uu_4                -1.473604e-01 1 1  ON 4
 uu_5                -1.594752e-01 1 1  ON 5
 uu_6                -1.461239e-01 1 1  ON 6
 uu_7                -9.607393e-02 1 1  ON 7
 uu_8                -1.460234e-03 1 1  ON 8
 uu_9                 2.066546e-01 1 1  ON 9
 ud_0                 3.604461e-01 1 1  ON 10
 ud_1                 1.009069e-01 1 1  ON 11
 ud_2                -1.078374e-02 1 1  ON 12
 ud_3                -7.379782e-02 1 1  ON 13
 ud_4                -1.238773e-01 1 1  ON 14
 ud_5                -1.594151e-01 1 1  ON 15
 ud_6                -1.699551e-01 1 1  ON 16
 ud_7                -1.426599e-01 1 1  ON 17
 ud_8                -7.197326e-02 1 1  ON 18
 ud_9                 7.865140e-02 1 1  ON 19
 eO_0                -8.963458e-01 1 1  ON 20
 eO_1                -5.702170e-01 1 1  ON 21
 eO_2                -1.499047e-01 1 1  ON 22
 eO_3                 1.245936e-01 1 1  ON 23
 eO_4                 2.500180e-01 1 1  ON 24
 eO_5                 3.252674e-01 1 1  ON 25
 eO_6                 3.531623e-01 1 1  ON 26
 eO_7                 4.011351e-01 1 1  ON 27
 eO_8                 1.014185e-01 1 1  ON 28
 eO_9                 3.821353e-02 1 1  ON 29
eH1_0                -2.030704e-01 1 1  ON 30
eH1_1                -1.238384e-01 1 1  ON 31
eH1_2                -8.186821e-02 1 1  ON 32
eH1_3                -4.449730e-02 1 1  ON 33
eH1_4                 9.120994e-04 1 1  ON 34
eH1_5                 1.138632e-02 1 1  ON 35
eH1_6                 4.990928e-02 1 1  ON 36
eH1_7                 4.764861e-02 1 1  ON 37
eH1_8                 2.187810e-01 1 1  ON 38
eH1_9                 8.402580e-02 1 1  ON 39
eH2_0                -2.033674e-01 1 1  ON 40
eH2_1                -1.238534e-01 1 1  ON 41
eH2_2                -8.173151e-02 1 1  ON 42
eH2_3                -4.442436e-02 1 1  ON 43
eH2_4                 9.968058e-04 1 1  ON 44
eH2_5                 1.169656e-02 1 1  ON 45
eH2_6                 5.365394e-02 1 1  ON 46
eH2_7                 6.389687e-02 1 1  ON 47
eH2_8                 2.111441e-01 1 1  ON 48
eH2_9                 8.150040e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.163698
====================================================
  Execution time = 3.1414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2612e-01
  Total weights = 2.0000e+06
  Execution time = 2.9848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326199765835
                                         uncertainty =       0.004236790202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326199765835
                                         uncertainty =       0.004236790202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403816147
  error estimate for blocks of size 2^( 2) =       0.000413390878
  error estimate for blocks of size 2^( 3) =       0.000421927676
  error estimate for blocks of size 2^( 4) =       0.000427607901
  error estimate for blocks of size 2^( 5) =       0.000431495142
  error estimate for blocks of size 2^( 6) =       0.000433541214
  error estimate for blocks of size 2^( 7) =       0.000433665323

      target function =                  N/A
              le_mean =     -17.217127499913
             les_mean =     296.755614145860
             stat err =       0.000431577395
             autocorr =       1.142220677280
              std dev =       0.571082271358
             le_variance =       0.326134960659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326186585111
                                         uncertainty =       0.004236398621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326186585111
                                         uncertainty =       0.004236398621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403807961
  error estimate for blocks of size 2^( 2) =       0.000413379513
  error estimate for blocks of size 2^( 3) =       0.000421914058
  error estimate for blocks of size 2^( 4) =       0.000427592423
  error estimate for blocks of size 2^( 5) =       0.000431477115
  error estimate for blocks of size 2^( 6) =       0.000433526355
  error estimate for blocks of size 2^( 7) =       0.000433650138

      target function =                  N/A
              le_mean =     -17.217126662513
             les_mean =     296.755572089115
             stat err =       0.000431561508
             autocorr =       1.142182888294
              std dev =       0.571070695412
             le_variance =       0.326121739159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326172781385
                                         uncertainty =       0.004235833160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326172781385
                                         uncertainty =       0.004235833160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403799435
  error estimate for blocks of size 2^( 2) =       0.000413371725
  error estimate for blocks of size 2^( 3) =       0.000421906764
  error estimate for blocks of size 2^( 4) =       0.000427585376
  error estimate for blocks of size 2^( 5) =       0.000431469912
  error estimate for blocks of size 2^( 6) =       0.000433519398
  error estimate for blocks of size 2^( 7) =       0.000433643066

      target function =                  N/A
              le_mean =     -17.217127010460
             les_mean =     296.755570298923
             stat err =       0.000431554438
             autocorr =       1.142193698125
              std dev =       0.571058637668
             le_variance =       0.326107967655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326195124656
                                         uncertainty =       0.004236612718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326195124656
                                         uncertainty =       0.004236612718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403813273
  error estimate for blocks of size 2^( 2) =       0.000413387636
  error estimate for blocks of size 2^( 3) =       0.000421924168
  error estimate for blocks of size 2^( 4) =       0.000427604136
  error estimate for blocks of size 2^( 5) =       0.000431490920
  error estimate for blocks of size 2^( 6) =       0.000433537536
  error estimate for blocks of size 2^( 7) =       0.000433661569

      target function =                  N/A
              le_mean =     -17.217127419503
             les_mean =     296.755606735284
             stat err =       0.000431573540
             autocorr =       1.142216529657
              std dev =       0.571078207385
             le_variance =       0.326130318950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217127499913        initial  <--
     3.6380e-01     3.6380e+00             2.8747e-04       -17.217126662513
     1.4552e+00     1.4552e+01             8.5986e-05       -17.217127010460
     5.8208e+00     5.8208e+01             2.3057e-05       -17.217127419503

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.4730
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.073193e-01 1 1  ON 0
 uu_1                 4.375005e-02 1 1  ON 1
 uu_2                -5.306567e-02 1 1  ON 2
 uu_3                -1.106046e-01 1 1  ON 3
 uu_4                -1.473558e-01 1 1  ON 4
 uu_5                -1.594934e-01 1 1  ON 5
 uu_6                -1.461205e-01 1 1  ON 6
 uu_7                -9.607164e-02 1 1  ON 7
 uu_8                -1.446446e-03 1 1  ON 8
 uu_9                 2.066613e-01 1 1  ON 9
 ud_0                 3.604601e-01 1 1  ON 10
 ud_1                 1.008407e-01 1 1  ON 11
 ud_2                -1.076332e-02 1 1  ON 12
 ud_3                -7.381640e-02 1 1  ON 13
 ud_4                -1.239107e-01 1 1  ON 14
 ud_5                -1.593994e-01 1 1  ON 15
 ud_6                -1.699228e-01 1 1  ON 16
 ud_7                -1.426444e-01 1 1  ON 17
 ud_8                -7.194822e-02 1 1  ON 18
 ud_9                 7.866901e-02 1 1  ON 19
 eO_0                -8.963297e-01 1 1  ON 20
 eO_1                -5.702385e-01 1 1  ON 21
 eO_2                -1.498828e-01 1 1  ON 22
 eO_3                 1.246209e-01 1 1  ON 23
 eO_4                 2.500064e-01 1 1  ON 24
 eO_5                 3.252483e-01 1 1  ON 25
 eO_6                 3.531737e-01 1 1  ON 26
 eO_7                 4.011254e-01 1 1  ON 27
 eO_8                 1.014104e-01 1 1  ON 28
 eO_9                 3.821022e-02 1 1  ON 29
eH1_0                -2.030590e-01 1 1  ON 30
eH1_1                -1.238322e-01 1 1  ON 31
eH1_2                -8.185096e-02 1 1  ON 32
eH1_3                -4.452639e-02 1 1  ON 33
eH1_4                 8.938566e-04 1 1  ON 34
eH1_5                 1.141640e-02 1 1  ON 35
eH1_6                 4.991297e-02 1 1  ON 36
eH1_7                 4.763923e-02 1 1  ON 37
eH1_8                 2.187802e-01 1 1  ON 38
eH1_9                 8.401853e-02 1 1  ON 39
eH2_0                -2.033600e-01 1 1  ON 40
eH2_1                -1.237674e-01 1 1  ON 41
eH2_2                -8.170203e-02 1 1  ON 42
eH2_3                -4.445096e-02 1 1  ON 43
eH2_4                 9.370305e-04 1 1  ON 44
eH2_5                 1.165656e-02 1 1  ON 45
eH2_6                 5.365553e-02 1 1  ON 46
eH2_7                 6.390585e-02 1 1  ON 47
eH2_8                 2.111477e-01 1 1  ON 48
eH2_9                 8.149533e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7627e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.405499
====================================================
  Execution time = 3.2769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1873e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318820423594
                                         uncertainty =       0.003634215295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318820423594
                                         uncertainty =       0.003634215295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399203213
  error estimate for blocks of size 2^( 2) =       0.000408836618
  error estimate for blocks of size 2^( 3) =       0.000417196234
  error estimate for blocks of size 2^( 4) =       0.000423022456
  error estimate for blocks of size 2^( 5) =       0.000428156615
  error estimate for blocks of size 2^( 6) =       0.000430865408
  error estimate for blocks of size 2^( 7) =       0.000433534815

      target function =                  N/A
              le_mean =     -17.217086488807
             les_mean =     296.746793414259
             stat err =       0.000428894823
             autocorr =       1.154286330499
              std dev =       0.564558597991
             le_variance =       0.318726410565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708648881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217086488807       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217086525451       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217086554758       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217086550619       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217086514412       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217086480481       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217086485839       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 4.057252e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217086488807       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217086498453       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217086506167       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217086503796       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217086491647       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217086484787       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.027938e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217086488807       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217086491251       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217086493206       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217086492519       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217086489245       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217086487655       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.590306e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.418441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1764e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.073110e-01 1 1  ON 0
 uu_1                 4.374661e-02 1 1  ON 1
 uu_2                -5.306172e-02 1 1  ON 2
 uu_3                -1.106048e-01 1 1  ON 3
 uu_4                -1.473535e-01 1 1  ON 4
 uu_5                -1.594910e-01 1 1  ON 5
 uu_6                -1.461179e-01 1 1  ON 6
 uu_7                -9.606916e-02 1 1  ON 7
 uu_8                -1.447978e-03 1 1  ON 8
 uu_9                 2.066596e-01 1 1  ON 9
 ud_0                 3.604562e-01 1 1  ON 10
 ud_1                 1.008423e-01 1 1  ON 11
 ud_2                -1.075794e-02 1 1  ON 12
 ud_3                -7.381619e-02 1 1  ON 13
 ud_4                -1.239086e-01 1 1  ON 14
 ud_5                -1.594077e-01 1 1  ON 15
 ud_6                -1.699197e-01 1 1  ON 16
 ud_7                -1.426405e-01 1 1  ON 17
 ud_8                -7.195098e-02 1 1  ON 18
 ud_9                 7.866670e-02 1 1  ON 19
 eO_0                -8.963297e-01 1 1  ON 20
 eO_1                -5.702354e-01 1 1  ON 21
 eO_2                -1.498892e-01 1 1  ON 22
 eO_3                 1.246217e-01 1 1  ON 23
 eO_4                 2.500018e-01 1 1  ON 24
 eO_5                 3.252511e-01 1 1  ON 25
 eO_6                 3.531753e-01 1 1  ON 26
 eO_7                 4.011273e-01 1 1  ON 27
 eO_8                 1.014111e-01 1 1  ON 28
 eO_9                 3.821030e-02 1 1  ON 29
eH1_0                -2.030605e-01 1 1  ON 30
eH1_1                -1.238326e-01 1 1  ON 31
eH1_2                -8.185707e-02 1 1  ON 32
eH1_3                -4.452513e-02 1 1  ON 33
eH1_4                 8.909854e-04 1 1  ON 34
eH1_5                 1.142208e-02 1 1  ON 35
eH1_6                 4.991455e-02 1 1  ON 36
eH1_7                 4.764173e-02 1 1  ON 37
eH1_8                 2.187800e-01 1 1  ON 38
eH1_9                 8.401864e-02 1 1  ON 39
eH2_0                -2.033546e-01 1 1  ON 40
eH2_1                -1.237777e-01 1 1  ON 41
eH2_2                -8.170969e-02 1 1  ON 42
eH2_3                -4.444668e-02 1 1  ON 43
eH2_4                 9.468956e-04 1 1  ON 44
eH2_5                 1.165580e-02 1 1  ON 45
eH2_6                 5.365403e-02 1 1  ON 46
eH2_7                 6.390660e-02 1 1  ON 47
eH2_8                 2.111473e-01 1 1  ON 48
eH2_9                 8.149539e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1956
    reference variance = 0.184934
====================================================
  Execution time = 3.2686e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2864e-01
  Total weights = 2.0000e+06
  Execution time = 2.9958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328562664190
                                         uncertainty =       0.008597827734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328562664190
                                         uncertainty =       0.008597827734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405370341
  error estimate for blocks of size 2^( 2) =       0.000414863505
  error estimate for blocks of size 2^( 3) =       0.000423718044
  error estimate for blocks of size 2^( 4) =       0.000429175791
  error estimate for blocks of size 2^( 5) =       0.000432329375
  error estimate for blocks of size 2^( 6) =       0.000435459161
  error estimate for blocks of size 2^( 7) =       0.000433550511

      target function =                  N/A
              le_mean =     -17.216784511910
             les_mean =     296.746318991445
             stat err =       0.000432628709
             autocorr =       1.139007889086
              std dev =       0.573280233600
             le_variance =       0.328650226237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328531689645
                                         uncertainty =       0.008597044178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328531689645
                                         uncertainty =       0.008597044178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405351244
  error estimate for blocks of size 2^( 2) =       0.000414845120
  error estimate for blocks of size 2^( 3) =       0.000423700077
  error estimate for blocks of size 2^( 4) =       0.000429157851
  error estimate for blocks of size 2^( 5) =       0.000432311971
  error estimate for blocks of size 2^( 6) =       0.000435441710
  error estimate for blocks of size 2^( 7) =       0.000433534115

      target function =                  N/A
              le_mean =     -17.216784558531
             les_mean =     296.746289631901
             stat err =       0.000432611412
             autocorr =       1.139024125836
              std dev =       0.573253226188
             le_variance =       0.328619261335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328545825778
                                         uncertainty =       0.008597451314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328545825778
                                         uncertainty =       0.008597451314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405359959
  error estimate for blocks of size 2^( 2) =       0.000414853501
  error estimate for blocks of size 2^( 3) =       0.000423708262
  error estimate for blocks of size 2^( 4) =       0.000429166013
  error estimate for blocks of size 2^( 5) =       0.000432319906
  error estimate for blocks of size 2^( 6) =       0.000435449637
  error estimate for blocks of size 2^( 7) =       0.000433541585

      target function =                  N/A
              le_mean =     -17.216784540796
             les_mean =     296.746303152238
             stat err =       0.000432619285
             autocorr =       1.139016608351
              std dev =       0.573265551349
             le_variance =       0.328633392364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328560513712
                                         uncertainty =       0.008597783520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328560513712
                                         uncertainty =       0.008597783520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405369015
  error estimate for blocks of size 2^( 2) =       0.000414862227
  error estimate for blocks of size 2^( 3) =       0.000423716795
  error estimate for blocks of size 2^( 4) =       0.000429174543
  error estimate for blocks of size 2^( 5) =       0.000432328167
  error estimate for blocks of size 2^( 6) =       0.000435457946
  error estimate for blocks of size 2^( 7) =       0.000433549373

      target function =                  N/A
              le_mean =     -17.216784515161
             les_mean =     296.746316953489
             stat err =       0.000432627507
             autocorr =       1.139009009562
              std dev =       0.573278358491
             le_variance =       0.328648076314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216784511910        initial
     3.6380e+00     3.6380e+01             4.0573e-05       -17.216784558531  <--
     1.4552e+01     1.4552e+02             1.0279e-05       -17.216784540796
     5.8208e+01     5.8208e+02             2.5903e-06       -17.216784515161

*****************************************************************************
Applying the update for shift_i =   3.6380e+00     and shift_s =   3.6380e+01
*****************************************************************************

  Execution time = 4.7843e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.072864e-01 1 1  ON 0
 uu_1                 4.373949e-02 1 1  ON 1
 uu_2                -5.305283e-02 1 1  ON 2
 uu_3                -1.106054e-01 1 1  ON 3
 uu_4                -1.473479e-01 1 1  ON 4
 uu_5                -1.594835e-01 1 1  ON 5
 uu_6                -1.461098e-01 1 1  ON 6
 uu_7                -9.606122e-02 1 1  ON 7
 uu_8                -1.453066e-03 1 1  ON 8
 uu_9                 2.066537e-01 1 1  ON 9
 ud_0                 3.604460e-01 1 1  ON 10
 ud_1                 1.008454e-01 1 1  ON 11
 ud_2                -1.074241e-02 1 1  ON 12
 ud_3                -7.381377e-02 1 1  ON 13
 ud_4                -1.239039e-01 1 1  ON 14
 ud_5                -1.594320e-01 1 1  ON 15
 ud_6                -1.699102e-01 1 1  ON 16
 ud_7                -1.426282e-01 1 1  ON 17
 ud_8                -7.196017e-02 1 1  ON 18
 ud_9                 7.865908e-02 1 1  ON 19
 eO_0                -8.963285e-01 1 1  ON 20
 eO_1                -5.702285e-01 1 1  ON 21
 eO_2                -1.499064e-01 1 1  ON 22
 eO_3                 1.246224e-01 1 1  ON 23
 eO_4                 2.499869e-01 1 1  ON 24
 eO_5                 3.252605e-01 1 1  ON 25
 eO_6                 3.531802e-01 1 1  ON 26
 eO_7                 4.011336e-01 1 1  ON 27
 eO_8                 1.014135e-01 1 1  ON 28
 eO_9                 3.821058e-02 1 1  ON 29
eH1_0                -2.030654e-01 1 1  ON 30
eH1_1                -1.238338e-01 1 1  ON 31
eH1_2                -8.187334e-02 1 1  ON 32
eH1_3                -4.452390e-02 1 1  ON 33
eH1_4                 8.816253e-04 1 1  ON 34
eH1_5                 1.143975e-02 1 1  ON 35
eH1_6                 4.991946e-02 1 1  ON 36
eH1_7                 4.764988e-02 1 1  ON 37
eH1_8                 2.187793e-01 1 1  ON 38
eH1_9                 8.401898e-02 1 1  ON 39
eH2_0                -2.033379e-01 1 1  ON 40
eH2_1                -1.238080e-01 1 1  ON 41
eH2_2                -8.173052e-02 1 1  ON 42
eH2_3                -4.443546e-02 1 1  ON 43
eH2_4                 9.755704e-04 1 1  ON 44
eH2_5                 1.165300e-02 1 1  ON 45
eH2_6                 5.364938e-02 1 1  ON 46
eH2_7                 6.390901e-02 1 1  ON 47
eH2_8                 2.111459e-01 1 1  ON 48
eH2_9                 8.149559e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1732
    reference variance = 0.235023
====================================================
  Execution time = 3.2697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1581e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315739770308
                                         uncertainty =       0.002648394323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315739770308
                                         uncertainty =       0.002648394323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397373121
  error estimate for blocks of size 2^( 2) =       0.000407043616
  error estimate for blocks of size 2^( 3) =       0.000415496084
  error estimate for blocks of size 2^( 4) =       0.000420990426
  error estimate for blocks of size 2^( 5) =       0.000425143645
  error estimate for blocks of size 2^( 6) =       0.000427891135
  error estimate for blocks of size 2^( 7) =       0.000430119615

      target function =                  N/A
              le_mean =     -17.216560578963
             les_mean =     296.725768806486
             stat err =       0.000426036205
             autocorr =       1.149465761806
              std dev =       0.561970457679
             le_variance =       0.315810795304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656057896e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216560578963       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216561172205       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216561271372       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216561072975       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216561073716       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216561013939       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216561050769       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e-01 is 1.131231e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216560578963       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560762506       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216560795865       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216560733100       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216560730402       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216560724265       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 3.388207e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216560578963       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560627746       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216560636923       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216560620484       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216560619323       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216560618606       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 8.735317e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1673e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.072994e-01 1 1  ON 0
 uu_1                 4.375783e-02 1 1  ON 1
 uu_2                -5.304189e-02 1 1  ON 2
 uu_3                -1.106117e-01 1 1  ON 3
 uu_4                -1.473818e-01 1 1  ON 4
 uu_5                -1.594848e-01 1 1  ON 5
 uu_6                -1.461097e-01 1 1  ON 6
 uu_7                -9.606292e-02 1 1  ON 7
 uu_8                -1.458540e-03 1 1  ON 8
 uu_9                 2.066500e-01 1 1  ON 9
 ud_0                 3.604418e-01 1 1  ON 10
 ud_1                 1.008396e-01 1 1  ON 11
 ud_2                -1.075371e-02 1 1  ON 12
 ud_3                -7.379594e-02 1 1  ON 13
 ud_4                -1.239004e-01 1 1  ON 14
 ud_5                -1.594248e-01 1 1  ON 15
 ud_6                -1.699172e-01 1 1  ON 16
 ud_7                -1.426235e-01 1 1  ON 17
 ud_8                -7.196780e-02 1 1  ON 18
 ud_9                 7.865284e-02 1 1  ON 19
 eO_0                -8.963343e-01 1 1  ON 20
 eO_1                -5.702137e-01 1 1  ON 21
 eO_2                -1.499244e-01 1 1  ON 22
 eO_3                 1.246276e-01 1 1  ON 23
 eO_4                 2.499879e-01 1 1  ON 24
 eO_5                 3.252632e-01 1 1  ON 25
 eO_6                 3.531726e-01 1 1  ON 26
 eO_7                 4.011351e-01 1 1  ON 27
 eO_8                 1.014168e-01 1 1  ON 28
 eO_9                 3.821195e-02 1 1  ON 29
eH1_0                -2.030653e-01 1 1  ON 30
eH1_1                -1.238638e-01 1 1  ON 31
eH1_2                -8.188507e-02 1 1  ON 32
eH1_3                -4.452834e-02 1 1  ON 33
eH1_4                 9.068551e-04 1 1  ON 34
eH1_5                 1.144923e-02 1 1  ON 35
eH1_6                 4.992843e-02 1 1  ON 36
eH1_7                 4.765159e-02 1 1  ON 37
eH1_8                 2.187769e-01 1 1  ON 38
eH1_9                 8.402048e-02 1 1  ON 39
eH2_0                -2.033255e-01 1 1  ON 40
eH2_1                -1.237869e-01 1 1  ON 41
eH2_2                -8.176296e-02 1 1  ON 42
eH2_3                -4.443271e-02 1 1  ON 43
eH2_4                 9.960335e-04 1 1  ON 44
eH2_5                 1.163745e-02 1 1  ON 45
eH2_6                 5.363546e-02 1 1  ON 46
eH2_7                 6.391050e-02 1 1  ON 47
eH2_8                 2.111456e-01 1 1  ON 48
eH2_9                 8.149791e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1292
    reference variance = 0.165794
====================================================
  Execution time = 3.2385e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1295e-01
  Total weights = 2.0000e+06
  Execution time = 2.9891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312985836904
                                         uncertainty =       0.002440983965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312985836904
                                         uncertainty =       0.002440983965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395556479
  error estimate for blocks of size 2^( 2) =       0.000405448367
  error estimate for blocks of size 2^( 3) =       0.000414493757
  error estimate for blocks of size 2^( 4) =       0.000420565632
  error estimate for blocks of size 2^( 5) =       0.000424830320
  error estimate for blocks of size 2^( 6) =       0.000426926672
  error estimate for blocks of size 2^( 7) =       0.000425797989

      target function =                  N/A
              le_mean =     -17.217163755001
             les_mean =     296.743657466212
             stat err =       0.000424530153
             autocorr =       1.151861014803
              std dev =       0.559401337291
             le_variance =       0.312929856163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313030971773
                                         uncertainty =       0.002441297873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313030971773
                                         uncertainty =       0.002441297873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395585009
  error estimate for blocks of size 2^( 2) =       0.000405474946
  error estimate for blocks of size 2^( 3) =       0.000414518217
  error estimate for blocks of size 2^( 4) =       0.000420588336
  error estimate for blocks of size 2^( 5) =       0.000424853076
  error estimate for blocks of size 2^( 6) =       0.000426949127
  error estimate for blocks of size 2^( 7) =       0.000425823236

      target function =                  N/A
              le_mean =     -17.217164536246
             les_mean =     296.743729510126
             stat err =       0.000424553444
             autocorr =       1.151821246301
              std dev =       0.559441684590
             le_variance =       0.312974998457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313017078520
                                         uncertainty =       0.002441202795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313017078520
                                         uncertainty =       0.002441202795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395576225
  error estimate for blocks of size 2^( 2) =       0.000405466715
  error estimate for blocks of size 2^( 3) =       0.000414510677
  error estimate for blocks of size 2^( 4) =       0.000420581422
  error estimate for blocks of size 2^( 5) =       0.000424846140
  error estimate for blocks of size 2^( 6) =       0.000426942177
  error estimate for blocks of size 2^( 7) =       0.000425814884

      target function =                  N/A
              le_mean =     -17.217164211275
             les_mean =     296.743704420839
             stat err =       0.000424546156
             autocorr =       1.151832855205
              std dev =       0.559429262113
             le_variance =       0.312961099308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312990033619
                                         uncertainty =       0.002441013095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312990033619
                                         uncertainty =       0.002441013095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395559132
  error estimate for blocks of size 2^( 2) =       0.000405450828
  error estimate for blocks of size 2^( 3) =       0.000414496027
  error estimate for blocks of size 2^( 4) =       0.000420567755
  error estimate for blocks of size 2^( 5) =       0.000424832449
  error estimate for blocks of size 2^( 6) =       0.000426928750
  error estimate for blocks of size 2^( 7) =       0.000425800244

      target function =                  N/A
              le_mean =     -17.217163812301
             les_mean =     296.743663636176
             stat err =       0.000424532299
             autocorr =       1.151857214068
              std dev =       0.559405088492
             le_variance =       0.312934053031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217163755001        initial
     9.0949e-01     9.0949e+00             1.1312e-04       -17.217164536246  <--
     3.6380e+00     3.6380e+01             3.3882e-05       -17.217164211275
     1.4552e+01     1.4552e+02             8.7353e-06       -17.217163812301

*****************************************************************************
Applying the update for shift_i =   9.0949e-01     and shift_s =   9.0949e+00
*****************************************************************************

  Execution time = 4.7448e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.073426e-01 1 1  ON 0
 uu_1                 4.380030e-02 1 1  ON 1
 uu_2                -5.301586e-02 1 1  ON 2
 uu_3                -1.106308e-01 1 1  ON 3
 uu_4                -1.474606e-01 1 1  ON 4
 uu_5                -1.594939e-01 1 1  ON 5
 uu_6                -1.461119e-01 1 1  ON 6
 uu_7                -9.606802e-02 1 1  ON 7
 uu_8                -1.475965e-03 1 1  ON 8
 uu_9                 2.066382e-01 1 1  ON 9
 ud_0                 3.604264e-01 1 1  ON 10
 ud_1                 1.008228e-01 1 1  ON 11
 ud_2                -1.076952e-02 1 1  ON 12
 ud_3                -7.375859e-02 1 1  ON 13
 ud_4                -1.238886e-01 1 1  ON 14
 ud_5                -1.594039e-01 1 1  ON 15
 ud_6                -1.699385e-01 1 1  ON 16
 ud_7                -1.426084e-01 1 1  ON 17
 ud_8                -7.199222e-02 1 1  ON 18
 ud_9                 7.863285e-02 1 1  ON 19
 eO_0                -8.963484e-01 1 1  ON 20
 eO_1                -5.701801e-01 1 1  ON 21
 eO_2                -1.499710e-01 1 1  ON 22
 eO_3                 1.246410e-01 1 1  ON 23
 eO_4                 2.499926e-01 1 1  ON 24
 eO_5                 3.252718e-01 1 1  ON 25
 eO_6                 3.531481e-01 1 1  ON 26
 eO_7                 4.011402e-01 1 1  ON 27
 eO_8                 1.014275e-01 1 1  ON 28
 eO_9                 3.821634e-02 1 1  ON 29
eH1_0                -2.030680e-01 1 1  ON 30
eH1_1                -1.239469e-01 1 1  ON 31
eH1_2                -8.191692e-02 1 1  ON 32
eH1_3                -4.454201e-02 1 1  ON 33
eH1_4                 9.761416e-04 1 1  ON 34
eH1_5                 1.147508e-02 1 1  ON 35
eH1_6                 4.995670e-02 1 1  ON 36
eH1_7                 4.765707e-02 1 1  ON 37
eH1_8                 2.187689e-01 1 1  ON 38
eH1_9                 8.402530e-02 1 1  ON 39
eH2_0                -2.032889e-01 1 1  ON 40
eH2_1                -1.237420e-01 1 1  ON 41
eH2_2                -8.183160e-02 1 1  ON 42
eH2_3                -4.443198e-02 1 1  ON 43
eH2_4                 1.052909e-03 1 1  ON 44
eH2_5                 1.159319e-02 1 1  ON 45
eH2_6                 5.359229e-02 1 1  ON 46
eH2_7                 6.391532e-02 1 1  ON 47
eH2_8                 2.111444e-01 1 1  ON 48
eH2_9                 8.150537e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2374
    reference variance = 0.286282
====================================================
  Execution time = 3.2601e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2384e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323922340670
                                         uncertainty =       0.003643118573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323922340670
                                         uncertainty =       0.003643118573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402395656
  error estimate for blocks of size 2^( 2) =       0.000411881336
  error estimate for blocks of size 2^( 3) =       0.000420029617
  error estimate for blocks of size 2^( 4) =       0.000425837523
  error estimate for blocks of size 2^( 5) =       0.000428935156
  error estimate for blocks of size 2^( 6) =       0.000429800422
  error estimate for blocks of size 2^( 7) =       0.000431279043

      target function =                  N/A
              le_mean =     -17.217473638252
             les_mean =     296.765242849220
             stat err =       0.000428963036
             autocorr =       1.136405100629
              std dev =       0.569073393554
             le_variance =       0.323844527251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721747363825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217473638252       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217472101387       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217471161074       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217470680949       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217470263617       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217470359768       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217469859525       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217469734715       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217469974672       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e-01 is 4.262066e-04

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217473638252       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217473001520       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217472594180       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217472354332       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217472047496       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217472018859       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217471905629       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e-01 is 1.210926e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217473638252       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217473447772       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217473320382       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217473236415       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217473149124       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217473126250       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217473090189       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 3.918625e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1630e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.073005e-01 1 1  ON 0
 uu_1                 4.390578e-02 1 1  ON 1
 uu_2                -5.292673e-02 1 1  ON 2
 uu_3                -1.105385e-01 1 1  ON 3
 uu_4                -1.474634e-01 1 1  ON 4
 uu_5                -1.596000e-01 1 1  ON 5
 uu_6                -1.462167e-01 1 1  ON 6
 uu_7                -9.608377e-02 1 1  ON 7
 uu_8                -1.492849e-03 1 1  ON 8
 uu_9                 2.066106e-01 1 1  ON 9
 ud_0                 3.603053e-01 1 1  ON 10
 ud_1                 1.008107e-01 1 1  ON 11
 ud_2                -1.068175e-02 1 1  ON 12
 ud_3                -7.367513e-02 1 1  ON 13
 ud_4                -1.238177e-01 1 1  ON 14
 ud_5                -1.593068e-01 1 1  ON 15
 ud_6                -1.699679e-01 1 1  ON 16
 ud_7                -1.426765e-01 1 1  ON 17
 ud_8                -7.206124e-02 1 1  ON 18
 ud_9                 7.857969e-02 1 1  ON 19
 eO_0                -8.963850e-01 1 1  ON 20
 eO_1                -5.700961e-01 1 1  ON 21
 eO_2                -1.499881e-01 1 1  ON 22
 eO_3                 1.246699e-01 1 1  ON 23
 eO_4                 2.499746e-01 1 1  ON 24
 eO_5                 3.252648e-01 1 1  ON 25
 eO_6                 3.530908e-01 1 1  ON 26
 eO_7                 4.011431e-01 1 1  ON 27
 eO_8                 1.014442e-01 1 1  ON 28
 eO_9                 3.821840e-02 1 1  ON 29
eH1_0                -2.031235e-01 1 1  ON 30
eH1_1                -1.239963e-01 1 1  ON 31
eH1_2                -8.194507e-02 1 1  ON 32
eH1_3                -4.452612e-02 1 1  ON 33
eH1_4                 1.093586e-03 1 1  ON 34
eH1_5                 1.155158e-02 1 1  ON 35
eH1_6                 4.991052e-02 1 1  ON 36
eH1_7                 4.764923e-02 1 1  ON 37
eH1_8                 2.187467e-01 1 1  ON 38
eH1_9                 8.402292e-02 1 1  ON 39
eH2_0                -2.032793e-01 1 1  ON 40
eH2_1                -1.238471e-01 1 1  ON 41
eH2_2                -8.190643e-02 1 1  ON 42
eH2_3                -4.439140e-02 1 1  ON 43
eH2_4                 1.147412e-03 1 1  ON 44
eH2_5                 1.166608e-02 1 1  ON 45
eH2_6                 5.355204e-02 1 1  ON 46
eH2_7                 6.391056e-02 1 1  ON 47
eH2_8                 2.111405e-01 1 1  ON 48
eH2_9                 8.151123e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2369
    reference variance = 0.273428
====================================================
  Execution time = 3.2048e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1469e-01
  Total weights = 2.0000e+06
  Execution time = 2.9992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314875199830
                                         uncertainty =       0.002469290065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314875199830
                                         uncertainty =       0.002469290065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396767925
  error estimate for blocks of size 2^( 2) =       0.000406770025
  error estimate for blocks of size 2^( 3) =       0.000414770096
  error estimate for blocks of size 2^( 4) =       0.000421809431
  error estimate for blocks of size 2^( 5) =       0.000424998636
  error estimate for blocks of size 2^( 6) =       0.000425785396
  error estimate for blocks of size 2^( 7) =       0.000427191101

      target function =                  N/A
              le_mean =     -17.216974611657
             les_mean =     296.739064193155
             stat err =       0.000424946141
             autocorr =       1.147082536525
              std dev =       0.561114580217
             le_variance =       0.314849572132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314562374819
                                         uncertainty =       0.002465866227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314562374819
                                         uncertainty =       0.002465866227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396570849
  error estimate for blocks of size 2^( 2) =       0.000406579464
  error estimate for blocks of size 2^( 3) =       0.000414581116
  error estimate for blocks of size 2^( 4) =       0.000421618902
  error estimate for blocks of size 2^( 5) =       0.000424808105
  error estimate for blocks of size 2^( 6) =       0.000425597614
  error estimate for blocks of size 2^( 7) =       0.000427007493

      target function =                  N/A
              le_mean =     -17.216974459963
             les_mean =     296.738746274458
             stat err =       0.000424758029
             autocorr =       1.147206551291
              std dev =       0.560835873238
             le_variance =       0.314536876711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314560736244
                                         uncertainty =       0.002465938794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314560736244
                                         uncertainty =       0.002465938794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396569816
  error estimate for blocks of size 2^( 2) =       0.000406578966
  error estimate for blocks of size 2^( 3) =       0.000414581589
  error estimate for blocks of size 2^( 4) =       0.000421619664
  error estimate for blocks of size 2^( 5) =       0.000424809111
  error estimate for blocks of size 2^( 6) =       0.000425597106
  error estimate for blocks of size 2^( 7) =       0.000427006921

      target function =                  N/A
              le_mean =     -17.216973481478
             les_mean =     296.738710942546
             stat err =       0.000424758200
             autocorr =       1.147213456240
              std dev =       0.560834412203
             le_variance =       0.314535237911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314824722640
                                         uncertainty =       0.002468756953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314824722640
                                         uncertainty =       0.002468756953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396736131
  error estimate for blocks of size 2^( 2) =       0.000406739365
  error estimate for blocks of size 2^( 3) =       0.000414739833
  error estimate for blocks of size 2^( 4) =       0.000421778934
  error estimate for blocks of size 2^( 5) =       0.000424968252
  error estimate for blocks of size 2^( 6) =       0.000425755127
  error estimate for blocks of size 2^( 7) =       0.000427161514

      target function =                  N/A
              le_mean =     -17.216974296441
             les_mean =     296.739002881516
             stat err =       0.000424915957
             autocorr =       1.147103417820
              std dev =       0.561069616551
             le_variance =       0.314799114617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216974611657        initial  <--
     2.2737e-01     2.2737e+00             4.2621e-04       -17.216974459963
     9.0949e-01     9.0949e+00             1.2109e-04       -17.216973481478
     3.6380e+00     3.6380e+01             3.9186e-05       -17.216974296441

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.1635
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.073426e-01 1 1  ON 0
 uu_1                 4.380030e-02 1 1  ON 1
 uu_2                -5.301586e-02 1 1  ON 2
 uu_3                -1.106308e-01 1 1  ON 3
 uu_4                -1.474606e-01 1 1  ON 4
 uu_5                -1.594939e-01 1 1  ON 5
 uu_6                -1.461119e-01 1 1  ON 6
 uu_7                -9.606802e-02 1 1  ON 7
 uu_8                -1.475965e-03 1 1  ON 8
 uu_9                 2.066382e-01 1 1  ON 9
 ud_0                 3.604264e-01 1 1  ON 10
 ud_1                 1.008228e-01 1 1  ON 11
 ud_2                -1.076952e-02 1 1  ON 12
 ud_3                -7.375859e-02 1 1  ON 13
 ud_4                -1.238886e-01 1 1  ON 14
 ud_5                -1.594039e-01 1 1  ON 15
 ud_6                -1.699385e-01 1 1  ON 16
 ud_7                -1.426084e-01 1 1  ON 17
 ud_8                -7.199222e-02 1 1  ON 18
 ud_9                 7.863285e-02 1 1  ON 19
 eO_0                -8.963484e-01 1 1  ON 20
 eO_1                -5.701801e-01 1 1  ON 21
 eO_2                -1.499710e-01 1 1  ON 22
 eO_3                 1.246410e-01 1 1  ON 23
 eO_4                 2.499926e-01 1 1  ON 24
 eO_5                 3.252718e-01 1 1  ON 25
 eO_6                 3.531481e-01 1 1  ON 26
 eO_7                 4.011402e-01 1 1  ON 27
 eO_8                 1.014275e-01 1 1  ON 28
 eO_9                 3.821634e-02 1 1  ON 29
eH1_0                -2.030680e-01 1 1  ON 30
eH1_1                -1.239469e-01 1 1  ON 31
eH1_2                -8.191692e-02 1 1  ON 32
eH1_3                -4.454201e-02 1 1  ON 33
eH1_4                 9.761416e-04 1 1  ON 34
eH1_5                 1.147508e-02 1 1  ON 35
eH1_6                 4.995670e-02 1 1  ON 36
eH1_7                 4.765707e-02 1 1  ON 37
eH1_8                 2.187689e-01 1 1  ON 38
eH1_9                 8.402530e-02 1 1  ON 39
eH2_0                -2.032889e-01 1 1  ON 40
eH2_1                -1.237420e-01 1 1  ON 41
eH2_2                -8.183160e-02 1 1  ON 42
eH2_3                -4.443198e-02 1 1  ON 43
eH2_4                 1.052909e-03 1 1  ON 44
eH2_5                 1.159319e-02 1 1  ON 45
eH2_6                 5.359229e-02 1 1  ON 46
eH2_7                 6.391532e-02 1 1  ON 47
eH2_8                 2.111444e-01 1 1  ON 48
eH2_9                 8.150537e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8818e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2149
    reference variance = 0.260054
====================================================
  Execution time = 3.1976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3377e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333777400248
                                         uncertainty =       0.010533672882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333777400248
                                         uncertainty =       0.010533672882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408513767
  error estimate for blocks of size 2^( 2) =       0.000417633608
  error estimate for blocks of size 2^( 3) =       0.000425825985
  error estimate for blocks of size 2^( 4) =       0.000431384824
  error estimate for blocks of size 2^( 5) =       0.000434113195
  error estimate for blocks of size 2^( 6) =       0.000435590276
  error estimate for blocks of size 2^( 7) =       0.000433286709

      target function =                  N/A
              le_mean =     -17.216231038522
             les_mean =     296.732378000702
             stat err =       0.000433593751
             autocorr =       1.126555611401
              std dev =       0.577725709848
             le_variance =       0.333766995819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721623103852e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216231038522       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216231053518       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216230939259       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216230901334       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216230896188       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216230879190       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216230876815       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+00 is 6.056643e-05

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216231038522       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216231042521       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216231010998       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216230998125       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216230995332       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216230990183       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 1.548850e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216231038522       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216231039539       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216231031447       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216231027953       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216231027143       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216231025787       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 3.939263e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.430782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0996e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.073541e-01 1 1  ON 0
 uu_1                 4.381038e-02 1 1  ON 1
 uu_2                -5.302097e-02 1 1  ON 2
 uu_3                -1.106307e-01 1 1  ON 3
 uu_4                -1.474605e-01 1 1  ON 4
 uu_5                -1.594947e-01 1 1  ON 5
 uu_6                -1.461164e-01 1 1  ON 6
 uu_7                -9.607715e-02 1 1  ON 7
 uu_8                -1.479654e-03 1 1  ON 8
 uu_9                 2.066363e-01 1 1  ON 9
 ud_0                 3.604338e-01 1 1  ON 10
 ud_1                 1.008170e-01 1 1  ON 11
 ud_2                -1.076780e-02 1 1  ON 12
 ud_3                -7.375749e-02 1 1  ON 13
 ud_4                -1.238860e-01 1 1  ON 14
 ud_5                -1.593997e-01 1 1  ON 15
 ud_6                -1.699393e-01 1 1  ON 16
 ud_7                -1.426119e-01 1 1  ON 17
 ud_8                -7.199862e-02 1 1  ON 18
 ud_9                 7.862959e-02 1 1  ON 19
 eO_0                -8.963467e-01 1 1  ON 20
 eO_1                -5.701824e-01 1 1  ON 21
 eO_2                -1.499589e-01 1 1  ON 22
 eO_3                 1.246255e-01 1 1  ON 23
 eO_4                 2.499927e-01 1 1  ON 24
 eO_5                 3.252763e-01 1 1  ON 25
 eO_6                 3.531446e-01 1 1  ON 26
 eO_7                 4.011407e-01 1 1  ON 27
 eO_8                 1.014289e-01 1 1  ON 28
 eO_9                 3.821682e-02 1 1  ON 29
eH1_0                -2.030695e-01 1 1  ON 30
eH1_1                -1.239603e-01 1 1  ON 31
eH1_2                -8.191508e-02 1 1  ON 32
eH1_3                -4.453810e-02 1 1  ON 33
eH1_4                 9.821138e-04 1 1  ON 34
eH1_5                 1.147922e-02 1 1  ON 35
eH1_6                 4.995481e-02 1 1  ON 36
eH1_7                 4.765751e-02 1 1  ON 37
eH1_8                 2.187685e-01 1 1  ON 38
eH1_9                 8.402577e-02 1 1  ON 39
eH2_0                -2.032889e-01 1 1  ON 40
eH2_1                -1.237402e-01 1 1  ON 41
eH2_2                -8.182733e-02 1 1  ON 42
eH2_3                -4.442872e-02 1 1  ON 43
eH2_4                 1.052627e-03 1 1  ON 44
eH2_5                 1.158618e-02 1 1  ON 45
eH2_6                 5.358945e-02 1 1  ON 46
eH2_7                 6.391515e-02 1 1  ON 47
eH2_8                 2.111437e-01 1 1  ON 48
eH2_9                 8.150617e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1722
    reference variance = 0.228244
====================================================
  Execution time = 3.1994e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2116e-01
  Total weights = 2.0000e+06
  Execution time = 2.9842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321174585021
                                         uncertainty =       0.003905602592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321174585021
                                         uncertainty =       0.003905602592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400718900
  error estimate for blocks of size 2^( 2) =       0.000409982408
  error estimate for blocks of size 2^( 3) =       0.000418181769
  error estimate for blocks of size 2^( 4) =       0.000424887211
  error estimate for blocks of size 2^( 5) =       0.000427761268
  error estimate for blocks of size 2^( 6) =       0.000428637354
  error estimate for blocks of size 2^( 7) =       0.000430120299

      target function =                  N/A
              le_mean =     -17.216461036196
             les_mean =     296.727681724308
             stat err =       0.000427851533
             autocorr =       1.140004408936
              std dev =       0.566702103426
             le_variance =       0.321151274028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321211964582
                                         uncertainty =       0.003906023467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321211964582
                                         uncertainty =       0.003906023467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400742247
  error estimate for blocks of size 2^( 2) =       0.000410004784
  error estimate for blocks of size 2^( 3) =       0.000418203464
  error estimate for blocks of size 2^( 4) =       0.000424908530
  error estimate for blocks of size 2^( 5) =       0.000427782249
  error estimate for blocks of size 2^( 6) =       0.000428658130
  error estimate for blocks of size 2^( 7) =       0.000430142834

      target function =                  N/A
              le_mean =     -17.216460994720
             les_mean =     296.727717719537
             stat err =       0.000427872936
             autocorr =       1.139985625464
              std dev =       0.566735121041
             le_variance =       0.321188697421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321196458365
                                         uncertainty =       0.003905836761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321196458365
                                         uncertainty =       0.003905836761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400732561
  error estimate for blocks of size 2^( 2) =       0.000409995491
  error estimate for blocks of size 2^( 3) =       0.000418194439
  error estimate for blocks of size 2^( 4) =       0.000424899646
  error estimate for blocks of size 2^( 5) =       0.000427773508
  error estimate for blocks of size 2^( 6) =       0.000428649488
  error estimate for blocks of size 2^( 7) =       0.000430133513

      target function =                  N/A
              le_mean =     -17.216460991395
             les_mean =     296.727702078688
             stat err =       0.000427864039
             autocorr =       1.139993325869
              std dev =       0.566721422782
             le_variance =       0.321173171040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321177421932
                                         uncertainty =       0.003905632605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321177421932
                                         uncertainty =       0.003905632605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400720672
  error estimate for blocks of size 2^( 2) =       0.000409984105
  error estimate for blocks of size 2^( 3) =       0.000418183413
  error estimate for blocks of size 2^( 4) =       0.000424888824
  error estimate for blocks of size 2^( 5) =       0.000427762855
  error estimate for blocks of size 2^( 6) =       0.000428638927
  error estimate for blocks of size 2^( 7) =       0.000430122013

      target function =                  N/A
              le_mean =     -17.216461029437
             les_mean =     296.727684331506
             stat err =       0.000427853155
             autocorr =       1.140002970848
              std dev =       0.566704609099
             le_variance =       0.321154113974


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216461036196        initial  <--
     2.2737e+00     2.2737e+01             6.0566e-05       -17.216460994720
     9.0949e+00     9.0949e+01             1.5488e-05       -17.216460991395
     3.6380e+01     3.6380e+02             3.9393e-06       -17.216461029437

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.0483
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.073426e-01 1 1  ON 0
 uu_1                 4.380030e-02 1 1  ON 1
 uu_2                -5.301586e-02 1 1  ON 2
 uu_3                -1.106308e-01 1 1  ON 3
 uu_4                -1.474606e-01 1 1  ON 4
 uu_5                -1.594939e-01 1 1  ON 5
 uu_6                -1.461119e-01 1 1  ON 6
 uu_7                -9.606802e-02 1 1  ON 7
 uu_8                -1.475965e-03 1 1  ON 8
 uu_9                 2.066382e-01 1 1  ON 9
 ud_0                 3.604264e-01 1 1  ON 10
 ud_1                 1.008228e-01 1 1  ON 11
 ud_2                -1.076952e-02 1 1  ON 12
 ud_3                -7.375859e-02 1 1  ON 13
 ud_4                -1.238886e-01 1 1  ON 14
 ud_5                -1.594039e-01 1 1  ON 15
 ud_6                -1.699385e-01 1 1  ON 16
 ud_7                -1.426084e-01 1 1  ON 17
 ud_8                -7.199222e-02 1 1  ON 18
 ud_9                 7.863285e-02 1 1  ON 19
 eO_0                -8.963484e-01 1 1  ON 20
 eO_1                -5.701801e-01 1 1  ON 21
 eO_2                -1.499710e-01 1 1  ON 22
 eO_3                 1.246410e-01 1 1  ON 23
 eO_4                 2.499926e-01 1 1  ON 24
 eO_5                 3.252718e-01 1 1  ON 25
 eO_6                 3.531481e-01 1 1  ON 26
 eO_7                 4.011402e-01 1 1  ON 27
 eO_8                 1.014275e-01 1 1  ON 28
 eO_9                 3.821634e-02 1 1  ON 29
eH1_0                -2.030680e-01 1 1  ON 30
eH1_1                -1.239469e-01 1 1  ON 31
eH1_2                -8.191692e-02 1 1  ON 32
eH1_3                -4.454201e-02 1 1  ON 33
eH1_4                 9.761416e-04 1 1  ON 34
eH1_5                 1.147508e-02 1 1  ON 35
eH1_6                 4.995670e-02 1 1  ON 36
eH1_7                 4.765707e-02 1 1  ON 37
eH1_8                 2.187689e-01 1 1  ON 38
eH1_9                 8.402530e-02 1 1  ON 39
eH2_0                -2.032889e-01 1 1  ON 40
eH2_1                -1.237420e-01 1 1  ON 41
eH2_2                -8.183160e-02 1 1  ON 42
eH2_3                -4.443198e-02 1 1  ON 43
eH2_4                 1.052909e-03 1 1  ON 44
eH2_5                 1.159319e-02 1 1  ON 45
eH2_6                 5.359229e-02 1 1  ON 46
eH2_7                 6.391532e-02 1 1  ON 47
eH2_8                 2.111444e-01 1 1  ON 48
eH2_9                 8.150537e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1747
    reference variance = 0.168453
====================================================
  Execution time = 3.2232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3145e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331449257118
                                         uncertainty =       0.012229875566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331449257118
                                         uncertainty =       0.012229875566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407093405
  error estimate for blocks of size 2^( 2) =       0.000416122197
  error estimate for blocks of size 2^( 3) =       0.000424924718
  error estimate for blocks of size 2^( 4) =       0.000431014774
  error estimate for blocks of size 2^( 5) =       0.000434899565
  error estimate for blocks of size 2^( 6) =       0.000437847061
  error estimate for blocks of size 2^( 7) =       0.000439289808

      target function =                  N/A
              le_mean =     -17.216637912753
             les_mean =     296.744070933141
             stat err =       0.000435762802
             autocorr =       1.145808861260
              std dev =       0.575717013849
             le_variance =       0.331450080035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663791275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216637912753       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216637903214       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216637890875       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216637888906       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216637884484       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216637885686       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216637882032       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 6.022624e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216637912753       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216637910349       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216637907233       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216637906727       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216637905606       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216637905907       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216637904990       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 1.511527e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216637912753       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216637912150       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216637911370       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216637911242       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216637910961       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216637911036       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216637910806       residual = 1.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 3.782489e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.436933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1230e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.073439e-01 1 1  ON 0
 uu_1                 4.380026e-02 1 1  ON 1
 uu_2                -5.301562e-02 1 1  ON 2
 uu_3                -1.106299e-01 1 1  ON 3
 uu_4                -1.474604e-01 1 1  ON 4
 uu_5                -1.594954e-01 1 1  ON 5
 uu_6                -1.461133e-01 1 1  ON 6
 uu_7                -9.606813e-02 1 1  ON 7
 uu_8                -1.475886e-03 1 1  ON 8
 uu_9                 2.066381e-01 1 1  ON 9
 ud_0                 3.604263e-01 1 1  ON 10
 ud_1                 1.008225e-01 1 1  ON 11
 ud_2                -1.076952e-02 1 1  ON 12
 ud_3                -7.375926e-02 1 1  ON 13
 ud_4                -1.238883e-01 1 1  ON 14
 ud_5                -1.594035e-01 1 1  ON 15
 ud_6                -1.699382e-01 1 1  ON 16
 ud_7                -1.426081e-01 1 1  ON 17
 ud_8                -7.199244e-02 1 1  ON 18
 ud_9                 7.863265e-02 1 1  ON 19
 eO_0                -8.963474e-01 1 1  ON 20
 eO_1                -5.701804e-01 1 1  ON 21
 eO_2                -1.499712e-01 1 1  ON 22
 eO_3                 1.246400e-01 1 1  ON 23
 eO_4                 2.499930e-01 1 1  ON 24
 eO_5                 3.252716e-01 1 1  ON 25
 eO_6                 3.531478e-01 1 1  ON 26
 eO_7                 4.011403e-01 1 1  ON 27
 eO_8                 1.014278e-01 1 1  ON 28
 eO_9                 3.821642e-02 1 1  ON 29
eH1_0                -2.030678e-01 1 1  ON 30
eH1_1                -1.239471e-01 1 1  ON 31
eH1_2                -8.191757e-02 1 1  ON 32
eH1_3                -4.454267e-02 1 1  ON 33
eH1_4                 9.764009e-04 1 1  ON 34
eH1_5                 1.147489e-02 1 1  ON 35
eH1_6                 4.995717e-02 1 1  ON 36
eH1_7                 4.765775e-02 1 1  ON 37
eH1_8                 2.187689e-01 1 1  ON 38
eH1_9                 8.402539e-02 1 1  ON 39
eH2_0                -2.032877e-01 1 1  ON 40
eH2_1                -1.237424e-01 1 1  ON 41
eH2_2                -8.183225e-02 1 1  ON 42
eH2_3                -4.443192e-02 1 1  ON 43
eH2_4                 1.053153e-03 1 1  ON 44
eH2_5                 1.159322e-02 1 1  ON 45
eH2_6                 5.359187e-02 1 1  ON 46
eH2_7                 6.391513e-02 1 1  ON 47
eH2_8                 2.111444e-01 1 1  ON 48
eH2_9                 8.150552e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2065
    reference variance = 0.253365
====================================================
  Execution time = 3.1599e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1767e-01
  Total weights = 2.0000e+06
  Execution time = 2.9915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317773456649
                                         uncertainty =       0.002920758612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317773456649
                                         uncertainty =       0.002920758612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398538448
  error estimate for blocks of size 2^( 2) =       0.000408011390
  error estimate for blocks of size 2^( 3) =       0.000416388243
  error estimate for blocks of size 2^( 4) =       0.000422504858
  error estimate for blocks of size 2^( 5) =       0.000427095125
  error estimate for blocks of size 2^( 6) =       0.000429958926
  error estimate for blocks of size 2^( 7) =       0.000430086986

      target function =                  N/A
              le_mean =     -17.216524794919
             les_mean =     296.726391643606
             stat err =       0.000427411474
             autocorr =       1.150143167165
              std dev =       0.563618477691
             le_variance =       0.317665788395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317774070251
                                         uncertainty =       0.002920743075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317774070251
                                         uncertainty =       0.002920743075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398538832
  error estimate for blocks of size 2^( 2) =       0.000408011778
  error estimate for blocks of size 2^( 3) =       0.000416388601
  error estimate for blocks of size 2^( 4) =       0.000422505170
  error estimate for blocks of size 2^( 5) =       0.000427095467
  error estimate for blocks of size 2^( 6) =       0.000429959250
  error estimate for blocks of size 2^( 7) =       0.000430087362

      target function =                  N/A
              le_mean =     -17.216524825804
             les_mean =     296.726393320653
             stat err =       0.000427411813
             autocorr =       1.150142768367
              std dev =       0.563619021999
             le_variance =       0.317666401959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317773766224
                                         uncertainty =       0.002920750700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317773766224
                                         uncertainty =       0.002920750700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398538642
  error estimate for blocks of size 2^( 2) =       0.000408011586
  error estimate for blocks of size 2^( 3) =       0.000416388424
  error estimate for blocks of size 2^( 4) =       0.000422505016
  error estimate for blocks of size 2^( 5) =       0.000427095298
  error estimate for blocks of size 2^( 6) =       0.000429959090
  error estimate for blocks of size 2^( 7) =       0.000430087177

      target function =                  N/A
              le_mean =     -17.216524810515
             les_mean =     296.726392490197
             stat err =       0.000427411645
             autocorr =       1.150142969206
              std dev =       0.563618752304
             le_variance =       0.317666097948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317773495417
                                         uncertainty =       0.002920757618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317773495417
                                         uncertainty =       0.002920757618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398538472
  error estimate for blocks of size 2^( 2) =       0.000408011414
  error estimate for blocks of size 2^( 3) =       0.000416388266
  error estimate for blocks of size 2^( 4) =       0.000422504878
  error estimate for blocks of size 2^( 5) =       0.000427095147
  error estimate for blocks of size 2^( 6) =       0.000429958947
  error estimate for blocks of size 2^( 7) =       0.000430087010

      target function =                  N/A
              le_mean =     -17.216524796871
             les_mean =     296.726391749594
             stat err =       0.000427411495
             autocorr =       1.150143142448
              std dev =       0.563618512081
             le_variance =       0.317665827160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216524794919        initial
     2.2737e+01     2.2737e+02             6.0226e-06       -17.216524825804  <--
     9.0949e+01     9.0949e+02             1.5115e-06       -17.216524810515
     3.6380e+02     3.6380e+03             3.7825e-07       -17.216524796871

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 4.6693e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.073476e-01 1 1  ON 0
 uu_1                 4.380014e-02 1 1  ON 1
 uu_2                -5.301488e-02 1 1  ON 2
 uu_3                -1.106271e-01 1 1  ON 3
 uu_4                -1.474598e-01 1 1  ON 4
 uu_5                -1.594999e-01 1 1  ON 5
 uu_6                -1.461174e-01 1 1  ON 6
 uu_7                -9.606848e-02 1 1  ON 7
 uu_8                -1.475652e-03 1 1  ON 8
 uu_9                 2.066379e-01 1 1  ON 9
 ud_0                 3.604261e-01 1 1  ON 10
 ud_1                 1.008214e-01 1 1  ON 11
 ud_2                -1.076953e-02 1 1  ON 12
 ud_3                -7.376122e-02 1 1  ON 13
 ud_4                -1.238877e-01 1 1  ON 14
 ud_5                -1.594022e-01 1 1  ON 15
 ud_6                -1.699373e-01 1 1  ON 16
 ud_7                -1.426073e-01 1 1  ON 17
 ud_8                -7.199309e-02 1 1  ON 18
 ud_9                 7.863204e-02 1 1  ON 19
 eO_0                -8.963445e-01 1 1  ON 20
 eO_1                -5.701813e-01 1 1  ON 21
 eO_2                -1.499717e-01 1 1  ON 22
 eO_3                 1.246372e-01 1 1  ON 23
 eO_4                 2.499942e-01 1 1  ON 24
 eO_5                 3.252710e-01 1 1  ON 25
 eO_6                 3.531468e-01 1 1  ON 26
 eO_7                 4.011409e-01 1 1  ON 27
 eO_8                 1.014286e-01 1 1  ON 28
 eO_9                 3.821663e-02 1 1  ON 29
eH1_0                -2.030671e-01 1 1  ON 30
eH1_1                -1.239478e-01 1 1  ON 31
eH1_2                -8.191952e-02 1 1  ON 32
eH1_3                -4.454463e-02 1 1  ON 33
eH1_4                 9.771761e-04 1 1  ON 34
eH1_5                 1.147435e-02 1 1  ON 35
eH1_6                 4.995858e-02 1 1  ON 36
eH1_7                 4.765976e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402566e-02 1 1  ON 39
eH2_0                -2.032842e-01 1 1  ON 40
eH2_1                -1.237438e-01 1 1  ON 41
eH2_2                -8.183421e-02 1 1  ON 42
eH2_3                -4.443177e-02 1 1  ON 43
eH2_4                 1.053887e-03 1 1  ON 44
eH2_5                 1.159332e-02 1 1  ON 45
eH2_6                 5.359062e-02 1 1  ON 46
eH2_7                 6.391459e-02 1 1  ON 47
eH2_8                 2.111444e-01 1 1  ON 48
eH2_9                 8.150596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2056
    reference variance = 0.238296
====================================================
  Execution time = 7.6360e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1864e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318632150920
                                         uncertainty =       0.003726042331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318632150920
                                         uncertainty =       0.003726042331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399148177
  error estimate for blocks of size 2^( 2) =       0.000408517467
  error estimate for blocks of size 2^( 3) =       0.000416514398
  error estimate for blocks of size 2^( 4) =       0.000422867242
  error estimate for blocks of size 2^( 5) =       0.000426726565
  error estimate for blocks of size 2^( 6) =       0.000429538995
  error estimate for blocks of size 2^( 7) =       0.000430603064

      target function =                  N/A
              le_mean =     -17.217409213764
             les_mean =     296.757818408757
             stat err =       0.000427433967
             autocorr =       1.146752676419
              std dev =       0.564480764844
             le_variance =       0.318638533879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721740921376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217409213764       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217409229827       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217409230330       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217409279537       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217409341862       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217409347336       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217409350550       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+00 is 2.060591e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217409213764       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217409217914       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217409218041       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217409231216       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217409247805       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217409248857       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217409249524       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 5.456693e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217409213764       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217409214810       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217409214842       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217409218195       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217409222411       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217409222653       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217409222811       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 1.385131e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.443006 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 8.5311e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.073453e-01 1 1  ON 0
 uu_1                 4.379801e-02 1 1  ON 1
 uu_2                -5.301379e-02 1 1  ON 2
 uu_3                -1.106260e-01 1 1  ON 3
 uu_4                -1.474594e-01 1 1  ON 4
 uu_5                -1.595007e-01 1 1  ON 5
 uu_6                -1.461169e-01 1 1  ON 6
 uu_7                -9.606682e-02 1 1  ON 7
 uu_8                -1.475654e-03 1 1  ON 8
 uu_9                 2.066372e-01 1 1  ON 9
 ud_0                 3.604224e-01 1 1  ON 10
 ud_1                 1.008237e-01 1 1  ON 11
 ud_2                -1.076545e-02 1 1  ON 12
 ud_3                -7.376181e-02 1 1  ON 13
 ud_4                -1.238822e-01 1 1  ON 14
 ud_5                -1.594049e-01 1 1  ON 15
 ud_6                -1.699393e-01 1 1  ON 16
 ud_7                -1.426076e-01 1 1  ON 17
 ud_8                -7.199509e-02 1 1  ON 18
 ud_9                 7.863068e-02 1 1  ON 19
 eO_0                -8.963440e-01 1 1  ON 20
 eO_1                -5.701833e-01 1 1  ON 21
 eO_2                -1.499719e-01 1 1  ON 22
 eO_3                 1.246356e-01 1 1  ON 23
 eO_4                 2.499955e-01 1 1  ON 24
 eO_5                 3.252724e-01 1 1  ON 25
 eO_6                 3.531450e-01 1 1  ON 26
 eO_7                 4.011418e-01 1 1  ON 27
 eO_8                 1.014297e-01 1 1  ON 28
 eO_9                 3.821679e-02 1 1  ON 29
eH1_0                -2.030708e-01 1 1  ON 30
eH1_1                -1.239496e-01 1 1  ON 31
eH1_2                -8.191786e-02 1 1  ON 32
eH1_3                -4.454370e-02 1 1  ON 33
eH1_4                 9.749929e-04 1 1  ON 34
eH1_5                 1.147702e-02 1 1  ON 35
eH1_6                 4.996026e-02 1 1  ON 36
eH1_7                 4.766083e-02 1 1  ON 37
eH1_8                 2.187680e-01 1 1  ON 38
eH1_9                 8.402591e-02 1 1  ON 39
eH2_0                -2.032814e-01 1 1  ON 40
eH2_1                -1.237487e-01 1 1  ON 41
eH2_2                -8.183557e-02 1 1  ON 42
eH2_3                -4.442813e-02 1 1  ON 43
eH2_4                 1.054816e-03 1 1  ON 44
eH2_5                 1.159380e-02 1 1  ON 45
eH2_6                 5.358813e-02 1 1  ON 46
eH2_7                 6.391466e-02 1 1  ON 47
eH2_8                 2.111446e-01 1 1  ON 48
eH2_9                 8.150632e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1716
    reference variance = 0.260856
====================================================
  Execution time = 3.2276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2295e-01
  Total weights = 2.0000e+06
  Execution time = 2.9830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323008738295
                                         uncertainty =       0.005172904486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323008738295
                                         uncertainty =       0.005172904486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401846509
  error estimate for blocks of size 2^( 2) =       0.000411306546
  error estimate for blocks of size 2^( 3) =       0.000419207659
  error estimate for blocks of size 2^( 4) =       0.000425301796
  error estimate for blocks of size 2^( 5) =       0.000429101570
  error estimate for blocks of size 2^( 6) =       0.000432540287
  error estimate for blocks of size 2^( 7) =       0.000434873782

      target function =                  N/A
              le_mean =     -17.216495705396
             les_mean =     296.730685446215
             stat err =       0.000430454359
             autocorr =       1.147450130229
              std dev =       0.568296783188
             le_variance =       0.322961233781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322977721550
                                         uncertainty =       0.005171728084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322977721550
                                         uncertainty =       0.005171728084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401827221
  error estimate for blocks of size 2^( 2) =       0.000411288112
  error estimate for blocks of size 2^( 3) =       0.000419189830
  error estimate for blocks of size 2^( 4) =       0.000425284493
  error estimate for blocks of size 2^( 5) =       0.000429084461
  error estimate for blocks of size 2^( 6) =       0.000432522870
  error estimate for blocks of size 2^( 7) =       0.000434855835

      target function =                  N/A
              le_mean =     -17.216495672338
             les_mean =     296.730653305796
             stat err =       0.000430436915
             autocorr =       1.147467281294
              std dev =       0.568269506169
             le_variance =       0.322930231642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322992390465
                                         uncertainty =       0.005172286011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322992390465
                                         uncertainty =       0.005172286011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401836343
  error estimate for blocks of size 2^( 2) =       0.000411296833
  error estimate for blocks of size 2^( 3) =       0.000419198262
  error estimate for blocks of size 2^( 4) =       0.000425292674
  error estimate for blocks of size 2^( 5) =       0.000429092548
  error estimate for blocks of size 2^( 6) =       0.000432531104
  error estimate for blocks of size 2^( 7) =       0.000434864326

      target function =                  N/A
              le_mean =     -17.216495686830
             les_mean =     296.730668466847
             stat err =       0.000430445163
             autocorr =       1.147459160789
              std dev =       0.568282406616
             le_variance =       0.322944893669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323006665901
                                         uncertainty =       0.005172826145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323006665901
                                         uncertainty =       0.005172826145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401845220
  error estimate for blocks of size 2^( 2) =       0.000411305315
  error estimate for blocks of size 2^( 3) =       0.000419206468
  error estimate for blocks of size 2^( 4) =       0.000425300640
  error estimate for blocks of size 2^( 5) =       0.000429100426
  error estimate for blocks of size 2^( 6) =       0.000432539123
  error estimate for blocks of size 2^( 7) =       0.000434872583

      target function =                  N/A
              le_mean =     -17.216495702933
             les_mean =     296.730683290004
             stat err =       0.000430453193
             autocorr =       1.147451274290
              std dev =       0.568294960709
             le_variance =       0.322959162367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216495705396        initial  <--
     5.6843e+00     5.6843e+01             2.0606e-05       -17.216495672338
     2.2737e+01     2.2737e+02             5.4567e-06       -17.216495686830
     9.0949e+01     9.0949e+02             1.3851e-06       -17.216495702933

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.3223
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.073476e-01 1 1  ON 0
 uu_1                 4.380014e-02 1 1  ON 1
 uu_2                -5.301488e-02 1 1  ON 2
 uu_3                -1.106271e-01 1 1  ON 3
 uu_4                -1.474598e-01 1 1  ON 4
 uu_5                -1.594999e-01 1 1  ON 5
 uu_6                -1.461174e-01 1 1  ON 6
 uu_7                -9.606848e-02 1 1  ON 7
 uu_8                -1.475652e-03 1 1  ON 8
 uu_9                 2.066379e-01 1 1  ON 9
 ud_0                 3.604261e-01 1 1  ON 10
 ud_1                 1.008214e-01 1 1  ON 11
 ud_2                -1.076953e-02 1 1  ON 12
 ud_3                -7.376122e-02 1 1  ON 13
 ud_4                -1.238877e-01 1 1  ON 14
 ud_5                -1.594022e-01 1 1  ON 15
 ud_6                -1.699373e-01 1 1  ON 16
 ud_7                -1.426073e-01 1 1  ON 17
 ud_8                -7.199309e-02 1 1  ON 18
 ud_9                 7.863204e-02 1 1  ON 19
 eO_0                -8.963445e-01 1 1  ON 20
 eO_1                -5.701813e-01 1 1  ON 21
 eO_2                -1.499717e-01 1 1  ON 22
 eO_3                 1.246372e-01 1 1  ON 23
 eO_4                 2.499942e-01 1 1  ON 24
 eO_5                 3.252710e-01 1 1  ON 25
 eO_6                 3.531468e-01 1 1  ON 26
 eO_7                 4.011409e-01 1 1  ON 27
 eO_8                 1.014286e-01 1 1  ON 28
 eO_9                 3.821663e-02 1 1  ON 29
eH1_0                -2.030671e-01 1 1  ON 30
eH1_1                -1.239478e-01 1 1  ON 31
eH1_2                -8.191952e-02 1 1  ON 32
eH1_3                -4.454463e-02 1 1  ON 33
eH1_4                 9.771761e-04 1 1  ON 34
eH1_5                 1.147435e-02 1 1  ON 35
eH1_6                 4.995858e-02 1 1  ON 36
eH1_7                 4.765976e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402566e-02 1 1  ON 39
eH2_0                -2.032842e-01 1 1  ON 40
eH2_1                -1.237438e-01 1 1  ON 41
eH2_2                -8.183421e-02 1 1  ON 42
eH2_3                -4.443177e-02 1 1  ON 43
eH2_4                 1.053887e-03 1 1  ON 44
eH2_5                 1.159332e-02 1 1  ON 45
eH2_6                 5.359062e-02 1 1  ON 46
eH2_7                 6.391459e-02 1 1  ON 47
eH2_8                 2.111444e-01 1 1  ON 48
eH2_9                 8.150596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3312e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1046
    reference variance = 0.341265
====================================================
  Execution time = 3.2243e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3473e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334814072480
                                         uncertainty =       0.008062881678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334814072480
                                         uncertainty =       0.008062881678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409105491
  error estimate for blocks of size 2^( 2) =       0.000418194498
  error estimate for blocks of size 2^( 3) =       0.000426276213
  error estimate for blocks of size 2^( 4) =       0.000432605060
  error estimate for blocks of size 2^( 5) =       0.000437466493
  error estimate for blocks of size 2^( 6) =       0.000440018333
  error estimate for blocks of size 2^( 7) =       0.000439900149

      target function =                  N/A
              le_mean =     -17.216839007830
             les_mean =     296.754279859562
             stat err =       0.000437497509
             autocorr =       1.143616865939
              std dev =       0.578562533685
             le_variance =       0.334734605384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683900783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216839007830       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216839012199       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216839028225       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216839028120       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216839029762       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216839030074       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216839029703       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+01 is 2.934955e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216839007830       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216839008925       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216839012954       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216839012926       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216839013332       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216839013425       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216839013320       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 7.357480e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216839007830       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216839008104       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216839009113       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216839009105       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216839009207       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216839009232       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216839009204       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 1.840632e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.445226 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1223e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.073477e-01 1 1  ON 0
 uu_1                 4.379984e-02 1 1  ON 1
 uu_2                -5.301491e-02 1 1  ON 2
 uu_3                -1.106268e-01 1 1  ON 3
 uu_4                -1.474598e-01 1 1  ON 4
 uu_5                -1.594999e-01 1 1  ON 5
 uu_6                -1.461178e-01 1 1  ON 6
 uu_7                -9.606846e-02 1 1  ON 7
 uu_8                -1.475600e-03 1 1  ON 8
 uu_9                 2.066379e-01 1 1  ON 9
 ud_0                 3.604259e-01 1 1  ON 10
 ud_1                 1.008212e-01 1 1  ON 11
 ud_2                -1.076911e-02 1 1  ON 12
 ud_3                -7.376156e-02 1 1  ON 13
 ud_4                -1.238880e-01 1 1  ON 14
 ud_5                -1.594022e-01 1 1  ON 15
 ud_6                -1.699369e-01 1 1  ON 16
 ud_7                -1.426071e-01 1 1  ON 17
 ud_8                -7.199318e-02 1 1  ON 18
 ud_9                 7.863197e-02 1 1  ON 19
 eO_0                -8.963441e-01 1 1  ON 20
 eO_1                -5.701809e-01 1 1  ON 21
 eO_2                -1.499720e-01 1 1  ON 22
 eO_3                 1.246365e-01 1 1  ON 23
 eO_4                 2.499939e-01 1 1  ON 24
 eO_5                 3.252711e-01 1 1  ON 25
 eO_6                 3.531468e-01 1 1  ON 26
 eO_7                 4.011410e-01 1 1  ON 27
 eO_8                 1.014287e-01 1 1  ON 28
 eO_9                 3.821667e-02 1 1  ON 29
eH1_0                -2.030676e-01 1 1  ON 30
eH1_1                -1.239485e-01 1 1  ON 31
eH1_2                -8.191939e-02 1 1  ON 32
eH1_3                -4.454464e-02 1 1  ON 33
eH1_4                 9.775636e-04 1 1  ON 34
eH1_5                 1.147416e-02 1 1  ON 35
eH1_6                 4.995896e-02 1 1  ON 36
eH1_7                 4.766007e-02 1 1  ON 37
eH1_8                 2.187688e-01 1 1  ON 38
eH1_9                 8.402573e-02 1 1  ON 39
eH2_0                -2.032839e-01 1 1  ON 40
eH2_1                -1.237437e-01 1 1  ON 41
eH2_2                -8.183455e-02 1 1  ON 42
eH2_3                -4.443176e-02 1 1  ON 43
eH2_4                 1.054220e-03 1 1  ON 44
eH2_5                 1.159326e-02 1 1  ON 45
eH2_6                 5.359030e-02 1 1  ON 46
eH2_7                 6.391456e-02 1 1  ON 47
eH2_8                 2.111443e-01 1 1  ON 48
eH2_9                 8.150601e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2003
    reference variance = 0.262716
====================================================
  Execution time = 3.1878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2402e-01
  Total weights = 2.0000e+06
  Execution time = 2.9889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324084306171
                                         uncertainty =       0.005700859332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324084306171
                                         uncertainty =       0.005700859332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402501955
  error estimate for blocks of size 2^( 2) =       0.000411813112
  error estimate for blocks of size 2^( 3) =       0.000420176548
  error estimate for blocks of size 2^( 4) =       0.000425612175
  error estimate for blocks of size 2^( 5) =       0.000429251032
  error estimate for blocks of size 2^( 6) =       0.000429897642
  error estimate for blocks of size 2^( 7) =       0.000431020046

      target function =                  N/A
              le_mean =     -17.216881312269
             les_mean =     296.745017605640
             stat err =       0.000428945224
             autocorr =       1.135710615781
              std dev =       0.569223723063
             le_variance =       0.324015646898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324082762278
                                         uncertainty =       0.005700801886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324082762278
                                         uncertainty =       0.005700801886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402500996
  error estimate for blocks of size 2^( 2) =       0.000411812226
  error estimate for blocks of size 2^( 3) =       0.000420175733
  error estimate for blocks of size 2^( 4) =       0.000425611380
  error estimate for blocks of size 2^( 5) =       0.000429250244
  error estimate for blocks of size 2^( 6) =       0.000429896887
  error estimate for blocks of size 2^( 7) =       0.000431019370

      target function =                  N/A
              le_mean =     -17.216881321048
             les_mean =     296.745016364561
             stat err =       0.000428944470
             autocorr =       1.135712035953
              std dev =       0.569222367387
             le_variance =       0.324014103534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324083530320
                                         uncertainty =       0.005700830475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324083530320
                                         uncertainty =       0.005700830475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402501473
  error estimate for blocks of size 2^( 2) =       0.000411812667
  error estimate for blocks of size 2^( 3) =       0.000420176139
  error estimate for blocks of size 2^( 4) =       0.000425611776
  error estimate for blocks of size 2^( 5) =       0.000429250636
  error estimate for blocks of size 2^( 6) =       0.000429897263
  error estimate for blocks of size 2^( 7) =       0.000431019707

      target function =                  N/A
              le_mean =     -17.216881316702
             les_mean =     296.745016982709
             stat err =       0.000428944845
             autocorr =       1.135711330469
              std dev =       0.569223041797
             le_variance =       0.324014871312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324084209059
                                         uncertainty =       0.005700855720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324084209059
                                         uncertainty =       0.005700855720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402501894
  error estimate for blocks of size 2^( 2) =       0.000411813056
  error estimate for blocks of size 2^( 3) =       0.000420176497
  error estimate for blocks of size 2^( 4) =       0.000425612125
  error estimate for blocks of size 2^( 5) =       0.000429250982
  error estimate for blocks of size 2^( 6) =       0.000429897594
  error estimate for blocks of size 2^( 7) =       0.000431020004

      target function =                  N/A
              le_mean =     -17.216881312823
             les_mean =     296.745017527655
             stat err =       0.000428945176
             autocorr =       1.135710705268
              std dev =       0.569223637790
             le_variance =       0.324015549818


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216881312269        initial
     5.6843e+01     5.6843e+02             2.9350e-06       -17.216881321048  <--
     2.2737e+02     2.2737e+03             7.3575e-07       -17.216881316702
     9.0949e+02     9.0949e+03             1.8406e-07       -17.216881312823

*****************************************************************************
Applying the update for shift_i =   5.6843e+01     and shift_s =   5.6843e+02
*****************************************************************************

  Execution time = 4.6954e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.073480e-01 1 1  ON 0
 uu_1                 4.379894e-02 1 1  ON 1
 uu_2                -5.301498e-02 1 1  ON 2
 uu_3                -1.106260e-01 1 1  ON 3
 uu_4                -1.474596e-01 1 1  ON 4
 uu_5                -1.594999e-01 1 1  ON 5
 uu_6                -1.461191e-01 1 1  ON 6
 uu_7                -9.606837e-02 1 1  ON 7
 uu_8                -1.475442e-03 1 1  ON 8
 uu_9                 2.066379e-01 1 1  ON 9
 ud_0                 3.604254e-01 1 1  ON 10
 ud_1                 1.008206e-01 1 1  ON 11
 ud_2                -1.076787e-02 1 1  ON 12
 ud_3                -7.376257e-02 1 1  ON 13
 ud_4                -1.238890e-01 1 1  ON 14
 ud_5                -1.594021e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.426066e-01 1 1  ON 17
 ud_8                -7.199344e-02 1 1  ON 18
 ud_9                 7.863176e-02 1 1  ON 19
 eO_0                -8.963432e-01 1 1  ON 20
 eO_1                -5.701796e-01 1 1  ON 21
 eO_2                -1.499728e-01 1 1  ON 22
 eO_3                 1.246345e-01 1 1  ON 23
 eO_4                 2.499931e-01 1 1  ON 24
 eO_5                 3.252715e-01 1 1  ON 25
 eO_6                 3.531468e-01 1 1  ON 26
 eO_7                 4.011414e-01 1 1  ON 27
 eO_8                 1.014290e-01 1 1  ON 28
 eO_9                 3.821680e-02 1 1  ON 29
eH1_0                -2.030689e-01 1 1  ON 30
eH1_1                -1.239507e-01 1 1  ON 31
eH1_2                -8.191903e-02 1 1  ON 32
eH1_3                -4.454466e-02 1 1  ON 33
eH1_4                 9.787254e-04 1 1  ON 34
eH1_5                 1.147361e-02 1 1  ON 35
eH1_6                 4.996011e-02 1 1  ON 36
eH1_7                 4.766101e-02 1 1  ON 37
eH1_8                 2.187690e-01 1 1  ON 38
eH1_9                 8.402593e-02 1 1  ON 39
eH2_0                -2.032830e-01 1 1  ON 40
eH2_1                -1.237435e-01 1 1  ON 41
eH2_2                -8.183560e-02 1 1  ON 42
eH2_3                -4.443173e-02 1 1  ON 43
eH2_4                 1.055219e-03 1 1  ON 44
eH2_5                 1.159306e-02 1 1  ON 45
eH2_6                 5.358933e-02 1 1  ON 46
eH2_7                 6.391444e-02 1 1  ON 47
eH2_8                 2.111442e-01 1 1  ON 48
eH2_9                 8.150616e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2699
    reference variance = 0.267522
====================================================
  Execution time = 3.1970e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2534e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325410290556
                                         uncertainty =       0.003739919761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325410290556
                                         uncertainty =       0.003739919761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403325354
  error estimate for blocks of size 2^( 2) =       0.000412817519
  error estimate for blocks of size 2^( 3) =       0.000421096287
  error estimate for blocks of size 2^( 4) =       0.000427412342
  error estimate for blocks of size 2^( 5) =       0.000430111656
  error estimate for blocks of size 2^( 6) =       0.000431938372
  error estimate for blocks of size 2^( 7) =       0.000432997492

      target function =                  N/A
              le_mean =     -17.217527842255
             les_mean =     296.768607519289
             stat err =       0.000430614966
             autocorr =       1.139901145468
              std dev =       0.570388186368
             le_variance =       0.325342683148


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721752784225e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217527842255       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217527850807       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217527866649       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217527854229       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217527868883       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217527853127       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217527855297       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+01 is 1.075366e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217527842255       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217527844414       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217527848508       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217527845460       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217527849348       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217527845339       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217527845777       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+01 is 2.716381e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217527842255       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217527842796       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217527843828       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217527843070       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217527844057       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217527843050       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217527843153       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 6.842087e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.447429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0927e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.073454e-01 1 1  ON 0
 uu_1                 4.379993e-02 1 1  ON 1
 uu_2                -5.301282e-02 1 1  ON 2
 uu_3                -1.106254e-01 1 1  ON 3
 uu_4                -1.474596e-01 1 1  ON 4
 uu_5                -1.595013e-01 1 1  ON 5
 uu_6                -1.461193e-01 1 1  ON 6
 uu_7                -9.606813e-02 1 1  ON 7
 uu_8                -1.475764e-03 1 1  ON 8
 uu_9                 2.066377e-01 1 1  ON 9
 ud_0                 3.604253e-01 1 1  ON 10
 ud_1                 1.008197e-01 1 1  ON 11
 ud_2                -1.076651e-02 1 1  ON 12
 ud_3                -7.376529e-02 1 1  ON 13
 ud_4                -1.238869e-01 1 1  ON 14
 ud_5                -1.594018e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.426060e-01 1 1  ON 17
 ud_8                -7.199379e-02 1 1  ON 18
 ud_9                 7.863124e-02 1 1  ON 19
 eO_0                -8.963414e-01 1 1  ON 20
 eO_1                -5.701807e-01 1 1  ON 21
 eO_2                -1.499740e-01 1 1  ON 22
 eO_3                 1.246347e-01 1 1  ON 23
 eO_4                 2.499921e-01 1 1  ON 24
 eO_5                 3.252721e-01 1 1  ON 25
 eO_6                 3.531466e-01 1 1  ON 26
 eO_7                 4.011418e-01 1 1  ON 27
 eO_8                 1.014294e-01 1 1  ON 28
 eO_9                 3.821691e-02 1 1  ON 29
eH1_0                -2.030683e-01 1 1  ON 30
eH1_1                -1.239521e-01 1 1  ON 31
eH1_2                -8.191959e-02 1 1  ON 32
eH1_3                -4.454411e-02 1 1  ON 33
eH1_4                 9.795563e-04 1 1  ON 34
eH1_5                 1.147232e-02 1 1  ON 35
eH1_6                 4.996054e-02 1 1  ON 36
eH1_7                 4.766163e-02 1 1  ON 37
eH1_8                 2.187689e-01 1 1  ON 38
eH1_9                 8.402608e-02 1 1  ON 39
eH2_0                -2.032839e-01 1 1  ON 40
eH2_1                -1.237431e-01 1 1  ON 41
eH2_2                -8.183649e-02 1 1  ON 42
eH2_3                -4.443166e-02 1 1  ON 43
eH2_4                 1.057927e-03 1 1  ON 44
eH2_5                 1.159160e-02 1 1  ON 45
eH2_6                 5.358879e-02 1 1  ON 46
eH2_7                 6.391455e-02 1 1  ON 47
eH2_8                 2.111444e-01 1 1  ON 48
eH2_9                 8.150644e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2209
    reference variance = 0.199722
====================================================
  Execution time = 3.1460e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 4.9263e-01
  Total weights = 2.0000e+06
  Execution time = 2.9882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492955222313
                                         uncertainty =       0.168675357488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492955222313
                                         uncertainty =       0.168675357488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496291815
  error estimate for blocks of size 2^( 2) =       0.000504121262
  error estimate for blocks of size 2^( 3) =       0.000510751209
  error estimate for blocks of size 2^( 4) =       0.000515590726
  error estimate for blocks of size 2^( 5) =       0.000520953812
  error estimate for blocks of size 2^( 6) =       0.000521884677
  error estimate for blocks of size 2^( 7) =       0.000524370899

      target function =                  N/A
              le_mean =     -17.217144562627
             les_mean =     296.922677774558
             stat err =       0.000520700029
             autocorr =       1.100781135140
              std dev =       0.701862615106
             le_variance =       0.492611130483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493037131175
                                         uncertainty =       0.168763524018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493037131175
                                         uncertainty =       0.168763524018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496333004
  error estimate for blocks of size 2^( 2) =       0.000504161906
  error estimate for blocks of size 2^( 3) =       0.000510791390
  error estimate for blocks of size 2^( 4) =       0.000515630529
  error estimate for blocks of size 2^( 5) =       0.000520993635
  error estimate for blocks of size 2^( 6) =       0.000521924071
  error estimate for blocks of size 2^( 7) =       0.000524410414

      target function =                  N/A
              le_mean =     -17.217144718310
             les_mean =     296.922764905811
             stat err =       0.000520739662
             autocorr =       1.100765995334
              std dev =       0.701920865146
             le_variance =       0.492692900927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492996910116
                                         uncertainty =       0.168720254529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492996910116
                                         uncertainty =       0.168720254529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496312778
  error estimate for blocks of size 2^( 2) =       0.000504141949
  error estimate for blocks of size 2^( 3) =       0.000510771662
  error estimate for blocks of size 2^( 4) =       0.000515610988
  error estimate for blocks of size 2^( 5) =       0.000520974084
  error estimate for blocks of size 2^( 6) =       0.000521904730
  error estimate for blocks of size 2^( 7) =       0.000524391014

      target function =                  N/A
              le_mean =     -17.217144642155
             les_mean =     296.922722130398
             stat err =       0.000520720204
             autocorr =       1.100773443737
              std dev =       0.701892262263
             le_variance =       0.492652747825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492960456425
                                         uncertainty =       0.168680995556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492960456425
                                         uncertainty =       0.168680995556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496294447
  error estimate for blocks of size 2^( 2) =       0.000504123860
  error estimate for blocks of size 2^( 3) =       0.000510753777
  error estimate for blocks of size 2^( 4) =       0.000515593270
  error estimate for blocks of size 2^( 5) =       0.000520956357
  error estimate for blocks of size 2^( 6) =       0.000521887195
  error estimate for blocks of size 2^( 7) =       0.000524373425

      target function =                  N/A
              le_mean =     -17.217144572604
             les_mean =     296.922683343379
             stat err =       0.000520702562
             autocorr =       1.100780169820
              std dev =       0.701866337523
             le_variance =       0.492616355748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217144562627        initial
     1.4211e+01     1.4211e+02             1.0754e-05       -17.217144718310  <--
     5.6843e+01     5.6843e+02             2.7164e-06       -17.217144642155
     2.2737e+02     2.2737e+03             6.8421e-07       -17.217144572604

*****************************************************************************
Applying the update for shift_i =   1.4211e+01     and shift_s =   1.4211e+02
*****************************************************************************

  Execution time = 4.6525e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.073377e-01 1 1  ON 0
 uu_1                 4.380292e-02 1 1  ON 1
 uu_2                -5.300653e-02 1 1  ON 2
 uu_3                -1.106238e-01 1 1  ON 3
 uu_4                -1.474595e-01 1 1  ON 4
 uu_5                -1.595053e-01 1 1  ON 5
 uu_6                -1.461198e-01 1 1  ON 6
 uu_7                -9.606744e-02 1 1  ON 7
 uu_8                -1.476720e-03 1 1  ON 8
 uu_9                 2.066373e-01 1 1  ON 9
 ud_0                 3.604248e-01 1 1  ON 10
 ud_1                 1.008170e-01 1 1  ON 11
 ud_2                -1.076269e-02 1 1  ON 12
 ud_3                -7.377313e-02 1 1  ON 13
 ud_4                -1.238808e-01 1 1  ON 14
 ud_5                -1.594010e-01 1 1  ON 15
 ud_6                -1.699357e-01 1 1  ON 16
 ud_7                -1.426043e-01 1 1  ON 17
 ud_8                -7.199485e-02 1 1  ON 18
 ud_9                 7.862970e-02 1 1  ON 19
 eO_0                -8.963363e-01 1 1  ON 20
 eO_1                -5.701840e-01 1 1  ON 21
 eO_2                -1.499777e-01 1 1  ON 22
 eO_3                 1.246353e-01 1 1  ON 23
 eO_4                 2.499893e-01 1 1  ON 24
 eO_5                 3.252738e-01 1 1  ON 25
 eO_6                 3.531460e-01 1 1  ON 26
 eO_7                 4.011431e-01 1 1  ON 27
 eO_8                 1.014307e-01 1 1  ON 28
 eO_9                 3.821724e-02 1 1  ON 29
eH1_0                -2.030663e-01 1 1  ON 30
eH1_1                -1.239564e-01 1 1  ON 31
eH1_2                -8.192127e-02 1 1  ON 32
eH1_3                -4.454251e-02 1 1  ON 33
eH1_4                 9.820410e-04 1 1  ON 34
eH1_5                 1.146849e-02 1 1  ON 35
eH1_6                 4.996182e-02 1 1  ON 36
eH1_7                 4.766345e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402650e-02 1 1  ON 39
eH2_0                -2.032865e-01 1 1  ON 40
eH2_1                -1.237419e-01 1 1  ON 41
eH2_2                -8.183911e-02 1 1  ON 42
eH2_3                -4.443143e-02 1 1  ON 43
eH2_4                 1.065973e-03 1 1  ON 44
eH2_5                 1.158726e-02 1 1  ON 45
eH2_6                 5.358717e-02 1 1  ON 46
eH2_7                 6.391487e-02 1 1  ON 47
eH2_8                 2.111449e-01 1 1  ON 48
eH2_9                 8.150728e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7718e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2201
    reference variance = 0.381667
====================================================
  Execution time = 3.2590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2447e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324549199763
                                         uncertainty =       0.004309958789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324549199763
                                         uncertainty =       0.004309958789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402786280
  error estimate for blocks of size 2^( 2) =       0.000412357582
  error estimate for blocks of size 2^( 3) =       0.000420739351
  error estimate for blocks of size 2^( 4) =       0.000427381914
  error estimate for blocks of size 2^( 5) =       0.000431811873
  error estimate for blocks of size 2^( 6) =       0.000432673771
  error estimate for blocks of size 2^( 7) =       0.000433755156

      target function =                  N/A
              le_mean =     -17.216731381498
             les_mean =     296.740312874723
             stat err =       0.000431405679
             autocorr =       1.147155727177
              std dev =       0.569625819550
             le_variance =       0.324473574298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673138150e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731381498       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731386030       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731509473       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216731579407       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216731604929       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216731651638       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.5527e+00 is 2.954633e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731381498       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731382668       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731415435       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216731434142       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216731440898       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216731453196       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+01 is 7.957906e-06

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731381498       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731381793       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731390114       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216731394874       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216731396592       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216731399705       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+01 is 2.029542e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.449275 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1538e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.073413e-01 1 1  ON 0
 uu_1                 4.381088e-02 1 1  ON 1
 uu_2                -5.300915e-02 1 1  ON 2
 uu_3                -1.106221e-01 1 1  ON 3
 uu_4                -1.474640e-01 1 1  ON 4
 uu_5                -1.595122e-01 1 1  ON 5
 uu_6                -1.461230e-01 1 1  ON 6
 uu_7                -9.606341e-02 1 1  ON 7
 uu_8                -1.477205e-03 1 1  ON 8
 uu_9                 2.066357e-01 1 1  ON 9
 ud_0                 3.604279e-01 1 1  ON 10
 ud_1                 1.008147e-01 1 1  ON 11
 ud_2                -1.076314e-02 1 1  ON 12
 ud_3                -7.377407e-02 1 1  ON 13
 ud_4                -1.238837e-01 1 1  ON 14
 ud_5                -1.593960e-01 1 1  ON 15
 ud_6                -1.699338e-01 1 1  ON 16
 ud_7                -1.426038e-01 1 1  ON 17
 ud_8                -7.199778e-02 1 1  ON 18
 ud_9                 7.862755e-02 1 1  ON 19
 eO_0                -8.963350e-01 1 1  ON 20
 eO_1                -5.701877e-01 1 1  ON 21
 eO_2                -1.499731e-01 1 1  ON 22
 eO_3                 1.246326e-01 1 1  ON 23
 eO_4                 2.499884e-01 1 1  ON 24
 eO_5                 3.252729e-01 1 1  ON 25
 eO_6                 3.531451e-01 1 1  ON 26
 eO_7                 4.011451e-01 1 1  ON 27
 eO_8                 1.014317e-01 1 1  ON 28
 eO_9                 3.821744e-02 1 1  ON 29
eH1_0                -2.030649e-01 1 1  ON 30
eH1_1                -1.239627e-01 1 1  ON 31
eH1_2                -8.192490e-02 1 1  ON 32
eH1_3                -4.454105e-02 1 1  ON 33
eH1_4                 9.893217e-04 1 1  ON 34
eH1_5                 1.146656e-02 1 1  ON 35
eH1_6                 4.996159e-02 1 1  ON 36
eH1_7                 4.766528e-02 1 1  ON 37
eH1_8                 2.187684e-01 1 1  ON 38
eH1_9                 8.402678e-02 1 1  ON 39
eH2_0                -2.032879e-01 1 1  ON 40
eH2_1                -1.237487e-01 1 1  ON 41
eH2_2                -8.184407e-02 1 1  ON 42
eH2_3                -4.442405e-02 1 1  ON 43
eH2_4                 1.064778e-03 1 1  ON 44
eH2_5                 1.159453e-02 1 1  ON 45
eH2_6                 5.358700e-02 1 1  ON 46
eH2_7                 6.391376e-02 1 1  ON 47
eH2_8                 2.111448e-01 1 1  ON 48
eH2_9                 8.150783e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2681
    reference variance = 0.242325
====================================================
  Execution time = 3.1680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1495e-01
  Total weights = 2.0000e+06
  Execution time = 2.9883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314855049986
                                         uncertainty =       0.002104068458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314855049986
                                         uncertainty =       0.002104068458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396827353
  error estimate for blocks of size 2^( 2) =       0.000406044996
  error estimate for blocks of size 2^( 3) =       0.000414657904
  error estimate for blocks of size 2^( 4) =       0.000420220558
  error estimate for blocks of size 2^( 5) =       0.000425583881
  error estimate for blocks of size 2^( 6) =       0.000427199935
  error estimate for blocks of size 2^( 7) =       0.000427693139

      target function =                  N/A
              le_mean =     -17.216432512691
             les_mean =     296.720492202634
             stat err =       0.000425174378
             autocorr =       1.147971142026
              std dev =       0.561198624421
             le_variance =       0.314943896052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314878984735
                                         uncertainty =       0.002104248044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314878984735
                                         uncertainty =       0.002104248044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396842435
  error estimate for blocks of size 2^( 2) =       0.000406059168
  error estimate for blocks of size 2^( 3) =       0.000414670841
  error estimate for blocks of size 2^( 4) =       0.000420233004
  error estimate for blocks of size 2^( 5) =       0.000425596325
  error estimate for blocks of size 2^( 6) =       0.000427212089
  error estimate for blocks of size 2^( 7) =       0.000427705742

      target function =                  N/A
              le_mean =     -17.216432439081
             les_mean =     296.720513608623
             stat err =       0.000425186790
             autocorr =       1.147950903537
              std dev =       0.561219953897
             le_variance =       0.314967836652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314868071722
                                         uncertainty =       0.002104166718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314868071722
                                         uncertainty =       0.002104166718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396835558
  error estimate for blocks of size 2^( 2) =       0.000406052712
  error estimate for blocks of size 2^( 3) =       0.000414664961
  error estimate for blocks of size 2^( 4) =       0.000420227354
  error estimate for blocks of size 2^( 5) =       0.000425590678
  error estimate for blocks of size 2^( 6) =       0.000427206583
  error estimate for blocks of size 2^( 7) =       0.000427700047

      target function =                  N/A
              le_mean =     -17.216432477300
             les_mean =     296.720504008613
             stat err =       0.000425181166
             autocorr =       1.147960319933
              std dev =       0.561210228568
             le_variance =       0.314956920649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314856713701
                                         uncertainty =       0.002104081038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314856713701
                                         uncertainty =       0.002104081038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396828401
  error estimate for blocks of size 2^( 2) =       0.000406045982
  error estimate for blocks of size 2^( 3) =       0.000414658806
  error estimate for blocks of size 2^( 4) =       0.000420221427
  error estimate for blocks of size 2^( 5) =       0.000425584750
  error estimate for blocks of size 2^( 6) =       0.000427200785
  error estimate for blocks of size 2^( 7) =       0.000427694024

      target function =                  N/A
              le_mean =     -17.216432508197
             les_mean =     296.720493711954
             stat err =       0.000425175247
             autocorr =       1.147969764616
              std dev =       0.561200107022
             le_variance =       0.314945560121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216432512691        initial  <--
     3.5527e+00     3.5527e+01             2.9546e-05       -17.216432439081
     1.4211e+01     1.4211e+02             7.9579e-06       -17.216432477300
     5.6843e+01     5.6843e+02             2.0295e-06       -17.216432508197

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.7483
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.073377e-01 1 1  ON 0
 uu_1                 4.380292e-02 1 1  ON 1
 uu_2                -5.300653e-02 1 1  ON 2
 uu_3                -1.106238e-01 1 1  ON 3
 uu_4                -1.474595e-01 1 1  ON 4
 uu_5                -1.595053e-01 1 1  ON 5
 uu_6                -1.461198e-01 1 1  ON 6
 uu_7                -9.606744e-02 1 1  ON 7
 uu_8                -1.476720e-03 1 1  ON 8
 uu_9                 2.066373e-01 1 1  ON 9
 ud_0                 3.604248e-01 1 1  ON 10
 ud_1                 1.008170e-01 1 1  ON 11
 ud_2                -1.076269e-02 1 1  ON 12
 ud_3                -7.377313e-02 1 1  ON 13
 ud_4                -1.238808e-01 1 1  ON 14
 ud_5                -1.594010e-01 1 1  ON 15
 ud_6                -1.699357e-01 1 1  ON 16
 ud_7                -1.426043e-01 1 1  ON 17
 ud_8                -7.199485e-02 1 1  ON 18
 ud_9                 7.862970e-02 1 1  ON 19
 eO_0                -8.963363e-01 1 1  ON 20
 eO_1                -5.701840e-01 1 1  ON 21
 eO_2                -1.499777e-01 1 1  ON 22
 eO_3                 1.246353e-01 1 1  ON 23
 eO_4                 2.499893e-01 1 1  ON 24
 eO_5                 3.252738e-01 1 1  ON 25
 eO_6                 3.531460e-01 1 1  ON 26
 eO_7                 4.011431e-01 1 1  ON 27
 eO_8                 1.014307e-01 1 1  ON 28
 eO_9                 3.821724e-02 1 1  ON 29
eH1_0                -2.030663e-01 1 1  ON 30
eH1_1                -1.239564e-01 1 1  ON 31
eH1_2                -8.192127e-02 1 1  ON 32
eH1_3                -4.454251e-02 1 1  ON 33
eH1_4                 9.820410e-04 1 1  ON 34
eH1_5                 1.146849e-02 1 1  ON 35
eH1_6                 4.996182e-02 1 1  ON 36
eH1_7                 4.766345e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402650e-02 1 1  ON 39
eH2_0                -2.032865e-01 1 1  ON 40
eH2_1                -1.237419e-01 1 1  ON 41
eH2_2                -8.183911e-02 1 1  ON 42
eH2_3                -4.443143e-02 1 1  ON 43
eH2_4                 1.065973e-03 1 1  ON 44
eH2_5                 1.158726e-02 1 1  ON 45
eH2_6                 5.358717e-02 1 1  ON 46
eH2_7                 6.391487e-02 1 1  ON 47
eH2_8                 2.111449e-01 1 1  ON 48
eH2_9                 8.150728e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8697e+01 secs
  Total Execution time = 3.6117e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
