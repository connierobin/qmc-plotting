--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0251.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 79450 MB
Rank =    1  Free Memory = 79441 MB
Rank =    2  Free Memory = 79441 MB
Rank =    3  Free Memory = 79441 MB
Rank =    4  Free Memory = 79441 MB
Rank =    5  Free Memory = 79441 MB
Rank =    6  Free Memory = 79441 MB
Rank =    7  Free Memory = 79441 MB
Rank =    8  Free Memory = 79441 MB
Rank =    9  Free Memory = 79441 MB
Rank =   10  Free Memory = 79441 MB
Rank =   11  Free Memory = 79441 MB
Rank =   12  Free Memory = 79441 MB
Rank =   13  Free Memory = 79441 MB
Rank =   14  Free Memory = 79441 MB
Rank =   15  Free Memory = 79441 MB
Rank =   16  Free Memory = 79441 MB
Rank =   17  Free Memory = 79441 MB
Rank =   18  Free Memory = 79441 MB
Rank =   19  Free Memory = 79441 MB
Rank =   20  Free Memory = 79441 MB
Rank =   21  Free Memory = 79441 MB
Rank =   22  Free Memory = 79441 MB
Rank =   23  Free Memory = 79441 MB
Rank =   24  Free Memory = 79441 MB
Rank =   25  Free Memory = 79441 MB
Rank =   26  Free Memory = 79441 MB
Rank =   27  Free Memory = 79441 MB
Rank =   28  Free Memory = 79441 MB
Rank =   29  Free Memory = 79441 MB
Rank =   30  Free Memory = 79441 MB
Rank =   31  Free Memory = 79441 MB
Rank =   32  Free Memory = 79441 MB
Rank =   33  Free Memory = 79441 MB
Rank =   34  Free Memory = 79441 MB
Rank =   35  Free Memory = 79441 MB
Rank =   36  Free Memory = 79441 MB
Rank =   37  Free Memory = 79441 MB
Rank =   38  Free Memory = 79441 MB
Rank =   39  Free Memory = 79441 MB
Rank =   40  Free Memory = 84731 MB
Rank =   41  Free Memory = 84731 MB
Rank =   42  Free Memory = 84731 MB
Rank =   43  Free Memory = 84731 MB
Rank =   44  Free Memory = 84731 MB
Rank =   45  Free Memory = 84731 MB
Rank =   46  Free Memory = 84731 MB
Rank =   47  Free Memory = 84731 MB
Rank =   48  Free Memory = 84731 MB
Rank =   49  Free Memory = 84731 MB
Rank =   50  Free Memory = 84731 MB
Rank =   51  Free Memory = 84731 MB
Rank =   52  Free Memory = 84731 MB
Rank =   53  Free Memory = 84731 MB
Rank =   54  Free Memory = 84731 MB
Rank =   55  Free Memory = 84731 MB
Rank =   56  Free Memory = 84731 MB
Rank =   57  Free Memory = 84731 MB
Rank =   58  Free Memory = 84731 MB
Rank =   59  Free Memory = 84731 MB
Rank =   60  Free Memory = 84731 MB
Rank =   61  Free Memory = 84731 MB
Rank =   62  Free Memory = 84731 MB
Rank =   63  Free Memory = 84731 MB
Rank =   64  Free Memory = 84731 MB
Rank =   65  Free Memory = 84731 MB
Rank =   66  Free Memory = 84731 MB
Rank =   67  Free Memory = 84731 MB
Rank =   68  Free Memory = 84731 MB
Rank =   69  Free Memory = 84731 MB
Rank =   70  Free Memory = 84731 MB
Rank =   71  Free Memory = 84731 MB
Rank =   72  Free Memory = 84731 MB
Rank =   73  Free Memory = 84731 MB
Rank =   74  Free Memory = 84731 MB
Rank =   75  Free Memory = 84731 MB
Rank =   76  Free Memory = 84731 MB
Rank =   77  Free Memory = 84731 MB
Rank =   78  Free Memory = 84731 MB
Rank =   79  Free Memory = 84731 MB
Rank =   80  Free Memory = 78769 MB
Rank =   81  Free Memory = 78769 MB
Rank =   82  Free Memory = 78769 MB
Rank =   83  Free Memory = 78769 MB
Rank =   84  Free Memory = 78769 MB
Rank =   85  Free Memory = 78769 MB
Rank =   86  Free Memory = 78768 MB
Rank =   87  Free Memory = 78767 MB
Rank =   88  Free Memory = 78767 MB
Rank =   89  Free Memory = 78767 MB
Rank =   90  Free Memory = 78767 MB
Rank =   91  Free Memory = 78767 MB
Rank =   92  Free Memory = 78767 MB
Rank =   93  Free Memory = 78767 MB
Rank =   94  Free Memory = 78767 MB
Rank =   95  Free Memory = 78767 MB
Rank =   96  Free Memory = 78767 MB
Rank =   97  Free Memory = 78767 MB
Rank =   98  Free Memory = 78767 MB
Rank =   99  Free Memory = 78767 MB
Rank =  100  Free Memory = 78767 MB
Rank =  101  Free Memory = 78767 MB
Rank =  102  Free Memory = 78767 MB
Rank =  103  Free Memory = 78767 MB
Rank =  104  Free Memory = 78767 MB
Rank =  105  Free Memory = 78767 MB
Rank =  106  Free Memory = 78767 MB
Rank =  107  Free Memory = 78767 MB
Rank =  108  Free Memory = 78767 MB
Rank =  109  Free Memory = 78767 MB
Rank =  110  Free Memory = 78767 MB
Rank =  111  Free Memory = 78767 MB
Rank =  112  Free Memory = 78767 MB
Rank =  113  Free Memory = 78767 MB
Rank =  114  Free Memory = 78767 MB
Rank =  115  Free Memory = 78767 MB
Rank =  116  Free Memory = 78767 MB
Rank =  117  Free Memory = 78767 MB
Rank =  118  Free Memory = 78767 MB
Rank =  119  Free Memory = 78767 MB
Rank =  120  Free Memory = 80380 MB
Rank =  121  Free Memory = 80380 MB
Rank =  122  Free Memory = 80380 MB
  Input file(s): opt_h2o_gs_gvptt_run002d.xml 
Rank =  123  Free Memory = 80380 MB
Rank =  124  Free Memory = 80380 MB
Rank =  127  Free Memory = 80380 MB
Rank =  125  Free Memory = 80380 MB
Rank =  126  Free Memory = 80380 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run002d.xml

  Project = H2O
  date    = 2023-03-13 14:01:00 PDT
  host    = n0249.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 780

  Range of prime numbers to use as seeds over processors and threads = 5981-7103


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.900908e-01    1         1  ON     0
     uu_1                 2.766899e-02    1         1  ON     1
     uu_2                -6.712008e-02    1         1  ON     2
     uu_3                -1.233850e-01    1         1  ON     3
     uu_4                -1.599952e-01    1         1  ON     4
     uu_5                -1.724922e-01    1         1  ON     5
     uu_6                -1.594272e-01    1         1  ON     6
     uu_7                -1.136794e-01    1         1  ON     7
     uu_8                -3.711584e-02    1         1  ON     8
     uu_9                 1.619959e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.445745e-01    1         1  ON     0
     ud_1                 8.858809e-02    1         1  ON     1
     ud_2                -1.688695e-02    1         1  ON     2
     ud_3                -7.711815e-02    1         1  ON     3
     ud_4                -1.286176e-01    1         1  ON     4
     ud_5                -1.681282e-01    1         1  ON     5
     ud_6                -1.818350e-01    1         1  ON     6
     ud_7                -1.593236e-01    1         1  ON     7
     ud_8                -9.915845e-02    1         1  ON     8
     ud_9                -8.563873e-03    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.170178e-01    1         1  ON     0
     eO_1                -5.998458e-01    1         1  ON     1
     eO_2                -1.934355e-01    1         1  ON     2
     eO_3                 7.456347e-02    1         1  ON     3
     eO_4                 2.040319e-01    1         1  ON     4
     eO_5                 2.942542e-01    1         1  ON     5
     eO_6                 3.344180e-01    1         1  ON     6
     eO_7                 5.024660e-01    1         1  ON     7
     eO_8                 1.937198e-01    1         1  ON     8
     eO_9                 6.108356e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.104790e-01    1         1  ON     0
     eH1_1                -1.324596e-01    1         1  ON     1
     eH1_2                -9.144633e-02    1         1  ON     2
     eH1_3                -5.413807e-02    1         1  ON     3
     eH1_4                -7.814867e-03    1         1  ON     4
     eH1_5                 3.426036e-03    1         1  ON     5
     eH1_6                 4.134862e-02    1         1  ON     6
     eH1_7                 6.448167e-02    1         1  ON     7
     eH1_8                 1.799388e-01    1         1  ON     8
     eH1_9                 1.209295e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.062053e-01    1         1  ON     0
     eH2_1                -1.275402e-01    1         1  ON     1
     eH2_2                -8.640355e-02    1         1  ON     2
     eH2_3                -4.935045e-02    1         1  ON     3
     eH2_4                -3.342877e-03    1         1  ON     4
     eH2_5                 8.775442e-03    1         1  ON     5
     eH2_6                 4.709264e-02    1         1  ON     6
     eH2_7                 4.599308e-02    1         1  ON     7
     eH2_8                 1.982614e-01    1         1  ON     8
     eH2_9                 1.200575e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.703520e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.4718e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0249.savio3:258153] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0249.savio3:258153] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2041
    reference variance = 0.276142
====================================================
  Execution time = 2.0692e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315690864073
                                         uncertainty =       0.003770824045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315690864073
                                         uncertainty =       0.003770824045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397222874
  error estimate for blocks of size 2^( 2) =       0.000406900758
  error estimate for blocks of size 2^( 3) =       0.000415386854
  error estimate for blocks of size 2^( 4) =       0.000421552584
  error estimate for blocks of size 2^( 5) =       0.000425937437
  error estimate for blocks of size 2^( 6) =       0.000430219100
  error estimate for blocks of size 2^( 7) =       0.000431698940

      target function =                  N/A
              le_mean =     -17.217464925312
             les_mean =     296.756670319079
             stat err =       0.000427352015
             autocorr =       1.157452068347
              std dev =       0.561757975030
             le_variance =       0.315572022510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721746492531e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217464925312       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217485698278       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217488432180       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217493240867       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217501442481       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217504138637       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217505619347       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217506081280       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217504843814       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217505123760       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217505568071       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 3.302978e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217464925312       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217473958282       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217475066085       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217476236471       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217479340859       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217480705583       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217481045380       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217481186555       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217480936830       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.120048e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217464925312       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217467695624       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217468042492       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217468310802       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217469121497       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217469478272       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217469555615       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217469620119       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217469583161       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 3.177994e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6497e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.901317e-01                 1 1 ON  0
uu_1  2.776402e-02                 1 1 ON  1
uu_2  -6.729410e-02                1 1 ON  2
uu_3  -1.234858e-01                1 1 ON  3
uu_4  -1.599206e-01                1 1 ON  4
uu_5  -1.724022e-01                1 1 ON  5
uu_6  -1.594824e-01                1 1 ON  6
uu_7  -1.136752e-01                1 1 ON  7
uu_8  -3.709485e-02                1 1 ON  8
uu_9  1.619831e-01                 1 1 ON  9
ud_0  3.453845e-01                 1 1 ON  10
ud_1  8.911460e-02                 1 1 ON  11
ud_2  -1.741951e-02                1 1 ON  12
ud_3  -7.777959e-02                1 1 ON  13
ud_4  -1.288197e-01                1 1 ON  14
ud_5  -1.679834e-01                1 1 ON  15
ud_6  -1.818569e-01                1 1 ON  16
ud_7  -1.593827e-01                1 1 ON  17
ud_8  -9.916599e-02                1 1 ON  18
ud_9  -8.562423e-03                1 1 ON  19
eO_0  -9.181378e-01                1 1 ON  20
eO_1  -6.001904e-01                1 1 ON  21
eO_2  -1.923686e-01                1 1 ON  22
eO_3  7.518725e-02                 1 1 ON  23
eO_4  2.039545e-01                 1 1 ON  24
eO_5  2.941245e-01                 1 1 ON  25
eO_6  3.343779e-01                 1 1 ON  26
eO_7  5.024632e-01                 1 1 ON  27
eO_8  1.937417e-01                 1 1 ON  28
eO_9  6.108673e-02                 1 1 ON  29
eH1_0 -2.106066e-01                1 1 ON  30
eH1_1 -1.324093e-01                1 1 ON  31
eH1_2 -9.148767e-02                1 1 ON  32
eH1_3 -5.407131e-02                1 1 ON  33
eH1_4 -7.723729e-03                1 1 ON  34
eH1_5 3.455028e-03                 1 1 ON  35
eH1_6 4.130031e-02                 1 1 ON  36
eH1_7 6.444875e-02                 1 1 ON  37
eH1_8 1.799395e-01                 1 1 ON  38
eH1_9 1.209381e-01                 1 1 ON  39
eH2_0 -2.062899e-01                1 1 ON  40
eH2_1 -1.274672e-01                1 1 ON  41
eH2_2 -8.655310e-02                1 1 ON  42
eH2_3 -4.920203e-02                1 1 ON  43
eH2_4 -3.205755e-03                1 1 ON  44
eH2_5 8.742547e-03                 1 1 ON  45
eH2_6 4.701286e-02                 1 1 ON  46
eH2_7 4.597596e-02                 1 1 ON  47
eH2_8 1.982606e-01                 1 1 ON  48
eH2_9 1.200611e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2664
    reference variance = 0.19417
====================================================
  Execution time = 2.0064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2337e-01
  Total weights = 2.0000e+06
  Execution time = 1.9106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322656713212
                                         uncertainty =       0.007672831489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322656713212
                                         uncertainty =       0.007672831489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401591467
  error estimate for blocks of size 2^( 2) =       0.000411117184
  error estimate for blocks of size 2^( 3) =       0.000419992809
  error estimate for blocks of size 2^( 4) =       0.000426162187
  error estimate for blocks of size 2^( 5) =       0.000430059638
  error estimate for blocks of size 2^( 6) =       0.000431608184
  error estimate for blocks of size 2^( 7) =       0.000431393025

      target function =                  N/A
              le_mean =     -17.217431994566
             les_mean =     296.762515739300
             stat err =       0.000429805758
             autocorr =       1.145448337146
              std dev =       0.567936099466
             le_variance =       0.322551413076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324890822055
                                         uncertainty =       0.007705764806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324890822055
                                         uncertainty =       0.007705764806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402979771
  error estimate for blocks of size 2^( 2) =       0.000412400457
  error estimate for blocks of size 2^( 3) =       0.000421168372
  error estimate for blocks of size 2^( 4) =       0.000427259608
  error estimate for blocks of size 2^( 5) =       0.000431111166
  error estimate for blocks of size 2^( 6) =       0.000432649719
  error estimate for blocks of size 2^( 7) =       0.000432367077

      target function =                  N/A
              le_mean =     -17.217436872560
             les_mean =     296.764917690036
             stat err =       0.000430846893
             autocorr =       1.143087402909
              std dev =       0.569899457663
             le_variance =       0.324785391844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341115074
                                         uncertainty =       0.007695106189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341115074
                                         uncertainty =       0.007695106189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402638644
  error estimate for blocks of size 2^( 2) =       0.000412079262
  error estimate for blocks of size 2^( 3) =       0.000420869706
  error estimate for blocks of size 2^( 4) =       0.000426976488
  error estimate for blocks of size 2^( 5) =       0.000430837272
  error estimate for blocks of size 2^( 6) =       0.000432372911
  error estimate for blocks of size 2^( 7) =       0.000432108838

      target function =                  N/A
              le_mean =     -17.217434602051
             les_mean =     296.764289868594
             stat err =       0.000430573877
             autocorr =       1.143574457691
              std dev =       0.569417030672
             le_variance =       0.324235754819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322886318095
                                         uncertainty =       0.007675826010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322886318095
                                         uncertainty =       0.007675826010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401734374
  error estimate for blocks of size 2^( 2) =       0.000411246612
  error estimate for blocks of size 2^( 3) =       0.000420109117
  error estimate for blocks of size 2^( 4) =       0.000426268854
  error estimate for blocks of size 2^( 5) =       0.000430160740
  error estimate for blocks of size 2^( 6) =       0.000431706801
  error estimate for blocks of size 2^( 7) =       0.000431485031

      target function =                  N/A
              le_mean =     -17.217430671899
             les_mean =     296.762699794377
             stat err =       0.000429905357
             autocorr =       1.145164105281
              std dev =       0.568138199855
             le_variance =       0.322781014134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217431994566        initial
     2.5000e-01     2.5000e+00             3.3030e-03       -17.217436872560  <--
     1.0000e+00     1.0000e+01             1.1200e-03       -17.217434602051
     4.0000e+00     4.0000e+01             3.1780e-04       -17.217430671899

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9675e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.903678e-01 1 1  ON 0
 uu_1                 2.788173e-02 1 1  ON 1
 uu_2                -6.751922e-02 1 1  ON 2
 uu_3                -1.237530e-01 1 1  ON 3
 uu_4                -1.599569e-01 1 1  ON 4
 uu_5                -1.722648e-01 1 1  ON 5
 uu_6                -1.595705e-01 1 1  ON 6
 uu_7                -1.136340e-01 1 1  ON 7
 uu_8                -3.702619e-02 1 1  ON 8
 uu_9                 1.619473e-01 1 1  ON 9
 ud_0                 3.467544e-01 1 1  ON 10
 ud_1                 8.975939e-02 1 1  ON 11
 ud_2                -1.803106e-02 1 1  ON 12
 ud_3                -7.891405e-02 1 1  ON 13
 ud_4                -1.294138e-01 1 1  ON 14
 ud_5                -1.677380e-01 1 1  ON 15
 ud_6                -1.817169e-01 1 1  ON 16
 ud_7                -1.594544e-01 1 1  ON 17
 ud_8                -9.916835e-02 1 1  ON 18
 ud_9                -8.554567e-03 1 1  ON 19
 eO_0                -9.203208e-01 1 1  ON 20
 eO_1                -6.009215e-01 1 1  ON 21
 eO_2                -1.907684e-01 1 1  ON 22
 eO_3                 7.672495e-02 1 1  ON 23
 eO_4                 2.040193e-01 1 1  ON 24
 eO_5                 2.938588e-01 1 1  ON 25
 eO_6                 3.342861e-01 1 1  ON 26
 eO_7                 5.024601e-01 1 1  ON 27
 eO_8                 1.938075e-01 1 1  ON 28
 eO_9                 6.109631e-02 1 1  ON 29
eH1_0                -2.108926e-01 1 1  ON 30
eH1_1                -1.323830e-01 1 1  ON 31
eH1_2                -9.149297e-02 1 1  ON 32
eH1_3                -5.399342e-02 1 1  ON 33
eH1_4                -7.594256e-03 1 1  ON 34
eH1_5                 3.621473e-03 1 1  ON 35
eH1_6                 4.122903e-02 1 1  ON 36
eH1_7                 6.436888e-02 1 1  ON 37
eH1_8                 1.799446e-01 1 1  ON 38
eH1_9                 1.209642e-01 1 1  ON 39
eH2_0                -2.064918e-01 1 1  ON 40
eH2_1                -1.274600e-01 1 1  ON 41
eH2_2                -8.669411e-02 1 1  ON 42
eH2_3                -4.897520e-02 1 1  ON 43
eH2_4                -2.952585e-03 1 1  ON 44
eH2_5                 8.773909e-03 1 1  ON 45
eH2_6                 4.685212e-02 1 1  ON 46
eH2_7                 4.594130e-02 1 1  ON 47
eH2_8                 1.982615e-01 1 1  ON 48
eH2_9                 1.200726e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6181e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2388
    reference variance = 0.294948
====================================================
  Execution time = 2.2654e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2240e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322420717121
                                         uncertainty =       0.007194760971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322420717121
                                         uncertainty =       0.007194760971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401497484
  error estimate for blocks of size 2^( 2) =       0.000410884311
  error estimate for blocks of size 2^( 3) =       0.000419434116
  error estimate for blocks of size 2^( 4) =       0.000426138328
  error estimate for blocks of size 2^( 5) =       0.000431030358
  error estimate for blocks of size 2^( 6) =       0.000433549296
  error estimate for blocks of size 2^( 7) =       0.000436882252

      target function =                  N/A
              le_mean =     -17.216719407859
             les_mean =     296.737827467385
             stat err =       0.000431900059
             autocorr =       1.157179868167
              std dev =       0.567803187414
             le_variance =       0.322400459637


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671940786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719407859       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216718788443       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216722459052       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216728996893       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216734737013       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216735642102       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216739007280       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216738211257       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216738503537       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216738701440       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216737868972       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216738086798       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216738092608       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 5.234285e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719407859       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216718987506       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721014449       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216724350555       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216728301432       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216728319946       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216729401404       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216728936251       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216729007476       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216729064205       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.213710e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719407859       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719223936       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216719977669       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216720988613       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722387932       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216722484663       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216722723042       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216722567125       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216722580063       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 7.109831e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127785 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8206e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.904634e-01 1 1  ON 0
 uu_1                 2.796195e-02 1 1  ON 1
 uu_2                -6.759226e-02 1 1  ON 2
 uu_3                -1.240672e-01 1 1  ON 3
 uu_4                -1.601128e-01 1 1  ON 4
 uu_5                -1.720185e-01 1 1  ON 5
 uu_6                -1.595697e-01 1 1  ON 6
 uu_7                -1.135949e-01 1 1  ON 7
 uu_8                -3.702217e-02 1 1  ON 8
 uu_9                 1.618981e-01 1 1  ON 9
 ud_0                 3.480421e-01 1 1  ON 10
 ud_1                 9.031969e-02 1 1  ON 11
 ud_2                -1.865492e-02 1 1  ON 12
 ud_3                -7.988919e-02 1 1  ON 13
 ud_4                -1.300286e-01 1 1  ON 14
 ud_5                -1.679267e-01 1 1  ON 15
 ud_6                -1.812192e-01 1 1  ON 16
 ud_7                -1.593846e-01 1 1  ON 17
 ud_8                -9.923508e-02 1 1  ON 18
 ud_9                -8.557527e-03 1 1  ON 19
 eO_0                -9.225345e-01 1 1  ON 20
 eO_1                -6.018469e-01 1 1  ON 21
 eO_2                -1.894912e-01 1 1  ON 22
 eO_3                 7.841381e-02 1 1  ON 23
 eO_4                 2.043950e-01 1 1  ON 24
 eO_5                 2.936408e-01 1 1  ON 25
 eO_6                 3.342584e-01 1 1  ON 26
 eO_7                 5.024136e-01 1 1  ON 27
 eO_8                 1.938796e-01 1 1  ON 28
 eO_9                 6.110936e-02 1 1  ON 29
eH1_0                -2.113328e-01 1 1  ON 30
eH1_1                -1.326390e-01 1 1  ON 31
eH1_2                -9.142611e-02 1 1  ON 32
eH1_3                -5.395813e-02 1 1  ON 33
eH1_4                -7.614930e-03 1 1  ON 34
eH1_5                 4.168506e-03 1 1  ON 35
eH1_6                 4.133153e-02 1 1  ON 36
eH1_7                 6.430419e-02 1 1  ON 37
eH1_8                 1.799282e-01 1 1  ON 38
eH1_9                 1.209838e-01 1 1  ON 39
eH2_0                -2.066739e-01 1 1  ON 40
eH2_1                -1.278227e-01 1 1  ON 41
eH2_2                -8.657817e-02 1 1  ON 42
eH2_3                -4.911273e-02 1 1  ON 43
eH2_4                -2.661113e-03 1 1  ON 44
eH2_5                 8.949595e-03 1 1  ON 45
eH2_6                 4.681075e-02 1 1  ON 46
eH2_7                 4.607855e-02 1 1  ON 47
eH2_8                 1.982306e-01 1 1  ON 48
eH2_9                 1.200938e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2412
    reference variance = 0.16001
====================================================
  Execution time = 1.9784e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2102e-01
  Total weights = 2.0000e+06
  Execution time = 1.9076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319847611265
                                         uncertainty =       0.003736969309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319847611265
                                         uncertainty =       0.003736969309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399838512
  error estimate for blocks of size 2^( 2) =       0.000409270157
  error estimate for blocks of size 2^( 3) =       0.000417773567
  error estimate for blocks of size 2^( 4) =       0.000423772424
  error estimate for blocks of size 2^( 5) =       0.000427444886
  error estimate for blocks of size 2^( 6) =       0.000429045425
  error estimate for blocks of size 2^( 7) =       0.000428326253

      target function =                  N/A
              le_mean =     -17.216663145348
             les_mean =     296.733231371664
             stat err =       0.000427147247
             autocorr =       1.141263633394
              std dev =       0.565457046239
             le_variance =       0.319741671141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322203509158
                                         uncertainty =       0.003760400640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322203509158
                                         uncertainty =       0.003760400640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401308684
  error estimate for blocks of size 2^( 2) =       0.000410656205
  error estimate for blocks of size 2^( 3) =       0.000419079611
  error estimate for blocks of size 2^( 4) =       0.000425013631
  error estimate for blocks of size 2^( 5) =       0.000428656936
  error estimate for blocks of size 2^( 6) =       0.000430194171
  error estimate for blocks of size 2^( 7) =       0.000429411636

      target function =                  N/A
              le_mean =     -17.216660371067
             les_mean =     296.735491491194
             stat err =       0.000428319093
             autocorr =       1.139141710360
              std dev =       0.567536183481
             le_variance =       0.322097319560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322467475506
                                         uncertainty =       0.003761399136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322467475506
                                         uncertainty =       0.003761399136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401473103
  error estimate for blocks of size 2^( 2) =       0.000410809049
  error estimate for blocks of size 2^( 3) =       0.000419225561
  error estimate for blocks of size 2^( 4) =       0.000425158167
  error estimate for blocks of size 2^( 5) =       0.000428795338
  error estimate for blocks of size 2^( 6) =       0.000430328493
  error estimate for blocks of size 2^( 7) =       0.000429533089

      target function =                  N/A
              le_mean =     -17.216665070168
             les_mean =     296.735917282639
             stat err =       0.000428453772
             autocorr =       1.138924748294
              std dev =       0.567768707728
             le_variance =       0.322361305475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320332764832
                                         uncertainty =       0.003741585641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320332764832
                                         uncertainty =       0.003741585641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400141716
  error estimate for blocks of size 2^( 2) =       0.000409552411
  error estimate for blocks of size 2^( 3) =       0.000418037523
  error estimate for blocks of size 2^( 4) =       0.000424023576
  error estimate for blocks of size 2^( 5) =       0.000427688551
  error estimate for blocks of size 2^( 6) =       0.000429275693
  error estimate for blocks of size 2^( 7) =       0.000428539530

      target function =                  N/A
              le_mean =     -17.216660655993
             les_mean =     296.733630768493
             stat err =       0.000427381837
             autocorr =       1.140786739610
              std dev =       0.565885840954
             le_variance =       0.320226784992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216663145348        initial
     6.2500e-02     6.2500e-01             5.2343e-03       -17.216660371067
     2.5000e-01     2.5000e+00             2.2137e-03       -17.216665070168  <--
     1.0000e+00     1.0000e+01             7.1098e-04       -17.216660655993

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9373e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.904634e-01 1 1  ON 0
 uu_1                 2.796195e-02 1 1  ON 1
 uu_2                -6.759226e-02 1 1  ON 2
 uu_3                -1.240672e-01 1 1  ON 3
 uu_4                -1.601128e-01 1 1  ON 4
 uu_5                -1.720185e-01 1 1  ON 5
 uu_6                -1.595697e-01 1 1  ON 6
 uu_7                -1.135949e-01 1 1  ON 7
 uu_8                -3.702217e-02 1 1  ON 8
 uu_9                 1.618981e-01 1 1  ON 9
 ud_0                 3.480421e-01 1 1  ON 10
 ud_1                 9.031969e-02 1 1  ON 11
 ud_2                -1.865492e-02 1 1  ON 12
 ud_3                -7.988919e-02 1 1  ON 13
 ud_4                -1.300286e-01 1 1  ON 14
 ud_5                -1.679267e-01 1 1  ON 15
 ud_6                -1.812192e-01 1 1  ON 16
 ud_7                -1.593846e-01 1 1  ON 17
 ud_8                -9.923508e-02 1 1  ON 18
 ud_9                -8.557527e-03 1 1  ON 19
 eO_0                -9.225345e-01 1 1  ON 20
 eO_1                -6.018469e-01 1 1  ON 21
 eO_2                -1.894912e-01 1 1  ON 22
 eO_3                 7.841381e-02 1 1  ON 23
 eO_4                 2.043950e-01 1 1  ON 24
 eO_5                 2.936408e-01 1 1  ON 25
 eO_6                 3.342584e-01 1 1  ON 26
 eO_7                 5.024136e-01 1 1  ON 27
 eO_8                 1.938796e-01 1 1  ON 28
 eO_9                 6.110936e-02 1 1  ON 29
eH1_0                -2.113328e-01 1 1  ON 30
eH1_1                -1.326390e-01 1 1  ON 31
eH1_2                -9.142611e-02 1 1  ON 32
eH1_3                -5.395813e-02 1 1  ON 33
eH1_4                -7.614930e-03 1 1  ON 34
eH1_5                 4.168506e-03 1 1  ON 35
eH1_6                 4.133153e-02 1 1  ON 36
eH1_7                 6.430419e-02 1 1  ON 37
eH1_8                 1.799282e-01 1 1  ON 38
eH1_9                 1.209838e-01 1 1  ON 39
eH2_0                -2.066739e-01 1 1  ON 40
eH2_1                -1.278227e-01 1 1  ON 41
eH2_2                -8.657817e-02 1 1  ON 42
eH2_3                -4.911273e-02 1 1  ON 43
eH2_4                -2.661113e-03 1 1  ON 44
eH2_5                 8.949595e-03 1 1  ON 45
eH2_6                 4.681075e-02 1 1  ON 46
eH2_7                 4.607855e-02 1 1  ON 47
eH2_8                 1.982306e-01 1 1  ON 48
eH2_9                 1.200938e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7238e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2605
    reference variance = 0.380057
====================================================
  Execution time = 2.3299e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2270e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322733803148
                                         uncertainty =       0.005497927216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322733803148
                                         uncertainty =       0.005497927216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401686709
  error estimate for blocks of size 2^( 2) =       0.000411039241
  error estimate for blocks of size 2^( 3) =       0.000419296891
  error estimate for blocks of size 2^( 4) =       0.000424787749
  error estimate for blocks of size 2^( 5) =       0.000427377190
  error estimate for blocks of size 2^( 6) =       0.000428000353
  error estimate for blocks of size 2^( 7) =       0.000428385227

      target function =                  N/A
              le_mean =     -17.216811624789
             les_mean =     296.741306786799
             stat err =       0.000427137630
             autocorr =       1.130734757798
              std dev =       0.568070791977
             le_variance =       0.322704424698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721681162479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216811624789       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216820271811       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216822121703       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216824248555       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216825277853       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216827063430       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216828354385       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216828771201       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216831119229       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216831857582       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216831556292       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216831606599       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.231521e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216811624789       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817096565       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216818275895       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216819637993       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216820125501       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216820951901       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216821162381       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216821454103       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216821918078       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216821985238       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.704265e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216811624789       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216813841133       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216814425466       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216814956568       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216815086236       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216815337221       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216815341652       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216815455808       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.375464e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8904e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.907277e-01 1 1  ON 0
 uu_1                 2.805236e-02 1 1  ON 1
 uu_2                -6.760578e-02 1 1  ON 2
 uu_3                -1.242484e-01 1 1  ON 3
 uu_4                -1.604078e-01 1 1  ON 4
 uu_5                -1.723536e-01 1 1  ON 5
 uu_6                -1.594748e-01 1 1  ON 6
 uu_7                -1.135478e-01 1 1  ON 7
 uu_8                -3.694946e-02 1 1  ON 8
 uu_9                 1.619061e-01 1 1  ON 9
 ud_0                 3.487401e-01 1 1  ON 10
 ud_1                 9.059408e-02 1 1  ON 11
 ud_2                -1.896137e-02 1 1  ON 12
 ud_3                -8.046602e-02 1 1  ON 13
 ud_4                -1.304003e-01 1 1  ON 14
 ud_5                -1.677457e-01 1 1  ON 15
 ud_6                -1.810977e-01 1 1  ON 16
 ud_7                -1.596121e-01 1 1  ON 17
 ud_8                -9.921077e-02 1 1  ON 18
 ud_9                -8.475984e-03 1 1  ON 19
 eO_0                -9.242387e-01 1 1  ON 20
 eO_1                -6.026117e-01 1 1  ON 21
 eO_2                -1.888502e-01 1 1  ON 22
 eO_3                 7.967566e-02 1 1  ON 23
 eO_4                 2.049368e-01 1 1  ON 24
 eO_5                 2.936353e-01 1 1  ON 25
 eO_6                 3.341917e-01 1 1  ON 26
 eO_7                 5.023463e-01 1 1  ON 27
 eO_8                 1.939912e-01 1 1  ON 28
 eO_9                 6.114641e-02 1 1  ON 29
eH1_0                -2.115121e-01 1 1  ON 30
eH1_1                -1.327268e-01 1 1  ON 31
eH1_2                -9.161147e-02 1 1  ON 32
eH1_3                -5.386023e-02 1 1  ON 33
eH1_4                -7.541729e-03 1 1  ON 34
eH1_5                 4.469136e-03 1 1  ON 35
eH1_6                 4.149621e-02 1 1  ON 36
eH1_7                 6.415873e-02 1 1  ON 37
eH1_8                 1.798722e-01 1 1  ON 38
eH1_9                 1.209799e-01 1 1  ON 39
eH2_0                -2.068390e-01 1 1  ON 40
eH2_1                -1.280220e-01 1 1  ON 41
eH2_2                -8.648831e-02 1 1  ON 42
eH2_3                -4.912199e-02 1 1  ON 43
eH2_4                -2.863933e-03 1 1  ON 44
eH2_5                 9.152768e-03 1 1  ON 45
eH2_6                 4.682701e-02 1 1  ON 46
eH2_7                 4.621963e-02 1 1  ON 47
eH2_8                 1.982536e-01 1 1  ON 48
eH2_9                 1.201494e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2869
    reference variance = 0.229319
====================================================
  Execution time = 2.1000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2383e-01
  Total weights = 2.0000e+06
  Execution time = 1.8690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323058875995
                                         uncertainty =       0.005168093544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323058875995
                                         uncertainty =       0.005168093544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401888830
  error estimate for blocks of size 2^( 2) =       0.000411229628
  error estimate for blocks of size 2^( 3) =       0.000420052234
  error estimate for blocks of size 2^( 4) =       0.000425941906
  error estimate for blocks of size 2^( 5) =       0.000429319961
  error estimate for blocks of size 2^( 6) =       0.000432040595
  error estimate for blocks of size 2^( 7) =       0.000433986400

      target function =                  N/A
              le_mean =     -17.216796845363
             les_mean =     296.741122715630
             stat err =       0.000430322216
             autocorr =       1.146504237167
              std dev =       0.568356633326
             le_variance =       0.323029262645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324583343478
                                         uncertainty =       0.005185284583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324583343478
                                         uncertainty =       0.005185284583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402835728
  error estimate for blocks of size 2^( 2) =       0.000412128497
  error estimate for blocks of size 2^( 3) =       0.000420906233
  error estimate for blocks of size 2^( 4) =       0.000426758182
  error estimate for blocks of size 2^( 5) =       0.000430098112
  error estimate for blocks of size 2^( 6) =       0.000432810160
  error estimate for blocks of size 2^( 7) =       0.000434731061

      target function =                  N/A
              le_mean =     -17.216799620492
             les_mean =     296.742742257784
             stat err =       0.000431099379
             autocorr =       1.145246122184
              std dev =       0.569695750294
             le_variance =       0.324553247903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324673854760
                                         uncertainty =       0.005186732131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324673854760
                                         uncertainty =       0.005186732131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402891930
  error estimate for blocks of size 2^( 2) =       0.000412179868
  error estimate for blocks of size 2^( 3) =       0.000420955150
  error estimate for blocks of size 2^( 4) =       0.000426806857
  error estimate for blocks of size 2^( 5) =       0.000430145956
  error estimate for blocks of size 2^( 6) =       0.000432853475
  error estimate for blocks of size 2^( 7) =       0.000434768683

      target function =                  N/A
              le_mean =     -17.216799958245
             les_mean =     296.742844455147
             stat err =       0.000431143743
             autocorr =       1.145162286824
              std dev =       0.569775232200
             le_variance =       0.324643815228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323353255311
                                         uncertainty =       0.005171670872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323353255311
                                         uncertainty =       0.005171670872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402071870
  error estimate for blocks of size 2^( 2) =       0.000411401725
  error estimate for blocks of size 2^( 3) =       0.000420214923
  error estimate for blocks of size 2^( 4) =       0.000426097215
  error estimate for blocks of size 2^( 5) =       0.000429468018
  error estimate for blocks of size 2^( 6) =       0.000432185545
  error estimate for blocks of size 2^( 7) =       0.000434124426

      target function =                  N/A
              le_mean =     -17.216796439247
             les_mean =     296.741403045904
             stat err =       0.000430468801
             autocorr =       1.146241113952
              std dev =       0.568615491444
             le_variance =       0.323323577110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216796845363        initial
     6.2500e-02     6.2500e-01             4.2315e-03       -17.216799620492
     2.5000e-01     2.5000e+00             1.7043e-03       -17.216799958245  <--
     1.0000e+00     1.0000e+01             5.3755e-04       -17.216796439247

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0449e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.907277e-01 1 1  ON 0
 uu_1                 2.805236e-02 1 1  ON 1
 uu_2                -6.760578e-02 1 1  ON 2
 uu_3                -1.242484e-01 1 1  ON 3
 uu_4                -1.604078e-01 1 1  ON 4
 uu_5                -1.723536e-01 1 1  ON 5
 uu_6                -1.594748e-01 1 1  ON 6
 uu_7                -1.135478e-01 1 1  ON 7
 uu_8                -3.694946e-02 1 1  ON 8
 uu_9                 1.619061e-01 1 1  ON 9
 ud_0                 3.487401e-01 1 1  ON 10
 ud_1                 9.059408e-02 1 1  ON 11
 ud_2                -1.896137e-02 1 1  ON 12
 ud_3                -8.046602e-02 1 1  ON 13
 ud_4                -1.304003e-01 1 1  ON 14
 ud_5                -1.677457e-01 1 1  ON 15
 ud_6                -1.810977e-01 1 1  ON 16
 ud_7                -1.596121e-01 1 1  ON 17
 ud_8                -9.921077e-02 1 1  ON 18
 ud_9                -8.475984e-03 1 1  ON 19
 eO_0                -9.242387e-01 1 1  ON 20
 eO_1                -6.026117e-01 1 1  ON 21
 eO_2                -1.888502e-01 1 1  ON 22
 eO_3                 7.967566e-02 1 1  ON 23
 eO_4                 2.049368e-01 1 1  ON 24
 eO_5                 2.936353e-01 1 1  ON 25
 eO_6                 3.341917e-01 1 1  ON 26
 eO_7                 5.023463e-01 1 1  ON 27
 eO_8                 1.939912e-01 1 1  ON 28
 eO_9                 6.114641e-02 1 1  ON 29
eH1_0                -2.115121e-01 1 1  ON 30
eH1_1                -1.327268e-01 1 1  ON 31
eH1_2                -9.161147e-02 1 1  ON 32
eH1_3                -5.386023e-02 1 1  ON 33
eH1_4                -7.541729e-03 1 1  ON 34
eH1_5                 4.469136e-03 1 1  ON 35
eH1_6                 4.149621e-02 1 1  ON 36
eH1_7                 6.415873e-02 1 1  ON 37
eH1_8                 1.798722e-01 1 1  ON 38
eH1_9                 1.209799e-01 1 1  ON 39
eH2_0                -2.068390e-01 1 1  ON 40
eH2_1                -1.280220e-01 1 1  ON 41
eH2_2                -8.648831e-02 1 1  ON 42
eH2_3                -4.912199e-02 1 1  ON 43
eH2_4                -2.863933e-03 1 1  ON 44
eH2_5                 9.152768e-03 1 1  ON 45
eH2_6                 4.682701e-02 1 1  ON 46
eH2_7                 4.621963e-02 1 1  ON 47
eH2_8                 1.982536e-01 1 1  ON 48
eH2_9                 1.201494e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7250e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.146545
====================================================
  Execution time = 2.1458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2792e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327928652767
                                         uncertainty =       0.004559554623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327928652767
                                         uncertainty =       0.004559554623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404919364
  error estimate for blocks of size 2^( 2) =       0.000414652148
  error estimate for blocks of size 2^( 3) =       0.000422675295
  error estimate for blocks of size 2^( 4) =       0.000429352016
  error estimate for blocks of size 2^( 5) =       0.000433860225
  error estimate for blocks of size 2^( 6) =       0.000435144944
  error estimate for blocks of size 2^( 7) =       0.000434797383

      target function =                  N/A
              le_mean =     -17.216463718002
             les_mean =     296.734542171288
             stat err =       0.000433288642
             autocorr =       1.145031723198
              std dev =       0.572642455599
             le_variance =       0.327919381954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646371800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216463718002       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216465279273       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216467892814       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216465634768       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216465157407       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216465062440       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216464637229       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216466503020       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216466754373       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216466742118       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216466540267       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216466822135       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.090480e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216463718002       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216464583797       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216466162667       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216464540421       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216464591518       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216464537831       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216464529306       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216465084980       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216465083368       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216465112342       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.209145e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216463718002       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216464029235       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216464661609       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216464126256       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216464074417       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216464162972       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216464254904       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216464243635       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.789614e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7125e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.911097e-01 1 1  ON 0
 uu_1                 2.816551e-02 1 1  ON 1
 uu_2                -6.764504e-02 1 1  ON 2
 uu_3                -1.242711e-01 1 1  ON 3
 uu_4                -1.604724e-01 1 1  ON 4
 uu_5                -1.726350e-01 1 1  ON 5
 uu_6                -1.595789e-01 1 1  ON 6
 uu_7                -1.135681e-01 1 1  ON 7
 uu_8                -3.698126e-02 1 1  ON 8
 uu_9                 1.618300e-01 1 1  ON 9
 ud_0                 3.490412e-01 1 1  ON 10
 ud_1                 9.094792e-02 1 1  ON 11
 ud_2                -1.892636e-02 1 1  ON 12
 ud_3                -8.064911e-02 1 1  ON 13
 ud_4                -1.308258e-01 1 1  ON 14
 ud_5                -1.679863e-01 1 1  ON 15
 ud_6                -1.809590e-01 1 1  ON 16
 ud_7                -1.595865e-01 1 1  ON 17
 ud_8                -9.929343e-02 1 1  ON 18
 ud_9                -8.474933e-03 1 1  ON 19
 eO_0                -9.254479e-01 1 1  ON 20
 eO_1                -6.030549e-01 1 1  ON 21
 eO_2                -1.887771e-01 1 1  ON 22
 eO_3                 8.069209e-02 1 1  ON 23
 eO_4                 2.056902e-01 1 1  ON 24
 eO_5                 2.935939e-01 1 1  ON 25
 eO_6                 3.339943e-01 1 1  ON 26
 eO_7                 5.022856e-01 1 1  ON 27
 eO_8                 1.940617e-01 1 1  ON 28
 eO_9                 6.116910e-02 1 1  ON 29
eH1_0                -2.117352e-01 1 1  ON 30
eH1_1                -1.329372e-01 1 1  ON 31
eH1_2                -9.154203e-02 1 1  ON 32
eH1_3                -5.378505e-02 1 1  ON 33
eH1_4                -7.646867e-03 1 1  ON 34
eH1_5                 4.719729e-03 1 1  ON 35
eH1_6                 4.164212e-02 1 1  ON 36
eH1_7                 6.408994e-02 1 1  ON 37
eH1_8                 1.799008e-01 1 1  ON 38
eH1_9                 1.210016e-01 1 1  ON 39
eH2_0                -2.068923e-01 1 1  ON 40
eH2_1                -1.278687e-01 1 1  ON 41
eH2_2                -8.659231e-02 1 1  ON 42
eH2_3                -4.921463e-02 1 1  ON 43
eH2_4                -3.005398e-03 1 1  ON 44
eH2_5                 9.497646e-03 1 1  ON 45
eH2_6                 4.683253e-02 1 1  ON 46
eH2_7                 4.613243e-02 1 1  ON 47
eH2_8                 1.981716e-01 1 1  ON 48
eH2_9                 1.201657e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2415
    reference variance = 0.280915
====================================================
  Execution time = 2.1102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1950e-01
  Total weights = 2.0000e+06
  Execution time = 1.8705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319183526618
                                         uncertainty =       0.004357329451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319183526618
                                         uncertainty =       0.004357329451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399490975
  error estimate for blocks of size 2^( 2) =       0.000409190447
  error estimate for blocks of size 2^( 3) =       0.000417896250
  error estimate for blocks of size 2^( 4) =       0.000423784051
  error estimate for blocks of size 2^( 5) =       0.000428019313
  error estimate for blocks of size 2^( 6) =       0.000429375785
  error estimate for blocks of size 2^( 7) =       0.000429255370

      target function =                  N/A
              le_mean =     -17.216581142157
             les_mean =     296.729852142327
             stat err =       0.000427608630
             autocorr =       1.145721277644
              std dev =       0.564965554202
             le_variance =       0.319186077434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319977941368
                                         uncertainty =       0.004390313154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319977941368
                                         uncertainty =       0.004390313154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399987623
  error estimate for blocks of size 2^( 2) =       0.000409669451
  error estimate for blocks of size 2^( 3) =       0.000418352190
  error estimate for blocks of size 2^( 4) =       0.000424209450
  error estimate for blocks of size 2^( 5) =       0.000428436174
  error estimate for blocks of size 2^( 6) =       0.000429772757
  error estimate for blocks of size 2^( 7) =       0.000429643542

      target function =                  N/A
              le_mean =     -17.216579184545
             les_mean =     296.730578854376
             stat err =       0.000428015481
             autocorr =       1.145053686204
              std dev =       0.565667920845
             le_variance =       0.319980196673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319829588663
                                         uncertainty =       0.004389500157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319829588663
                                         uncertainty =       0.004389500157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399894906
  error estimate for blocks of size 2^( 2) =       0.000409580443
  error estimate for blocks of size 2^( 3) =       0.000418268363
  error estimate for blocks of size 2^( 4) =       0.000424130684
  error estimate for blocks of size 2^( 5) =       0.000428357451
  error estimate for blocks of size 2^( 6) =       0.000429691877
  error estimate for blocks of size 2^( 7) =       0.000429561487

      target function =                  N/A
              le_mean =     -17.216578991228
             les_mean =     296.730423872637
             stat err =       0.000427935375
             autocorr =       1.145155949131
              std dev =       0.565536799307
             le_variance =       0.319831871370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319278306433
                                         uncertainty =       0.004363541457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319278306433
                                         uncertainty =       0.004363541457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399550254
  error estimate for blocks of size 2^( 2) =       0.000409247402
  error estimate for blocks of size 2^( 3) =       0.000417950595
  error estimate for blocks of size 2^( 4) =       0.000423834258
  error estimate for blocks of size 2^( 5) =       0.000428068064
  error estimate for blocks of size 2^( 6) =       0.000429420266
  error estimate for blocks of size 2^( 7) =       0.000429297975

      target function =                  N/A
              le_mean =     -17.216580323287
             les_mean =     296.729918680244
             stat err =       0.000427655141
             autocorr =       1.145630508988
              std dev =       0.565049388707
             le_variance =       0.319280811678


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216581142157        initial  <--
     6.2500e-02     6.2500e-01             3.0905e-03       -17.216579184545
     2.5000e-01     2.5000e+00             1.2091e-03       -17.216578991228
     1.0000e+00     1.0000e+01             3.7896e-04       -17.216580323287

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5696
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.907277e-01 1 1  ON 0
 uu_1                 2.805236e-02 1 1  ON 1
 uu_2                -6.760578e-02 1 1  ON 2
 uu_3                -1.242484e-01 1 1  ON 3
 uu_4                -1.604078e-01 1 1  ON 4
 uu_5                -1.723536e-01 1 1  ON 5
 uu_6                -1.594748e-01 1 1  ON 6
 uu_7                -1.135478e-01 1 1  ON 7
 uu_8                -3.694946e-02 1 1  ON 8
 uu_9                 1.619061e-01 1 1  ON 9
 ud_0                 3.487401e-01 1 1  ON 10
 ud_1                 9.059408e-02 1 1  ON 11
 ud_2                -1.896137e-02 1 1  ON 12
 ud_3                -8.046602e-02 1 1  ON 13
 ud_4                -1.304003e-01 1 1  ON 14
 ud_5                -1.677457e-01 1 1  ON 15
 ud_6                -1.810977e-01 1 1  ON 16
 ud_7                -1.596121e-01 1 1  ON 17
 ud_8                -9.921077e-02 1 1  ON 18
 ud_9                -8.475984e-03 1 1  ON 19
 eO_0                -9.242387e-01 1 1  ON 20
 eO_1                -6.026117e-01 1 1  ON 21
 eO_2                -1.888502e-01 1 1  ON 22
 eO_3                 7.967566e-02 1 1  ON 23
 eO_4                 2.049368e-01 1 1  ON 24
 eO_5                 2.936353e-01 1 1  ON 25
 eO_6                 3.341917e-01 1 1  ON 26
 eO_7                 5.023463e-01 1 1  ON 27
 eO_8                 1.939912e-01 1 1  ON 28
 eO_9                 6.114641e-02 1 1  ON 29
eH1_0                -2.115121e-01 1 1  ON 30
eH1_1                -1.327268e-01 1 1  ON 31
eH1_2                -9.161147e-02 1 1  ON 32
eH1_3                -5.386023e-02 1 1  ON 33
eH1_4                -7.541729e-03 1 1  ON 34
eH1_5                 4.469136e-03 1 1  ON 35
eH1_6                 4.149621e-02 1 1  ON 36
eH1_7                 6.415873e-02 1 1  ON 37
eH1_8                 1.798722e-01 1 1  ON 38
eH1_9                 1.209799e-01 1 1  ON 39
eH2_0                -2.068390e-01 1 1  ON 40
eH2_1                -1.280220e-01 1 1  ON 41
eH2_2                -8.648831e-02 1 1  ON 42
eH2_3                -4.912199e-02 1 1  ON 43
eH2_4                -2.863933e-03 1 1  ON 44
eH2_5                 9.152768e-03 1 1  ON 45
eH2_6                 4.682701e-02 1 1  ON 46
eH2_7                 4.621963e-02 1 1  ON 47
eH2_8                 1.982536e-01 1 1  ON 48
eH2_9                 1.201494e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7242e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1516
    reference variance = 0.310645
====================================================
  Execution time = 2.1568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1584e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315827548929
                                         uncertainty =       0.002797208424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315827548929
                                         uncertainty =       0.002797208424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397393613
  error estimate for blocks of size 2^( 2) =       0.000407274501
  error estimate for blocks of size 2^( 3) =       0.000416503223
  error estimate for blocks of size 2^( 4) =       0.000423207134
  error estimate for blocks of size 2^( 5) =       0.000426854366
  error estimate for blocks of size 2^( 6) =       0.000430031006
  error estimate for blocks of size 2^( 7) =       0.000434932319

      target function =                  N/A
              le_mean =     -17.216868233806
             les_mean =     296.736394989607
             stat err =       0.000428756206
             autocorr =       1.164069936724
              std dev =       0.561999437094
             le_variance =       0.315843367294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686823381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216868233806       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216869695854       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216870727299       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216871257143       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216871337943       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216870880672       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216870858427       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216871004979       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216870997311       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.763621e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216868233806       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216868699647       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216869001346       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216869153084       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216869154963       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216869070794       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216869006009       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.277580e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216868233806       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216868358847       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216868437999       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216868477016       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216868476404       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216868457388       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216868437009       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.324777e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7218e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.906973e-01 1 1  ON 0
 uu_1                 2.808709e-02 1 1  ON 1
 uu_2                -6.760077e-02 1 1  ON 2
 uu_3                -1.242796e-01 1 1  ON 3
 uu_4                -1.603908e-01 1 1  ON 4
 uu_5                -1.723343e-01 1 1  ON 5
 uu_6                -1.594779e-01 1 1  ON 6
 uu_7                -1.135640e-01 1 1  ON 7
 uu_8                -3.694828e-02 1 1  ON 8
 uu_9                 1.619010e-01 1 1  ON 9
 ud_0                 3.488276e-01 1 1  ON 10
 ud_1                 9.060101e-02 1 1  ON 11
 ud_2                -1.897627e-02 1 1  ON 12
 ud_3                -8.054303e-02 1 1  ON 13
 ud_4                -1.304639e-01 1 1  ON 14
 ud_5                -1.677257e-01 1 1  ON 15
 ud_6                -1.810455e-01 1 1  ON 16
 ud_7                -1.596124e-01 1 1  ON 17
 ud_8                -9.922318e-02 1 1  ON 18
 ud_9                -8.478200e-03 1 1  ON 19
 eO_0                -9.243665e-01 1 1  ON 20
 eO_1                -6.026486e-01 1 1  ON 21
 eO_2                -1.888237e-01 1 1  ON 22
 eO_3                 7.977661e-02 1 1  ON 23
 eO_4                 2.049774e-01 1 1  ON 24
 eO_5                 2.936322e-01 1 1  ON 25
 eO_6                 3.341891e-01 1 1  ON 26
 eO_7                 5.023405e-01 1 1  ON 27
 eO_8                 1.939977e-01 1 1  ON 28
 eO_9                 6.114806e-02 1 1  ON 29
eH1_0                -2.115584e-01 1 1  ON 30
eH1_1                -1.327781e-01 1 1  ON 31
eH1_2                -9.158831e-02 1 1  ON 32
eH1_3                -5.388094e-02 1 1  ON 33
eH1_4                -7.484169e-03 1 1  ON 34
eH1_5                 4.519458e-03 1 1  ON 35
eH1_6                 4.149210e-02 1 1  ON 36
eH1_7                 6.414350e-02 1 1  ON 37
eH1_8                 1.798745e-01 1 1  ON 38
eH1_9                 1.209825e-01 1 1  ON 39
eH2_0                -2.068510e-01 1 1  ON 40
eH2_1                -1.280371e-01 1 1  ON 41
eH2_2                -8.649825e-02 1 1  ON 42
eH2_3                -4.909224e-02 1 1  ON 43
eH2_4                -2.843445e-03 1 1  ON 44
eH2_5                 9.125395e-03 1 1  ON 45
eH2_6                 4.681721e-02 1 1  ON 46
eH2_7                 4.624203e-02 1 1  ON 47
eH2_8                 1.982552e-01 1 1  ON 48
eH2_9                 1.201484e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2571
    reference variance = 0.178178
====================================================
  Execution time = 2.1129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2625e-01
  Total weights = 2.0000e+06
  Execution time = 1.8757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326273745433
                                         uncertainty =       0.005973750641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326273745433
                                         uncertainty =       0.005973750641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403836979
  error estimate for blocks of size 2^( 2) =       0.000413466859
  error estimate for blocks of size 2^( 3) =       0.000421856350
  error estimate for blocks of size 2^( 4) =       0.000427748710
  error estimate for blocks of size 2^( 5) =       0.000431998639
  error estimate for blocks of size 2^( 6) =       0.000435014683
  error estimate for blocks of size 2^( 7) =       0.000436303404

      target function =                  N/A
              le_mean =     -17.216468987859
             les_mean =     296.732972857466
             stat err =       0.000432766359
             autocorr =       1.148404323969
              std dev =       0.571111732176
             le_variance =       0.326168610629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326541324054
                                         uncertainty =       0.005982941596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326541324054
                                         uncertainty =       0.005982941596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404002531
  error estimate for blocks of size 2^( 2) =       0.000413623710
  error estimate for blocks of size 2^( 3) =       0.000422002760
  error estimate for blocks of size 2^( 4) =       0.000427886119
  error estimate for blocks of size 2^( 5) =       0.000432132125
  error estimate for blocks of size 2^( 6) =       0.000435149420
  error estimate for blocks of size 2^( 7) =       0.000436436117

      target function =                  N/A
              le_mean =     -17.216470276931
             les_mean =     296.733284724109
             stat err =       0.000432900945
             autocorr =       1.148177137468
              std dev =       0.571345859255
             le_variance =       0.326436090888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326443301846
                                         uncertainty =       0.005979934066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326443301846
                                         uncertainty =       0.005979934066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403941896
  error estimate for blocks of size 2^( 2) =       0.000413566375
  error estimate for blocks of size 2^( 3) =       0.000421949323
  error estimate for blocks of size 2^( 4) =       0.000427836197
  error estimate for blocks of size 2^( 5) =       0.000432083315
  error estimate for blocks of size 2^( 6) =       0.000435100026
  error estimate for blocks of size 2^( 7) =       0.000436387148

      target function =                  N/A
              le_mean =     -17.216469912071
             les_mean =     296.733174180816
             stat err =       0.000432851672
             autocorr =       1.148260430172
              std dev =       0.571260107783
             le_variance =       0.326338110744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326296568637
                                         uncertainty =       0.005974582707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326296568637
                                         uncertainty =       0.005974582707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403851103
  error estimate for blocks of size 2^( 2) =       0.000413480252
  error estimate for blocks of size 2^( 3) =       0.000421868855
  error estimate for blocks of size 2^( 4) =       0.000427760477
  error estimate for blocks of size 2^( 5) =       0.000432010018
  error estimate for blocks of size 2^( 6) =       0.000435026143
  error estimate for blocks of size 2^( 7) =       0.000436314651

      target function =                  N/A
              le_mean =     -17.216469103303
             les_mean =     296.732999648305
             stat err =       0.000432777822
             autocorr =       1.148384832465
              std dev =       0.571131706703
             le_variance =       0.326191426402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216468987859        initial
     6.2500e-01     6.2500e+00             4.7636e-04       -17.216470276931  <--
     2.5000e+00     2.5000e+01             1.2776e-04       -17.216469912071
     1.0000e+01     1.0000e+02             3.3248e-05       -17.216469103303

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0612e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.906655e-01 1 1  ON 0
 uu_1                 2.815978e-02 1 1  ON 1
 uu_2                -6.760357e-02 1 1  ON 2
 uu_3                -1.243422e-01 1 1  ON 3
 uu_4                -1.603897e-01 1 1  ON 4
 uu_5                -1.722792e-01 1 1  ON 5
 uu_6                -1.594783e-01 1 1  ON 6
 uu_7                -1.136116e-01 1 1  ON 7
 uu_8                -3.694362e-02 1 1  ON 8
 uu_9                 1.618847e-01 1 1  ON 9
 ud_0                 3.490034e-01 1 1  ON 10
 ud_1                 9.064520e-02 1 1  ON 11
 ud_2                -1.901851e-02 1 1  ON 12
 ud_3                -8.070580e-02 1 1  ON 13
 ud_4                -1.306311e-01 1 1  ON 14
 ud_5                -1.677059e-01 1 1  ON 15
 ud_6                -1.808870e-01 1 1  ON 16
 ud_7                -1.596065e-01 1 1  ON 17
 ud_8                -9.926072e-02 1 1  ON 18
 ud_9                -8.484997e-03 1 1  ON 19
 eO_0                -9.247151e-01 1 1  ON 20
 eO_1                -6.027571e-01 1 1  ON 21
 eO_2                -1.887734e-01 1 1  ON 22
 eO_3                 8.003192e-02 1 1  ON 23
 eO_4                 2.051233e-01 1 1  ON 24
 eO_5                 2.936352e-01 1 1  ON 25
 eO_6                 3.341832e-01 1 1  ON 26
 eO_7                 5.023226e-01 1 1  ON 27
 eO_8                 1.940187e-01 1 1  ON 28
 eO_9                 6.115341e-02 1 1  ON 29
eH1_0                -2.116838e-01 1 1  ON 30
eH1_1                -1.328911e-01 1 1  ON 31
eH1_2                -9.155653e-02 1 1  ON 32
eH1_3                -5.391204e-02 1 1  ON 33
eH1_4                -7.362017e-03 1 1  ON 34
eH1_5                 4.664370e-03 1 1  ON 35
eH1_6                 4.148759e-02 1 1  ON 36
eH1_7                 6.409694e-02 1 1  ON 37
eH1_8                 1.798821e-01 1 1  ON 38
eH1_9                 1.209911e-01 1 1  ON 39
eH2_0                -2.068841e-01 1 1  ON 40
eH2_1                -1.280924e-01 1 1  ON 41
eH2_2                -8.651480e-02 1 1  ON 42
eH2_3                -4.902100e-02 1 1  ON 43
eH2_4                -2.788431e-03 1 1  ON 44
eH2_5                 9.049593e-03 1 1  ON 45
eH2_6                 4.679291e-02 1 1  ON 46
eH2_7                 4.631523e-02 1 1  ON 47
eH2_8                 1.982607e-01 1 1  ON 48
eH2_9                 1.201451e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7837e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7234e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2225
    reference variance = 0.18003
====================================================
  Execution time = 2.1451e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.6343e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363478954412
                                         uncertainty =       0.039117517761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363478954412
                                         uncertainty =       0.039117517761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426278072
  error estimate for blocks of size 2^( 2) =       0.000435010765
  error estimate for blocks of size 2^( 3) =       0.000443379837
  error estimate for blocks of size 2^( 4) =       0.000448946238
  error estimate for blocks of size 2^( 5) =       0.000452260080
  error estimate for blocks of size 2^( 6) =       0.000454486882
  error estimate for blocks of size 2^( 7) =       0.000457007995

      target function =                  N/A
              le_mean =     -17.216114894592
             les_mean =     296.758037870617
             stat err =       0.000453175299
             autocorr =       1.130177025187
              std dev =       0.602848230112
             le_variance =       0.363425988549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611489459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114894592       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216116395896       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216117459121       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216115835601       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216116369642       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216115950740       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216117489161       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216117356604       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216117457977       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216117327840       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.534085e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114894592       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216115551655       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216116345474       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216115751587       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216115718160       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216115779536       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216115897308       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216116044908       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.275823e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114894592       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216115096805       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216115413945       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216115259483       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216115226818       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216115256564       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216115239638       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.434619e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140744 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7093e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.909158e-01 1 1  ON 0
 uu_1                 2.815889e-02 1 1  ON 1
 uu_2                -6.769587e-02 1 1  ON 2
 uu_3                -1.243591e-01 1 1  ON 3
 uu_4                -1.605515e-01 1 1  ON 4
 uu_5                -1.723029e-01 1 1  ON 5
 uu_6                -1.594814e-01 1 1  ON 6
 uu_7                -1.135593e-01 1 1  ON 7
 uu_8                -3.695296e-02 1 1  ON 8
 uu_9                 1.618340e-01 1 1  ON 9
 ud_0                 3.492007e-01 1 1  ON 10
 ud_1                 9.078887e-02 1 1  ON 11
 ud_2                -1.902570e-02 1 1  ON 12
 ud_3                -8.083129e-02 1 1  ON 13
 ud_4                -1.307525e-01 1 1  ON 14
 ud_5                -1.678032e-01 1 1  ON 15
 ud_6                -1.808025e-01 1 1  ON 16
 ud_7                -1.596074e-01 1 1  ON 17
 ud_8                -9.932893e-02 1 1  ON 18
 ud_9                -8.520656e-03 1 1  ON 19
 eO_0                -9.250763e-01 1 1  ON 20
 eO_1                -6.030515e-01 1 1  ON 21
 eO_2                -1.887438e-01 1 1  ON 22
 eO_3                 8.055950e-02 1 1  ON 23
 eO_4                 2.053063e-01 1 1  ON 24
 eO_5                 2.935764e-01 1 1  ON 25
 eO_6                 3.341498e-01 1 1  ON 26
 eO_7                 5.023036e-01 1 1  ON 27
 eO_8                 1.940358e-01 1 1  ON 28
 eO_9                 6.115866e-02 1 1  ON 29
eH1_0                -2.117358e-01 1 1  ON 30
eH1_1                -1.329237e-01 1 1  ON 31
eH1_2                -9.145456e-02 1 1  ON 32
eH1_3                -5.372913e-02 1 1  ON 33
eH1_4                -7.361596e-03 1 1  ON 34
eH1_5                 4.545158e-03 1 1  ON 35
eH1_6                 4.145208e-02 1 1  ON 36
eH1_7                 6.403751e-02 1 1  ON 37
eH1_8                 1.798754e-01 1 1  ON 38
eH1_9                 1.209983e-01 1 1  ON 39
eH2_0                -2.070023e-01 1 1  ON 40
eH2_1                -1.281578e-01 1 1  ON 41
eH2_2                -8.655327e-02 1 1  ON 42
eH2_3                -4.891369e-02 1 1  ON 43
eH2_4                -2.940990e-03 1 1  ON 44
eH2_5                 9.156945e-03 1 1  ON 45
eH2_6                 4.684863e-02 1 1  ON 46
eH2_7                 4.640651e-02 1 1  ON 47
eH2_8                 1.982584e-01 1 1  ON 48
eH2_9                 1.201503e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2822
    reference variance = 0.308076
====================================================
  Execution time = 2.1145e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1332e-01
  Total weights = 2.0000e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313164912441
                                         uncertainty =       0.002704748270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313164912441
                                         uncertainty =       0.002704748270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395678189
  error estimate for blocks of size 2^( 2) =       0.000405447829
  error estimate for blocks of size 2^( 3) =       0.000414714009
  error estimate for blocks of size 2^( 4) =       0.000421020269
  error estimate for blocks of size 2^( 5) =       0.000425393924
  error estimate for blocks of size 2^( 6) =       0.000427553640
  error estimate for blocks of size 2^( 7) =       0.000430320254

      target function =                  N/A
              le_mean =     -17.217097292738
             les_mean =     296.741561489628
             stat err =       0.000426072022
             autocorr =       1.159529523273
              std dev =       0.559573461282
             le_variance =       0.313122458571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313668291921
                                         uncertainty =       0.002709100815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313668291921
                                         uncertainty =       0.002709100815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395996131
  error estimate for blocks of size 2^( 2) =       0.000405754990
  error estimate for blocks of size 2^( 3) =       0.000415008525
  error estimate for blocks of size 2^( 4) =       0.000421306956
  error estimate for blocks of size 2^( 5) =       0.000425673080
  error estimate for blocks of size 2^( 6) =       0.000427823625
  error estimate for blocks of size 2^( 7) =       0.000430590796

      target function =                  N/A
              le_mean =     -17.217095844234
             les_mean =     296.742015023706
             stat err =       0.000426348614
             autocorr =       1.159171851227
              std dev =       0.560023098600
             le_variance =       0.313625870966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313561401699
                                         uncertainty =       0.002708269644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313561401699
                                         uncertainty =       0.002708269644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395928629
  error estimate for blocks of size 2^( 2) =       0.000405690726
  error estimate for blocks of size 2^( 3) =       0.000414947898
  error estimate for blocks of size 2^( 4) =       0.000421248119
  error estimate for blocks of size 2^( 5) =       0.000425615055
  error estimate for blocks of size 2^( 6) =       0.000427764776
  error estimate for blocks of size 2^( 7) =       0.000430532428

      target function =                  N/A
              le_mean =     -17.217095410113
             les_mean =     296.741893162234
             stat err =       0.000426290094
             autocorr =       1.159248841756
              std dev =       0.559927636458
             le_variance =       0.313518958070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313221649804
                                         uncertainty =       0.002705265331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313221649804
                                         uncertainty =       0.002705265331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395714034
  error estimate for blocks of size 2^( 2) =       0.000405482713
  error estimate for blocks of size 2^( 3) =       0.000414747781
  error estimate for blocks of size 2^( 4) =       0.000421053224
  error estimate for blocks of size 2^( 5) =       0.000425425686
  error estimate for blocks of size 2^( 6) =       0.000427583364
  error estimate for blocks of size 2^( 7) =       0.000430350212

      target function =                  N/A
              le_mean =     -17.217096845150
             les_mean =     296.741602812428
             stat err =       0.000426103121
             autocorr =       1.159488712536
              std dev =       0.559624153992
             le_variance =       0.313179193731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217097292738        initial  <--
     1.5625e-01     1.5625e+00             1.5341e-03       -17.217095844234
     6.2500e-01     6.2500e+00             5.2758e-04       -17.217095410113
     2.5000e+00     2.5000e+01             1.4346e-04       -17.217096845150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6433
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.906655e-01 1 1  ON 0
 uu_1                 2.815978e-02 1 1  ON 1
 uu_2                -6.760357e-02 1 1  ON 2
 uu_3                -1.243422e-01 1 1  ON 3
 uu_4                -1.603897e-01 1 1  ON 4
 uu_5                -1.722792e-01 1 1  ON 5
 uu_6                -1.594783e-01 1 1  ON 6
 uu_7                -1.136116e-01 1 1  ON 7
 uu_8                -3.694362e-02 1 1  ON 8
 uu_9                 1.618847e-01 1 1  ON 9
 ud_0                 3.490034e-01 1 1  ON 10
 ud_1                 9.064520e-02 1 1  ON 11
 ud_2                -1.901851e-02 1 1  ON 12
 ud_3                -8.070580e-02 1 1  ON 13
 ud_4                -1.306311e-01 1 1  ON 14
 ud_5                -1.677059e-01 1 1  ON 15
 ud_6                -1.808870e-01 1 1  ON 16
 ud_7                -1.596065e-01 1 1  ON 17
 ud_8                -9.926072e-02 1 1  ON 18
 ud_9                -8.484997e-03 1 1  ON 19
 eO_0                -9.247151e-01 1 1  ON 20
 eO_1                -6.027571e-01 1 1  ON 21
 eO_2                -1.887734e-01 1 1  ON 22
 eO_3                 8.003192e-02 1 1  ON 23
 eO_4                 2.051233e-01 1 1  ON 24
 eO_5                 2.936352e-01 1 1  ON 25
 eO_6                 3.341832e-01 1 1  ON 26
 eO_7                 5.023226e-01 1 1  ON 27
 eO_8                 1.940187e-01 1 1  ON 28
 eO_9                 6.115341e-02 1 1  ON 29
eH1_0                -2.116838e-01 1 1  ON 30
eH1_1                -1.328911e-01 1 1  ON 31
eH1_2                -9.155653e-02 1 1  ON 32
eH1_3                -5.391204e-02 1 1  ON 33
eH1_4                -7.362017e-03 1 1  ON 34
eH1_5                 4.664370e-03 1 1  ON 35
eH1_6                 4.148759e-02 1 1  ON 36
eH1_7                 6.409694e-02 1 1  ON 37
eH1_8                 1.798821e-01 1 1  ON 38
eH1_9                 1.209911e-01 1 1  ON 39
eH2_0                -2.068841e-01 1 1  ON 40
eH2_1                -1.280924e-01 1 1  ON 41
eH2_2                -8.651480e-02 1 1  ON 42
eH2_3                -4.902100e-02 1 1  ON 43
eH2_4                -2.788431e-03 1 1  ON 44
eH2_5                 9.049593e-03 1 1  ON 45
eH2_6                 4.679291e-02 1 1  ON 46
eH2_7                 4.631523e-02 1 1  ON 47
eH2_8                 1.982607e-01 1 1  ON 48
eH2_9                 1.201451e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7237e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2767
    reference variance = 0.196515
====================================================
  Execution time = 2.3492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2732e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327366046309
                                         uncertainty =       0.004859692001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327366046309
                                         uncertainty =       0.004859692001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404551289
  error estimate for blocks of size 2^( 2) =       0.000413833898
  error estimate for blocks of size 2^( 3) =       0.000422981502
  error estimate for blocks of size 2^( 4) =       0.000429346940
  error estimate for blocks of size 2^( 5) =       0.000432944659
  error estimate for blocks of size 2^( 6) =       0.000435687309
  error estimate for blocks of size 2^( 7) =       0.000435218647

      target function =                  N/A
              le_mean =     -17.216935484406
             les_mean =     296.750190801003
             stat err =       0.000433299389
             autocorr =       1.147173153211
              std dev =       0.572121919229
             le_variance =       0.327323490463


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693548441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935484406       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216935771320       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216935780551       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216935934404       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216936070458       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216936098829       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216936009165       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.055113e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935484406       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216935564605       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216935565646       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216935592140       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216935624789       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216935633573       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216935615999       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 5.446867e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935484406       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216935505066       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216935505247       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216935510906       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216935518656       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216935521013       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216935516919       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.385309e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142949 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9133e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.906520e-01 1 1  ON 0
 uu_1                 2.815497e-02 1 1  ON 1
 uu_2                -6.761302e-02 1 1  ON 2
 uu_3                -1.243494e-01 1 1  ON 3
 uu_4                -1.603862e-01 1 1  ON 4
 uu_5                -1.722824e-01 1 1  ON 5
 uu_6                -1.594685e-01 1 1  ON 6
 uu_7                -1.136060e-01 1 1  ON 7
 uu_8                -3.693615e-02 1 1  ON 8
 uu_9                 1.618877e-01 1 1  ON 9
 ud_0                 3.490156e-01 1 1  ON 10
 ud_1                 9.065790e-02 1 1  ON 11
 ud_2                -1.901463e-02 1 1  ON 12
 ud_3                -8.072235e-02 1 1  ON 13
 ud_4                -1.306543e-01 1 1  ON 14
 ud_5                -1.677119e-01 1 1  ON 15
 ud_6                -1.808826e-01 1 1  ON 16
 ud_7                -1.596039e-01 1 1  ON 17
 ud_8                -9.925983e-02 1 1  ON 18
 ud_9                -8.482634e-03 1 1  ON 19
 eO_0                -9.247696e-01 1 1  ON 20
 eO_1                -6.027681e-01 1 1  ON 21
 eO_2                -1.887747e-01 1 1  ON 22
 eO_3                 8.007566e-02 1 1  ON 23
 eO_4                 2.051452e-01 1 1  ON 24
 eO_5                 2.936306e-01 1 1  ON 25
 eO_6                 3.341810e-01 1 1  ON 26
 eO_7                 5.023223e-01 1 1  ON 27
 eO_8                 1.940238e-01 1 1  ON 28
 eO_9                 6.115522e-02 1 1  ON 29
eH1_0                -2.116860e-01 1 1  ON 30
eH1_1                -1.328920e-01 1 1  ON 31
eH1_2                -9.155750e-02 1 1  ON 32
eH1_3                -5.390003e-02 1 1  ON 33
eH1_4                -7.369168e-03 1 1  ON 34
eH1_5                 4.656504e-03 1 1  ON 35
eH1_6                 4.149256e-02 1 1  ON 36
eH1_7                 6.409428e-02 1 1  ON 37
eH1_8                 1.798835e-01 1 1  ON 38
eH1_9                 1.209929e-01 1 1  ON 39
eH2_0                -2.068941e-01 1 1  ON 40
eH2_1                -1.280903e-01 1 1  ON 41
eH2_2                -8.652341e-02 1 1  ON 42
eH2_3                -4.903702e-02 1 1  ON 43
eH2_4                -2.775050e-03 1 1  ON 44
eH2_5                 9.053066e-03 1 1  ON 45
eH2_6                 4.680339e-02 1 1  ON 46
eH2_7                 4.631728e-02 1 1  ON 47
eH2_8                 1.982598e-01 1 1  ON 48
eH2_9                 1.201472e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1111
    reference variance = 0.245141
====================================================
  Execution time = 2.0998e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1256e-01
  Total weights = 2.0000e+06
  Execution time = 1.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312609933152
                                         uncertainty =       0.002702912415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312609933152
                                         uncertainty =       0.002702912415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395319623
  error estimate for blocks of size 2^( 2) =       0.000404943956
  error estimate for blocks of size 2^( 3) =       0.000413100432
  error estimate for blocks of size 2^( 4) =       0.000419495592
  error estimate for blocks of size 2^( 5) =       0.000422417239
  error estimate for blocks of size 2^( 6) =       0.000423651614
  error estimate for blocks of size 2^( 7) =       0.000426070947

      target function =                  N/A
              le_mean =     -17.216533982775
             les_mean =     296.721597432392
             stat err =       0.000422908848
             autocorr =       1.144449932272
              std dev =       0.559066372301
             le_variance =       0.312555208637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312644551000
                                         uncertainty =       0.002703060676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312644551000
                                         uncertainty =       0.002703060676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395341529
  error estimate for blocks of size 2^( 2) =       0.000404964726
  error estimate for blocks of size 2^( 3) =       0.000413120344
  error estimate for blocks of size 2^( 4) =       0.000419514805
  error estimate for blocks of size 2^( 5) =       0.000422434669
  error estimate for blocks of size 2^( 6) =       0.000423668341
  error estimate for blocks of size 2^( 7) =       0.000426086717

      target function =                  N/A
              le_mean =     -17.216533812636
             les_mean =     296.721626214184
             stat err =       0.000422926133
             autocorr =       1.144416650058
              std dev =       0.559097351831
             le_variance =       0.312589848825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312625763533
                                         uncertainty =       0.002702961679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312625763533
                                         uncertainty =       0.002702961679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395329643
  error estimate for blocks of size 2^( 2) =       0.000404953438
  error estimate for blocks of size 2^( 3) =       0.000413109542
  error estimate for blocks of size 2^( 4) =       0.000419504417
  error estimate for blocks of size 2^( 5) =       0.000422425127
  error estimate for blocks of size 2^( 6) =       0.000423659134
  error estimate for blocks of size 2^( 7) =       0.000426077959

      target function =                  N/A
              le_mean =     -17.216533903987
             les_mean =     296.721610563800
             stat err =       0.000422916659
             autocorr =       1.144434194499
              std dev =       0.559080542461
             le_variance =       0.312571052959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312611840559
                                         uncertainty =       0.002702917502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312611840559
                                         uncertainty =       0.002702917502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395320830
  error estimate for blocks of size 2^( 2) =       0.000404945098
  error estimate for blocks of size 2^( 3) =       0.000413101529
  error estimate for blocks of size 2^( 4) =       0.000419496655
  error estimate for blocks of size 2^( 5) =       0.000422418184
  error estimate for blocks of size 2^( 6) =       0.000423652513
  error estimate for blocks of size 2^( 7) =       0.000426071781

      target function =                  N/A
              le_mean =     -17.216533971979
             les_mean =     296.721598969942
             stat err =       0.000422909783
             autocorr =       1.144448004083
              std dev =       0.559068079851
             le_variance =       0.312557117908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216533982775        initial  <--
     1.5625e+00     1.5625e+01             2.0551e-04       -17.216533812636
     6.2500e+00     6.2500e+01             5.4469e-05       -17.216533903987
     2.5000e+01     2.5000e+02             1.3853e-05       -17.216533971979

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5034
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.906655e-01 1 1  ON 0
 uu_1                 2.815978e-02 1 1  ON 1
 uu_2                -6.760357e-02 1 1  ON 2
 uu_3                -1.243422e-01 1 1  ON 3
 uu_4                -1.603897e-01 1 1  ON 4
 uu_5                -1.722792e-01 1 1  ON 5
 uu_6                -1.594783e-01 1 1  ON 6
 uu_7                -1.136116e-01 1 1  ON 7
 uu_8                -3.694362e-02 1 1  ON 8
 uu_9                 1.618847e-01 1 1  ON 9
 ud_0                 3.490034e-01 1 1  ON 10
 ud_1                 9.064520e-02 1 1  ON 11
 ud_2                -1.901851e-02 1 1  ON 12
 ud_3                -8.070580e-02 1 1  ON 13
 ud_4                -1.306311e-01 1 1  ON 14
 ud_5                -1.677059e-01 1 1  ON 15
 ud_6                -1.808870e-01 1 1  ON 16
 ud_7                -1.596065e-01 1 1  ON 17
 ud_8                -9.926072e-02 1 1  ON 18
 ud_9                -8.484997e-03 1 1  ON 19
 eO_0                -9.247151e-01 1 1  ON 20
 eO_1                -6.027571e-01 1 1  ON 21
 eO_2                -1.887734e-01 1 1  ON 22
 eO_3                 8.003192e-02 1 1  ON 23
 eO_4                 2.051233e-01 1 1  ON 24
 eO_5                 2.936352e-01 1 1  ON 25
 eO_6                 3.341832e-01 1 1  ON 26
 eO_7                 5.023226e-01 1 1  ON 27
 eO_8                 1.940187e-01 1 1  ON 28
 eO_9                 6.115341e-02 1 1  ON 29
eH1_0                -2.116838e-01 1 1  ON 30
eH1_1                -1.328911e-01 1 1  ON 31
eH1_2                -9.155653e-02 1 1  ON 32
eH1_3                -5.391204e-02 1 1  ON 33
eH1_4                -7.362017e-03 1 1  ON 34
eH1_5                 4.664370e-03 1 1  ON 35
eH1_6                 4.148759e-02 1 1  ON 36
eH1_7                 6.409694e-02 1 1  ON 37
eH1_8                 1.798821e-01 1 1  ON 38
eH1_9                 1.209911e-01 1 1  ON 39
eH2_0                -2.068841e-01 1 1  ON 40
eH2_1                -1.280924e-01 1 1  ON 41
eH2_2                -8.651480e-02 1 1  ON 42
eH2_3                -4.902100e-02 1 1  ON 43
eH2_4                -2.788431e-03 1 1  ON 44
eH2_5                 9.049593e-03 1 1  ON 45
eH2_6                 4.679291e-02 1 1  ON 46
eH2_7                 4.631523e-02 1 1  ON 47
eH2_8                 1.982607e-01 1 1  ON 48
eH2_9                 1.201451e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9643e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2167
    reference variance = 0.233956
====================================================
  Execution time = 2.3509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1488e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314960198707
                                         uncertainty =       0.003150091491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314960198707
                                         uncertainty =       0.003150091491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396787099
  error estimate for blocks of size 2^( 2) =       0.000405843377
  error estimate for blocks of size 2^( 3) =       0.000414041247
  error estimate for blocks of size 2^( 4) =       0.000420935692
  error estimate for blocks of size 2^( 5) =       0.000425096783
  error estimate for blocks of size 2^( 6) =       0.000428229234
  error estimate for blocks of size 2^( 7) =       0.000430506900

      target function =                  N/A
              le_mean =     -17.216706054254
             les_mean =     296.729847204359
             stat err =       0.000426192152
             autocorr =       1.153707753965
              std dev =       0.561141696186
             le_variance =       0.314880003198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670605425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216706054254       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216706117174       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216706157339       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216706117162       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216706114130       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216706140001       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216706135624       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.633174e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216706054254       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216706070190       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216706080537       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216706070624       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216706069794       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216706076185       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216706075108       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 6.618878e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216706054254       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216706058251       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216706060858       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216706058388       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216706058177       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216706059769       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216706059501       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.656990e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9183e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.906668e-01 1 1  ON 0
 uu_1                 2.816097e-02 1 1  ON 1
 uu_2                -6.760548e-02 1 1  ON 2
 uu_3                -1.243435e-01 1 1  ON 3
 uu_4                -1.603890e-01 1 1  ON 4
 uu_5                -1.722804e-01 1 1  ON 5
 uu_6                -1.594783e-01 1 1  ON 6
 uu_7                -1.136116e-01 1 1  ON 7
 uu_8                -3.694314e-02 1 1  ON 8
 uu_9                 1.618846e-01 1 1  ON 9
 ud_0                 3.490039e-01 1 1  ON 10
 ud_1                 9.064643e-02 1 1  ON 11
 ud_2                -1.901772e-02 1 1  ON 12
 ud_3                -8.070773e-02 1 1  ON 13
 ud_4                -1.306327e-01 1 1  ON 14
 ud_5                -1.677076e-01 1 1  ON 15
 ud_6                -1.808863e-01 1 1  ON 16
 ud_7                -1.596055e-01 1 1  ON 17
 ud_8                -9.926034e-02 1 1  ON 18
 ud_9                -8.484859e-03 1 1  ON 19
 eO_0                -9.247217e-01 1 1  ON 20
 eO_1                -6.027593e-01 1 1  ON 21
 eO_2                -1.887710e-01 1 1  ON 22
 eO_3                 8.003725e-02 1 1  ON 23
 eO_4                 2.051248e-01 1 1  ON 24
 eO_5                 2.936345e-01 1 1  ON 25
 eO_6                 3.341829e-01 1 1  ON 26
 eO_7                 5.023224e-01 1 1  ON 27
 eO_8                 1.940191e-01 1 1  ON 28
 eO_9                 6.115361e-02 1 1  ON 29
eH1_0                -2.116857e-01 1 1  ON 30
eH1_1                -1.328919e-01 1 1  ON 31
eH1_2                -9.155582e-02 1 1  ON 32
eH1_3                -5.391162e-02 1 1  ON 33
eH1_4                -7.361997e-03 1 1  ON 34
eH1_5                 4.666312e-03 1 1  ON 35
eH1_6                 4.148731e-02 1 1  ON 36
eH1_7                 6.409641e-02 1 1  ON 37
eH1_8                 1.798821e-01 1 1  ON 38
eH1_9                 1.209913e-01 1 1  ON 39
eH2_0                -2.068838e-01 1 1  ON 40
eH2_1                -1.280924e-01 1 1  ON 41
eH2_2                -8.651451e-02 1 1  ON 42
eH2_3                -4.902191e-02 1 1  ON 43
eH2_4                -2.788846e-03 1 1  ON 44
eH2_5                 9.049197e-03 1 1  ON 45
eH2_6                 4.679324e-02 1 1  ON 46
eH2_7                 4.631579e-02 1 1  ON 47
eH2_8                 1.982608e-01 1 1  ON 48
eH2_9                 1.201452e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2292
    reference variance = 0.19191
====================================================
  Execution time = 2.1512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1574e-01
  Total weights = 2.0000e+06
  Execution time = 1.8729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315703237537
                                         uncertainty =       0.003613656414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315703237537
                                         uncertainty =       0.003613656414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397328324
  error estimate for blocks of size 2^( 2) =       0.000406501828
  error estimate for blocks of size 2^( 3) =       0.000414800724
  error estimate for blocks of size 2^( 4) =       0.000421204498
  error estimate for blocks of size 2^( 5) =       0.000425090891
  error estimate for blocks of size 2^( 6) =       0.000428332162
  error estimate for blocks of size 2^( 7) =       0.000429967588

      target function =                  N/A
              le_mean =     -17.216875407580
             les_mean =     296.736538236508
             stat err =       0.000426148785
             autocorr =       1.150332679805
              std dev =       0.561907104653
             le_variance =       0.315739594259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315706861832
                                         uncertainty =       0.003613696667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315706861832
                                         uncertainty =       0.003613696667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397330604
  error estimate for blocks of size 2^( 2) =       0.000406504122
  error estimate for blocks of size 2^( 3) =       0.000414802931
  error estimate for blocks of size 2^( 4) =       0.000421206734
  error estimate for blocks of size 2^( 5) =       0.000425092983
  error estimate for blocks of size 2^( 6) =       0.000428334035
  error estimate for blocks of size 2^( 7) =       0.000429969227

      target function =                  N/A
              le_mean =     -17.216875410072
             les_mean =     296.736541945131
             stat err =       0.000426150744
             autocorr =       1.150330060742
              std dev =       0.561910328319
             le_variance =       0.315743217072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315705023981
                                         uncertainty =       0.003613676228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315705023981
                                         uncertainty =       0.003613676228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397329448
  error estimate for blocks of size 2^( 2) =       0.000406502961
  error estimate for blocks of size 2^( 3) =       0.000414801814
  error estimate for blocks of size 2^( 4) =       0.000421205604
  error estimate for blocks of size 2^( 5) =       0.000425091924
  error estimate for blocks of size 2^( 6) =       0.000428333083
  error estimate for blocks of size 2^( 7) =       0.000429968391

      target function =                  N/A
              le_mean =     -17.216875408529
             les_mean =     296.736540054844
             stat err =       0.000426149751
             autocorr =       1.150331387744
              std dev =       0.561908693566
             le_variance =       0.315741379905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315703459922
                                         uncertainty =       0.003613658880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315703459922
                                         uncertainty =       0.003613658880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397328464
  error estimate for blocks of size 2^( 2) =       0.000406501969
  error estimate for blocks of size 2^( 3) =       0.000414800860
  error estimate for blocks of size 2^( 4) =       0.000421204636
  error estimate for blocks of size 2^( 5) =       0.000425091020
  error estimate for blocks of size 2^( 6) =       0.000428332276
  error estimate for blocks of size 2^( 7) =       0.000429967688

      target function =                  N/A
              le_mean =     -17.216875407676
             les_mean =     296.736538462094
             stat err =       0.000426148905
             autocorr =       1.150332518806
              std dev =       0.561907302446
             le_variance =       0.315739816542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216875407580        initial
     1.5625e+01     1.5625e+02             2.6332e-05       -17.216875410072  <--
     6.2500e+01     6.2500e+02             6.6189e-06       -17.216875408529
     2.5000e+02     2.5000e+03             1.6570e-06       -17.216875407676

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 3.0981e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.906708e-01 1 1  ON 0
 uu_1                 2.816442e-02 1 1  ON 1
 uu_2                -6.761106e-02 1 1  ON 2
 uu_3                -1.243474e-01 1 1  ON 3
 uu_4                -1.603872e-01 1 1  ON 4
 uu_5                -1.722838e-01 1 1  ON 5
 uu_6                -1.594784e-01 1 1  ON 6
 uu_7                -1.136116e-01 1 1  ON 7
 uu_8                -3.694169e-02 1 1  ON 8
 uu_9                 1.618846e-01 1 1  ON 9
 ud_0                 3.490053e-01 1 1  ON 10
 ud_1                 9.065009e-02 1 1  ON 11
 ud_2                -1.901544e-02 1 1  ON 12
 ud_3                -8.071341e-02 1 1  ON 13
 ud_4                -1.306376e-01 1 1  ON 14
 ud_5                -1.677126e-01 1 1  ON 15
 ud_6                -1.808844e-01 1 1  ON 16
 ud_7                -1.596023e-01 1 1  ON 17
 ud_8                -9.925919e-02 1 1  ON 18
 ud_9                -8.484447e-03 1 1  ON 19
 eO_0                -9.247414e-01 1 1  ON 20
 eO_1                -6.027659e-01 1 1  ON 21
 eO_2                -1.887636e-01 1 1  ON 22
 eO_3                 8.005315e-02 1 1  ON 23
 eO_4                 2.051292e-01 1 1  ON 24
 eO_5                 2.936326e-01 1 1  ON 25
 eO_6                 3.341819e-01 1 1  ON 26
 eO_7                 5.023219e-01 1 1  ON 27
 eO_8                 1.940203e-01 1 1  ON 28
 eO_9                 6.115421e-02 1 1  ON 29
eH1_0                -2.116911e-01 1 1  ON 30
eH1_1                -1.328942e-01 1 1  ON 31
eH1_2                -9.155370e-02 1 1  ON 32
eH1_3                -5.391040e-02 1 1  ON 33
eH1_4                -7.361928e-03 1 1  ON 34
eH1_5                 4.672120e-03 1 1  ON 35
eH1_6                 4.148647e-02 1 1  ON 36
eH1_7                 6.409483e-02 1 1  ON 37
eH1_8                 1.798820e-01 1 1  ON 38
eH1_9                 1.209919e-01 1 1  ON 39
eH2_0                -2.068831e-01 1 1  ON 40
eH2_1                -1.280923e-01 1 1  ON 41
eH2_2                -8.651364e-02 1 1  ON 42
eH2_3                -4.902458e-02 1 1  ON 43
eH2_4                -2.790103e-03 1 1  ON 44
eH2_5                 9.048021e-03 1 1  ON 45
eH2_6                 4.679423e-02 1 1  ON 46
eH2_7                 4.631747e-02 1 1  ON 47
eH2_8                 1.982609e-01 1 1  ON 48
eH2_9                 1.201453e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0173e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2635
    reference variance = 0.544327
====================================================
  Execution time = 2.2851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1905e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319001881496
                                         uncertainty =       0.002782216327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319001881496
                                         uncertainty =       0.002782216327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399404963
  error estimate for blocks of size 2^( 2) =       0.000408891905
  error estimate for blocks of size 2^( 3) =       0.000417916945
  error estimate for blocks of size 2^( 4) =       0.000423690641
  error estimate for blocks of size 2^( 5) =       0.000425658011
  error estimate for blocks of size 2^( 6) =       0.000427849978
  error estimate for blocks of size 2^( 7) =       0.000429813604

      target function =                  N/A
              le_mean =     -17.216401687457
             les_mean =     296.723535553598
             stat err =       0.000426753059
             autocorr =       1.141632621926
              std dev =       0.564843915829
             le_variance =       0.319048649249


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640168746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216401687457       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216401679960       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216401678335       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216401773068       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216401737481       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216401657307       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216401727884       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 8.247626e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216401687457       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216401685526       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216401684702       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216401710688       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216401703330       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216401684869       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216401701061       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.114185e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216401687457       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216401686970       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216401686735       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216401693400       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216401691667       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216401687170       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216401691119       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.319730e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8356e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.906755e-01 1 1  ON 0
 uu_1                 2.817247e-02 1 1  ON 1
 uu_2                -6.761954e-02 1 1  ON 2
 uu_3                -1.243467e-01 1 1  ON 3
 uu_4                -1.603899e-01 1 1  ON 4
 uu_5                -1.722867e-01 1 1  ON 5
 uu_6                -1.594798e-01 1 1  ON 6
 uu_7                -1.136120e-01 1 1  ON 7
 uu_8                -3.694145e-02 1 1  ON 8
 uu_9                 1.618841e-01 1 1  ON 9
 ud_0                 3.490122e-01 1 1  ON 10
 ud_1                 9.065894e-02 1 1  ON 11
 ud_2                -1.901355e-02 1 1  ON 12
 ud_3                -8.071782e-02 1 1  ON 13
 ud_4                -1.306374e-01 1 1  ON 14
 ud_5                -1.677185e-01 1 1  ON 15
 ud_6                -1.808869e-01 1 1  ON 16
 ud_7                -1.596061e-01 1 1  ON 17
 ud_8                -9.926267e-02 1 1  ON 18
 ud_9                -8.484316e-03 1 1  ON 19
 eO_0                -9.247626e-01 1 1  ON 20
 eO_1                -6.027719e-01 1 1  ON 21
 eO_2                -1.887537e-01 1 1  ON 22
 eO_3                 8.006795e-02 1 1  ON 23
 eO_4                 2.051387e-01 1 1  ON 24
 eO_5                 2.936267e-01 1 1  ON 25
 eO_6                 3.341795e-01 1 1  ON 26
 eO_7                 5.023211e-01 1 1  ON 27
 eO_8                 1.940214e-01 1 1  ON 28
 eO_9                 6.115482e-02 1 1  ON 29
eH1_0                -2.116998e-01 1 1  ON 30
eH1_1                -1.328961e-01 1 1  ON 31
eH1_2                -9.154683e-02 1 1  ON 32
eH1_3                -5.390256e-02 1 1  ON 33
eH1_4                -7.364533e-03 1 1  ON 34
eH1_5                 4.674069e-03 1 1  ON 35
eH1_6                 4.148476e-02 1 1  ON 36
eH1_7                 6.409239e-02 1 1  ON 37
eH1_8                 1.798817e-01 1 1  ON 38
eH1_9                 1.209923e-01 1 1  ON 39
eH2_0                -2.068834e-01 1 1  ON 40
eH2_1                -1.280981e-01 1 1  ON 41
eH2_2                -8.651194e-02 1 1  ON 42
eH2_3                -4.902283e-02 1 1  ON 43
eH2_4                -2.787238e-03 1 1  ON 44
eH2_5                 9.047971e-03 1 1  ON 45
eH2_6                 4.679300e-02 1 1  ON 46
eH2_7                 4.631832e-02 1 1  ON 47
eH2_8                 1.982605e-01 1 1  ON 48
eH2_9                 1.201456e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2441
    reference variance = 0.272242
====================================================
  Execution time = 2.0842e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1827e-01
  Total weights = 2.0000e+06
  Execution time = 1.8662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318359678800
                                         uncertainty =       0.003260148392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318359678800
                                         uncertainty =       0.003260148392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398910401
  error estimate for blocks of size 2^( 2) =       0.000408382515
  error estimate for blocks of size 2^( 3) =       0.000416546490
  error estimate for blocks of size 2^( 4) =       0.000422392314
  error estimate for blocks of size 2^( 5) =       0.000426826534
  error estimate for blocks of size 2^( 6) =       0.000430090760
  error estimate for blocks of size 2^( 7) =       0.000431101797

      target function =                  N/A
              le_mean =     -17.216543949960
             les_mean =     296.727644437522
             stat err =       0.000427602851
             autocorr =       1.149027611958
              std dev =       0.564144499002
             le_variance =       0.318259015754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318385749102
                                         uncertainty =       0.003260649746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318385749102
                                         uncertainty =       0.003260649746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398926732
  error estimate for blocks of size 2^( 2) =       0.000408398027
  error estimate for blocks of size 2^( 3) =       0.000416561394
  error estimate for blocks of size 2^( 4) =       0.000422406522
  error estimate for blocks of size 2^( 5) =       0.000426840659
  error estimate for blocks of size 2^( 6) =       0.000430104921
  error estimate for blocks of size 2^( 7) =       0.000431115522

      target function =                  N/A
              le_mean =     -17.216544153807
             les_mean =     296.727677516513
             stat err =       0.000427616906
             autocorr =       1.149009063901
              std dev =       0.564167595360
             le_variance =       0.318285075655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318372863573
                                         uncertainty =       0.003260408976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318372863573
                                         uncertainty =       0.003260408976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398918660
  error estimate for blocks of size 2^( 2) =       0.000408390350
  error estimate for blocks of size 2^( 3) =       0.000416554031
  error estimate for blocks of size 2^( 4) =       0.000422399495
  error estimate for blocks of size 2^( 5) =       0.000426833697
  error estimate for blocks of size 2^( 6) =       0.000430097945
  error estimate for blocks of size 2^( 7) =       0.000431108747

      target function =                  N/A
              le_mean =     -17.216544055806
             les_mean =     296.727661261440
             stat err =       0.000427609971
             autocorr =       1.149018294428
              std dev =       0.564156179688
             le_variance =       0.318272195080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318361329438
                                         uncertainty =       0.003260181297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318361329438
                                         uncertainty =       0.003260181297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398911435
  error estimate for blocks of size 2^( 2) =       0.000408383495
  error estimate for blocks of size 2^( 3) =       0.000416547434
  error estimate for blocks of size 2^( 4) =       0.000422393213
  error estimate for blocks of size 2^( 5) =       0.000426827431
  error estimate for blocks of size 2^( 6) =       0.000430091660
  error estimate for blocks of size 2^( 7) =       0.000431102667

      target function =                  N/A
              le_mean =     -17.216543963093
             les_mean =     296.727646539699
             stat err =       0.000427603743
             autocorr =       1.149026446242
              std dev =       0.564145961346
             le_variance =       0.318260665703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216543949960        initial
     3.9062e+00     3.9062e+01             8.2476e-05       -17.216544153807  <--
     1.5625e+01     1.5625e+02             2.1142e-05       -17.216544055806
     6.2500e+01     6.2500e+02             5.3197e-06       -17.216543963093

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.0302e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.906894e-01 1 1  ON 0
 uu_1                 2.819394e-02 1 1  ON 1
 uu_2                -6.764154e-02 1 1  ON 2
 uu_3                -1.243464e-01 1 1  ON 3
 uu_4                -1.603970e-01 1 1  ON 4
 uu_5                -1.722951e-01 1 1  ON 5
 uu_6                -1.594842e-01 1 1  ON 6
 uu_7                -1.136131e-01 1 1  ON 7
 uu_8                -3.694079e-02 1 1  ON 8
 uu_9                 1.618825e-01 1 1  ON 9
 ud_0                 3.490338e-01 1 1  ON 10
 ud_1                 9.068389e-02 1 1  ON 11
 ud_2                -1.900788e-02 1 1  ON 12
 ud_3                -8.072997e-02 1 1  ON 13
 ud_4                -1.306377e-01 1 1  ON 14
 ud_5                -1.677352e-01 1 1  ON 15
 ud_6                -1.808945e-01 1 1  ON 16
 ud_7                -1.596175e-01 1 1  ON 17
 ud_8                -9.927294e-02 1 1  ON 18
 ud_9                -8.483942e-03 1 1  ON 19
 eO_0                -9.248239e-01 1 1  ON 20
 eO_1                -6.027896e-01 1 1  ON 21
 eO_2                -1.887257e-01 1 1  ON 22
 eO_3                 8.011183e-02 1 1  ON 23
 eO_4                 2.051669e-01 1 1  ON 24
 eO_5                 2.936090e-01 1 1  ON 25
 eO_6                 3.341725e-01 1 1  ON 26
 eO_7                 5.023189e-01 1 1  ON 27
 eO_8                 1.940247e-01 1 1  ON 28
 eO_9                 6.115662e-02 1 1  ON 29
eH1_0                -2.117253e-01 1 1  ON 30
eH1_1                -1.329012e-01 1 1  ON 31
eH1_2                -9.152682e-02 1 1  ON 32
eH1_3                -5.387995e-02 1 1  ON 33
eH1_4                -7.371566e-03 1 1  ON 34
eH1_5                 4.679581e-03 1 1  ON 35
eH1_6                 4.147957e-02 1 1  ON 36
eH1_7                 6.408518e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.209937e-01 1 1  ON 39
eH2_0                -2.068848e-01 1 1  ON 40
eH2_1                -1.281151e-01 1 1  ON 41
eH2_2                -8.650647e-02 1 1  ON 42
eH2_3                -4.901790e-02 1 1  ON 43
eH2_4                -2.778762e-03 1 1  ON 44
eH2_5                 9.048026e-03 1 1  ON 45
eH2_6                 4.678933e-02 1 1  ON 46
eH2_7                 4.632077e-02 1 1  ON 47
eH2_8                 1.982593e-01 1 1  ON 48
eH2_9                 1.201462e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8665e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1785
    reference variance = 0.248037
====================================================
  Execution time = 2.1713e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2231e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322415534673
                                         uncertainty =       0.004219813021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322415534673
                                         uncertainty =       0.004219813021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401442578
  error estimate for blocks of size 2^( 2) =       0.000411001224
  error estimate for blocks of size 2^( 3) =       0.000418787690
  error estimate for blocks of size 2^( 4) =       0.000425637812
  error estimate for blocks of size 2^( 5) =       0.000429967080
  error estimate for blocks of size 2^( 6) =       0.000431618725
  error estimate for blocks of size 2^( 7) =       0.000431690690

      target function =                  N/A
              le_mean =     -17.216061732862
             les_mean =     296.715093715560
             stat err =       0.000429728577
             autocorr =       1.145886502152
              std dev =       0.567725538443
             le_variance =       0.322312287000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721606173286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216061732862       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216062603126       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216062886669       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216062891121       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216063000287       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216063250033       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216063195132       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.677705e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216061732862       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216061999488       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216062075952       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216062081538       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216062124707       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216062192340       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216062184409       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.905881e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216061732862       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216061803501       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216061823121       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216061824944       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216061837537       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216061854697       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216061853327       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.736936e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149624 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7337e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.907476e-01 1 1  ON 0
 uu_1                 2.818464e-02 1 1  ON 1
 uu_2                -6.765933e-02 1 1  ON 2
 uu_3                -1.243663e-01 1 1  ON 3
 uu_4                -1.604043e-01 1 1  ON 4
 uu_5                -1.723155e-01 1 1  ON 5
 uu_6                -1.594876e-01 1 1  ON 6
 uu_7                -1.136094e-01 1 1  ON 7
 uu_8                -3.693478e-02 1 1  ON 8
 uu_9                 1.618812e-01 1 1  ON 9
 ud_0                 3.490717e-01 1 1  ON 10
 ud_1                 9.068253e-02 1 1  ON 11
 ud_2                -1.900826e-02 1 1  ON 12
 ud_3                -8.075979e-02 1 1  ON 13
 ud_4                -1.306687e-01 1 1  ON 14
 ud_5                -1.677516e-01 1 1  ON 15
 ud_6                -1.808775e-01 1 1  ON 16
 ud_7                -1.596003e-01 1 1  ON 17
 ud_8                -9.927476e-02 1 1  ON 18
 ud_9                -8.482431e-03 1 1  ON 19
 eO_0                -9.248930e-01 1 1  ON 20
 eO_1                -6.028330e-01 1 1  ON 21
 eO_2                -1.887083e-01 1 1  ON 22
 eO_3                 8.017738e-02 1 1  ON 23
 eO_4                 2.051971e-01 1 1  ON 24
 eO_5                 2.936037e-01 1 1  ON 25
 eO_6                 3.341717e-01 1 1  ON 26
 eO_7                 5.023174e-01 1 1  ON 27
 eO_8                 1.940283e-01 1 1  ON 28
 eO_9                 6.115879e-02 1 1  ON 29
eH1_0                -2.117026e-01 1 1  ON 30
eH1_1                -1.328936e-01 1 1  ON 31
eH1_2                -9.152916e-02 1 1  ON 32
eH1_3                -5.389469e-02 1 1  ON 33
eH1_4                -7.381069e-03 1 1  ON 34
eH1_5                 4.683056e-03 1 1  ON 35
eH1_6                 4.147084e-02 1 1  ON 36
eH1_7                 6.408149e-02 1 1  ON 37
eH1_8                 1.798817e-01 1 1  ON 38
eH1_9                 1.209953e-01 1 1  ON 39
eH2_0                -2.068718e-01 1 1  ON 40
eH2_1                -1.281037e-01 1 1  ON 41
eH2_2                -8.651964e-02 1 1  ON 42
eH2_3                -4.903347e-02 1 1  ON 43
eH2_4                -2.792536e-03 1 1  ON 44
eH2_5                 9.053046e-03 1 1  ON 45
eH2_6                 4.678893e-02 1 1  ON 46
eH2_7                 4.633053e-02 1 1  ON 47
eH2_8                 1.982601e-01 1 1  ON 48
eH2_9                 1.201482e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1846
    reference variance = 0.441158
====================================================
  Execution time = 2.0749e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2220e-01
  Total weights = 2.0000e+06
  Execution time = 1.8846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322195821461
                                         uncertainty =       0.005209237871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322195821461
                                         uncertainty =       0.005209237871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401338760
  error estimate for blocks of size 2^( 2) =       0.000410873573
  error estimate for blocks of size 2^( 3) =       0.000419150629
  error estimate for blocks of size 2^( 4) =       0.000425526285
  error estimate for blocks of size 2^( 5) =       0.000429460852
  error estimate for blocks of size 2^( 6) =       0.000433198563
  error estimate for blocks of size 2^( 7) =       0.000434480969

      target function =                  N/A
              le_mean =     -17.216115474214
             les_mean =     296.716777460856
             stat err =       0.000430666667
             autocorr =       1.151490370037
              std dev =       0.567578717412
             le_variance =       0.322145600459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322387162315
                                         uncertainty =       0.005212348347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322387162315
                                         uncertainty =       0.005212348347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401457890
  error estimate for blocks of size 2^( 2) =       0.000410989265
  error estimate for blocks of size 2^( 3) =       0.000419262404
  error estimate for blocks of size 2^( 4) =       0.000425633500
  error estimate for blocks of size 2^( 5) =       0.000429564664
  error estimate for blocks of size 2^( 6) =       0.000433304656
  error estimate for blocks of size 2^( 7) =       0.000434586688

      target function =                  N/A
              le_mean =     -17.216116057594
             les_mean =     296.716988822351
             stat err =       0.000430772377
             autocorr =       1.151372090722
              std dev =       0.567747192822
             le_variance =       0.322336874957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322307117902
                                         uncertainty =       0.005211078874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322307117902
                                         uncertainty =       0.005211078874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401408058
  error estimate for blocks of size 2^( 2) =       0.000410940860
  error estimate for blocks of size 2^( 3) =       0.000419215716
  error estimate for blocks of size 2^( 4) =       0.000425588753
  error estimate for blocks of size 2^( 5) =       0.000429521408
  error estimate for blocks of size 2^( 6) =       0.000433260357
  error estimate for blocks of size 2^( 7) =       0.000434542415

      target function =                  N/A
              le_mean =     -17.216115748188
             les_mean =     296.716898152593
             stat err =       0.000430728233
             autocorr =       1.151421953321
              std dev =       0.567676720252
             le_variance =       0.322256858716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322210367013
                                         uncertainty =       0.005209479532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322210367013
                                         uncertainty =       0.005209479532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401347817
  error estimate for blocks of size 2^( 2) =       0.000410882366
  error estimate for blocks of size 2^( 3) =       0.000419159137
  error estimate for blocks of size 2^( 4) =       0.000425534451
  error estimate for blocks of size 2^( 5) =       0.000429468771
  error estimate for blocks of size 2^( 6) =       0.000433206640
  error estimate for blocks of size 2^( 7) =       0.000434488993

      target function =                  N/A
              le_mean =     -17.216115505036
             les_mean =     296.716793062703
             stat err =       0.000430674714
             autocorr =       1.151481424385
              std dev =       0.567591526569
             le_variance =       0.322160141033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216115474214        initial
     9.7656e-01     9.7656e+00             2.6777e-04       -17.216116057594  <--
     3.9062e+00     3.9062e+01             6.9059e-05       -17.216115748188
     1.5625e+01     1.5625e+02             1.7369e-05       -17.216115505036

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.0284e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.908909e-01 1 1  ON 0
 uu_1                 2.816056e-02 1 1  ON 1
 uu_2                -6.769843e-02 1 1  ON 2
 uu_3                -1.244201e-01 1 1  ON 3
 uu_4                -1.604268e-01 1 1  ON 4
 uu_5                -1.723684e-01 1 1  ON 5
 uu_6                -1.594956e-01 1 1  ON 6
 uu_7                -1.135979e-01 1 1  ON 7
 uu_8                -3.691751e-02 1 1  ON 8
 uu_9                 1.618777e-01 1 1  ON 9
 ud_0                 3.491593e-01 1 1  ON 10
 ud_1                 9.068458e-02 1 1  ON 11
 ud_2                -1.901449e-02 1 1  ON 12
 ud_3                -8.083370e-02 1 1  ON 13
 ud_4                -1.307490e-01 1 1  ON 14
 ud_5                -1.678004e-01 1 1  ON 15
 ud_6                -1.808289e-01 1 1  ON 16
 ud_7                -1.595499e-01 1 1  ON 17
 ud_8                -9.927897e-02 1 1  ON 18
 ud_9                -8.478014e-03 1 1  ON 19
 eO_0                -9.250917e-01 1 1  ON 20
 eO_1                -6.029448e-01 1 1  ON 21
 eO_2                -1.886666e-01 1 1  ON 22
 eO_3                 8.036107e-02 1 1  ON 23
 eO_4                 2.052828e-01 1 1  ON 24
 eO_5                 2.935892e-01 1 1  ON 25
 eO_6                 3.341700e-01 1 1  ON 26
 eO_7                 5.023134e-01 1 1  ON 27
 eO_8                 1.940385e-01 1 1  ON 28
 eO_9                 6.116483e-02 1 1  ON 29
eH1_0                -2.116386e-01 1 1  ON 30
eH1_1                -1.328757e-01 1 1  ON 31
eH1_2                -9.153672e-02 1 1  ON 32
eH1_3                -5.392990e-02 1 1  ON 33
eH1_4                -7.412098e-03 1 1  ON 34
eH1_5                 4.693783e-03 1 1  ON 35
eH1_6                 4.144729e-02 1 1  ON 36
eH1_7                 6.407156e-02 1 1  ON 37
eH1_8                 1.798850e-01 1 1  ON 38
eH1_9                 1.209999e-01 1 1  ON 39
eH2_0                -2.068344e-01 1 1  ON 40
eH2_1                -1.280800e-01 1 1  ON 41
eH2_2                -8.655266e-02 1 1  ON 42
eH2_3                -4.907257e-02 1 1  ON 43
eH2_4                -2.835859e-03 1 1  ON 44
eH2_5                 9.069005e-03 1 1  ON 45
eH2_6                 4.678912e-02 1 1  ON 46
eH2_7                 4.635827e-02 1 1  ON 47
eH2_8                 1.982626e-01 1 1  ON 48
eH2_9                 1.201537e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7627e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.19869
====================================================
  Execution time = 2.1725e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325900493636
                                         uncertainty =       0.003984345573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325900493636
                                         uncertainty =       0.003984345573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403672430
  error estimate for blocks of size 2^( 2) =       0.000413248793
  error estimate for blocks of size 2^( 3) =       0.000421539571
  error estimate for blocks of size 2^( 4) =       0.000427220398
  error estimate for blocks of size 2^( 5) =       0.000431029996
  error estimate for blocks of size 2^( 6) =       0.000433978206
  error estimate for blocks of size 2^( 7) =       0.000434630598

      target function =                  N/A
              le_mean =     -17.216653935803
             les_mean =     296.739075443336
             stat err =       0.000431714800
             autocorr =       1.143762086667
              std dev =       0.570879024916
             le_variance =       0.325902861089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665393580e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216653935803       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216654283064       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216655149687       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216654809107       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216655474326       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216655693379       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216655777116       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216655276697       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216655294725       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 9.945890e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216653935803       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216654072722       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216654428158       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216654428869       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216654678809       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216654695633       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216654661908       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216654553614       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.184142e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216653935803       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216653975804       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216654081060       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216654102000       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216654188356       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216654177457       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216654159169       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 8.579697e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7274e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.908817e-01 1 1  ON 0
 uu_1                 2.815513e-02 1 1  ON 1
 uu_2                -6.765891e-02 1 1  ON 2
 uu_3                -1.244350e-01 1 1  ON 3
 uu_4                -1.604145e-01 1 1  ON 4
 uu_5                -1.723661e-01 1 1  ON 5
 uu_6                -1.595539e-01 1 1  ON 6
 uu_7                -1.135983e-01 1 1  ON 7
 uu_8                -3.691020e-02 1 1  ON 8
 uu_9                 1.618679e-01 1 1  ON 9
 ud_0                 3.492322e-01 1 1  ON 10
 ud_1                 9.074202e-02 1 1  ON 11
 ud_2                -1.900223e-02 1 1  ON 12
 ud_3                -8.088762e-02 1 1  ON 13
 ud_4                -1.308736e-01 1 1  ON 14
 ud_5                -1.678352e-01 1 1  ON 15
 ud_6                -1.807851e-01 1 1  ON 16
 ud_7                -1.595054e-01 1 1  ON 17
 ud_8                -9.931113e-02 1 1  ON 18
 ud_9                -8.484924e-03 1 1  ON 19
 eO_0                -9.253617e-01 1 1  ON 20
 eO_1                -6.030647e-01 1 1  ON 21
 eO_2                -1.886890e-01 1 1  ON 22
 eO_3                 8.067949e-02 1 1  ON 23
 eO_4                 2.053945e-01 1 1  ON 24
 eO_5                 2.935936e-01 1 1  ON 25
 eO_6                 3.341333e-01 1 1  ON 26
 eO_7                 5.022986e-01 1 1  ON 27
 eO_8                 1.940586e-01 1 1  ON 28
 eO_9                 6.117182e-02 1 1  ON 29
eH1_0                -2.117271e-01 1 1  ON 30
eH1_1                -1.328804e-01 1 1  ON 31
eH1_2                -9.147098e-02 1 1  ON 32
eH1_3                -5.400089e-02 1 1  ON 33
eH1_4                -7.397655e-03 1 1  ON 34
eH1_5                 4.786479e-03 1 1  ON 35
eH1_6                 4.148537e-02 1 1  ON 36
eH1_7                 6.402064e-02 1 1  ON 37
eH1_8                 1.798776e-01 1 1  ON 38
eH1_9                 1.210066e-01 1 1  ON 39
eH2_0                -2.069035e-01 1 1  ON 40
eH2_1                -1.280965e-01 1 1  ON 41
eH2_2                -8.659102e-02 1 1  ON 42
eH2_3                -4.898465e-02 1 1  ON 43
eH2_4                -2.811033e-03 1 1  ON 44
eH2_5                 9.060999e-03 1 1  ON 45
eH2_6                 4.678226e-02 1 1  ON 46
eH2_7                 4.638134e-02 1 1  ON 47
eH2_8                 1.982539e-01 1 1  ON 48
eH2_9                 1.201590e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1756
    reference variance = 0.339305
====================================================
  Execution time = 2.1237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1695e-01
  Total weights = 2.0000e+06
  Execution time = 1.8767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317003926838
                                         uncertainty =       0.003094587587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317003926838
                                         uncertainty =       0.003094587587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398075751
  error estimate for blocks of size 2^( 2) =       0.000408036268
  error estimate for blocks of size 2^( 3) =       0.000417088982
  error estimate for blocks of size 2^( 4) =       0.000422921264
  error estimate for blocks of size 2^( 5) =       0.000426422485
  error estimate for blocks of size 2^( 6) =       0.000427360762
  error estimate for blocks of size 2^( 7) =       0.000428645629

      target function =                  N/A
              le_mean =     -17.215772569901
             les_mean =     296.699753627117
             stat err =       0.000426337535
             autocorr =       1.147032421631
              std dev =       0.562964125881
             le_variance =       0.316928607029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317125921172
                                         uncertainty =       0.003095512902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317125921172
                                         uncertainty =       0.003095512902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398152290
  error estimate for blocks of size 2^( 2) =       0.000408109915
  error estimate for blocks of size 2^( 3) =       0.000417160831
  error estimate for blocks of size 2^( 4) =       0.000422988060
  error estimate for blocks of size 2^( 5) =       0.000426483128
  error estimate for blocks of size 2^( 6) =       0.000427419110
  error estimate for blocks of size 2^( 7) =       0.000428706885

      target function =                  N/A
              le_mean =     -17.215771282901
             les_mean =     296.699831199161
             stat err =       0.000426399296
             autocorr =       1.146923684179
              std dev =       0.563072368808
             le_variance =       0.317050492515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055920764
                                         uncertainty =       0.003094812296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055920764
                                         uncertainty =       0.003094812296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398108369
  error estimate for blocks of size 2^( 2) =       0.000408067516
  error estimate for blocks of size 2^( 3) =       0.000417120049
  error estimate for blocks of size 2^( 4) =       0.000422949765
  error estimate for blocks of size 2^( 5) =       0.000426446965
  error estimate for blocks of size 2^( 6) =       0.000427382061
  error estimate for blocks of size 2^( 7) =       0.000428669272

      target function =                  N/A
              le_mean =     -17.215771418077
             les_mean =     296.699765907222
             stat err =       0.000426362016
             autocorr =       1.146976183352
              std dev =       0.563010254126
             le_variance =       0.316980546251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317007180352
                                         uncertainty =       0.003094576234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317007180352
                                         uncertainty =       0.003094576234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398077790
  error estimate for blocks of size 2^( 2) =       0.000408038217
  error estimate for blocks of size 2^( 3) =       0.000417091012
  error estimate for blocks of size 2^( 4) =       0.000422922999
  error estimate for blocks of size 2^( 5) =       0.000426423705
  error estimate for blocks of size 2^( 6) =       0.000427361427
  error estimate for blocks of size 2^( 7) =       0.000428646693

      target function =                  N/A
              le_mean =     -17.215772356550
             les_mean =     296.699749528519
             stat err =       0.000426338706
             autocorr =       1.147026969554
              std dev =       0.562967010082
             le_variance =       0.316931854441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215772569901        initial  <--
     2.4414e-01     2.4414e+00             9.9459e-04       -17.215771282901
     9.7656e-01     9.7656e+00             3.1841e-04       -17.215771418077
     3.9062e+00     3.9062e+01             8.5797e-05       -17.215772356550

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7236
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.908909e-01 1 1  ON 0
 uu_1                 2.816056e-02 1 1  ON 1
 uu_2                -6.769843e-02 1 1  ON 2
 uu_3                -1.244201e-01 1 1  ON 3
 uu_4                -1.604268e-01 1 1  ON 4
 uu_5                -1.723684e-01 1 1  ON 5
 uu_6                -1.594956e-01 1 1  ON 6
 uu_7                -1.135979e-01 1 1  ON 7
 uu_8                -3.691751e-02 1 1  ON 8
 uu_9                 1.618777e-01 1 1  ON 9
 ud_0                 3.491593e-01 1 1  ON 10
 ud_1                 9.068458e-02 1 1  ON 11
 ud_2                -1.901449e-02 1 1  ON 12
 ud_3                -8.083370e-02 1 1  ON 13
 ud_4                -1.307490e-01 1 1  ON 14
 ud_5                -1.678004e-01 1 1  ON 15
 ud_6                -1.808289e-01 1 1  ON 16
 ud_7                -1.595499e-01 1 1  ON 17
 ud_8                -9.927897e-02 1 1  ON 18
 ud_9                -8.478014e-03 1 1  ON 19
 eO_0                -9.250917e-01 1 1  ON 20
 eO_1                -6.029448e-01 1 1  ON 21
 eO_2                -1.886666e-01 1 1  ON 22
 eO_3                 8.036107e-02 1 1  ON 23
 eO_4                 2.052828e-01 1 1  ON 24
 eO_5                 2.935892e-01 1 1  ON 25
 eO_6                 3.341700e-01 1 1  ON 26
 eO_7                 5.023134e-01 1 1  ON 27
 eO_8                 1.940385e-01 1 1  ON 28
 eO_9                 6.116483e-02 1 1  ON 29
eH1_0                -2.116386e-01 1 1  ON 30
eH1_1                -1.328757e-01 1 1  ON 31
eH1_2                -9.153672e-02 1 1  ON 32
eH1_3                -5.392990e-02 1 1  ON 33
eH1_4                -7.412098e-03 1 1  ON 34
eH1_5                 4.693783e-03 1 1  ON 35
eH1_6                 4.144729e-02 1 1  ON 36
eH1_7                 6.407156e-02 1 1  ON 37
eH1_8                 1.798850e-01 1 1  ON 38
eH1_9                 1.209999e-01 1 1  ON 39
eH2_0                -2.068344e-01 1 1  ON 40
eH2_1                -1.280800e-01 1 1  ON 41
eH2_2                -8.655266e-02 1 1  ON 42
eH2_3                -4.907257e-02 1 1  ON 43
eH2_4                -2.835859e-03 1 1  ON 44
eH2_5                 9.069005e-03 1 1  ON 45
eH2_6                 4.678912e-02 1 1  ON 46
eH2_7                 4.635827e-02 1 1  ON 47
eH2_8                 1.982626e-01 1 1  ON 48
eH2_9                 1.201537e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8004e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2029
    reference variance = 0.212313
====================================================
  Execution time = 2.1474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1982e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319857838575
                                         uncertainty =       0.003994536768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319857838575
                                         uncertainty =       0.003994536768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399886037
  error estimate for blocks of size 2^( 2) =       0.000409165649
  error estimate for blocks of size 2^( 3) =       0.000417519248
  error estimate for blocks of size 2^( 4) =       0.000424423369
  error estimate for blocks of size 2^( 5) =       0.000429008735
  error estimate for blocks of size 2^( 6) =       0.000431723508
  error estimate for blocks of size 2^( 7) =       0.000430354591

      target function =                  N/A
              le_mean =     -17.217014439888
             les_mean =     296.745403748231
             stat err =       0.000428877550
             autocorr =       1.150255047959
              std dev =       0.565524256625
             le_variance =       0.319817684832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721701443989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217014439888       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217014679742       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217014780615       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217014843873       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217015020562       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217015104975       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217015061862       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.155048e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217014439888       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217014502706       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217014530196       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217014548165       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217014602143       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217014618322       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217014608637       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.998113e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217014439888       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217014455781       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217014462817       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217014467470       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217014481699       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217014485418       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217014483076       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 7.569230e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154455 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9312e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.908966e-01 1 1  ON 0
 uu_1                 2.816373e-02 1 1  ON 1
 uu_2                -6.769214e-02 1 1  ON 2
 uu_3                -1.244185e-01 1 1  ON 3
 uu_4                -1.604333e-01 1 1  ON 4
 uu_5                -1.723736e-01 1 1  ON 5
 uu_6                -1.595031e-01 1 1  ON 6
 uu_7                -1.135992e-01 1 1  ON 7
 uu_8                -3.691687e-02 1 1  ON 8
 uu_9                 1.618770e-01 1 1  ON 9
 ud_0                 3.491743e-01 1 1  ON 10
 ud_1                 9.069811e-02 1 1  ON 11
 ud_2                -1.901749e-02 1 1  ON 12
 ud_3                -8.083936e-02 1 1  ON 13
 ud_4                -1.307577e-01 1 1  ON 14
 ud_5                -1.677939e-01 1 1  ON 15
 ud_6                -1.808358e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.928647e-02 1 1  ON 18
 ud_9                -8.478229e-03 1 1  ON 19
 eO_0                -9.251217e-01 1 1  ON 20
 eO_1                -6.029534e-01 1 1  ON 21
 eO_2                -1.886604e-01 1 1  ON 22
 eO_3                 8.038770e-02 1 1  ON 23
 eO_4                 2.052967e-01 1 1  ON 24
 eO_5                 2.935849e-01 1 1  ON 25
 eO_6                 3.341651e-01 1 1  ON 26
 eO_7                 5.023117e-01 1 1  ON 27
 eO_8                 1.940401e-01 1 1  ON 28
 eO_9                 6.116572e-02 1 1  ON 29
eH1_0                -2.116424e-01 1 1  ON 30
eH1_1                -1.328796e-01 1 1  ON 31
eH1_2                -9.153902e-02 1 1  ON 32
eH1_3                -5.392443e-02 1 1  ON 33
eH1_4                -7.406344e-03 1 1  ON 34
eH1_5                 4.695947e-03 1 1  ON 35
eH1_6                 4.144683e-02 1 1  ON 36
eH1_7                 6.406826e-02 1 1  ON 37
eH1_8                 1.798847e-01 1 1  ON 38
eH1_9                 1.210002e-01 1 1  ON 39
eH2_0                -2.068388e-01 1 1  ON 40
eH2_1                -1.280787e-01 1 1  ON 41
eH2_2                -8.655454e-02 1 1  ON 42
eH2_3                -4.907592e-02 1 1  ON 43
eH2_4                -2.838585e-03 1 1  ON 44
eH2_5                 9.078109e-03 1 1  ON 45
eH2_6                 4.679180e-02 1 1  ON 46
eH2_7                 4.635871e-02 1 1  ON 47
eH2_8                 1.982605e-01 1 1  ON 48
eH2_9                 1.201538e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2676
    reference variance = 0.357096
====================================================
  Execution time = 2.0826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2114e-01
  Total weights = 2.0000e+06
  Execution time = 1.8951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320990213829
                                         uncertainty =       0.004375474643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320990213829
                                         uncertainty =       0.004375474643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400701328
  error estimate for blocks of size 2^( 2) =       0.000409675113
  error estimate for blocks of size 2^( 3) =       0.000417341622
  error estimate for blocks of size 2^( 4) =       0.000422505527
  error estimate for blocks of size 2^( 5) =       0.000425767135
  error estimate for blocks of size 2^( 6) =       0.000427205755
  error estimate for blocks of size 2^( 7) =       0.000432246679

      target function =                  N/A
              le_mean =     -17.216602812969
             les_mean =     296.732535367872
             stat err =       0.000426931274
             autocorr =       1.135205205407
              std dev =       0.566677252846
             le_variance =       0.321123108893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321038182766
                                         uncertainty =       0.004376005371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321038182766
                                         uncertainty =       0.004376005371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400731246
  error estimate for blocks of size 2^( 2) =       0.000409703213
  error estimate for blocks of size 2^( 3) =       0.000417367754
  error estimate for blocks of size 2^( 4) =       0.000422530299
  error estimate for blocks of size 2^( 5) =       0.000425790524
  error estimate for blocks of size 2^( 6) =       0.000427230549
  error estimate for blocks of size 2^( 7) =       0.000432272947

      target function =                  N/A
              le_mean =     -17.216602956990
             les_mean =     296.732588281741
             stat err =       0.000426956080
             autocorr =       1.135167607582
              std dev =       0.566719563533
             le_variance =       0.321171063691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321014581278
                                         uncertainty =       0.004375748438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321014581278
                                         uncertainty =       0.004375748438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400716524
  error estimate for blocks of size 2^( 2) =       0.000409689345
  error estimate for blocks of size 2^( 3) =       0.000417354829
  error estimate for blocks of size 2^( 4) =       0.000422518045
  error estimate for blocks of size 2^( 5) =       0.000425778910
  error estimate for blocks of size 2^( 6) =       0.000427218318
  error estimate for blocks of size 2^( 7) =       0.000432260083

      target function =                  N/A
              le_mean =     -17.216602885951
             les_mean =     296.732562237963
             stat err =       0.000426943839
             autocorr =       1.135185924835
              std dev =       0.566698743603
             le_variance =       0.321147466001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320993262634
                                         uncertainty =       0.004375509087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320993262634
                                         uncertainty =       0.004375509087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400703230
  error estimate for blocks of size 2^( 2) =       0.000409676892
  error estimate for blocks of size 2^( 3) =       0.000417343272
  error estimate for blocks of size 2^( 4) =       0.000422507089
  error estimate for blocks of size 2^( 5) =       0.000425768603
  error estimate for blocks of size 2^( 6) =       0.000427207324
  error estimate for blocks of size 2^( 7) =       0.000432248357

      target function =                  N/A
              le_mean =     -17.216602821790
             les_mean =     296.732538718990
             stat err =       0.000426932844
             autocorr =       1.135202781387
              std dev =       0.566679941666
             le_variance =       0.321126156287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216602812969        initial
     2.4414e+00     2.4414e+01             1.1550e-04       -17.216602956990  <--
     9.7656e+00     9.7656e+01             2.9981e-05       -17.216602885951
     3.9062e+01     3.9062e+02             7.5692e-06       -17.216602821790

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 3.0331e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.909141e-01 1 1  ON 0
 uu_1                 2.817490e-02 1 1  ON 1
 uu_2                -6.767576e-02 1 1  ON 2
 uu_3                -1.244131e-01 1 1  ON 3
 uu_4                -1.604516e-01 1 1  ON 4
 uu_5                -1.723896e-01 1 1  ON 5
 uu_6                -1.595257e-01 1 1  ON 6
 uu_7                -1.136031e-01 1 1  ON 7
 uu_8                -3.691506e-02 1 1  ON 8
 uu_9                 1.618750e-01 1 1  ON 9
 ud_0                 3.492190e-01 1 1  ON 10
 ud_1                 9.073444e-02 1 1  ON 11
 ud_2                -1.902304e-02 1 1  ON 12
 ud_3                -8.085627e-02 1 1  ON 13
 ud_4                -1.307823e-01 1 1  ON 14
 ud_5                -1.677764e-01 1 1  ON 15
 ud_6                -1.808557e-01 1 1  ON 16
 ud_7                -1.595733e-01 1 1  ON 17
 ud_8                -9.930845e-02 1 1  ON 18
 ud_9                -8.478877e-03 1 1  ON 19
 eO_0                -9.252072e-01 1 1  ON 20
 eO_1                -6.029793e-01 1 1  ON 21
 eO_2                -1.886424e-01 1 1  ON 22
 eO_3                 8.046486e-02 1 1  ON 23
 eO_4                 2.053370e-01 1 1  ON 24
 eO_5                 2.935719e-01 1 1  ON 25
 eO_6                 3.341506e-01 1 1  ON 26
 eO_7                 5.023068e-01 1 1  ON 27
 eO_8                 1.940448e-01 1 1  ON 28
 eO_9                 6.116833e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328909e-01 1 1  ON 31
eH1_2                -9.154434e-02 1 1  ON 32
eH1_3                -5.390975e-02 1 1  ON 33
eH1_4                -7.389281e-03 1 1  ON 34
eH1_5                 4.702322e-03 1 1  ON 35
eH1_6                 4.144535e-02 1 1  ON 36
eH1_7                 6.405853e-02 1 1  ON 37
eH1_8                 1.798837e-01 1 1  ON 38
eH1_9                 1.210009e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280761e-01 1 1  ON 41
eH2_2                -8.655982e-02 1 1  ON 42
eH2_3                -4.908499e-02 1 1  ON 43
eH2_4                -2.846495e-03 1 1  ON 44
eH2_5                 9.104712e-03 1 1  ON 45
eH2_6                 4.679972e-02 1 1  ON 46
eH2_7                 4.635996e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2776
    reference variance = 0.400264
====================================================
  Execution time = 2.3284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324309785089
                                         uncertainty =       0.005172607367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324309785089
                                         uncertainty =       0.005172607367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402679608
  error estimate for blocks of size 2^( 2) =       0.000412248461
  error estimate for blocks of size 2^( 3) =       0.000421204709
  error estimate for blocks of size 2^( 4) =       0.000427061131
  error estimate for blocks of size 2^( 5) =       0.000432016151
  error estimate for blocks of size 2^( 6) =       0.000432833398
  error estimate for blocks of size 2^( 7) =       0.000434064567

      target function =                  N/A
              le_mean =     -17.217529135098
             les_mean =     296.767611088597
             stat err =       0.000431493812
             autocorr =       1.148232590676
              std dev =       0.569474962387
             le_variance =       0.324301732785


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721752913510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217529135098       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217528610207       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217528536704       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217528477878       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217529969902       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217529690082       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217529765349       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217529874842       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.390922e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217529135098       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217528960951       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217528843905       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217528844348       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217529292951       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217529225939       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217529266311       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.241579e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217529135098       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217529087684       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217529045398       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217529056739       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217529163950       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217529150841       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217529164040       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.245797e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8878e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.909049e-01 1 1  ON 0
 uu_1                 2.820092e-02 1 1  ON 1
 uu_2                -6.770894e-02 1 1  ON 2
 uu_3                -1.243870e-01 1 1  ON 3
 uu_4                -1.604559e-01 1 1  ON 4
 uu_5                -1.723984e-01 1 1  ON 5
 uu_6                -1.595295e-01 1 1  ON 6
 uu_7                -1.136086e-01 1 1  ON 7
 uu_8                -3.691007e-02 1 1  ON 8
 uu_9                 1.618675e-01 1 1  ON 9
 ud_0                 3.492465e-01 1 1  ON 10
 ud_1                 9.074109e-02 1 1  ON 11
 ud_2                -1.900390e-02 1 1  ON 12
 ud_3                -8.090331e-02 1 1  ON 13
 ud_4                -1.308025e-01 1 1  ON 14
 ud_5                -1.678118e-01 1 1  ON 15
 ud_6                -1.808157e-01 1 1  ON 16
 ud_7                -1.595846e-01 1 1  ON 17
 ud_8                -9.931506e-02 1 1  ON 18
 ud_9                -8.469842e-03 1 1  ON 19
 eO_0                -9.253314e-01 1 1  ON 20
 eO_1                -6.030226e-01 1 1  ON 21
 eO_2                -1.885928e-01 1 1  ON 22
 eO_3                 8.056256e-02 1 1  ON 23
 eO_4                 2.053834e-01 1 1  ON 24
 eO_5                 2.935450e-01 1 1  ON 25
 eO_6                 3.341430e-01 1 1  ON 26
 eO_7                 5.023009e-01 1 1  ON 27
 eO_8                 1.940536e-01 1 1  ON 28
 eO_9                 6.117130e-02 1 1  ON 29
eH1_0                -2.116644e-01 1 1  ON 30
eH1_1                -1.329290e-01 1 1  ON 31
eH1_2                -9.151907e-02 1 1  ON 32
eH1_3                -5.389837e-02 1 1  ON 33
eH1_4                -7.400656e-03 1 1  ON 34
eH1_5                 4.713214e-03 1 1  ON 35
eH1_6                 4.145896e-02 1 1  ON 36
eH1_7                 6.405293e-02 1 1  ON 37
eH1_8                 1.798830e-01 1 1  ON 38
eH1_9                 1.210032e-01 1 1  ON 39
eH2_0                -2.068727e-01 1 1  ON 40
eH2_1                -1.280375e-01 1 1  ON 41
eH2_2                -8.653690e-02 1 1  ON 42
eH2_3                -4.904980e-02 1 1  ON 43
eH2_4                -2.900187e-03 1 1  ON 44
eH2_5                 9.083973e-03 1 1  ON 45
eH2_6                 4.678778e-02 1 1  ON 46
eH2_7                 4.636584e-02 1 1  ON 47
eH2_8                 1.982516e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2437
    reference variance = 0.476661
====================================================
  Execution time = 2.0795e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1788e-01
  Total weights = 2.0000e+06
  Execution time = 1.8836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317792170106
                                         uncertainty =       0.003353789117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317792170106
                                         uncertainty =       0.003353789117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398661672
  error estimate for blocks of size 2^( 2) =       0.000408489914
  error estimate for blocks of size 2^( 3) =       0.000416843687
  error estimate for blocks of size 2^( 4) =       0.000422448507
  error estimate for blocks of size 2^( 5) =       0.000425842088
  error estimate for blocks of size 2^( 6) =       0.000427627469
  error estimate for blocks of size 2^( 7) =       0.000427410038

      target function =                  N/A
              le_mean =     -17.216644814494
             les_mean =     296.730720767735
             stat err =       0.000425832025
             autocorr =       1.140952781996
              std dev =       0.563792744040
             le_variance =       0.317862258232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317860703512
                                         uncertainty =       0.003354258989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317860703512
                                         uncertainty =       0.003354258989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398704681
  error estimate for blocks of size 2^( 2) =       0.000408531961
  error estimate for blocks of size 2^( 3) =       0.000416883154
  error estimate for blocks of size 2^( 4) =       0.000422485645
  error estimate for blocks of size 2^( 5) =       0.000425877682
  error estimate for blocks of size 2^( 6) =       0.000427660618
  error estimate for blocks of size 2^( 7) =       0.000427448794

      target function =                  N/A
              le_mean =     -17.216644128552
             les_mean =     296.730765735063
             stat err =       0.000425868185
             autocorr =       1.140900380318
              std dev =       0.563853566820
             le_variance =       0.317930844815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317827180686
                                         uncertainty =       0.003353981691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317827180686
                                         uncertainty =       0.003353981691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398683647
  error estimate for blocks of size 2^( 2) =       0.000408511600
  error estimate for blocks of size 2^( 3) =       0.000416863794
  error estimate for blocks of size 2^( 4) =       0.000422467287
  error estimate for blocks of size 2^( 5) =       0.000425859911
  error estimate for blocks of size 2^( 6) =       0.000427643697
  error estimate for blocks of size 2^( 7) =       0.000427430588

      target function =                  N/A
              le_mean =     -17.216644371340
             les_mean =     296.730740551734
             stat err =       0.000425850371
             autocorr =       1.140925308211
              std dev =       0.563823821329
             le_variance =       0.317897301498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317796738767
                                         uncertainty =       0.003353814032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317796738767
                                         uncertainty =       0.003353814032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398664540
  error estimate for blocks of size 2^( 2) =       0.000408492751
  error estimate for blocks of size 2^( 3) =       0.000416846309
  error estimate for blocks of size 2^( 4) =       0.000422450944
  error estimate for blocks of size 2^( 5) =       0.000425844397
  error estimate for blocks of size 2^( 6) =       0.000427629558
  error estimate for blocks of size 2^( 7) =       0.000427412775

      target function =                  N/A
              le_mean =     -17.216644742642
             les_mean =     296.730722866752
             stat err =       0.000425834418
             autocorr =       1.140949190402
              std dev =       0.563796799705
             le_variance =       0.317866831358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216644814494        initial  <--
     6.1035e-01     6.1035e+00             4.3909e-04       -17.216644128552
     2.4414e+00     2.4414e+01             1.2416e-04       -17.216644371340
     9.7656e+00     9.7656e+01             3.2458e-05       -17.216644742642

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3197
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.909141e-01 1 1  ON 0
 uu_1                 2.817490e-02 1 1  ON 1
 uu_2                -6.767576e-02 1 1  ON 2
 uu_3                -1.244131e-01 1 1  ON 3
 uu_4                -1.604516e-01 1 1  ON 4
 uu_5                -1.723896e-01 1 1  ON 5
 uu_6                -1.595257e-01 1 1  ON 6
 uu_7                -1.136031e-01 1 1  ON 7
 uu_8                -3.691506e-02 1 1  ON 8
 uu_9                 1.618750e-01 1 1  ON 9
 ud_0                 3.492190e-01 1 1  ON 10
 ud_1                 9.073444e-02 1 1  ON 11
 ud_2                -1.902304e-02 1 1  ON 12
 ud_3                -8.085627e-02 1 1  ON 13
 ud_4                -1.307823e-01 1 1  ON 14
 ud_5                -1.677764e-01 1 1  ON 15
 ud_6                -1.808557e-01 1 1  ON 16
 ud_7                -1.595733e-01 1 1  ON 17
 ud_8                -9.930845e-02 1 1  ON 18
 ud_9                -8.478877e-03 1 1  ON 19
 eO_0                -9.252072e-01 1 1  ON 20
 eO_1                -6.029793e-01 1 1  ON 21
 eO_2                -1.886424e-01 1 1  ON 22
 eO_3                 8.046486e-02 1 1  ON 23
 eO_4                 2.053370e-01 1 1  ON 24
 eO_5                 2.935719e-01 1 1  ON 25
 eO_6                 3.341506e-01 1 1  ON 26
 eO_7                 5.023068e-01 1 1  ON 27
 eO_8                 1.940448e-01 1 1  ON 28
 eO_9                 6.116833e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328909e-01 1 1  ON 31
eH1_2                -9.154434e-02 1 1  ON 32
eH1_3                -5.390975e-02 1 1  ON 33
eH1_4                -7.389281e-03 1 1  ON 34
eH1_5                 4.702322e-03 1 1  ON 35
eH1_6                 4.144535e-02 1 1  ON 36
eH1_7                 6.405853e-02 1 1  ON 37
eH1_8                 1.798837e-01 1 1  ON 38
eH1_9                 1.210009e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280761e-01 1 1  ON 41
eH2_2                -8.655982e-02 1 1  ON 42
eH2_3                -4.908499e-02 1 1  ON 43
eH2_4                -2.846495e-03 1 1  ON 44
eH2_5                 9.104712e-03 1 1  ON 45
eH2_6                 4.679972e-02 1 1  ON 46
eH2_7                 4.635996e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9205e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2668
    reference variance = 0.210706
====================================================
  Execution time = 2.1370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3137e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331463388590
                                         uncertainty =       0.010338321621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331463388590
                                         uncertainty =       0.010338321621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407043859
  error estimate for blocks of size 2^( 2) =       0.000416253872
  error estimate for blocks of size 2^( 3) =       0.000424841482
  error estimate for blocks of size 2^( 4) =       0.000430973099
  error estimate for blocks of size 2^( 5) =       0.000435116090
  error estimate for blocks of size 2^( 6) =       0.000437912646
  error estimate for blocks of size 2^( 7) =       0.000437363027

      target function =                  N/A
              le_mean =     -17.216384143209
             les_mean =     296.735252206390
             stat err =       0.000435341215
             autocorr =       1.143871284973
              std dev =       0.575646945214
             le_variance =       0.331369405534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638414321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216384143209       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216384134146       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216384090762       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216384063792       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216384174449       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216384125125       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216384149742       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.171710e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216384143209       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216384140891       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216384129884       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216384122618       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216384151606       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216384138903       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216384144515       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.053141e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216384143209       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216384142626       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216384139864       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216384138013       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216384145347       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216384142148       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216384143514       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.639139e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6949e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.909210e-01 1 1  ON 0
 uu_1                 2.817810e-02 1 1  ON 1
 uu_2                -6.767811e-02 1 1  ON 2
 uu_3                -1.244124e-01 1 1  ON 3
 uu_4                -1.604557e-01 1 1  ON 4
 uu_5                -1.723893e-01 1 1  ON 5
 uu_6                -1.595300e-01 1 1  ON 6
 uu_7                -1.136047e-01 1 1  ON 7
 uu_8                -3.691494e-02 1 1  ON 8
 uu_9                 1.618745e-01 1 1  ON 9
 ud_0                 3.492291e-01 1 1  ON 10
 ud_1                 9.073527e-02 1 1  ON 11
 ud_2                -1.902428e-02 1 1  ON 12
 ud_3                -8.086312e-02 1 1  ON 13
 ud_4                -1.307840e-01 1 1  ON 14
 ud_5                -1.677737e-01 1 1  ON 15
 ud_6                -1.808558e-01 1 1  ON 16
 ud_7                -1.595747e-01 1 1  ON 17
 ud_8                -9.931163e-02 1 1  ON 18
 ud_9                -8.479425e-03 1 1  ON 19
 eO_0                -9.252145e-01 1 1  ON 20
 eO_1                -6.029877e-01 1 1  ON 21
 eO_2                -1.886379e-01 1 1  ON 22
 eO_3                 8.047540e-02 1 1  ON 23
 eO_4                 2.053400e-01 1 1  ON 24
 eO_5                 2.935710e-01 1 1  ON 25
 eO_6                 3.341486e-01 1 1  ON 26
 eO_7                 5.023060e-01 1 1  ON 27
 eO_8                 1.940456e-01 1 1  ON 28
 eO_9                 6.116859e-02 1 1  ON 29
eH1_0                -2.116564e-01 1 1  ON 30
eH1_1                -1.328883e-01 1 1  ON 31
eH1_2                -9.154166e-02 1 1  ON 32
eH1_3                -5.390750e-02 1 1  ON 33
eH1_4                -7.392469e-03 1 1  ON 34
eH1_5                 4.701805e-03 1 1  ON 35
eH1_6                 4.144519e-02 1 1  ON 36
eH1_7                 6.405692e-02 1 1  ON 37
eH1_8                 1.798835e-01 1 1  ON 38
eH1_9                 1.210013e-01 1 1  ON 39
eH2_0                -2.068502e-01 1 1  ON 40
eH2_1                -1.280748e-01 1 1  ON 41
eH2_2                -8.656204e-02 1 1  ON 42
eH2_3                -4.907813e-02 1 1  ON 43
eH2_4                -2.848861e-03 1 1  ON 44
eH2_5                 9.098271e-03 1 1  ON 45
eH2_6                 4.679960e-02 1 1  ON 46
eH2_7                 4.636109e-02 1 1  ON 47
eH2_8                 1.982544e-01 1 1  ON 48
eH2_9                 1.201544e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2182
    reference variance = 0.190789
====================================================
  Execution time = 2.0920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.3121e-01
  Total weights = 2.0000e+06
  Execution time = 1.8845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331182915846
                                         uncertainty =       0.015336098468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331182915846
                                         uncertainty =       0.015336098468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406940495
  error estimate for blocks of size 2^( 2) =       0.000416243186
  error estimate for blocks of size 2^( 3) =       0.000424854748
  error estimate for blocks of size 2^( 4) =       0.000431470232
  error estimate for blocks of size 2^( 5) =       0.000434766505
  error estimate for blocks of size 2^( 6) =       0.000438118237
  error estimate for blocks of size 2^( 7) =       0.000439314665

      target function =                  N/A
              le_mean =     -17.217521854316
             les_mean =     296.774259771365
             stat err =       0.000435917410
             autocorr =       1.147483924584
              std dev =       0.575500767247
             le_variance =       0.331201133102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331227074667
                                         uncertainty =       0.015337314164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331227074667
                                         uncertainty =       0.015337314164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406967622
  error estimate for blocks of size 2^( 2) =       0.000416269119
  error estimate for blocks of size 2^( 3) =       0.000424879637
  error estimate for blocks of size 2^( 4) =       0.000431494715
  error estimate for blocks of size 2^( 5) =       0.000434790104
  error estimate for blocks of size 2^( 6) =       0.000438141860
  error estimate for blocks of size 2^( 7) =       0.000439338234

      target function =                  N/A
              le_mean =     -17.217521810940
             les_mean =     296.774302434962
             stat err =       0.000435941228
             autocorr =       1.147456341198
              std dev =       0.575539130202
             le_variance =       0.331245290394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331205836572
                                         uncertainty =       0.015336728595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331205836572
                                         uncertainty =       0.015336728595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406954575
  error estimate for blocks of size 2^( 2) =       0.000416256647
  error estimate for blocks of size 2^( 3) =       0.000424867669
  error estimate for blocks of size 2^( 4) =       0.000431482947
  error estimate for blocks of size 2^( 5) =       0.000434778760
  error estimate for blocks of size 2^( 6) =       0.000438130499
  error estimate for blocks of size 2^( 7) =       0.000439326905

      target function =                  N/A
              le_mean =     -17.217521833288
             les_mean =     296.774281967106
             stat err =       0.000435929778
             autocorr =       1.147469632600
              std dev =       0.575520679879
             le_variance =       0.331224052969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331185807994
                                         uncertainty =       0.015336177972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331185807994
                                         uncertainty =       0.015336177972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406942272
  error estimate for blocks of size 2^( 2) =       0.000416244884
  error estimate for blocks of size 2^( 3) =       0.000424856378
  error estimate for blocks of size 2^( 4) =       0.000431471836
  error estimate for blocks of size 2^( 5) =       0.000434768051
  error estimate for blocks of size 2^( 6) =       0.000438119784
  error estimate for blocks of size 2^( 7) =       0.000439316209

      target function =                  N/A
              le_mean =     -17.217521851605
             les_mean =     296.774262570049
             stat err =       0.000435918970
             autocorr =       1.147482121138
              std dev =       0.575503279867
             le_variance =       0.331204025138


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217521854316        initial  <--
     6.1035e+00     6.1035e+01             4.1717e-05       -17.217521810940
     2.4414e+01     2.4414e+02             1.0531e-05       -17.217521833288
     9.7656e+01     9.7656e+02             2.6391e-06       -17.217521851605

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4377
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.909141e-01 1 1  ON 0
 uu_1                 2.817490e-02 1 1  ON 1
 uu_2                -6.767576e-02 1 1  ON 2
 uu_3                -1.244131e-01 1 1  ON 3
 uu_4                -1.604516e-01 1 1  ON 4
 uu_5                -1.723896e-01 1 1  ON 5
 uu_6                -1.595257e-01 1 1  ON 6
 uu_7                -1.136031e-01 1 1  ON 7
 uu_8                -3.691506e-02 1 1  ON 8
 uu_9                 1.618750e-01 1 1  ON 9
 ud_0                 3.492190e-01 1 1  ON 10
 ud_1                 9.073444e-02 1 1  ON 11
 ud_2                -1.902304e-02 1 1  ON 12
 ud_3                -8.085627e-02 1 1  ON 13
 ud_4                -1.307823e-01 1 1  ON 14
 ud_5                -1.677764e-01 1 1  ON 15
 ud_6                -1.808557e-01 1 1  ON 16
 ud_7                -1.595733e-01 1 1  ON 17
 ud_8                -9.930845e-02 1 1  ON 18
 ud_9                -8.478877e-03 1 1  ON 19
 eO_0                -9.252072e-01 1 1  ON 20
 eO_1                -6.029793e-01 1 1  ON 21
 eO_2                -1.886424e-01 1 1  ON 22
 eO_3                 8.046486e-02 1 1  ON 23
 eO_4                 2.053370e-01 1 1  ON 24
 eO_5                 2.935719e-01 1 1  ON 25
 eO_6                 3.341506e-01 1 1  ON 26
 eO_7                 5.023068e-01 1 1  ON 27
 eO_8                 1.940448e-01 1 1  ON 28
 eO_9                 6.116833e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328909e-01 1 1  ON 31
eH1_2                -9.154434e-02 1 1  ON 32
eH1_3                -5.390975e-02 1 1  ON 33
eH1_4                -7.389281e-03 1 1  ON 34
eH1_5                 4.702322e-03 1 1  ON 35
eH1_6                 4.144535e-02 1 1  ON 36
eH1_7                 6.405853e-02 1 1  ON 37
eH1_8                 1.798837e-01 1 1  ON 38
eH1_9                 1.210009e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280761e-01 1 1  ON 41
eH2_2                -8.655982e-02 1 1  ON 42
eH2_3                -4.908499e-02 1 1  ON 43
eH2_4                -2.846495e-03 1 1  ON 44
eH2_5                 9.104712e-03 1 1  ON 45
eH2_6                 4.679972e-02 1 1  ON 46
eH2_7                 4.635996e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1977
    reference variance = 0.178915
====================================================
  Execution time = 2.1351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1511e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315217902161
                                         uncertainty =       0.003055196768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315217902161
                                         uncertainty =       0.003055196768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396934452
  error estimate for blocks of size 2^( 2) =       0.000406637319
  error estimate for blocks of size 2^( 3) =       0.000415426057
  error estimate for blocks of size 2^( 4) =       0.000421767851
  error estimate for blocks of size 2^( 5) =       0.000425609106
  error estimate for blocks of size 2^( 6) =       0.000426719193
  error estimate for blocks of size 2^( 7) =       0.000428789269

      target function =                  N/A
              le_mean =     -17.217071661909
             les_mean =     296.742670372258
             stat err =       0.000425721354
             autocorr =       1.150305721461
              std dev =       0.561350085501
             le_variance =       0.315113918492


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721707166191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217071661909       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217071668632       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217071673888       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217071667678       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217071676804       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217071678073       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217071677829       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 4.643728e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217071661909       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217071663594       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217071664917       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217071663363       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217071665657       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217071665978       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217071665916       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.162528e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217071661909       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217071662331       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217071662662       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217071662274       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217071662847       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217071662929       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217071662912       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.907320e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6912e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.909144e-01 1 1  ON 0
 uu_1                 2.817494e-02 1 1  ON 1
 uu_2                -6.767555e-02 1 1  ON 2
 uu_3                -1.244130e-01 1 1  ON 3
 uu_4                -1.604516e-01 1 1  ON 4
 uu_5                -1.723897e-01 1 1  ON 5
 uu_6                -1.595260e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691517e-02 1 1  ON 8
 uu_9                 1.618749e-01 1 1  ON 9
 ud_0                 3.492197e-01 1 1  ON 10
 ud_1                 9.073452e-02 1 1  ON 11
 ud_2                -1.902295e-02 1 1  ON 12
 ud_3                -8.085648e-02 1 1  ON 13
 ud_4                -1.307827e-01 1 1  ON 14
 ud_5                -1.677759e-01 1 1  ON 15
 ud_6                -1.808559e-01 1 1  ON 16
 ud_7                -1.595736e-01 1 1  ON 17
 ud_8                -9.930864e-02 1 1  ON 18
 ud_9                -8.478923e-03 1 1  ON 19
 eO_0                -9.252084e-01 1 1  ON 20
 eO_1                -6.029796e-01 1 1  ON 21
 eO_2                -1.886423e-01 1 1  ON 22
 eO_3                 8.046579e-02 1 1  ON 23
 eO_4                 2.053377e-01 1 1  ON 24
 eO_5                 2.935718e-01 1 1  ON 25
 eO_6                 3.341504e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940449e-01 1 1  ON 28
 eO_9                 6.116835e-02 1 1  ON 29
eH1_0                -2.116540e-01 1 1  ON 30
eH1_1                -1.328911e-01 1 1  ON 31
eH1_2                -9.154407e-02 1 1  ON 32
eH1_3                -5.390975e-02 1 1  ON 33
eH1_4                -7.389442e-03 1 1  ON 34
eH1_5                 4.702573e-03 1 1  ON 35
eH1_6                 4.144538e-02 1 1  ON 36
eH1_7                 6.405839e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210009e-01 1 1  ON 39
eH2_0                -2.068518e-01 1 1  ON 40
eH2_1                -1.280761e-01 1 1  ON 41
eH2_2                -8.656003e-02 1 1  ON 42
eH2_3                -4.908505e-02 1 1  ON 43
eH2_4                -2.846266e-03 1 1  ON 44
eH2_5                 9.105003e-03 1 1  ON 45
eH2_6                 4.679964e-02 1 1  ON 46
eH2_7                 4.635993e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1908
    reference variance = 0.571712
====================================================
  Execution time = 2.0900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1834e-01
  Total weights = 2.0000e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377071589
                                         uncertainty =       0.004662950979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377071589
                                         uncertainty =       0.004662950979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398961225
  error estimate for blocks of size 2^( 2) =       0.000408122307
  error estimate for blocks of size 2^( 3) =       0.000416335126
  error estimate for blocks of size 2^( 4) =       0.000422092961
  error estimate for blocks of size 2^( 5) =       0.000425379340
  error estimate for blocks of size 2^( 6) =       0.000426725115
  error estimate for blocks of size 2^( 7) =       0.000427740597

      target function =                  N/A
              le_mean =     -17.216377328907
             les_mean =     296.721988289858
             stat err =       0.000425484503
             autocorr =       1.137381388637
              std dev =       0.564216374909
             le_variance =       0.318340117716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379004694
                                         uncertainty =       0.004662966406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379004694
                                         uncertainty =       0.004662966406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398962436
  error estimate for blocks of size 2^( 2) =       0.000408123454
  error estimate for blocks of size 2^( 3) =       0.000416336208
  error estimate for blocks of size 2^( 4) =       0.000422094019
  error estimate for blocks of size 2^( 5) =       0.000425380360
  error estimate for blocks of size 2^( 6) =       0.000426726088
  error estimate for blocks of size 2^( 7) =       0.000427741629

      target function =                  N/A
              le_mean =     -17.216377313804
             les_mean =     296.721989702755
             stat err =       0.000425485524
             autocorr =       1.137379938620
              std dev =       0.564218087853
             le_variance =       0.318342050661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318378040912
                                         uncertainty =       0.004662958679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318378040912
                                         uncertainty =       0.004662958679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398961832
  error estimate for blocks of size 2^( 2) =       0.000408122882
  error estimate for blocks of size 2^( 3) =       0.000416335669
  error estimate for blocks of size 2^( 4) =       0.000422093492
  error estimate for blocks of size 2^( 5) =       0.000425379852
  error estimate for blocks of size 2^( 6) =       0.000426725603
  error estimate for blocks of size 2^( 7) =       0.000427741114

      target function =                  N/A
              le_mean =     -17.216377321334
             les_mean =     296.721988998337
             stat err =       0.000425485015
             autocorr =       1.137380661653
              std dev =       0.564217233837
             le_variance =       0.318341086959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377192838
                                         uncertainty =       0.004662951941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377192838
                                         uncertainty =       0.004662951941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398961301
  error estimate for blocks of size 2^( 2) =       0.000408122379
  error estimate for blocks of size 2^( 3) =       0.000416335194
  error estimate for blocks of size 2^( 4) =       0.000422093027
  error estimate for blocks of size 2^( 5) =       0.000425379404
  error estimate for blocks of size 2^( 6) =       0.000426725176
  error estimate for blocks of size 2^( 7) =       0.000427740662

      target function =                  N/A
              le_mean =     -17.216377327960
             les_mean =     296.721988378467
             stat err =       0.000425484567
             autocorr =       1.137381297706
              std dev =       0.564216482350
             le_variance =       0.318340238956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216377328907        initial  <--
     6.1035e+01     6.1035e+02             4.6437e-06       -17.216377313804
     2.4414e+02     2.4414e+03             1.1625e-06       -17.216377321334
     9.7656e+02     9.7656e+03             2.9073e-07       -17.216377327960

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4610
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.909141e-01 1 1  ON 0
 uu_1                 2.817490e-02 1 1  ON 1
 uu_2                -6.767576e-02 1 1  ON 2
 uu_3                -1.244131e-01 1 1  ON 3
 uu_4                -1.604516e-01 1 1  ON 4
 uu_5                -1.723896e-01 1 1  ON 5
 uu_6                -1.595257e-01 1 1  ON 6
 uu_7                -1.136031e-01 1 1  ON 7
 uu_8                -3.691506e-02 1 1  ON 8
 uu_9                 1.618750e-01 1 1  ON 9
 ud_0                 3.492190e-01 1 1  ON 10
 ud_1                 9.073444e-02 1 1  ON 11
 ud_2                -1.902304e-02 1 1  ON 12
 ud_3                -8.085627e-02 1 1  ON 13
 ud_4                -1.307823e-01 1 1  ON 14
 ud_5                -1.677764e-01 1 1  ON 15
 ud_6                -1.808557e-01 1 1  ON 16
 ud_7                -1.595733e-01 1 1  ON 17
 ud_8                -9.930845e-02 1 1  ON 18
 ud_9                -8.478877e-03 1 1  ON 19
 eO_0                -9.252072e-01 1 1  ON 20
 eO_1                -6.029793e-01 1 1  ON 21
 eO_2                -1.886424e-01 1 1  ON 22
 eO_3                 8.046486e-02 1 1  ON 23
 eO_4                 2.053370e-01 1 1  ON 24
 eO_5                 2.935719e-01 1 1  ON 25
 eO_6                 3.341506e-01 1 1  ON 26
 eO_7                 5.023068e-01 1 1  ON 27
 eO_8                 1.940448e-01 1 1  ON 28
 eO_9                 6.116833e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328909e-01 1 1  ON 31
eH1_2                -9.154434e-02 1 1  ON 32
eH1_3                -5.390975e-02 1 1  ON 33
eH1_4                -7.389281e-03 1 1  ON 34
eH1_5                 4.702322e-03 1 1  ON 35
eH1_6                 4.144535e-02 1 1  ON 36
eH1_7                 6.405853e-02 1 1  ON 37
eH1_8                 1.798837e-01 1 1  ON 38
eH1_9                 1.210009e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280761e-01 1 1  ON 41
eH2_2                -8.655982e-02 1 1  ON 42
eH2_3                -4.908499e-02 1 1  ON 43
eH2_4                -2.846495e-03 1 1  ON 44
eH2_5                 9.104712e-03 1 1  ON 45
eH2_6                 4.679972e-02 1 1  ON 46
eH2_7                 4.635996e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7381e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1172
    reference variance = 0.192846
====================================================
  Execution time = 2.1616e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1988e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319885150580
                                         uncertainty =       0.003958762194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319885150580
                                         uncertainty =       0.003958762194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399928204
  error estimate for blocks of size 2^( 2) =       0.000409776369
  error estimate for blocks of size 2^( 3) =       0.000417966784
  error estimate for blocks of size 2^( 4) =       0.000424586240
  error estimate for blocks of size 2^( 5) =       0.000428641126
  error estimate for blocks of size 2^( 6) =       0.000432180060
  error estimate for blocks of size 2^( 7) =       0.000432434373

      target function =                  N/A
              le_mean =     -17.217464085405
             les_mean =     296.760954509097
             stat err =       0.000429460450
             autocorr =       1.153140654776
              std dev =       0.565583890169
             le_variance =       0.319885136819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721746408541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217464085405       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217464086288       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217464087035       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217464088820       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217464088750       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217464088650       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217464088502       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.171616e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217464085405       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217464085626       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217464085813       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217464086259       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217464086242       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217464086216       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217464086181       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.043034e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217464085405       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217464085460       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217464085507       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217464085621       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217464085614       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217464085582       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217464085567       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.607665e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163463 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7176e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.909141e-01 1 1  ON 0
 uu_1                 2.817495e-02 1 1  ON 1
 uu_2                -6.767574e-02 1 1  ON 2
 uu_3                -1.244131e-01 1 1  ON 3
 uu_4                -1.604516e-01 1 1  ON 4
 uu_5                -1.723897e-01 1 1  ON 5
 uu_6                -1.595257e-01 1 1  ON 6
 uu_7                -1.136031e-01 1 1  ON 7
 uu_8                -3.691505e-02 1 1  ON 8
 uu_9                 1.618750e-01 1 1  ON 9
 ud_0                 3.492191e-01 1 1  ON 10
 ud_1                 9.073444e-02 1 1  ON 11
 ud_2                -1.902304e-02 1 1  ON 12
 ud_3                -8.085629e-02 1 1  ON 13
 ud_4                -1.307823e-01 1 1  ON 14
 ud_5                -1.677764e-01 1 1  ON 15
 ud_6                -1.808556e-01 1 1  ON 16
 ud_7                -1.595733e-01 1 1  ON 17
 ud_8                -9.930846e-02 1 1  ON 18
 ud_9                -8.478878e-03 1 1  ON 19
 eO_0                -9.252073e-01 1 1  ON 20
 eO_1                -6.029794e-01 1 1  ON 21
 eO_2                -1.886424e-01 1 1  ON 22
 eO_3                 8.046497e-02 1 1  ON 23
 eO_4                 2.053370e-01 1 1  ON 24
 eO_5                 2.935719e-01 1 1  ON 25
 eO_6                 3.341506e-01 1 1  ON 26
 eO_7                 5.023068e-01 1 1  ON 27
 eO_8                 1.940449e-01 1 1  ON 28
 eO_9                 6.116833e-02 1 1  ON 29
eH1_0                -2.116540e-01 1 1  ON 30
eH1_1                -1.328909e-01 1 1  ON 31
eH1_2                -9.154435e-02 1 1  ON 32
eH1_3                -5.390973e-02 1 1  ON 33
eH1_4                -7.389274e-03 1 1  ON 34
eH1_5                 4.702336e-03 1 1  ON 35
eH1_6                 4.144535e-02 1 1  ON 36
eH1_7                 6.405852e-02 1 1  ON 37
eH1_8                 1.798837e-01 1 1  ON 38
eH1_9                 1.210009e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280760e-01 1 1  ON 41
eH2_2                -8.655985e-02 1 1  ON 42
eH2_3                -4.908493e-02 1 1  ON 43
eH2_4                -2.846496e-03 1 1  ON 44
eH2_5                 9.104672e-03 1 1  ON 45
eH2_6                 4.679971e-02 1 1  ON 46
eH2_7                 4.635997e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2336
    reference variance = 0.228707
====================================================
  Execution time = 2.1008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1314e-01
  Total weights = 2.0000e+06
  Execution time = 1.8713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313099765232
                                         uncertainty =       0.002902522865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313099765232
                                         uncertainty =       0.002902522865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395689368
  error estimate for blocks of size 2^( 2) =       0.000405223019
  error estimate for blocks of size 2^( 3) =       0.000413804638
  error estimate for blocks of size 2^( 4) =       0.000419632046
  error estimate for blocks of size 2^( 5) =       0.000423094767
  error estimate for blocks of size 2^( 6) =       0.000425172163
  error estimate for blocks of size 2^( 7) =       0.000426696505

      target function =                  N/A
              le_mean =     -17.217388331788
             les_mean =     296.751600962448
             stat err =       0.000423648870
             autocorr =       1.146313333747
              std dev =       0.559589270304
             le_variance =       0.313140151439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313099873958
                                         uncertainty =       0.002902523713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313099873958
                                         uncertainty =       0.002902523713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395689436
  error estimate for blocks of size 2^( 2) =       0.000405223084
  error estimate for blocks of size 2^( 3) =       0.000413804696
  error estimate for blocks of size 2^( 4) =       0.000419632099
  error estimate for blocks of size 2^( 5) =       0.000423094816
  error estimate for blocks of size 2^( 6) =       0.000425172206
  error estimate for blocks of size 2^( 7) =       0.000426696544

      target function =                  N/A
              le_mean =     -17.217388332704
             les_mean =     296.751601102717
             stat err =       0.000423648916
             autocorr =       1.146313183639
              std dev =       0.559589367437
             le_variance =       0.313140260148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313099819601
                                         uncertainty =       0.002902523289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313099819601
                                         uncertainty =       0.002902523289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395689402
  error estimate for blocks of size 2^( 2) =       0.000405223051
  error estimate for blocks of size 2^( 3) =       0.000413804667
  error estimate for blocks of size 2^( 4) =       0.000419632073
  error estimate for blocks of size 2^( 5) =       0.000423094792
  error estimate for blocks of size 2^( 6) =       0.000425172184
  error estimate for blocks of size 2^( 7) =       0.000426696525

      target function =                  N/A
              le_mean =     -17.217388332246
             les_mean =     296.751601032589
             stat err =       0.000423648893
             autocorr =       1.146313258663
              std dev =       0.559589318876
             le_variance =       0.313140205800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313099772029
                                         uncertainty =       0.002902522918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313099772029
                                         uncertainty =       0.002902522918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395689372
  error estimate for blocks of size 2^( 2) =       0.000405223023
  error estimate for blocks of size 2^( 3) =       0.000413804641
  error estimate for blocks of size 2^( 4) =       0.000419632050
  error estimate for blocks of size 2^( 5) =       0.000423094771
  error estimate for blocks of size 2^( 6) =       0.000425172165
  error estimate for blocks of size 2^( 7) =       0.000426696508

      target function =                  N/A
              le_mean =     -17.217388331845
             les_mean =     296.751600971216
             stat err =       0.000423648873
             autocorr =       1.146313324362
              std dev =       0.559589276375
             le_variance =       0.313140158234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217388331788        initial
     6.1035e+02     6.1035e+03             4.1716e-07       -17.217388332704  <--
     2.4414e+03     2.4414e+04             1.0430e-07       -17.217388332246
     9.7656e+03     9.7656e+04             2.6077e-08       -17.217388331845

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 3.0452e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.909141e-01 1 1  ON 0
 uu_1                 2.817508e-02 1 1  ON 1
 uu_2                -6.767568e-02 1 1  ON 2
 uu_3                -1.244132e-01 1 1  ON 3
 uu_4                -1.604516e-01 1 1  ON 4
 uu_5                -1.723897e-01 1 1  ON 5
 uu_6                -1.595258e-01 1 1  ON 6
 uu_7                -1.136031e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618749e-01 1 1  ON 9
 ud_0                 3.492191e-01 1 1  ON 10
 ud_1                 9.073445e-02 1 1  ON 11
 ud_2                -1.902305e-02 1 1  ON 12
 ud_3                -8.085637e-02 1 1  ON 13
 ud_4                -1.307826e-01 1 1  ON 14
 ud_5                -1.677764e-01 1 1  ON 15
 ud_6                -1.808555e-01 1 1  ON 16
 ud_7                -1.595732e-01 1 1  ON 17
 ud_8                -9.930849e-02 1 1  ON 18
 ud_9                -8.478880e-03 1 1  ON 19
 eO_0                -9.252076e-01 1 1  ON 20
 eO_1                -6.029795e-01 1 1  ON 21
 eO_2                -1.886423e-01 1 1  ON 22
 eO_3                 8.046528e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935718e-01 1 1  ON 25
 eO_6                 3.341506e-01 1 1  ON 26
 eO_7                 5.023068e-01 1 1  ON 27
 eO_8                 1.940449e-01 1 1  ON 28
 eO_9                 6.116833e-02 1 1  ON 29
eH1_0                -2.116541e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154437e-02 1 1  ON 32
eH1_3                -5.390965e-02 1 1  ON 33
eH1_4                -7.389254e-03 1 1  ON 34
eH1_5                 4.702381e-03 1 1  ON 35
eH1_6                 4.144536e-02 1 1  ON 36
eH1_7                 6.405848e-02 1 1  ON 37
eH1_8                 1.798837e-01 1 1  ON 38
eH1_9                 1.210009e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280760e-01 1 1  ON 41
eH2_2                -8.655994e-02 1 1  ON 42
eH2_3                -4.908475e-02 1 1  ON 43
eH2_4                -2.846498e-03 1 1  ON 44
eH2_5                 9.104553e-03 1 1  ON 45
eH2_6                 4.679969e-02 1 1  ON 46
eH2_7                 4.636000e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7634e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1973
    reference variance = 0.252442
====================================================
  Execution time = 2.1222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1098e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025558519
                                         uncertainty =       0.002810363691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025558519
                                         uncertainty =       0.002810363691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394319168
  error estimate for blocks of size 2^( 2) =       0.000403338955
  error estimate for blocks of size 2^( 3) =       0.000411823752
  error estimate for blocks of size 2^( 4) =       0.000417401804
  error estimate for blocks of size 2^( 5) =       0.000421032151
  error estimate for blocks of size 2^( 6) =       0.000423481524
  error estimate for blocks of size 2^( 7) =       0.000424956380

      target function =                  N/A
              le_mean =     -17.216531381273
             les_mean =     296.719927859787
             stat err =       0.000421717965
             autocorr =       1.143795610281
              std dev =       0.557651515649
             le_variance =       0.310975212906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653138127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531381273       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531383472       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531384931       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216531384557       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216531384637       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216531385913       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216531385336       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.895863e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531381273       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531381823       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531382189       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216531382095       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216531382115       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216531382434       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216531382289       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.741197e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531381273       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531381411       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531381502       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216531381479       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216531381484       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216531381564       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216531381527       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.185395e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6875e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.909143e-01 1 1  ON 0
 uu_1                 2.817525e-02 1 1  ON 1
 uu_2                -6.767564e-02 1 1  ON 2
 uu_3                -1.244132e-01 1 1  ON 3
 uu_4                -1.604518e-01 1 1  ON 4
 uu_5                -1.723899e-01 1 1  ON 5
 uu_6                -1.595260e-01 1 1  ON 6
 uu_7                -1.136031e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618749e-01 1 1  ON 9
 ud_0                 3.492194e-01 1 1  ON 10
 ud_1                 9.073448e-02 1 1  ON 11
 ud_2                -1.902317e-02 1 1  ON 12
 ud_3                -8.085650e-02 1 1  ON 13
 ud_4                -1.307826e-01 1 1  ON 14
 ud_5                -1.677764e-01 1 1  ON 15
 ud_6                -1.808554e-01 1 1  ON 16
 ud_7                -1.595733e-01 1 1  ON 17
 ud_8                -9.930857e-02 1 1  ON 18
 ud_9                -8.478886e-03 1 1  ON 19
 eO_0                -9.252079e-01 1 1  ON 20
 eO_1                -6.029798e-01 1 1  ON 21
 eO_2                -1.886422e-01 1 1  ON 22
 eO_3                 8.046576e-02 1 1  ON 23
 eO_4                 2.053371e-01 1 1  ON 24
 eO_5                 2.935717e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023068e-01 1 1  ON 27
 eO_8                 1.940449e-01 1 1  ON 28
 eO_9                 6.116834e-02 1 1  ON 29
eH1_0                -2.116541e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154447e-02 1 1  ON 32
eH1_3                -5.390953e-02 1 1  ON 33
eH1_4                -7.389298e-03 1 1  ON 34
eH1_5                 4.702420e-03 1 1  ON 35
eH1_6                 4.144533e-02 1 1  ON 36
eH1_7                 6.405842e-02 1 1  ON 37
eH1_8                 1.798837e-01 1 1  ON 38
eH1_9                 1.210009e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280761e-01 1 1  ON 41
eH2_2                -8.656001e-02 1 1  ON 42
eH2_3                -4.908477e-02 1 1  ON 43
eH2_4                -2.846423e-03 1 1  ON 44
eH2_5                 9.104624e-03 1 1  ON 45
eH2_6                 4.679970e-02 1 1  ON 46
eH2_7                 4.636003e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1845
    reference variance = 0.285075
====================================================
  Execution time = 2.2947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1807e-01
  Total weights = 2.0000e+06
  Execution time = 1.8744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318158991885
                                         uncertainty =       0.002927475802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318158991885
                                         uncertainty =       0.002927475802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398791863
  error estimate for blocks of size 2^( 2) =       0.000408384038
  error estimate for blocks of size 2^( 3) =       0.000416809854
  error estimate for blocks of size 2^( 4) =       0.000423084150
  error estimate for blocks of size 2^( 5) =       0.000426917475
  error estimate for blocks of size 2^( 6) =       0.000428721406
  error estimate for blocks of size 2^( 7) =       0.000431783351

      target function =                  N/A
              le_mean =     -17.216942166444
             les_mean =     296.741167302908
             stat err =       0.000427626596
             autocorr =       1.149838483411
              std dev =       0.563976860563
             le_variance =       0.318069899251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318160599568
                                         uncertainty =       0.002927486778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318160599568
                                         uncertainty =       0.002927486778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398792870
  error estimate for blocks of size 2^( 2) =       0.000408384998
  error estimate for blocks of size 2^( 3) =       0.000416810763
  error estimate for blocks of size 2^( 4) =       0.000423085008
  error estimate for blocks of size 2^( 5) =       0.000426918301
  error estimate for blocks of size 2^( 6) =       0.000428722199
  error estimate for blocks of size 2^( 7) =       0.000431784124

      target function =                  N/A
              le_mean =     -17.216942173573
             les_mean =     296.741169155165
             stat err =       0.000427627408
             autocorr =       1.149837044259
              std dev =       0.563978285094
             le_variance =       0.318071506058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318159796908
                                         uncertainty =       0.002927481297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318159796908
                                         uncertainty =       0.002927481297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398792367
  error estimate for blocks of size 2^( 2) =       0.000408384519
  error estimate for blocks of size 2^( 3) =       0.000416810309
  error estimate for blocks of size 2^( 4) =       0.000423084580
  error estimate for blocks of size 2^( 5) =       0.000426917889
  error estimate for blocks of size 2^( 6) =       0.000428721803
  error estimate for blocks of size 2^( 7) =       0.000431783738

      target function =                  N/A
              le_mean =     -17.216942170015
             les_mean =     296.741168230455
             stat err =       0.000427627002
             autocorr =       1.149837762696
              std dev =       0.563977573876
             le_variance =       0.318070703835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318159092549
                                         uncertainty =       0.002927476489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318159092549
                                         uncertainty =       0.002927476489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398791926
  error estimate for blocks of size 2^( 2) =       0.000408384098
  error estimate for blocks of size 2^( 3) =       0.000416809911
  error estimate for blocks of size 2^( 4) =       0.000423084204
  error estimate for blocks of size 2^( 5) =       0.000426917527
  error estimate for blocks of size 2^( 6) =       0.000428721456
  error estimate for blocks of size 2^( 7) =       0.000431783399

      target function =                  N/A
              le_mean =     -17.216942166891
             les_mean =     296.741167418892
             stat err =       0.000427626646
             autocorr =       1.149838393291
              std dev =       0.563976949759
             le_variance =       0.318069999860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216942166444        initial
     1.5259e+02     1.5259e+03             1.8959e-06       -17.216942173573  <--
     6.1035e+02     6.1035e+03             4.7412e-07       -17.216942170015
     2.4414e+03     2.4414e+04             1.1854e-07       -17.216942166891

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 3.2444e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817578e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244134e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691505e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073457e-02 1 1  ON 11
 ud_2                -1.902354e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930878e-02 1 1  ON 18
 ud_9                -8.478906e-03 1 1  ON 19
 eO_0                -9.252087e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886416e-01 1 1  ON 22
 eO_3                 8.046718e-02 1 1  ON 23
 eO_4                 2.053371e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389429e-03 1 1  ON 34
eH1_5                 4.702537e-03 1 1  ON 35
eH1_6                 4.144524e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656020e-02 1 1  ON 42
eH2_3                -4.908483e-02 1 1  ON 43
eH2_4                -2.846197e-03 1 1  ON 44
eH2_5                 9.104837e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9325e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2141
    reference variance = 0.119652
====================================================
  Execution time = 2.1602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3877e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338774559961
                                         uncertainty =       0.013247731740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338774559961
                                         uncertainty =       0.013247731740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411564286
  error estimate for blocks of size 2^( 2) =       0.000420695814
  error estimate for blocks of size 2^( 3) =       0.000428826213
  error estimate for blocks of size 2^( 4) =       0.000434075092
  error estimate for blocks of size 2^( 5) =       0.000437783815
  error estimate for blocks of size 2^( 6) =       0.000441150840
  error estimate for blocks of size 2^( 7) =       0.000441522571

      target function =                  N/A
              le_mean =     -17.216975700574
             les_mean =     296.763022427745
             stat err =       0.000438633080
             autocorr =       1.135866783722
              std dev =       0.582039795019
             le_variance =       0.338770322985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697570057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216975700574       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216975700426       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216975696867       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216975721684       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216975731898       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216975722781       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216975724232       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.015046e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216975700574       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216975700537       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216975699640       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216975705877       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216975708462       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216975706185       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216975706529       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.541052e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216975700574       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216975700564       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216975700340       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216975701901       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216975702550       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216975701980       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216975702065       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 6.354778e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0538e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.909159e-01 1 1  ON 0
 uu_1                 2.817578e-02 1 1  ON 1
 uu_2                -6.767600e-02 1 1  ON 2
 uu_3                -1.244135e-01 1 1  ON 3
 uu_4                -1.604522e-01 1 1  ON 4
 uu_5                -1.723905e-01 1 1  ON 5
 uu_6                -1.595266e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691492e-02 1 1  ON 8
 uu_9                 1.618747e-01 1 1  ON 9
 ud_0                 3.492205e-01 1 1  ON 10
 ud_1                 9.073559e-02 1 1  ON 11
 ud_2                -1.902337e-02 1 1  ON 12
 ud_3                -8.085704e-02 1 1  ON 13
 ud_4                -1.307835e-01 1 1  ON 14
 ud_5                -1.677776e-01 1 1  ON 15
 ud_6                -1.808550e-01 1 1  ON 16
 ud_7                -1.595731e-01 1 1  ON 17
 ud_8                -9.930885e-02 1 1  ON 18
 ud_9                -8.478863e-03 1 1  ON 19
 eO_0                -9.252110e-01 1 1  ON 20
 eO_1                -6.029813e-01 1 1  ON 21
 eO_2                -1.886415e-01 1 1  ON 22
 eO_3                 8.046972e-02 1 1  ON 23
 eO_4                 2.053377e-01 1 1  ON 24
 eO_5                 2.935711e-01 1 1  ON 25
 eO_6                 3.341503e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940451e-01 1 1  ON 28
 eO_9                 6.116843e-02 1 1  ON 29
eH1_0                -2.116544e-01 1 1  ON 30
eH1_1                -1.328907e-01 1 1  ON 31
eH1_2                -9.154458e-02 1 1  ON 32
eH1_3                -5.390884e-02 1 1  ON 33
eH1_4                -7.389320e-03 1 1  ON 34
eH1_5                 4.702575e-03 1 1  ON 35
eH1_6                 4.144513e-02 1 1  ON 36
eH1_7                 6.405802e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280766e-01 1 1  ON 41
eH2_2                -8.656009e-02 1 1  ON 42
eH2_3                -4.908459e-02 1 1  ON 43
eH2_4                -2.846627e-03 1 1  ON 44
eH2_5                 9.104780e-03 1 1  ON 45
eH2_6                 4.679968e-02 1 1  ON 46
eH2_7                 4.636032e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201542e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2616
    reference variance = 0.200652
====================================================
  Execution time = 2.1709e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1568e-01
  Total weights = 2.0000e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315782266385
                                         uncertainty =       0.002383892756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315782266385
                                         uncertainty =       0.002383892756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397293001
  error estimate for blocks of size 2^( 2) =       0.000407014761
  error estimate for blocks of size 2^( 3) =       0.000415661996
  error estimate for blocks of size 2^( 4) =       0.000422995348
  error estimate for blocks of size 2^( 5) =       0.000427786907
  error estimate for blocks of size 2^( 6) =       0.000429831292
  error estimate for blocks of size 2^( 7) =       0.000430432439

      target function =                  N/A
              le_mean =     -17.216450166888
             les_mean =     296.721839648709
             stat err =       0.000427761497
             autocorr =       1.159261871335
              std dev =       0.561857150554
             le_variance =       0.315683457628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315782869627
                                         uncertainty =       0.002383889451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315782869627
                                         uncertainty =       0.002383889451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397293381
  error estimate for blocks of size 2^( 2) =       0.000407015143
  error estimate for blocks of size 2^( 3) =       0.000415662386
  error estimate for blocks of size 2^( 4) =       0.000422995699
  error estimate for blocks of size 2^( 5) =       0.000427787243
  error estimate for blocks of size 2^( 6) =       0.000429831625
  error estimate for blocks of size 2^( 7) =       0.000430432879

      target function =                  N/A
              le_mean =     -17.216450156736
             les_mean =     296.721839902757
             stat err =       0.000427761862
             autocorr =       1.159261633302
              std dev =       0.561857687683
             le_variance =       0.315684061208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315782559346
                                         uncertainty =       0.002383891025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315782559346
                                         uncertainty =       0.002383891025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397293186
  error estimate for blocks of size 2^( 2) =       0.000407014947
  error estimate for blocks of size 2^( 3) =       0.000415662186
  error estimate for blocks of size 2^( 4) =       0.000422995518
  error estimate for blocks of size 2^( 5) =       0.000427787070
  error estimate for blocks of size 2^( 6) =       0.000429831454
  error estimate for blocks of size 2^( 7) =       0.000430432654

      target function =                  N/A
              le_mean =     -17.216450161724
             les_mean =     296.721839764047
             stat err =       0.000427761674
             autocorr =       1.159261757781
              std dev =       0.561857411418
             le_variance =       0.315683750765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315782302721
                                         uncertainty =       0.002383892537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315782302721
                                         uncertainty =       0.002383892537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397293024
  error estimate for blocks of size 2^( 2) =       0.000407014784
  error estimate for blocks of size 2^( 3) =       0.000415662019
  error estimate for blocks of size 2^( 4) =       0.000422995369
  error estimate for blocks of size 2^( 5) =       0.000427786927
  error estimate for blocks of size 2^( 6) =       0.000429831312
  error estimate for blocks of size 2^( 7) =       0.000430432465

      target function =                  N/A
              le_mean =     -17.216450166238
             les_mean =     296.721839662696
             stat err =       0.000427761519
             autocorr =       1.159261857303
              std dev =       0.561857182909
             le_variance =       0.315683493986


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216450166888        initial  <--
     3.8147e+01     3.8147e+02             1.0150e-05       -17.216450156736
     1.5259e+02     1.5259e+03             2.5411e-06       -17.216450161724
     6.1035e+02     6.1035e+03             6.3548e-07       -17.216450166238

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2048
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817578e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244134e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691505e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073457e-02 1 1  ON 11
 ud_2                -1.902354e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930878e-02 1 1  ON 18
 ud_9                -8.478906e-03 1 1  ON 19
 eO_0                -9.252087e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886416e-01 1 1  ON 22
 eO_3                 8.046718e-02 1 1  ON 23
 eO_4                 2.053371e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389429e-03 1 1  ON 34
eH1_5                 4.702537e-03 1 1  ON 35
eH1_6                 4.144524e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656020e-02 1 1  ON 42
eH2_3                -4.908483e-02 1 1  ON 43
eH2_4                -2.846197e-03 1 1  ON 44
eH2_5                 9.104837e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1749e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.199578
====================================================
  Execution time = 2.1792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1962e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319664951180
                                         uncertainty =       0.004115776371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319664951180
                                         uncertainty =       0.004115776371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399763192
  error estimate for blocks of size 2^( 2) =       0.000409001076
  error estimate for blocks of size 2^( 3) =       0.000417288544
  error estimate for blocks of size 2^( 4) =       0.000422949339
  error estimate for blocks of size 2^( 5) =       0.000427438692
  error estimate for blocks of size 2^( 6) =       0.000428581781
  error estimate for blocks of size 2^( 7) =       0.000428379367

      target function =                  N/A
              le_mean =     -17.215970599087
             les_mean =     296.709264728847
             stat err =       0.000426837295
             autocorr =       1.140037425433
              std dev =       0.565350528447
             le_variance =       0.319621220016


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597059909e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215970599087       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215970599560       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215970602563       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215970602804       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215970601421       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215970601602       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215970601897       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.018696e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215970599087       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215970599206       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215970599957       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215970600017       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215970599671       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215970599715       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215970599790       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.547138e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215970599087       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215970599117       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215970599305       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215970599320       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215970599230       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215970599240       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215970599266       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 6.368091e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7394e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244134e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723905e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492205e-01 1 1  ON 10
 ud_1                 9.073458e-02 1 1  ON 11
 ud_2                -1.902354e-02 1 1  ON 12
 ud_3                -8.085696e-02 1 1  ON 13
 ud_4                -1.307830e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808552e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930880e-02 1 1  ON 18
 ud_9                -8.478902e-03 1 1  ON 19
 eO_0                -9.252089e-01 1 1  ON 20
 eO_1                -6.029807e-01 1 1  ON 21
 eO_2                -1.886416e-01 1 1  ON 22
 eO_3                 8.046743e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116838e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328909e-01 1 1  ON 31
eH1_2                -9.154475e-02 1 1  ON 32
eH1_3                -5.390918e-02 1 1  ON 33
eH1_4                -7.389412e-03 1 1  ON 34
eH1_5                 4.702566e-03 1 1  ON 35
eH1_6                 4.144528e-02 1 1  ON 36
eH1_7                 6.405824e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656023e-02 1 1  ON 42
eH2_3                -4.908485e-02 1 1  ON 43
eH2_4                -2.846206e-03 1 1  ON 44
eH2_5                 9.104821e-03 1 1  ON 45
eH2_6                 4.679972e-02 1 1  ON 46
eH2_7                 4.636015e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2244
    reference variance = 0.153347
====================================================
  Execution time = 2.0814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1515e-01
  Total weights = 2.0000e+06
  Execution time = 1.8726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315201744405
                                         uncertainty =       0.003072372897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315201744405
                                         uncertainty =       0.003072372897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396957747
  error estimate for blocks of size 2^( 2) =       0.000406032051
  error estimate for blocks of size 2^( 3) =       0.000414396200
  error estimate for blocks of size 2^( 4) =       0.000421036693
  error estimate for blocks of size 2^( 5) =       0.000424721564
  error estimate for blocks of size 2^( 6) =       0.000425907867
  error estimate for blocks of size 2^( 7) =       0.000427939369

      target function =                  N/A
              le_mean =     -17.216130889281
             les_mean =     296.710313544303
             stat err =       0.000424901373
             autocorr =       1.145744302338
              std dev =       0.561383028807
             le_variance =       0.315150905033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315202340105
                                         uncertainty =       0.003072377902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315202340105
                                         uncertainty =       0.003072377902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396958122
  error estimate for blocks of size 2^( 2) =       0.000406032410
  error estimate for blocks of size 2^( 3) =       0.000414396545
  error estimate for blocks of size 2^( 4) =       0.000421037028
  error estimate for blocks of size 2^( 5) =       0.000424721893
  error estimate for blocks of size 2^( 6) =       0.000425908191
  error estimate for blocks of size 2^( 7) =       0.000427939690

      target function =                  N/A
              le_mean =     -17.216130886362
             les_mean =     296.710314039529
             stat err =       0.000424901701
             autocorr =       1.145743903266
              std dev =       0.561383559402
             le_variance =       0.315151500767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315202042455
                                         uncertainty =       0.003072375401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315202042455
                                         uncertainty =       0.003072375401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396957934
  error estimate for blocks of size 2^( 2) =       0.000406032230
  error estimate for blocks of size 2^( 3) =       0.000414396373
  error estimate for blocks of size 2^( 4) =       0.000421036861
  error estimate for blocks of size 2^( 5) =       0.000424721729
  error estimate for blocks of size 2^( 6) =       0.000425908029
  error estimate for blocks of size 2^( 7) =       0.000427939530

      target function =                  N/A
              le_mean =     -17.216130887820
             les_mean =     296.710313792075
             stat err =       0.000424901537
             autocorr =       1.145744102685
              std dev =       0.561383294283
             le_variance =       0.315151203100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315201781667
                                         uncertainty =       0.003072373210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315201781667
                                         uncertainty =       0.003072373210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396957770
  error estimate for blocks of size 2^( 2) =       0.000406032073
  error estimate for blocks of size 2^( 3) =       0.000414396222
  error estimate for blocks of size 2^( 4) =       0.000421036714
  error estimate for blocks of size 2^( 5) =       0.000424721585
  error estimate for blocks of size 2^( 6) =       0.000425907887
  error estimate for blocks of size 2^( 7) =       0.000427939389

      target function =                  N/A
              le_mean =     -17.216130889098
             les_mean =     296.710313575279
             stat err =       0.000424901394
             autocorr =       1.145744277376
              std dev =       0.561383061997
             le_variance =       0.315150942297


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216130889281        initial  <--
     3.8147e+02     3.8147e+03             1.0187e-06       -17.216130886362
     1.5259e+03     1.5259e+04             2.5471e-07       -17.216130887820
     6.1035e+03     6.1035e+04             6.3681e-08       -17.216130889098

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3405
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817578e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244134e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691505e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073457e-02 1 1  ON 11
 ud_2                -1.902354e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930878e-02 1 1  ON 18
 ud_9                -8.478906e-03 1 1  ON 19
 eO_0                -9.252087e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886416e-01 1 1  ON 22
 eO_3                 8.046718e-02 1 1  ON 23
 eO_4                 2.053371e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389429e-03 1 1  ON 34
eH1_5                 4.702537e-03 1 1  ON 35
eH1_6                 4.144524e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656020e-02 1 1  ON 42
eH2_3                -4.908483e-02 1 1  ON 43
eH2_4                -2.846197e-03 1 1  ON 44
eH2_5                 9.104837e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.211
    reference variance = 0.152383
====================================================
  Execution time = 2.1204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1290e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312968410188
                                         uncertainty =       0.002957628175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312968410188
                                         uncertainty =       0.002957628175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395539422
  error estimate for blocks of size 2^( 2) =       0.000405330249
  error estimate for blocks of size 2^( 3) =       0.000414437515
  error estimate for blocks of size 2^( 4) =       0.000420960447
  error estimate for blocks of size 2^( 5) =       0.000424785966
  error estimate for blocks of size 2^( 6) =       0.000426922285
  error estimate for blocks of size 2^( 7) =       0.000429580600

      target function =                  N/A
              le_mean =     -17.216872677689
             les_mean =     296.733607511383
             stat err =       0.000425562324
             autocorr =       1.157568756575
              std dev =       0.559377214495
             le_variance =       0.312902868096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687267769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216872677689       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216872677655       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216872677597       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216872677421       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216872677454       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216872677412       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216872677422       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 8.390754e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216872677689       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216872677680       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216872677666       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216872677621       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216872677621       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216872677617       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216872677623       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.097725e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216872677689       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216872677686       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216872677683       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216872677672       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216872677654       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216872677689       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216872677666       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 5.244335e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6854e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817578e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244134e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073458e-02 1 1  ON 11
 ud_2                -1.902354e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930878e-02 1 1  ON 18
 ud_9                -8.478906e-03 1 1  ON 19
 eO_0                -9.252087e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886416e-01 1 1  ON 22
 eO_3                 8.046720e-02 1 1  ON 23
 eO_4                 2.053371e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389427e-03 1 1  ON 34
eH1_5                 4.702541e-03 1 1  ON 35
eH1_6                 4.144524e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656020e-02 1 1  ON 42
eH2_3                -4.908483e-02 1 1  ON 43
eH2_4                -2.846194e-03 1 1  ON 44
eH2_5                 9.104840e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1933
    reference variance = 0.326174
====================================================
  Execution time = 2.0928e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2993e-01
  Total weights = 2.0000e+06
  Execution time = 1.8734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330020836918
                                         uncertainty =       0.006590716706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330020836918
                                         uncertainty =       0.006590716706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406157680
  error estimate for blocks of size 2^( 2) =       0.000415345024
  error estimate for blocks of size 2^( 3) =       0.000423021941
  error estimate for blocks of size 2^( 4) =       0.000429224963
  error estimate for blocks of size 2^( 5) =       0.000432902223
  error estimate for blocks of size 2^( 6) =       0.000435542646
  error estimate for blocks of size 2^( 7) =       0.000437692135

      target function =                  N/A
              le_mean =     -17.216548990789
             les_mean =     296.739487109724
             stat err =       0.000433840492
             autocorr =       1.140961073637
              std dev =       0.574393699878
             le_variance =       0.329928122459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330020845833
                                         uncertainty =       0.006590716674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330020845833
                                         uncertainty =       0.006590716674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406157686
  error estimate for blocks of size 2^( 2) =       0.000415345030
  error estimate for blocks of size 2^( 3) =       0.000423021945
  error estimate for blocks of size 2^( 4) =       0.000429224967
  error estimate for blocks of size 2^( 5) =       0.000432902226
  error estimate for blocks of size 2^( 6) =       0.000435542650
  error estimate for blocks of size 2^( 7) =       0.000437692138

      target function =                  N/A
              le_mean =     -17.216548990974
             les_mean =     296.739487125009
             stat err =       0.000433840495
             autocorr =       1.140961060584
              std dev =       0.574393707616
             le_variance =       0.329928131348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330020841375
                                         uncertainty =       0.006590716690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330020841375
                                         uncertainty =       0.006590716690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406157683
  error estimate for blocks of size 2^( 2) =       0.000415345027
  error estimate for blocks of size 2^( 3) =       0.000423021943
  error estimate for blocks of size 2^( 4) =       0.000429224965
  error estimate for blocks of size 2^( 5) =       0.000432902225
  error estimate for blocks of size 2^( 6) =       0.000435542648
  error estimate for blocks of size 2^( 7) =       0.000437692137

      target function =                  N/A
              le_mean =     -17.216548990882
             les_mean =     296.739487117367
             stat err =       0.000433840494
             autocorr =       1.140961067095
              std dev =       0.574393703747
             le_variance =       0.329928126904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330020837475
                                         uncertainty =       0.006590716704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330020837475
                                         uncertainty =       0.006590716704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406157681
  error estimate for blocks of size 2^( 2) =       0.000415345025
  error estimate for blocks of size 2^( 3) =       0.000423021941
  error estimate for blocks of size 2^( 4) =       0.000429224963
  error estimate for blocks of size 2^( 5) =       0.000432902223
  error estimate for blocks of size 2^( 6) =       0.000435542646
  error estimate for blocks of size 2^( 7) =       0.000437692135

      target function =                  N/A
              le_mean =     -17.216548990800
             les_mean =     296.739487110679
             stat err =       0.000433840492
             autocorr =       1.140961072823
              std dev =       0.574393700361
             le_variance =       0.329928123015


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216548990789        initial
     3.8147e+03     3.8147e+04             8.3908e-08       -17.216548990974  <--
     1.5259e+04     1.5259e+05             2.0977e-08       -17.216548990882
     6.1035e+04     6.1035e+05             5.2443e-09       -17.216548990800

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 3.0410e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073459e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046726e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390917e-02 1 1  ON 33
eH1_4                -7.389423e-03 1 1  ON 34
eH1_5                 4.702553e-03 1 1  ON 35
eH1_6                 4.144526e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846184e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1809
    reference variance = 0.190935
====================================================
  Execution time = 2.1470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2029e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320323648089
                                         uncertainty =       0.002838126572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320323648089
                                         uncertainty =       0.002838126572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400183812
  error estimate for blocks of size 2^( 2) =       0.000409849383
  error estimate for blocks of size 2^( 3) =       0.000417977927
  error estimate for blocks of size 2^( 4) =       0.000424360200
  error estimate for blocks of size 2^( 5) =       0.000427772066
  error estimate for blocks of size 2^( 6) =       0.000429926681
  error estimate for blocks of size 2^( 7) =       0.000431800922

      target function =                  N/A
              le_mean =     -17.217524389442
             les_mean =     296.763440107288
             stat err =       0.000428464967
             autocorr =       1.146335133639
              std dev =       0.565945374053
             le_variance =       0.320294166412


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721752438944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217524389442       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217524388845       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217524388675       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217524388066       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217524388467       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217524388660       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217524388633       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 3.321944e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217524389442       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217524389293       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217524389250       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217524389099       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217524389200       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217524389245       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217524389239       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 8.305856e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217524389442       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217524389405       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217524389394       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217524389360       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217524389384       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217524389400       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217524389379       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.076526e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7051e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817579e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691503e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902352e-02 1 1  ON 12
 ud_3                -8.085693e-02 1 1  ON 13
 ud_4                -1.307830e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252089e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886416e-01 1 1  ON 22
 eO_3                 8.046733e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116838e-02 1 1  ON 29
eH1_0                -2.116540e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389408e-03 1 1  ON 34
eH1_5                 4.702542e-03 1 1  ON 35
eH1_6                 4.144524e-02 1 1  ON 36
eH1_7                 6.405824e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656019e-02 1 1  ON 42
eH2_3                -4.908483e-02 1 1  ON 43
eH2_4                -2.846176e-03 1 1  ON 44
eH2_5                 9.104838e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636013e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2581
    reference variance = 0.532862
====================================================
  Execution time = 2.0909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1581e-01
  Total weights = 2.0000e+06
  Execution time = 1.8715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315803797407
                                         uncertainty =       0.002507383379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315803797407
                                         uncertainty =       0.002507383379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397372949
  error estimate for blocks of size 2^( 2) =       0.000406825736
  error estimate for blocks of size 2^( 3) =       0.000415856153
  error estimate for blocks of size 2^( 4) =       0.000422288027
  error estimate for blocks of size 2^( 5) =       0.000426603811
  error estimate for blocks of size 2^( 6) =       0.000427887379
  error estimate for blocks of size 2^( 7) =       0.000429777729

      target function =                  N/A
              le_mean =     -17.216966663791
             les_mean =     296.739751466106
             stat err =       0.000426639236
             autocorr =       1.152723074405
              std dev =       0.561970214436
             le_variance =       0.315810521913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315803789784
                                         uncertainty =       0.002507383299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315803789784
                                         uncertainty =       0.002507383299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397372945
  error estimate for blocks of size 2^( 2) =       0.000406825732
  error estimate for blocks of size 2^( 3) =       0.000415856149
  error estimate for blocks of size 2^( 4) =       0.000422288021
  error estimate for blocks of size 2^( 5) =       0.000426603805
  error estimate for blocks of size 2^( 6) =       0.000427887376
  error estimate for blocks of size 2^( 7) =       0.000429777723

      target function =                  N/A
              le_mean =     -17.216966663115
             les_mean =     296.739751435146
             stat err =       0.000426639231
             autocorr =       1.152723076003
              std dev =       0.561970207617
             le_variance =       0.315810514249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315803793583
                                         uncertainty =       0.002507383339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315803793583
                                         uncertainty =       0.002507383339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397372947
  error estimate for blocks of size 2^( 2) =       0.000406825734
  error estimate for blocks of size 2^( 3) =       0.000415856151
  error estimate for blocks of size 2^( 4) =       0.000422288024
  error estimate for blocks of size 2^( 5) =       0.000426603808
  error estimate for blocks of size 2^( 6) =       0.000427887377
  error estimate for blocks of size 2^( 7) =       0.000429777726

      target function =                  N/A
              le_mean =     -17.216966663453
             les_mean =     296.739751450605
             stat err =       0.000426639234
             autocorr =       1.152723075221
              std dev =       0.561970211015
             le_variance =       0.315810518068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315803796929
                                         uncertainty =       0.002507383374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315803796929
                                         uncertainty =       0.002507383374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397372949
  error estimate for blocks of size 2^( 2) =       0.000406825735
  error estimate for blocks of size 2^( 3) =       0.000415856153
  error estimate for blocks of size 2^( 4) =       0.000422288027
  error estimate for blocks of size 2^( 5) =       0.000426603810
  error estimate for blocks of size 2^( 6) =       0.000427887378
  error estimate for blocks of size 2^( 7) =       0.000429777728

      target function =                  N/A
              le_mean =     -17.216966663749
             les_mean =     296.739751464167
             stat err =       0.000426639236
             autocorr =       1.152723074514
              std dev =       0.561970214008
             le_variance =       0.315810521432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216966663791        initial  <--
     9.5367e+02     9.5367e+03             3.3219e-07       -17.216966663115
     3.8147e+03     3.8147e+04             8.3059e-08       -17.216966663453
     1.5259e+04     1.5259e+05             2.0765e-08       -17.216966663749

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3895
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073459e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046726e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390917e-02 1 1  ON 33
eH1_4                -7.389423e-03 1 1  ON 34
eH1_5                 4.702553e-03 1 1  ON 35
eH1_6                 4.144526e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846184e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2487
    reference variance = 0.202211
====================================================
  Execution time = 2.1454e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1792e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317772897406
                                         uncertainty =       0.006457981944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317772897406
                                         uncertainty =       0.006457981944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398700700
  error estimate for blocks of size 2^( 2) =       0.000408650420
  error estimate for blocks of size 2^( 3) =       0.000416930482
  error estimate for blocks of size 2^( 4) =       0.000423591055
  error estimate for blocks of size 2^( 5) =       0.000427178710
  error estimate for blocks of size 2^( 6) =       0.000428490931
  error estimate for blocks of size 2^( 7) =       0.000426999463

      target function =                  N/A
              le_mean =     -17.216161885937
             les_mean =     296.714154419756
             stat err =       0.000426565040
             autocorr =       1.144660039650
              std dev =       0.563847936873
             le_variance =       0.317924495916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616188594e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216161885937       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216161885919       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216161885913       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216161885893       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216161885868       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216161885866       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216161885887       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 3.072607e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216161885937       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216161885933       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216161885931       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216161885931       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216161885956       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216161886068       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216161885922       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 7.681586e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216161885937       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216161885936       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216161885936       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216161885935       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216161885964       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216161885971       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216161885900       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.920401e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7000e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389422e-03 1 1  ON 34
eH1_5                 4.702554e-03 1 1  ON 35
eH1_6                 4.144526e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846186e-03 1 1  ON 44
eH2_5                 9.104847e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1165
    reference variance = 0.386766
====================================================
  Execution time = 2.3133e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2464e-01
  Total weights = 2.0000e+06
  Execution time = 1.8679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324657479691
                                         uncertainty =       0.004266484973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324657479691
                                         uncertainty =       0.004266484973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402890807
  error estimate for blocks of size 2^( 2) =       0.000411890320
  error estimate for blocks of size 2^( 3) =       0.000420315125
  error estimate for blocks of size 2^( 4) =       0.000426695967
  error estimate for blocks of size 2^( 5) =       0.000430860410
  error estimate for blocks of size 2^( 6) =       0.000432113564
  error estimate for blocks of size 2^( 7) =       0.000432128431

      target function =                  N/A
              le_mean =     -17.216817607597
             les_mean =     296.743450375353
             stat err =       0.000430449593
             autocorr =       1.141484154609
              std dev =       0.569773643121
             le_variance =       0.324642004395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324657482947
                                         uncertainty =       0.004266485144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324657482947
                                         uncertainty =       0.004266485144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402890809
  error estimate for blocks of size 2^( 2) =       0.000411890322
  error estimate for blocks of size 2^( 3) =       0.000420315127
  error estimate for blocks of size 2^( 4) =       0.000426695968
  error estimate for blocks of size 2^( 5) =       0.000430860412
  error estimate for blocks of size 2^( 6) =       0.000432113565
  error estimate for blocks of size 2^( 7) =       0.000432128432

      target function =                  N/A
              le_mean =     -17.216817607468
             les_mean =     296.743450374157
             stat err =       0.000430449594
             autocorr =       1.141484150243
              std dev =       0.569773645971
             le_variance =       0.324642007643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324657481319
                                         uncertainty =       0.004266485058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324657481319
                                         uncertainty =       0.004266485058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402890808
  error estimate for blocks of size 2^( 2) =       0.000411890321
  error estimate for blocks of size 2^( 3) =       0.000420315126
  error estimate for blocks of size 2^( 4) =       0.000426695967
  error estimate for blocks of size 2^( 5) =       0.000430860411
  error estimate for blocks of size 2^( 6) =       0.000432113564
  error estimate for blocks of size 2^( 7) =       0.000432128431

      target function =                  N/A
              le_mean =     -17.216817607533
             les_mean =     296.743450374755
             stat err =       0.000430449593
             autocorr =       1.141484152430
              std dev =       0.569773644546
             le_variance =       0.324642006019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324657479895
                                         uncertainty =       0.004266484983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324657479895
                                         uncertainty =       0.004266484983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402890807
  error estimate for blocks of size 2^( 2) =       0.000411890320
  error estimate for blocks of size 2^( 3) =       0.000420315125
  error estimate for blocks of size 2^( 4) =       0.000426695967
  error estimate for blocks of size 2^( 5) =       0.000430860410
  error estimate for blocks of size 2^( 6) =       0.000432113564
  error estimate for blocks of size 2^( 7) =       0.000432128431

      target function =                  N/A
              le_mean =     -17.216817607589
             les_mean =     296.743450375278
             stat err =       0.000430449593
             autocorr =       1.141484154345
              std dev =       0.569773643299
             le_variance =       0.324642004598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216817607597        initial  <--
     9.5367e+03     9.5367e+04             3.0726e-08       -17.216817607468
     3.8147e+04     3.8147e+05             7.6816e-09       -17.216817607533
     1.5259e+05     1.5259e+06             1.9204e-09       -17.216817607589

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.5920
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073459e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046726e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390917e-02 1 1  ON 33
eH1_4                -7.389423e-03 1 1  ON 34
eH1_5                 4.702553e-03 1 1  ON 35
eH1_6                 4.144526e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846184e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9598e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.405729
====================================================
  Execution time = 2.1286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2322e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323198216488
                                         uncertainty =       0.005476335480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323198216488
                                         uncertainty =       0.005476335480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402007945
  error estimate for blocks of size 2^( 2) =       0.000411542056
  error estimate for blocks of size 2^( 3) =       0.000419715800
  error estimate for blocks of size 2^( 4) =       0.000426409324
  error estimate for blocks of size 2^( 5) =       0.000430956017
  error estimate for blocks of size 2^( 6) =       0.000432971306
  error estimate for blocks of size 2^( 7) =       0.000433510792

      target function =                  N/A
              le_mean =     -17.218035906520
             les_mean =     296.783981092825
             stat err =       0.000430961860
             autocorr =       1.149233824363
              std dev =       0.568525088478
             le_variance =       0.323220776229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721803590652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.218035906520       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.218035906529       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218035906529       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218035906530       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.218035906533       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.218035906534       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.218035906716       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 4.297769e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.218035906520       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.218035906522       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218035906522       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218035906493       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.218035906523       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.218035906252       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.218035906558       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 1.074444e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.218035906520       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.218035906520       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218035906520       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218035906552       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.218035906527       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.218035906834       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.218035905584       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 2.686111e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6817e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073459e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046726e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390917e-02 1 1  ON 33
eH1_4                -7.389423e-03 1 1  ON 34
eH1_5                 4.702553e-03 1 1  ON 35
eH1_6                 4.144526e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846184e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1987
    reference variance = 0.198027
====================================================
  Execution time = 2.3096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2720e-01
  Total weights = 2.0000e+06
  Execution time = 1.8722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326900577465
                                         uncertainty =       0.010221710727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326900577465
                                         uncertainty =       0.010221710727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404472002
  error estimate for blocks of size 2^( 2) =       0.000413837103
  error estimate for blocks of size 2^( 3) =       0.000421929412
  error estimate for blocks of size 2^( 4) =       0.000427692381
  error estimate for blocks of size 2^( 5) =       0.000431996838
  error estimate for blocks of size 2^( 6) =       0.000433691265
  error estimate for blocks of size 2^( 7) =       0.000434341306

      target function =                  N/A
              le_mean =     -17.217657696384
             les_mean =     296.774931587564
             stat err =       0.000431930448
             autocorr =       1.140382931847
              std dev =       0.572009791277
             le_variance =       0.327195201317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326900576083
                                         uncertainty =       0.010221710683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326900576083
                                         uncertainty =       0.010221710683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404472001
  error estimate for blocks of size 2^( 2) =       0.000413837102
  error estimate for blocks of size 2^( 3) =       0.000421929411
  error estimate for blocks of size 2^( 4) =       0.000427692381
  error estimate for blocks of size 2^( 5) =       0.000431996837
  error estimate for blocks of size 2^( 6) =       0.000433691264
  error estimate for blocks of size 2^( 7) =       0.000434341305

      target function =                  N/A
              le_mean =     -17.217657696389
             les_mean =     296.774931586346
             stat err =       0.000431930447
             autocorr =       1.140382932634
              std dev =       0.572009790069
             le_variance =       0.327195199935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326900576774
                                         uncertainty =       0.010221710705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326900576774
                                         uncertainty =       0.010221710705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404472002
  error estimate for blocks of size 2^( 2) =       0.000413837102
  error estimate for blocks of size 2^( 3) =       0.000421929412
  error estimate for blocks of size 2^( 4) =       0.000427692381
  error estimate for blocks of size 2^( 5) =       0.000431996838
  error estimate for blocks of size 2^( 6) =       0.000433691264
  error estimate for blocks of size 2^( 7) =       0.000434341306

      target function =                  N/A
              le_mean =     -17.217657696386
             les_mean =     296.774931586955
             stat err =       0.000431930447
             autocorr =       1.140382932244
              std dev =       0.572009790673
             le_variance =       0.327195200626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326900577379
                                         uncertainty =       0.010221710724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326900577379
                                         uncertainty =       0.010221710724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404472002
  error estimate for blocks of size 2^( 2) =       0.000413837103
  error estimate for blocks of size 2^( 3) =       0.000421929412
  error estimate for blocks of size 2^( 4) =       0.000427692381
  error estimate for blocks of size 2^( 5) =       0.000431996838
  error estimate for blocks of size 2^( 6) =       0.000433691265
  error estimate for blocks of size 2^( 7) =       0.000434341306

      target function =                  N/A
              le_mean =     -17.217657696384
             les_mean =     296.774931587488
             stat err =       0.000431930447
             autocorr =       1.140382931896
              std dev =       0.572009791201
             le_variance =       0.327195201230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217657696384        initial
     9.5367e+04     9.5367e+05             4.2978e-09       -17.217657696389  <--
     3.8147e+05     3.8147e+06             1.0744e-09       -17.217657696386
     1.5259e+06     1.5259e+07             2.6861e-10       -17.217657696384

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 3.2580e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9403e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1615
    reference variance = 0.27709
====================================================
  Execution time = 2.1227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2618e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326276294215
                                         uncertainty =       0.004275619987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326276294215
                                         uncertainty =       0.004275619987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403841931
  error estimate for blocks of size 2^( 2) =       0.000413144376
  error estimate for blocks of size 2^( 3) =       0.000421399182
  error estimate for blocks of size 2^( 4) =       0.000427450079
  error estimate for blocks of size 2^( 5) =       0.000431770901
  error estimate for blocks of size 2^( 6) =       0.000433632131
  error estimate for blocks of size 2^( 7) =       0.000434593688

      target function =                  N/A
              le_mean =     -17.217569237151
             les_mean =     296.770866883221
             stat err =       0.000431861700
             autocorr =       1.143580023314
              std dev =       0.571118735664
             le_variance =       0.326176610227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721756923715e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217569237151       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217569237169       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217569237213       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217569237211       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217569237211       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217569237213       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217569237208       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.013744e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217569237151       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217569237155       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217569237166       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217569237214       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217569237167       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217569236636       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217569237116       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.534366e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217569237151       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217569237152       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217569237155       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217569237155       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217569237201       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217569237154       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217569237150       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 6.335925e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6737e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389425e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846184e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2696
    reference variance = 0.839726
====================================================
  Execution time = 2.1056e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3109e-01
  Total weights = 2.0000e+06
  Execution time = 1.9480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331115584641
                                         uncertainty =       0.015944969999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331115584641
                                         uncertainty =       0.015944969999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406870244
  error estimate for blocks of size 2^( 2) =       0.000416053823
  error estimate for blocks of size 2^( 3) =       0.000424853613
  error estimate for blocks of size 2^( 4) =       0.000430540049
  error estimate for blocks of size 2^( 5) =       0.000434444223
  error estimate for blocks of size 2^( 6) =       0.000435562807
  error estimate for blocks of size 2^( 7) =       0.000436541785

      target function =                  N/A
              le_mean =     -17.217007547761
             les_mean =     296.756435524986
             stat err =       0.000434272216
             autocorr =       1.139232144973
              std dev =       0.575401417170
             le_variance =       0.331086790881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331115580495
                                         uncertainty =       0.015944969935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331115580495
                                         uncertainty =       0.015944969935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406870241
  error estimate for blocks of size 2^( 2) =       0.000416053821
  error estimate for blocks of size 2^( 3) =       0.000424853610
  error estimate for blocks of size 2^( 4) =       0.000430540046
  error estimate for blocks of size 2^( 5) =       0.000434444220
  error estimate for blocks of size 2^( 6) =       0.000435562805
  error estimate for blocks of size 2^( 7) =       0.000436541783

      target function =                  N/A
              le_mean =     -17.217007547731
             les_mean =     296.756435519812
             stat err =       0.000434272214
             autocorr =       1.139232146874
              std dev =       0.575401413568
             le_variance =       0.331086786736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331115582568
                                         uncertainty =       0.015944969967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331115582568
                                         uncertainty =       0.015944969967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406870243
  error estimate for blocks of size 2^( 2) =       0.000416053822
  error estimate for blocks of size 2^( 3) =       0.000424853611
  error estimate for blocks of size 2^( 4) =       0.000430540047
  error estimate for blocks of size 2^( 5) =       0.000434444221
  error estimate for blocks of size 2^( 6) =       0.000435562806
  error estimate for blocks of size 2^( 7) =       0.000436541784

      target function =                  N/A
              le_mean =     -17.217007547746
             les_mean =     296.756435522399
             stat err =       0.000434272215
             autocorr =       1.139232145929
              std dev =       0.575401415369
             le_variance =       0.331086788808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331115584382
                                         uncertainty =       0.015944969995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331115584382
                                         uncertainty =       0.015944969995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406870244
  error estimate for blocks of size 2^( 2) =       0.000416053823
  error estimate for blocks of size 2^( 3) =       0.000424853613
  error estimate for blocks of size 2^( 4) =       0.000430540048
  error estimate for blocks of size 2^( 5) =       0.000434444222
  error estimate for blocks of size 2^( 6) =       0.000435562807
  error estimate for blocks of size 2^( 7) =       0.000436541785

      target function =                  N/A
              le_mean =     -17.217007547759
             les_mean =     296.756435524662
             stat err =       0.000434272216
             autocorr =       1.139232145088
              std dev =       0.575401416944
             le_variance =       0.331086790621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217007547761        initial  <--
     2.3842e+04     2.3842e+05             1.0137e-08       -17.217007547731
     9.5367e+04     9.5367e+05             2.5344e-09       -17.217007547746
     3.8147e+05     3.8147e+06             6.3359e-10       -17.217007547759

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6921
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7435e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2026
    reference variance = 0.179996
====================================================
  Execution time = 2.1131e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1603e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316097980069
                                         uncertainty =       0.003254215169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316097980069
                                         uncertainty =       0.003254215169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397508853
  error estimate for blocks of size 2^( 2) =       0.000407111908
  error estimate for blocks of size 2^( 3) =       0.000416039240
  error estimate for blocks of size 2^( 4) =       0.000422016492
  error estimate for blocks of size 2^( 5) =       0.000426418270
  error estimate for blocks of size 2^( 6) =       0.000429592618
  error estimate for blocks of size 2^( 7) =       0.000431303226

      target function =                  N/A
              le_mean =     -17.217204076669
             les_mean =     296.748142636284
             stat err =       0.000427332651
             autocorr =       1.155682518533
              std dev =       0.562162411260
             le_variance =       0.316026576634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721720407667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217204076669       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217204076669       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217204076667       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217204076669       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217204076661       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217204076819       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217204076849       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.230134e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217204076669       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217204076669       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217204076668       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217204076580       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217204076735       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217204076674       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217204076928       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.075335e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217204076669       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217204076669       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217204076669       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217204076710       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217204073642       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217204077611       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217204080108       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 7.688317e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183302 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6722e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1904
    reference variance = 0.168048
====================================================
  Execution time = 2.1172e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2321e-01
  Total weights = 2.0000e+06
  Execution time = 1.8828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323173850743
                                         uncertainty =       0.003380197610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323173850743
                                         uncertainty =       0.003380197610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401998875
  error estimate for blocks of size 2^( 2) =       0.000411528991
  error estimate for blocks of size 2^( 3) =       0.000419482074
  error estimate for blocks of size 2^( 4) =       0.000425427401
  error estimate for blocks of size 2^( 5) =       0.000428772620
  error estimate for blocks of size 2^( 6) =       0.000429786044
  error estimate for blocks of size 2^( 7) =       0.000430423415

      target function =                  N/A
              le_mean =     -17.216814477528
             les_mean =     296.741906782857
             stat err =       0.000428602370
             autocorr =       1.136735600283
              std dev =       0.568512260937
             le_variance =       0.323206190835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323173850610
                                         uncertainty =       0.003380197609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323173850610
                                         uncertainty =       0.003380197609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401998875
  error estimate for blocks of size 2^( 2) =       0.000411528991
  error estimate for blocks of size 2^( 3) =       0.000419482074
  error estimate for blocks of size 2^( 4) =       0.000425427401
  error estimate for blocks of size 2^( 5) =       0.000428772620
  error estimate for blocks of size 2^( 6) =       0.000429786044
  error estimate for blocks of size 2^( 7) =       0.000430423415

      target function =                  N/A
              le_mean =     -17.216814477523
             les_mean =     296.741906782536
             stat err =       0.000428602370
             autocorr =       1.136735600230
              std dev =       0.568512260819
             le_variance =       0.323206190702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323173850677
                                         uncertainty =       0.003380197609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323173850677
                                         uncertainty =       0.003380197609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401998875
  error estimate for blocks of size 2^( 2) =       0.000411528991
  error estimate for blocks of size 2^( 3) =       0.000419482074
  error estimate for blocks of size 2^( 4) =       0.000425427401
  error estimate for blocks of size 2^( 5) =       0.000428772620
  error estimate for blocks of size 2^( 6) =       0.000429786044
  error estimate for blocks of size 2^( 7) =       0.000430423415

      target function =                  N/A
              le_mean =     -17.216814477525
             les_mean =     296.741906782697
             stat err =       0.000428602370
             autocorr =       1.136735600253
              std dev =       0.568512260878
             le_variance =       0.323206190769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323173850735
                                         uncertainty =       0.003380197610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323173850735
                                         uncertainty =       0.003380197610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401998875
  error estimate for blocks of size 2^( 2) =       0.000411528991
  error estimate for blocks of size 2^( 3) =       0.000419482074
  error estimate for blocks of size 2^( 4) =       0.000425427401
  error estimate for blocks of size 2^( 5) =       0.000428772620
  error estimate for blocks of size 2^( 6) =       0.000429786044
  error estimate for blocks of size 2^( 7) =       0.000430423415

      target function =                  N/A
              le_mean =     -17.216814477528
             les_mean =     296.741906782837
             stat err =       0.000428602370
             autocorr =       1.136735600278
              std dev =       0.568512260929
             le_variance =       0.323206190827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216814477528        initial  <--
     2.3842e+05     2.3842e+06             1.2301e-09       -17.216814477523
     9.5367e+05     9.5367e+06             3.0753e-10       -17.216814477525
     3.8147e+06     3.8147e+07             7.6883e-11       -17.216814477528

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6883
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7417e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.3054
    reference variance = 0.303371
====================================================
  Execution time = 2.1311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316219087230
                                         uncertainty =       0.003033280499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316219087230
                                         uncertainty =       0.003033280499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397692475
  error estimate for blocks of size 2^( 2) =       0.000407349480
  error estimate for blocks of size 2^( 3) =       0.000415369743
  error estimate for blocks of size 2^( 4) =       0.000421488910
  error estimate for blocks of size 2^( 5) =       0.000425833503
  error estimate for blocks of size 2^( 6) =       0.000427491534
  error estimate for blocks of size 2^( 7) =       0.000428526632

      target function =                  N/A
              le_mean =     -17.216658448989
             les_mean =     296.729646599622
             stat err =       0.000425835145
             autocorr =       1.146537481798
              std dev =       0.562422091175
             le_variance =       0.316318608642


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665844899e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216658448989       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216658448989       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216658448990       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216658449007       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216658448815       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216658449002       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216658448224       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.724376e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216658448989       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216658448989       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216658448989       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216658448968       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216658446780       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216658443827       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216658453912       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 4.310927e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216658448989       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216658448989       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216658448989       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216658448989       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216658453653       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216658435478       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216658437695       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 1.077728e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185503 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6859e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104850e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1748
    reference variance = 0.270474
====================================================
  Execution time = 2.0944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2984e-01
  Total weights = 2.0000e+06
  Execution time = 1.8701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329828084932
                                         uncertainty =       0.013329261435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329828084932
                                         uncertainty =       0.013329261435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406105904
  error estimate for blocks of size 2^( 2) =       0.000415542374
  error estimate for blocks of size 2^( 3) =       0.000424049848
  error estimate for blocks of size 2^( 4) =       0.000429566207
  error estimate for blocks of size 2^( 5) =       0.000433406697
  error estimate for blocks of size 2^( 6) =       0.000434158247
  error estimate for blocks of size 2^( 7) =       0.000433778129

      target function =                  N/A
              le_mean =     -17.216489984302
             les_mean =     296.737371225281
             stat err =       0.000432727320
             autocorr =       1.135402961929
              std dev =       0.574320477281
             le_variance =       0.329844010624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329828084934
                                         uncertainty =       0.013329261436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329828084934
                                         uncertainty =       0.013329261436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406105904
  error estimate for blocks of size 2^( 2) =       0.000415542374
  error estimate for blocks of size 2^( 3) =       0.000424049848
  error estimate for blocks of size 2^( 4) =       0.000429566207
  error estimate for blocks of size 2^( 5) =       0.000433406697
  error estimate for blocks of size 2^( 6) =       0.000434158247
  error estimate for blocks of size 2^( 7) =       0.000433778129

      target function =                  N/A
              le_mean =     -17.216489984302
             les_mean =     296.737371225278
             stat err =       0.000432727320
             autocorr =       1.135402961921
              std dev =       0.574320477283
             le_variance =       0.329844010626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329828084933
                                         uncertainty =       0.013329261436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329828084933
                                         uncertainty =       0.013329261436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406105904
  error estimate for blocks of size 2^( 2) =       0.000415542374
  error estimate for blocks of size 2^( 3) =       0.000424049848
  error estimate for blocks of size 2^( 4) =       0.000429566207
  error estimate for blocks of size 2^( 5) =       0.000433406697
  error estimate for blocks of size 2^( 6) =       0.000434158247
  error estimate for blocks of size 2^( 7) =       0.000433778129

      target function =                  N/A
              le_mean =     -17.216489984302
             les_mean =     296.737371225280
             stat err =       0.000432727320
             autocorr =       1.135402961923
              std dev =       0.574320477282
             le_variance =       0.329844010625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329828084932
                                         uncertainty =       0.013329261435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329828084932
                                         uncertainty =       0.013329261435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406105904
  error estimate for blocks of size 2^( 2) =       0.000415542374
  error estimate for blocks of size 2^( 3) =       0.000424049848
  error estimate for blocks of size 2^( 4) =       0.000429566207
  error estimate for blocks of size 2^( 5) =       0.000433406697
  error estimate for blocks of size 2^( 6) =       0.000434158247
  error estimate for blocks of size 2^( 7) =       0.000433778129

      target function =                  N/A
              le_mean =     -17.216489984302
             les_mean =     296.737371225281
             stat err =       0.000432727320
             autocorr =       1.135402961928
              std dev =       0.574320477281
             le_variance =       0.329844010624


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216489984302        initial  <--
     2.3842e+06     2.3842e+07             1.7244e-10       -17.216489984302
     9.5367e+06     9.5367e+07             4.3109e-11       -17.216489984302
     3.8147e+07     3.8147e+08             1.0777e-11       -17.216489984302

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4179
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7283e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1792
    reference variance = 0.336544
====================================================
  Execution time = 2.1517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1174e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311758148610
                                         uncertainty =       0.002002487555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311758148610
                                         uncertainty =       0.002002487555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394806480
  error estimate for blocks of size 2^( 2) =       0.000404485545
  error estimate for blocks of size 2^( 3) =       0.000413101411
  error estimate for blocks of size 2^( 4) =       0.000419978028
  error estimate for blocks of size 2^( 5) =       0.000424876986
  error estimate for blocks of size 2^( 6) =       0.000426260775
  error estimate for blocks of size 2^( 7) =       0.000428374094

      target function =                  N/A
              le_mean =     -17.216897181108
             les_mean =     296.733292702729
             stat err =       0.000424872471
             autocorr =       1.158106874416
              std dev =       0.558340678932
             le_variance =       0.311744313750


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689718111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216897181108       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216897181108       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216897181108       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216897182033       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216897158722       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216897180489       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216897170050       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.769388e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216897181108       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216897181108       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216897181108       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216897181108       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216897175606       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216897142397       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216897179054       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 4.423496e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216897181108       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216897181108       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216897181108       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216897187187       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216897188447       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216897181108       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216897209603       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 1.105881e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7106e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1945
    reference variance = 0.165359
====================================================
  Execution time = 2.1174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2595e-01
  Total weights = 2.0000e+06
  Execution time = 2.3141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051848185
                                         uncertainty =       0.006516152585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051848185
                                         uncertainty =       0.006516152585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403699745
  error estimate for blocks of size 2^( 2) =       0.000412922015
  error estimate for blocks of size 2^( 3) =       0.000421211351
  error estimate for blocks of size 2^( 4) =       0.000427454512
  error estimate for blocks of size 2^( 5) =       0.000430390108
  error estimate for blocks of size 2^( 6) =       0.000431831249
  error estimate for blocks of size 2^( 7) =       0.000432431287

      target function =                  N/A
              le_mean =     -17.216846243941
             les_mean =     296.745741392555
             stat err =       0.000430526789
             autocorr =       1.137321922341
              std dev =       0.570917654341
             le_variance =       0.325946968039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051848187
                                         uncertainty =       0.006516152586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051848187
                                         uncertainty =       0.006516152586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403699745
  error estimate for blocks of size 2^( 2) =       0.000412922015
  error estimate for blocks of size 2^( 3) =       0.000421211351
  error estimate for blocks of size 2^( 4) =       0.000427454512
  error estimate for blocks of size 2^( 5) =       0.000430390108
  error estimate for blocks of size 2^( 6) =       0.000431831249
  error estimate for blocks of size 2^( 7) =       0.000432431287

      target function =                  N/A
              le_mean =     -17.216846243941
             les_mean =     296.745741392557
             stat err =       0.000430526789
             autocorr =       1.137321922336
              std dev =       0.570917654344
             le_variance =       0.325946968041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051848186
                                         uncertainty =       0.006516152585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051848186
                                         uncertainty =       0.006516152585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403699745
  error estimate for blocks of size 2^( 2) =       0.000412922015
  error estimate for blocks of size 2^( 3) =       0.000421211351
  error estimate for blocks of size 2^( 4) =       0.000427454512
  error estimate for blocks of size 2^( 5) =       0.000430390108
  error estimate for blocks of size 2^( 6) =       0.000431831249
  error estimate for blocks of size 2^( 7) =       0.000432431287

      target function =                  N/A
              le_mean =     -17.216846243941
             les_mean =     296.745741392556
             stat err =       0.000430526789
             autocorr =       1.137321922343
              std dev =       0.570917654343
             le_variance =       0.325946968040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051848185
                                         uncertainty =       0.006516152585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051848185
                                         uncertainty =       0.006516152585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403699745
  error estimate for blocks of size 2^( 2) =       0.000412922015
  error estimate for blocks of size 2^( 3) =       0.000421211351
  error estimate for blocks of size 2^( 4) =       0.000427454512
  error estimate for blocks of size 2^( 5) =       0.000430390108
  error estimate for blocks of size 2^( 6) =       0.000431831249
  error estimate for blocks of size 2^( 7) =       0.000432431287

      target function =                  N/A
              le_mean =     -17.216846243941
             les_mean =     296.745741392555
             stat err =       0.000430526789
             autocorr =       1.137321922345
              std dev =       0.570917654341
             le_variance =       0.325946968039


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216846243941        initial  <--
     2.3842e+07     2.3842e+08             1.7694e-11       -17.216846243941
     9.5367e+07     9.5367e+08             4.4235e-12       -17.216846243941
     3.8147e+08     3.8147e+09             1.1059e-12       -17.216846243941

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4178
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8530e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2088
    reference variance = 0.266868
====================================================
  Execution time = 2.1610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316109070633
                                         uncertainty =       0.002864307893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316109070633
                                         uncertainty =       0.002864307893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397488225
  error estimate for blocks of size 2^( 2) =       0.000407143880
  error estimate for blocks of size 2^( 3) =       0.000415459682
  error estimate for blocks of size 2^( 4) =       0.000421506191
  error estimate for blocks of size 2^( 5) =       0.000425117185
  error estimate for blocks of size 2^( 6) =       0.000426293620
  error estimate for blocks of size 2^( 7) =       0.000426296463

      target function =                  N/A
              le_mean =     -17.216963577326
             les_mean =     296.739828443356
             stat err =       0.000424803365
             autocorr =       1.142161086952
              std dev =       0.562133239002
             le_variance =       0.315993778391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696357733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963577326       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216963577326       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216963577326       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216963510237       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216963587105       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216963644556       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216963343687       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 1.393118e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963577326       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216963577326       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216963577326       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216963577326       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216963269091       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216963639546       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216963577326       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 3.481307e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963577326       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216963577326       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216963577326       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216963512902       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216961636584       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216964724870       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216964018473       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 8.696097e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7150e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2189
    reference variance = 0.245867
====================================================
  Execution time = 2.3363e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2365e-01
  Total weights = 2.0000e+06
  Execution time = 1.8640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323712141399
                                         uncertainty =       0.002898594462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323712141399
                                         uncertainty =       0.002898594462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402272944
  error estimate for blocks of size 2^( 2) =       0.000412205056
  error estimate for blocks of size 2^( 3) =       0.000421109452
  error estimate for blocks of size 2^( 4) =       0.000427358448
  error estimate for blocks of size 2^( 5) =       0.000431262865
  error estimate for blocks of size 2^( 6) =       0.000433182890
  error estimate for blocks of size 2^( 7) =       0.000432649401

      target function =                  N/A
              le_mean =     -17.217066444971
             les_mean =     296.751023852259
             stat err =       0.000431113401
             autocorr =       1.148527497558
              std dev =       0.568899853708
             le_variance =       0.323647043549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323712141399
                                         uncertainty =       0.002898594462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323712141399
                                         uncertainty =       0.002898594462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402272944
  error estimate for blocks of size 2^( 2) =       0.000412205056
  error estimate for blocks of size 2^( 3) =       0.000421109452
  error estimate for blocks of size 2^( 4) =       0.000427358448
  error estimate for blocks of size 2^( 5) =       0.000431262865
  error estimate for blocks of size 2^( 6) =       0.000433182890
  error estimate for blocks of size 2^( 7) =       0.000432649401

      target function =                  N/A
              le_mean =     -17.217066444971
             les_mean =     296.751023852259
             stat err =       0.000431113401
             autocorr =       1.148527497549
              std dev =       0.568899853708
             le_variance =       0.323647043549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323712141399
                                         uncertainty =       0.002898594462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323712141399
                                         uncertainty =       0.002898594462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402272944
  error estimate for blocks of size 2^( 2) =       0.000412205056
  error estimate for blocks of size 2^( 3) =       0.000421109452
  error estimate for blocks of size 2^( 4) =       0.000427358448
  error estimate for blocks of size 2^( 5) =       0.000431262865
  error estimate for blocks of size 2^( 6) =       0.000433182890
  error estimate for blocks of size 2^( 7) =       0.000432649401

      target function =                  N/A
              le_mean =     -17.217066444971
             les_mean =     296.751023852259
             stat err =       0.000431113401
             autocorr =       1.148527497550
              std dev =       0.568899853708
             le_variance =       0.323647043549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323712141399
                                         uncertainty =       0.002898594462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323712141399
                                         uncertainty =       0.002898594462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402272944
  error estimate for blocks of size 2^( 2) =       0.000412205056
  error estimate for blocks of size 2^( 3) =       0.000421109452
  error estimate for blocks of size 2^( 4) =       0.000427358448
  error estimate for blocks of size 2^( 5) =       0.000431262865
  error estimate for blocks of size 2^( 6) =       0.000433182890
  error estimate for blocks of size 2^( 7) =       0.000432649401

      target function =                  N/A
              le_mean =     -17.217066444971
             les_mean =     296.751023852259
             stat err =       0.000431113401
             autocorr =       1.148527497556
              std dev =       0.568899853708
             le_variance =       0.323647043549


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217066444971        initial  <--
     2.3842e+08     2.3842e+09             1.3931e-12       -17.217066444971
     9.5367e+08     9.5367e+09             3.4813e-13       -17.217066444971
     3.8147e+09     3.8147e+10             8.6961e-14       -17.217066444971

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.9113
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0068e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1723
    reference variance = 0.894446
====================================================
  Execution time = 2.1505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317104725175
                                         uncertainty =       0.004165201348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317104725175
                                         uncertainty =       0.004165201348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398170160
  error estimate for blocks of size 2^( 2) =       0.000408066393
  error estimate for blocks of size 2^( 3) =       0.000416691494
  error estimate for blocks of size 2^( 4) =       0.000422812430
  error estimate for blocks of size 2^( 5) =       0.000426673218
  error estimate for blocks of size 2^( 6) =       0.000427771140
  error estimate for blocks of size 2^( 7) =       0.000429082174

      target function =                  N/A
              le_mean =     -17.216772492874
             les_mean =     296.734333865461
             stat err =       0.000426584740
             autocorr =       1.147818480681
              std dev =       0.563097640387
             le_variance =       0.317078952610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677249287e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216772492874       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216772492874       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216772492874       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216772492874       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216772256222       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216772492874       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216773644153       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 1.464342e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216772492874       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216772492874       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216772492874       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776204350       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216777582864       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216744040985       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216743059665       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216794725750       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216769116657       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 3.676026e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216772492874       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216772492874       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216772492874       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216761246903       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216772492874       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216777643552       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768770918       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216748585856       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216796278012       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216661588738       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216281788581       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216636390593       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216954625744       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216540185022       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217604185682       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216355415377       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217674980320       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217945090582       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.218055602403       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216500825794       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217750332521       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.222404451838       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217584934530       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.226214359992       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.230842060713       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.206776503573       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.197287247042       residual = 5.78e-02           smallest_sin_value = 9.99e-01
davidson iteration   27:   krylov dim =  28   energy =     -17.226630097434       residual = 1.60e-02           smallest_sin_value = 9.94e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 8.830815e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7113e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1928
    reference variance = 0.231026
====================================================
  Execution time = 2.0860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2131e-01
  Total weights = 2.0000e+06
  Execution time = 1.8689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321242243230
                                         uncertainty =       0.003921824914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321242243230
                                         uncertainty =       0.003921824914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400818842
  error estimate for blocks of size 2^( 2) =       0.000410319811
  error estimate for blocks of size 2^( 3) =       0.000419471408
  error estimate for blocks of size 2^( 4) =       0.000425477989
  error estimate for blocks of size 2^( 5) =       0.000428757151
  error estimate for blocks of size 2^( 6) =       0.000431858709
  error estimate for blocks of size 2^( 7) =       0.000433075534

      target function =                  N/A
              le_mean =     -17.217104404352
             les_mean =     296.749995398367
             stat err =       0.000429792346
             autocorr =       1.149796798815
              std dev =       0.566843442831
             le_variance =       0.321311488680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321242243230
                                         uncertainty =       0.003921824914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321242243230
                                         uncertainty =       0.003921824914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400818842
  error estimate for blocks of size 2^( 2) =       0.000410319811
  error estimate for blocks of size 2^( 3) =       0.000419471408
  error estimate for blocks of size 2^( 4) =       0.000425477989
  error estimate for blocks of size 2^( 5) =       0.000428757151
  error estimate for blocks of size 2^( 6) =       0.000431858709
  error estimate for blocks of size 2^( 7) =       0.000433075534

      target function =                  N/A
              le_mean =     -17.217104404352
             les_mean =     296.749995398366
             stat err =       0.000429792346
             autocorr =       1.149796798815
              std dev =       0.566843442831
             le_variance =       0.321311488680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321242243230
                                         uncertainty =       0.003921824914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321242243230
                                         uncertainty =       0.003921824914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400818842
  error estimate for blocks of size 2^( 2) =       0.000410319811
  error estimate for blocks of size 2^( 3) =       0.000419471408
  error estimate for blocks of size 2^( 4) =       0.000425477989
  error estimate for blocks of size 2^( 5) =       0.000428757151
  error estimate for blocks of size 2^( 6) =       0.000431858709
  error estimate for blocks of size 2^( 7) =       0.000433075534

      target function =                  N/A
              le_mean =     -17.217104404352
             les_mean =     296.749995398367
             stat err =       0.000429792346
             autocorr =       1.149796798818
              std dev =       0.566843442831
             le_variance =       0.321311488680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321242243230
                                         uncertainty =       0.003921824914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321242243230
                                         uncertainty =       0.003921824914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400818842
  error estimate for blocks of size 2^( 2) =       0.000410319811
  error estimate for blocks of size 2^( 3) =       0.000419471408
  error estimate for blocks of size 2^( 4) =       0.000425477989
  error estimate for blocks of size 2^( 5) =       0.000428757151
  error estimate for blocks of size 2^( 6) =       0.000431858709
  error estimate for blocks of size 2^( 7) =       0.000433075534

      target function =                  N/A
              le_mean =     -17.217104404352
             les_mean =     296.749995398367
             stat err =       0.000429792346
             autocorr =       1.149796798815
              std dev =       0.566843442831
             le_variance =       0.321311488680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217104404352        initial  <--
     2.3842e+09     2.3842e+10             1.4643e-13       -17.217104404352
     9.5367e+09     9.5367e+10             3.6760e-14       -17.217104404352
     3.8147e+10     3.8147e+11             8.8308e-15       -17.217104404352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3160
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1485
    reference variance = 0.166337
====================================================
  Execution time = 2.1525e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3379e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333717766921
                                         uncertainty =       0.008002584589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333717766921
                                         uncertainty =       0.008002584589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408529534
  error estimate for blocks of size 2^( 2) =       0.000417909892
  error estimate for blocks of size 2^( 3) =       0.000426311351
  error estimate for blocks of size 2^( 4) =       0.000431410636
  error estimate for blocks of size 2^( 5) =       0.000435503400
  error estimate for blocks of size 2^( 6) =       0.000438014906
  error estimate for blocks of size 2^( 7) =       0.000440067829

      target function =                  N/A
              le_mean =     -17.217029444340
             les_mean =     296.759895480307
             stat err =       0.000436249193
             autocorr =       1.140308486074
              std dev =       0.577748007302
             le_variance =       0.333792759942


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702944434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217029444340       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217029444340       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217029444340       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217029444340       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217023386411       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216990034781       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217030680831       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217026660613       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 1.116614e-14

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217029444340       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217029444340       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217029444340       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217026778801       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217029444340       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217038758691       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217029289506       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217051001392       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217492064057       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217351812712       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217194799906       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217059027464       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217308049851       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217120108088       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217438703076       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217582562149       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.220214290327       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214150161150       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217399436099       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217556374179       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.223869283460       residual = 7.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.211707801337       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.201207332245       residual = 4.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.192843075032       residual = 9.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.207790377969       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.208228585680       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.198688808494       residual = 5.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.214893503763       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.200807555490       residual = 4.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.117426356992       residual = 1.56e+00           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.237227349633       residual = 1.06e-01           smallest_sin_value = 9.99e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 2.747468e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217029444340       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217029444340       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217029444340       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217029444340       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216618470441       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216957061263       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211844242183       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216759713120       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216938847205       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217737939875       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.219214685877       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214469236561       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.219823412147       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.227516118863       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215534315887       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.218335466519       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.210737301030       residual = 6.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.189379840736       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.224326680550       residual = 8.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.255716230579       residual = 2.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.234558431251       residual = 4.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.224585919192       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.218921590072       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.200011473464       residual = 4.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.151152071054       residual = 6.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.953175003394       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.138993944356       residual = 9.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.282334965836       residual = 6.95e-01           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.186588922694       residual = 3.06e-01           smallest_sin_value = 9.94e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.26e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 4.920326e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7150e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1968
    reference variance = 0.235635
====================================================
  Execution time = 2.0854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1635e-01
  Total weights = 2.0000e+06
  Execution time = 1.8695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423619263
                                         uncertainty =       0.002979163583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423619263
                                         uncertainty =       0.002979163583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397711881
  error estimate for blocks of size 2^( 2) =       0.000407192297
  error estimate for blocks of size 2^( 3) =       0.000415403909
  error estimate for blocks of size 2^( 4) =       0.000422070903
  error estimate for blocks of size 2^( 5) =       0.000426702541
  error estimate for blocks of size 2^( 6) =       0.000428904436
  error estimate for blocks of size 2^( 7) =       0.000430973626

      target function =                  N/A
              le_mean =     -17.216180317375
             les_mean =     296.713214043054
             stat err =       0.000427162877
             autocorr =       1.153585727839
              std dev =       0.562449536279
             le_variance =       0.316349480860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423619263
                                         uncertainty =       0.002979163583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423619263
                                         uncertainty =       0.002979163583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397711881
  error estimate for blocks of size 2^( 2) =       0.000407192297
  error estimate for blocks of size 2^( 3) =       0.000415403909
  error estimate for blocks of size 2^( 4) =       0.000422070903
  error estimate for blocks of size 2^( 5) =       0.000426702541
  error estimate for blocks of size 2^( 6) =       0.000428904436
  error estimate for blocks of size 2^( 7) =       0.000430973626

      target function =                  N/A
              le_mean =     -17.216180317375
             les_mean =     296.713214043054
             stat err =       0.000427162877
             autocorr =       1.153585727838
              std dev =       0.562449536279
             le_variance =       0.316349480860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423619263
                                         uncertainty =       0.002979163583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423619263
                                         uncertainty =       0.002979163583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397711881
  error estimate for blocks of size 2^( 2) =       0.000407192297
  error estimate for blocks of size 2^( 3) =       0.000415403909
  error estimate for blocks of size 2^( 4) =       0.000422070903
  error estimate for blocks of size 2^( 5) =       0.000426702541
  error estimate for blocks of size 2^( 6) =       0.000428904436
  error estimate for blocks of size 2^( 7) =       0.000430973626

      target function =                  N/A
              le_mean =     -17.216180317375
             les_mean =     296.713214043054
             stat err =       0.000427162877
             autocorr =       1.153585727838
              std dev =       0.562449536279
             le_variance =       0.316349480860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423619263
                                         uncertainty =       0.002979163583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423619263
                                         uncertainty =       0.002979163583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397711881
  error estimate for blocks of size 2^( 2) =       0.000407192297
  error estimate for blocks of size 2^( 3) =       0.000415403909
  error estimate for blocks of size 2^( 4) =       0.000422070903
  error estimate for blocks of size 2^( 5) =       0.000426702541
  error estimate for blocks of size 2^( 6) =       0.000428904436
  error estimate for blocks of size 2^( 7) =       0.000430973626

      target function =                  N/A
              le_mean =     -17.216180317375
             les_mean =     296.713214043054
             stat err =       0.000427162877
             autocorr =       1.153585727839
              std dev =       0.562449536279
             le_variance =       0.316349480860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216180317375        initial
     2.3842e+10     2.3842e+11             1.1166e-14       -17.216180317375
     9.5367e+10     9.5367e+11             2.7475e-15       -17.216180317375  <--
     3.8147e+11     3.8147e+12             4.9203e-16       -17.216180317375

*****************************************************************************
Applying the update for shift_i =   9.5367e+10     and shift_s =   9.5367e+11
*****************************************************************************

  Execution time = 3.0405e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7562e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2511
    reference variance = 0.334094
====================================================
  Execution time = 2.1276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2205e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322115633188
                                         uncertainty =       0.005166357439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322115633188
                                         uncertainty =       0.005166357439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401282277
  error estimate for blocks of size 2^( 2) =       0.000410641415
  error estimate for blocks of size 2^( 3) =       0.000418854785
  error estimate for blocks of size 2^( 4) =       0.000424809042
  error estimate for blocks of size 2^( 5) =       0.000429403424
  error estimate for blocks of size 2^( 6) =       0.000431908448
  error estimate for blocks of size 2^( 7) =       0.000431716600

      target function =                  N/A
              le_mean =     -17.216643626872
             les_mean =     296.734872544718
             stat err =       0.000429459379
             autocorr =       1.145365836841
              std dev =       0.567498837916
             le_variance =       0.322054931036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721664362687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216643626872       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216643626872       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216643626872       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216643626872       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216640354285       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216657598817       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216631029039       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216705790099       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216653799226       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216622734289       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216375767287       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216855367776       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216556772872       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216322809021       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216932977022       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215459358948       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.218028492197       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218833444524       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216252909294       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216996213464       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216255555498       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217513851612       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214089788880       residual = 9.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217028394969       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.214896876749       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216680857125       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.217088327507       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.211988003842       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.248173676149       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.216124740071       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.206177540142       residual = 1.76e-02           smallest_sin_value = 9.96e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.05e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 1.463551e-14

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216643626872       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216643626872       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216643626872       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216640455469       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216643626872       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216611604323       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216573393281       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216732685513       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216857504809       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217083255674       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217778016675       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215565159716       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.218293074832       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217087880309       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.220609208607       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213813689839       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.218483199367       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217855030690       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.223909118322       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213373073871       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.208972773707       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.218166242111       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.224694601150       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.248151101047       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.243058214726       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.249162766133       residual = 1.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.238124085386       residual = 6.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.195084851730       residual = 6.83e-02           smallest_sin_value = 9.97e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 3.101500e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216643626872       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216643626872       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216643626872       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216643626872       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216721587944       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216647299328       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215181019710       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216270143142       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.218023603279       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217937740230       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215353142294       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215427526586       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.210685441777       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217325121744       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.204595156827       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.209160280054       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211501142219       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.158660881126       residual = 5.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.095503752347       residual = 2.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.189598747044       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.246632508734       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.272665953966       residual = 4.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.205354700803       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.204016038837       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.168022471073       residual = 3.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.280900617285       residual = 6.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.365492000072       residual = 3.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.229175374054       residual = 2.81e-02           smallest_sin_value = 9.98e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.153923189800       residual = 5.75e-01           smallest_sin_value = 9.92e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.47e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 5.169136e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263246 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6863e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1953
    reference variance = 0.194023
====================================================
  Execution time = 2.1022e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2888e-01
  Total weights = 2.0000e+06
  Execution time = 1.8685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328842567274
                                         uncertainty =       0.007946668146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328842567274
                                         uncertainty =       0.007946668146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405513602
  error estimate for blocks of size 2^( 2) =       0.000414677508
  error estimate for blocks of size 2^( 3) =       0.000423013476
  error estimate for blocks of size 2^( 4) =       0.000429139265
  error estimate for blocks of size 2^( 5) =       0.000433078628
  error estimate for blocks of size 2^( 6) =       0.000436339380
  error estimate for blocks of size 2^( 7) =       0.000437025628

      target function =                  N/A
              le_mean =     -17.216855500374
             les_mean =     296.748995719560
             stat err =       0.000433895725
             autocorr =       1.144879792815
              std dev =       0.573482836059
             le_variance =       0.328882563254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328842567274
                                         uncertainty =       0.007946668146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328842567274
                                         uncertainty =       0.007946668146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405513602
  error estimate for blocks of size 2^( 2) =       0.000414677508
  error estimate for blocks of size 2^( 3) =       0.000423013476
  error estimate for blocks of size 2^( 4) =       0.000429139265
  error estimate for blocks of size 2^( 5) =       0.000433078628
  error estimate for blocks of size 2^( 6) =       0.000436339380
  error estimate for blocks of size 2^( 7) =       0.000437025628

      target function =                  N/A
              le_mean =     -17.216855500374
             les_mean =     296.748995719560
             stat err =       0.000433895725
             autocorr =       1.144879792815
              std dev =       0.573482836059
             le_variance =       0.328882563254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328842567274
                                         uncertainty =       0.007946668146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328842567274
                                         uncertainty =       0.007946668146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405513602
  error estimate for blocks of size 2^( 2) =       0.000414677508
  error estimate for blocks of size 2^( 3) =       0.000423013476
  error estimate for blocks of size 2^( 4) =       0.000429139265
  error estimate for blocks of size 2^( 5) =       0.000433078628
  error estimate for blocks of size 2^( 6) =       0.000436339380
  error estimate for blocks of size 2^( 7) =       0.000437025628

      target function =                  N/A
              le_mean =     -17.216855500374
             les_mean =     296.748995719560
             stat err =       0.000433895725
             autocorr =       1.144879792817
              std dev =       0.573482836058
             le_variance =       0.328882563254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328842567274
                                         uncertainty =       0.007946668146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328842567274
                                         uncertainty =       0.007946668146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405513602
  error estimate for blocks of size 2^( 2) =       0.000414677508
  error estimate for blocks of size 2^( 3) =       0.000423013476
  error estimate for blocks of size 2^( 4) =       0.000429139265
  error estimate for blocks of size 2^( 5) =       0.000433078628
  error estimate for blocks of size 2^( 6) =       0.000436339380
  error estimate for blocks of size 2^( 7) =       0.000437025628

      target function =                  N/A
              le_mean =     -17.216855500374
             les_mean =     296.748995719560
             stat err =       0.000433895725
             autocorr =       1.144879792816
              std dev =       0.573482836059
             le_variance =       0.328882563254


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216855500374        initial
     2.3842e+10     2.3842e+11             1.4636e-14       -17.216855500374
     9.5367e+10     9.5367e+11             3.1015e-15       -17.216855500374  <--
     3.8147e+11     3.8147e+12             5.1691e-16       -17.216855500374

*****************************************************************************
Applying the update for shift_i =   9.5367e+10     and shift_s =   9.5367e+11
*****************************************************************************

  Execution time = 3.0476e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1352
    reference variance = 0.196511
====================================================
  Execution time = 2.1173e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3485e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334844477301
                                         uncertainty =       0.010423189008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334844477301
                                         uncertainty =       0.010423189008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409175368
  error estimate for blocks of size 2^( 2) =       0.000418772791
  error estimate for blocks of size 2^( 3) =       0.000427118037
  error estimate for blocks of size 2^( 4) =       0.000433987450
  error estimate for blocks of size 2^( 5) =       0.000437759000
  error estimate for blocks of size 2^( 6) =       0.000440481651
  error estimate for blocks of size 2^( 7) =       0.000443687783

      target function =                  N/A
              le_mean =     -17.216682322998
             les_mean =     296.748999007334
             stat err =       0.000438978971
             autocorr =       1.150981832207
              std dev =       0.578661354971
             le_variance =       0.334848963737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668232300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216682322998       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216682322998       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216682322998       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216693561541       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216680271030       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216684379835       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216673373071       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216693149791       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216661572459       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216543977221       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216300422009       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216432658414       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216595992935       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216719852967       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216944271481       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217237175998       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217730170016       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217684863939       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217054642717       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217822360618       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215559857053       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.211986560962       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217874118809       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.220727555146       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.210649601669       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.213746683913       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.221222400487       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.222246549371       residual = 4.89e-03           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.217377647780       residual = 8.20e-05           smallest_sin_value = 9.97e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.68e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 1.281232e-14

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216682322998       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216682322998       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216682322998       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216670838343       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216682322998       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216677947372       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216663415469       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216286022263       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216442568679       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216602073607       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216895029481       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216447030602       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216069040609       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215561167658       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217449193939       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215850177631       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211173343054       residual = 4.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.227380841130       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.223382183253       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215995156409       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.198248125403       residual = 5.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.223816678019       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.212922386784       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217409002789       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.218346007264       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.215856160296       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.209793649878       residual = 7.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.228825302489       residual = 3.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.199322005469       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.210060984819       residual = 7.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.217021440065       residual = 1.21e-03           smallest_sin_value = 9.97e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 3.061163e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216682322998       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216682322998       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216682322998       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216476087942       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216513957148       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217887361618       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.219556936335       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217042474989       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213237035819       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216902475168       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214439270399       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216317682701       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.203413577242       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.220407281140       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.221916981157       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.220320050199       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.170419954094       residual = 3.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.201214609858       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.153831751477       residual = 6.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.182766121183       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.244458088546       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.293834904863       residual = 9.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.230476420791       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.228064691510       residual = 3.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.176850627510       residual = 3.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.205273225992       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.261106565653       residual = 3.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.068328719506       residual = 3.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.935495153236       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.839458407903       residual = 2.23e+01           smallest_sin_value = 9.97e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.21e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 2.485043e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6754e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1625
    reference variance = 0.35854
====================================================
  Execution time = 2.1012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2075e-01
  Total weights = 2.0000e+06
  Execution time = 1.8605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320826735585
                                         uncertainty =       0.004232856396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320826735585
                                         uncertainty =       0.004232856396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467898
  error estimate for blocks of size 2^( 2) =       0.000409995287
  error estimate for blocks of size 2^( 3) =       0.000418983353
  error estimate for blocks of size 2^( 4) =       0.000425164290
  error estimate for blocks of size 2^( 5) =       0.000428584058
  error estimate for blocks of size 2^( 6) =       0.000429871092
  error estimate for blocks of size 2^( 7) =       0.000432718451

      target function =                  N/A
              le_mean =     -17.216948923338
             les_mean =     296.744079143818
             stat err =       0.000429084472
             autocorr =       1.148021919131
              std dev =       0.566347133266
             le_variance =       0.320749075358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320826735585
                                         uncertainty =       0.004232856396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320826735585
                                         uncertainty =       0.004232856396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467898
  error estimate for blocks of size 2^( 2) =       0.000409995287
  error estimate for blocks of size 2^( 3) =       0.000418983353
  error estimate for blocks of size 2^( 4) =       0.000425164290
  error estimate for blocks of size 2^( 5) =       0.000428584058
  error estimate for blocks of size 2^( 6) =       0.000429871092
  error estimate for blocks of size 2^( 7) =       0.000432718451

      target function =                  N/A
              le_mean =     -17.216948923338
             les_mean =     296.744079143818
             stat err =       0.000429084472
             autocorr =       1.148021919135
              std dev =       0.566347133266
             le_variance =       0.320749075358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320826735585
                                         uncertainty =       0.004232856396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320826735585
                                         uncertainty =       0.004232856396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467898
  error estimate for blocks of size 2^( 2) =       0.000409995287
  error estimate for blocks of size 2^( 3) =       0.000418983353
  error estimate for blocks of size 2^( 4) =       0.000425164290
  error estimate for blocks of size 2^( 5) =       0.000428584058
  error estimate for blocks of size 2^( 6) =       0.000429871092
  error estimate for blocks of size 2^( 7) =       0.000432718451

      target function =                  N/A
              le_mean =     -17.216948923338
             les_mean =     296.744079143818
             stat err =       0.000429084472
             autocorr =       1.148021919131
              std dev =       0.566347133266
             le_variance =       0.320749075358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320826735585
                                         uncertainty =       0.004232856396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320826735585
                                         uncertainty =       0.004232856396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467898
  error estimate for blocks of size 2^( 2) =       0.000409995287
  error estimate for blocks of size 2^( 3) =       0.000418983353
  error estimate for blocks of size 2^( 4) =       0.000425164290
  error estimate for blocks of size 2^( 5) =       0.000428584058
  error estimate for blocks of size 2^( 6) =       0.000429871092
  error estimate for blocks of size 2^( 7) =       0.000432718451

      target function =                  N/A
              le_mean =     -17.216948923338
             les_mean =     296.744079143818
             stat err =       0.000429084472
             autocorr =       1.148021919131
              std dev =       0.566347133266
             le_variance =       0.320749075358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216948923338        initial  <--
     2.3842e+10     2.3842e+11             1.2812e-14       -17.216948923338
     9.5367e+10     9.5367e+11             3.0612e-15       -17.216948923338
     3.8147e+11     3.8147e+12             2.4850e-16       -17.216948923338

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.1561
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.190246
====================================================
  Execution time = 2.1351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2561e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325687069602
                                         uncertainty =       0.003930346374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325687069602
                                         uncertainty =       0.003930346374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403494105
  error estimate for blocks of size 2^( 2) =       0.000412630867
  error estimate for blocks of size 2^( 3) =       0.000420683806
  error estimate for blocks of size 2^( 4) =       0.000426882184
  error estimate for blocks of size 2^( 5) =       0.000431139259
  error estimate for blocks of size 2^( 6) =       0.000432757125
  error estimate for blocks of size 2^( 7) =       0.000434929507

      target function =                  N/A
              le_mean =     -17.217326183376
             les_mean =     296.761935726748
             stat err =       0.000431427019
             autocorr =       1.143247585813
              std dev =       0.570626834982
             le_variance =       0.325614984802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721732618338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217326183376       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217326183376       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217326183376       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217326183376       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217334930183       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217243502582       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217214811050       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216620130207       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216124516860       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212898130924       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211845930102       residual = 4.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217884375077       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.219361699580       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216720909755       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215574685002       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.208873454254       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217566575552       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.222948303575       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.212750703282       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.225839178532       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.238960204361       residual = 7.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.201720596823       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.235527220955       residual = 5.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.178196965366       residual = 2.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.202575851554       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.237877869619       residual = 6.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.194973095031       residual = 7.90e-02           smallest_sin_value = 9.99e-01
davidson iteration   27:   krylov dim =  28   energy =     -17.231630291732       residual = 2.87e-02           smallest_sin_value = 9.92e-01
davidson iteration   28 stopping due to small subspace S singular value of 8.72e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 8.805291e-16

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217326183376       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217326183376       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217326183376       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217326183376       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217092330608       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217347802812       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.224544670921       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216638210950       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.222741739999       residual = 4.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.221395906188       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211477796724       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.208897322856       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.219632749902       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.222995648117       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.195704955480       residual = 7.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.203764537973       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.207476314701       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.196581541534       residual = 7.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.174991327991       residual = 2.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.359764008224       residual = 3.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.327204131992       residual = 1.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.971398966107       residual = 9.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.485568218499       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.194276941439       residual = 8.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.558013250002       residual = 1.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.411461171740       residual = 5.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.407771088410       residual = 6.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -18.525714422003       residual = 2.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.672609592055       residual = 2.92e+01           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.380988956079       residual = 3.41e+00           smallest_sin_value = 9.91e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.03e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 1.059351e-16

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217326183376       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217326183376       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217326183376       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218878612901       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.222086557359       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214571504901       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.228622797450       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.195186224866       residual = 6.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.165690019055       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.173809420364       residual = 2.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.184290332683       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.180814668242       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.139110998241       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.062558334545       residual = 3.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.092879670425       residual = 2.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.073634114878       residual = 3.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.239783602746       residual = 6.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.124444718677       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.224440951327       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.062928735158       residual = 4.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.311668711391       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.340128321074       residual = 2.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.103667459149       residual = 1.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.690503496391       residual = 3.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903550547102       residual = 1.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.050383607636       residual = 4.53e+00           smallest_sin_value = 9.97e-01
davidson iteration   26 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 1.735330e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.330636 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6860e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1742
    reference variance = 0.141416
====================================================
  Execution time = 2.1133e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1582e-01
  Total weights = 2.0000e+06
  Execution time = 2.1867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876322133
                                         uncertainty =       0.002930783782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876322133
                                         uncertainty =       0.002930783782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397381670
  error estimate for blocks of size 2^( 2) =       0.000406813490
  error estimate for blocks of size 2^( 3) =       0.000414991936
  error estimate for blocks of size 2^( 4) =       0.000421382539
  error estimate for blocks of size 2^( 5) =       0.000425644151
  error estimate for blocks of size 2^( 6) =       0.000426705786
  error estimate for blocks of size 2^( 7) =       0.000427248567

      target function =                  N/A
              le_mean =     -17.217690143069
             les_mean =     296.764678087848
             stat err =       0.000425245261
             autocorr =       1.145152441453
              std dev =       0.561982546889
             le_variance =       0.315824383008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876322133
                                         uncertainty =       0.002930783782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876322133
                                         uncertainty =       0.002930783782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397381670
  error estimate for blocks of size 2^( 2) =       0.000406813490
  error estimate for blocks of size 2^( 3) =       0.000414991936
  error estimate for blocks of size 2^( 4) =       0.000421382539
  error estimate for blocks of size 2^( 5) =       0.000425644151
  error estimate for blocks of size 2^( 6) =       0.000426705786
  error estimate for blocks of size 2^( 7) =       0.000427248567

      target function =                  N/A
              le_mean =     -17.217690143069
             les_mean =     296.764678087848
             stat err =       0.000425245261
             autocorr =       1.145152441453
              std dev =       0.561982546889
             le_variance =       0.315824383008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876322133
                                         uncertainty =       0.002930783782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876322133
                                         uncertainty =       0.002930783782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397381670
  error estimate for blocks of size 2^( 2) =       0.000406813490
  error estimate for blocks of size 2^( 3) =       0.000414991936
  error estimate for blocks of size 2^( 4) =       0.000421382539
  error estimate for blocks of size 2^( 5) =       0.000425644151
  error estimate for blocks of size 2^( 6) =       0.000426705786
  error estimate for blocks of size 2^( 7) =       0.000427248567

      target function =                  N/A
              le_mean =     -17.217690143069
             les_mean =     296.764678087848
             stat err =       0.000425245261
             autocorr =       1.145152441453
              std dev =       0.561982546889
             le_variance =       0.315824383008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876322133
                                         uncertainty =       0.002930783782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876322133
                                         uncertainty =       0.002930783782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397381670
  error estimate for blocks of size 2^( 2) =       0.000406813490
  error estimate for blocks of size 2^( 3) =       0.000414991936
  error estimate for blocks of size 2^( 4) =       0.000421382539
  error estimate for blocks of size 2^( 5) =       0.000425644151
  error estimate for blocks of size 2^( 6) =       0.000426705786
  error estimate for blocks of size 2^( 7) =       0.000427248567

      target function =                  N/A
              le_mean =     -17.217690143069
             les_mean =     296.764678087848
             stat err =       0.000425245261
             autocorr =       1.145152441453
              std dev =       0.561982546889
             le_variance =       0.315824383008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217690143069        initial  <--
     2.3842e+11     2.3842e+12             8.8053e-16       -17.217690143069
     9.5367e+11     9.5367e+12             1.0594e-16       -17.217690143069
     3.8147e+12     3.8147e+13             1.7353e-17       -17.217690143069

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8823
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8749e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2358
    reference variance = 0.536656
====================================================
  Execution time = 2.1168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1077e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310754866058
                                         uncertainty =       0.002270899548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310754866058
                                         uncertainty =       0.002270899548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394189745
  error estimate for blocks of size 2^( 2) =       0.000403801223
  error estimate for blocks of size 2^( 3) =       0.000412079573
  error estimate for blocks of size 2^( 4) =       0.000419074861
  error estimate for blocks of size 2^( 5) =       0.000422475756
  error estimate for blocks of size 2^( 6) =       0.000426141295
  error estimate for blocks of size 2^( 7) =       0.000425012613

      target function =                  N/A
              le_mean =     -17.216808531359
             les_mean =     296.729266960939
             stat err =       0.000423176131
             autocorr =       1.152475450669
              std dev =       0.557468484186
             le_variance =       0.310771110860


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680853136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216808531359       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216808531359       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216808531359       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216808531359       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216808531359       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216808531359       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.229011917467       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.197561010724       residual = 5.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.208385385479       residual = 5.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.199748142081       residual = 5.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.160875278213       residual = 3.93e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.047371259540       residual = 4.33e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.884773409983       residual = 1.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.105139591509       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.136616386560       residual = 9.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.779214509624       residual = 4.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.089238875244       residual = 2.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.117089751266       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.884727479619       residual = 7.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.850224804308       residual = 2.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.551752096002       residual = 2.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -18.740708280732       residual = 3.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.049320654463       residual = 3.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.681625345868       residual = 2.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -15.627741634941       residual = 4.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.753650802763       residual = 6.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -15.798565895806       residual = 3.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -18.222717711286       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.018467208988       residual = 5.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.708319336604       residual = 3.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -11.513118331365       residual = 5.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -12.314316671832       residual = 3.80e+03           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -20.471122561874       residual = 1.72e+03           smallest_sin_value = 9.94e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.45e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216808531359       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216808531359       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216808531359       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218754207001       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216808531359       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.188973130321       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.274653866817       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.232560566525       residual = 2.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.921136962218       residual = 1.39e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.356528889933       residual = 3.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.581609756184       residual = 6.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -18.030965491196       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.350165299837       residual = 2.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.644358177584       residual = 5.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.360694753182       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -21.063066843116       residual = 2.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.865816917623       residual = 5.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -15.784554914523       residual = 3.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -14.265474475335       residual = 1.45e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -18.651786713835       residual = 3.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -24.771706209612       residual = 8.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -13.284442950914       residual = 2.47e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -13.866234505775       residual = 1.79e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -23.656803528037       residual = 6.42e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.741961672744       residual = 7.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   25 stopping due to too large eigenvalue change
davidson solver did not converge after         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6714e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.17
    reference variance = 0.282173
====================================================
  Execution time = 2.1026e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1787e-01
  Total weights = 2.0000e+06
  Execution time = 1.8753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868711877
                                         uncertainty =       0.004113490162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868711877
                                         uncertainty =       0.004113490162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398664773
  error estimate for blocks of size 2^( 2) =       0.000408197549
  error estimate for blocks of size 2^( 3) =       0.000416798391
  error estimate for blocks of size 2^( 4) =       0.000422489002
  error estimate for blocks of size 2^( 5) =       0.000425982417
  error estimate for blocks of size 2^( 6) =       0.000429197332
  error estimate for blocks of size 2^( 7) =       0.000433878900

      target function =                  N/A
              le_mean =     -17.216517190242
             les_mean =     296.726331205892
             stat err =       0.000427886913
             autocorr =       1.151972953730
              std dev =       0.563797129222
             le_variance =       0.317867202919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868711877
                                         uncertainty =       0.004113490162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868711877
                                         uncertainty =       0.004113490162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398664773
  error estimate for blocks of size 2^( 2) =       0.000408197549
  error estimate for blocks of size 2^( 3) =       0.000416798391
  error estimate for blocks of size 2^( 4) =       0.000422489002
  error estimate for blocks of size 2^( 5) =       0.000425982417
  error estimate for blocks of size 2^( 6) =       0.000429197332
  error estimate for blocks of size 2^( 7) =       0.000433878900

      target function =                  N/A
              le_mean =     -17.216517190242
             les_mean =     296.726331205892
             stat err =       0.000427886913
             autocorr =       1.151972953730
              std dev =       0.563797129222
             le_variance =       0.317867202919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868711877
                                         uncertainty =       0.004113490162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868711877
                                         uncertainty =       0.004113490162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398664773
  error estimate for blocks of size 2^( 2) =       0.000408197549
  error estimate for blocks of size 2^( 3) =       0.000416798391
  error estimate for blocks of size 2^( 4) =       0.000422489002
  error estimate for blocks of size 2^( 5) =       0.000425982417
  error estimate for blocks of size 2^( 6) =       0.000429197332
  error estimate for blocks of size 2^( 7) =       0.000433878900

      target function =                  N/A
              le_mean =     -17.216517190242
             les_mean =     296.726331205892
             stat err =       0.000427886913
             autocorr =       1.151972953730
              std dev =       0.563797129222
             le_variance =       0.317867202919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868711877
                                         uncertainty =       0.004113490162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317868711877
                                         uncertainty =       0.004113490162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398664773
  error estimate for blocks of size 2^( 2) =       0.000408197549
  error estimate for blocks of size 2^( 3) =       0.000416798391
  error estimate for blocks of size 2^( 4) =       0.000422489002
  error estimate for blocks of size 2^( 5) =       0.000425982417
  error estimate for blocks of size 2^( 6) =       0.000429197332
  error estimate for blocks of size 2^( 7) =       0.000433878900

      target function =                  N/A
              le_mean =     -17.216517190242
             les_mean =     296.726331205892
             stat err =       0.000427886913
             autocorr =       1.151972953730
              std dev =       0.563797129222
             le_variance =       0.317867202919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216517190242        initial  <--
     2.3842e+12     2.3842e+13             0.0000e+00       -17.216517190242
     9.5367e+12     9.5367e+13             0.0000e+00       -17.216517190242
     3.8147e+13     3.8147e+14             0.0000e+00       -17.216517190242

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5583
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1959
    reference variance = 0.254822
====================================================
  Execution time = 2.1532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2113e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321161195952
                                         uncertainty =       0.005605301866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321161195952
                                         uncertainty =       0.005605301866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400703200
  error estimate for blocks of size 2^( 2) =       0.000410297566
  error estimate for blocks of size 2^( 3) =       0.000418193144
  error estimate for blocks of size 2^( 4) =       0.000424524773
  error estimate for blocks of size 2^( 5) =       0.000428797209
  error estimate for blocks of size 2^( 6) =       0.000430605578
  error estimate for blocks of size 2^( 7) =       0.000431763793

      target function =                  N/A
              le_mean =     -17.217173499810
             les_mean =     296.752189271679
             stat err =       0.000428922838
             autocorr =       1.145810293183
              std dev =       0.566679900545
             le_variance =       0.321126109682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717349981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217173499810       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217173499810       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217173499810       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217173499810       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217173499810       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217173499810       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7107e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1819
    reference variance = 0.452955
====================================================
  Execution time = 2.1118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2189e-01
  Total weights = 2.0000e+06
  Execution time = 1.8809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321884215431
                                         uncertainty =       0.003232682208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321884215431
                                         uncertainty =       0.003232682208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401179189
  error estimate for blocks of size 2^( 2) =       0.000410932764
  error estimate for blocks of size 2^( 3) =       0.000419337731
  error estimate for blocks of size 2^( 4) =       0.000425760970
  error estimate for blocks of size 2^( 5) =       0.000429140461
  error estimate for blocks of size 2^( 6) =       0.000430837424
  error estimate for blocks of size 2^( 7) =       0.000431368605

      target function =                  N/A
              le_mean =     -17.216718144961
             les_mean =     296.737273005376
             stat err =       0.000429276865
             autocorr =       1.144980723778
              std dev =       0.567353049963
             le_variance =       0.321889483302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321884215431
                                         uncertainty =       0.003232682208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321884215431
                                         uncertainty =       0.003232682208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401179189
  error estimate for blocks of size 2^( 2) =       0.000410932764
  error estimate for blocks of size 2^( 3) =       0.000419337731
  error estimate for blocks of size 2^( 4) =       0.000425760970
  error estimate for blocks of size 2^( 5) =       0.000429140461
  error estimate for blocks of size 2^( 6) =       0.000430837424
  error estimate for blocks of size 2^( 7) =       0.000431368605

      target function =                  N/A
              le_mean =     -17.216718144961
             les_mean =     296.737273005376
             stat err =       0.000429276865
             autocorr =       1.144980723778
              std dev =       0.567353049963
             le_variance =       0.321889483302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321884215431
                                         uncertainty =       0.003232682208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321884215431
                                         uncertainty =       0.003232682208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401179189
  error estimate for blocks of size 2^( 2) =       0.000410932764
  error estimate for blocks of size 2^( 3) =       0.000419337731
  error estimate for blocks of size 2^( 4) =       0.000425760970
  error estimate for blocks of size 2^( 5) =       0.000429140461
  error estimate for blocks of size 2^( 6) =       0.000430837424
  error estimate for blocks of size 2^( 7) =       0.000431368605

      target function =                  N/A
              le_mean =     -17.216718144961
             les_mean =     296.737273005376
             stat err =       0.000429276865
             autocorr =       1.144980723778
              std dev =       0.567353049963
             le_variance =       0.321889483302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321884215431
                                         uncertainty =       0.003232682208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321884215431
                                         uncertainty =       0.003232682208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401179189
  error estimate for blocks of size 2^( 2) =       0.000410932764
  error estimate for blocks of size 2^( 3) =       0.000419337731
  error estimate for blocks of size 2^( 4) =       0.000425760970
  error estimate for blocks of size 2^( 5) =       0.000429140461
  error estimate for blocks of size 2^( 6) =       0.000430837424
  error estimate for blocks of size 2^( 7) =       0.000431368605

      target function =                  N/A
              le_mean =     -17.216718144961
             les_mean =     296.737273005376
             stat err =       0.000429276865
             autocorr =       1.144980723778
              std dev =       0.567353049963
             le_variance =       0.321889483302


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216718144961        initial  <--
     2.3842e+13     2.3842e+14             0.0000e+00       -17.216718144961
     9.5367e+13     9.5367e+14             0.0000e+00       -17.216718144961
     3.8147e+14     3.8147e+15             0.0000e+00       -17.216718144961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6439
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1772
    reference variance = 0.197958
====================================================
  Execution time = 2.1355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1854e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318571047320
                                         uncertainty =       0.003263042482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318571047320
                                         uncertainty =       0.003263042482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399089045
  error estimate for blocks of size 2^( 2) =       0.000408670768
  error estimate for blocks of size 2^( 3) =       0.000417361079
  error estimate for blocks of size 2^( 4) =       0.000424173567
  error estimate for blocks of size 2^( 5) =       0.000428771449
  error estimate for blocks of size 2^( 6) =       0.000430156287
  error estimate for blocks of size 2^( 7) =       0.000432996560

      target function =                  N/A
              le_mean =     -17.217386508446
             les_mean =     296.756942154351
             stat err =       0.000429024466
             autocorr =       1.155645157886
              std dev =       0.564397140683
             le_variance =       0.318544132411


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721738650845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217386508446       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217386508446       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217386508446       residual = 2.87e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.248331349830       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216627979803       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -15.992469818927       residual = 2.07e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217704845625       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.956151322401       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -18.848872714642       residual = 4.66e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.924557847541       residual = 7.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -15.765749616933       residual = 3.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.335222789137       residual = 1.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.989825772889       residual = 5.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -19.325874479802       residual = 5.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.812752063172       residual = 4.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   15 stopping due to too large eigenvalue change
davidson solver did not converge after         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+14 is 3.407803e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217386508446       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217386508446       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217386508446       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217386508446       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -18.254769174134       residual = 1.44e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201315357084       residual = 7.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -19.901250216995       residual = 1.06e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.503379633650       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -18.690060805559       residual = 6.14e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.013340482734       residual = 1.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -20.375748284571       residual = 1.55e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.523458711277       residual = 4.67e+03           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 8.519507e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217386508446       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217386508446       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.357871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6914e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2789
    reference variance = 1.01887
====================================================
  Execution time = 2.0974e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2491e-01
  Total weights = 2.0000e+06
  Execution time = 1.8768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324896546758
                                         uncertainty =       0.004677846181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324896546758
                                         uncertainty =       0.004677846181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403059624
  error estimate for blocks of size 2^( 2) =       0.000412202095
  error estimate for blocks of size 2^( 3) =       0.000420579431
  error estimate for blocks of size 2^( 4) =       0.000426371129
  error estimate for blocks of size 2^( 5) =       0.000430012721
  error estimate for blocks of size 2^( 6) =       0.000432537597
  error estimate for blocks of size 2^( 7) =       0.000430910812

      target function =                  N/A
              le_mean =     -17.216694463365
             les_mean =     296.739482203486
             stat err =       0.000429958065
             autocorr =       1.137924917665
              std dev =       0.570012386784
             le_variance =       0.324914121087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324896546758
                                         uncertainty =       0.004677846181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324896546758
                                         uncertainty =       0.004677846181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403059624
  error estimate for blocks of size 2^( 2) =       0.000412202095
  error estimate for blocks of size 2^( 3) =       0.000420579431
  error estimate for blocks of size 2^( 4) =       0.000426371129
  error estimate for blocks of size 2^( 5) =       0.000430012721
  error estimate for blocks of size 2^( 6) =       0.000432537597
  error estimate for blocks of size 2^( 7) =       0.000430910812

      target function =                  N/A
              le_mean =     -17.216694463365
             les_mean =     296.739482203486
             stat err =       0.000429958065
             autocorr =       1.137924917665
              std dev =       0.570012386784
             le_variance =       0.324914121087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324896546758
                                         uncertainty =       0.004677846181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324896546758
                                         uncertainty =       0.004677846181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403059624
  error estimate for blocks of size 2^( 2) =       0.000412202095
  error estimate for blocks of size 2^( 3) =       0.000420579431
  error estimate for blocks of size 2^( 4) =       0.000426371129
  error estimate for blocks of size 2^( 5) =       0.000430012721
  error estimate for blocks of size 2^( 6) =       0.000432537597
  error estimate for blocks of size 2^( 7) =       0.000430910812

      target function =                  N/A
              le_mean =     -17.216694463365
             les_mean =     296.739482203486
             stat err =       0.000429958065
             autocorr =       1.137924917665
              std dev =       0.570012386784
             le_variance =       0.324914121087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324896546758
                                         uncertainty =       0.004677846181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324896546758
                                         uncertainty =       0.004677846181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403059624
  error estimate for blocks of size 2^( 2) =       0.000412202095
  error estimate for blocks of size 2^( 3) =       0.000420579431
  error estimate for blocks of size 2^( 4) =       0.000426371129
  error estimate for blocks of size 2^( 5) =       0.000430012721
  error estimate for blocks of size 2^( 6) =       0.000432537597
  error estimate for blocks of size 2^( 7) =       0.000430910812

      target function =                  N/A
              le_mean =     -17.216694463365
             les_mean =     296.739482203486
             stat err =       0.000429958065
             autocorr =       1.137924917665
              std dev =       0.570012386784
             le_variance =       0.324914121087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216694463365        initial  <--
     2.3842e+14     2.3842e+15             3.4078e-19       -17.216694463365
     9.5367e+14     9.5367e+15             8.5195e-20       -17.216694463365
     3.8147e+15     3.8147e+16             0.0000e+00       -17.216694463365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4654
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7386e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1466
    reference variance = 0.849192
====================================================
  Execution time = 2.1396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327007086574
                                         uncertainty =       0.010907187611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327007086574
                                         uncertainty =       0.010907187611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404309773
  error estimate for blocks of size 2^( 2) =       0.000414032208
  error estimate for blocks of size 2^( 3) =       0.000422215348
  error estimate for blocks of size 2^( 4) =       0.000428577028
  error estimate for blocks of size 2^( 5) =       0.000432894675
  error estimate for blocks of size 2^( 6) =       0.000434371946
  error estimate for blocks of size 2^( 7) =       0.000437160719

      target function =                  N/A
              le_mean =     -17.216921301911
             les_mean =     296.749311737088
             stat err =       0.000433251092
             autocorr =       1.148288075429
              std dev =       0.571780363737
             le_variance =       0.326932784355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692130191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216921301911       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216921301911       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216921301911       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216921301911       residual = 1.22e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.040576085476       residual = 4.77e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.517550509330       residual = 7.59e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -18.326086983275       residual = 7.73e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -19.020752843018       residual = 2.87e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -18.358956993218       residual = 8.05e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -23.738262179290       residual = 7.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+15 is 3.209071e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216921301911       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216921301911       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216921301911       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216921301911       residual = 2.81e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 8.022677e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216921301911       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216921301911       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216921301911       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216921301911       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 2.005669e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6958e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2097
    reference variance = 0.170922
====================================================
  Execution time = 2.1086e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2032e-01
  Total weights = 2.0000e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320371144454
                                         uncertainty =       0.003931930295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320371144454
                                         uncertainty =       0.003931930295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400197693
  error estimate for blocks of size 2^( 2) =       0.000409525785
  error estimate for blocks of size 2^( 3) =       0.000418167572
  error estimate for blocks of size 2^( 4) =       0.000424374665
  error estimate for blocks of size 2^( 5) =       0.000428253742
  error estimate for blocks of size 2^( 6) =       0.000430071271
  error estimate for blocks of size 2^( 7) =       0.000431597345

      target function =                  N/A
              le_mean =     -17.216929860388
             les_mean =     296.742990043581
             stat err =       0.000428574256
             autocorr =       1.146840439860
              std dev =       0.565965004412
             le_variance =       0.320316386219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320371144454
                                         uncertainty =       0.003931930295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320371144454
                                         uncertainty =       0.003931930295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400197693
  error estimate for blocks of size 2^( 2) =       0.000409525785
  error estimate for blocks of size 2^( 3) =       0.000418167572
  error estimate for blocks of size 2^( 4) =       0.000424374665
  error estimate for blocks of size 2^( 5) =       0.000428253742
  error estimate for blocks of size 2^( 6) =       0.000430071271
  error estimate for blocks of size 2^( 7) =       0.000431597345

      target function =                  N/A
              le_mean =     -17.216929860388
             les_mean =     296.742990043581
             stat err =       0.000428574256
             autocorr =       1.146840439860
              std dev =       0.565965004412
             le_variance =       0.320316386219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320371144454
                                         uncertainty =       0.003931930295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320371144454
                                         uncertainty =       0.003931930295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400197693
  error estimate for blocks of size 2^( 2) =       0.000409525785
  error estimate for blocks of size 2^( 3) =       0.000418167572
  error estimate for blocks of size 2^( 4) =       0.000424374665
  error estimate for blocks of size 2^( 5) =       0.000428253742
  error estimate for blocks of size 2^( 6) =       0.000430071271
  error estimate for blocks of size 2^( 7) =       0.000431597345

      target function =                  N/A
              le_mean =     -17.216929860388
             les_mean =     296.742990043581
             stat err =       0.000428574256
             autocorr =       1.146840439860
              std dev =       0.565965004412
             le_variance =       0.320316386219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320371144454
                                         uncertainty =       0.003931930295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320371144454
                                         uncertainty =       0.003931930295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400197693
  error estimate for blocks of size 2^( 2) =       0.000409525785
  error estimate for blocks of size 2^( 3) =       0.000418167572
  error estimate for blocks of size 2^( 4) =       0.000424374665
  error estimate for blocks of size 2^( 5) =       0.000428253742
  error estimate for blocks of size 2^( 6) =       0.000430071271
  error estimate for blocks of size 2^( 7) =       0.000431597345

      target function =                  N/A
              le_mean =     -17.216929860388
             les_mean =     296.742990043581
             stat err =       0.000428574256
             autocorr =       1.146840439860
              std dev =       0.565965004412
             le_variance =       0.320316386219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216929860388        initial  <--
     2.3842e+15     2.3842e+16             3.2091e-20       -17.216929860388
     9.5367e+15     9.5367e+16             8.0227e-21       -17.216929860388
     3.8147e+16     3.8147e+17             2.0057e-21       -17.216929860388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5950
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.4196
    reference variance = 2.62031
====================================================
  Execution time = 2.3235e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1348e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313351080905
                                         uncertainty =       0.002816394837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313351080905
                                         uncertainty =       0.002816394837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395906771
  error estimate for blocks of size 2^( 2) =       0.000405525436
  error estimate for blocks of size 2^( 3) =       0.000413687640
  error estimate for blocks of size 2^( 4) =       0.000419829859
  error estimate for blocks of size 2^( 5) =       0.000423010165
  error estimate for blocks of size 2^( 6) =       0.000425587889
  error estimate for blocks of size 2^( 7) =       0.000425008413

      target function =                  N/A
              le_mean =     -17.216494358962
             les_mean =     296.721162198600
             stat err =       0.000423359081
             autocorr =       1.143488762616
              std dev =       0.559896725438
             le_variance =       0.313484343156


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649435896e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216494358962       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216494358962       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216494358962       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216494358962       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216494358962       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216494358962       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8762e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.255
    reference variance = 0.170245
====================================================
  Execution time = 2.1533e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2474e-01
  Total weights = 2.0000e+06
  Execution time = 1.8693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324708263051
                                         uncertainty =       0.004582283189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324708263051
                                         uncertainty =       0.004582283189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402953624
  error estimate for blocks of size 2^( 2) =       0.000411915883
  error estimate for blocks of size 2^( 3) =       0.000419979721
  error estimate for blocks of size 2^( 4) =       0.000426616318
  error estimate for blocks of size 2^( 5) =       0.000430806246
  error estimate for blocks of size 2^( 6) =       0.000432388807
  error estimate for blocks of size 2^( 7) =       0.000433102323

      target function =                  N/A
              le_mean =     -17.216762894055
             les_mean =     296.741667633605
             stat err =       0.000430728424
             autocorr =       1.142607134676
              std dev =       0.569862479792
             le_variance =       0.324743245875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324708263051
                                         uncertainty =       0.004582283189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324708263051
                                         uncertainty =       0.004582283189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402953624
  error estimate for blocks of size 2^( 2) =       0.000411915883
  error estimate for blocks of size 2^( 3) =       0.000419979721
  error estimate for blocks of size 2^( 4) =       0.000426616318
  error estimate for blocks of size 2^( 5) =       0.000430806246
  error estimate for blocks of size 2^( 6) =       0.000432388807
  error estimate for blocks of size 2^( 7) =       0.000433102323

      target function =                  N/A
              le_mean =     -17.216762894055
             les_mean =     296.741667633605
             stat err =       0.000430728424
             autocorr =       1.142607134676
              std dev =       0.569862479792
             le_variance =       0.324743245875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324708263051
                                         uncertainty =       0.004582283189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324708263051
                                         uncertainty =       0.004582283189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402953624
  error estimate for blocks of size 2^( 2) =       0.000411915883
  error estimate for blocks of size 2^( 3) =       0.000419979721
  error estimate for blocks of size 2^( 4) =       0.000426616318
  error estimate for blocks of size 2^( 5) =       0.000430806246
  error estimate for blocks of size 2^( 6) =       0.000432388807
  error estimate for blocks of size 2^( 7) =       0.000433102323

      target function =                  N/A
              le_mean =     -17.216762894055
             les_mean =     296.741667633605
             stat err =       0.000430728424
             autocorr =       1.142607134676
              std dev =       0.569862479792
             le_variance =       0.324743245875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324708263051
                                         uncertainty =       0.004582283189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324708263051
                                         uncertainty =       0.004582283189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402953624
  error estimate for blocks of size 2^( 2) =       0.000411915883
  error estimate for blocks of size 2^( 3) =       0.000419979721
  error estimate for blocks of size 2^( 4) =       0.000426616318
  error estimate for blocks of size 2^( 5) =       0.000430806246
  error estimate for blocks of size 2^( 6) =       0.000432388807
  error estimate for blocks of size 2^( 7) =       0.000433102323

      target function =                  N/A
              le_mean =     -17.216762894055
             les_mean =     296.741667633605
             stat err =       0.000430728424
             autocorr =       1.142607134676
              std dev =       0.569862479792
             le_variance =       0.324743245875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216762894055        initial  <--
     2.3842e+16     2.3842e+17             0.0000e+00       -17.216762894055
     9.5367e+16     9.5367e+17             0.0000e+00       -17.216762894055
     3.8147e+17     3.8147e+18             0.0000e+00       -17.216762894055

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9891
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2445
    reference variance = 0.236355
====================================================
  Execution time = 2.3192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2206e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138233132
                                         uncertainty =       0.006628399000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138233132
                                         uncertainty =       0.006628399000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401282875
  error estimate for blocks of size 2^( 2) =       0.000410696643
  error estimate for blocks of size 2^( 3) =       0.000418863461
  error estimate for blocks of size 2^( 4) =       0.000424370836
  error estimate for blocks of size 2^( 5) =       0.000427972072
  error estimate for blocks of size 2^( 6) =       0.000428104000
  error estimate for blocks of size 2^( 7) =       0.000427589217

      target function =                  N/A
              le_mean =     -17.217131626488
             les_mean =     296.751677174739
             stat err =       0.000427009031
             autocorr =       1.132329618264
              std dev =       0.567499684548
             le_variance =       0.322055891962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721713162649e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217131626488       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217131626488       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217131626488       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217131626488       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217131626488       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217131626488       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217131626488       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217131626488       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217131626488       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8808e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2339
    reference variance = 0.346122
====================================================
  Execution time = 2.1498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1871e-01
  Total weights = 2.0000e+06
  Execution time = 1.8778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318583995269
                                         uncertainty =       0.003214464469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318583995269
                                         uncertainty =       0.003214464469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399195892
  error estimate for blocks of size 2^( 2) =       0.000408619451
  error estimate for blocks of size 2^( 3) =       0.000416732886
  error estimate for blocks of size 2^( 4) =       0.000422724866
  error estimate for blocks of size 2^( 5) =       0.000427536475
  error estimate for blocks of size 2^( 6) =       0.000427123059
  error estimate for blocks of size 2^( 7) =       0.000429318018

      target function =                  N/A
              le_mean =     -17.216674314775
             les_mean =     296.732589022265
             stat err =       0.000426675605
             autocorr =       1.142413950625
              std dev =       0.564548244680
             le_variance =       0.318714720572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318583995269
                                         uncertainty =       0.003214464469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318583995269
                                         uncertainty =       0.003214464469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399195892
  error estimate for blocks of size 2^( 2) =       0.000408619451
  error estimate for blocks of size 2^( 3) =       0.000416732886
  error estimate for blocks of size 2^( 4) =       0.000422724866
  error estimate for blocks of size 2^( 5) =       0.000427536475
  error estimate for blocks of size 2^( 6) =       0.000427123059
  error estimate for blocks of size 2^( 7) =       0.000429318018

      target function =                  N/A
              le_mean =     -17.216674314775
             les_mean =     296.732589022265
             stat err =       0.000426675605
             autocorr =       1.142413950625
              std dev =       0.564548244680
             le_variance =       0.318714720572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318583995269
                                         uncertainty =       0.003214464469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318583995269
                                         uncertainty =       0.003214464469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399195892
  error estimate for blocks of size 2^( 2) =       0.000408619451
  error estimate for blocks of size 2^( 3) =       0.000416732886
  error estimate for blocks of size 2^( 4) =       0.000422724866
  error estimate for blocks of size 2^( 5) =       0.000427536475
  error estimate for blocks of size 2^( 6) =       0.000427123059
  error estimate for blocks of size 2^( 7) =       0.000429318018

      target function =                  N/A
              le_mean =     -17.216674314775
             les_mean =     296.732589022265
             stat err =       0.000426675605
             autocorr =       1.142413950625
              std dev =       0.564548244680
             le_variance =       0.318714720572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318583995269
                                         uncertainty =       0.003214464469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318583995269
                                         uncertainty =       0.003214464469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399195892
  error estimate for blocks of size 2^( 2) =       0.000408619451
  error estimate for blocks of size 2^( 3) =       0.000416732886
  error estimate for blocks of size 2^( 4) =       0.000422724866
  error estimate for blocks of size 2^( 5) =       0.000427536475
  error estimate for blocks of size 2^( 6) =       0.000427123059
  error estimate for blocks of size 2^( 7) =       0.000429318018

      target function =                  N/A
              le_mean =     -17.216674314775
             les_mean =     296.732589022265
             stat err =       0.000426675605
             autocorr =       1.142413950625
              std dev =       0.564548244680
             le_variance =       0.318714720572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216674314775        initial  <--
     2.3842e+17     2.3842e+18             0.0000e+00       -17.216674314775
     9.5367e+17     9.5367e+18             0.0000e+00       -17.216674314775
     3.8147e+18     3.8147e+19             0.0000e+00       -17.216674314775

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0312
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2144
    reference variance = 0.389543
====================================================
  Execution time = 2.1154e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2345e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323510359257
                                         uncertainty =       0.004149474977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323510359257
                                         uncertainty =       0.004149474977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402150596
  error estimate for blocks of size 2^( 2) =       0.000411867861
  error estimate for blocks of size 2^( 3) =       0.000419997181
  error estimate for blocks of size 2^( 4) =       0.000426096491
  error estimate for blocks of size 2^( 5) =       0.000431182732
  error estimate for blocks of size 2^( 6) =       0.000431845238
  error estimate for blocks of size 2^( 7) =       0.000431047578

      target function =                  N/A
              le_mean =     -17.216540585023
             les_mean =     296.732719758325
             stat err =       0.000430043010
             autocorr =       1.143526810795
              std dev =       0.568726827475
             le_variance =       0.323450204290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654058502e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216540585023       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216540585023       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216540585023       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216540585023       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216540585023       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216540585023       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6821e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2597
    reference variance = 0.248849
====================================================
  Execution time = 2.1070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2019e-01
  Total weights = 2.0000e+06
  Execution time = 1.8791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194670726
                                         uncertainty =       0.004498659103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194670726
                                         uncertainty =       0.004498659103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400119715
  error estimate for blocks of size 2^( 2) =       0.000409523665
  error estimate for blocks of size 2^( 3) =       0.000418044074
  error estimate for blocks of size 2^( 4) =       0.000424066516
  error estimate for blocks of size 2^( 5) =       0.000427932643
  error estimate for blocks of size 2^( 6) =       0.000429940441
  error estimate for blocks of size 2^( 7) =       0.000432435556

      target function =                  N/A
              le_mean =     -17.216755771664
             les_mean =     296.736870713006
             stat err =       0.000428593789
             autocorr =       1.147392073851
              std dev =       0.565854726929
             le_variance =       0.320191571987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194670726
                                         uncertainty =       0.004498659103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194670726
                                         uncertainty =       0.004498659103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400119715
  error estimate for blocks of size 2^( 2) =       0.000409523665
  error estimate for blocks of size 2^( 3) =       0.000418044074
  error estimate for blocks of size 2^( 4) =       0.000424066516
  error estimate for blocks of size 2^( 5) =       0.000427932643
  error estimate for blocks of size 2^( 6) =       0.000429940441
  error estimate for blocks of size 2^( 7) =       0.000432435556

      target function =                  N/A
              le_mean =     -17.216755771664
             les_mean =     296.736870713006
             stat err =       0.000428593789
             autocorr =       1.147392073851
              std dev =       0.565854726929
             le_variance =       0.320191571987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194670726
                                         uncertainty =       0.004498659103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194670726
                                         uncertainty =       0.004498659103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400119715
  error estimate for blocks of size 2^( 2) =       0.000409523665
  error estimate for blocks of size 2^( 3) =       0.000418044074
  error estimate for blocks of size 2^( 4) =       0.000424066516
  error estimate for blocks of size 2^( 5) =       0.000427932643
  error estimate for blocks of size 2^( 6) =       0.000429940441
  error estimate for blocks of size 2^( 7) =       0.000432435556

      target function =                  N/A
              le_mean =     -17.216755771664
             les_mean =     296.736870713006
             stat err =       0.000428593789
             autocorr =       1.147392073851
              std dev =       0.565854726929
             le_variance =       0.320191571987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194670726
                                         uncertainty =       0.004498659103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194670726
                                         uncertainty =       0.004498659103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400119715
  error estimate for blocks of size 2^( 2) =       0.000409523665
  error estimate for blocks of size 2^( 3) =       0.000418044074
  error estimate for blocks of size 2^( 4) =       0.000424066516
  error estimate for blocks of size 2^( 5) =       0.000427932643
  error estimate for blocks of size 2^( 6) =       0.000429940441
  error estimate for blocks of size 2^( 7) =       0.000432435556

      target function =                  N/A
              le_mean =     -17.216755771664
             les_mean =     296.736870713006
             stat err =       0.000428593789
             autocorr =       1.147392073851
              std dev =       0.565854726929
             le_variance =       0.320191571987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216755771664        initial  <--
     2.3842e+18     2.3842e+19             0.0000e+00       -17.216755771664
     9.5367e+18     9.5367e+19             0.0000e+00       -17.216755771664
     3.8147e+19     3.8147e+20             0.0000e+00       -17.216755771664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5646
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7391e+01 secs
  Total Execution time = 2.3346e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
