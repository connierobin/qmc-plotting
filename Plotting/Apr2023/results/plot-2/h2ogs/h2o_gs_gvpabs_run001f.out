--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0241.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 73101 MB
Rank =    1  Free Memory = 73101 MB
Rank =    2  Free Memory = 73100 MB
Rank =    3  Free Memory = 73100 MB
Rank =    4  Free Memory = 73100 MB
Rank =    5  Free Memory = 73099 MB
Rank =    6  Free Memory = 73099 MB
Rank =    7  Free Memory = 73098 MB
Rank =    8  Free Memory = 73098 MB
Rank =    9  Free Memory = 73098 MB
Rank =   10  Free Memory = 73097 MB
Rank =   11  Free Memory = 73097 MB
Rank =   12  Free Memory = 73097 MB
Rank =   13  Free Memory = 73097 MB
Rank =   14  Free Memory = 73096 MB
Rank =   15  Free Memory = 73092 MB
Rank =   16  Free Memory = 73084 MB
Rank =   17  Free Memory = 73083 MB
Rank =   18  Free Memory = 73083 MB
Rank =   19  Free Memory = 73083 MB
Rank =   20  Free Memory = 73083 MB
Rank =   21  Free Memory = 73083 MB
Rank =   22  Free Memory = 73083 MB
Rank =   23  Free Memory = 73083 MB
Rank =   24  Free Memory = 73083 MB
Rank =   25  Free Memory = 73083 MB
Rank =   26  Free Memory = 73083 MB
Rank =   27  Free Memory = 73083 MB
Rank =   28  Free Memory = 73083 MB
Rank =   29  Free Memory = 73083 MB
Rank =   30  Free Memory = 73083 MB
Rank =   31  Free Memory = 73083 MB
Rank =   32  Free Memory = 90649 MB
Rank =   33  Free Memory = 90649 MB
Rank =   34  Free Memory = 90649 MB
Rank =   35  Free Memory = 90649 MB
Rank =   36  Free Memory = 90649 MB
Rank =   37  Free Memory = 90649 MB
Rank =   38  Free Memory = 90649 MB
Rank =   39  Free Memory = 90649 MB
Rank =   40  Free Memory = 90649 MB
Rank =   41  Free Memory = 90649 MB
Rank =   42  Free Memory = 90649 MB
Rank =   43  Free Memory = 90649 MB
Rank =   44  Free Memory = 90649 MB
Rank =   45  Free Memory = 90649 MB
Rank =   46  Free Memory = 90648 MB
Rank =   47  Free Memory = 90648 MB
Rank =   48  Free Memory = 90648 MB
Rank =   49  Free Memory = 90648 MB
Rank =   50  Free Memory = 90648 MB
Rank =   51  Free Memory = 90648 MB
Rank =   52  Free Memory = 90648 MB
Rank =   53  Free Memory = 90648 MB
Rank =   54  Free Memory = 90648 MB
Rank =   55  Free Memory = 90648 MB
Rank =   56  Free Memory = 90648 MB
Rank =   57  Free Memory = 90648 MB
Rank =   58  Free Memory = 90648 MB
Rank =   59  Free Memory = 90648 MB
Rank =   60  Free Memory = 90648 MB
Rank =   61  Free Memory = 90648 MB
Rank =   62  Free Memory = 90648 MB
Rank =   63  Free Memory = 90648 MB
Rank =   64  Free Memory = 90648 MB
Rank =   65  Free Memory = 90648 MB
Rank =   66  Free Memory = 90648 MB
Rank =   67  Free Memory = 90648 MB
Rank =   68  Free Memory = 90648 MB
Rank =   69  Free Memory = 90648 MB
Rank =   70  Free Memory = 90648 MB
Rank =   71  Free Memory = 90648 MB
Rank =   72  Free Memory = 90408 MB
Rank =   73  Free Memory = 90408 MB
Rank =   74  Free Memory = 90408 MB
Rank =   75  Free Memory = 90408 MB
Rank =   76  Free Memory = 90408 MB
Rank =   77  Free Memory = 90408 MB
Rank =   78  Free Memory = 90408 MB
Rank =   79  Free Memory = 90408 MB
Rank =   80  Free Memory = 90408 MB
Rank =   81  Free Memory = 90408 MB
Rank =   82  Free Memory = 90408 MB
Rank =   83  Free Memory = 90408 MB
Rank =   84  Free Memory = 90408 MB
Rank =   85  Free Memory = 90408 MB
Rank =   86  Free Memory = 90408 MB
Rank =   87  Free Memory = 90408 MB
Rank =   88  Free Memory = 90408 MB
Rank =   89  Free Memory = 90408 MB
Rank =   90  Free Memory = 90408 MB
Rank =   91  Free Memory = 90408 MB
Rank =   92  Free Memory = 90408 MB
Rank =   93  Free Memory = 90408 MB
Rank =   94  Free Memory = 90408 MB
Rank =   95  Free Memory = 90408 MB
Rank =   96  Free Memory = 90408 MB
Rank =   97  Free Memory = 90408 MB
Rank =   98  Free Memory = 90408 MB
Rank =   99  Free Memory = 90408 MB
Rank =  100  Free Memory = 90408 MB
Rank =  101  Free Memory = 90408 MB
Rank =  102  Free Memory = 90408 MB
Rank =  103  Free Memory = 90408 MB
Rank =  104  Free Memory = 90408 MB
Rank =  105  Free Memory = 90408 MB
Rank =  106  Free Memory = 90408 MB
Rank =  107  Free Memory = 90408 MB
Rank =  108  Free Memory = 90408 MB
Rank =  109  Free Memory = 90408 MB
Rank =  110  Free Memory = 90408 MB
Rank =  111  Free Memory = 90408 MB
Rank =  112  Free Memory = 76825 MB
  Input file(s): opt_h2o_gs_gvpabs_run001f.xml 
Rank =  113  Free Memory = 76825 MB
Rank =  114  Free Memory = 76825 MB
Rank =  115  Free Memory = 76825 MB
Rank =  116  Free Memory = 76825 MB
Rank =  117  Free Memory = 76825 MB
Rank =  118  Free Memory = 76825 MB
Rank =  119  Free Memory = 76825 MB
Rank =  120  Free Memory = 76825 MB
Rank =  121  Free Memory = 76825 MB
Rank =  122  Free Memory = 76825 MB
Rank =  123  Free Memory = 76825 MB
Rank =  124  Free Memory = 76825 MB
Rank =  125  Free Memory = 76825 MB
Rank =  127  Free Memory = 76825 MB
Rank =  126  Free Memory = 76825 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvpabs_run001f.xml

  Project = H2O
  date    = 2023-03-24 23:03:58 PDT
  host    = n0061.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 718

  Range of prime numbers to use as seeds over processors and threads = 5443-6563


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.104696e-01    1         1  ON     0
     uu_1                 4.892067e-02    1         1  ON     1
     uu_2                -4.507123e-02    1         1  ON     2
     uu_3                -9.921785e-02    1         1  ON     3
     uu_4                -1.323018e-01    1         1  ON     4
     uu_5                -1.393382e-01    1         1  ON     5
     uu_6                -1.164220e-01    1         1  ON     6
     uu_7                -4.321770e-02    1         1  ON     7
     uu_8                 9.731932e-02    1         1  ON     8
     uu_9                 1.235537e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.511334e-01    1         1  ON     0
     ud_1                 9.355902e-02    1         1  ON     1
     ud_2                -1.454367e-02    1         1  ON     2
     ud_3                -7.438882e-02    1         1  ON     3
     ud_4                -1.216541e-01    1         1  ON     4
     ud_5                -1.534355e-01    1         1  ON     5
     ud_6                -1.562587e-01    1         1  ON     6
     ud_7                -1.121238e-01    1         1  ON     7
     ud_8                 4.818477e-04    1         1  ON     8
     ud_9                 9.256698e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.658330e-01    1         1  ON     0
     eO_1                -4.483905e-01    1         1  ON     1
     eO_2                -4.416870e-02    1         1  ON     2
     eO_3                 2.080098e-01    1         1  ON     3
     eO_4                 3.018007e-01    1         1  ON     4
     eO_5                 3.162564e-01    1         1  ON     5
     eO_6                 2.558454e-01    1         1  ON     6
     eO_7                 1.181304e-01    1         1  ON     7
     eO_8                 2.889627e-02    1         1  ON     8
     eO_9                 1.867985e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.823898e-01    1         1  ON     0
     eH1_1                -1.034065e-01    1         1  ON     1
     eH1_2                -6.301830e-02    1         1  ON     2
     eH1_3                -2.641644e-02    1         1  ON     3
     eH1_4                 1.893996e-02    1         1  ON     4
     eH1_5                 3.340007e-02    1         1  ON     5
     eH1_6                 7.790898e-02    1         1  ON     6
     eH1_7                 1.099551e-01    1         1  ON     7
     eH1_8                 9.408750e-02    1         1  ON     8
     eH1_9                 2.537945e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.842273e-01    1         1  ON     0
     eH2_1                -1.051416e-01    1         1  ON     1
     eH2_2                -6.443389e-02    1         1  ON     2
     eH2_3                -2.763389e-02    1         1  ON     3
     eH2_4                 1.795701e-02    1         1  ON     4
     eH2_5                 3.308771e-02    1         1  ON     5
     eH2_6                 7.960926e-02    1         1  ON     6
     eH2_7                 1.140543e-01    1         1  ON     7
     eH2_8                 9.678406e-02    1         1  ON     8
     eH2_9                 2.747078e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.701517e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2170e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0061.savio3:136623] 55 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0061.savio3:136623] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2098
    reference variance = 0.167935
====================================================
  Execution time = 2.0651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2264e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322499362057
                                         uncertainty =       0.010191900562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322499362057
                                         uncertainty =       0.010191900562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401644776
  error estimate for blocks of size 2^( 2) =       0.000411403203
  error estimate for blocks of size 2^( 3) =       0.000420106954
  error estimate for blocks of size 2^( 4) =       0.000426730293
  error estimate for blocks of size 2^( 5) =       0.000431005074
  error estimate for blocks of size 2^( 6) =       0.000433012456
  error estimate for blocks of size 2^( 7) =       0.000435589204

      target function =                  N/A
              le_mean =     -17.216465504487
             les_mean =     296.729321358802
             stat err =       0.000431584257
             autocorr =       1.154640912760
              std dev =       0.568011490145
             le_variance =       0.322637052936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721646550449e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216465504487       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216468109037       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216471658323       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216473827974       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216472781841       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216476834919       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216475780368       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216475990420       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216476185964       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216476210177       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216476218523       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.536916e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216465504487       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216466554835       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216468138849       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216469336123       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216469075195       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216469442493       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216469626727       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216469494629       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216469598478       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 7.394338e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216465504487       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216465814607       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216466315832       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216466730059       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216466720127       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216466681283       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216466765351       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216466736230       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.910765e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9520e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.106436e-01                 1 1 ON  0
uu_1  4.909150e-02                 1 1 ON  1
uu_2  -4.501708e-02                1 1 ON  2
uu_3  -9.928867e-02                1 1 ON  3
uu_4  -1.324640e-01                1 1 ON  4
uu_5  -1.393912e-01                1 1 ON  5
uu_6  -1.164898e-01                1 1 ON  6
uu_7  -4.333497e-02                1 1 ON  7
uu_8  9.724043e-02                 1 1 ON  8
uu_9  1.236241e-01                 1 1 ON  9
ud_0  3.516254e-01                 1 1 ON  10
ud_1  9.374670e-02                 1 1 ON  11
ud_2  -1.478175e-02                1 1 ON  12
ud_3  -7.458855e-02                1 1 ON  13
ud_4  -1.217485e-01                1 1 ON  14
ud_5  -1.534677e-01                1 1 ON  15
ud_6  -1.562424e-01                1 1 ON  16
ud_7  -1.121770e-01                1 1 ON  17
ud_8  3.471519e-04                 1 1 ON  18
ud_9  9.256671e-02                 1 1 ON  19
eO_0  -7.665724e-01                1 1 ON  20
eO_1  -4.488618e-01                1 1 ON  21
eO_2  -4.391741e-02                1 1 ON  22
eO_3  2.083441e-01                 1 1 ON  23
eO_4  3.020586e-01                 1 1 ON  24
eO_5  3.163833e-01                 1 1 ON  25
eO_6  2.559457e-01                 1 1 ON  26
eO_7  1.182370e-01                 1 1 ON  27
eO_8  2.891476e-02                 1 1 ON  28
eO_9  1.868872e-02                 1 1 ON  29
eH1_0 -1.824946e-01                1 1 ON  30
eH1_1 -1.035627e-01                1 1 ON  31
eH1_2 -6.305462e-02                1 1 ON  32
eH1_3 -2.630291e-02                1 1 ON  33
eH1_4 1.901482e-02                 1 1 ON  34
eH1_5 3.343739e-02                 1 1 ON  35
eH1_6 7.790313e-02                 1 1 ON  36
eH1_7 1.099188e-01                 1 1 ON  37
eH1_8 9.415962e-02                 1 1 ON  38
eH1_9 2.541211e-02                 1 1 ON  39
eH2_0 -1.843285e-01                1 1 ON  40
eH2_1 -1.052455e-01                1 1 ON  41
eH2_2 -6.436892e-02                1 1 ON  42
eH2_3 -2.758014e-02                1 1 ON  43
eH2_4 1.803709e-02                 1 1 ON  44
eH2_5 3.308827e-02                 1 1 ON  45
eH2_6 7.954668e-02                 1 1 ON  46
eH2_7 1.140359e-01                 1 1 ON  47
eH2_8 9.684303e-02                 1 1 ON  48
eH2_9 2.749054e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.0948
    reference variance = 0.305211
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1308e-01
  Total weights = 2.0000e+06
  Execution time = 1.8356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312571686963
                                         uncertainty =       0.002828218617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312571686963
                                         uncertainty =       0.002828218617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395330108
  error estimate for blocks of size 2^( 2) =       0.000405195370
  error estimate for blocks of size 2^( 3) =       0.000414028134
  error estimate for blocks of size 2^( 4) =       0.000420193370
  error estimate for blocks of size 2^( 5) =       0.000424088970
  error estimate for blocks of size 2^( 6) =       0.000427395600
  error estimate for blocks of size 2^( 7) =       0.000427815547

      target function =                  N/A
              le_mean =     -17.216407068926
             les_mean =     296.717243995041
             stat err =       0.000424873372
             autocorr =       1.155045904253
              std dev =       0.559081200143
             le_variance =       0.312571788353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313860053560
                                         uncertainty =       0.002839123813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313860053560
                                         uncertainty =       0.002839123813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396144162
  error estimate for blocks of size 2^( 2) =       0.000405952486
  error estimate for blocks of size 2^( 3) =       0.000414734301
  error estimate for blocks of size 2^( 4) =       0.000420868776
  error estimate for blocks of size 2^( 5) =       0.000424750141
  error estimate for blocks of size 2^( 6) =       0.000428062696
  error estimate for blocks of size 2^( 7) =       0.000428496011

      target function =                  N/A
              le_mean =     -17.216407826407
             les_mean =     296.718558683155
             stat err =       0.000425544406
             autocorr =       1.153940060927
              std dev =       0.560232447229
             le_variance =       0.313860394928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313600865717
                                         uncertainty =       0.002836697294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313600865717
                                         uncertainty =       0.002836697294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395980551
  error estimate for blocks of size 2^( 2) =       0.000405799084
  error estimate for blocks of size 2^( 3) =       0.000414592187
  error estimate for blocks of size 2^( 4) =       0.000420733138
  error estimate for blocks of size 2^( 5) =       0.000424615704
  error estimate for blocks of size 2^( 6) =       0.000427931286
  error estimate for blocks of size 2^( 7) =       0.000428360031

      target function =                  N/A
              le_mean =     -17.216406747725
             les_mean =     296.718262340490
             stat err =       0.000425410040
             autocorr =       1.154164622099
              std dev =       0.560001066226
             le_variance =       0.313601194174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312724037675
                                         uncertainty =       0.002829472990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312724037675
                                         uncertainty =       0.002829472990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395426464
  error estimate for blocks of size 2^( 2) =       0.000405284444
  error estimate for blocks of size 2^( 3) =       0.000414111204
  error estimate for blocks of size 2^( 4) =       0.000420272704
  error estimate for blocks of size 2^( 5) =       0.000424166233
  error estimate for blocks of size 2^( 6) =       0.000427474548
  error estimate for blocks of size 2^( 7) =       0.000427895615

      target function =                  N/A
              le_mean =     -17.216406641818
             les_mean =     296.717381677629
             stat err =       0.000424952275
             autocorr =       1.154911892630
              std dev =       0.559217468925
             le_variance =       0.312724177551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216407068926        initial
     2.5000e-01     2.5000e+00             2.5369e-03       -17.216407826407  <--
     1.0000e+00     1.0000e+01             7.3943e-04       -17.216406747725
     4.0000e+00     4.0000e+01             1.9108e-04       -17.216406641818

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9681e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.111434e-01 1 1  ON 0
 uu_1                 4.944858e-02 1 1  ON 1
 uu_2                -4.487083e-02 1 1  ON 2
 uu_3                -9.941569e-02 1 1  ON 3
 uu_4                -1.328150e-01 1 1  ON 4
 uu_5                -1.396416e-01 1 1  ON 5
 uu_6                -1.166717e-01 1 1  ON 6
 uu_7                -4.365609e-02 1 1  ON 7
 uu_8                 9.701009e-02 1 1  ON 8
 uu_9                 1.238385e-01 1 1  ON 9
 ud_0                 3.524248e-01 1 1  ON 10
 ud_1                 9.407472e-02 1 1  ON 11
 ud_2                -1.496669e-02 1 1  ON 12
 ud_3                -7.495263e-02 1 1  ON 13
 ud_4                -1.219860e-01 1 1  ON 14
 ud_5                -1.535640e-01 1 1  ON 15
 ud_6                -1.561547e-01 1 1  ON 16
 ud_7                -1.122916e-01 1 1  ON 17
 ud_8                -4.380047e-05 1 1  ON 18
 ud_9                 9.256812e-02 1 1  ON 19
 eO_0                -7.683699e-01 1 1  ON 20
 eO_1                -4.500340e-01 1 1  ON 21
 eO_2                -4.376639e-02 1 1  ON 22
 eO_3                 2.091062e-01 1 1  ON 23
 eO_4                 3.029052e-01 1 1  ON 24
 eO_5                 3.168394e-01 1 1  ON 25
 eO_6                 2.562696e-01 1 1  ON 26
 eO_7                 1.185648e-01 1 1  ON 27
 eO_8                 2.897170e-02 1 1  ON 28
 eO_9                 1.871566e-02 1 1  ON 29
eH1_0                -1.827958e-01 1 1  ON 30
eH1_1                -1.038999e-01 1 1  ON 31
eH1_2                -6.311708e-02 1 1  ON 32
eH1_3                -2.612423e-02 1 1  ON 33
eH1_4                 1.916168e-02 1 1  ON 34
eH1_5                 3.354828e-02 1 1  ON 35
eH1_6                 7.791747e-02 1 1  ON 36
eH1_7                 1.098214e-01 1 1  ON 37
eH1_8                 9.438045e-02 1 1  ON 38
eH1_9                 2.551154e-02 1 1  ON 39
eH2_0                -1.845752e-01 1 1  ON 40
eH2_1                -1.054358e-01 1 1  ON 41
eH2_2                -6.426889e-02 1 1  ON 42
eH2_3                -2.748047e-02 1 1  ON 43
eH2_4                 1.817444e-02 1 1  ON 44
eH2_5                 3.311457e-02 1 1  ON 45
eH2_6                 7.939835e-02 1 1  ON 46
eH2_7                 1.139923e-01 1 1  ON 47
eH2_8                 9.702398e-02 1 1  ON 48
eH2_9                 2.755095e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7152e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2062
    reference variance = 0.252306
====================================================
  Execution time = 1.9884e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2814e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328149885682
                                         uncertainty =       0.009932628244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328149885682
                                         uncertainty =       0.009932628244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405055676
  error estimate for blocks of size 2^( 2) =       0.000414942691
  error estimate for blocks of size 2^( 3) =       0.000423643053
  error estimate for blocks of size 2^( 4) =       0.000430443370
  error estimate for blocks of size 2^( 5) =       0.000433659507
  error estimate for blocks of size 2^( 6) =       0.000436052565
  error estimate for blocks of size 2^( 7) =       0.000436357945

      target function =                  N/A
              le_mean =     -17.216900905552
             les_mean =     296.749816828150
             stat err =       0.000434128347
             autocorr =       1.148700593839
              std dev =       0.572835229920
             le_variance =       0.328140200637


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721690090555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216900905552       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216904076022       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216901988018       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216903867892       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216905762873       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216906332603       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216909142341       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216910027535       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216912548776       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216911502314       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216911822586       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216912255641       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216912683078       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.221604e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216900905552       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216902885883       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216901686451       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216902256041       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216903401332       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216903592452       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216904123968       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216904127723       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216904605532       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216904434293       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.036868e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216900905552       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216901697199       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216901261154       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216901322998       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216901675082       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216901847341       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216901770708       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216901836142       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.803941e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5450e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.116339e-01 1 1  ON 0
 uu_1                 4.961076e-02 1 1  ON 1
 uu_2                -4.478444e-02 1 1  ON 2
 uu_3                -9.942148e-02 1 1  ON 3
 uu_4                -1.329287e-01 1 1  ON 4
 uu_5                -1.398718e-01 1 1  ON 5
 uu_6                -1.168103e-01 1 1  ON 6
 uu_7                -4.416260e-02 1 1  ON 7
 uu_8                 9.675975e-02 1 1  ON 8
 uu_9                 1.240692e-01 1 1  ON 9
 ud_0                 3.529048e-01 1 1  ON 10
 ud_1                 9.439614e-02 1 1  ON 11
 ud_2                -1.482750e-02 1 1  ON 12
 ud_3                -7.519293e-02 1 1  ON 13
 ud_4                -1.224277e-01 1 1  ON 14
 ud_5                -1.537422e-01 1 1  ON 15
 ud_6                -1.560422e-01 1 1  ON 16
 ud_7                -1.123219e-01 1 1  ON 17
 ud_8                -4.459439e-04 1 1  ON 18
 ud_9                 9.256897e-02 1 1  ON 19
 eO_0                -7.704067e-01 1 1  ON 20
 eO_1                -4.513214e-01 1 1  ON 21
 eO_2                -4.418410e-02 1 1  ON 22
 eO_3                 2.098979e-01 1 1  ON 23
 eO_4                 3.040569e-01 1 1  ON 24
 eO_5                 3.176260e-01 1 1  ON 25
 eO_6                 2.567258e-01 1 1  ON 26
 eO_7                 1.189908e-01 1 1  ON 27
 eO_8                 2.904121e-02 1 1  ON 28
 eO_9                 1.874097e-02 1 1  ON 29
eH1_0                -1.831432e-01 1 1  ON 30
eH1_1                -1.040793e-01 1 1  ON 31
eH1_2                -6.311187e-02 1 1  ON 32
eH1_3                -2.603956e-02 1 1  ON 33
eH1_4                 1.927964e-02 1 1  ON 34
eH1_5                 3.356387e-02 1 1  ON 35
eH1_6                 7.791998e-02 1 1  ON 36
eH1_7                 1.098099e-01 1 1  ON 37
eH1_8                 9.459291e-02 1 1  ON 38
eH1_9                 2.559136e-02 1 1  ON 39
eH2_0                -1.847151e-01 1 1  ON 40
eH2_1                -1.056340e-01 1 1  ON 41
eH2_2                -6.414634e-02 1 1  ON 42
eH2_3                -2.742670e-02 1 1  ON 43
eH2_4                 1.805322e-02 1 1  ON 44
eH2_5                 3.287289e-02 1 1  ON 45
eH2_6                 7.948151e-02 1 1  ON 46
eH2_7                 1.140171e-01 1 1  ON 47
eH2_8                 9.730908e-02 1 1  ON 48
eH2_9                 2.765111e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2804
    reference variance = 0.232546
====================================================
  Execution time = 1.9981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2120e-01
  Total weights = 2.0000e+06
  Execution time = 1.8384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320872420477
                                         uncertainty =       0.003279751720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320872420477
                                         uncertainty =       0.003279751720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400535133
  error estimate for blocks of size 2^( 2) =       0.000410251584
  error estimate for blocks of size 2^( 3) =       0.000418965385
  error estimate for blocks of size 2^( 4) =       0.000425694340
  error estimate for blocks of size 2^( 5) =       0.000430155721
  error estimate for blocks of size 2^( 6) =       0.000432956852
  error estimate for blocks of size 2^( 7) =       0.000432740288

      target function =                  N/A
              le_mean =     -17.216376533804
             les_mean =     296.724477578081
             stat err =       0.000430386800
             autocorr =       1.154613563920
              std dev =       0.566442216648
             le_variance =       0.320856784801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321702819844
                                         uncertainty =       0.003284670880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321702819844
                                         uncertainty =       0.003284670880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401053152
  error estimate for blocks of size 2^( 2) =       0.000410741358
  error estimate for blocks of size 2^( 3) =       0.000419417908
  error estimate for blocks of size 2^( 4) =       0.000426105688
  error estimate for blocks of size 2^( 5) =       0.000430551609
  error estimate for blocks of size 2^( 6) =       0.000433353049
  error estimate for blocks of size 2^( 7) =       0.000433109079

      target function =                  N/A
              le_mean =     -17.216381055174
             les_mean =     296.725463737174
             stat err =       0.000430779856
             autocorr =       1.153737229072
              std dev =       0.567174806447
             le_variance =       0.321687261068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321557728532
                                         uncertainty =       0.003283562205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321557728532
                                         uncertainty =       0.003283562205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400962738
  error estimate for blocks of size 2^( 2) =       0.000410658155
  error estimate for blocks of size 2^( 3) =       0.000419345042
  error estimate for blocks of size 2^( 4) =       0.000426042209
  error estimate for blocks of size 2^( 5) =       0.000430492448
  error estimate for blocks of size 2^( 6) =       0.000433293160
  error estimate for blocks of size 2^( 7) =       0.000433049528

      target function =                  N/A
              le_mean =     -17.216379199445
             les_mean =     296.725254813534
             stat err =       0.000430719336
             autocorr =       1.153933301559
              std dev =       0.567046942706
             le_variance =       0.321542235232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320981098649
                                         uncertainty =       0.003280348009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320981098649
                                         uncertainty =       0.003280348009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400602977
  error estimate for blocks of size 2^( 2) =       0.000410316123
  error estimate for blocks of size 2^( 3) =       0.000419025875
  error estimate for blocks of size 2^( 4) =       0.000425749914
  error estimate for blocks of size 2^( 5) =       0.000430209747
  error estimate for blocks of size 2^( 6) =       0.000433010739
  error estimate for blocks of size 2^( 7) =       0.000432789155

      target function =                  N/A
              le_mean =     -17.216376694214
             les_mean =     296.724591807631
             stat err =       0.000430439889
             autocorr =       1.154507277890
              std dev =       0.566538163801
             le_variance =       0.320965491043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216376533804        initial
     6.2500e-02     6.2500e-01             6.2216e-03       -17.216381055174  <--
     2.5000e-01     2.5000e+00             2.0369e-03       -17.216379199445
     1.0000e+00     1.0000e+01             5.8039e-04       -17.216376694214

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9225e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.124842e-01 1 1  ON 0
 uu_1                 5.022894e-02 1 1  ON 1
 uu_2                -4.440661e-02 1 1  ON 2
 uu_3                -9.931088e-02 1 1  ON 3
 uu_4                -1.331968e-01 1 1  ON 4
 uu_5                -1.404166e-01 1 1  ON 5
 uu_6                -1.173419e-01 1 1  ON 6
 uu_7                -4.553925e-02 1 1  ON 7
 uu_8                 9.603394e-02 1 1  ON 8
 uu_9                 1.247456e-01 1 1  ON 9
 ud_0                 3.536975e-01 1 1  ON 10
 ud_1                 9.504118e-02 1 1  ON 11
 ud_2                -1.449225e-02 1 1  ON 12
 ud_3                -7.527304e-02 1 1  ON 13
 ud_4                -1.229414e-01 1 1  ON 14
 ud_5                -1.543249e-01 1 1  ON 15
 ud_6                -1.561742e-01 1 1  ON 16
 ud_7                -1.123835e-01 1 1  ON 17
 ud_8                -1.561597e-03 1 1  ON 18
 ud_9                 9.257649e-02 1 1  ON 19
 eO_0                -7.745915e-01 1 1  ON 20
 eO_1                -4.545066e-01 1 1  ON 21
 eO_2                -4.582527e-02 1 1  ON 22
 eO_3                 2.105097e-01 1 1  ON 23
 eO_4                 3.068391e-01 1 1  ON 24
 eO_5                 3.201474e-01 1 1  ON 25
 eO_6                 2.581594e-01 1 1  ON 26
 eO_7                 1.202671e-01 1 1  ON 27
 eO_8                 2.924903e-02 1 1  ON 28
 eO_9                 1.881562e-02 1 1  ON 29
eH1_0                -1.837047e-01 1 1  ON 30
eH1_1                -1.044641e-01 1 1  ON 31
eH1_2                -6.317564e-02 1 1  ON 32
eH1_3                -2.604459e-02 1 1  ON 33
eH1_4                 1.947402e-02 1 1  ON 34
eH1_5                 3.339765e-02 1 1  ON 35
eH1_6                 7.796075e-02 1 1  ON 36
eH1_7                 1.098225e-01 1 1  ON 37
eH1_8                 9.522989e-02 1 1  ON 38
eH1_9                 2.582858e-02 1 1  ON 39
eH2_0                -1.850078e-01 1 1  ON 40
eH2_1                -1.059240e-01 1 1  ON 41
eH2_2                -6.417467e-02 1 1  ON 42
eH2_3                -2.746489e-02 1 1  ON 43
eH2_4                 1.787275e-02 1 1  ON 44
eH2_5                 3.216707e-02 1 1  ON 45
eH2_6                 7.967087e-02 1 1  ON 46
eH2_7                 1.141193e-01 1 1  ON 47
eH2_8                 9.816128e-02 1 1  ON 48
eH2_9                 2.794920e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4680e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.236
    reference variance = 0.389073
====================================================
  Execution time = 2.0161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4556e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345614643392
                                         uncertainty =       0.018718402879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345614643392
                                         uncertainty =       0.018718402879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415671220
  error estimate for blocks of size 2^( 2) =       0.000424942628
  error estimate for blocks of size 2^( 3) =       0.000433587736
  error estimate for blocks of size 2^( 4) =       0.000440044302
  error estimate for blocks of size 2^( 5) =       0.000444068757
  error estimate for blocks of size 2^( 6) =       0.000446661509
  error estimate for blocks of size 2^( 7) =       0.000446300999

      target function =                  N/A
              le_mean =     -17.216686394367
             les_mean =     296.759855355150
             stat err =       0.000444268892
             autocorr =       1.142330828650
              std dev =       0.587847876550
             le_variance =       0.345565125965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668639437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216686394367       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216689088160       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216690461907       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691349356       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216694008121       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216700319891       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216707882690       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216708707357       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216709804416       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216710159899       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216713437203       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216714316670       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216714564767       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216714778524       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216714252437       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216713158411       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216714027335       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216713454434       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216713016556       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216713095245       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.353891e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216686394367       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216688689737       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216689907250       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216690279960       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216692035210       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216695827202       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216698718697       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216698610214       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216698665939       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216698148653       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216698790066       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216698925219       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216698556256       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.713494e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216686394367       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216687836530       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216688698015       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216688704950       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216689339606       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216690792004       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216691323402       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216691245948       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216691181758       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216691044796       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.424082e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5701e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.132821e-01 1 1  ON 0
 uu_1                 5.147644e-02 1 1  ON 1
 uu_2                -4.361961e-02 1 1  ON 2
 uu_3                -9.915014e-02 1 1  ON 3
 uu_4                -1.334345e-01 1 1  ON 4
 uu_5                -1.406946e-01 1 1  ON 5
 uu_6                -1.189172e-01 1 1  ON 6
 uu_7                -4.731201e-02 1 1  ON 7
 uu_8                 9.453286e-02 1 1  ON 8
 uu_9                 1.256331e-01 1 1  ON 9
 ud_0                 3.545169e-01 1 1  ON 10
 ud_1                 9.595324e-02 1 1  ON 11
 ud_2                -1.397484e-02 1 1  ON 12
 ud_3                -7.506961e-02 1 1  ON 13
 ud_4                -1.230100e-01 1 1  ON 14
 ud_5                -1.549143e-01 1 1  ON 15
 ud_6                -1.566761e-01 1 1  ON 16
 ud_7                -1.129184e-01 1 1  ON 17
 ud_8                -3.415730e-03 1 1  ON 18
 ud_9                 9.249827e-02 1 1  ON 19
 eO_0                -7.793050e-01 1 1  ON 20
 eO_1                -4.584886e-01 1 1  ON 21
 eO_2                -4.782121e-02 1 1  ON 22
 eO_3                 2.107136e-01 1 1  ON 23
 eO_4                 3.102503e-01 1 1  ON 24
 eO_5                 3.234779e-01 1 1  ON 25
 eO_6                 2.596966e-01 1 1  ON 26
 eO_7                 1.219210e-01 1 1  ON 27
 eO_8                 2.949381e-02 1 1  ON 28
 eO_9                 1.894547e-02 1 1  ON 29
eH1_0                -1.837802e-01 1 1  ON 30
eH1_1                -1.046669e-01 1 1  ON 31
eH1_2                -6.335760e-02 1 1  ON 32
eH1_3                -2.620935e-02 1 1  ON 33
eH1_4                 1.914870e-02 1 1  ON 34
eH1_5                 3.361986e-02 1 1  ON 35
eH1_6                 7.749913e-02 1 1  ON 36
eH1_7                 1.096501e-01 1 1  ON 37
eH1_8                 9.618971e-02 1 1  ON 38
eH1_9                 2.606446e-02 1 1  ON 39
eH2_0                -1.850683e-01 1 1  ON 40
eH2_1                -1.061054e-01 1 1  ON 41
eH2_2                -6.463666e-02 1 1  ON 42
eH2_3                -2.799655e-02 1 1  ON 43
eH2_4                 1.782458e-02 1 1  ON 44
eH2_5                 3.224332e-02 1 1  ON 45
eH2_6                 7.956935e-02 1 1  ON 46
eH2_7                 1.139789e-01 1 1  ON 47
eH2_8                 9.920065e-02 1 1  ON 48
eH2_9                 2.827932e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1699
    reference variance = 0.163562
====================================================
  Execution time = 1.9449e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3076e-01
  Total weights = 2.0000e+06
  Execution time = 1.8350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330416366349
                                         uncertainty =       0.006734317370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330416366349
                                         uncertainty =       0.006734317370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406394197
  error estimate for blocks of size 2^( 2) =       0.000416086027
  error estimate for blocks of size 2^( 3) =       0.000425082692
  error estimate for blocks of size 2^( 4) =       0.000430972034
  error estimate for blocks of size 2^( 5) =       0.000433863202
  error estimate for blocks of size 2^( 6) =       0.000436308419
  error estimate for blocks of size 2^( 7) =       0.000438182122

      target function =                  N/A
              le_mean =     -17.216209363491
             les_mean =     296.728177169187
             stat err =       0.000434831444
             autocorr =       1.144845516835
              std dev =       0.574728185127
             le_variance =       0.330312486779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331543955987
                                         uncertainty =       0.006759149469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331543955987
                                         uncertainty =       0.006759149469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407086978
  error estimate for blocks of size 2^( 2) =       0.000416741423
  error estimate for blocks of size 2^( 3) =       0.000425676528
  error estimate for blocks of size 2^( 4) =       0.000431513349
  error estimate for blocks of size 2^( 5) =       0.000434379379
  error estimate for blocks of size 2^( 6) =       0.000436826676
  error estimate for blocks of size 2^( 7) =       0.000438706071

      target function =                  N/A
              le_mean =     -17.216214737283
             les_mean =     296.729489329123
             stat err =       0.000435356369
             autocorr =       1.143708594629
              std dev =       0.575707924747
             le_variance =       0.331439614616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331337062582
                                         uncertainty =       0.006756686974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331337062582
                                         uncertainty =       0.006756686974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406959950
  error estimate for blocks of size 2^( 2) =       0.000416623364
  error estimate for blocks of size 2^( 3) =       0.000425568858
  error estimate for blocks of size 2^( 4) =       0.000431417332
  error estimate for blocks of size 2^( 5) =       0.000434296587
  error estimate for blocks of size 2^( 6) =       0.000436750650
  error estimate for blocks of size 2^( 7) =       0.000438627750

      target function =                  N/A
              le_mean =     -17.216219127513
             les_mean =     296.729433682518
             stat err =       0.000435273080
             autocorr =       1.143984852527
              std dev =       0.575528280436
             le_variance =       0.331232801581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330554745931
                                         uncertainty =       0.006737928981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330554745931
                                         uncertainty =       0.006737928981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406479275
  error estimate for blocks of size 2^( 2) =       0.000416166029
  error estimate for blocks of size 2^( 3) =       0.000425152423
  error estimate for blocks of size 2^( 4) =       0.000431033963
  error estimate for blocks of size 2^( 5) =       0.000433924688
  error estimate for blocks of size 2^( 6) =       0.000436372446
  error estimate for blocks of size 2^( 7) =       0.000438245389

      target function =                  N/A
              le_mean =     -17.216210431759
             les_mean =     296.728352267089
             stat err =       0.000434894121
             autocorr =       1.144696250100
              std dev =       0.574848503273
             le_variance =       0.330450801715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216209363491        initial
     1.5625e-02     1.5625e-01             1.3539e-02       -17.216214737283
     6.2500e-02     6.2500e-01             4.7135e-03       -17.216219127513  <--
     2.5000e-01     2.5000e+00             1.4241e-03       -17.216210431759

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.8716e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.132821e-01 1 1  ON 0
 uu_1                 5.147644e-02 1 1  ON 1
 uu_2                -4.361961e-02 1 1  ON 2
 uu_3                -9.915014e-02 1 1  ON 3
 uu_4                -1.334345e-01 1 1  ON 4
 uu_5                -1.406946e-01 1 1  ON 5
 uu_6                -1.189172e-01 1 1  ON 6
 uu_7                -4.731201e-02 1 1  ON 7
 uu_8                 9.453286e-02 1 1  ON 8
 uu_9                 1.256331e-01 1 1  ON 9
 ud_0                 3.545169e-01 1 1  ON 10
 ud_1                 9.595324e-02 1 1  ON 11
 ud_2                -1.397484e-02 1 1  ON 12
 ud_3                -7.506961e-02 1 1  ON 13
 ud_4                -1.230100e-01 1 1  ON 14
 ud_5                -1.549143e-01 1 1  ON 15
 ud_6                -1.566761e-01 1 1  ON 16
 ud_7                -1.129184e-01 1 1  ON 17
 ud_8                -3.415730e-03 1 1  ON 18
 ud_9                 9.249827e-02 1 1  ON 19
 eO_0                -7.793050e-01 1 1  ON 20
 eO_1                -4.584886e-01 1 1  ON 21
 eO_2                -4.782121e-02 1 1  ON 22
 eO_3                 2.107136e-01 1 1  ON 23
 eO_4                 3.102503e-01 1 1  ON 24
 eO_5                 3.234779e-01 1 1  ON 25
 eO_6                 2.596966e-01 1 1  ON 26
 eO_7                 1.219210e-01 1 1  ON 27
 eO_8                 2.949381e-02 1 1  ON 28
 eO_9                 1.894547e-02 1 1  ON 29
eH1_0                -1.837802e-01 1 1  ON 30
eH1_1                -1.046669e-01 1 1  ON 31
eH1_2                -6.335760e-02 1 1  ON 32
eH1_3                -2.620935e-02 1 1  ON 33
eH1_4                 1.914870e-02 1 1  ON 34
eH1_5                 3.361986e-02 1 1  ON 35
eH1_6                 7.749913e-02 1 1  ON 36
eH1_7                 1.096501e-01 1 1  ON 37
eH1_8                 9.618971e-02 1 1  ON 38
eH1_9                 2.606446e-02 1 1  ON 39
eH2_0                -1.850683e-01 1 1  ON 40
eH2_1                -1.061054e-01 1 1  ON 41
eH2_2                -6.463666e-02 1 1  ON 42
eH2_3                -2.799655e-02 1 1  ON 43
eH2_4                 1.782458e-02 1 1  ON 44
eH2_5                 3.224332e-02 1 1  ON 45
eH2_6                 7.956935e-02 1 1  ON 46
eH2_7                 1.139789e-01 1 1  ON 47
eH2_8                 9.920065e-02 1 1  ON 48
eH2_9                 2.827932e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2167
    reference variance = 0.23221
====================================================
  Execution time = 1.9916e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2465e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324684771010
                                         uncertainty =       0.011854482020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324684771010
                                         uncertainty =       0.011854482020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402896783
  error estimate for blocks of size 2^( 2) =       0.000412596039
  error estimate for blocks of size 2^( 3) =       0.000420873152
  error estimate for blocks of size 2^( 4) =       0.000427618887
  error estimate for blocks of size 2^( 5) =       0.000430692693
  error estimate for blocks of size 2^( 6) =       0.000433027738
  error estimate for blocks of size 2^( 7) =       0.000435360630

      target function =                  N/A
              le_mean =     -17.216016479768
             les_mean =     296.715874905185
             stat err =       0.000431674987
             autocorr =       1.147958450707
              std dev =       0.569782095082
             le_variance =       0.324651635877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721601647977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216016479768       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216021534535       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216021268155       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216023787823       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216022156272       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216022046643       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216025992334       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216024883948       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216026216759       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216034562010       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216032361296       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216036879714       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216036749840       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216036406490       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216035858041       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216035180229       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216034827369       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.225312e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216016479768       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216020795123       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216020667178       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216022629781       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216021268074       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216021061405       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216022908282       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216021391448       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216022165215       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216024381779       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216023558271       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216024470537       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.140509e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216016479768       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216019202182       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216019274241       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216020385446       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216019578285       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216019491144       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216019719507       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216019019311       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216019416910       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216019638466       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.208404e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5551e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.147600e-01 1 1  ON 0
 uu_1                 5.209059e-02 1 1  ON 1
 uu_2                -4.327601e-02 1 1  ON 2
 uu_3                -9.921294e-02 1 1  ON 3
 uu_4                -1.340523e-01 1 1  ON 4
 uu_5                -1.415112e-01 1 1  ON 5
 uu_6                -1.192435e-01 1 1  ON 6
 uu_7                -4.832889e-02 1 1  ON 7
 uu_8                 9.326069e-02 1 1  ON 8
 uu_9                 1.261931e-01 1 1  ON 9
 ud_0                 3.552747e-01 1 1  ON 10
 ud_1                 9.651558e-02 1 1  ON 11
 ud_2                -1.344405e-02 1 1  ON 12
 ud_3                -7.478987e-02 1 1  ON 13
 ud_4                -1.230864e-01 1 1  ON 14
 ud_5                -1.552350e-01 1 1  ON 15
 ud_6                -1.572671e-01 1 1  ON 16
 ud_7                -1.134715e-01 1 1  ON 17
 ud_8                -4.805061e-03 1 1  ON 18
 ud_9                 9.243905e-02 1 1  ON 19
 eO_0                -7.834455e-01 1 1  ON 20
 eO_1                -4.619720e-01 1 1  ON 21
 eO_2                -5.008618e-02 1 1  ON 22
 eO_3                 2.109087e-01 1 1  ON 23
 eO_4                 3.124873e-01 1 1  ON 24
 eO_5                 3.268135e-01 1 1  ON 25
 eO_6                 2.615429e-01 1 1  ON 26
 eO_7                 1.236674e-01 1 1  ON 27
 eO_8                 2.976817e-02 1 1  ON 28
 eO_9                 1.907547e-02 1 1  ON 29
eH1_0                -1.842658e-01 1 1  ON 30
eH1_1                -1.047818e-01 1 1  ON 31
eH1_2                -6.365972e-02 1 1  ON 32
eH1_3                -2.633888e-02 1 1  ON 33
eH1_4                 1.882140e-02 1 1  ON 34
eH1_5                 3.325449e-02 1 1  ON 35
eH1_6                 7.806791e-02 1 1  ON 36
eH1_7                 1.093886e-01 1 1  ON 37
eH1_8                 9.714099e-02 1 1  ON 38
eH1_9                 2.635762e-02 1 1  ON 39
eH2_0                -1.856891e-01 1 1  ON 40
eH2_1                -1.063491e-01 1 1  ON 41
eH2_2                -6.508279e-02 1 1  ON 42
eH2_3                -2.782764e-02 1 1  ON 43
eH2_4                 1.762330e-02 1 1  ON 44
eH2_5                 3.203015e-02 1 1  ON 45
eH2_6                 7.951664e-02 1 1  ON 46
eH2_7                 1.143177e-01 1 1  ON 47
eH2_8                 1.001140e-01 1 1  ON 48
eH2_9                 2.848964e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2963
    reference variance = 0.329696
====================================================
  Execution time = 2.2337e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1363e-01
  Total weights = 2.0000e+06
  Execution time = 1.8399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313107190197
                                         uncertainty =       0.002748056071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313107190197
                                         uncertainty =       0.002748056071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395631650
  error estimate for blocks of size 2^( 2) =       0.000405791601
  error estimate for blocks of size 2^( 3) =       0.000414492206
  error estimate for blocks of size 2^( 4) =       0.000421537815
  error estimate for blocks of size 2^( 5) =       0.000426515468
  error estimate for blocks of size 2^( 6) =       0.000430275672
  error estimate for blocks of size 2^( 7) =       0.000433287219

      target function =                  N/A
              le_mean =     -17.216499080752
             les_mean =     296.720889245214
             stat err =       0.000427904044
             autocorr =       1.169797603392
              std dev =       0.559507644459
             le_variance =       0.313048804208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314135060252
                                         uncertainty =       0.002752057666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314135060252
                                         uncertainty =       0.002752057666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396280570
  error estimate for blocks of size 2^( 2) =       0.000406419045
  error estimate for blocks of size 2^( 3) =       0.000415074429
  error estimate for blocks of size 2^( 4) =       0.000422081749
  error estimate for blocks of size 2^( 5) =       0.000427043251
  error estimate for blocks of size 2^( 6) =       0.000430813316
  error estimate for blocks of size 2^( 7) =       0.000433844556

      target function =                  N/A
              le_mean =     -17.216495531198
             les_mean =     296.721794798556
             stat err =       0.000428445718
             autocorr =       1.168923408817
              std dev =       0.560425356158
             le_variance =       0.314076579825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314283476108
                                         uncertainty =       0.002754235652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314283476108
                                         uncertainty =       0.002754235652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396374051
  error estimate for blocks of size 2^( 2) =       0.000406514685
  error estimate for blocks of size 2^( 3) =       0.000415175170
  error estimate for blocks of size 2^( 4) =       0.000422183298
  error estimate for blocks of size 2^( 5) =       0.000427154193
  error estimate for blocks of size 2^( 6) =       0.000430924448
  error estimate for blocks of size 2^( 7) =       0.000433963726

      target function =                  N/A
              le_mean =     -17.216493911902
             les_mean =     296.721887238377
             stat err =       0.000428556416
             autocorr =       1.168975938997
              std dev =       0.560557558986
             le_variance =       0.314224776936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313386744684
                                         uncertainty =       0.002749788480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313386744684
                                         uncertainty =       0.002749788480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395808191
  error estimate for blocks of size 2^( 2) =       0.000405963855
  error estimate for blocks of size 2^( 3) =       0.000414656886
  error estimate for blocks of size 2^( 4) =       0.000421694762
  error estimate for blocks of size 2^( 5) =       0.000426671746
  error estimate for blocks of size 2^( 6) =       0.000430434147
  error estimate for blocks of size 2^( 7) =       0.000433450617

      target function =                  N/A
              le_mean =     -17.216496944632
             les_mean =     296.721095136519
             stat err =       0.000428062818
             autocorr =       1.169621806721
              std dev =       0.559757312289
             le_variance =       0.313328248661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216499080752        initial  <--
     1.5625e-02     1.5625e-01             1.2253e-02       -17.216495531198
     6.2500e-02     6.2500e-01             4.1405e-03       -17.216493911902
     2.5000e-01     2.5000e+00             1.2084e-03       -17.216496944632

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6214
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.132821e-01 1 1  ON 0
 uu_1                 5.147644e-02 1 1  ON 1
 uu_2                -4.361961e-02 1 1  ON 2
 uu_3                -9.915014e-02 1 1  ON 3
 uu_4                -1.334345e-01 1 1  ON 4
 uu_5                -1.406946e-01 1 1  ON 5
 uu_6                -1.189172e-01 1 1  ON 6
 uu_7                -4.731201e-02 1 1  ON 7
 uu_8                 9.453286e-02 1 1  ON 8
 uu_9                 1.256331e-01 1 1  ON 9
 ud_0                 3.545169e-01 1 1  ON 10
 ud_1                 9.595324e-02 1 1  ON 11
 ud_2                -1.397484e-02 1 1  ON 12
 ud_3                -7.506961e-02 1 1  ON 13
 ud_4                -1.230100e-01 1 1  ON 14
 ud_5                -1.549143e-01 1 1  ON 15
 ud_6                -1.566761e-01 1 1  ON 16
 ud_7                -1.129184e-01 1 1  ON 17
 ud_8                -3.415730e-03 1 1  ON 18
 ud_9                 9.249827e-02 1 1  ON 19
 eO_0                -7.793050e-01 1 1  ON 20
 eO_1                -4.584886e-01 1 1  ON 21
 eO_2                -4.782121e-02 1 1  ON 22
 eO_3                 2.107136e-01 1 1  ON 23
 eO_4                 3.102503e-01 1 1  ON 24
 eO_5                 3.234779e-01 1 1  ON 25
 eO_6                 2.596966e-01 1 1  ON 26
 eO_7                 1.219210e-01 1 1  ON 27
 eO_8                 2.949381e-02 1 1  ON 28
 eO_9                 1.894547e-02 1 1  ON 29
eH1_0                -1.837802e-01 1 1  ON 30
eH1_1                -1.046669e-01 1 1  ON 31
eH1_2                -6.335760e-02 1 1  ON 32
eH1_3                -2.620935e-02 1 1  ON 33
eH1_4                 1.914870e-02 1 1  ON 34
eH1_5                 3.361986e-02 1 1  ON 35
eH1_6                 7.749913e-02 1 1  ON 36
eH1_7                 1.096501e-01 1 1  ON 37
eH1_8                 9.618971e-02 1 1  ON 38
eH1_9                 2.606446e-02 1 1  ON 39
eH2_0                -1.850683e-01 1 1  ON 40
eH2_1                -1.061054e-01 1 1  ON 41
eH2_2                -6.463666e-02 1 1  ON 42
eH2_3                -2.799655e-02 1 1  ON 43
eH2_4                 1.782458e-02 1 1  ON 44
eH2_5                 3.224332e-02 1 1  ON 45
eH2_6                 7.956935e-02 1 1  ON 46
eH2_7                 1.139789e-01 1 1  ON 47
eH2_8                 9.920065e-02 1 1  ON 48
eH2_9                 2.827932e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.153
    reference variance = 0.273881
====================================================
  Execution time = 2.0419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2044e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320527202173
                                         uncertainty =       0.006118725048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320527202173
                                         uncertainty =       0.006118725048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400275914
  error estimate for blocks of size 2^( 2) =       0.000409773091
  error estimate for blocks of size 2^( 3) =       0.000418257516
  error estimate for blocks of size 2^( 4) =       0.000424272794
  error estimate for blocks of size 2^( 5) =       0.000427556177
  error estimate for blocks of size 2^( 6) =       0.000431096462
  error estimate for blocks of size 2^( 7) =       0.000431166981

      target function =                  N/A
              le_mean =     -17.216400570642
             les_mean =     296.724890063687
             stat err =       0.000428523104
             autocorr =       1.146118616593
              std dev =       0.566075626666
             le_variance =       0.320441615105


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640057064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216400570642       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216399039387       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216398753066       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216398768131       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216400608391       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216401912233       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216401769785       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216402648804       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216402595672       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216402331531       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216402152727       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.771641e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216400570642       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216399718954       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216399592052       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216399568012       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216400303038       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216400567274       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216400485626       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216400710821       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.762437e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216400570642       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216400263749       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216400218855       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216400203049       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216400403200       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216400455951       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216400440364       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.161523e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6054e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.135451e-01 1 1  ON 0
 uu_1                 5.150225e-02 1 1  ON 1
 uu_2                -4.365307e-02 1 1  ON 2
 uu_3                -9.915958e-02 1 1  ON 3
 uu_4                -1.334762e-01 1 1  ON 4
 uu_5                -1.409591e-01 1 1  ON 5
 uu_6                -1.187912e-01 1 1  ON 6
 uu_7                -4.739955e-02 1 1  ON 7
 uu_8                 9.440146e-02 1 1  ON 8
 uu_9                 1.256933e-01 1 1  ON 9
 ud_0                 3.547717e-01 1 1  ON 10
 ud_1                 9.602510e-02 1 1  ON 11
 ud_2                -1.397663e-02 1 1  ON 12
 ud_3                -7.509497e-02 1 1  ON 13
 ud_4                -1.230200e-01 1 1  ON 14
 ud_5                -1.551165e-01 1 1  ON 15
 ud_6                -1.567645e-01 1 1  ON 16
 ud_7                -1.128916e-01 1 1  ON 17
 ud_8                -3.535801e-03 1 1  ON 18
 ud_9                 9.250102e-02 1 1  ON 19
 eO_0                -7.797812e-01 1 1  ON 20
 eO_1                -4.588537e-01 1 1  ON 21
 eO_2                -4.797387e-02 1 1  ON 22
 eO_3                 2.108307e-01 1 1  ON 23
 eO_4                 3.104034e-01 1 1  ON 24
 eO_5                 3.237545e-01 1 1  ON 25
 eO_6                 2.599277e-01 1 1  ON 26
 eO_7                 1.220993e-01 1 1  ON 27
 eO_8                 2.951706e-02 1 1  ON 28
 eO_9                 1.895294e-02 1 1  ON 29
eH1_0                -1.837824e-01 1 1  ON 30
eH1_1                -1.047651e-01 1 1  ON 31
eH1_2                -6.334297e-02 1 1  ON 32
eH1_3                -2.630157e-02 1 1  ON 33
eH1_4                 1.908726e-02 1 1  ON 34
eH1_5                 3.362100e-02 1 1  ON 35
eH1_6                 7.757998e-02 1 1  ON 36
eH1_7                 1.096929e-01 1 1  ON 37
eH1_8                 9.627598e-02 1 1  ON 38
eH1_9                 2.608307e-02 1 1  ON 39
eH2_0                -1.852383e-01 1 1  ON 40
eH2_1                -1.060640e-01 1 1  ON 41
eH2_2                -6.474625e-02 1 1  ON 42
eH2_3                -2.796026e-02 1 1  ON 43
eH2_4                 1.777429e-02 1 1  ON 44
eH2_5                 3.230555e-02 1 1  ON 45
eH2_6                 7.958694e-02 1 1  ON 46
eH2_7                 1.140006e-01 1 1  ON 47
eH2_8                 9.931135e-02 1 1  ON 48
eH2_9                 2.830936e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2604
    reference variance = 0.225403
====================================================
  Execution time = 1.9589e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2778e-01
  Total weights = 2.0000e+06
  Execution time = 1.8314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327627099287
                                         uncertainty =       0.006973600440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327627099287
                                         uncertainty =       0.006973600440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404666254
  error estimate for blocks of size 2^( 2) =       0.000413720191
  error estimate for blocks of size 2^( 3) =       0.000422358772
  error estimate for blocks of size 2^( 4) =       0.000428344912
  error estimate for blocks of size 2^( 5) =       0.000431966775
  error estimate for blocks of size 2^( 6) =       0.000431944985
  error estimate for blocks of size 2^( 7) =       0.000433125027

      target function =                  N/A
              le_mean =     -17.217168956033
             les_mean =     296.758416251129
             stat err =       0.000431345425
             autocorr =       1.136204260409
              std dev =       0.572284504678
             le_variance =       0.327509554295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328228109467
                                         uncertainty =       0.006987534549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328228109467
                                         uncertainty =       0.006987534549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405037312
  error estimate for blocks of size 2^( 2) =       0.000414076656
  error estimate for blocks of size 2^( 3) =       0.000422698780
  error estimate for blocks of size 2^( 4) =       0.000428667876
  error estimate for blocks of size 2^( 5) =       0.000432283339
  error estimate for blocks of size 2^( 6) =       0.000432259711
  error estimate for blocks of size 2^( 7) =       0.000433436520

      target function =                  N/A
              le_mean =     -17.217173261264
             les_mean =     296.759165393116
             stat err =       0.000431661862
             autocorr =       1.135788046073
              std dev =       0.572809260390
             le_variance =       0.328110448789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328177597756
                                         uncertainty =       0.006985773064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328177597756
                                         uncertainty =       0.006985773064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405006160
  error estimate for blocks of size 2^( 2) =       0.000414046967
  error estimate for blocks of size 2^( 3) =       0.000422671908
  error estimate for blocks of size 2^( 4) =       0.000428643991
  error estimate for blocks of size 2^( 5) =       0.000432261378
  error estimate for blocks of size 2^( 6) =       0.000432239489
  error estimate for blocks of size 2^( 7) =       0.000433416841

      target function =                  N/A
              le_mean =     -17.217172348019
             les_mean =     296.759083476712
             stat err =       0.000431640425
             autocorr =       1.135849954681
              std dev =       0.572765204370
             le_variance =       0.328059979337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327724999310
                                         uncertainty =       0.006975931350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327724999310
                                         uncertainty =       0.006975931350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404726721
  error estimate for blocks of size 2^( 2) =       0.000413778306
  error estimate for blocks of size 2^( 3) =       0.000422414487
  error estimate for blocks of size 2^( 4) =       0.000428398269
  error estimate for blocks of size 2^( 5) =       0.000432019459
  error estimate for blocks of size 2^( 6) =       0.000431997821
  error estimate for blocks of size 2^( 7) =       0.000433177360

      target function =                  N/A
              le_mean =     -17.217169445697
             les_mean =     296.758530994930
             stat err =       0.000431398227
             autocorr =       1.136142893386
              std dev =       0.572370017469
             le_variance =       0.327607436898


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217168956033        initial
     1.5625e-01     1.5625e+00             1.7716e-03       -17.217173261264  <--
     6.2500e-01     6.2500e+00             4.7624e-04       -17.217172348019
     2.5000e+00     2.5000e+01             1.1615e-04       -17.217169445697

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.8838e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.139136e-01 1 1  ON 0
 uu_1                 5.167375e-02 1 1  ON 1
 uu_2                -4.357524e-02 1 1  ON 2
 uu_3                -9.915230e-02 1 1  ON 3
 uu_4                -1.335547e-01 1 1  ON 4
 uu_5                -1.414073e-01 1 1  ON 5
 uu_6                -1.186553e-01 1 1  ON 6
 uu_7                -4.770514e-02 1 1  ON 7
 uu_8                 9.400162e-02 1 1  ON 8
 uu_9                 1.258783e-01 1 1  ON 9
 ud_0                 3.551801e-01 1 1  ON 10
 ud_1                 9.624716e-02 1 1  ON 11
 ud_2                -1.385289e-02 1 1  ON 12
 ud_3                -7.509661e-02 1 1  ON 13
 ud_4                -1.230721e-01 1 1  ON 14
 ud_5                -1.554281e-01 1 1  ON 15
 ud_6                -1.570908e-01 1 1  ON 16
 ud_7                -1.128726e-01 1 1  ON 17
 ud_8                -3.908604e-03 1 1  ON 18
 ud_9                 9.250967e-02 1 1  ON 19
 eO_0                -7.810766e-01 1 1  ON 20
 eO_1                -4.598985e-01 1 1  ON 21
 eO_2                -4.852769e-02 1 1  ON 22
 eO_3                 2.109979e-01 1 1  ON 23
 eO_4                 3.109302e-01 1 1  ON 24
 eO_5                 3.245940e-01 1 1  ON 25
 eO_6                 2.606212e-01 1 1  ON 26
 eO_7                 1.226493e-01 1 1  ON 27
 eO_8                 2.958955e-02 1 1  ON 28
 eO_9                 1.897603e-02 1 1  ON 29
eH1_0                -1.838802e-01 1 1  ON 30
eH1_1                -1.049545e-01 1 1  ON 31
eH1_2                -6.343792e-02 1 1  ON 32
eH1_3                -2.645458e-02 1 1  ON 33
eH1_4                 1.895410e-02 1 1  ON 34
eH1_5                 3.358944e-02 1 1  ON 35
eH1_6                 7.780415e-02 1 1  ON 36
eH1_7                 1.098157e-01 1 1  ON 37
eH1_8                 9.654110e-02 1 1  ON 38
eH1_9                 2.614077e-02 1 1  ON 39
eH2_0                -1.855648e-01 1 1  ON 40
eH2_1                -1.061425e-01 1 1  ON 41
eH2_2                -6.494015e-02 1 1  ON 42
eH2_3                -2.798584e-02 1 1  ON 43
eH2_4                 1.768936e-02 1 1  ON 44
eH2_5                 3.244365e-02 1 1  ON 45
eH2_6                 7.963295e-02 1 1  ON 46
eH2_7                 1.140619e-01 1 1  ON 47
eH2_8                 9.965187e-02 1 1  ON 48
eH2_9                 2.840238e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4897e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.244
    reference variance = 0.1563
====================================================
  Execution time = 1.9934e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2231e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322276000785
                                         uncertainty =       0.004393148488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322276000785
                                         uncertainty =       0.004393148488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401438700
  error estimate for blocks of size 2^( 2) =       0.000410902526
  error estimate for blocks of size 2^( 3) =       0.000419369606
  error estimate for blocks of size 2^( 4) =       0.000426090525
  error estimate for blocks of size 2^( 5) =       0.000429463230
  error estimate for blocks of size 2^( 6) =       0.000429516797
  error estimate for blocks of size 2^( 7) =       0.000429846113

      target function =                  N/A
              le_mean =     -17.216665835484
             les_mean =     296.735888389757
             stat err =       0.000428729166
             autocorr =       1.140584807839
              std dev =       0.567720054416
             le_variance =       0.322306060186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666583548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216665835484       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216666148127       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216667147884       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216666249642       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216666448875       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216669600722       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216673581126       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216671282596       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216672441462       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216671554469       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216672328357       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216671577660       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.398109e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216665835484       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216666067524       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216666833091       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216666295651       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216665921547       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216667117436       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216668273283       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216667761519       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216667869130       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.245688e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216665835484       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216665949719       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216666355668       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216666161989       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216665672499       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216665976966       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216666153963       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216666205179       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.124655e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5582e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.139493e-01 1 1  ON 0
 uu_1                 5.167499e-02 1 1  ON 1
 uu_2                -4.338066e-02 1 1  ON 2
 uu_3                -9.920850e-02 1 1  ON 3
 uu_4                -1.337910e-01 1 1  ON 4
 uu_5                -1.417131e-01 1 1  ON 5
 uu_6                -1.186927e-01 1 1  ON 6
 uu_7                -4.798680e-02 1 1  ON 7
 uu_8                 9.386469e-02 1 1  ON 8
 uu_9                 1.263102e-01 1 1  ON 9
 ud_0                 3.554806e-01 1 1  ON 10
 ud_1                 9.616409e-02 1 1  ON 11
 ud_2                -1.380959e-02 1 1  ON 12
 ud_3                -7.519815e-02 1 1  ON 13
 ud_4                -1.232104e-01 1 1  ON 14
 ud_5                -1.553542e-01 1 1  ON 15
 ud_6                -1.571813e-01 1 1  ON 16
 ud_7                -1.129146e-01 1 1  ON 17
 ud_8                -4.340884e-03 1 1  ON 18
 ud_9                 9.260417e-02 1 1  ON 19
 eO_0                -7.823223e-01 1 1  ON 20
 eO_1                -4.610116e-01 1 1  ON 21
 eO_2                -4.933290e-02 1 1  ON 22
 eO_3                 2.109590e-01 1 1  ON 23
 eO_4                 3.112546e-01 1 1  ON 24
 eO_5                 3.255299e-01 1 1  ON 25
 eO_6                 2.614673e-01 1 1  ON 26
 eO_7                 1.235017e-01 1 1  ON 27
 eO_8                 2.974536e-02 1 1  ON 28
 eO_9                 1.902348e-02 1 1  ON 29
eH1_0                -1.844055e-01 1 1  ON 30
eH1_1                -1.049391e-01 1 1  ON 31
eH1_2                -6.354773e-02 1 1  ON 32
eH1_3                -2.627741e-02 1 1  ON 33
eH1_4                 1.889022e-02 1 1  ON 34
eH1_5                 3.366178e-02 1 1  ON 35
eH1_6                 7.770311e-02 1 1  ON 36
eH1_7                 1.097143e-01 1 1  ON 37
eH1_8                 9.696236e-02 1 1  ON 38
eH1_9                 2.629008e-02 1 1  ON 39
eH2_0                -1.857653e-01 1 1  ON 40
eH2_1                -1.063056e-01 1 1  ON 41
eH2_2                -6.486751e-02 1 1  ON 42
eH2_3                -2.788856e-02 1 1  ON 43
eH2_4                 1.767951e-02 1 1  ON 44
eH2_5                 3.177849e-02 1 1  ON 45
eH2_6                 7.962604e-02 1 1  ON 46
eH2_7                 1.142116e-01 1 1  ON 47
eH2_8                 1.001721e-01 1 1  ON 48
eH2_9                 2.856567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1938
    reference variance = 0.203154
====================================================
  Execution time = 1.9590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1794e-01
  Total weights = 2.0000e+06
  Execution time = 2.3107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317770305306
                                         uncertainty =       0.004129754218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317770305306
                                         uncertainty =       0.004129754218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398596896
  error estimate for blocks of size 2^( 2) =       0.000408185049
  error estimate for blocks of size 2^( 3) =       0.000416862981
  error estimate for blocks of size 2^( 4) =       0.000423952270
  error estimate for blocks of size 2^( 5) =       0.000428516010
  error estimate for blocks of size 2^( 6) =       0.000429725723
  error estimate for blocks of size 2^( 7) =       0.000431584486

      target function =                  N/A
              le_mean =     -17.216695301514
             les_mean =     296.732355916685
             stat err =       0.000428444622
             autocorr =       1.155371281265
              std dev =       0.563701135697
             le_variance =       0.317758970386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318102708284
                                         uncertainty =       0.004135794878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318102708284
                                         uncertainty =       0.004135794878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398805191
  error estimate for blocks of size 2^( 2) =       0.000408377382
  error estimate for blocks of size 2^( 3) =       0.000417042096
  error estimate for blocks of size 2^( 4) =       0.000424116486
  error estimate for blocks of size 2^( 5) =       0.000428664741
  error estimate for blocks of size 2^( 6) =       0.000429867895
  error estimate for blocks of size 2^( 7) =       0.000431739194

      target function =                  N/A
              le_mean =     -17.216699291972
             les_mean =     296.732825512655
             stat err =       0.000428597079
             autocorr =       1.154986231308
              std dev =       0.563995710551
             le_variance =       0.318091161520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318146151113
                                         uncertainty =       0.004138495166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318146151113
                                         uncertainty =       0.004138495166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398832317
  error estimate for blocks of size 2^( 2) =       0.000408403668
  error estimate for blocks of size 2^( 3) =       0.000417073196
  error estimate for blocks of size 2^( 4) =       0.000424150850
  error estimate for blocks of size 2^( 5) =       0.000428703426
  error estimate for blocks of size 2^( 6) =       0.000429905458
  error estimate for blocks of size 2^( 7) =       0.000431778786

      target function =                  N/A
              le_mean =     -17.216700860011
             les_mean =     296.732922777771
             stat err =       0.000428634630
             autocorr =       1.155031500851
              std dev =       0.564034071422
             le_variance =       0.318134433725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317853081329
                                         uncertainty =       0.004132022938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317853081329
                                         uncertainty =       0.004132022938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398648751
  error estimate for blocks of size 2^( 2) =       0.000408233263
  error estimate for blocks of size 2^( 3) =       0.000416909722
  error estimate for blocks of size 2^( 4) =       0.000423996617
  error estimate for blocks of size 2^( 5) =       0.000428558258
  error estimate for blocks of size 2^( 6) =       0.000429764861
  error estimate for blocks of size 2^( 7) =       0.000431627371

      target function =                  N/A
              le_mean =     -17.216696491783
             les_mean =     296.732479584678
             stat err =       0.000428486777
             autocorr =       1.155298029281
              std dev =       0.563774470366
             le_variance =       0.317841653437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216695301514        initial
     3.9062e-02     3.9062e-01             4.3981e-03       -17.216699291972
     1.5625e-01     1.5625e+00             1.2457e-03       -17.216700860011  <--
     6.2500e-01     6.2500e+00             3.1247e-04       -17.216696491783

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0144e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.139493e-01 1 1  ON 0
 uu_1                 5.167499e-02 1 1  ON 1
 uu_2                -4.338066e-02 1 1  ON 2
 uu_3                -9.920850e-02 1 1  ON 3
 uu_4                -1.337910e-01 1 1  ON 4
 uu_5                -1.417131e-01 1 1  ON 5
 uu_6                -1.186927e-01 1 1  ON 6
 uu_7                -4.798680e-02 1 1  ON 7
 uu_8                 9.386469e-02 1 1  ON 8
 uu_9                 1.263102e-01 1 1  ON 9
 ud_0                 3.554806e-01 1 1  ON 10
 ud_1                 9.616409e-02 1 1  ON 11
 ud_2                -1.380959e-02 1 1  ON 12
 ud_3                -7.519815e-02 1 1  ON 13
 ud_4                -1.232104e-01 1 1  ON 14
 ud_5                -1.553542e-01 1 1  ON 15
 ud_6                -1.571813e-01 1 1  ON 16
 ud_7                -1.129146e-01 1 1  ON 17
 ud_8                -4.340884e-03 1 1  ON 18
 ud_9                 9.260417e-02 1 1  ON 19
 eO_0                -7.823223e-01 1 1  ON 20
 eO_1                -4.610116e-01 1 1  ON 21
 eO_2                -4.933290e-02 1 1  ON 22
 eO_3                 2.109590e-01 1 1  ON 23
 eO_4                 3.112546e-01 1 1  ON 24
 eO_5                 3.255299e-01 1 1  ON 25
 eO_6                 2.614673e-01 1 1  ON 26
 eO_7                 1.235017e-01 1 1  ON 27
 eO_8                 2.974536e-02 1 1  ON 28
 eO_9                 1.902348e-02 1 1  ON 29
eH1_0                -1.844055e-01 1 1  ON 30
eH1_1                -1.049391e-01 1 1  ON 31
eH1_2                -6.354773e-02 1 1  ON 32
eH1_3                -2.627741e-02 1 1  ON 33
eH1_4                 1.889022e-02 1 1  ON 34
eH1_5                 3.366178e-02 1 1  ON 35
eH1_6                 7.770311e-02 1 1  ON 36
eH1_7                 1.097143e-01 1 1  ON 37
eH1_8                 9.696236e-02 1 1  ON 38
eH1_9                 2.629008e-02 1 1  ON 39
eH2_0                -1.857653e-01 1 1  ON 40
eH2_1                -1.063056e-01 1 1  ON 41
eH2_2                -6.486751e-02 1 1  ON 42
eH2_3                -2.788856e-02 1 1  ON 43
eH2_4                 1.767951e-02 1 1  ON 44
eH2_5                 3.177849e-02 1 1  ON 45
eH2_6                 7.962604e-02 1 1  ON 46
eH2_7                 1.142116e-01 1 1  ON 47
eH2_8                 1.001721e-01 1 1  ON 48
eH2_9                 2.856567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1766
    reference variance = 0.568506
====================================================
  Execution time = 2.0030e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2985e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329815085845
                                         uncertainty =       0.009010082287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329815085845
                                         uncertainty =       0.009010082287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406108897
  error estimate for blocks of size 2^( 2) =       0.000415255500
  error estimate for blocks of size 2^( 3) =       0.000423880201
  error estimate for blocks of size 2^( 4) =       0.000429783455
  error estimate for blocks of size 2^( 5) =       0.000435281369
  error estimate for blocks of size 2^( 6) =       0.000437070600
  error estimate for blocks of size 2^( 7) =       0.000439194753

      target function =                  N/A
              le_mean =     -17.217311782864
             les_mean =     296.765673735662
             stat err =       0.000435332544
             autocorr =       1.149098512334
              std dev =       0.574324709768
             le_variance =       0.329848872250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721731178286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217311782864       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217310102892       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217310184532       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217312003325       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217314037919       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217317101615       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217315280326       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217314614717       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217314798579       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217314379764       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217315337480       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217315392662       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217315141190       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217315318115       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.211287e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217311782864       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217310668228       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217310661907       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217311971717       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217313696766       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217313192721       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217312663323       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217312501410       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217312526156       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217312423276       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217312615012       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.256022e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217311782864       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217311307754       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217311257347       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217311459129       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217311917420       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217311992926       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217311779514       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217311807828       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.461254e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5609e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.145827e-01 1 1  ON 0
 uu_1                 5.190215e-02 1 1  ON 1
 uu_2                -4.319898e-02 1 1  ON 2
 uu_3                -9.914719e-02 1 1  ON 3
 uu_4                -1.338523e-01 1 1  ON 4
 uu_5                -1.420796e-01 1 1  ON 5
 uu_6                -1.190157e-01 1 1  ON 6
 uu_7                -4.850440e-02 1 1  ON 7
 uu_8                 9.316728e-02 1 1  ON 8
 uu_9                 1.265564e-01 1 1  ON 9
 ud_0                 3.556690e-01 1 1  ON 10
 ud_1                 9.631234e-02 1 1  ON 11
 ud_2                -1.368397e-02 1 1  ON 12
 ud_3                -7.495680e-02 1 1  ON 13
 ud_4                -1.231430e-01 1 1  ON 14
 ud_5                -1.549566e-01 1 1  ON 15
 ud_6                -1.572954e-01 1 1  ON 16
 ud_7                -1.135931e-01 1 1  ON 17
 ud_8                -5.276403e-03 1 1  ON 18
 ud_9                 9.260625e-02 1 1  ON 19
 eO_0                -7.835783e-01 1 1  ON 20
 eO_1                -4.618138e-01 1 1  ON 21
 eO_2                -5.003401e-02 1 1  ON 22
 eO_3                 2.105673e-01 1 1  ON 23
 eO_4                 3.117136e-01 1 1  ON 24
 eO_5                 3.264635e-01 1 1  ON 25
 eO_6                 2.622709e-01 1 1  ON 26
 eO_7                 1.242562e-01 1 1  ON 27
 eO_8                 2.979815e-02 1 1  ON 28
 eO_9                 1.908463e-02 1 1  ON 29
eH1_0                -1.843628e-01 1 1  ON 30
eH1_1                -1.048125e-01 1 1  ON 31
eH1_2                -6.358603e-02 1 1  ON 32
eH1_3                -2.665886e-02 1 1  ON 33
eH1_4                 1.881391e-02 1 1  ON 34
eH1_5                 3.317500e-02 1 1  ON 35
eH1_6                 7.787623e-02 1 1  ON 36
eH1_7                 1.097364e-01 1 1  ON 37
eH1_8                 9.735525e-02 1 1  ON 38
eH1_9                 2.641454e-02 1 1  ON 39
eH2_0                -1.855122e-01 1 1  ON 40
eH2_1                -1.064684e-01 1 1  ON 41
eH2_2                -6.505650e-02 1 1  ON 42
eH2_3                -2.788953e-02 1 1  ON 43
eH2_4                 1.792971e-02 1 1  ON 44
eH2_5                 3.178045e-02 1 1  ON 45
eH2_6                 7.903387e-02 1 1  ON 46
eH2_7                 1.140036e-01 1 1  ON 47
eH2_8                 1.005851e-01 1 1  ON 48
eH2_9                 2.871233e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1782
    reference variance = 0.303522
====================================================
  Execution time = 1.9669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1750e-01
  Total weights = 2.0000e+06
  Execution time = 1.8351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317298652022
                                         uncertainty =       0.004645412222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317298652022
                                         uncertainty =       0.004645412222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398286763
  error estimate for blocks of size 2^( 2) =       0.000407799099
  error estimate for blocks of size 2^( 3) =       0.000416932737
  error estimate for blocks of size 2^( 4) =       0.000423934473
  error estimate for blocks of size 2^( 5) =       0.000427735866
  error estimate for blocks of size 2^( 6) =       0.000429657394
  error estimate for blocks of size 2^( 7) =       0.000429907192

      target function =                  N/A
              le_mean =     -17.216970775516
             les_mean =     296.741347216877
             stat err =       0.000427808731
             autocorr =       1.153738918921
              std dev =       0.563262541408
             le_variance =       0.317264690554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317730507813
                                         uncertainty =       0.004654488889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317730507813
                                         uncertainty =       0.004654488889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398557776
  error estimate for blocks of size 2^( 2) =       0.000408056242
  error estimate for blocks of size 2^( 3) =       0.000417173018
  error estimate for blocks of size 2^( 4) =       0.000424162954
  error estimate for blocks of size 2^( 5) =       0.000427960548
  error estimate for blocks of size 2^( 6) =       0.000429874522
  error estimate for blocks of size 2^( 7) =       0.000430117547

      target function =                  N/A
              le_mean =     -17.216969970760
             les_mean =     296.741751417632
             stat err =       0.000428028893
             autocorr =       1.153356577005
              std dev =       0.563645812913
             le_variance =       0.317696602415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317765920701
                                         uncertainty =       0.004654444778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317765920701
                                         uncertainty =       0.004654444778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398579978
  error estimate for blocks of size 2^( 2) =       0.000408080636
  error estimate for blocks of size 2^( 3) =       0.000417200574
  error estimate for blocks of size 2^( 4) =       0.000424193538
  error estimate for blocks of size 2^( 5) =       0.000427991057
  error estimate for blocks of size 2^( 6) =       0.000429905503
  error estimate for blocks of size 2^( 7) =       0.000430148557

      target function =                  N/A
              le_mean =     -17.216969833415
             les_mean =     296.741782083945
             stat err =       0.000428059664
             autocorr =       1.153393908741
              std dev =       0.563677210909
             le_variance =       0.317731998098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317388608719
                                         uncertainty =       0.004647065604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317388608719
                                         uncertainty =       0.004647065604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398343227
  error estimate for blocks of size 2^( 2) =       0.000407853440
  error estimate for blocks of size 2^( 3) =       0.000416984887
  error estimate for blocks of size 2^( 4) =       0.000423985415
  error estimate for blocks of size 2^( 5) =       0.000427786089
  error estimate for blocks of size 2^( 6) =       0.000429706343
  error estimate for blocks of size 2^( 7) =       0.000429954520

      target function =                  N/A
              le_mean =     -17.216970154524
             les_mean =     296.741415796583
             stat err =       0.000427858092
             autocorr =       1.153678036159
              std dev =       0.563342394535
             le_variance =       0.317354653480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216970775516        initial  <--
     3.9062e-02     3.9062e-01             4.2113e-03       -17.216969970760
     1.5625e-01     1.5625e+00             1.2560e-03       -17.216969833415
     6.2500e-01     6.2500e+00             3.4613e-04       -17.216970154524

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9282
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.139493e-01 1 1  ON 0
 uu_1                 5.167499e-02 1 1  ON 1
 uu_2                -4.338066e-02 1 1  ON 2
 uu_3                -9.920850e-02 1 1  ON 3
 uu_4                -1.337910e-01 1 1  ON 4
 uu_5                -1.417131e-01 1 1  ON 5
 uu_6                -1.186927e-01 1 1  ON 6
 uu_7                -4.798680e-02 1 1  ON 7
 uu_8                 9.386469e-02 1 1  ON 8
 uu_9                 1.263102e-01 1 1  ON 9
 ud_0                 3.554806e-01 1 1  ON 10
 ud_1                 9.616409e-02 1 1  ON 11
 ud_2                -1.380959e-02 1 1  ON 12
 ud_3                -7.519815e-02 1 1  ON 13
 ud_4                -1.232104e-01 1 1  ON 14
 ud_5                -1.553542e-01 1 1  ON 15
 ud_6                -1.571813e-01 1 1  ON 16
 ud_7                -1.129146e-01 1 1  ON 17
 ud_8                -4.340884e-03 1 1  ON 18
 ud_9                 9.260417e-02 1 1  ON 19
 eO_0                -7.823223e-01 1 1  ON 20
 eO_1                -4.610116e-01 1 1  ON 21
 eO_2                -4.933290e-02 1 1  ON 22
 eO_3                 2.109590e-01 1 1  ON 23
 eO_4                 3.112546e-01 1 1  ON 24
 eO_5                 3.255299e-01 1 1  ON 25
 eO_6                 2.614673e-01 1 1  ON 26
 eO_7                 1.235017e-01 1 1  ON 27
 eO_8                 2.974536e-02 1 1  ON 28
 eO_9                 1.902348e-02 1 1  ON 29
eH1_0                -1.844055e-01 1 1  ON 30
eH1_1                -1.049391e-01 1 1  ON 31
eH1_2                -6.354773e-02 1 1  ON 32
eH1_3                -2.627741e-02 1 1  ON 33
eH1_4                 1.889022e-02 1 1  ON 34
eH1_5                 3.366178e-02 1 1  ON 35
eH1_6                 7.770311e-02 1 1  ON 36
eH1_7                 1.097143e-01 1 1  ON 37
eH1_8                 9.696236e-02 1 1  ON 38
eH1_9                 2.629008e-02 1 1  ON 39
eH2_0                -1.857653e-01 1 1  ON 40
eH2_1                -1.063056e-01 1 1  ON 41
eH2_2                -6.486751e-02 1 1  ON 42
eH2_3                -2.788856e-02 1 1  ON 43
eH2_4                 1.767951e-02 1 1  ON 44
eH2_5                 3.177849e-02 1 1  ON 45
eH2_6                 7.962604e-02 1 1  ON 46
eH2_7                 1.142116e-01 1 1  ON 47
eH2_8                 1.001721e-01 1 1  ON 48
eH2_9                 2.856567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2954
    reference variance = 0.263426
====================================================
  Execution time = 2.0378e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2395e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324030631794
                                         uncertainty =       0.004471939548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324030631794
                                         uncertainty =       0.004471939548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402464170
  error estimate for blocks of size 2^( 2) =       0.000412229579
  error estimate for blocks of size 2^( 3) =       0.000420974352
  error estimate for blocks of size 2^( 4) =       0.000427640688
  error estimate for blocks of size 2^( 5) =       0.000431950788
  error estimate for blocks of size 2^( 6) =       0.000434459396
  error estimate for blocks of size 2^( 7) =       0.000434215332

      target function =                  N/A
              le_mean =     -17.217081528355
             les_mean =     296.751851008032
             stat err =       0.000432066551
             autocorr =       1.152515692098
              std dev =       0.569170287345
             le_variance =       0.323954815997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708152835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217081528355       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217081683181       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217082802299       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217083509763       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217085281251       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217085240942       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217084819168       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217084512910       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217084560293       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 6.373589e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217081528355       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217081587970       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217081916843       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217082110686       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217082842844       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217082911076       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217082739047       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217082728946       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.826535e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217081528355       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217081545585       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217081630256       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217081677101       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217081888042       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217081920051       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217081889515       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.818862e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039829 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5926e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.139542e-01 1 1  ON 0
 uu_1                 5.170651e-02 1 1  ON 1
 uu_2                -4.337664e-02 1 1  ON 2
 uu_3                -9.920627e-02 1 1  ON 3
 uu_4                -1.337924e-01 1 1  ON 4
 uu_5                -1.417037e-01 1 1  ON 5
 uu_6                -1.187544e-01 1 1  ON 6
 uu_7                -4.802267e-02 1 1  ON 7
 uu_8                 9.383778e-02 1 1  ON 8
 uu_9                 1.263443e-01 1 1  ON 9
 ud_0                 3.553725e-01 1 1  ON 10
 ud_1                 9.621945e-02 1 1  ON 11
 ud_2                -1.376688e-02 1 1  ON 12
 ud_3                -7.514633e-02 1 1  ON 13
 ud_4                -1.232089e-01 1 1  ON 14
 ud_5                -1.553875e-01 1 1  ON 15
 ud_6                -1.571718e-01 1 1  ON 16
 ud_7                -1.129186e-01 1 1  ON 17
 ud_8                -4.394878e-03 1 1  ON 18
 ud_9                 9.260757e-02 1 1  ON 19
 eO_0                -7.825050e-01 1 1  ON 20
 eO_1                -4.610614e-01 1 1  ON 21
 eO_2                -4.943826e-02 1 1  ON 22
 eO_3                 2.108967e-01 1 1  ON 23
 eO_4                 3.113528e-01 1 1  ON 24
 eO_5                 3.256495e-01 1 1  ON 25
 eO_6                 2.615471e-01 1 1  ON 26
 eO_7                 1.235855e-01 1 1  ON 27
 eO_8                 2.975624e-02 1 1  ON 28
 eO_9                 1.902807e-02 1 1  ON 29
eH1_0                -1.843774e-01 1 1  ON 30
eH1_1                -1.049531e-01 1 1  ON 31
eH1_2                -6.353065e-02 1 1  ON 32
eH1_3                -2.636146e-02 1 1  ON 33
eH1_4                 1.892077e-02 1 1  ON 34
eH1_5                 3.366902e-02 1 1  ON 35
eH1_6                 7.766034e-02 1 1  ON 36
eH1_7                 1.097027e-01 1 1  ON 37
eH1_8                 9.701329e-02 1 1  ON 38
eH1_9                 2.630385e-02 1 1  ON 39
eH2_0                -1.857716e-01 1 1  ON 40
eH2_1                -1.063290e-01 1 1  ON 41
eH2_2                -6.491057e-02 1 1  ON 42
eH2_3                -2.789850e-02 1 1  ON 43
eH2_4                 1.769132e-02 1 1  ON 44
eH2_5                 3.177534e-02 1 1  ON 45
eH2_6                 7.963830e-02 1 1  ON 46
eH2_7                 1.142171e-01 1 1  ON 47
eH2_8                 1.002115e-01 1 1  ON 48
eH2_9                 2.857666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1868
    reference variance = 0.128023
====================================================
  Execution time = 1.9582e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2214e-01
  Total weights = 2.0000e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322211793240
                                         uncertainty =       0.007013088698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322211793240
                                         uncertainty =       0.007013088698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401404607
  error estimate for blocks of size 2^( 2) =       0.000410932092
  error estimate for blocks of size 2^( 3) =       0.000419860134
  error estimate for blocks of size 2^( 4) =       0.000426268905
  error estimate for blocks of size 2^( 5) =       0.000430062061
  error estimate for blocks of size 2^( 6) =       0.000432700168
  error estimate for blocks of size 2^( 7) =       0.000433463484

      target function =                  N/A
              le_mean =     -17.216387600297
             les_mean =     296.726253159202
             stat err =       0.000430623654
             autocorr =       1.150882693882
              std dev =       0.567671838881
             le_variance =       0.322251316658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321992725408
                                         uncertainty =       0.007007832654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321992725408
                                         uncertainty =       0.007007832654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401268094
  error estimate for blocks of size 2^( 2) =       0.000410801366
  error estimate for blocks of size 2^( 3) =       0.000419734317
  error estimate for blocks of size 2^( 4) =       0.000426146606
  error estimate for blocks of size 2^( 5) =       0.000429942675
  error estimate for blocks of size 2^( 6) =       0.000432583998
  error estimate for blocks of size 2^( 7) =       0.000433357835

      target function =                  N/A
              le_mean =     -17.216388087101
             les_mean =     296.726050771960
             stat err =       0.000430507779
             autocorr =       1.151046176112
              std dev =       0.567478781366
             le_variance =       0.322032167301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321995838939
                                         uncertainty =       0.007008124242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321995838939
                                         uncertainty =       0.007008124242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401270036
  error estimate for blocks of size 2^( 2) =       0.000410803098
  error estimate for blocks of size 2^( 3) =       0.000419736049
  error estimate for blocks of size 2^( 4) =       0.000426148411
  error estimate for blocks of size 2^( 5) =       0.000429944633
  error estimate for blocks of size 2^( 6) =       0.000432585364
  error estimate for blocks of size 2^( 7) =       0.000433357496

      target function =                  N/A
              le_mean =     -17.216388149150
             les_mean =     296.726056025536
             stat err =       0.000430508976
             autocorr =       1.151041437272
              std dev =       0.567481527759
             le_variance =       0.322035284347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322175653605
                                         uncertainty =       0.007012261431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322175653605
                                         uncertainty =       0.007012261431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401382090
  error estimate for blocks of size 2^( 2) =       0.000410910490
  error estimate for blocks of size 2^( 3) =       0.000419839346
  error estimate for blocks of size 2^( 4) =       0.000426248716
  error estimate for blocks of size 2^( 5) =       0.000430042411
  error estimate for blocks of size 2^( 6) =       0.000432680899
  error estimate for blocks of size 2^( 7) =       0.000433445642

      target function =                  N/A
              le_mean =     -17.216387674208
             les_mean =     296.726219551370
             stat err =       0.000430604417
             autocorr =       1.150908988084
              std dev =       0.567639994927
             le_variance =       0.322215163841


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216387600297        initial
     3.9062e-01     3.9062e+00             6.3736e-04       -17.216388087101
     1.5625e+00     1.5625e+01             1.8265e-04       -17.216388149150  <--
     6.2500e+00     6.2500e+01             4.8189e-05       -17.216387674208

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.8805e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.139542e-01 1 1  ON 0
 uu_1                 5.170651e-02 1 1  ON 1
 uu_2                -4.337664e-02 1 1  ON 2
 uu_3                -9.920627e-02 1 1  ON 3
 uu_4                -1.337924e-01 1 1  ON 4
 uu_5                -1.417037e-01 1 1  ON 5
 uu_6                -1.187544e-01 1 1  ON 6
 uu_7                -4.802267e-02 1 1  ON 7
 uu_8                 9.383778e-02 1 1  ON 8
 uu_9                 1.263443e-01 1 1  ON 9
 ud_0                 3.553725e-01 1 1  ON 10
 ud_1                 9.621945e-02 1 1  ON 11
 ud_2                -1.376688e-02 1 1  ON 12
 ud_3                -7.514633e-02 1 1  ON 13
 ud_4                -1.232089e-01 1 1  ON 14
 ud_5                -1.553875e-01 1 1  ON 15
 ud_6                -1.571718e-01 1 1  ON 16
 ud_7                -1.129186e-01 1 1  ON 17
 ud_8                -4.394878e-03 1 1  ON 18
 ud_9                 9.260757e-02 1 1  ON 19
 eO_0                -7.825050e-01 1 1  ON 20
 eO_1                -4.610614e-01 1 1  ON 21
 eO_2                -4.943826e-02 1 1  ON 22
 eO_3                 2.108967e-01 1 1  ON 23
 eO_4                 3.113528e-01 1 1  ON 24
 eO_5                 3.256495e-01 1 1  ON 25
 eO_6                 2.615471e-01 1 1  ON 26
 eO_7                 1.235855e-01 1 1  ON 27
 eO_8                 2.975624e-02 1 1  ON 28
 eO_9                 1.902807e-02 1 1  ON 29
eH1_0                -1.843774e-01 1 1  ON 30
eH1_1                -1.049531e-01 1 1  ON 31
eH1_2                -6.353065e-02 1 1  ON 32
eH1_3                -2.636146e-02 1 1  ON 33
eH1_4                 1.892077e-02 1 1  ON 34
eH1_5                 3.366902e-02 1 1  ON 35
eH1_6                 7.766034e-02 1 1  ON 36
eH1_7                 1.097027e-01 1 1  ON 37
eH1_8                 9.701329e-02 1 1  ON 38
eH1_9                 2.630385e-02 1 1  ON 39
eH2_0                -1.857716e-01 1 1  ON 40
eH2_1                -1.063290e-01 1 1  ON 41
eH2_2                -6.491057e-02 1 1  ON 42
eH2_3                -2.789850e-02 1 1  ON 43
eH2_4                 1.769132e-02 1 1  ON 44
eH2_5                 3.177534e-02 1 1  ON 45
eH2_6                 7.963830e-02 1 1  ON 46
eH2_7                 1.142171e-01 1 1  ON 47
eH2_8                 1.002115e-01 1 1  ON 48
eH2_9                 2.857666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2991
    reference variance = 0.23566
====================================================
  Execution time = 1.9996e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2213e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322155718273
                                         uncertainty =       0.004255058255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322155718273
                                         uncertainty =       0.004255058255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401329881
  error estimate for blocks of size 2^( 2) =       0.000410676381
  error estimate for blocks of size 2^( 3) =       0.000419208433
  error estimate for blocks of size 2^( 4) =       0.000425641606
  error estimate for blocks of size 2^( 5) =       0.000430326620
  error estimate for blocks of size 2^( 6) =       0.000433977914
  error estimate for blocks of size 2^( 7) =       0.000433709416

      target function =                  N/A
              le_mean =     -17.217153376686
             les_mean =     296.752501582696
             stat err =       0.000430913889
             autocorr =       1.152863768188
              std dev =       0.567566161287
             le_variance =       0.322131347438


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721715337669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217153376686       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217153261192       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217152311616       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217153368422       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217154038779       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217154185563       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217154433788       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217154425718       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217154230918       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 7.360992e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217153376686       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217153338353       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217152967799       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217153293648       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217153523409       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217153548209       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217153566362       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217153553012       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.107697e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217153376686       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217153366248       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217153261005       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217153344533       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217153397122       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217153409577       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217153410363       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 5.598649e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5598e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.139445e-01 1 1  ON 0
 uu_1                 5.175346e-02 1 1  ON 1
 uu_2                -4.334834e-02 1 1  ON 2
 uu_3                -9.920377e-02 1 1  ON 3
 uu_4                -1.337190e-01 1 1  ON 4
 uu_5                -1.417675e-01 1 1  ON 5
 uu_6                -1.188007e-01 1 1  ON 6
 uu_7                -4.809396e-02 1 1  ON 7
 uu_8                 9.377097e-02 1 1  ON 8
 uu_9                 1.263808e-01 1 1  ON 9
 ud_0                 3.553387e-01 1 1  ON 10
 ud_1                 9.626265e-02 1 1  ON 11
 ud_2                -1.372749e-02 1 1  ON 12
 ud_3                -7.512961e-02 1 1  ON 13
 ud_4                -1.231238e-01 1 1  ON 14
 ud_5                -1.554195e-01 1 1  ON 15
 ud_6                -1.572149e-01 1 1  ON 16
 ud_7                -1.129681e-01 1 1  ON 17
 ud_8                -4.474588e-03 1 1  ON 18
 ud_9                 9.260784e-02 1 1  ON 19
 eO_0                -7.827157e-01 1 1  ON 20
 eO_1                -4.611606e-01 1 1  ON 21
 eO_2                -4.945258e-02 1 1  ON 22
 eO_3                 2.108611e-01 1 1  ON 23
 eO_4                 3.114425e-01 1 1  ON 24
 eO_5                 3.257398e-01 1 1  ON 25
 eO_6                 2.616344e-01 1 1  ON 26
 eO_7                 1.236542e-01 1 1  ON 27
 eO_8                 2.976561e-02 1 1  ON 28
 eO_9                 1.903415e-02 1 1  ON 29
eH1_0                -1.843258e-01 1 1  ON 30
eH1_1                -1.049984e-01 1 1  ON 31
eH1_2                -6.352466e-02 1 1  ON 32
eH1_3                -2.637494e-02 1 1  ON 33
eH1_4                 1.885476e-02 1 1  ON 34
eH1_5                 3.370381e-02 1 1  ON 35
eH1_6                 7.766368e-02 1 1  ON 36
eH1_7                 1.096737e-01 1 1  ON 37
eH1_8                 9.705342e-02 1 1  ON 38
eH1_9                 2.631764e-02 1 1  ON 39
eH2_0                -1.857960e-01 1 1  ON 40
eH2_1                -1.063687e-01 1 1  ON 41
eH2_2                -6.487033e-02 1 1  ON 42
eH2_3                -2.789623e-02 1 1  ON 43
eH2_4                 1.767273e-02 1 1  ON 44
eH2_5                 3.179270e-02 1 1  ON 45
eH2_6                 7.959412e-02 1 1  ON 46
eH2_7                 1.142032e-01 1 1  ON 47
eH2_8                 1.002657e-01 1 1  ON 48
eH2_9                 2.859238e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2675
    reference variance = 0.348131
====================================================
  Execution time = 1.9471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1966e-01
  Total weights = 2.0000e+06
  Execution time = 1.8432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319791205083
                                         uncertainty =       0.003784649379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319791205083
                                         uncertainty =       0.003784649379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399828718
  error estimate for blocks of size 2^( 2) =       0.000409683979
  error estimate for blocks of size 2^( 3) =       0.000417798869
  error estimate for blocks of size 2^( 4) =       0.000423813002
  error estimate for blocks of size 2^( 5) =       0.000428126585
  error estimate for blocks of size 2^( 6) =       0.000428634814
  error estimate for blocks of size 2^( 7) =       0.000429577396

      target function =                  N/A
              le_mean =     -17.216373139634
             les_mean =     296.723229930379
             stat err =       0.000427537949
             autocorr =       1.143408381817
              std dev =       0.565443195321
             le_variance =       0.319726007135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319664009833
                                         uncertainty =       0.003784292378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319664009833
                                         uncertainty =       0.003784292378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399749223
  error estimate for blocks of size 2^( 2) =       0.000409606382
  error estimate for blocks of size 2^( 3) =       0.000417722731
  error estimate for blocks of size 2^( 4) =       0.000423738328
  error estimate for blocks of size 2^( 5) =       0.000428051341
  error estimate for blocks of size 2^( 6) =       0.000428554341
  error estimate for blocks of size 2^( 7) =       0.000429493933

      target function =                  N/A
              le_mean =     -17.216372784136
             les_mean =     296.723090565890
             stat err =       0.000427459486
             autocorr =       1.143443368325
              std dev =       0.565330773401
             le_variance =       0.319598883354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319666350802
                                         uncertainty =       0.003784271368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319666350802
                                         uncertainty =       0.003784271368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399750682
  error estimate for blocks of size 2^( 2) =       0.000409607991
  error estimate for blocks of size 2^( 3) =       0.000417724948
  error estimate for blocks of size 2^( 4) =       0.000423740645
  error estimate for blocks of size 2^( 5) =       0.000428054490
  error estimate for blocks of size 2^( 6) =       0.000428558404
  error estimate for blocks of size 2^( 7) =       0.000429498296

      target function =                  N/A
              le_mean =     -17.216372782364
             les_mean =     296.723092837150
             stat err =       0.000427462959
             autocorr =       1.143453605599
              std dev =       0.565332836157
             le_variance =       0.319601215637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319770370389
                                         uncertainty =       0.003784558315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319770370389
                                         uncertainty =       0.003784558315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399815697
  error estimate for blocks of size 2^( 2) =       0.000409671310
  error estimate for blocks of size 2^( 3) =       0.000417786555
  error estimate for blocks of size 2^( 4) =       0.000423800935
  error estimate for blocks of size 2^( 5) =       0.000428114620
  error estimate for blocks of size 2^( 6) =       0.000428622172
  error estimate for blocks of size 2^( 7) =       0.000429564367

      target function =                  N/A
              le_mean =     -17.216373054761
             les_mean =     296.723206183433
             stat err =       0.000427525524
             autocorr =       1.143416393030
              std dev =       0.565424780655
             le_variance =       0.319705182579


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216373139634        initial  <--
     3.9062e-01     3.9062e+00             7.3610e-04       -17.216372784136
     1.5625e+00     1.5625e+01             2.1077e-04       -17.216372782364
     6.2500e+00     6.2500e+01             5.5986e-05       -17.216373054761

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7750
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.139542e-01 1 1  ON 0
 uu_1                 5.170651e-02 1 1  ON 1
 uu_2                -4.337664e-02 1 1  ON 2
 uu_3                -9.920627e-02 1 1  ON 3
 uu_4                -1.337924e-01 1 1  ON 4
 uu_5                -1.417037e-01 1 1  ON 5
 uu_6                -1.187544e-01 1 1  ON 6
 uu_7                -4.802267e-02 1 1  ON 7
 uu_8                 9.383778e-02 1 1  ON 8
 uu_9                 1.263443e-01 1 1  ON 9
 ud_0                 3.553725e-01 1 1  ON 10
 ud_1                 9.621945e-02 1 1  ON 11
 ud_2                -1.376688e-02 1 1  ON 12
 ud_3                -7.514633e-02 1 1  ON 13
 ud_4                -1.232089e-01 1 1  ON 14
 ud_5                -1.553875e-01 1 1  ON 15
 ud_6                -1.571718e-01 1 1  ON 16
 ud_7                -1.129186e-01 1 1  ON 17
 ud_8                -4.394878e-03 1 1  ON 18
 ud_9                 9.260757e-02 1 1  ON 19
 eO_0                -7.825050e-01 1 1  ON 20
 eO_1                -4.610614e-01 1 1  ON 21
 eO_2                -4.943826e-02 1 1  ON 22
 eO_3                 2.108967e-01 1 1  ON 23
 eO_4                 3.113528e-01 1 1  ON 24
 eO_5                 3.256495e-01 1 1  ON 25
 eO_6                 2.615471e-01 1 1  ON 26
 eO_7                 1.235855e-01 1 1  ON 27
 eO_8                 2.975624e-02 1 1  ON 28
 eO_9                 1.902807e-02 1 1  ON 29
eH1_0                -1.843774e-01 1 1  ON 30
eH1_1                -1.049531e-01 1 1  ON 31
eH1_2                -6.353065e-02 1 1  ON 32
eH1_3                -2.636146e-02 1 1  ON 33
eH1_4                 1.892077e-02 1 1  ON 34
eH1_5                 3.366902e-02 1 1  ON 35
eH1_6                 7.766034e-02 1 1  ON 36
eH1_7                 1.097027e-01 1 1  ON 37
eH1_8                 9.701329e-02 1 1  ON 38
eH1_9                 2.630385e-02 1 1  ON 39
eH2_0                -1.857716e-01 1 1  ON 40
eH2_1                -1.063290e-01 1 1  ON 41
eH2_2                -6.491057e-02 1 1  ON 42
eH2_3                -2.789850e-02 1 1  ON 43
eH2_4                 1.769132e-02 1 1  ON 44
eH2_5                 3.177534e-02 1 1  ON 45
eH2_6                 7.963830e-02 1 1  ON 46
eH2_7                 1.142171e-01 1 1  ON 47
eH2_8                 1.002115e-01 1 1  ON 48
eH2_9                 2.857666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4378e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2228
    reference variance = 0.295225
====================================================
  Execution time = 2.2575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1572e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315705359476
                                         uncertainty =       0.003473357532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315705359476
                                         uncertainty =       0.003473357532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397313869
  error estimate for blocks of size 2^( 2) =       0.000406511089
  error estimate for blocks of size 2^( 3) =       0.000415576089
  error estimate for blocks of size 2^( 4) =       0.000422728835
  error estimate for blocks of size 2^( 5) =       0.000427145811
  error estimate for blocks of size 2^( 6) =       0.000429915236
  error estimate for blocks of size 2^( 7) =       0.000432267250

      target function =                  N/A
              le_mean =     -17.216623028002
             les_mean =     296.727824950989
             stat err =       0.000428014283
             autocorr =       1.160510500714
              std dev =       0.561886661636
             le_variance =       0.315716620525


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662302800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216623028002       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216623086391       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216623095620       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216623195988       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216623160861       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216623192799       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216623187488       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.986362e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216623028002       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216623043307       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216623045810       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216623072404       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216623062620       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216623070226       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216623068624       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.751433e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216623028002       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216623031875       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216623032514       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216623039270       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216623036758       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216623038633       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216623038207       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.381587e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8295e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.139607e-01 1 1  ON 0
 uu_1                 5.171086e-02 1 1  ON 1
 uu_2                -4.337898e-02 1 1  ON 2
 uu_3                -9.920534e-02 1 1  ON 3
 uu_4                -1.337968e-01 1 1  ON 4
 uu_5                -1.417057e-01 1 1  ON 5
 uu_6                -1.187548e-01 1 1  ON 6
 uu_7                -4.802813e-02 1 1  ON 7
 uu_8                 9.383292e-02 1 1  ON 8
 uu_9                 1.263477e-01 1 1  ON 9
 ud_0                 3.553741e-01 1 1  ON 10
 ud_1                 9.622399e-02 1 1  ON 11
 ud_2                -1.376786e-02 1 1  ON 12
 ud_3                -7.514330e-02 1 1  ON 13
 ud_4                -1.232105e-01 1 1  ON 14
 ud_5                -1.553943e-01 1 1  ON 15
 ud_6                -1.571707e-01 1 1  ON 16
 ud_7                -1.129179e-01 1 1  ON 17
 ud_8                -4.400980e-03 1 1  ON 18
 ud_9                 9.260812e-02 1 1  ON 19
 eO_0                -7.825225e-01 1 1  ON 20
 eO_1                -4.610782e-01 1 1  ON 21
 eO_2                -4.944122e-02 1 1  ON 22
 eO_3                 2.108983e-01 1 1  ON 23
 eO_4                 3.113590e-01 1 1  ON 24
 eO_5                 3.256599e-01 1 1  ON 25
 eO_6                 2.615557e-01 1 1  ON 26
 eO_7                 1.235938e-01 1 1  ON 27
 eO_8                 2.975767e-02 1 1  ON 28
 eO_9                 1.902844e-02 1 1  ON 29
eH1_0                -1.843832e-01 1 1  ON 30
eH1_1                -1.049478e-01 1 1  ON 31
eH1_2                -6.353318e-02 1 1  ON 32
eH1_3                -2.636412e-02 1 1  ON 33
eH1_4                 1.892321e-02 1 1  ON 34
eH1_5                 3.366765e-02 1 1  ON 35
eH1_6                 7.765794e-02 1 1  ON 36
eH1_7                 1.097032e-01 1 1  ON 37
eH1_8                 9.701796e-02 1 1  ON 38
eH1_9                 2.630518e-02 1 1  ON 39
eH2_0                -1.857723e-01 1 1  ON 40
eH2_1                -1.063316e-01 1 1  ON 41
eH2_2                -6.490982e-02 1 1  ON 42
eH2_3                -2.789749e-02 1 1  ON 43
eH2_4                 1.768464e-02 1 1  ON 44
eH2_5                 3.177494e-02 1 1  ON 45
eH2_6                 7.963894e-02 1 1  ON 46
eH2_7                 1.142183e-01 1 1  ON 47
eH2_8                 1.002165e-01 1 1  ON 48
eH2_9                 2.857825e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2828
    reference variance = 0.657392
====================================================
  Execution time = 1.9657e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1036e-01
  Total weights = 2.0000e+06
  Execution time = 1.8302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310356174580
                                         uncertainty =       0.002267643735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310356174580
                                         uncertainty =       0.002267643735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393929051
  error estimate for blocks of size 2^( 2) =       0.000403445317
  error estimate for blocks of size 2^( 3) =       0.000412263887
  error estimate for blocks of size 2^( 4) =       0.000418692152
  error estimate for blocks of size 2^( 5) =       0.000421748617
  error estimate for blocks of size 2^( 6) =       0.000424813834
  error estimate for blocks of size 2^( 7) =       0.000425605036

      target function =                  N/A
              le_mean =     -17.216426717281
             les_mean =     296.715708951062
             stat err =       0.000422714909
             autocorr =       1.151487192667
              std dev =       0.557099806806
             le_variance =       0.310360194744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310368821523
                                         uncertainty =       0.002267704933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310368821523
                                         uncertainty =       0.002267704933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393937082
  error estimate for blocks of size 2^( 2) =       0.000403452896
  error estimate for blocks of size 2^( 3) =       0.000412271197
  error estimate for blocks of size 2^( 4) =       0.000418698930
  error estimate for blocks of size 2^( 5) =       0.000421755263
  error estimate for blocks of size 2^( 6) =       0.000424819810
  error estimate for blocks of size 2^( 7) =       0.000425611512

      target function =                  N/A
              le_mean =     -17.216426898640
             les_mean =     296.715727850332
             stat err =       0.000422721379
             autocorr =       1.151475488661
              std dev =       0.557111164213
             le_variance =       0.310372849290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310362703436
                                         uncertainty =       0.002267673728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310362703436
                                         uncertainty =       0.002267673728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393933197
  error estimate for blocks of size 2^( 2) =       0.000403449219
  error estimate for blocks of size 2^( 3) =       0.000412267651
  error estimate for blocks of size 2^( 4) =       0.000418695640
  error estimate for blocks of size 2^( 5) =       0.000421752033
  error estimate for blocks of size 2^( 6) =       0.000424816883
  error estimate for blocks of size 2^( 7) =       0.000425608331

      target function =                  N/A
              le_mean =     -17.216426816231
             les_mean =     296.715718891235
             stat err =       0.000422718222
             autocorr =       1.151481000072
              std dev =       0.557105670215
             le_variance =       0.310366727786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310356997355
                                         uncertainty =       0.002267647462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310356997355
                                         uncertainty =       0.002267647462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393929574
  error estimate for blocks of size 2^( 2) =       0.000403445809
  error estimate for blocks of size 2^( 3) =       0.000412264361
  error estimate for blocks of size 2^( 4) =       0.000418692591
  error estimate for blocks of size 2^( 5) =       0.000421749047
  error estimate for blocks of size 2^( 6) =       0.000424814217
  error estimate for blocks of size 2^( 7) =       0.000425605449

      target function =                  N/A
              le_mean =     -17.216426729841
             les_mean =     296.715710206870
             stat err =       0.000422715326
             autocorr =       1.151486405874
              std dev =       0.557100545732
             le_variance =       0.310361018055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216426717281        initial
     3.9062e+00     3.9062e+01             6.9864e-05       -17.216426898640  <--
     1.5625e+01     1.5625e+02             1.7514e-05       -17.216426816231
     6.2500e+01     6.2500e+02             4.3816e-06       -17.216426729841

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.8898e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.139797e-01 1 1  ON 0
 uu_1                 5.172292e-02 1 1  ON 1
 uu_2                -4.338454e-02 1 1  ON 2
 uu_3                -9.920346e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417118e-01 1 1  ON 5
 uu_6                -1.187558e-01 1 1  ON 6
 uu_7                -4.804432e-02 1 1  ON 7
 uu_8                 9.381845e-02 1 1  ON 8
 uu_9                 1.263580e-01 1 1  ON 9
 ud_0                 3.553793e-01 1 1  ON 10
 ud_1                 9.623656e-02 1 1  ON 11
 ud_2                -1.376979e-02 1 1  ON 12
 ud_3                -7.513548e-02 1 1  ON 13
 ud_4                -1.232147e-01 1 1  ON 14
 ud_5                -1.554144e-01 1 1  ON 15
 ud_6                -1.571677e-01 1 1  ON 16
 ud_7                -1.129160e-01 1 1  ON 17
 ud_8                -4.419131e-03 1 1  ON 18
 ud_9                 9.260976e-02 1 1  ON 19
 eO_0                -7.825748e-01 1 1  ON 20
 eO_1                -4.611279e-01 1 1  ON 21
 eO_2                -4.945081e-02 1 1  ON 22
 eO_3                 2.109035e-01 1 1  ON 23
 eO_4                 3.113773e-01 1 1  ON 24
 eO_5                 3.256906e-01 1 1  ON 25
 eO_6                 2.615815e-01 1 1  ON 26
 eO_7                 1.236185e-01 1 1  ON 27
 eO_8                 2.976195e-02 1 1  ON 28
 eO_9                 1.902956e-02 1 1  ON 29
eH1_0                -1.844003e-01 1 1  ON 30
eH1_1                -1.049333e-01 1 1  ON 31
eH1_2                -6.354019e-02 1 1  ON 32
eH1_3                -2.637157e-02 1 1  ON 33
eH1_4                 1.893002e-02 1 1  ON 34
eH1_5                 3.366376e-02 1 1  ON 35
eH1_6                 7.765082e-02 1 1  ON 36
eH1_7                 1.097047e-01 1 1  ON 37
eH1_8                 9.703187e-02 1 1  ON 38
eH1_9                 2.630912e-02 1 1  ON 39
eH2_0                -1.857743e-01 1 1  ON 40
eH2_1                -1.063384e-01 1 1  ON 41
eH2_2                -6.490817e-02 1 1  ON 42
eH2_3                -2.789465e-02 1 1  ON 43
eH2_4                 1.766491e-02 1 1  ON 44
eH2_5                 3.177355e-02 1 1  ON 45
eH2_6                 7.964078e-02 1 1  ON 46
eH2_7                 1.142218e-01 1 1  ON 47
eH2_8                 1.002314e-01 1 1  ON 48
eH2_9                 2.858298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1591
    reference variance = 0.193327
====================================================
  Execution time = 2.0596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1956e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319471723241
                                         uncertainty =       0.004902099440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319471723241
                                         uncertainty =       0.004902099440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399727475
  error estimate for blocks of size 2^( 2) =       0.000409573951
  error estimate for blocks of size 2^( 3) =       0.000418196332
  error estimate for blocks of size 2^( 4) =       0.000425182112
  error estimate for blocks of size 2^( 5) =       0.000429828363
  error estimate for blocks of size 2^( 6) =       0.000431013667
  error estimate for blocks of size 2^( 7) =       0.000432730876

      target function =                  N/A
              le_mean =     -17.216763501862
             les_mean =     296.736509428254
             stat err =       0.000429688754
             autocorr =       1.155526671598
              std dev =       0.565300016799
             le_variance =       0.319564108993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676350186e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216763501862       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216763318015       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216763407660       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216763643799       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216763581963       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216763625740       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216763663110       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216763648811       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.674683e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216763501862       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216763448090       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216763468843       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216763531150       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216763503746       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216763533966       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216763536190       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.594662e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216763501862       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216763487823       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216763492843       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216763508485       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216763500329       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216763509459       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216763509806       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.648474e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6113e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.140099e-01 1 1  ON 0
 uu_1                 5.173239e-02 1 1  ON 1
 uu_2                -4.338362e-02 1 1  ON 2
 uu_3                -9.920443e-02 1 1  ON 3
 uu_4                -1.338142e-01 1 1  ON 4
 uu_5                -1.417185e-01 1 1  ON 5
 uu_6                -1.187770e-01 1 1  ON 6
 uu_7                -4.805962e-02 1 1  ON 7
 uu_8                 9.380289e-02 1 1  ON 8
 uu_9                 1.263671e-01 1 1  ON 9
 ud_0                 3.553602e-01 1 1  ON 10
 ud_1                 9.625812e-02 1 1  ON 11
 ud_2                -1.376196e-02 1 1  ON 12
 ud_3                -7.513547e-02 1 1  ON 13
 ud_4                -1.231977e-01 1 1  ON 14
 ud_5                -1.554432e-01 1 1  ON 15
 ud_6                -1.571668e-01 1 1  ON 16
 ud_7                -1.129049e-01 1 1  ON 17
 ud_8                -4.443156e-03 1 1  ON 18
 ud_9                 9.260787e-02 1 1  ON 19
 eO_0                -7.826408e-01 1 1  ON 20
 eO_1                -4.611878e-01 1 1  ON 21
 eO_2                -4.945749e-02 1 1  ON 22
 eO_3                 2.109042e-01 1 1  ON 23
 eO_4                 3.113815e-01 1 1  ON 24
 eO_5                 3.257408e-01 1 1  ON 25
 eO_6                 2.616161e-01 1 1  ON 26
 eO_7                 1.236518e-01 1 1  ON 27
 eO_8                 2.976778e-02 1 1  ON 28
 eO_9                 1.903151e-02 1 1  ON 29
eH1_0                -1.843976e-01 1 1  ON 30
eH1_1                -1.049355e-01 1 1  ON 31
eH1_2                -6.354407e-02 1 1  ON 32
eH1_3                -2.638854e-02 1 1  ON 33
eH1_4                 1.894426e-02 1 1  ON 34
eH1_5                 3.364217e-02 1 1  ON 35
eH1_6                 7.764978e-02 1 1  ON 36
eH1_7                 1.097058e-01 1 1  ON 37
eH1_8                 9.705224e-02 1 1  ON 38
eH1_9                 2.631547e-02 1 1  ON 39
eH2_0                -1.857665e-01 1 1  ON 40
eH2_1                -1.063465e-01 1 1  ON 41
eH2_2                -6.489935e-02 1 1  ON 42
eH2_3                -2.791050e-02 1 1  ON 43
eH2_4                 1.765001e-02 1 1  ON 44
eH2_5                 3.177004e-02 1 1  ON 45
eH2_6                 7.963784e-02 1 1  ON 46
eH2_7                 1.142235e-01 1 1  ON 47
eH2_8                 1.002502e-01 1 1  ON 48
eH2_9                 2.858884e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.271
    reference variance = 0.288813
====================================================
  Execution time = 2.0005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4108e-01
  Total weights = 2.0000e+06
  Execution time = 1.8368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341176476989
                                         uncertainty =       0.020039555489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341176476989
                                         uncertainty =       0.020039555489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412973112
  error estimate for blocks of size 2^( 2) =       0.000422369415
  error estimate for blocks of size 2^( 3) =       0.000430830285
  error estimate for blocks of size 2^( 4) =       0.000437842652
  error estimate for blocks of size 2^( 5) =       0.000441005918
  error estimate for blocks of size 2^( 6) =       0.000443019163
  error estimate for blocks of size 2^( 7) =       0.000442485957

      target function =                  N/A
              le_mean =     -17.217430503830
             les_mean =     296.781006566179
             stat err =       0.000441088422
             autocorr =       1.140795406962
              std dev =       0.584032175933
             le_variance =       0.341093582525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341139481816
                                         uncertainty =       0.020037871041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341139481816
                                         uncertainty =       0.020037871041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412950718
  error estimate for blocks of size 2^( 2) =       0.000422348829
  error estimate for blocks of size 2^( 3) =       0.000430809723
  error estimate for blocks of size 2^( 4) =       0.000437820707
  error estimate for blocks of size 2^( 5) =       0.000440984073
  error estimate for blocks of size 2^( 6) =       0.000442998050
  error estimate for blocks of size 2^( 7) =       0.000442462643

      target function =                  N/A
              le_mean =     -17.217430031102
             les_mean =     296.780953295691
             stat err =       0.000441066368
             autocorr =       1.140805055024
              std dev =       0.584000505416
             le_variance =       0.341056590327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341140673066
                                         uncertainty =       0.020038703990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341140673066
                                         uncertainty =       0.020038703990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412951437
  error estimate for blocks of size 2^( 2) =       0.000422349155
  error estimate for blocks of size 2^( 3) =       0.000430810230
  error estimate for blocks of size 2^( 4) =       0.000437821821
  error estimate for blocks of size 2^( 5) =       0.000440985101
  error estimate for blocks of size 2^( 6) =       0.000442998926
  error estimate for blocks of size 2^( 7) =       0.000442464466

      target function =                  N/A
              le_mean =     -17.217430159906
             les_mean =     296.780958919409
             stat err =       0.000441067578
             autocorr =       1.140807340084
              std dev =       0.584001522868
             le_variance =       0.341057778713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341171278258
                                         uncertainty =       0.020039439919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341171278258
                                         uncertainty =       0.020039439919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412969965
  error estimate for blocks of size 2^( 2) =       0.000422366467
  error estimate for blocks of size 2^( 3) =       0.000430827373
  error estimate for blocks of size 2^( 4) =       0.000437839644
  error estimate for blocks of size 2^( 5) =       0.000441002914
  error estimate for blocks of size 2^( 6) =       0.000443016242
  error estimate for blocks of size 2^( 7) =       0.000442482872

      target function =                  N/A
              le_mean =     -17.217430456331
             les_mean =     296.780999731847
             stat err =       0.000441085418
             autocorr =       1.140797254796
              std dev =       0.584027725189
             le_variance =       0.341088383789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217430503830        initial  <--
     9.7656e-01     9.7656e+00             2.6747e-04       -17.217430031102
     3.9062e+00     3.9062e+01             6.5947e-05       -17.217430159906
     1.5625e+01     1.5625e+02             1.6485e-05       -17.217430456331

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2987
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.139797e-01 1 1  ON 0
 uu_1                 5.172292e-02 1 1  ON 1
 uu_2                -4.338454e-02 1 1  ON 2
 uu_3                -9.920346e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417118e-01 1 1  ON 5
 uu_6                -1.187558e-01 1 1  ON 6
 uu_7                -4.804432e-02 1 1  ON 7
 uu_8                 9.381845e-02 1 1  ON 8
 uu_9                 1.263580e-01 1 1  ON 9
 ud_0                 3.553793e-01 1 1  ON 10
 ud_1                 9.623656e-02 1 1  ON 11
 ud_2                -1.376979e-02 1 1  ON 12
 ud_3                -7.513548e-02 1 1  ON 13
 ud_4                -1.232147e-01 1 1  ON 14
 ud_5                -1.554144e-01 1 1  ON 15
 ud_6                -1.571677e-01 1 1  ON 16
 ud_7                -1.129160e-01 1 1  ON 17
 ud_8                -4.419131e-03 1 1  ON 18
 ud_9                 9.260976e-02 1 1  ON 19
 eO_0                -7.825748e-01 1 1  ON 20
 eO_1                -4.611279e-01 1 1  ON 21
 eO_2                -4.945081e-02 1 1  ON 22
 eO_3                 2.109035e-01 1 1  ON 23
 eO_4                 3.113773e-01 1 1  ON 24
 eO_5                 3.256906e-01 1 1  ON 25
 eO_6                 2.615815e-01 1 1  ON 26
 eO_7                 1.236185e-01 1 1  ON 27
 eO_8                 2.976195e-02 1 1  ON 28
 eO_9                 1.902956e-02 1 1  ON 29
eH1_0                -1.844003e-01 1 1  ON 30
eH1_1                -1.049333e-01 1 1  ON 31
eH1_2                -6.354019e-02 1 1  ON 32
eH1_3                -2.637157e-02 1 1  ON 33
eH1_4                 1.893002e-02 1 1  ON 34
eH1_5                 3.366376e-02 1 1  ON 35
eH1_6                 7.765082e-02 1 1  ON 36
eH1_7                 1.097047e-01 1 1  ON 37
eH1_8                 9.703187e-02 1 1  ON 38
eH1_9                 2.630912e-02 1 1  ON 39
eH2_0                -1.857743e-01 1 1  ON 40
eH2_1                -1.063384e-01 1 1  ON 41
eH2_2                -6.490817e-02 1 1  ON 42
eH2_3                -2.789465e-02 1 1  ON 43
eH2_4                 1.766491e-02 1 1  ON 44
eH2_5                 3.177355e-02 1 1  ON 45
eH2_6                 7.964078e-02 1 1  ON 46
eH2_7                 1.142218e-01 1 1  ON 47
eH2_8                 1.002314e-01 1 1  ON 48
eH2_9                 2.858298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2545
    reference variance = 0.227806
====================================================
  Execution time = 2.2689e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1982e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319904087124
                                         uncertainty =       0.003738833240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319904087124
                                         uncertainty =       0.003738833240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399889843
  error estimate for blocks of size 2^( 2) =       0.000409788906
  error estimate for blocks of size 2^( 3) =       0.000418092546
  error estimate for blocks of size 2^( 4) =       0.000424473848
  error estimate for blocks of size 2^( 5) =       0.000428181351
  error estimate for blocks of size 2^( 6) =       0.000429721045
  error estimate for blocks of size 2^( 7) =       0.000431695878

      target function =                  N/A
              le_mean =     -17.217011184391
             les_mean =     296.745297736999
             stat err =       0.000428518031
             autocorr =       1.148305521484
              std dev =       0.565529639762
             le_variance =       0.319823773450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721701118439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217011184391       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217011204455       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217011233167       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217011247006       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217011303662       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217011303788       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217011302901       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.379748e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217011184391       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217011189465       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217011196858       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217011200499       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217011214908       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217011214875       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217011214818       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.998989e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217011184391       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217011185664       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217011187526       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217011188448       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217011192067       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217011192054       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217011192051       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.502939e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049554 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8256e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.139775e-01 1 1  ON 0
 uu_1                 5.172565e-02 1 1  ON 1
 uu_2                -4.338447e-02 1 1  ON 2
 uu_3                -9.920476e-02 1 1  ON 3
 uu_4                -1.338058e-01 1 1  ON 4
 uu_5                -1.417133e-01 1 1  ON 5
 uu_6                -1.187560e-01 1 1  ON 6
 uu_7                -4.804613e-02 1 1  ON 7
 uu_8                 9.381685e-02 1 1  ON 8
 uu_9                 1.263590e-01 1 1  ON 9
 ud_0                 3.553780e-01 1 1  ON 10
 ud_1                 9.623866e-02 1 1  ON 11
 ud_2                -1.376999e-02 1 1  ON 12
 ud_3                -7.513281e-02 1 1  ON 13
 ud_4                -1.232152e-01 1 1  ON 14
 ud_5                -1.554147e-01 1 1  ON 15
 ud_6                -1.571672e-01 1 1  ON 16
 ud_7                -1.129169e-01 1 1  ON 17
 ud_8                -4.421939e-03 1 1  ON 18
 ud_9                 9.260929e-02 1 1  ON 19
 eO_0                -7.825808e-01 1 1  ON 20
 eO_1                -4.611332e-01 1 1  ON 21
 eO_2                -4.945523e-02 1 1  ON 22
 eO_3                 2.109023e-01 1 1  ON 23
 eO_4                 3.113811e-01 1 1  ON 24
 eO_5                 3.256963e-01 1 1  ON 25
 eO_6                 2.615856e-01 1 1  ON 26
 eO_7                 1.236214e-01 1 1  ON 27
 eO_8                 2.976237e-02 1 1  ON 28
 eO_9                 1.902962e-02 1 1  ON 29
eH1_0                -1.844014e-01 1 1  ON 30
eH1_1                -1.049361e-01 1 1  ON 31
eH1_2                -6.354123e-02 1 1  ON 32
eH1_3                -2.637133e-02 1 1  ON 33
eH1_4                 1.893129e-02 1 1  ON 34
eH1_5                 3.366183e-02 1 1  ON 35
eH1_6                 7.765281e-02 1 1  ON 36
eH1_7                 1.097058e-01 1 1  ON 37
eH1_8                 9.703362e-02 1 1  ON 38
eH1_9                 2.630960e-02 1 1  ON 39
eH2_0                -1.857735e-01 1 1  ON 40
eH2_1                -1.063396e-01 1 1  ON 41
eH2_2                -6.490825e-02 1 1  ON 42
eH2_3                -2.789236e-02 1 1  ON 43
eH2_4                 1.766299e-02 1 1  ON 44
eH2_5                 3.177302e-02 1 1  ON 45
eH2_6                 7.963961e-02 1 1  ON 46
eH2_7                 1.142214e-01 1 1  ON 47
eH2_8                 1.002330e-01 1 1  ON 48
eH2_9                 2.858344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1869
    reference variance = 0.249676
====================================================
  Execution time = 2.0040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1132e-01
  Total weights = 2.0000e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311322464604
                                         uncertainty =       0.003084113151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311322464604
                                         uncertainty =       0.003084113151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394536982
  error estimate for blocks of size 2^( 2) =       0.000404232169
  error estimate for blocks of size 2^( 3) =       0.000413006778
  error estimate for blocks of size 2^( 4) =       0.000419730748
  error estimate for blocks of size 2^( 5) =       0.000424124746
  error estimate for blocks of size 2^( 6) =       0.000426461920
  error estimate for blocks of size 2^( 7) =       0.000429356875

      target function =                  N/A
              le_mean =     -17.217366206037
             les_mean =     296.749017777782
             stat err =       0.000424918572
             autocorr =       1.159941242022
              std dev =       0.557959551088
             le_variance =       0.311318860650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311316596322
                                         uncertainty =       0.003084033410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311316596322
                                         uncertainty =       0.003084033410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394533264
  error estimate for blocks of size 2^( 2) =       0.000404228415
  error estimate for blocks of size 2^( 3) =       0.000413003033
  error estimate for blocks of size 2^( 4) =       0.000419727167
  error estimate for blocks of size 2^( 5) =       0.000424121350
  error estimate for blocks of size 2^( 6) =       0.000426458355
  error estimate for blocks of size 2^( 7) =       0.000429352992

      target function =                  N/A
              le_mean =     -17.217366121206
             les_mean =     296.749008989558
             stat err =       0.000424914966
             autocorr =       1.159943414624
              std dev =       0.557954293421
             le_variance =       0.311312993547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311319478355
                                         uncertainty =       0.003084072053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311319478355
                                         uncertainty =       0.003084072053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394535090
  error estimate for blocks of size 2^( 2) =       0.000404230257
  error estimate for blocks of size 2^( 3) =       0.000413004869
  error estimate for blocks of size 2^( 4) =       0.000419728923
  error estimate for blocks of size 2^( 5) =       0.000424123016
  error estimate for blocks of size 2^( 6) =       0.000426460100
  error estimate for blocks of size 2^( 7) =       0.000429354893

      target function =                  N/A
              le_mean =     -17.217366162627
             les_mean =     296.749013297341
             stat err =       0.000424916733
             autocorr =       1.159942325209
              std dev =       0.557956875588
             le_variance =       0.311315875016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311322089296
                                         uncertainty =       0.003084107972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311322089296
                                         uncertainty =       0.003084107972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394536744
  error estimate for blocks of size 2^( 2) =       0.000404231928
  error estimate for blocks of size 2^( 3) =       0.000413006538
  error estimate for blocks of size 2^( 4) =       0.000419730518
  error estimate for blocks of size 2^( 5) =       0.000424124529
  error estimate for blocks of size 2^( 6) =       0.000426461691
  error estimate for blocks of size 2^( 7) =       0.000429356625

      target function =                  N/A
              le_mean =     -17.217366200551
             les_mean =     296.749017213635
             stat err =       0.000424918341
             autocorr =       1.159941377314
              std dev =       0.557959214835
             le_variance =       0.311318485420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217366206037        initial  <--
     9.7656e+00     9.7656e+01             2.3797e-05       -17.217366121206
     3.9062e+01     3.9062e+02             5.9990e-06       -17.217366162627
     1.5625e+02     1.5625e+03             1.5029e-06       -17.217366200551

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3505
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.139797e-01 1 1  ON 0
 uu_1                 5.172292e-02 1 1  ON 1
 uu_2                -4.338454e-02 1 1  ON 2
 uu_3                -9.920346e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417118e-01 1 1  ON 5
 uu_6                -1.187558e-01 1 1  ON 6
 uu_7                -4.804432e-02 1 1  ON 7
 uu_8                 9.381845e-02 1 1  ON 8
 uu_9                 1.263580e-01 1 1  ON 9
 ud_0                 3.553793e-01 1 1  ON 10
 ud_1                 9.623656e-02 1 1  ON 11
 ud_2                -1.376979e-02 1 1  ON 12
 ud_3                -7.513548e-02 1 1  ON 13
 ud_4                -1.232147e-01 1 1  ON 14
 ud_5                -1.554144e-01 1 1  ON 15
 ud_6                -1.571677e-01 1 1  ON 16
 ud_7                -1.129160e-01 1 1  ON 17
 ud_8                -4.419131e-03 1 1  ON 18
 ud_9                 9.260976e-02 1 1  ON 19
 eO_0                -7.825748e-01 1 1  ON 20
 eO_1                -4.611279e-01 1 1  ON 21
 eO_2                -4.945081e-02 1 1  ON 22
 eO_3                 2.109035e-01 1 1  ON 23
 eO_4                 3.113773e-01 1 1  ON 24
 eO_5                 3.256906e-01 1 1  ON 25
 eO_6                 2.615815e-01 1 1  ON 26
 eO_7                 1.236185e-01 1 1  ON 27
 eO_8                 2.976195e-02 1 1  ON 28
 eO_9                 1.902956e-02 1 1  ON 29
eH1_0                -1.844003e-01 1 1  ON 30
eH1_1                -1.049333e-01 1 1  ON 31
eH1_2                -6.354019e-02 1 1  ON 32
eH1_3                -2.637157e-02 1 1  ON 33
eH1_4                 1.893002e-02 1 1  ON 34
eH1_5                 3.366376e-02 1 1  ON 35
eH1_6                 7.765082e-02 1 1  ON 36
eH1_7                 1.097047e-01 1 1  ON 37
eH1_8                 9.703187e-02 1 1  ON 38
eH1_9                 2.630912e-02 1 1  ON 39
eH2_0                -1.857743e-01 1 1  ON 40
eH2_1                -1.063384e-01 1 1  ON 41
eH2_2                -6.490817e-02 1 1  ON 42
eH2_3                -2.789465e-02 1 1  ON 43
eH2_4                 1.766491e-02 1 1  ON 44
eH2_5                 3.177355e-02 1 1  ON 45
eH2_6                 7.964078e-02 1 1  ON 46
eH2_7                 1.142218e-01 1 1  ON 47
eH2_8                 1.002314e-01 1 1  ON 48
eH2_9                 2.858298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2109
    reference variance = 0.265636
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1767e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6570e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317782204042
                                         uncertainty =       0.003105234601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317782204042
                                         uncertainty =       0.003105234601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398543914
  error estimate for blocks of size 2^( 2) =       0.000408172774
  error estimate for blocks of size 2^( 3) =       0.000416527208
  error estimate for blocks of size 2^( 4) =       0.000422432783
  error estimate for blocks of size 2^( 5) =       0.000425331450
  error estimate for blocks of size 2^( 6) =       0.000427716467
  error estimate for blocks of size 2^( 7) =       0.000428976235

      target function =                  N/A
              le_mean =     -17.216966994657
             les_mean =     296.741626838526
             stat err =       0.000426114234
             autocorr =       1.143140786950
              std dev =       0.563626207931
             le_variance =       0.317674502267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696699466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216966994657       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216966992882       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216966995443       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216966993242       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216966999054       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216966999685       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216966999024       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.307152e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216966994657       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216966994213       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216966994854       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216966994302       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216966995758       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216966995915       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216966995751       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.773134e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216966994657       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216966994546       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216966994706       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216966994568       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216966994931       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216966994971       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216966994930       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.443613e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051825 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6072e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.139795e-01 1 1  ON 0
 uu_1                 5.172319e-02 1 1  ON 1
 uu_2                -4.338458e-02 1 1  ON 2
 uu_3                -9.920353e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417117e-01 1 1  ON 5
 uu_6                -1.187559e-01 1 1  ON 6
 uu_7                -4.804442e-02 1 1  ON 7
 uu_8                 9.381829e-02 1 1  ON 8
 uu_9                 1.263581e-01 1 1  ON 9
 ud_0                 3.553792e-01 1 1  ON 10
 ud_1                 9.623668e-02 1 1  ON 11
 ud_2                -1.376965e-02 1 1  ON 12
 ud_3                -7.513540e-02 1 1  ON 13
 ud_4                -1.232146e-01 1 1  ON 14
 ud_5                -1.554143e-01 1 1  ON 15
 ud_6                -1.571678e-01 1 1  ON 16
 ud_7                -1.129161e-01 1 1  ON 17
 ud_8                -4.419387e-03 1 1  ON 18
 ud_9                 9.260973e-02 1 1  ON 19
 eO_0                -7.825754e-01 1 1  ON 20
 eO_1                -4.611283e-01 1 1  ON 21
 eO_2                -4.945112e-02 1 1  ON 22
 eO_3                 2.109034e-01 1 1  ON 23
 eO_4                 3.113775e-01 1 1  ON 24
 eO_5                 3.256911e-01 1 1  ON 25
 eO_6                 2.615818e-01 1 1  ON 26
 eO_7                 1.236188e-01 1 1  ON 27
 eO_8                 2.976200e-02 1 1  ON 28
 eO_9                 1.902957e-02 1 1  ON 29
eH1_0                -1.844000e-01 1 1  ON 30
eH1_1                -1.049334e-01 1 1  ON 31
eH1_2                -6.354039e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.893004e-02 1 1  ON 34
eH1_5                 3.366341e-02 1 1  ON 35
eH1_6                 7.765087e-02 1 1  ON 36
eH1_7                 1.097048e-01 1 1  ON 37
eH1_8                 9.703204e-02 1 1  ON 38
eH1_9                 2.630916e-02 1 1  ON 39
eH2_0                -1.857744e-01 1 1  ON 40
eH2_1                -1.063386e-01 1 1  ON 41
eH2_2                -6.490817e-02 1 1  ON 42
eH2_3                -2.789442e-02 1 1  ON 43
eH2_4                 1.766481e-02 1 1  ON 44
eH2_5                 3.177362e-02 1 1  ON 45
eH2_6                 7.964072e-02 1 1  ON 46
eH2_7                 1.142218e-01 1 1  ON 47
eH2_8                 1.002315e-01 1 1  ON 48
eH2_9                 2.858302e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2785
    reference variance = 0.175469
====================================================
  Execution time = 1.9746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2762e-01
  Total weights = 2.0000e+06
  Execution time = 1.8372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327708585814
                                         uncertainty =       0.010206889037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327708585814
                                         uncertainty =       0.010206889037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404735107
  error estimate for blocks of size 2^( 2) =       0.000414646954
  error estimate for blocks of size 2^( 3) =       0.000423334455
  error estimate for blocks of size 2^( 4) =       0.000429302017
  error estimate for blocks of size 2^( 5) =       0.000433231016
  error estimate for blocks of size 2^( 6) =       0.000435793090
  error estimate for blocks of size 2^( 7) =       0.000435326697

      target function =                  N/A
              le_mean =     -17.216981891011
             les_mean =     296.752086285406
             stat err =       0.000433413205
             autocorr =       1.146733564067
              std dev =       0.572381877601
             le_variance =       0.327621013806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327707947905
                                         uncertainty =       0.010206886869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327707947905
                                         uncertainty =       0.010206886869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404734714
  error estimate for blocks of size 2^( 2) =       0.000414646571
  error estimate for blocks of size 2^( 3) =       0.000423334075
  error estimate for blocks of size 2^( 4) =       0.000429301642
  error estimate for blocks of size 2^( 5) =       0.000433230636
  error estimate for blocks of size 2^( 6) =       0.000435792696
  error estimate for blocks of size 2^( 7) =       0.000435326362

      target function =                  N/A
              le_mean =     -17.216981893989
             les_mean =     296.752085751070
             stat err =       0.000433412834
             autocorr =       1.146733827948
              std dev =       0.572381321275
             le_variance =       0.327620376944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327708266044
                                         uncertainty =       0.010206887944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327708266044
                                         uncertainty =       0.010206887944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404734910
  error estimate for blocks of size 2^( 2) =       0.000414646762
  error estimate for blocks of size 2^( 3) =       0.000423334264
  error estimate for blocks of size 2^( 4) =       0.000429301829
  error estimate for blocks of size 2^( 5) =       0.000433230826
  error estimate for blocks of size 2^( 6) =       0.000435792892
  error estimate for blocks of size 2^( 7) =       0.000435326529

      target function =                  N/A
              le_mean =     -17.216981892506
             les_mean =     296.752086017628
             stat err =       0.000433413019
             autocorr =       1.146733696341
              std dev =       0.572381598727
             le_variance =       0.327620694561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327708545816
                                         uncertainty =       0.010206888900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327708545816
                                         uncertainty =       0.010206888900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404735082
  error estimate for blocks of size 2^( 2) =       0.000414646930
  error estimate for blocks of size 2^( 3) =       0.000423334431
  error estimate for blocks of size 2^( 4) =       0.000429301994
  error estimate for blocks of size 2^( 5) =       0.000433230992
  error estimate for blocks of size 2^( 6) =       0.000435793066
  error estimate for blocks of size 2^( 7) =       0.000435326676

      target function =                  N/A
              le_mean =     -17.216981891198
             les_mean =     296.752086251908
             stat err =       0.000433413182
             autocorr =       1.146733580606
              std dev =       0.572381842718
             le_variance =       0.327620973874


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216981891011        initial
     9.7656e+01     9.7656e+02             2.3072e-06       -17.216981893989  <--
     3.9062e+02     3.9062e+03             5.7731e-07       -17.216981892506
     1.5625e+03     1.5625e+04             1.4436e-07       -17.216981891198

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.9052e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.139790e-01 1 1  ON 0
 uu_1                 5.172402e-02 1 1  ON 1
 uu_2                -4.338471e-02 1 1  ON 2
 uu_3                -9.920374e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187561e-01 1 1  ON 6
 uu_7                -4.804474e-02 1 1  ON 7
 uu_8                 9.381781e-02 1 1  ON 8
 uu_9                 1.263584e-01 1 1  ON 9
 ud_0                 3.553788e-01 1 1  ON 10
 ud_1                 9.623704e-02 1 1  ON 11
 ud_2                -1.376924e-02 1 1  ON 12
 ud_3                -7.513514e-02 1 1  ON 13
 ud_4                -1.232145e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571683e-01 1 1  ON 16
 ud_7                -1.129162e-01 1 1  ON 17
 ud_8                -4.420157e-03 1 1  ON 18
 ud_9                 9.260964e-02 1 1  ON 19
 eO_0                -7.825771e-01 1 1  ON 20
 eO_1                -4.611296e-01 1 1  ON 21
 eO_2                -4.945204e-02 1 1  ON 22
 eO_3                 2.109032e-01 1 1  ON 23
 eO_4                 3.113782e-01 1 1  ON 24
 eO_5                 3.256926e-01 1 1  ON 25
 eO_6                 2.615828e-01 1 1  ON 26
 eO_7                 1.236197e-01 1 1  ON 27
 eO_8                 2.976212e-02 1 1  ON 28
 eO_9                 1.902959e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049336e-01 1 1  ON 31
eH1_2                -6.354098e-02 1 1  ON 32
eH1_3                -2.637136e-02 1 1  ON 33
eH1_4                 1.893011e-02 1 1  ON 34
eH1_5                 3.366237e-02 1 1  ON 35
eH1_6                 7.765103e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703255e-02 1 1  ON 38
eH1_9                 2.630927e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490818e-02 1 1  ON 42
eH2_3                -2.789372e-02 1 1  ON 43
eH2_4                 1.766449e-02 1 1  ON 44
eH2_5                 3.177384e-02 1 1  ON 45
eH2_6                 7.964054e-02 1 1  ON 46
eH2_7                 1.142217e-01 1 1  ON 47
eH2_8                 1.002319e-01 1 1  ON 48
eH2_9                 2.858314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5164e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2663
    reference variance = 0.30526
====================================================
  Execution time = 2.0249e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1369e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313631759191
                                         uncertainty =       0.002640067933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313631759191
                                         uncertainty =       0.002640067933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396036317
  error estimate for blocks of size 2^( 2) =       0.000405763616
  error estimate for blocks of size 2^( 3) =       0.000414277454
  error estimate for blocks of size 2^( 4) =       0.000420811937
  error estimate for blocks of size 2^( 5) =       0.000423942289
  error estimate for blocks of size 2^( 6) =       0.000425395337
  error estimate for blocks of size 2^( 7) =       0.000428678655

      target function =                  N/A
              le_mean =     -17.216215448819
             les_mean =     296.711763752654
             stat err =       0.000424707055
             autocorr =       1.150029346535
              std dev =       0.560079931217
             le_variance =       0.313689529352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621544882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216215448819       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216215463936       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216215509809       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215535237       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216215531401       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216215525784       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216215523590       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.491265e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216215448819       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216215452624       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216215464200       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215470641       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216215469739       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216215468305       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216215467756       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.745735e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216215448819       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216215449772       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216215452673       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215454288       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216215454066       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216215453706       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216215453568       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 9.375453e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054102 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5815e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.139802e-01 1 1  ON 0
 uu_1                 5.172530e-02 1 1  ON 1
 uu_2                -4.338493e-02 1 1  ON 2
 uu_3                -9.920354e-02 1 1  ON 3
 uu_4                -1.338097e-01 1 1  ON 4
 uu_5                -1.417117e-01 1 1  ON 5
 uu_6                -1.187570e-01 1 1  ON 6
 uu_7                -4.804572e-02 1 1  ON 7
 uu_8                 9.381714e-02 1 1  ON 8
 uu_9                 1.263589e-01 1 1  ON 9
 ud_0                 3.553798e-01 1 1  ON 10
 ud_1                 9.623760e-02 1 1  ON 11
 ud_2                -1.376954e-02 1 1  ON 12
 ud_3                -7.513496e-02 1 1  ON 13
 ud_4                -1.232153e-01 1 1  ON 14
 ud_5                -1.554132e-01 1 1  ON 15
 ud_6                -1.571686e-01 1 1  ON 16
 ud_7                -1.129166e-01 1 1  ON 17
 ud_8                -4.421140e-03 1 1  ON 18
 ud_9                 9.260962e-02 1 1  ON 19
 eO_0                -7.825785e-01 1 1  ON 20
 eO_1                -4.611334e-01 1 1  ON 21
 eO_2                -4.945227e-02 1 1  ON 22
 eO_3                 2.109026e-01 1 1  ON 23
 eO_4                 3.113791e-01 1 1  ON 24
 eO_5                 3.256948e-01 1 1  ON 25
 eO_6                 2.615842e-01 1 1  ON 26
 eO_7                 1.236210e-01 1 1  ON 27
 eO_8                 2.976229e-02 1 1  ON 28
 eO_9                 1.902963e-02 1 1  ON 29
eH1_0                -1.843996e-01 1 1  ON 30
eH1_1                -1.049335e-01 1 1  ON 31
eH1_2                -6.354123e-02 1 1  ON 32
eH1_3                -2.637174e-02 1 1  ON 33
eH1_4                 1.893004e-02 1 1  ON 34
eH1_5                 3.366211e-02 1 1  ON 35
eH1_6                 7.765126e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703319e-02 1 1  ON 38
eH1_9                 2.630947e-02 1 1  ON 39
eH2_0                -1.857740e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490981e-02 1 1  ON 42
eH2_3                -2.789255e-02 1 1  ON 43
eH2_4                 1.766291e-02 1 1  ON 44
eH2_5                 3.177406e-02 1 1  ON 45
eH2_6                 7.964069e-02 1 1  ON 46
eH2_7                 1.142218e-01 1 1  ON 47
eH2_8                 1.002326e-01 1 1  ON 48
eH2_9                 2.858333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.069
    reference variance = 0.281919
====================================================
  Execution time = 1.9867e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1928e-01
  Total weights = 2.0000e+06
  Execution time = 1.8449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319322869787
                                         uncertainty =       0.003669470140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319322869787
                                         uncertainty =       0.003669470140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399547152
  error estimate for blocks of size 2^( 2) =       0.000409201721
  error estimate for blocks of size 2^( 3) =       0.000417619764
  error estimate for blocks of size 2^( 4) =       0.000424045891
  error estimate for blocks of size 2^( 5) =       0.000427910913
  error estimate for blocks of size 2^( 6) =       0.000429689676
  error estimate for blocks of size 2^( 7) =       0.000431359746

      target function =                  N/A
              le_mean =     -17.216922744588
             les_mean =     296.741704486687
             stat err =       0.000428251557
             autocorr =       1.148846013895
              std dev =       0.565045001053
             le_variance =       0.319275853215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319328705459
                                         uncertainty =       0.003669545377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319328705459
                                         uncertainty =       0.003669545377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399550801
  error estimate for blocks of size 2^( 2) =       0.000409205183
  error estimate for blocks of size 2^( 3) =       0.000417622994
  error estimate for blocks of size 2^( 4) =       0.000424048953
  error estimate for blocks of size 2^( 5) =       0.000427913905
  error estimate for blocks of size 2^( 6) =       0.000429692685
  error estimate for blocks of size 2^( 7) =       0.000431362815

      target function =                  N/A
              le_mean =     -17.216922726675
             les_mean =     296.741709702042
             stat err =       0.000428254590
             autocorr =       1.148841301559
              std dev =       0.565050161821
             le_variance =       0.319281685374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319325822058
                                         uncertainty =       0.003669508235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319325822058
                                         uncertainty =       0.003669508235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399548998
  error estimate for blocks of size 2^( 2) =       0.000409203472
  error estimate for blocks of size 2^( 3) =       0.000417621398
  error estimate for blocks of size 2^( 4) =       0.000424047440
  error estimate for blocks of size 2^( 5) =       0.000427912427
  error estimate for blocks of size 2^( 6) =       0.000429691199
  error estimate for blocks of size 2^( 7) =       0.000431361300

      target function =                  N/A
              le_mean =     -17.216922735699
             les_mean =     296.741707131082
             stat err =       0.000428253092
             autocorr =       1.148843634034
              std dev =       0.565047611889
             le_variance =       0.319278803702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319323239876
                                         uncertainty =       0.003669474917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319323239876
                                         uncertainty =       0.003669474917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399547383
  error estimate for blocks of size 2^( 2) =       0.000409201941
  error estimate for blocks of size 2^( 3) =       0.000417619968
  error estimate for blocks of size 2^( 4) =       0.000424046086
  error estimate for blocks of size 2^( 5) =       0.000427911102
  error estimate for blocks of size 2^( 6) =       0.000429689867
  error estimate for blocks of size 2^( 7) =       0.000431359941

      target function =                  N/A
              le_mean =     -17.216922743474
             les_mean =     296.741704818208
             stat err =       0.000428251749
             autocorr =       1.148845715645
              std dev =       0.565045328341
             le_variance =       0.319276223080


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216922744588        initial  <--
     2.4414e+01     2.4414e+02             1.4913e-05       -17.216922726675
     9.7656e+01     9.7656e+02             3.7457e-06       -17.216922735699
     3.9062e+02     3.9062e+03             9.3755e-07       -17.216922743474

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2065
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.139790e-01 1 1  ON 0
 uu_1                 5.172402e-02 1 1  ON 1
 uu_2                -4.338471e-02 1 1  ON 2
 uu_3                -9.920374e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187561e-01 1 1  ON 6
 uu_7                -4.804474e-02 1 1  ON 7
 uu_8                 9.381781e-02 1 1  ON 8
 uu_9                 1.263584e-01 1 1  ON 9
 ud_0                 3.553788e-01 1 1  ON 10
 ud_1                 9.623704e-02 1 1  ON 11
 ud_2                -1.376924e-02 1 1  ON 12
 ud_3                -7.513514e-02 1 1  ON 13
 ud_4                -1.232145e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571683e-01 1 1  ON 16
 ud_7                -1.129162e-01 1 1  ON 17
 ud_8                -4.420157e-03 1 1  ON 18
 ud_9                 9.260964e-02 1 1  ON 19
 eO_0                -7.825771e-01 1 1  ON 20
 eO_1                -4.611296e-01 1 1  ON 21
 eO_2                -4.945204e-02 1 1  ON 22
 eO_3                 2.109032e-01 1 1  ON 23
 eO_4                 3.113782e-01 1 1  ON 24
 eO_5                 3.256926e-01 1 1  ON 25
 eO_6                 2.615828e-01 1 1  ON 26
 eO_7                 1.236197e-01 1 1  ON 27
 eO_8                 2.976212e-02 1 1  ON 28
 eO_9                 1.902959e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049336e-01 1 1  ON 31
eH1_2                -6.354098e-02 1 1  ON 32
eH1_3                -2.637136e-02 1 1  ON 33
eH1_4                 1.893011e-02 1 1  ON 34
eH1_5                 3.366237e-02 1 1  ON 35
eH1_6                 7.765103e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703255e-02 1 1  ON 38
eH1_9                 2.630927e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490818e-02 1 1  ON 42
eH2_3                -2.789372e-02 1 1  ON 43
eH2_4                 1.766449e-02 1 1  ON 44
eH2_5                 3.177384e-02 1 1  ON 45
eH2_6                 7.964054e-02 1 1  ON 46
eH2_7                 1.142217e-01 1 1  ON 47
eH2_8                 1.002319e-01 1 1  ON 48
eH2_9                 2.858314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5027e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.293002
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1846e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318459318046
                                         uncertainty =       0.004163465759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318459318046
                                         uncertainty =       0.004163465759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399039461
  error estimate for blocks of size 2^( 2) =       0.000408530458
  error estimate for blocks of size 2^( 3) =       0.000417334611
  error estimate for blocks of size 2^( 4) =       0.000424307067
  error estimate for blocks of size 2^( 5) =       0.000429082012
  error estimate for blocks of size 2^( 6) =       0.000431696344
  error estimate for blocks of size 2^( 7) =       0.000431999500

      target function =                  N/A
              le_mean =     -17.216431118343
             les_mean =     296.723965275987
             stat err =       0.000429271230
             autocorr =       1.157262489729
              std dev =       0.564327017398
             le_variance =       0.318464982565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643111834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216431118343       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431119521       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216431119830       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216431120758       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216431120615       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216431120894       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216431120567       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.101241e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216431118343       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431118638       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216431118715       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216431118947       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216431118911       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216431118982       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216431118899       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.753721e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216431118343       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431118417       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216431118436       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216431118494       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216431118485       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216431118503       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216431118485       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 6.884689e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.056436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8940e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.139791e-01 1 1  ON 0
 uu_1                 5.172405e-02 1 1  ON 1
 uu_2                -4.338474e-02 1 1  ON 2
 uu_3                -9.920382e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187561e-01 1 1  ON 6
 uu_7                -4.804474e-02 1 1  ON 7
 uu_8                 9.381777e-02 1 1  ON 8
 uu_9                 1.263584e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.623705e-02 1 1  ON 11
 ud_2                -1.376920e-02 1 1  ON 12
 ud_3                -7.513516e-02 1 1  ON 13
 ud_4                -1.232145e-01 1 1  ON 14
 ud_5                -1.554139e-01 1 1  ON 15
 ud_6                -1.571682e-01 1 1  ON 16
 ud_7                -1.129162e-01 1 1  ON 17
 ud_8                -4.420210e-03 1 1  ON 18
 ud_9                 9.260965e-02 1 1  ON 19
 eO_0                -7.825774e-01 1 1  ON 20
 eO_1                -4.611299e-01 1 1  ON 21
 eO_2                -4.945222e-02 1 1  ON 22
 eO_3                 2.109032e-01 1 1  ON 23
 eO_4                 3.113783e-01 1 1  ON 24
 eO_5                 3.256928e-01 1 1  ON 25
 eO_6                 2.615829e-01 1 1  ON 26
 eO_7                 1.236199e-01 1 1  ON 27
 eO_8                 2.976214e-02 1 1  ON 28
 eO_9                 1.902960e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049337e-01 1 1  ON 31
eH1_2                -6.354096e-02 1 1  ON 32
eH1_3                -2.637138e-02 1 1  ON 33
eH1_4                 1.893018e-02 1 1  ON 34
eH1_5                 3.366228e-02 1 1  ON 35
eH1_6                 7.765101e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703265e-02 1 1  ON 38
eH1_9                 2.630930e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490827e-02 1 1  ON 42
eH2_3                -2.789370e-02 1 1  ON 43
eH2_4                 1.766446e-02 1 1  ON 44
eH2_5                 3.177387e-02 1 1  ON 45
eH2_6                 7.964054e-02 1 1  ON 46
eH2_7                 1.142217e-01 1 1  ON 47
eH2_8                 1.002320e-01 1 1  ON 48
eH2_9                 2.858316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2563
    reference variance = 0.54723
====================================================
  Execution time = 2.0123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1569e-01
  Total weights = 2.0000e+06
  Execution time = 1.8431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315671144270
                                         uncertainty =       0.003345377922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315671144270
                                         uncertainty =       0.003345377922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397296824
  error estimate for blocks of size 2^( 2) =       0.000407330633
  error estimate for blocks of size 2^( 3) =       0.000415943882
  error estimate for blocks of size 2^( 4) =       0.000422305607
  error estimate for blocks of size 2^( 5) =       0.000427863933
  error estimate for blocks of size 2^( 6) =       0.000428520696
  error estimate for blocks of size 2^( 7) =       0.000430688910

      target function =                  N/A
              le_mean =     -17.216584811275
             les_mean =     296.726481938781
             stat err =       0.000427344786
             autocorr =       1.156982081622
              std dev =       0.561862556846
             le_variance =       0.315689532785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315670967882
                                         uncertainty =       0.003345376604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315670967882
                                         uncertainty =       0.003345376604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397296713
  error estimate for blocks of size 2^( 2) =       0.000407330529
  error estimate for blocks of size 2^( 3) =       0.000415943783
  error estimate for blocks of size 2^( 4) =       0.000422305511
  error estimate for blocks of size 2^( 5) =       0.000427863841
  error estimate for blocks of size 2^( 6) =       0.000428520600
  error estimate for blocks of size 2^( 7) =       0.000430688802

      target function =                  N/A
              le_mean =     -17.216584811195
             les_mean =     296.726481759515
             stat err =       0.000427344688
             autocorr =       1.156982197978
              std dev =       0.561862399788
             le_variance =       0.315689356296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315671055975
                                         uncertainty =       0.003345377262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315671055975
                                         uncertainty =       0.003345377262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397296768
  error estimate for blocks of size 2^( 2) =       0.000407330581
  error estimate for blocks of size 2^( 3) =       0.000415943832
  error estimate for blocks of size 2^( 4) =       0.000422305559
  error estimate for blocks of size 2^( 5) =       0.000427863887
  error estimate for blocks of size 2^( 6) =       0.000428520648
  error estimate for blocks of size 2^( 7) =       0.000430688855

      target function =                  N/A
              le_mean =     -17.216584811235
             les_mean =     296.726481849058
             stat err =       0.000427344737
             autocorr =       1.156982139885
              std dev =       0.561862478227
             le_variance =       0.315689444439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315671133230
                                         uncertainty =       0.003345377839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315671133230
                                         uncertainty =       0.003345377839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397296817
  error estimate for blocks of size 2^( 2) =       0.000407330627
  error estimate for blocks of size 2^( 3) =       0.000415943876
  error estimate for blocks of size 2^( 4) =       0.000422305601
  error estimate for blocks of size 2^( 5) =       0.000427863928
  error estimate for blocks of size 2^( 6) =       0.000428520690
  error estimate for blocks of size 2^( 7) =       0.000430688903

      target function =                  N/A
              le_mean =     -17.216584811270
             les_mean =     296.726481927562
             stat err =       0.000427344780
             autocorr =       1.156982088902
              std dev =       0.561862547015
             le_variance =       0.315689521739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216584811275        initial  <--
     2.4414e+02     2.4414e+03             1.1012e-06       -17.216584811195
     9.7656e+02     9.7656e+03             2.7537e-07       -17.216584811235
     3.9062e+03     3.9062e+04             6.8847e-08       -17.216584811270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4577
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.139790e-01 1 1  ON 0
 uu_1                 5.172402e-02 1 1  ON 1
 uu_2                -4.338471e-02 1 1  ON 2
 uu_3                -9.920374e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187561e-01 1 1  ON 6
 uu_7                -4.804474e-02 1 1  ON 7
 uu_8                 9.381781e-02 1 1  ON 8
 uu_9                 1.263584e-01 1 1  ON 9
 ud_0                 3.553788e-01 1 1  ON 10
 ud_1                 9.623704e-02 1 1  ON 11
 ud_2                -1.376924e-02 1 1  ON 12
 ud_3                -7.513514e-02 1 1  ON 13
 ud_4                -1.232145e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571683e-01 1 1  ON 16
 ud_7                -1.129162e-01 1 1  ON 17
 ud_8                -4.420157e-03 1 1  ON 18
 ud_9                 9.260964e-02 1 1  ON 19
 eO_0                -7.825771e-01 1 1  ON 20
 eO_1                -4.611296e-01 1 1  ON 21
 eO_2                -4.945204e-02 1 1  ON 22
 eO_3                 2.109032e-01 1 1  ON 23
 eO_4                 3.113782e-01 1 1  ON 24
 eO_5                 3.256926e-01 1 1  ON 25
 eO_6                 2.615828e-01 1 1  ON 26
 eO_7                 1.236197e-01 1 1  ON 27
 eO_8                 2.976212e-02 1 1  ON 28
 eO_9                 1.902959e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049336e-01 1 1  ON 31
eH1_2                -6.354098e-02 1 1  ON 32
eH1_3                -2.637136e-02 1 1  ON 33
eH1_4                 1.893011e-02 1 1  ON 34
eH1_5                 3.366237e-02 1 1  ON 35
eH1_6                 7.765103e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703255e-02 1 1  ON 38
eH1_9                 2.630927e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490818e-02 1 1  ON 42
eH2_3                -2.789372e-02 1 1  ON 43
eH2_4                 1.766449e-02 1 1  ON 44
eH2_5                 3.177384e-02 1 1  ON 45
eH2_6                 7.964054e-02 1 1  ON 46
eH2_7                 1.142217e-01 1 1  ON 47
eH2_8                 1.002319e-01 1 1  ON 48
eH2_9                 2.858314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8403e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1813
    reference variance = 0.187022
====================================================
  Execution time = 2.0940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2542e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325434141309
                                         uncertainty =       0.004384830725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325434141309
                                         uncertainty =       0.004384830725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403371801
  error estimate for blocks of size 2^( 2) =       0.000412748515
  error estimate for blocks of size 2^( 3) =       0.000421967387
  error estimate for blocks of size 2^( 4) =       0.000429121776
  error estimate for blocks of size 2^( 5) =       0.000433288577
  error estimate for blocks of size 2^( 6) =       0.000436562847
  error estimate for blocks of size 2^( 7) =       0.000438525210

      target function =                  N/A
              le_mean =     -17.216743101825
             les_mean =     296.741660491008
             stat err =       0.000434374602
             autocorr =       1.159625563687
              std dev =       0.570453871469
             le_variance =       0.325417619474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674310183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216743101825       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216743101773       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216743101825       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216743101729       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216743101575       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216743101656       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216743101661       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 8.179995e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216743101825       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216743101812       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216743101825       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216743101801       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216743101765       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216743101775       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216743101820       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.044998e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216743101825       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216743101822       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216743101825       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216743101819       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216743101809       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216743101803       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216743101845       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 5.112495e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058669 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6524e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.139790e-01 1 1  ON 0
 uu_1                 5.172403e-02 1 1  ON 1
 uu_2                -4.338471e-02 1 1  ON 2
 uu_3                -9.920374e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187561e-01 1 1  ON 6
 uu_7                -4.804474e-02 1 1  ON 7
 uu_8                 9.381780e-02 1 1  ON 8
 uu_9                 1.263584e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.623705e-02 1 1  ON 11
 ud_2                -1.376924e-02 1 1  ON 12
 ud_3                -7.513513e-02 1 1  ON 13
 ud_4                -1.232145e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571683e-01 1 1  ON 16
 ud_7                -1.129162e-01 1 1  ON 17
 ud_8                -4.420166e-03 1 1  ON 18
 ud_9                 9.260964e-02 1 1  ON 19
 eO_0                -7.825772e-01 1 1  ON 20
 eO_1                -4.611296e-01 1 1  ON 21
 eO_2                -4.945206e-02 1 1  ON 22
 eO_3                 2.109032e-01 1 1  ON 23
 eO_4                 3.113782e-01 1 1  ON 24
 eO_5                 3.256927e-01 1 1  ON 25
 eO_6                 2.615828e-01 1 1  ON 26
 eO_7                 1.236198e-01 1 1  ON 27
 eO_8                 2.976212e-02 1 1  ON 28
 eO_9                 1.902959e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049336e-01 1 1  ON 31
eH1_2                -6.354098e-02 1 1  ON 32
eH1_3                -2.637136e-02 1 1  ON 33
eH1_4                 1.893011e-02 1 1  ON 34
eH1_5                 3.366237e-02 1 1  ON 35
eH1_6                 7.765104e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703256e-02 1 1  ON 38
eH1_9                 2.630927e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490819e-02 1 1  ON 42
eH2_3                -2.789372e-02 1 1  ON 43
eH2_4                 1.766449e-02 1 1  ON 44
eH2_5                 3.177384e-02 1 1  ON 45
eH2_6                 7.964054e-02 1 1  ON 46
eH2_7                 1.142217e-01 1 1  ON 47
eH2_8                 1.002319e-01 1 1  ON 48
eH2_9                 2.858314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1538
    reference variance = 1.83056
====================================================
  Execution time = 2.0101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1660e-01
  Total weights = 2.0000e+06
  Execution time = 1.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316617980478
                                         uncertainty =       0.003513445345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316617980478
                                         uncertainty =       0.003513445345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867508
  error estimate for blocks of size 2^( 2) =       0.000407201613
  error estimate for blocks of size 2^( 3) =       0.000416093320
  error estimate for blocks of size 2^( 4) =       0.000422878447
  error estimate for blocks of size 2^( 5) =       0.000427918321
  error estimate for blocks of size 2^( 6) =       0.000430951769
  error estimate for blocks of size 2^( 7) =       0.000431357535

      target function =                  N/A
              le_mean =     -17.215967256800
             les_mean =     296.706125536193
             stat err =       0.000428276518
             autocorr =       1.158701526333
              std dev =       0.562669625345
             le_variance =       0.316597107286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316617979221
                                         uncertainty =       0.003513444880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316617979221
                                         uncertainty =       0.003513444880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867507
  error estimate for blocks of size 2^( 2) =       0.000407201612
  error estimate for blocks of size 2^( 3) =       0.000416093319
  error estimate for blocks of size 2^( 4) =       0.000422878446
  error estimate for blocks of size 2^( 5) =       0.000427918320
  error estimate for blocks of size 2^( 6) =       0.000430951767
  error estimate for blocks of size 2^( 7) =       0.000431357532

      target function =                  N/A
              le_mean =     -17.215967256863
             les_mean =     296.706125537101
             stat err =       0.000428276516
             autocorr =       1.158701520981
              std dev =       0.562669624230
             le_variance =       0.316597106031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316617979850
                                         uncertainty =       0.003513445113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316617979850
                                         uncertainty =       0.003513445113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867507
  error estimate for blocks of size 2^( 2) =       0.000407201612
  error estimate for blocks of size 2^( 3) =       0.000416093319
  error estimate for blocks of size 2^( 4) =       0.000422878446
  error estimate for blocks of size 2^( 5) =       0.000427918320
  error estimate for blocks of size 2^( 6) =       0.000430951768
  error estimate for blocks of size 2^( 7) =       0.000431357533

      target function =                  N/A
              le_mean =     -17.215967256831
             les_mean =     296.706125536647
             stat err =       0.000428276517
             autocorr =       1.158701523663
              std dev =       0.562669624788
             le_variance =       0.316597106659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316617980400
                                         uncertainty =       0.003513445316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316617980400
                                         uncertainty =       0.003513445316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867508
  error estimate for blocks of size 2^( 2) =       0.000407201613
  error estimate for blocks of size 2^( 3) =       0.000416093319
  error estimate for blocks of size 2^( 4) =       0.000422878447
  error estimate for blocks of size 2^( 5) =       0.000427918321
  error estimate for blocks of size 2^( 6) =       0.000430951769
  error estimate for blocks of size 2^( 7) =       0.000431357534

      target function =                  N/A
              le_mean =     -17.215967256804
             les_mean =     296.706125536250
             stat err =       0.000428276518
             autocorr =       1.158701526008
              std dev =       0.562669625276
             le_variance =       0.316597107208


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215967256800        initial
     2.4414e+03     2.4414e+04             8.1800e-08       -17.215967256863  <--
     9.7656e+03     9.7656e+04             2.0450e-08       -17.215967256831
     3.9062e+04     3.9062e+05             5.1125e-09       -17.215967256804

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 2.9348e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.139791e-01 1 1  ON 0
 uu_1                 5.172405e-02 1 1  ON 1
 uu_2                -4.338472e-02 1 1  ON 2
 uu_3                -9.920372e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187561e-01 1 1  ON 6
 uu_7                -4.804476e-02 1 1  ON 7
 uu_8                 9.381778e-02 1 1  ON 8
 uu_9                 1.263584e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.623706e-02 1 1  ON 11
 ud_2                -1.376924e-02 1 1  ON 12
 ud_3                -7.513512e-02 1 1  ON 13
 ud_4                -1.232145e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571683e-01 1 1  ON 16
 ud_7                -1.129162e-01 1 1  ON 17
 ud_8                -4.420192e-03 1 1  ON 18
 ud_9                 9.260964e-02 1 1  ON 19
 eO_0                -7.825772e-01 1 1  ON 20
 eO_1                -4.611297e-01 1 1  ON 21
 eO_2                -4.945212e-02 1 1  ON 22
 eO_3                 2.109032e-01 1 1  ON 23
 eO_4                 3.113783e-01 1 1  ON 24
 eO_5                 3.256927e-01 1 1  ON 25
 eO_6                 2.615828e-01 1 1  ON 26
 eO_7                 1.236198e-01 1 1  ON 27
 eO_8                 2.976213e-02 1 1  ON 28
 eO_9                 1.902959e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049336e-01 1 1  ON 31
eH1_2                -6.354099e-02 1 1  ON 32
eH1_3                -2.637138e-02 1 1  ON 33
eH1_4                 1.893011e-02 1 1  ON 34
eH1_5                 3.366235e-02 1 1  ON 35
eH1_6                 7.765104e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703258e-02 1 1  ON 38
eH1_9                 2.630928e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490821e-02 1 1  ON 42
eH2_3                -2.789371e-02 1 1  ON 43
eH2_4                 1.766449e-02 1 1  ON 44
eH2_5                 3.177384e-02 1 1  ON 45
eH2_6                 7.964054e-02 1 1  ON 46
eH2_7                 1.142217e-01 1 1  ON 47
eH2_8                 1.002320e-01 1 1  ON 48
eH2_9                 2.858315e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2501
    reference variance = 0.228838
====================================================
  Execution time = 2.0008e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1570e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315754754651
                                         uncertainty =       0.004192578814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315754754651
                                         uncertainty =       0.004192578814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397302591
  error estimate for blocks of size 2^( 2) =       0.000406754659
  error estimate for blocks of size 2^( 3) =       0.000415538304
  error estimate for blocks of size 2^( 4) =       0.000422285666
  error estimate for blocks of size 2^( 5) =       0.000428217840
  error estimate for blocks of size 2^( 6) =       0.000430196073
  error estimate for blocks of size 2^( 7) =       0.000431211819

      target function =                  N/A
              le_mean =     -17.215873492740
             les_mean =     296.701998658198
             stat err =       0.000427977850
             autocorr =       1.160378811413
              std dev =       0.561870712912
             le_variance =       0.315698698028


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721587349274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215873492740       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215873491962       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215873490345       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215873488656       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215873489642       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215873489513       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215873489702       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.690697e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215873492740       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215873492545       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215873492141       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215873491719       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215873491965       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215873491932       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215873491980       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.172889e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215873492740       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215873492691       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215873492590       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215873492486       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215873492546       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215873492537       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215873492548       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.932356e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5567e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.139791e-01 1 1  ON 0
 uu_1                 5.172412e-02 1 1  ON 1
 uu_2                -4.338478e-02 1 1  ON 2
 uu_3                -9.920374e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187561e-01 1 1  ON 6
 uu_7                -4.804480e-02 1 1  ON 7
 uu_8                 9.381775e-02 1 1  ON 8
 uu_9                 1.263584e-01 1 1  ON 9
 ud_0                 3.553788e-01 1 1  ON 10
 ud_1                 9.623710e-02 1 1  ON 11
 ud_2                -1.376926e-02 1 1  ON 12
 ud_3                -7.513512e-02 1 1  ON 13
 ud_4                -1.232145e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571683e-01 1 1  ON 16
 ud_7                -1.129162e-01 1 1  ON 17
 ud_8                -4.420216e-03 1 1  ON 18
 ud_9                 9.260964e-02 1 1  ON 19
 eO_0                -7.825773e-01 1 1  ON 20
 eO_1                -4.611298e-01 1 1  ON 21
 eO_2                -4.945209e-02 1 1  ON 22
 eO_3                 2.109031e-01 1 1  ON 23
 eO_4                 3.113783e-01 1 1  ON 24
 eO_5                 3.256928e-01 1 1  ON 25
 eO_6                 2.615829e-01 1 1  ON 26
 eO_7                 1.236199e-01 1 1  ON 27
 eO_8                 2.976214e-02 1 1  ON 28
 eO_9                 1.902960e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049336e-01 1 1  ON 31
eH1_2                -6.354100e-02 1 1  ON 32
eH1_3                -2.637139e-02 1 1  ON 33
eH1_4                 1.893010e-02 1 1  ON 34
eH1_5                 3.366231e-02 1 1  ON 35
eH1_6                 7.765106e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703261e-02 1 1  ON 38
eH1_9                 2.630929e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490823e-02 1 1  ON 42
eH2_3                -2.789371e-02 1 1  ON 43
eH2_4                 1.766446e-02 1 1  ON 44
eH2_5                 3.177387e-02 1 1  ON 45
eH2_6                 7.964053e-02 1 1  ON 46
eH2_7                 1.142217e-01 1 1  ON 47
eH2_8                 1.002320e-01 1 1  ON 48
eH2_9                 2.858316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2874
    reference variance = 0.323559
====================================================
  Execution time = 2.2153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1559e-01
  Total weights = 2.0000e+06
  Execution time = 1.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315689556068
                                         uncertainty =       0.003649955849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315689556068
                                         uncertainty =       0.003649955849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397236074
  error estimate for blocks of size 2^( 2) =       0.000406758910
  error estimate for blocks of size 2^( 3) =       0.000416009701
  error estimate for blocks of size 2^( 4) =       0.000422221425
  error estimate for blocks of size 2^( 5) =       0.000426410661
  error estimate for blocks of size 2^( 6) =       0.000429727175
  error estimate for blocks of size 2^( 7) =       0.000429563598

      target function =                  N/A
              le_mean =     -17.216701117334
             les_mean =     296.730390202170
             stat err =       0.000426980715
             autocorr =       1.155364869758
              std dev =       0.561776642762
             le_variance =       0.315592996353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315689856563
                                         uncertainty =       0.003649959699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315689856563
                                         uncertainty =       0.003649959699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397236263
  error estimate for blocks of size 2^( 2) =       0.000406759091
  error estimate for blocks of size 2^( 3) =       0.000416009876
  error estimate for blocks of size 2^( 4) =       0.000422221594
  error estimate for blocks of size 2^( 5) =       0.000426410824
  error estimate for blocks of size 2^( 6) =       0.000429727334
  error estimate for blocks of size 2^( 7) =       0.000429563745

      target function =                  N/A
              le_mean =     -17.216701118611
             les_mean =     296.730390546431
             stat err =       0.000426980874
             autocorr =       1.155364634949
              std dev =       0.561776910030
             le_variance =       0.315593296643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315689706370
                                         uncertainty =       0.003649957775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315689706370
                                         uncertainty =       0.003649957775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397236168
  error estimate for blocks of size 2^( 2) =       0.000406759000
  error estimate for blocks of size 2^( 3) =       0.000416009789
  error estimate for blocks of size 2^( 4) =       0.000422221510
  error estimate for blocks of size 2^( 5) =       0.000426410742
  error estimate for blocks of size 2^( 6) =       0.000429727254
  error estimate for blocks of size 2^( 7) =       0.000429563672

      target function =                  N/A
              le_mean =     -17.216701117972
             les_mean =     296.730390374350
             stat err =       0.000426980794
             autocorr =       1.155364752317
              std dev =       0.561776776444
             le_variance =       0.315593146552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315689574857
                                         uncertainty =       0.003649956090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315689574857
                                         uncertainty =       0.003649956090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397236085
  error estimate for blocks of size 2^( 2) =       0.000406758921
  error estimate for blocks of size 2^( 3) =       0.000416009712
  error estimate for blocks of size 2^( 4) =       0.000422221436
  error estimate for blocks of size 2^( 5) =       0.000426410671
  error estimate for blocks of size 2^( 6) =       0.000429727185
  error estimate for blocks of size 2^( 7) =       0.000429563607

      target function =                  N/A
              le_mean =     -17.216701117414
             les_mean =     296.730390223693
             stat err =       0.000426980724
             autocorr =       1.155364855077
              std dev =       0.561776659473
             le_variance =       0.315593015129


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216701117334        initial
     6.1035e+02     6.1035e+03             4.6907e-07       -17.216701118611  <--
     2.4414e+03     2.4414e+04             1.1729e-07       -17.216701117972
     9.7656e+03     9.7656e+04             2.9324e-08       -17.216701117414

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 3.1420e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.139793e-01 1 1  ON 0
 uu_1                 5.172432e-02 1 1  ON 1
 uu_2                -4.338497e-02 1 1  ON 2
 uu_3                -9.920380e-02 1 1  ON 3
 uu_4                -1.338092e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187562e-01 1 1  ON 6
 uu_7                -4.804493e-02 1 1  ON 7
 uu_8                 9.381765e-02 1 1  ON 8
 uu_9                 1.263585e-01 1 1  ON 9
 ud_0                 3.553789e-01 1 1  ON 10
 ud_1                 9.623719e-02 1 1  ON 11
 ud_2                -1.376931e-02 1 1  ON 12
 ud_3                -7.513511e-02 1 1  ON 13
 ud_4                -1.232146e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571684e-01 1 1  ON 16
 ud_7                -1.129162e-01 1 1  ON 17
 ud_8                -4.420289e-03 1 1  ON 18
 ud_9                 9.260966e-02 1 1  ON 19
 eO_0                -7.825777e-01 1 1  ON 20
 eO_1                -4.611302e-01 1 1  ON 21
 eO_2                -4.945201e-02 1 1  ON 22
 eO_3                 2.109031e-01 1 1  ON 23
 eO_4                 3.113784e-01 1 1  ON 24
 eO_5                 3.256931e-01 1 1  ON 25
 eO_6                 2.615830e-01 1 1  ON 26
 eO_7                 1.236200e-01 1 1  ON 27
 eO_8                 2.976218e-02 1 1  ON 28
 eO_9                 1.902961e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049337e-01 1 1  ON 31
eH1_2                -6.354101e-02 1 1  ON 32
eH1_3                -2.637141e-02 1 1  ON 33
eH1_4                 1.893004e-02 1 1  ON 34
eH1_5                 3.366220e-02 1 1  ON 35
eH1_6                 7.765112e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703270e-02 1 1  ON 38
eH1_9                 2.630932e-02 1 1  ON 39
eH2_0                -1.857745e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490829e-02 1 1  ON 42
eH2_3                -2.789368e-02 1 1  ON 43
eH2_4                 1.766440e-02 1 1  ON 44
eH2_5                 3.177395e-02 1 1  ON 45
eH2_6                 7.964049e-02 1 1  ON 46
eH2_7                 1.142216e-01 1 1  ON 47
eH2_8                 1.002321e-01 1 1  ON 48
eH2_9                 2.858319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7000e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.3311
    reference variance = 0.246035
====================================================
  Execution time = 2.0594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1765e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317635187693
                                         uncertainty =       0.005322819882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317635187693
                                         uncertainty =       0.005322819882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398525631
  error estimate for blocks of size 2^( 2) =       0.000408488659
  error estimate for blocks of size 2^( 3) =       0.000417650995
  error estimate for blocks of size 2^( 4) =       0.000424005133
  error estimate for blocks of size 2^( 5) =       0.000427904570
  error estimate for blocks of size 2^( 6) =       0.000428978757
  error estimate for blocks of size 2^( 7) =       0.000432632892

      target function =                  N/A
              le_mean =     -17.216766732824
             les_mean =     296.734701931143
             stat err =       0.000428380338
             autocorr =       1.155437720825
              std dev =       0.563600352648
             le_variance =       0.317645357505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676673282e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216766732824       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216766736315       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216766735548       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216766736785       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216766738317       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216766738206       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216766738793       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.488218e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216766732824       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216766733697       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216766733506       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216766733815       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216766734198       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216766734171       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216766734317       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.723757e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216766732824       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216766733042       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216766732994       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216766733072       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216766733167       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216766733162       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216766733198       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 9.311405e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6224e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.139797e-01 1 1  ON 0
 uu_1                 5.172440e-02 1 1  ON 1
 uu_2                -4.338516e-02 1 1  ON 2
 uu_3                -9.920376e-02 1 1  ON 3
 uu_4                -1.338092e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187564e-01 1 1  ON 6
 uu_7                -4.804509e-02 1 1  ON 7
 uu_8                 9.381754e-02 1 1  ON 8
 uu_9                 1.263586e-01 1 1  ON 9
 ud_0                 3.553789e-01 1 1  ON 10
 ud_1                 9.623751e-02 1 1  ON 11
 ud_2                -1.376940e-02 1 1  ON 12
 ud_3                -7.513509e-02 1 1  ON 13
 ud_4                -1.232147e-01 1 1  ON 14
 ud_5                -1.554140e-01 1 1  ON 15
 ud_6                -1.571684e-01 1 1  ON 16
 ud_7                -1.129163e-01 1 1  ON 17
 ud_8                -4.420411e-03 1 1  ON 18
 ud_9                 9.260970e-02 1 1  ON 19
 eO_0                -7.825780e-01 1 1  ON 20
 eO_1                -4.611305e-01 1 1  ON 21
 eO_2                -4.945220e-02 1 1  ON 22
 eO_3                 2.109031e-01 1 1  ON 23
 eO_4                 3.113784e-01 1 1  ON 24
 eO_5                 3.256933e-01 1 1  ON 25
 eO_6                 2.615832e-01 1 1  ON 26
 eO_7                 1.236202e-01 1 1  ON 27
 eO_8                 2.976222e-02 1 1  ON 28
 eO_9                 1.902963e-02 1 1  ON 29
eH1_0                -1.843994e-01 1 1  ON 30
eH1_1                -1.049336e-01 1 1  ON 31
eH1_2                -6.354119e-02 1 1  ON 32
eH1_3                -2.637140e-02 1 1  ON 33
eH1_4                 1.893025e-02 1 1  ON 34
eH1_5                 3.366207e-02 1 1  ON 35
eH1_6                 7.765111e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703280e-02 1 1  ON 38
eH1_9                 2.630936e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490824e-02 1 1  ON 42
eH2_3                -2.789375e-02 1 1  ON 43
eH2_4                 1.766428e-02 1 1  ON 44
eH2_5                 3.177391e-02 1 1  ON 45
eH2_6                 7.964050e-02 1 1  ON 46
eH2_7                 1.142216e-01 1 1  ON 47
eH2_8                 1.002322e-01 1 1  ON 48
eH2_9                 2.858323e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2734
    reference variance = 0.178109
====================================================
  Execution time = 2.0106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2782e-01
  Total weights = 2.0000e+06
  Execution time = 1.8330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327878803400
                                         uncertainty =       0.005127127348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327878803400
                                         uncertainty =       0.005127127348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404855668
  error estimate for blocks of size 2^( 2) =       0.000414317102
  error estimate for blocks of size 2^( 3) =       0.000423047826
  error estimate for blocks of size 2^( 4) =       0.000429691655
  error estimate for blocks of size 2^( 5) =       0.000434231616
  error estimate for blocks of size 2^( 6) =       0.000436391254
  error estimate for blocks of size 2^( 7) =       0.000438308833

      target function =                  N/A
              le_mean =     -17.216240050650
             les_mean =     296.726737541895
             stat err =       0.000434655840
             autocorr =       1.152631778860
              std dev =       0.572552376814
             le_variance =       0.327816224196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327879289413
                                         uncertainty =       0.005127110307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327879289413
                                         uncertainty =       0.005127110307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404855968
  error estimate for blocks of size 2^( 2) =       0.000414317379
  error estimate for blocks of size 2^( 3) =       0.000423048081
  error estimate for blocks of size 2^( 4) =       0.000429691900
  error estimate for blocks of size 2^( 5) =       0.000434231834
  error estimate for blocks of size 2^( 6) =       0.000436391480
  error estimate for blocks of size 2^( 7) =       0.000438309085

      target function =                  N/A
              le_mean =     -17.216240043257
             les_mean =     296.726737773026
             stat err =       0.000434656075
             autocorr =       1.152631318527
              std dev =       0.572552800972
             le_variance =       0.327816709900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327879046252
                                         uncertainty =       0.005127118810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327879046252
                                         uncertainty =       0.005127118810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404855818
  error estimate for blocks of size 2^( 2) =       0.000414317240
  error estimate for blocks of size 2^( 3) =       0.000423047954
  error estimate for blocks of size 2^( 4) =       0.000429691777
  error estimate for blocks of size 2^( 5) =       0.000434231725
  error estimate for blocks of size 2^( 6) =       0.000436391367
  error estimate for blocks of size 2^( 7) =       0.000438308959

      target function =                  N/A
              le_mean =     -17.216240046938
             les_mean =     296.726737656768
             stat err =       0.000434655957
             autocorr =       1.152631548541
              std dev =       0.572552588758
             le_variance =       0.327816466894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327878833749
                                         uncertainty =       0.005127126281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327878833749
                                         uncertainty =       0.005127126281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404855687
  error estimate for blocks of size 2^( 2) =       0.000414317119
  error estimate for blocks of size 2^( 3) =       0.000423047842
  error estimate for blocks of size 2^( 4) =       0.000429691670
  error estimate for blocks of size 2^( 5) =       0.000434231630
  error estimate for blocks of size 2^( 6) =       0.000436391268
  error estimate for blocks of size 2^( 7) =       0.000438308849

      target function =                  N/A
              le_mean =     -17.216240050185
             les_mean =     296.726737556221
             stat err =       0.000434655854
             autocorr =       1.152631750055
              std dev =       0.572552403301
             le_variance =       0.327816254526


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216240050650        initial  <--
     1.5259e+02     1.5259e+03             1.4882e-06       -17.216240043257
     6.1035e+02     6.1035e+03             3.7238e-07       -17.216240046938
     2.4414e+03     2.4414e+04             9.3114e-08       -17.216240050185

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3355
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.139793e-01 1 1  ON 0
 uu_1                 5.172432e-02 1 1  ON 1
 uu_2                -4.338497e-02 1 1  ON 2
 uu_3                -9.920380e-02 1 1  ON 3
 uu_4                -1.338092e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187562e-01 1 1  ON 6
 uu_7                -4.804493e-02 1 1  ON 7
 uu_8                 9.381765e-02 1 1  ON 8
 uu_9                 1.263585e-01 1 1  ON 9
 ud_0                 3.553789e-01 1 1  ON 10
 ud_1                 9.623719e-02 1 1  ON 11
 ud_2                -1.376931e-02 1 1  ON 12
 ud_3                -7.513511e-02 1 1  ON 13
 ud_4                -1.232146e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571684e-01 1 1  ON 16
 ud_7                -1.129162e-01 1 1  ON 17
 ud_8                -4.420289e-03 1 1  ON 18
 ud_9                 9.260966e-02 1 1  ON 19
 eO_0                -7.825777e-01 1 1  ON 20
 eO_1                -4.611302e-01 1 1  ON 21
 eO_2                -4.945201e-02 1 1  ON 22
 eO_3                 2.109031e-01 1 1  ON 23
 eO_4                 3.113784e-01 1 1  ON 24
 eO_5                 3.256931e-01 1 1  ON 25
 eO_6                 2.615830e-01 1 1  ON 26
 eO_7                 1.236200e-01 1 1  ON 27
 eO_8                 2.976218e-02 1 1  ON 28
 eO_9                 1.902961e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049337e-01 1 1  ON 31
eH1_2                -6.354101e-02 1 1  ON 32
eH1_3                -2.637141e-02 1 1  ON 33
eH1_4                 1.893004e-02 1 1  ON 34
eH1_5                 3.366220e-02 1 1  ON 35
eH1_6                 7.765112e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703270e-02 1 1  ON 38
eH1_9                 2.630932e-02 1 1  ON 39
eH2_0                -1.857745e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490829e-02 1 1  ON 42
eH2_3                -2.789368e-02 1 1  ON 43
eH2_4                 1.766440e-02 1 1  ON 44
eH2_5                 3.177395e-02 1 1  ON 45
eH2_6                 7.964049e-02 1 1  ON 46
eH2_7                 1.142216e-01 1 1  ON 47
eH2_8                 1.002321e-01 1 1  ON 48
eH2_9                 2.858319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5565e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.263
    reference variance = 0.202447
====================================================
  Execution time = 2.0324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322381218543
                                         uncertainty =       0.006350726670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322381218543
                                         uncertainty =       0.006350726670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401481804
  error estimate for blocks of size 2^( 2) =       0.000411033661
  error estimate for blocks of size 2^( 3) =       0.000419838654
  error estimate for blocks of size 2^( 4) =       0.000425935176
  error estimate for blocks of size 2^( 5) =       0.000429949951
  error estimate for blocks of size 2^( 6) =       0.000431376028
  error estimate for blocks of size 2^( 7) =       0.000430275416

      target function =                  N/A
              le_mean =     -17.216977607287
             les_mean =     296.746693046434
             stat err =       0.000429384143
             autocorr =       1.143826804892
              std dev =       0.567781012189
             le_variance =       0.322375277802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697760729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216977607287       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216977607260       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216977608612       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216977608805       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216977608898       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216977608995       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216977608894       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.376343e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216977607287       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216977607280       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216977607618       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216977607667       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216977607690       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216977607714       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216977607686       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 5.941492e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216977607287       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216977607285       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216977607370       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216977607379       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216977607388       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216977607409       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216977607395       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.485413e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5896e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.139793e-01 1 1  ON 0
 uu_1                 5.172433e-02 1 1  ON 1
 uu_2                -4.338496e-02 1 1  ON 2
 uu_3                -9.920380e-02 1 1  ON 3
 uu_4                -1.338092e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187562e-01 1 1  ON 6
 uu_7                -4.804494e-02 1 1  ON 7
 uu_8                 9.381764e-02 1 1  ON 8
 uu_9                 1.263585e-01 1 1  ON 9
 ud_0                 3.553788e-01 1 1  ON 10
 ud_1                 9.623722e-02 1 1  ON 11
 ud_2                -1.376931e-02 1 1  ON 12
 ud_3                -7.513509e-02 1 1  ON 13
 ud_4                -1.232146e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571684e-01 1 1  ON 16
 ud_7                -1.129163e-01 1 1  ON 17
 ud_8                -4.420310e-03 1 1  ON 18
 ud_9                 9.260966e-02 1 1  ON 19
 eO_0                -7.825777e-01 1 1  ON 20
 eO_1                -4.611302e-01 1 1  ON 21
 eO_2                -4.945204e-02 1 1  ON 22
 eO_3                 2.109031e-01 1 1  ON 23
 eO_4                 3.113784e-01 1 1  ON 24
 eO_5                 3.256931e-01 1 1  ON 25
 eO_6                 2.615830e-01 1 1  ON 26
 eO_7                 1.236200e-01 1 1  ON 27
 eO_8                 2.976218e-02 1 1  ON 28
 eO_9                 1.902961e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049337e-01 1 1  ON 31
eH1_2                -6.354101e-02 1 1  ON 32
eH1_3                -2.637141e-02 1 1  ON 33
eH1_4                 1.893004e-02 1 1  ON 34
eH1_5                 3.366219e-02 1 1  ON 35
eH1_6                 7.765112e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703271e-02 1 1  ON 38
eH1_9                 2.630933e-02 1 1  ON 39
eH2_0                -1.857745e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490831e-02 1 1  ON 42
eH2_3                -2.789368e-02 1 1  ON 43
eH2_4                 1.766441e-02 1 1  ON 44
eH2_5                 3.177395e-02 1 1  ON 45
eH2_6                 7.964048e-02 1 1  ON 46
eH2_7                 1.142216e-01 1 1  ON 47
eH2_8                 1.002321e-01 1 1  ON 48
eH2_9                 2.858320e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.245
    reference variance = 0.19658
====================================================
  Execution time = 2.0022e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1495e-01
  Total weights = 2.0000e+06
  Execution time = 1.8327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884926285
                                         uncertainty =       0.002472295185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884926285
                                         uncertainty =       0.002472295185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396829122
  error estimate for blocks of size 2^( 2) =       0.000406589539
  error estimate for blocks of size 2^( 3) =       0.000415083284
  error estimate for blocks of size 2^( 4) =       0.000421428366
  error estimate for blocks of size 2^( 5) =       0.000425431803
  error estimate for blocks of size 2^( 6) =       0.000429194376
  error estimate for blocks of size 2^( 7) =       0.000429463633

      target function =                  N/A
              le_mean =     -17.216190491011
             les_mean =     296.712161568700
             stat err =       0.000426379545
             autocorr =       1.154477973646
              std dev =       0.561201125620
             le_variance =       0.314946703397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884784760
                                         uncertainty =       0.002472293748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884784760
                                         uncertainty =       0.002472293748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396829032
  error estimate for blocks of size 2^( 2) =       0.000406589454
  error estimate for blocks of size 2^( 3) =       0.000415083202
  error estimate for blocks of size 2^( 4) =       0.000421428285
  error estimate for blocks of size 2^( 5) =       0.000425431721
  error estimate for blocks of size 2^( 6) =       0.000429194296
  error estimate for blocks of size 2^( 7) =       0.000429463550

      target function =                  N/A
              le_mean =     -17.216190491566
             les_mean =     296.712161446182
             stat err =       0.000426379463
             autocorr =       1.154478050814
              std dev =       0.561200999424
             le_variance =       0.314946561755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884855501
                                         uncertainty =       0.002472294466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884855501
                                         uncertainty =       0.002472294466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396829077
  error estimate for blocks of size 2^( 2) =       0.000406589496
  error estimate for blocks of size 2^( 3) =       0.000415083243
  error estimate for blocks of size 2^( 4) =       0.000421428325
  error estimate for blocks of size 2^( 5) =       0.000425431762
  error estimate for blocks of size 2^( 6) =       0.000429194336
  error estimate for blocks of size 2^( 7) =       0.000429463591

      target function =                  N/A
              le_mean =     -17.216190491289
             les_mean =     296.712161507421
             stat err =       0.000426379504
             autocorr =       1.154478012241
              std dev =       0.561201062503
             le_variance =       0.314946632555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884917436
                                         uncertainty =       0.002472295095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884917436
                                         uncertainty =       0.002472295095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396829116
  error estimate for blocks of size 2^( 2) =       0.000406589533
  error estimate for blocks of size 2^( 3) =       0.000415083279
  error estimate for blocks of size 2^( 4) =       0.000421428361
  error estimate for blocks of size 2^( 5) =       0.000425431798
  error estimate for blocks of size 2^( 6) =       0.000429194371
  error estimate for blocks of size 2^( 7) =       0.000429463628

      target function =                  N/A
              le_mean =     -17.216190491046
             les_mean =     296.712161561039
             stat err =       0.000426379539
             autocorr =       1.154477978464
              std dev =       0.561201117730
             le_variance =       0.314946694541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216190491011        initial
     1.5259e+03     1.5259e+04             2.3763e-07       -17.216190491566  <--
     6.1035e+03     6.1035e+04             5.9415e-08       -17.216190491289
     2.4414e+04     2.4414e+05             1.4854e-08       -17.216190491046

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 2.9281e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.139793e-01 1 1  ON 0
 uu_1                 5.172438e-02 1 1  ON 1
 uu_2                -4.338496e-02 1 1  ON 2
 uu_3                -9.920379e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187562e-01 1 1  ON 6
 uu_7                -4.804498e-02 1 1  ON 7
 uu_8                 9.381760e-02 1 1  ON 8
 uu_9                 1.263585e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.623732e-02 1 1  ON 11
 ud_2                -1.376930e-02 1 1  ON 12
 ud_3                -7.513504e-02 1 1  ON 13
 ud_4                -1.232146e-01 1 1  ON 14
 ud_5                -1.554137e-01 1 1  ON 15
 ud_6                -1.571684e-01 1 1  ON 16
 ud_7                -1.129163e-01 1 1  ON 17
 ud_8                -4.420374e-03 1 1  ON 18
 ud_9                 9.260966e-02 1 1  ON 19
 eO_0                -7.825779e-01 1 1  ON 20
 eO_1                -4.611302e-01 1 1  ON 21
 eO_2                -4.945211e-02 1 1  ON 22
 eO_3                 2.109030e-01 1 1  ON 23
 eO_4                 3.113784e-01 1 1  ON 24
 eO_5                 3.256932e-01 1 1  ON 25
 eO_6                 2.615831e-01 1 1  ON 26
 eO_7                 1.236201e-01 1 1  ON 27
 eO_8                 2.976219e-02 1 1  ON 28
 eO_9                 1.902961e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049337e-01 1 1  ON 31
eH1_2                -6.354099e-02 1 1  ON 32
eH1_3                -2.637142e-02 1 1  ON 33
eH1_4                 1.893005e-02 1 1  ON 34
eH1_5                 3.366216e-02 1 1  ON 35
eH1_6                 7.765112e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703274e-02 1 1  ON 38
eH1_9                 2.630933e-02 1 1  ON 39
eH2_0                -1.857745e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490838e-02 1 1  ON 42
eH2_3                -2.789368e-02 1 1  ON 43
eH2_4                 1.766444e-02 1 1  ON 44
eH2_5                 3.177396e-02 1 1  ON 45
eH2_6                 7.964045e-02 1 1  ON 46
eH2_7                 1.142216e-01 1 1  ON 47
eH2_8                 1.002321e-01 1 1  ON 48
eH2_9                 2.858320e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5182e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2397
    reference variance = 0.163663
====================================================
  Execution time = 2.0439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1847e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318373643971
                                         uncertainty =       0.002983621522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318373643971
                                         uncertainty =       0.002983621522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399040661
  error estimate for blocks of size 2^( 2) =       0.000408914076
  error estimate for blocks of size 2^( 3) =       0.000416744965
  error estimate for blocks of size 2^( 4) =       0.000423336648
  error estimate for blocks of size 2^( 5) =       0.000427933989
  error estimate for blocks of size 2^( 6) =       0.000430878077
  error estimate for blocks of size 2^( 7) =       0.000434448158

      target function =                  N/A
              le_mean =     -17.216661259663
             les_mean =     296.731891668589
             stat err =       0.000429149218
             autocorr =       1.156597765857
              std dev =       0.564328714337
             le_variance =       0.318466897825


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666125966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216661259663       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661259813       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216661258470       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216661258591       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216661259203       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216661258823       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216661258820       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 6.269339e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216661259663       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661259701       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216661259365       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216661259395       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216661259548       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216661259452       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216661259456       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.567533e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216661259663       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661259673       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216661259589       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216661259596       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216661259635       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216661259611       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216661259613       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.918958e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6157e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.139794e-01 1 1  ON 0
 uu_1                 5.172439e-02 1 1  ON 1
 uu_2                -4.338495e-02 1 1  ON 2
 uu_3                -9.920378e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417114e-01 1 1  ON 5
 uu_6                -1.187563e-01 1 1  ON 6
 uu_7                -4.804506e-02 1 1  ON 7
 uu_8                 9.381756e-02 1 1  ON 8
 uu_9                 1.263586e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.623739e-02 1 1  ON 11
 ud_2                -1.376930e-02 1 1  ON 12
 ud_3                -7.513496e-02 1 1  ON 13
 ud_4                -1.232146e-01 1 1  ON 14
 ud_5                -1.554138e-01 1 1  ON 15
 ud_6                -1.571685e-01 1 1  ON 16
 ud_7                -1.129163e-01 1 1  ON 17
 ud_8                -4.420429e-03 1 1  ON 18
 ud_9                 9.260967e-02 1 1  ON 19
 eO_0                -7.825781e-01 1 1  ON 20
 eO_1                -4.611303e-01 1 1  ON 21
 eO_2                -4.945222e-02 1 1  ON 22
 eO_3                 2.109030e-01 1 1  ON 23
 eO_4                 3.113785e-01 1 1  ON 24
 eO_5                 3.256933e-01 1 1  ON 25
 eO_6                 2.615832e-01 1 1  ON 26
 eO_7                 1.236202e-01 1 1  ON 27
 eO_8                 2.976221e-02 1 1  ON 28
 eO_9                 1.902962e-02 1 1  ON 29
eH1_0                -1.843993e-01 1 1  ON 30
eH1_1                -1.049337e-01 1 1  ON 31
eH1_2                -6.354097e-02 1 1  ON 32
eH1_3                -2.637145e-02 1 1  ON 33
eH1_4                 1.893007e-02 1 1  ON 34
eH1_5                 3.366213e-02 1 1  ON 35
eH1_6                 7.765108e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703279e-02 1 1  ON 38
eH1_9                 2.630935e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490836e-02 1 1  ON 42
eH2_3                -2.789362e-02 1 1  ON 43
eH2_4                 1.766449e-02 1 1  ON 44
eH2_5                 3.177389e-02 1 1  ON 45
eH2_6                 7.964041e-02 1 1  ON 46
eH2_7                 1.142216e-01 1 1  ON 47
eH2_8                 1.002322e-01 1 1  ON 48
eH2_9                 2.858322e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.299975
====================================================
  Execution time = 2.2149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2780e-01
  Total weights = 2.0000e+06
  Execution time = 1.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327846438930
                                         uncertainty =       0.008700057041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327846438930
                                         uncertainty =       0.008700057041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404844286
  error estimate for blocks of size 2^( 2) =       0.000414389603
  error estimate for blocks of size 2^( 3) =       0.000422920972
  error estimate for blocks of size 2^( 4) =       0.000429199099
  error estimate for blocks of size 2^( 5) =       0.000433140958
  error estimate for blocks of size 2^( 6) =       0.000436517517
  error estimate for blocks of size 2^( 7) =       0.000438964275

      target function =                  N/A
              le_mean =     -17.216388310112
             les_mean =     296.731824071709
             stat err =       0.000434455462
             autocorr =       1.151634048372
              std dev =       0.572536279227
             le_variance =       0.327797791031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327846383705
                                         uncertainty =       0.008700057545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327846383705
                                         uncertainty =       0.008700057545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404844251
  error estimate for blocks of size 2^( 2) =       0.000414389568
  error estimate for blocks of size 2^( 3) =       0.000422920936
  error estimate for blocks of size 2^( 4) =       0.000429199062
  error estimate for blocks of size 2^( 5) =       0.000433140923
  error estimate for blocks of size 2^( 6) =       0.000436517484
  error estimate for blocks of size 2^( 7) =       0.000438964237

      target function =                  N/A
              le_mean =     -17.216388310224
             les_mean =     296.731824020313
             stat err =       0.000434455426
             autocorr =       1.151634053115
              std dev =       0.572536230986
             le_variance =       0.327797735792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327846411267
                                         uncertainty =       0.008700057292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327846411267
                                         uncertainty =       0.008700057292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404844268
  error estimate for blocks of size 2^( 2) =       0.000414389585
  error estimate for blocks of size 2^( 3) =       0.000422920954
  error estimate for blocks of size 2^( 4) =       0.000429199080
  error estimate for blocks of size 2^( 5) =       0.000433140940
  error estimate for blocks of size 2^( 6) =       0.000436517500
  error estimate for blocks of size 2^( 7) =       0.000438964256

      target function =                  N/A
              le_mean =     -17.216388310168
             les_mean =     296.731824045939
             stat err =       0.000434455444
             autocorr =       1.151634050758
              std dev =       0.572536255062
             le_variance =       0.327797763361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327846435470
                                         uncertainty =       0.008700057073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327846435470
                                         uncertainty =       0.008700057073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404844283
  error estimate for blocks of size 2^( 2) =       0.000414389601
  error estimate for blocks of size 2^( 3) =       0.000422920969
  error estimate for blocks of size 2^( 4) =       0.000429199096
  error estimate for blocks of size 2^( 5) =       0.000433140956
  error estimate for blocks of size 2^( 6) =       0.000436517515
  error estimate for blocks of size 2^( 7) =       0.000438964273

      target function =                  N/A
              le_mean =     -17.216388310119
             les_mean =     296.731824068485
             stat err =       0.000434455460
             autocorr =       1.151634048661
              std dev =       0.572536276205
             le_variance =       0.327797787571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216388310112        initial
     3.8147e+02     3.8147e+03             6.2693e-07       -17.216388310224  <--
     1.5259e+03     1.5259e+04             1.5675e-07       -17.216388310168
     6.1035e+03     6.1035e+04             3.9190e-08       -17.216388310119

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 3.1358e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.139794e-01 1 1  ON 0
 uu_1                 5.172443e-02 1 1  ON 1
 uu_2                -4.338492e-02 1 1  ON 2
 uu_3                -9.920376e-02 1 1  ON 3
 uu_4                -1.338091e-01 1 1  ON 4
 uu_5                -1.417113e-01 1 1  ON 5
 uu_6                -1.187565e-01 1 1  ON 6
 uu_7                -4.804532e-02 1 1  ON 7
 uu_8                 9.381742e-02 1 1  ON 8
 uu_9                 1.263587e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.623763e-02 1 1  ON 11
 ud_2                -1.376930e-02 1 1  ON 12
 ud_3                -7.513474e-02 1 1  ON 13
 ud_4                -1.232146e-01 1 1  ON 14
 ud_5                -1.554140e-01 1 1  ON 15
 ud_6                -1.571688e-01 1 1  ON 16
 ud_7                -1.129164e-01 1 1  ON 17
 ud_8                -4.420595e-03 1 1  ON 18
 ud_9                 9.260970e-02 1 1  ON 19
 eO_0                -7.825785e-01 1 1  ON 20
 eO_1                -4.611307e-01 1 1  ON 21
 eO_2                -4.945253e-02 1 1  ON 22
 eO_3                 2.109030e-01 1 1  ON 23
 eO_4                 3.113789e-01 1 1  ON 24
 eO_5                 3.256936e-01 1 1  ON 25
 eO_6                 2.615834e-01 1 1  ON 26
 eO_7                 1.236204e-01 1 1  ON 27
 eO_8                 2.976227e-02 1 1  ON 28
 eO_9                 1.902965e-02 1 1  ON 29
eH1_0                -1.843994e-01 1 1  ON 30
eH1_1                -1.049336e-01 1 1  ON 31
eH1_2                -6.354091e-02 1 1  ON 32
eH1_3                -2.637156e-02 1 1  ON 33
eH1_4                 1.893014e-02 1 1  ON 34
eH1_5                 3.366205e-02 1 1  ON 35
eH1_6                 7.765098e-02 1 1  ON 36
eH1_7                 1.097049e-01 1 1  ON 37
eH1_8                 9.703295e-02 1 1  ON 38
eH1_9                 2.630941e-02 1 1  ON 39
eH2_0                -1.857747e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490829e-02 1 1  ON 42
eH2_3                -2.789344e-02 1 1  ON 43
eH2_4                 1.766464e-02 1 1  ON 44
eH2_5                 3.177366e-02 1 1  ON 45
eH2_6                 7.964028e-02 1 1  ON 46
eH2_7                 1.142216e-01 1 1  ON 47
eH2_8                 1.002323e-01 1 1  ON 48
eH2_9                 2.858326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7520e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2108
    reference variance = 0.180949
====================================================
  Execution time = 2.0487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1930e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143285453
                                         uncertainty =       0.005649472366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143285453
                                         uncertainty =       0.005649472366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399561365
  error estimate for blocks of size 2^( 2) =       0.000409031601
  error estimate for blocks of size 2^( 3) =       0.000417872042
  error estimate for blocks of size 2^( 4) =       0.000424306935
  error estimate for blocks of size 2^( 5) =       0.000428015271
  error estimate for blocks of size 2^( 6) =       0.000428629804
  error estimate for blocks of size 2^( 7) =       0.000431532046

      target function =                  N/A
              le_mean =     -17.216825511584
             les_mean =     296.738379104879
             stat err =       0.000428121014
             autocorr =       1.148064042812
              std dev =       0.565065100855
             le_variance =       0.319298568204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682551158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216825511584       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216825508027       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216825513276       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216825519077       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216825521646       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216825520771       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216825520392       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.915202e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216825511584       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216825510693       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216825512006       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216825513459       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216825514100       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216825513882       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216825513787       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 7.294179e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216825511584       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216825511361       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216825511689       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216825512053       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216825512213       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216825512159       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216825512134       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.823932e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6216e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.139792e-01 1 1  ON 0
 uu_1                 5.172461e-02 1 1  ON 1
 uu_2                -4.338488e-02 1 1  ON 2
 uu_3                -9.920365e-02 1 1  ON 3
 uu_4                -1.338090e-01 1 1  ON 4
 uu_5                -1.417111e-01 1 1  ON 5
 uu_6                -1.187565e-01 1 1  ON 6
 uu_7                -4.804570e-02 1 1  ON 7
 uu_8                 9.381711e-02 1 1  ON 8
 uu_9                 1.263588e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.623801e-02 1 1  ON 11
 ud_2                -1.376925e-02 1 1  ON 12
 ud_3                -7.513449e-02 1 1  ON 13
 ud_4                -1.232146e-01 1 1  ON 14
 ud_5                -1.554140e-01 1 1  ON 15
 ud_6                -1.571688e-01 1 1  ON 16
 ud_7                -1.129167e-01 1 1  ON 17
 ud_8                -4.421052e-03 1 1  ON 18
 ud_9                 9.260966e-02 1 1  ON 19
 eO_0                -7.825793e-01 1 1  ON 20
 eO_1                -4.611312e-01 1 1  ON 21
 eO_2                -4.945274e-02 1 1  ON 22
 eO_3                 2.109030e-01 1 1  ON 23
 eO_4                 3.113791e-01 1 1  ON 24
 eO_5                 3.256941e-01 1 1  ON 25
 eO_6                 2.615837e-01 1 1  ON 26
 eO_7                 1.236207e-01 1 1  ON 27
 eO_8                 2.976229e-02 1 1  ON 28
 eO_9                 1.902966e-02 1 1  ON 29
eH1_0                -1.843995e-01 1 1  ON 30
eH1_1                -1.049337e-01 1 1  ON 31
eH1_2                -6.354076e-02 1 1  ON 32
eH1_3                -2.637168e-02 1 1  ON 33
eH1_4                 1.893024e-02 1 1  ON 34
eH1_5                 3.366200e-02 1 1  ON 35
eH1_6                 7.765100e-02 1 1  ON 36
eH1_7                 1.097048e-01 1 1  ON 37
eH1_8                 9.703306e-02 1 1  ON 38
eH1_9                 2.630943e-02 1 1  ON 39
eH2_0                -1.857744e-01 1 1  ON 40
eH2_1                -1.063392e-01 1 1  ON 41
eH2_2                -6.490831e-02 1 1  ON 42
eH2_3                -2.789321e-02 1 1  ON 43
eH2_4                 1.766430e-02 1 1  ON 44
eH2_5                 3.177337e-02 1 1  ON 45
eH2_6                 7.964009e-02 1 1  ON 46
eH2_7                 1.142215e-01 1 1  ON 47
eH2_8                 1.002324e-01 1 1  ON 48
eH2_9                 2.858330e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1969
    reference variance = 0.242947
====================================================
  Execution time = 1.9978e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3939e-01
  Total weights = 2.0000e+06
  Execution time = 1.8336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339420330508
                                         uncertainty =       0.018416321046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339420330508
                                         uncertainty =       0.018416321046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411940790
  error estimate for blocks of size 2^( 2) =       0.000421639454
  error estimate for blocks of size 2^( 3) =       0.000429902331
  error estimate for blocks of size 2^( 4) =       0.000435832761
  error estimate for blocks of size 2^( 5) =       0.000440123399
  error estimate for blocks of size 2^( 6) =       0.000441387322
  error estimate for blocks of size 2^( 7) =       0.000444621614

      target function =                  N/A
              le_mean =     -17.217029000482
             les_mean =     296.765477862536
             stat err =       0.000440491274
             autocorr =       1.143417998323
              std dev =       0.582572252006
             le_variance =       0.339390428807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339419533350
                                         uncertainty =       0.018416236812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339419533350
                                         uncertainty =       0.018416236812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411940307
  error estimate for blocks of size 2^( 2) =       0.000421638973
  error estimate for blocks of size 2^( 3) =       0.000429901860
  error estimate for blocks of size 2^( 4) =       0.000435832294
  error estimate for blocks of size 2^( 5) =       0.000440122918
  error estimate for blocks of size 2^( 6) =       0.000441386852
  error estimate for blocks of size 2^( 7) =       0.000444621206

      target function =                  N/A
              le_mean =     -17.217029016627
             les_mean =     296.765477622264
             stat err =       0.000440490817
             autocorr =       1.143418310651
              std dev =       0.582571568638
             le_variance =       0.339389632586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339419929661
                                         uncertainty =       0.018416278656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339419929661
                                         uncertainty =       0.018416278656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411940547
  error estimate for blocks of size 2^( 2) =       0.000421639212
  error estimate for blocks of size 2^( 3) =       0.000429902094
  error estimate for blocks of size 2^( 4) =       0.000435832526
  error estimate for blocks of size 2^( 5) =       0.000440123157
  error estimate for blocks of size 2^( 6) =       0.000441387085
  error estimate for blocks of size 2^( 7) =       0.000444621409

      target function =                  N/A
              le_mean =     -17.217029008572
             les_mean =     296.765477740754
             stat err =       0.000440491044
             autocorr =       1.143418155569
              std dev =       0.582571908376
             le_variance =       0.339390028429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339420280329
                                         uncertainty =       0.018416315738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339420280329
                                         uncertainty =       0.018416315738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411940760
  error estimate for blocks of size 2^( 2) =       0.000421639423
  error estimate for blocks of size 2^( 3) =       0.000429902302
  error estimate for blocks of size 2^( 4) =       0.000435832731
  error estimate for blocks of size 2^( 5) =       0.000440123369
  error estimate for blocks of size 2^( 6) =       0.000441387292
  error estimate for blocks of size 2^( 7) =       0.000444621588

      target function =                  N/A
              le_mean =     -17.217029001493
             les_mean =     296.765477847255
             stat err =       0.000440491245
             autocorr =       1.143418018018
              std dev =       0.582572208989
             le_variance =       0.339390378687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217029000482        initial
     9.5367e+01     9.5367e+02             2.9152e-06       -17.217029016627  <--
     3.8147e+02     3.8147e+03             7.2942e-07       -17.217029008572
     1.5259e+03     1.5259e+04             1.8239e-07       -17.217029001493

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.9192e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.139785e-01 1 1  ON 0
 uu_1                 5.172518e-02 1 1  ON 1
 uu_2                -4.338474e-02 1 1  ON 2
 uu_3                -9.920333e-02 1 1  ON 3
 uu_4                -1.338087e-01 1 1  ON 4
 uu_5                -1.417104e-01 1 1  ON 5
 uu_6                -1.187564e-01 1 1  ON 6
 uu_7                -4.804685e-02 1 1  ON 7
 uu_8                 9.381617e-02 1 1  ON 8
 uu_9                 1.263590e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.623916e-02 1 1  ON 11
 ud_2                -1.376911e-02 1 1  ON 12
 ud_3                -7.513375e-02 1 1  ON 13
 ud_4                -1.232149e-01 1 1  ON 14
 ud_5                -1.554140e-01 1 1  ON 15
 ud_6                -1.571686e-01 1 1  ON 16
 ud_7                -1.129178e-01 1 1  ON 17
 ud_8                -4.422423e-03 1 1  ON 18
 ud_9                 9.260956e-02 1 1  ON 19
 eO_0                -7.825815e-01 1 1  ON 20
 eO_1                -4.611330e-01 1 1  ON 21
 eO_2                -4.945335e-02 1 1  ON 22
 eO_3                 2.109031e-01 1 1  ON 23
 eO_4                 3.113800e-01 1 1  ON 24
 eO_5                 3.256958e-01 1 1  ON 25
 eO_6                 2.615848e-01 1 1  ON 26
 eO_7                 1.236214e-01 1 1  ON 27
 eO_8                 2.976236e-02 1 1  ON 28
 eO_9                 1.902969e-02 1 1  ON 29
eH1_0                -1.843999e-01 1 1  ON 30
eH1_1                -1.049340e-01 1 1  ON 31
eH1_2                -6.354032e-02 1 1  ON 32
eH1_3                -2.637203e-02 1 1  ON 33
eH1_4                 1.893054e-02 1 1  ON 34
eH1_5                 3.366186e-02 1 1  ON 35
eH1_6                 7.765106e-02 1 1  ON 36
eH1_7                 1.097047e-01 1 1  ON 37
eH1_8                 9.703338e-02 1 1  ON 38
eH1_9                 2.630949e-02 1 1  ON 39
eH2_0                -1.857735e-01 1 1  ON 40
eH2_1                -1.063387e-01 1 1  ON 41
eH2_2                -6.490839e-02 1 1  ON 42
eH2_3                -2.789249e-02 1 1  ON 43
eH2_4                 1.766329e-02 1 1  ON 44
eH2_5                 3.177248e-02 1 1  ON 45
eH2_6                 7.963953e-02 1 1  ON 46
eH2_7                 1.142213e-01 1 1  ON 47
eH2_8                 1.002329e-01 1 1  ON 48
eH2_9                 2.858344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5413e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.21
    reference variance = 0.239568
====================================================
  Execution time = 2.0802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2683e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326705813664
                                         uncertainty =       0.006552481947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326705813664
                                         uncertainty =       0.006552481947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404247702
  error estimate for blocks of size 2^( 2) =       0.000413730914
  error estimate for blocks of size 2^( 3) =       0.000422694610
  error estimate for blocks of size 2^( 4) =       0.000428776373
  error estimate for blocks of size 2^( 5) =       0.000432894170
  error estimate for blocks of size 2^( 6) =       0.000435332090
  error estimate for blocks of size 2^( 7) =       0.000437230406

      target function =                  N/A
              le_mean =     -17.217036160936
             les_mean =     296.753166412425
             stat err =       0.000433558260
             autocorr =       1.150270043885
              std dev =       0.571692582471
             le_variance =       0.326832408852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721703616094e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217036160936       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217036164414       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217036169812       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217036168358       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217036158598       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217036165182       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217036166291       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.045330e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217036160936       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217036161812       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217036163176       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217036162826       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217036160402       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217036162014       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.587030e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217036160936       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217036161156       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217036161498       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217036161411       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217036160806       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217036161207       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 6.470872e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072041 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6354e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.139787e-01 1 1  ON 0
 uu_1                 5.172498e-02 1 1  ON 1
 uu_2                -4.338503e-02 1 1  ON 2
 uu_3                -9.920324e-02 1 1  ON 3
 uu_4                -1.338086e-01 1 1  ON 4
 uu_5                -1.417103e-01 1 1  ON 5
 uu_6                -1.187574e-01 1 1  ON 6
 uu_7                -4.804737e-02 1 1  ON 7
 uu_8                 9.381582e-02 1 1  ON 8
 uu_9                 1.263598e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.623957e-02 1 1  ON 11
 ud_2                -1.376881e-02 1 1  ON 12
 ud_3                -7.513417e-02 1 1  ON 13
 ud_4                -1.232158e-01 1 1  ON 14
 ud_5                -1.554135e-01 1 1  ON 15
 ud_6                -1.571685e-01 1 1  ON 16
 ud_7                -1.129177e-01 1 1  ON 17
 ud_8                -4.423388e-03 1 1  ON 18
 ud_9                 9.260964e-02 1 1  ON 19
 eO_0                -7.825840e-01 1 1  ON 20
 eO_1                -4.611343e-01 1 1  ON 21
 eO_2                -4.945467e-02 1 1  ON 22
 eO_3                 2.109028e-01 1 1  ON 23
 eO_4                 3.113803e-01 1 1  ON 24
 eO_5                 3.256976e-01 1 1  ON 25
 eO_6                 2.615862e-01 1 1  ON 26
 eO_7                 1.236228e-01 1 1  ON 27
 eO_8                 2.976270e-02 1 1  ON 28
 eO_9                 1.902981e-02 1 1  ON 29
eH1_0                -1.844001e-01 1 1  ON 30
eH1_1                -1.049344e-01 1 1  ON 31
eH1_2                -6.354048e-02 1 1  ON 32
eH1_3                -2.637213e-02 1 1  ON 33
eH1_4                 1.893019e-02 1 1  ON 34
eH1_5                 3.366173e-02 1 1  ON 35
eH1_6                 7.765111e-02 1 1  ON 36
eH1_7                 1.097048e-01 1 1  ON 37
eH1_8                 9.703413e-02 1 1  ON 38
eH1_9                 2.630979e-02 1 1  ON 39
eH2_0                -1.857746e-01 1 1  ON 40
eH2_1                -1.063386e-01 1 1  ON 41
eH2_2                -6.490829e-02 1 1  ON 42
eH2_3                -2.789236e-02 1 1  ON 43
eH2_4                 1.766302e-02 1 1  ON 44
eH2_5                 3.177254e-02 1 1  ON 45
eH2_6                 7.963892e-02 1 1  ON 46
eH2_7                 1.142214e-01 1 1  ON 47
eH2_8                 1.002337e-01 1 1  ON 48
eH2_9                 2.858380e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2404
    reference variance = 0.489422
====================================================
  Execution time = 2.0150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2616e-01
  Total weights = 2.0000e+06
  Execution time = 1.8355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326229675136
                                         uncertainty =       0.006718617572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326229675136
                                         uncertainty =       0.006718617572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403834320
  error estimate for blocks of size 2^( 2) =       0.000413175946
  error estimate for blocks of size 2^( 3) =       0.000421241896
  error estimate for blocks of size 2^( 4) =       0.000427548239
  error estimate for blocks of size 2^( 5) =       0.000432259564
  error estimate for blocks of size 2^( 6) =       0.000434118081
  error estimate for blocks of size 2^( 7) =       0.000437424475

      target function =                  N/A
              le_mean =     -17.217129942838
             les_mean =     296.755727621135
             stat err =       0.000432837590
             autocorr =       1.148797524584
              std dev =       0.571107971973
             le_variance =       0.326164315651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326229314372
                                         uncertainty =       0.006718710045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326229314372
                                         uncertainty =       0.006718710045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403834096
  error estimate for blocks of size 2^( 2) =       0.000413175733
  error estimate for blocks of size 2^( 3) =       0.000421241691
  error estimate for blocks of size 2^( 4) =       0.000427548022
  error estimate for blocks of size 2^( 5) =       0.000432259303
  error estimate for blocks of size 2^( 6) =       0.000434117812
  error estimate for blocks of size 2^( 7) =       0.000437424074

      target function =                  N/A
              le_mean =     -17.217129946330
             les_mean =     296.755727379183
             stat err =       0.000432837303
             autocorr =       1.148797275801
              std dev =       0.571107654877
             le_variance =       0.326163953459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326229498806
                                         uncertainty =       0.006718655500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326229498806
                                         uncertainty =       0.006718655500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403834210
  error estimate for blocks of size 2^( 2) =       0.000413175841
  error estimate for blocks of size 2^( 3) =       0.000421241794
  error estimate for blocks of size 2^( 4) =       0.000427548132
  error estimate for blocks of size 2^( 5) =       0.000432259436
  error estimate for blocks of size 2^( 6) =       0.000434117944
  error estimate for blocks of size 2^( 7) =       0.000437424280

      target function =                  N/A
              le_mean =     -17.217129945027
             les_mean =     296.755727519480
             stat err =       0.000432837448
             autocorr =       1.148797396085
              std dev =       0.571107816966
             le_variance =       0.326164138599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326229652823
                                         uncertainty =       0.006718622329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326229652823
                                         uncertainty =       0.006718622329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403834306
  error estimate for blocks of size 2^( 2) =       0.000413175933
  error estimate for blocks of size 2^( 3) =       0.000421241883
  error estimate for blocks of size 2^( 4) =       0.000427548225
  error estimate for blocks of size 2^( 5) =       0.000432259548
  error estimate for blocks of size 2^( 6) =       0.000434118064
  error estimate for blocks of size 2^( 7) =       0.000437424451

      target function =                  N/A
              le_mean =     -17.217129943111
             les_mean =     296.755727608120
             stat err =       0.000432837572
             autocorr =       1.148797508702
              std dev =       0.571107952359
             le_variance =       0.326164293248


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217129942838        initial
     2.3842e+01     2.3842e+02             1.0453e-05       -17.217129946330  <--
     9.5367e+01     9.5367e+02             2.5870e-06       -17.217129945027
     3.8147e+02     3.8147e+03             6.4709e-07       -17.217129943111

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 3.2942e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.139796e-01 1 1  ON 0
 uu_1                 5.172460e-02 1 1  ON 1
 uu_2                -4.338579e-02 1 1  ON 2
 uu_3                -9.920338e-02 1 1  ON 3
 uu_4                -1.338084e-01 1 1  ON 4
 uu_5                -1.417098e-01 1 1  ON 5
 uu_6                -1.187603e-01 1 1  ON 6
 uu_7                -4.804896e-02 1 1  ON 7
 uu_8                 9.381470e-02 1 1  ON 8
 uu_9                 1.263622e-01 1 1  ON 9
 ud_0                 3.553787e-01 1 1  ON 10
 ud_1                 9.624054e-02 1 1  ON 11
 ud_2                -1.376765e-02 1 1  ON 12
 ud_3                -7.513552e-02 1 1  ON 13
 ud_4                -1.232184e-01 1 1  ON 14
 ud_5                -1.554120e-01 1 1  ON 15
 ud_6                -1.571685e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.426383e-03 1 1  ON 18
 ud_9                 9.260988e-02 1 1  ON 19
 eO_0                -7.825919e-01 1 1  ON 20
 eO_1                -4.611385e-01 1 1  ON 21
 eO_2                -4.945865e-02 1 1  ON 22
 eO_3                 2.109018e-01 1 1  ON 23
 eO_4                 3.113812e-01 1 1  ON 24
 eO_5                 3.257031e-01 1 1  ON 25
 eO_6                 2.615906e-01 1 1  ON 26
 eO_7                 1.236273e-01 1 1  ON 27
 eO_8                 2.976373e-02 1 1  ON 28
 eO_9                 1.903017e-02 1 1  ON 29
eH1_0                -1.844007e-01 1 1  ON 30
eH1_1                -1.049356e-01 1 1  ON 31
eH1_2                -6.354116e-02 1 1  ON 32
eH1_3                -2.637247e-02 1 1  ON 33
eH1_4                 1.892930e-02 1 1  ON 34
eH1_5                 3.366133e-02 1 1  ON 35
eH1_6                 7.765126e-02 1 1  ON 36
eH1_7                 1.097051e-01 1 1  ON 37
eH1_8                 9.703645e-02 1 1  ON 38
eH1_9                 2.631070e-02 1 1  ON 39
eH2_0                -1.857776e-01 1 1  ON 40
eH2_1                -1.063384e-01 1 1  ON 41
eH2_2                -6.490815e-02 1 1  ON 42
eH2_3                -2.789202e-02 1 1  ON 43
eH2_4                 1.766227e-02 1 1  ON 44
eH2_5                 3.177273e-02 1 1  ON 45
eH2_6                 7.963706e-02 1 1  ON 46
eH2_7                 1.142219e-01 1 1  ON 47
eH2_8                 1.002365e-01 1 1  ON 48
eH2_9                 2.858492e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9302e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1811
    reference variance = 0.209501
====================================================
  Execution time = 2.0646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2661e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326591416623
                                         uncertainty =       0.012482166617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326591416623
                                         uncertainty =       0.012482166617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404107155
  error estimate for blocks of size 2^( 2) =       0.000413387783
  error estimate for blocks of size 2^( 3) =       0.000421725693
  error estimate for blocks of size 2^( 4) =       0.000428464023
  error estimate for blocks of size 2^( 5) =       0.000432439856
  error estimate for blocks of size 2^( 6) =       0.000434983583
  error estimate for blocks of size 2^( 7) =       0.000435269227

      target function =                  N/A
              le_mean =     -17.216868883669
             les_mean =     296.747179179676
             stat err =       0.000432789172
             autocorr =       1.146990164209
              std dev =       0.571493819312
             le_variance =       0.326605185512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686888367e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216868883669       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216868945606       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216868988132       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216868933123       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216869002519       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216869025136       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216869004998       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.973241e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216868883669       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216868899676       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216868910588       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216868896925       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216868914115       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216868920171       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216868915302       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 9.998721e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216868883669       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216868887705       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216868890451       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216868887044       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216868891329       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216868892870       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216868891667       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.503939e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074332 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6190e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.139859e-01 1 1  ON 0
 uu_1                 5.172423e-02 1 1  ON 1
 uu_2                -4.338603e-02 1 1  ON 2
 uu_3                -9.920608e-02 1 1  ON 3
 uu_4                -1.338088e-01 1 1  ON 4
 uu_5                -1.417112e-01 1 1  ON 5
 uu_6                -1.187640e-01 1 1  ON 6
 uu_7                -4.805175e-02 1 1  ON 7
 uu_8                 9.381233e-02 1 1  ON 8
 uu_9                 1.263653e-01 1 1  ON 9
 ud_0                 3.553759e-01 1 1  ON 10
 ud_1                 9.624360e-02 1 1  ON 11
 ud_2                -1.376876e-02 1 1  ON 12
 ud_3                -7.513730e-02 1 1  ON 13
 ud_4                -1.232191e-01 1 1  ON 14
 ud_5                -1.554089e-01 1 1  ON 15
 ud_6                -1.571700e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.429625e-03 1 1  ON 18
 ud_9                 9.261055e-02 1 1  ON 19
 eO_0                -7.826019e-01 1 1  ON 20
 eO_1                -4.611468e-01 1 1  ON 21
 eO_2                -4.946253e-02 1 1  ON 22
 eO_3                 2.109013e-01 1 1  ON 23
 eO_4                 3.113844e-01 1 1  ON 24
 eO_5                 3.257088e-01 1 1  ON 25
 eO_6                 2.615964e-01 1 1  ON 26
 eO_7                 1.236330e-01 1 1  ON 27
 eO_8                 2.976483e-02 1 1  ON 28
 eO_9                 1.903072e-02 1 1  ON 29
eH1_0                -1.843953e-01 1 1  ON 30
eH1_1                -1.049385e-01 1 1  ON 31
eH1_2                -6.354239e-02 1 1  ON 32
eH1_3                -2.637252e-02 1 1  ON 33
eH1_4                 1.892819e-02 1 1  ON 34
eH1_5                 3.365653e-02 1 1  ON 35
eH1_6                 7.765082e-02 1 1  ON 36
eH1_7                 1.097053e-01 1 1  ON 37
eH1_8                 9.703930e-02 1 1  ON 38
eH1_9                 2.631181e-02 1 1  ON 39
eH2_0                -1.857774e-01 1 1  ON 40
eH2_1                -1.063387e-01 1 1  ON 41
eH2_2                -6.490813e-02 1 1  ON 42
eH2_3                -2.789021e-02 1 1  ON 43
eH2_4                 1.765860e-02 1 1  ON 44
eH2_5                 3.177006e-02 1 1  ON 45
eH2_6                 7.963535e-02 1 1  ON 46
eH2_7                 1.142227e-01 1 1  ON 47
eH2_8                 1.002404e-01 1 1  ON 48
eH2_9                 2.858622e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2061
    reference variance = 0.390754
====================================================
  Execution time = 2.0017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3076e-01
  Total weights = 2.0000e+06
  Execution time = 1.8346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330877390548
                                         uncertainty =       0.005930215598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330877390548
                                         uncertainty =       0.005930215598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406672689
  error estimate for blocks of size 2^( 2) =       0.000416220575
  error estimate for blocks of size 2^( 3) =       0.000424968030
  error estimate for blocks of size 2^( 4) =       0.000431460989
  error estimate for blocks of size 2^( 5) =       0.000435644963
  error estimate for blocks of size 2^( 6) =       0.000438074136
  error estimate for blocks of size 2^( 7) =       0.000439061689

      target function =                  N/A
              le_mean =     -17.216934009138
             les_mean =     296.753581860832
             stat err =       0.000436060444
             autocorr =       1.149749877997
              std dev =       0.575122031580
             le_variance =       0.330765351209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330877001547
                                         uncertainty =       0.005930511286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330877001547
                                         uncertainty =       0.005930511286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406672448
  error estimate for blocks of size 2^( 2) =       0.000416220215
  error estimate for blocks of size 2^( 3) =       0.000424967530
  error estimate for blocks of size 2^( 4) =       0.000431460476
  error estimate for blocks of size 2^( 5) =       0.000435644085
  error estimate for blocks of size 2^( 6) =       0.000438072649
  error estimate for blocks of size 2^( 7) =       0.000439060369

      target function =                  N/A
              le_mean =     -17.216934098428
             les_mean =     296.753584544647
             stat err =       0.000436059395
             autocorr =       1.149745702050
              std dev =       0.575121691820
             le_variance =       0.330764960401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330876879151
                                         uncertainty =       0.005930362300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330876879151
                                         uncertainty =       0.005930362300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406672374
  error estimate for blocks of size 2^( 2) =       0.000416220204
  error estimate for blocks of size 2^( 3) =       0.000424967592
  error estimate for blocks of size 2^( 4) =       0.000431460545
  error estimate for blocks of size 2^( 5) =       0.000435644333
  error estimate for blocks of size 2^( 6) =       0.000438073188
  error estimate for blocks of size 2^( 7) =       0.000439060833

      target function =                  N/A
              le_mean =     -17.216934055828
             les_mean =     296.753582956420
             stat err =       0.000436059725
             autocorr =       1.149747864424
              std dev =       0.575121586340
             le_variance =       0.330764839074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330877315301
                                         uncertainty =       0.005930233888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330877315301
                                         uncertainty =       0.005930233888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406672642
  error estimate for blocks of size 2^( 2) =       0.000416220522
  error estimate for blocks of size 2^( 3) =       0.000424967969
  error estimate for blocks of size 2^( 4) =       0.000431460927
  error estimate for blocks of size 2^( 5) =       0.000435644878
  error estimate for blocks of size 2^( 6) =       0.000438074010
  error estimate for blocks of size 2^( 7) =       0.000439061575

      target function =                  N/A
              le_mean =     -17.216934015010
             les_mean =     296.753581987717
             stat err =       0.000436060347
             autocorr =       1.149749628956
              std dev =       0.575121966086
             le_variance =       0.330765275875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216934009138        initial
     5.9605e+00     5.9605e+01             3.9732e-05       -17.216934098428  <--
     2.3842e+01     2.3842e+02             9.9987e-06       -17.216934055828
     9.5367e+01     9.5367e+02             2.5039e-06       -17.216934015010

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.9249e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172329e-02 1 1  ON 1
 uu_2                -4.338668e-02 1 1  ON 2
 uu_3                -9.921377e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806008e-02 1 1  ON 7
 uu_8                 9.380526e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625185e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514254e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553998e-01 1 1  ON 15
 ud_6                -1.571743e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439286e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826316e-01 1 1  ON 20
 eO_1                -4.611712e-01 1 1  ON 21
 eO_2                -4.947437e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113939e-01 1 1  ON 24
 eO_5                 3.257259e-01 1 1  ON 25
 eO_6                 2.616138e-01 1 1  ON 26
 eO_7                 1.236499e-01 1 1  ON 27
 eO_8                 2.976813e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843796e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354580e-02 1 1  ON 32
eH1_3                -2.637281e-02 1 1  ON 33
eH1_4                 1.892479e-02 1 1  ON 34
eH1_5                 3.364220e-02 1 1  ON 35
eH1_6                 7.764950e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704781e-02 1 1  ON 38
eH1_9                 2.631511e-02 1 1  ON 39
eH2_0                -1.857768e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490801e-02 1 1  ON 42
eH2_3                -2.788498e-02 1 1  ON 43
eH2_4                 1.764776e-02 1 1  ON 44
eH2_5                 3.176199e-02 1 1  ON 45
eH2_6                 7.963024e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859009e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2703
    reference variance = 0.231368
====================================================
  Execution time = 2.0425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1991e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319928699033
                                         uncertainty =       0.003431253968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319928699033
                                         uncertainty =       0.003431253968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399945000
  error estimate for blocks of size 2^( 2) =       0.000409241180
  error estimate for blocks of size 2^( 3) =       0.000417812463
  error estimate for blocks of size 2^( 4) =       0.000423666930
  error estimate for blocks of size 2^( 5) =       0.000427981245
  error estimate for blocks of size 2^( 6) =       0.000431012618
  error estimate for blocks of size 2^( 7) =       0.000431506578

      target function =                  N/A
              le_mean =     -17.216624502114
             les_mean =     296.732071093459
             stat err =       0.000428541843
             autocorr =       1.148116402678
              std dev =       0.565607643713
             le_variance =       0.319912006627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662450211e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216624502114       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216624469887       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216624322846       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216624403854       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216624698930       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216624808079       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216624799887       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216624816865       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.887466e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216624502114       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216624493156       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216624450322       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216624467131       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216624536694       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216624562565       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216624565415       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 5.104678e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216624502114       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216624499810       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216624488636       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216624492530       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216624509305       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216624515678       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216624516790       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.297972e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076781 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5970e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.140085e-01 1 1  ON 0
 uu_1                 5.173816e-02 1 1  ON 1
 uu_2                -4.338919e-02 1 1  ON 2
 uu_3                -9.921515e-02 1 1  ON 3
 uu_4                -1.338149e-01 1 1  ON 4
 uu_5                -1.417293e-01 1 1  ON 5
 uu_6                -1.187846e-01 1 1  ON 6
 uu_7                -4.806063e-02 1 1  ON 7
 uu_8                 9.379590e-02 1 1  ON 8
 uu_9                 1.263828e-01 1 1  ON 9
 ud_0                 3.553880e-01 1 1  ON 10
 ud_1                 9.626428e-02 1 1  ON 11
 ud_2                -1.377767e-02 1 1  ON 12
 ud_3                -7.515179e-02 1 1  ON 13
 ud_4                -1.232289e-01 1 1  ON 14
 ud_5                -1.554187e-01 1 1  ON 15
 ud_6                -1.571753e-01 1 1  ON 16
 ud_7                -1.129128e-01 1 1  ON 17
 ud_8                -4.448400e-03 1 1  ON 18
 ud_9                 9.261643e-02 1 1  ON 19
 eO_0                -7.826709e-01 1 1  ON 20
 eO_1                -4.612222e-01 1 1  ON 21
 eO_2                -4.948317e-02 1 1  ON 22
 eO_3                 2.109028e-01 1 1  ON 23
 eO_4                 3.114087e-01 1 1  ON 24
 eO_5                 3.257528e-01 1 1  ON 25
 eO_6                 2.616380e-01 1 1  ON 26
 eO_7                 1.236729e-01 1 1  ON 27
 eO_8                 2.977260e-02 1 1  ON 28
 eO_9                 1.903346e-02 1 1  ON 29
eH1_0                -1.843837e-01 1 1  ON 30
eH1_1                -1.049601e-01 1 1  ON 31
eH1_2                -6.354806e-02 1 1  ON 32
eH1_3                -2.638285e-02 1 1  ON 33
eH1_4                 1.892538e-02 1 1  ON 34
eH1_5                 3.364293e-02 1 1  ON 35
eH1_6                 7.765822e-02 1 1  ON 36
eH1_7                 1.097091e-01 1 1  ON 37
eH1_8                 9.705717e-02 1 1  ON 38
eH1_9                 2.631956e-02 1 1  ON 39
eH2_0                -1.857894e-01 1 1  ON 40
eH2_1                -1.063463e-01 1 1  ON 41
eH2_2                -6.492305e-02 1 1  ON 42
eH2_3                -2.787946e-02 1 1  ON 43
eH2_4                 1.766305e-02 1 1  ON 44
eH2_5                 3.175663e-02 1 1  ON 45
eH2_6                 7.962511e-02 1 1  ON 46
eH2_7                 1.142287e-01 1 1  ON 47
eH2_8                 1.002665e-01 1 1  ON 48
eH2_9                 2.859516e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1896
    reference variance = 0.448504
====================================================
  Execution time = 2.0391e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1668e-01
  Total weights = 2.0000e+06
  Execution time = 1.8226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316668705684
                                         uncertainty =       0.004843114658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316668705684
                                         uncertainty =       0.004843114658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397909123
  error estimate for blocks of size 2^( 2) =       0.000407794014
  error estimate for blocks of size 2^( 3) =       0.000416222972
  error estimate for blocks of size 2^( 4) =       0.000423332702
  error estimate for blocks of size 2^( 5) =       0.000426746210
  error estimate for blocks of size 2^( 6) =       0.000428496444
  error estimate for blocks of size 2^( 7) =       0.000431261282

      target function =                  N/A
              le_mean =     -17.216111931801
             les_mean =     296.711173229646
             stat err =       0.000427459160
             autocorr =       1.154041597962
              std dev =       0.562728477749
             le_variance =       0.316663339669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316741654988
                                         uncertainty =       0.004844514549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316741654988
                                         uncertainty =       0.004844514549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397954937
  error estimate for blocks of size 2^( 2) =       0.000407837240
  error estimate for blocks of size 2^( 3) =       0.000416263358
  error estimate for blocks of size 2^( 4) =       0.000423370792
  error estimate for blocks of size 2^( 5) =       0.000426782983
  error estimate for blocks of size 2^( 6) =       0.000428531736
  error estimate for blocks of size 2^( 7) =       0.000431295602

      target function =                  N/A
              le_mean =     -17.216110933747
             les_mean =     296.711211788550
             stat err =       0.000427495278
             autocorr =       1.153970882519
              std dev =       0.562793269184
             le_variance =       0.316736263838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316709456554
                                         uncertainty =       0.004843847396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316709456554
                                         uncertainty =       0.004843847396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397934714
  error estimate for blocks of size 2^( 2) =       0.000407818147
  error estimate for blocks of size 2^( 3) =       0.000416245514
  error estimate for blocks of size 2^( 4) =       0.000423353993
  error estimate for blocks of size 2^( 5) =       0.000426766714
  error estimate for blocks of size 2^( 6) =       0.000428516066
  error estimate for blocks of size 2^( 7) =       0.000431280373

      target function =                  N/A
              le_mean =     -17.216111344417
             les_mean =     296.711193738504
             stat err =       0.000427479286
             autocorr =       1.154001831138
              std dev =       0.562764669741
             le_variance =       0.316704073509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316673921087
                                         uncertainty =       0.004843208238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316673921087
                                         uncertainty =       0.004843208238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397912398
  error estimate for blocks of size 2^( 2) =       0.000407797100
  error estimate for blocks of size 2^( 3) =       0.000416225852
  error estimate for blocks of size 2^( 4) =       0.000423335422
  error estimate for blocks of size 2^( 5) =       0.000426748828
  error estimate for blocks of size 2^( 6) =       0.000428498948
  error estimate for blocks of size 2^( 7) =       0.000431263719

      target function =                  N/A
              le_mean =     -17.216111854531
             les_mean =     296.711175782257
             stat err =       0.000427461730
             autocorr =       1.154036474742
              std dev =       0.562733109802
             le_variance =       0.316668552868


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216111931801        initial  <--
     1.4901e+00     1.4901e+01             1.8875e-04       -17.216110933747
     5.9605e+00     5.9605e+01             5.1047e-05       -17.216111344417
     2.3842e+01     2.3842e+02             1.2980e-05       -17.216111854531

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5777
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172329e-02 1 1  ON 1
 uu_2                -4.338668e-02 1 1  ON 2
 uu_3                -9.921377e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806008e-02 1 1  ON 7
 uu_8                 9.380526e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625185e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514254e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553998e-01 1 1  ON 15
 ud_6                -1.571743e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439286e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826316e-01 1 1  ON 20
 eO_1                -4.611712e-01 1 1  ON 21
 eO_2                -4.947437e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113939e-01 1 1  ON 24
 eO_5                 3.257259e-01 1 1  ON 25
 eO_6                 2.616138e-01 1 1  ON 26
 eO_7                 1.236499e-01 1 1  ON 27
 eO_8                 2.976813e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843796e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354580e-02 1 1  ON 32
eH1_3                -2.637281e-02 1 1  ON 33
eH1_4                 1.892479e-02 1 1  ON 34
eH1_5                 3.364220e-02 1 1  ON 35
eH1_6                 7.764950e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704781e-02 1 1  ON 38
eH1_9                 2.631511e-02 1 1  ON 39
eH2_0                -1.857768e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490801e-02 1 1  ON 42
eH2_3                -2.788498e-02 1 1  ON 43
eH2_4                 1.764776e-02 1 1  ON 44
eH2_5                 3.176199e-02 1 1  ON 45
eH2_6                 7.963024e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859009e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5553e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1609
    reference variance = 0.245795
====================================================
  Execution time = 2.0371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1565e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315715974091
                                         uncertainty =       0.002931263800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315715974091
                                         uncertainty =       0.002931263800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397274196
  error estimate for blocks of size 2^( 2) =       0.000407328754
  error estimate for blocks of size 2^( 3) =       0.000416401859
  error estimate for blocks of size 2^( 4) =       0.000423043245
  error estimate for blocks of size 2^( 5) =       0.000427508190
  error estimate for blocks of size 2^( 6) =       0.000428781150
  error estimate for blocks of size 2^( 7) =       0.000428061470

      target function =                  N/A
              le_mean =     -17.216597478268
             les_mean =     296.726882144109
             stat err =       0.000426848514
             autocorr =       1.154427950528
              std dev =       0.561830555636
             le_variance =       0.315653573246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659747827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216597478268       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216597504861       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216597519586       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216597537944       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216597551433       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216597553699       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216597548084       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.574565e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216597478268       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216597484967       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216597488725       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216597493333       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216597496601       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216597497138       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216597495723       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 6.486299e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216597478268       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216597479946       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216597480890       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216597482043       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216597482854       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216597482986       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216597482631       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.624756e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5965e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.140048e-01 1 1  ON 0
 uu_1                 5.172416e-02 1 1  ON 1
 uu_2                -4.338547e-02 1 1  ON 2
 uu_3                -9.921430e-02 1 1  ON 3
 uu_4                -1.338109e-01 1 1  ON 4
 uu_5                -1.417170e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806072e-02 1 1  ON 7
 uu_8                 9.380426e-02 1 1  ON 8
 uu_9                 1.263754e-01 1 1  ON 9
 ud_0                 3.553681e-01 1 1  ON 10
 ud_1                 9.625177e-02 1 1  ON 11
 ud_2                -1.377160e-02 1 1  ON 12
 ud_3                -7.514235e-02 1 1  ON 13
 ud_4                -1.232203e-01 1 1  ON 14
 ud_5                -1.554001e-01 1 1  ON 15
 ud_6                -1.571746e-01 1 1  ON 16
 ud_7                -1.129172e-01 1 1  ON 17
 ud_8                -4.440906e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826341e-01 1 1  ON 20
 eO_1                -4.611777e-01 1 1  ON 21
 eO_2                -4.947723e-02 1 1  ON 22
 eO_3                 2.109011e-01 1 1  ON 23
 eO_4                 3.113963e-01 1 1  ON 24
 eO_5                 3.257288e-01 1 1  ON 25
 eO_6                 2.616162e-01 1 1  ON 26
 eO_7                 1.236521e-01 1 1  ON 27
 eO_8                 2.976840e-02 1 1  ON 28
 eO_9                 1.903245e-02 1 1  ON 29
eH1_0                -1.843795e-01 1 1  ON 30
eH1_1                -1.049478e-01 1 1  ON 31
eH1_2                -6.354484e-02 1 1  ON 32
eH1_3                -2.637308e-02 1 1  ON 33
eH1_4                 1.892531e-02 1 1  ON 34
eH1_5                 3.363995e-02 1 1  ON 35
eH1_6                 7.764905e-02 1 1  ON 36
eH1_7                 1.097065e-01 1 1  ON 37
eH1_8                 9.704917e-02 1 1  ON 38
eH1_9                 2.631555e-02 1 1  ON 39
eH2_0                -1.857765e-01 1 1  ON 40
eH2_1                -1.063386e-01 1 1  ON 41
eH2_2                -6.490763e-02 1 1  ON 42
eH2_3                -2.788506e-02 1 1  ON 43
eH2_4                 1.764604e-02 1 1  ON 44
eH2_5                 3.176103e-02 1 1  ON 45
eH2_6                 7.962993e-02 1 1  ON 46
eH2_7                 1.142251e-01 1 1  ON 47
eH2_8                 1.002530e-01 1 1  ON 48
eH2_9                 2.859039e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1529
    reference variance = 0.188728
====================================================
  Execution time = 1.9947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1525e-01
  Total weights = 2.0000e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315281320995
                                         uncertainty =       0.003425883527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315281320995
                                         uncertainty =       0.003425883527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397023050
  error estimate for blocks of size 2^( 2) =       0.000406588118
  error estimate for blocks of size 2^( 3) =       0.000415430450
  error estimate for blocks of size 2^( 4) =       0.000421767562
  error estimate for blocks of size 2^( 5) =       0.000425114605
  error estimate for blocks of size 2^( 6) =       0.000427778278
  error estimate for blocks of size 2^( 7) =       0.000430303211

      target function =                  N/A
              le_mean =     -17.216986571046
             les_mean =     296.739881034998
             stat err =       0.000426240914
             autocorr =       1.152600557319
              std dev =       0.561475382402
             le_variance =       0.315254605043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315279077130
                                         uncertainty =       0.003425922381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315279077130
                                         uncertainty =       0.003425922381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397021638
  error estimate for blocks of size 2^( 2) =       0.000406586748
  error estimate for blocks of size 2^( 3) =       0.000415429144
  error estimate for blocks of size 2^( 4) =       0.000421766370
  error estimate for blocks of size 2^( 5) =       0.000425113380
  error estimate for blocks of size 2^( 6) =       0.000427776991
  error estimate for blocks of size 2^( 7) =       0.000430302096

      target function =                  N/A
              le_mean =     -17.216986561463
             les_mean =     296.739878461387
             stat err =       0.000426239709
             autocorr =       1.152602244443
              std dev =       0.561473384418
             le_variance =       0.315252361409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315280189806
                                         uncertainty =       0.003425903263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315280189806
                                         uncertainty =       0.003425903263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397022338
  error estimate for blocks of size 2^( 2) =       0.000406587428
  error estimate for blocks of size 2^( 3) =       0.000415429792
  error estimate for blocks of size 2^( 4) =       0.000421766962
  error estimate for blocks of size 2^( 5) =       0.000425113989
  error estimate for blocks of size 2^( 6) =       0.000427777630
  error estimate for blocks of size 2^( 7) =       0.000430302651

      target function =                  N/A
              le_mean =     -17.216986566198
             les_mean =     296.739879736981
             stat err =       0.000426240308
             autocorr =       1.152601415135
              std dev =       0.561474375165
             le_variance =       0.315253473967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315281179258
                                         uncertainty =       0.003425886004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315281179258
                                         uncertainty =       0.003425886004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397022961
  error estimate for blocks of size 2^( 2) =       0.000406588031
  error estimate for blocks of size 2^( 3) =       0.000415430367
  error estimate for blocks of size 2^( 4) =       0.000421767487
  error estimate for blocks of size 2^( 5) =       0.000425114528
  error estimate for blocks of size 2^( 6) =       0.000427778196
  error estimate for blocks of size 2^( 7) =       0.000430303141

      target function =                  N/A
              le_mean =     -17.216986570431
             les_mean =     296.739880872105
             stat err =       0.000426240838
             autocorr =       1.152600664976
              std dev =       0.561475256195
             le_variance =       0.315254463320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216986571046        initial  <--
     1.4901e+01     1.4901e+02             2.5746e-05       -17.216986561463
     5.9605e+01     5.9605e+02             6.4863e-06       -17.216986566198
     2.3842e+02     2.3842e+03             1.6248e-06       -17.216986570431

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2218
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172329e-02 1 1  ON 1
 uu_2                -4.338668e-02 1 1  ON 2
 uu_3                -9.921377e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806008e-02 1 1  ON 7
 uu_8                 9.380526e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625185e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514254e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553998e-01 1 1  ON 15
 ud_6                -1.571743e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439286e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826316e-01 1 1  ON 20
 eO_1                -4.611712e-01 1 1  ON 21
 eO_2                -4.947437e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113939e-01 1 1  ON 24
 eO_5                 3.257259e-01 1 1  ON 25
 eO_6                 2.616138e-01 1 1  ON 26
 eO_7                 1.236499e-01 1 1  ON 27
 eO_8                 2.976813e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843796e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354580e-02 1 1  ON 32
eH1_3                -2.637281e-02 1 1  ON 33
eH1_4                 1.892479e-02 1 1  ON 34
eH1_5                 3.364220e-02 1 1  ON 35
eH1_6                 7.764950e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704781e-02 1 1  ON 38
eH1_9                 2.631511e-02 1 1  ON 39
eH2_0                -1.857768e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490801e-02 1 1  ON 42
eH2_3                -2.788498e-02 1 1  ON 43
eH2_4                 1.764776e-02 1 1  ON 44
eH2_5                 3.176199e-02 1 1  ON 45
eH2_6                 7.963024e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859009e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5213e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2221
    reference variance = 0.249575
====================================================
  Execution time = 2.2517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1900e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319070550784
                                         uncertainty =       0.004957332983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319070550784
                                         uncertainty =       0.004957332983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399373227
  error estimate for blocks of size 2^( 2) =       0.000409177164
  error estimate for blocks of size 2^( 3) =       0.000418073779
  error estimate for blocks of size 2^( 4) =       0.000424552647
  error estimate for blocks of size 2^( 5) =       0.000428687916
  error estimate for blocks of size 2^( 6) =       0.000432252041
  error estimate for blocks of size 2^( 7) =       0.000432261114

      target function =                  N/A
              le_mean =     -17.216906664343
             les_mean =     296.740872878300
             stat err =       0.000429438429
             autocorr =       1.156229154429
              std dev =       0.564799034273
             le_variance =       0.318997949116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721690666434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216906664343       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216906663989       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216906658691       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216906656673       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216906656252       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216906657526       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216906658285       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.188005e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216906664343       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216906664254       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216906662927       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216906662421       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216906662313       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216906662632       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216906662822       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.472574e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216906664343       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216906664320       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216906663989       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216906663862       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216906663834       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216906663912       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216906663961       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.368304e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8138e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.140043e-01 1 1  ON 0
 uu_1                 5.172327e-02 1 1  ON 1
 uu_2                -4.338671e-02 1 1  ON 2
 uu_3                -9.921382e-02 1 1  ON 3
 uu_4                -1.338100e-01 1 1  ON 4
 uu_5                -1.417155e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806018e-02 1 1  ON 7
 uu_8                 9.380516e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553681e-01 1 1  ON 10
 ud_1                 9.625202e-02 1 1  ON 11
 ud_2                -1.377176e-02 1 1  ON 12
 ud_3                -7.514261e-02 1 1  ON 13
 ud_4                -1.232212e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129174e-01 1 1  ON 17
 ud_8                -4.439461e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826322e-01 1 1  ON 20
 eO_1                -4.611715e-01 1 1  ON 21
 eO_2                -4.947448e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113942e-01 1 1  ON 24
 eO_5                 3.257262e-01 1 1  ON 25
 eO_6                 2.616140e-01 1 1  ON 26
 eO_7                 1.236501e-01 1 1  ON 27
 eO_8                 2.976816e-02 1 1  ON 28
 eO_9                 1.903239e-02 1 1  ON 29
eH1_0                -1.843796e-01 1 1  ON 30
eH1_1                -1.049466e-01 1 1  ON 31
eH1_2                -6.354591e-02 1 1  ON 32
eH1_3                -2.637280e-02 1 1  ON 33
eH1_4                 1.892477e-02 1 1  ON 34
eH1_5                 3.364193e-02 1 1  ON 35
eH1_6                 7.764949e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704793e-02 1 1  ON 38
eH1_9                 2.631514e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063395e-01 1 1  ON 41
eH2_2                -6.490805e-02 1 1  ON 42
eH2_3                -2.788498e-02 1 1  ON 43
eH2_4                 1.764786e-02 1 1  ON 44
eH2_5                 3.176192e-02 1 1  ON 45
eH2_6                 7.963022e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002521e-01 1 1  ON 48
eH2_9                 2.859011e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.218
    reference variance = 0.207979
====================================================
  Execution time = 2.0154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2363e-01
  Total weights = 2.0000e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681728126
                                         uncertainty =       0.005722956560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681728126
                                         uncertainty =       0.005722956560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402259599
  error estimate for blocks of size 2^( 2) =       0.000411858546
  error estimate for blocks of size 2^( 3) =       0.000420275792
  error estimate for blocks of size 2^( 4) =       0.000427619671
  error estimate for blocks of size 2^( 5) =       0.000431966353
  error estimate for blocks of size 2^( 6) =       0.000434264097
  error estimate for blocks of size 2^( 7) =       0.000436176810

      target function =                  N/A
              le_mean =     -17.216949583834
             les_mean =     296.746978380334
             stat err =       0.000432506733
             autocorr =       1.156040135293
              std dev =       0.568880980396
             le_variance =       0.323625569856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681242614
                                         uncertainty =       0.005722933650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681242614
                                         uncertainty =       0.005722933650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402259297
  error estimate for blocks of size 2^( 2) =       0.000411858263
  error estimate for blocks of size 2^( 3) =       0.000420275515
  error estimate for blocks of size 2^( 4) =       0.000427619411
  error estimate for blocks of size 2^( 5) =       0.000431966096
  error estimate for blocks of size 2^( 6) =       0.000434263862
  error estimate for blocks of size 2^( 7) =       0.000436176565

      target function =                  N/A
              le_mean =     -17.216949581953
             les_mean =     296.746977829526
             stat err =       0.000432506484
             autocorr =       1.156040541512
              std dev =       0.568880553226
             le_variance =       0.323625083839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681484177
                                         uncertainty =       0.005722945068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681484177
                                         uncertainty =       0.005722945068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402259447
  error estimate for blocks of size 2^( 2) =       0.000411858404
  error estimate for blocks of size 2^( 3) =       0.000420275653
  error estimate for blocks of size 2^( 4) =       0.000427619541
  error estimate for blocks of size 2^( 5) =       0.000431966224
  error estimate for blocks of size 2^( 6) =       0.000434263979
  error estimate for blocks of size 2^( 7) =       0.000436176687

      target function =                  N/A
              le_mean =     -17.216949582892
             les_mean =     296.746978103670
             stat err =       0.000432506608
             autocorr =       1.156040339242
              std dev =       0.568880765762
             le_variance =       0.323625325654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681697594
                                         uncertainty =       0.005722955122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681697594
                                         uncertainty =       0.005722955122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402259580
  error estimate for blocks of size 2^( 2) =       0.000411858528
  error estimate for blocks of size 2^( 3) =       0.000420275774
  error estimate for blocks of size 2^( 4) =       0.000427619655
  error estimate for blocks of size 2^( 5) =       0.000431966337
  error estimate for blocks of size 2^( 6) =       0.000434264082
  error estimate for blocks of size 2^( 7) =       0.000436176794

      target function =                  N/A
              le_mean =     -17.216949583716
             les_mean =     296.746978345707
             stat err =       0.000432506717
             autocorr =       1.156040160810
              std dev =       0.568880953533
             le_variance =       0.323625539293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216949583834        initial  <--
     1.4901e+02     1.4901e+03             2.1880e-06       -17.216949581953
     5.9605e+02     5.9605e+03             5.4726e-07       -17.216949582892
     2.3842e+03     2.3842e+04             1.3683e-07       -17.216949583716

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3488
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172329e-02 1 1  ON 1
 uu_2                -4.338668e-02 1 1  ON 2
 uu_3                -9.921377e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806008e-02 1 1  ON 7
 uu_8                 9.380526e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625185e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514254e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553998e-01 1 1  ON 15
 ud_6                -1.571743e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439286e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826316e-01 1 1  ON 20
 eO_1                -4.611712e-01 1 1  ON 21
 eO_2                -4.947437e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113939e-01 1 1  ON 24
 eO_5                 3.257259e-01 1 1  ON 25
 eO_6                 2.616138e-01 1 1  ON 26
 eO_7                 1.236499e-01 1 1  ON 27
 eO_8                 2.976813e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843796e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354580e-02 1 1  ON 32
eH1_3                -2.637281e-02 1 1  ON 33
eH1_4                 1.892479e-02 1 1  ON 34
eH1_5                 3.364220e-02 1 1  ON 35
eH1_6                 7.764950e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704781e-02 1 1  ON 38
eH1_9                 2.631511e-02 1 1  ON 39
eH2_0                -1.857768e-01 1 1  ON 40
eH2_1                -1.063394e-01 1 1  ON 41
eH2_2                -6.490801e-02 1 1  ON 42
eH2_3                -2.788498e-02 1 1  ON 43
eH2_4                 1.764776e-02 1 1  ON 44
eH2_5                 3.176199e-02 1 1  ON 45
eH2_6                 7.963024e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859009e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1821
    reference variance = 0.234711
====================================================
  Execution time = 2.0769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1643e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316518473940
                                         uncertainty =       0.002707730186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316518473940
                                         uncertainty =       0.002707730186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397762418
  error estimate for blocks of size 2^( 2) =       0.000407428556
  error estimate for blocks of size 2^( 3) =       0.000416033254
  error estimate for blocks of size 2^( 4) =       0.000422300095
  error estimate for blocks of size 2^( 5) =       0.000425438334
  error estimate for blocks of size 2^( 6) =       0.000426679792
  error estimate for blocks of size 2^( 7) =       0.000428875775

      target function =                  N/A
              le_mean =     -17.216664879148
             les_mean =     296.729979284771
             stat err =       0.000425823499
             autocorr =       1.146071611139
              std dev =       0.562521005929
             le_variance =       0.316429882112


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666487915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216664879148       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216664879393       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216664879523       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216664879572       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216664880104       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216664880057       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216664880051       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.512239e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216664879148       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216664879209       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216664879241       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216664879258       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216664879386       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216664879370       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216664879377       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.780645e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216664879148       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216664879163       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216664879171       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216664879174       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216664879207       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216664879213       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216664879202       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.451641e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6359e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172330e-02 1 1  ON 1
 uu_2                -4.338669e-02 1 1  ON 2
 uu_3                -9.921377e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806008e-02 1 1  ON 7
 uu_8                 9.380526e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625186e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553998e-01 1 1  ON 15
 ud_6                -1.571743e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439301e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826317e-01 1 1  ON 20
 eO_1                -4.611712e-01 1 1  ON 21
 eO_2                -4.947438e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113939e-01 1 1  ON 24
 eO_5                 3.257259e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976813e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843796e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354580e-02 1 1  ON 32
eH1_3                -2.637282e-02 1 1  ON 33
eH1_4                 1.892481e-02 1 1  ON 34
eH1_5                 3.364219e-02 1 1  ON 35
eH1_6                 7.764950e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704782e-02 1 1  ON 38
eH1_9                 2.631512e-02 1 1  ON 39
eH2_0                -1.857768e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490802e-02 1 1  ON 42
eH2_3                -2.788499e-02 1 1  ON 43
eH2_4                 1.764774e-02 1 1  ON 44
eH2_5                 3.176199e-02 1 1  ON 45
eH2_6                 7.963023e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859009e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.217
    reference variance = 0.145878
====================================================
  Execution time = 1.9988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2507e-01
  Total weights = 2.0000e+06
  Execution time = 1.8295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324934616695
                                         uncertainty =       0.008683486475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324934616695
                                         uncertainty =       0.008683486475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403158206
  error estimate for blocks of size 2^( 2) =       0.000412905442
  error estimate for blocks of size 2^( 3) =       0.000420964565
  error estimate for blocks of size 2^( 4) =       0.000428256417
  error estimate for blocks of size 2^( 5) =       0.000431568514
  error estimate for blocks of size 2^( 6) =       0.000432731289
  error estimate for blocks of size 2^( 7) =       0.000433470072

      target function =                  N/A
              le_mean =     -17.217462554225
             les_mean =     296.766089721548
             stat err =       0.000431506573
             autocorr =       1.145575782064
              std dev =       0.570151802546
             le_variance =       0.325073077947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324934652017
                                         uncertainty =       0.008683486314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324934652017
                                         uncertainty =       0.008683486314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403158228
  error estimate for blocks of size 2^( 2) =       0.000412905463
  error estimate for blocks of size 2^( 3) =       0.000420964585
  error estimate for blocks of size 2^( 4) =       0.000428256437
  error estimate for blocks of size 2^( 5) =       0.000431568532
  error estimate for blocks of size 2^( 6) =       0.000432731306
  error estimate for blocks of size 2^( 7) =       0.000433470090

      target function =                  N/A
              le_mean =     -17.217462554515
             les_mean =     296.766089766802
             stat err =       0.000431506591
             autocorr =       1.145575753668
              std dev =       0.570151833469
             le_variance =       0.325073113208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324934634358
                                         uncertainty =       0.008683486395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324934634358
                                         uncertainty =       0.008683486395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403158217
  error estimate for blocks of size 2^( 2) =       0.000412905452
  error estimate for blocks of size 2^( 3) =       0.000420964575
  error estimate for blocks of size 2^( 4) =       0.000428256427
  error estimate for blocks of size 2^( 5) =       0.000431568523
  error estimate for blocks of size 2^( 6) =       0.000432731298
  error estimate for blocks of size 2^( 7) =       0.000433470081

      target function =                  N/A
              le_mean =     -17.217462554370
             les_mean =     296.766089744178
             stat err =       0.000431506582
             autocorr =       1.145575767860
              std dev =       0.570151818009
             le_variance =       0.325073095579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324934618903
                                         uncertainty =       0.008683486465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324934618903
                                         uncertainty =       0.008683486465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403158207
  error estimate for blocks of size 2^( 2) =       0.000412905443
  error estimate for blocks of size 2^( 3) =       0.000420964566
  error estimate for blocks of size 2^( 4) =       0.000428256418
  error estimate for blocks of size 2^( 5) =       0.000431568515
  error estimate for blocks of size 2^( 6) =       0.000432731290
  error estimate for blocks of size 2^( 7) =       0.000433470074

      target function =                  N/A
              le_mean =     -17.217462554243
             les_mean =     296.766089724377
             stat err =       0.000431506574
             autocorr =       1.145575780289
              std dev =       0.570151804479
             le_variance =       0.325073080151


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217462554225        initial
     1.4901e+03     1.4901e+04             1.5122e-07       -17.217462554515  <--
     5.9605e+03     5.9605e+04             3.7806e-08       -17.217462554370
     2.3842e+04     2.3842e+05             9.4516e-09       -17.217462554243

*****************************************************************************
Applying the update for shift_i =   1.4901e+03     and shift_s =   1.4901e+04
*****************************************************************************

  Execution time = 2.9183e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377188e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439343e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947443e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704785e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490805e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5547e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2552
    reference variance = 0.242494
====================================================
  Execution time = 2.2952e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2494e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325028741697
                                         uncertainty =       0.005437809304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325028741697
                                         uncertainty =       0.005437809304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403077077
  error estimate for blocks of size 2^( 2) =       0.000412446457
  error estimate for blocks of size 2^( 3) =       0.000420696633
  error estimate for blocks of size 2^( 4) =       0.000426435047
  error estimate for blocks of size 2^( 5) =       0.000430241431
  error estimate for blocks of size 2^( 6) =       0.000431987338
  error estimate for blocks of size 2^( 7) =       0.000431184059

      target function =                  N/A
              le_mean =     -17.215854255177
             les_mean =     296.710579833625
             stat err =       0.000429961969
             autocorr =       1.137847038153
              std dev =       0.570037069501
             le_variance =       0.324942260605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721585425518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215854255177       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215854256430       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215854256070       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215854257544       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215854256541       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215854257167       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215854257188       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 5.508015e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215854255177       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215854255490       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215854255400       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215854255768       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215854255517       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215854255675       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215854255680       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.376950e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215854255177       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215854255255       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215854255233       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215854255325       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215854255261       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215854255301       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215854255304       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.442342e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8605e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.140042e-01 1 1  ON 0
 uu_1                 5.172332e-02 1 1  ON 1
 uu_2                -4.338679e-02 1 1  ON 2
 uu_3                -9.921374e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806016e-02 1 1  ON 7
 uu_8                 9.380519e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625193e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514252e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129174e-01 1 1  ON 17
 ud_8                -4.439419e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826319e-01 1 1  ON 20
 eO_1                -4.611714e-01 1 1  ON 21
 eO_2                -4.947457e-02 1 1  ON 22
 eO_3                 2.108995e-01 1 1  ON 23
 eO_4                 3.113941e-01 1 1  ON 24
 eO_5                 3.257261e-01 1 1  ON 25
 eO_6                 2.616140e-01 1 1  ON 26
 eO_7                 1.236501e-01 1 1  ON 27
 eO_8                 2.976815e-02 1 1  ON 28
 eO_9                 1.903238e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049469e-01 1 1  ON 31
eH1_2                -6.354575e-02 1 1  ON 32
eH1_3                -2.637294e-02 1 1  ON 33
eH1_4                 1.892487e-02 1 1  ON 34
eH1_5                 3.364212e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704790e-02 1 1  ON 38
eH1_9                 2.631514e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490809e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764763e-02 1 1  ON 44
eH2_5                 3.176198e-02 1 1  ON 45
eH2_6                 7.963020e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002521e-01 1 1  ON 48
eH2_9                 2.859011e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1691
    reference variance = 0.214951
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1768e-01
  Total weights = 2.0000e+06
  Execution time = 1.8333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317691497608
                                         uncertainty =       0.003373523221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317691497608
                                         uncertainty =       0.003373523221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398547723
  error estimate for blocks of size 2^( 2) =       0.000408307006
  error estimate for blocks of size 2^( 3) =       0.000416928732
  error estimate for blocks of size 2^( 4) =       0.000423419068
  error estimate for blocks of size 2^( 5) =       0.000428119533
  error estimate for blocks of size 2^( 6) =       0.000429043582
  error estimate for blocks of size 2^( 7) =       0.000428323568

      target function =                  N/A
              le_mean =     -17.215121013750
             les_mean =     296.678071934357
             stat err =       0.000427226438
             autocorr =       1.149094048866
              std dev =       0.563631595239
             le_variance =       0.317680575152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317691621659
                                         uncertainty =       0.003373525451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317691621659
                                         uncertainty =       0.003373525451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398547801
  error estimate for blocks of size 2^( 2) =       0.000408307086
  error estimate for blocks of size 2^( 3) =       0.000416928808
  error estimate for blocks of size 2^( 4) =       0.000423419143
  error estimate for blocks of size 2^( 5) =       0.000428119610
  error estimate for blocks of size 2^( 6) =       0.000429043649
  error estimate for blocks of size 2^( 7) =       0.000428323623

      target function =                  N/A
              le_mean =     -17.215121013059
             les_mean =     296.678072034676
             stat err =       0.000427226506
             autocorr =       1.149093969019
              std dev =       0.563631705316
             le_variance =       0.317680699237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317691559702
                                         uncertainty =       0.003373524337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317691559702
                                         uncertainty =       0.003373524337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398547762
  error estimate for blocks of size 2^( 2) =       0.000408307046
  error estimate for blocks of size 2^( 3) =       0.000416928770
  error estimate for blocks of size 2^( 4) =       0.000423419106
  error estimate for blocks of size 2^( 5) =       0.000428119572
  error estimate for blocks of size 2^( 6) =       0.000429043615
  error estimate for blocks of size 2^( 7) =       0.000428323596

      target function =                  N/A
              le_mean =     -17.215121013404
             les_mean =     296.678071984564
             stat err =       0.000427226472
             autocorr =       1.149094008902
              std dev =       0.563631650338
             le_variance =       0.317680637262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317691505372
                                         uncertainty =       0.003373523360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317691505372
                                         uncertainty =       0.003373523360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398547728
  error estimate for blocks of size 2^( 2) =       0.000408307011
  error estimate for blocks of size 2^( 3) =       0.000416928736
  error estimate for blocks of size 2^( 4) =       0.000423419073
  error estimate for blocks of size 2^( 5) =       0.000428119538
  error estimate for blocks of size 2^( 6) =       0.000429043586
  error estimate for blocks of size 2^( 7) =       0.000428323572

      target function =                  N/A
              le_mean =     -17.215121013706
             les_mean =     296.678071940633
             stat err =       0.000427226442
             autocorr =       1.149094043874
              std dev =       0.563631602128
             le_variance =       0.317680582918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215121013750        initial  <--
     3.7253e+02     3.7253e+03             5.5080e-07       -17.215121013059
     1.4901e+03     1.4901e+04             1.3770e-07       -17.215121013404
     5.9605e+03     5.9605e+04             3.4423e-08       -17.215121013706

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6555
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377188e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439343e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947443e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704785e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490805e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1979
    reference variance = 0.202797
====================================================
  Execution time = 2.0583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2569e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325734534025
                                         uncertainty =       0.008255150606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325734534025
                                         uncertainty =       0.008255150606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403542613
  error estimate for blocks of size 2^( 2) =       0.000412634263
  error estimate for blocks of size 2^( 3) =       0.000421282106
  error estimate for blocks of size 2^( 4) =       0.000428259674
  error estimate for blocks of size 2^( 5) =       0.000432866491
  error estimate for blocks of size 2^( 6) =       0.000436143385
  error estimate for blocks of size 2^( 7) =       0.000436323371

      target function =                  N/A
              le_mean =     -17.216721678664
             les_mean =     296.741198478349
             stat err =       0.000433398230
             autocorr =       1.153441209784
              std dev =       0.570695435946
             le_variance =       0.325693280609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672167866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721678664       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721678685       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721678806       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216721678811       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216721678911       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216721678981       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216721678985       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 7.812154e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721678664       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721678669       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721678700       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216721678701       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216721678724       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216721678742       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216721678740       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.953074e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721678664       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721678666       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721678673       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216721678707       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216721678682       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216721678786       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216721678724       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 4.882708e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6082e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625190e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514252e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439348e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892483e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788501e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1766
    reference variance = 0.235337
====================================================
  Execution time = 2.0174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2517e-01
  Total weights = 2.0000e+06
  Execution time = 1.8226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325063707424
                                         uncertainty =       0.004959748113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325063707424
                                         uncertainty =       0.004959748113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403216362
  error estimate for blocks of size 2^( 2) =       0.000413092003
  error estimate for blocks of size 2^( 3) =       0.000421602064
  error estimate for blocks of size 2^( 4) =       0.000428015657
  error estimate for blocks of size 2^( 5) =       0.000432811829
  error estimate for blocks of size 2^( 6) =       0.000435310034
  error estimate for blocks of size 2^( 7) =       0.000434885126

      target function =                  N/A
              le_mean =     -17.216833115779
             les_mean =     296.744509243533
             stat err =       0.000432755662
             autocorr =       1.151885263924
              std dev =       0.570234048019
             le_variance =       0.325166869520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325063727274
                                         uncertainty =       0.004959748627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325063727274
                                         uncertainty =       0.004959748627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403216374
  error estimate for blocks of size 2^( 2) =       0.000413092014
  error estimate for blocks of size 2^( 3) =       0.000421602075
  error estimate for blocks of size 2^( 4) =       0.000428015668
  error estimate for blocks of size 2^( 5) =       0.000432811839
  error estimate for blocks of size 2^( 6) =       0.000435310044
  error estimate for blocks of size 2^( 7) =       0.000434885138

      target function =                  N/A
              le_mean =     -17.216833115601
             les_mean =     296.744509257181
             stat err =       0.000432755672
             autocorr =       1.151885251479
              std dev =       0.570234065377
             le_variance =       0.325166889317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325063717349
                                         uncertainty =       0.004959748370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325063717349
                                         uncertainty =       0.004959748370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403216368
  error estimate for blocks of size 2^( 2) =       0.000413092009
  error estimate for blocks of size 2^( 3) =       0.000421602069
  error estimate for blocks of size 2^( 4) =       0.000428015663
  error estimate for blocks of size 2^( 5) =       0.000432811834
  error estimate for blocks of size 2^( 6) =       0.000435310039
  error estimate for blocks of size 2^( 7) =       0.000434885132

      target function =                  N/A
              le_mean =     -17.216833115690
             les_mean =     296.744509250357
             stat err =       0.000432755667
             autocorr =       1.151885257699
              std dev =       0.570234056699
             le_variance =       0.325166879419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325063708665
                                         uncertainty =       0.004959748145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325063708665
                                         uncertainty =       0.004959748145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403216363
  error estimate for blocks of size 2^( 2) =       0.000413092003
  error estimate for blocks of size 2^( 3) =       0.000421602064
  error estimate for blocks of size 2^( 4) =       0.000428015658
  error estimate for blocks of size 2^( 5) =       0.000432811830
  error estimate for blocks of size 2^( 6) =       0.000435310034
  error estimate for blocks of size 2^( 7) =       0.000434885127

      target function =                  N/A
              le_mean =     -17.216833115768
             les_mean =     296.744509244386
             stat err =       0.000432755662
             autocorr =       1.151885263151
              std dev =       0.570234049104
             le_variance =       0.325166870758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216833115779        initial  <--
     3.7253e+03     3.7253e+04             7.8122e-08       -17.216833115601
     1.4901e+04     1.4901e+05             1.9531e-08       -17.216833115690
     5.9605e+04     5.9605e+05             4.8827e-09       -17.216833115768

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3915
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377188e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439343e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947443e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704785e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490805e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1131
    reference variance = 0.516552
====================================================
  Execution time = 2.0449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3148e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331513313415
                                         uncertainty =       0.009271319185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331513313415
                                         uncertainty =       0.009271319185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407109664
  error estimate for blocks of size 2^( 2) =       0.000416236198
  error estimate for blocks of size 2^( 3) =       0.000424545056
  error estimate for blocks of size 2^( 4) =       0.000431214315
  error estimate for blocks of size 2^( 5) =       0.000435467339
  error estimate for blocks of size 2^( 6) =       0.000438542991
  error estimate for blocks of size 2^( 7) =       0.000441419510

      target function =                  N/A
              le_mean =     -17.217039932410
             les_mean =     296.757940425477
             stat err =       0.000436661039
             autocorr =       1.150445537094
              std dev =       0.575740008189
             le_variance =       0.331476557029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721703993241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217039932410       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217039932416       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217039932417       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217039932444       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217039932424       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217039932425       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217039932430       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 8.580643e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217039932410       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217039932411       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217039932412       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217039932416       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217039932426       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217039932397       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217039932387       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.145167e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217039932410       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217039932410       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217039932410       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217039932411       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217039932287       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217039932083       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217039932144       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 5.362922e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6005e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377188e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439344e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947443e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490805e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2258
    reference variance = 0.497225
====================================================
  Execution time = 2.0247e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1136e-01
  Total weights = 2.0000e+06
  Execution time = 1.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311331714805
                                         uncertainty =       0.002938491127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311331714805
                                         uncertainty =       0.002938491127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394566147
  error estimate for blocks of size 2^( 2) =       0.000404087924
  error estimate for blocks of size 2^( 3) =       0.000412790916
  error estimate for blocks of size 2^( 4) =       0.000418729833
  error estimate for blocks of size 2^( 5) =       0.000422474017
  error estimate for blocks of size 2^( 6) =       0.000423679086
  error estimate for blocks of size 2^( 7) =       0.000425278459

      target function =                  N/A
              le_mean =     -17.216069956214
             les_mean =     296.704429469840
             stat err =       0.000422540349
             autocorr =       1.146823891323
              std dev =       0.558000795946
             le_variance =       0.311364888276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311331714034
                                         uncertainty =       0.002938491125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311331714034
                                         uncertainty =       0.002938491125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394566146
  error estimate for blocks of size 2^( 2) =       0.000404087923
  error estimate for blocks of size 2^( 3) =       0.000412790916
  error estimate for blocks of size 2^( 4) =       0.000418729833
  error estimate for blocks of size 2^( 5) =       0.000422474017
  error estimate for blocks of size 2^( 6) =       0.000423679086
  error estimate for blocks of size 2^( 7) =       0.000425278458

      target function =                  N/A
              le_mean =     -17.216069956230
             les_mean =     296.704429469636
             stat err =       0.000422540348
             autocorr =       1.146823891963
              std dev =       0.558000795255
             le_variance =       0.311364887506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311331714419
                                         uncertainty =       0.002938491126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311331714419
                                         uncertainty =       0.002938491126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394566146
  error estimate for blocks of size 2^( 2) =       0.000404087923
  error estimate for blocks of size 2^( 3) =       0.000412790916
  error estimate for blocks of size 2^( 4) =       0.000418729833
  error estimate for blocks of size 2^( 5) =       0.000422474017
  error estimate for blocks of size 2^( 6) =       0.000423679086
  error estimate for blocks of size 2^( 7) =       0.000425278459

      target function =                  N/A
              le_mean =     -17.216069956222
             les_mean =     296.704429469738
             stat err =       0.000422540349
             autocorr =       1.146823891644
              std dev =       0.558000795601
             le_variance =       0.311364887891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311331714757
                                         uncertainty =       0.002938491127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311331714757
                                         uncertainty =       0.002938491127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394566147
  error estimate for blocks of size 2^( 2) =       0.000404087924
  error estimate for blocks of size 2^( 3) =       0.000412790916
  error estimate for blocks of size 2^( 4) =       0.000418729833
  error estimate for blocks of size 2^( 5) =       0.000422474017
  error estimate for blocks of size 2^( 6) =       0.000423679086
  error estimate for blocks of size 2^( 7) =       0.000425278459

      target function =                  N/A
              le_mean =     -17.216069956215
             les_mean =     296.704429469828
             stat err =       0.000422540349
             autocorr =       1.146823891359
              std dev =       0.558000795903
             le_variance =       0.311364888228


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216069956214        initial
     3.7253e+04     3.7253e+05             8.5806e-09       -17.216069956230  <--
     1.4901e+05     1.4901e+06             2.1452e-09       -17.216069956222
     5.9605e+05     5.9605e+06             5.3629e-10       -17.216069956215

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 2.9475e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1931
    reference variance = 0.266435
====================================================
  Execution time = 2.0488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1443e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314567459404
                                         uncertainty =       0.004748468629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314567459404
                                         uncertainty =       0.004748468629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396502080
  error estimate for blocks of size 2^( 2) =       0.000406367808
  error estimate for blocks of size 2^( 3) =       0.000415488666
  error estimate for blocks of size 2^( 4) =       0.000421590611
  error estimate for blocks of size 2^( 5) =       0.000425234973
  error estimate for blocks of size 2^( 6) =       0.000427522669
  error estimate for blocks of size 2^( 7) =       0.000428955056

      target function =                  N/A
              le_mean =     -17.216552971514
             les_mean =     296.724123862549
             stat err =       0.000425825827
             autocorr =       1.153381703728
              std dev =       0.560738618990
             le_variance =       0.314427798826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655297151e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552971514       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552971643       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216552971626       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216552971649       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216552971644       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216552971643       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216552971651       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.565545e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552971514       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552971546       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216552971542       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216552971555       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216552971549       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216552971547       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216552971542       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.413868e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552971514       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552971522       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216552971521       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216552971522       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216552971521       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216552971503       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216552971537       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.603467e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6614e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625190e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439349e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490805e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1576
    reference variance = 0.208386
====================================================
  Execution time = 1.9797e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2813e-01
  Total weights = 2.0000e+06
  Execution time = 1.8304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150134994
                                         uncertainty =       0.011265870391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150134994
                                         uncertainty =       0.011265870391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405047089
  error estimate for blocks of size 2^( 2) =       0.000414183223
  error estimate for blocks of size 2^( 3) =       0.000423039025
  error estimate for blocks of size 2^( 4) =       0.000428719673
  error estimate for blocks of size 2^( 5) =       0.000432134079
  error estimate for blocks of size 2^( 6) =       0.000432791850
  error estimate for blocks of size 2^( 7) =       0.000434738976

      target function =                  N/A
              le_mean =     -17.217226119393
             les_mean =     296.761001370425
             stat err =       0.000432096145
             autocorr =       1.138019627695
              std dev =       0.572823086290
             le_variance =       0.328126288187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150139488
                                         uncertainty =       0.011265870052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150139488
                                         uncertainty =       0.011265870052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405047092
  error estimate for blocks of size 2^( 2) =       0.000414183225
  error estimate for blocks of size 2^( 3) =       0.000423039027
  error estimate for blocks of size 2^( 4) =       0.000428719676
  error estimate for blocks of size 2^( 5) =       0.000432134081
  error estimate for blocks of size 2^( 6) =       0.000432791853
  error estimate for blocks of size 2^( 7) =       0.000434738978

      target function =                  N/A
              le_mean =     -17.217226119267
             les_mean =     296.761001370587
             stat err =       0.000432096147
             autocorr =       1.138019623986
              std dev =       0.572823090214
             le_variance =       0.328126292682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150137241
                                         uncertainty =       0.011265870222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150137241
                                         uncertainty =       0.011265870222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405047090
  error estimate for blocks of size 2^( 2) =       0.000414183224
  error estimate for blocks of size 2^( 3) =       0.000423039026
  error estimate for blocks of size 2^( 4) =       0.000428719675
  error estimate for blocks of size 2^( 5) =       0.000432134080
  error estimate for blocks of size 2^( 6) =       0.000432791852
  error estimate for blocks of size 2^( 7) =       0.000434738977

      target function =                  N/A
              le_mean =     -17.217226119330
             les_mean =     296.761001370506
             stat err =       0.000432096146
             autocorr =       1.138019625848
              std dev =       0.572823088252
             le_variance =       0.328126290435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150135275
                                         uncertainty =       0.011265870370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150135275
                                         uncertainty =       0.011265870370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405047089
  error estimate for blocks of size 2^( 2) =       0.000414183223
  error estimate for blocks of size 2^( 3) =       0.000423039025
  error estimate for blocks of size 2^( 4) =       0.000428719674
  error estimate for blocks of size 2^( 5) =       0.000432134079
  error estimate for blocks of size 2^( 6) =       0.000432791851
  error estimate for blocks of size 2^( 7) =       0.000434738976

      target function =                  N/A
              le_mean =     -17.217226119385
             les_mean =     296.761001370435
             stat err =       0.000432096145
             autocorr =       1.138019627460
              std dev =       0.572823086535
             le_variance =       0.328126288468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217226119393        initial  <--
     9.3132e+03     9.3132e+04             2.5655e-08       -17.217226119267
     3.7253e+04     3.7253e+05             6.4139e-09       -17.217226119330
     1.4901e+05     1.4901e+06             1.6035e-09       -17.217226119385

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0210
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1971
    reference variance = 0.243982
====================================================
  Execution time = 2.0513e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1576e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315752002490
                                         uncertainty =       0.003382165844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315752002490
                                         uncertainty =       0.003382165844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397339540
  error estimate for blocks of size 2^( 2) =       0.000406584067
  error estimate for blocks of size 2^( 3) =       0.000415585484
  error estimate for blocks of size 2^( 4) =       0.000422634998
  error estimate for blocks of size 2^( 5) =       0.000426085688
  error estimate for blocks of size 2^( 6) =       0.000428679434
  error estimate for blocks of size 2^( 7) =       0.000431386499

      target function =                  N/A
              le_mean =     -17.216338143011
             les_mean =     296.718056316364
             stat err =       0.000427196655
             autocorr =       1.155931549391
              std dev =       0.561922966012
             le_variance =       0.315757419731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633814301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216338143011       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216338143020       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216338143017       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216338143021       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216338143072       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216338143058       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216338143028       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.703026e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216338143011       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216338143014       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216338143013       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216338142939       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216338143018       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216338142899       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216338143004       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.757572e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216338143011       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216338143012       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216338143012       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216338142036       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216338142988       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216338143353       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216338143788       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.689394e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6132e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2307
    reference variance = 0.343138
====================================================
  Execution time = 2.0138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1948e-01
  Total weights = 2.0000e+06
  Execution time = 1.8319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319122453298
                                         uncertainty =       0.004016329437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319122453298
                                         uncertainty =       0.004016329437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399672611
  error estimate for blocks of size 2^( 2) =       0.000409396805
  error estimate for blocks of size 2^( 3) =       0.000417897285
  error estimate for blocks of size 2^( 4) =       0.000424727845
  error estimate for blocks of size 2^( 5) =       0.000428340475
  error estimate for blocks of size 2^( 6) =       0.000429721066
  error estimate for blocks of size 2^( 7) =       0.000432099700

      target function =                  N/A
              le_mean =     -17.216797050060
             les_mean =     296.737576894724
             stat err =       0.000428722272
             autocorr =       1.150650194930
              std dev =       0.565222426578
             le_variance =       0.319476391507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319122453879
                                         uncertainty =       0.004016329454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319122453879
                                         uncertainty =       0.004016329454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399672611
  error estimate for blocks of size 2^( 2) =       0.000409396805
  error estimate for blocks of size 2^( 3) =       0.000417897286
  error estimate for blocks of size 2^( 4) =       0.000424727845
  error estimate for blocks of size 2^( 5) =       0.000428340475
  error estimate for blocks of size 2^( 6) =       0.000429721066
  error estimate for blocks of size 2^( 7) =       0.000432099700

      target function =                  N/A
              le_mean =     -17.216797050054
             les_mean =     296.737576895111
             stat err =       0.000428722272
             autocorr =       1.150650194327
              std dev =       0.565222427095
             le_variance =       0.319476392092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319122453588
                                         uncertainty =       0.004016329445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319122453588
                                         uncertainty =       0.004016329445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399672611
  error estimate for blocks of size 2^( 2) =       0.000409396805
  error estimate for blocks of size 2^( 3) =       0.000417897286
  error estimate for blocks of size 2^( 4) =       0.000424727845
  error estimate for blocks of size 2^( 5) =       0.000428340475
  error estimate for blocks of size 2^( 6) =       0.000429721066
  error estimate for blocks of size 2^( 7) =       0.000432099700

      target function =                  N/A
              le_mean =     -17.216797050057
             les_mean =     296.737576894918
             stat err =       0.000428722272
             autocorr =       1.150650194628
              std dev =       0.565222426837
             le_variance =       0.319476391799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319122453334
                                         uncertainty =       0.004016329438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319122453334
                                         uncertainty =       0.004016329438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399672611
  error estimate for blocks of size 2^( 2) =       0.000409396805
  error estimate for blocks of size 2^( 3) =       0.000417897285
  error estimate for blocks of size 2^( 4) =       0.000424727845
  error estimate for blocks of size 2^( 5) =       0.000428340475
  error estimate for blocks of size 2^( 6) =       0.000429721066
  error estimate for blocks of size 2^( 7) =       0.000432099700

      target function =                  N/A
              le_mean =     -17.216797050060
             les_mean =     296.737576894749
             stat err =       0.000428722272
             autocorr =       1.150650194894
              std dev =       0.565222426611
             le_variance =       0.319476391544


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216797050060        initial  <--
     9.3132e+04     9.3132e+05             2.7030e-09       -17.216797050054
     3.7253e+05     3.7253e+06             6.7576e-10       -17.216797050057
     1.4901e+06     1.4901e+07             1.6894e-10       -17.216797050060

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3539
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1551
    reference variance = 0.17106
====================================================
  Execution time = 2.0174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1417e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314186653735
                                         uncertainty =       0.003862526929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314186653735
                                         uncertainty =       0.003862526929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396340503
  error estimate for blocks of size 2^( 2) =       0.000405935628
  error estimate for blocks of size 2^( 3) =       0.000414594696
  error estimate for blocks of size 2^( 4) =       0.000421659552
  error estimate for blocks of size 2^( 5) =       0.000424825736
  error estimate for blocks of size 2^( 6) =       0.000427727091
  error estimate for blocks of size 2^( 7) =       0.000428195413

      target function =                  N/A
              le_mean =     -17.215979034306
             les_mean =     296.704105541061
             stat err =       0.000425601948
             autocorr =       1.153108841471
              std dev =       0.560510114521
             le_variance =       0.314171588480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597903431e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215979034306       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215979034306       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215979034305       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215979034305       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215979034306       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215979034124       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215979034317       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.643141e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215979034306       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215979034306       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215979034306       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215979032926       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215979034947       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215979030312       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215979027043       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 9.107823e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215979034306       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215979034306       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215979034306       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215979034306       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215979049958       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215979033804       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215979034231       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.277004e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5740e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.246819
====================================================
  Execution time = 2.2489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0983e-01
  Total weights = 2.0000e+06
  Execution time = 1.8240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309873305816
                                         uncertainty =       0.002114689478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309873305816
                                         uncertainty =       0.002114689478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393595508
  error estimate for blocks of size 2^( 2) =       0.000403508126
  error estimate for blocks of size 2^( 3) =       0.000412148846
  error estimate for blocks of size 2^( 4) =       0.000418810781
  error estimate for blocks of size 2^( 5) =       0.000422870504
  error estimate for blocks of size 2^( 6) =       0.000423545917
  error estimate for blocks of size 2^( 7) =       0.000426670746

      target function =                  N/A
              le_mean =     -17.216854723400
             les_mean =     296.729921259520
             stat err =       0.000422974487
             autocorr =       1.154856646191
              std dev =       0.556628105437
             le_variance =       0.309834847763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309873306020
                                         uncertainty =       0.002114689479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309873306020
                                         uncertainty =       0.002114689479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393595508
  error estimate for blocks of size 2^( 2) =       0.000403508126
  error estimate for blocks of size 2^( 3) =       0.000412148846
  error estimate for blocks of size 2^( 4) =       0.000418810781
  error estimate for blocks of size 2^( 5) =       0.000422870504
  error estimate for blocks of size 2^( 6) =       0.000423545917
  error estimate for blocks of size 2^( 7) =       0.000426670746

      target function =                  N/A
              le_mean =     -17.216854723401
             les_mean =     296.729921259745
             stat err =       0.000422974487
             autocorr =       1.154856646053
              std dev =       0.556628105621
             le_variance =       0.309834847967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309873305918
                                         uncertainty =       0.002114689479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309873305918
                                         uncertainty =       0.002114689479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393595508
  error estimate for blocks of size 2^( 2) =       0.000403508126
  error estimate for blocks of size 2^( 3) =       0.000412148846
  error estimate for blocks of size 2^( 4) =       0.000418810781
  error estimate for blocks of size 2^( 5) =       0.000422870504
  error estimate for blocks of size 2^( 6) =       0.000423545917
  error estimate for blocks of size 2^( 7) =       0.000426670746

      target function =                  N/A
              le_mean =     -17.216854723401
             les_mean =     296.729921259632
             stat err =       0.000422974487
             autocorr =       1.154856646128
              std dev =       0.556628105529
             le_variance =       0.309834847865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309873305828
                                         uncertainty =       0.002114689478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309873305828
                                         uncertainty =       0.002114689478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393595508
  error estimate for blocks of size 2^( 2) =       0.000403508126
  error estimate for blocks of size 2^( 3) =       0.000412148846
  error estimate for blocks of size 2^( 4) =       0.000418810781
  error estimate for blocks of size 2^( 5) =       0.000422870504
  error estimate for blocks of size 2^( 6) =       0.000423545917
  error estimate for blocks of size 2^( 7) =       0.000426670746

      target function =                  N/A
              le_mean =     -17.216854723400
             les_mean =     296.729921259534
             stat err =       0.000422974487
             autocorr =       1.154856646179
              std dev =       0.556628105449
             le_variance =       0.309834847775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216854723400        initial
     9.3132e+05     9.3132e+06             3.6431e-10       -17.216854723401  <--
     3.7253e+06     3.7253e+07             9.1078e-11       -17.216854723401
     1.4901e+07     1.4901e+08             2.2770e-11       -17.216854723400

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 3.1780e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7525e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1519
    reference variance = 0.148994
====================================================
  Execution time = 2.0142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2031e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320288946430
                                         uncertainty =       0.004668191792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320288946430
                                         uncertainty =       0.004668191792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400194355
  error estimate for blocks of size 2^( 2) =       0.000409875220
  error estimate for blocks of size 2^( 3) =       0.000417985067
  error estimate for blocks of size 2^( 4) =       0.000424556665
  error estimate for blocks of size 2^( 5) =       0.000428212385
  error estimate for blocks of size 2^( 6) =       0.000429502319
  error estimate for blocks of size 2^( 7) =       0.000429934826

      target function =                  N/A
              le_mean =     -17.216885009079
             les_mean =     296.741440299369
             stat err =       0.000428051549
             autocorr =       1.144063758555
              std dev =       0.565960284528
             le_variance =       0.320311043663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688500908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216885009079       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216885009080       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216885009082       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216885009046       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216885009079       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216885009168       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216885009199       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.263442e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216885009079       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216885009080       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216885009080       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216885009052       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216885008851       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216885009083       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216885008321       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.158606e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216885009079       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216885009079       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216885009080       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216885007960       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216885009080       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216885009439       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216885009080       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 7.896521e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5794e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439347e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1989
    reference variance = 0.429617
====================================================
  Execution time = 1.9999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1788e-01
  Total weights = 2.0000e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317888135221
                                         uncertainty =       0.004179431919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317888135221
                                         uncertainty =       0.004179431919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398670371
  error estimate for blocks of size 2^( 2) =       0.000408131568
  error estimate for blocks of size 2^( 3) =       0.000416784027
  error estimate for blocks of size 2^( 4) =       0.000423137054
  error estimate for blocks of size 2^( 5) =       0.000426578910
  error estimate for blocks of size 2^( 6) =       0.000429781525
  error estimate for blocks of size 2^( 7) =       0.000430440637

      target function =                  N/A
              le_mean =     -17.216965630870
             les_mean =     296.741781504529
             stat err =       0.000427484531
             autocorr =       1.149775072644
              std dev =       0.563805045131
             le_variance =       0.317876128915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317888134993
                                         uncertainty =       0.004179431911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317888134993
                                         uncertainty =       0.004179431911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398670371
  error estimate for blocks of size 2^( 2) =       0.000408131568
  error estimate for blocks of size 2^( 3) =       0.000416784027
  error estimate for blocks of size 2^( 4) =       0.000423137054
  error estimate for blocks of size 2^( 5) =       0.000426578910
  error estimate for blocks of size 2^( 6) =       0.000429781525
  error estimate for blocks of size 2^( 7) =       0.000430440637

      target function =                  N/A
              le_mean =     -17.216965630866
             les_mean =     296.741781504182
             stat err =       0.000427484531
             autocorr =       1.149775072814
              std dev =       0.563805044929
             le_variance =       0.317876128687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317888135107
                                         uncertainty =       0.004179431915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317888135107
                                         uncertainty =       0.004179431915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398670371
  error estimate for blocks of size 2^( 2) =       0.000408131568
  error estimate for blocks of size 2^( 3) =       0.000416784027
  error estimate for blocks of size 2^( 4) =       0.000423137054
  error estimate for blocks of size 2^( 5) =       0.000426578910
  error estimate for blocks of size 2^( 6) =       0.000429781525
  error estimate for blocks of size 2^( 7) =       0.000430440637

      target function =                  N/A
              le_mean =     -17.216965630868
             les_mean =     296.741781504355
             stat err =       0.000427484531
             autocorr =       1.149775072745
              std dev =       0.563805045030
             le_variance =       0.317876128801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317888135206
                                         uncertainty =       0.004179431918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317888135206
                                         uncertainty =       0.004179431918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398670371
  error estimate for blocks of size 2^( 2) =       0.000408131568
  error estimate for blocks of size 2^( 3) =       0.000416784027
  error estimate for blocks of size 2^( 4) =       0.000423137054
  error estimate for blocks of size 2^( 5) =       0.000426578910
  error estimate for blocks of size 2^( 6) =       0.000429781525
  error estimate for blocks of size 2^( 7) =       0.000430440637

      target function =                  N/A
              le_mean =     -17.216965630870
             les_mean =     296.741781504507
             stat err =       0.000427484531
             autocorr =       1.149775072654
              std dev =       0.563805045118
             le_variance =       0.317876128901


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216965630870        initial  <--
     2.3283e+05     2.3283e+06             1.2634e-09       -17.216965630866
     9.3132e+05     9.3132e+06             3.1586e-10       -17.216965630868
     3.7253e+06     3.7253e+07             7.8965e-11       -17.216965630870

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2367
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0455
    reference variance = 2.04279
====================================================
  Execution time = 2.0237e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2027e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319948313327
                                         uncertainty =       0.003479867345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319948313327
                                         uncertainty =       0.003479867345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400170195
  error estimate for blocks of size 2^( 2) =       0.000409770338
  error estimate for blocks of size 2^( 3) =       0.000417835565
  error estimate for blocks of size 2^( 4) =       0.000424221266
  error estimate for blocks of size 2^( 5) =       0.000428599118
  error estimate for blocks of size 2^( 6) =       0.000430450422
  error estimate for blocks of size 2^( 7) =       0.000432553197

      target function =                  N/A
              le_mean =     -17.216998092088
             les_mean =     296.745295512620
             stat err =       0.000428956001
             autocorr =       1.149042303169
              std dev =       0.565926116914
             le_variance =       0.320272369806


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699809209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216998092088       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216998092087       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216998092088       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216998092087       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216998091737       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216998092094       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216998094008       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.206888e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216998092088       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216998092088       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216998092088       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216998094966       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216998092418       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216998098653       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216998092717       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.017161e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216998092088       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216998092088       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216998092088       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216998092088       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216998092088       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216998095280       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216998078914       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 7.542988e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5837e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1742
    reference variance = 0.186995
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2393e-01
  Total weights = 2.0000e+06
  Execution time = 1.8324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323927443128
                                         uncertainty =       0.004286075117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323927443128
                                         uncertainty =       0.004286075117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402449984
  error estimate for blocks of size 2^( 2) =       0.000412090468
  error estimate for blocks of size 2^( 3) =       0.000421189370
  error estimate for blocks of size 2^( 4) =       0.000426974850
  error estimate for blocks of size 2^( 5) =       0.000431126358
  error estimate for blocks of size 2^( 6) =       0.000433447639
  error estimate for blocks of size 2^( 7) =       0.000435160127

      target function =                  N/A
              le_mean =     -17.216652922232
             les_mean =     296.737069662495
             stat err =       0.000431677244
             autocorr =       1.150520814747
              std dev =       0.569150226101
             le_variance =       0.323931979871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323927443107
                                         uncertainty =       0.004286075116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323927443107
                                         uncertainty =       0.004286075116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402449984
  error estimate for blocks of size 2^( 2) =       0.000412090467
  error estimate for blocks of size 2^( 3) =       0.000421189370
  error estimate for blocks of size 2^( 4) =       0.000426974850
  error estimate for blocks of size 2^( 5) =       0.000431126358
  error estimate for blocks of size 2^( 6) =       0.000433447639
  error estimate for blocks of size 2^( 7) =       0.000435160127

      target function =                  N/A
              le_mean =     -17.216652922232
             les_mean =     296.737069662468
             stat err =       0.000431677244
             autocorr =       1.150520814752
              std dev =       0.569150226083
             le_variance =       0.323931979850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323927443118
                                         uncertainty =       0.004286075116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323927443118
                                         uncertainty =       0.004286075116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402449984
  error estimate for blocks of size 2^( 2) =       0.000412090467
  error estimate for blocks of size 2^( 3) =       0.000421189370
  error estimate for blocks of size 2^( 4) =       0.000426974850
  error estimate for blocks of size 2^( 5) =       0.000431126358
  error estimate for blocks of size 2^( 6) =       0.000433447639
  error estimate for blocks of size 2^( 7) =       0.000435160127

      target function =                  N/A
              le_mean =     -17.216652922232
             les_mean =     296.737069662482
             stat err =       0.000431677244
             autocorr =       1.150520814756
              std dev =       0.569150226092
             le_variance =       0.323931979861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323927443127
                                         uncertainty =       0.004286075117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323927443127
                                         uncertainty =       0.004286075117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402449984
  error estimate for blocks of size 2^( 2) =       0.000412090468
  error estimate for blocks of size 2^( 3) =       0.000421189370
  error estimate for blocks of size 2^( 4) =       0.000426974850
  error estimate for blocks of size 2^( 5) =       0.000431126358
  error estimate for blocks of size 2^( 6) =       0.000433447639
  error estimate for blocks of size 2^( 7) =       0.000435160127

      target function =                  N/A
              le_mean =     -17.216652922232
             les_mean =     296.737069662494
             stat err =       0.000431677244
             autocorr =       1.150520814745
              std dev =       0.569150226100
             le_variance =       0.323931979870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216652922232        initial  <--
     2.3283e+06     2.3283e+07             1.2069e-10       -17.216652922232
     9.3132e+06     9.3132e+07             3.0172e-11       -17.216652922232
     3.7253e+07     3.7253e+08             7.5430e-12       -17.216652922232

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3131
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2535
    reference variance = 0.300777
====================================================
  Execution time = 2.0306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1987e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319969524413
                                         uncertainty =       0.004153331634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319969524413
                                         uncertainty =       0.004153331634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399915987
  error estimate for blocks of size 2^( 2) =       0.000409293598
  error estimate for blocks of size 2^( 3) =       0.000418115753
  error estimate for blocks of size 2^( 4) =       0.000424280779
  error estimate for blocks of size 2^( 5) =       0.000429602011
  error estimate for blocks of size 2^( 6) =       0.000430745385
  error estimate for blocks of size 2^( 7) =       0.000433519613

      target function =                  N/A
              le_mean =     -17.216462136274
             les_mean =     296.726433922659
             stat err =       0.000429536947
             autocorr =       1.153621977482
              std dev =       0.565566612192
             le_variance =       0.319865592826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646213627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216462136274       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216462136274       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216462136274       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216462136274       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216462134860       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216462146988       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216462135452       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.163327e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216462136274       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216462136274       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216462136274       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216462062734       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216462120679       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216462217755       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216462052000       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 2.908056e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216462136274       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216462136274       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216462136274       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216462050977       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216462158049       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216462070975       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216462327046       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 7.272004e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5855e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2312
    reference variance = 0.224162
====================================================
  Execution time = 2.2245e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1687e-01
  Total weights = 2.0000e+06
  Execution time = 1.8286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760793793
                                         uncertainty =       0.004398080075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760793793
                                         uncertainty =       0.004398080075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398040316
  error estimate for blocks of size 2^( 2) =       0.000407824892
  error estimate for blocks of size 2^( 3) =       0.000416895269
  error estimate for blocks of size 2^( 4) =       0.000423730357
  error estimate for blocks of size 2^( 5) =       0.000427686100
  error estimate for blocks of size 2^( 6) =       0.000428866073
  error estimate for blocks of size 2^( 7) =       0.000429526431

      target function =                  N/A
              le_mean =     -17.216219733212
             les_mean =     296.715093930253
             stat err =       0.000427452240
             autocorr =       1.153243644710
              std dev =       0.562914013375
             le_variance =       0.316872186453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760793788
                                         uncertainty =       0.004398080075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760793788
                                         uncertainty =       0.004398080075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398040316
  error estimate for blocks of size 2^( 2) =       0.000407824892
  error estimate for blocks of size 2^( 3) =       0.000416895269
  error estimate for blocks of size 2^( 4) =       0.000423730357
  error estimate for blocks of size 2^( 5) =       0.000427686100
  error estimate for blocks of size 2^( 6) =       0.000428866073
  error estimate for blocks of size 2^( 7) =       0.000429526431

      target function =                  N/A
              le_mean =     -17.216219733212
             les_mean =     296.715093930246
             stat err =       0.000427452240
             autocorr =       1.153243644706
              std dev =       0.562914013370
             le_variance =       0.316872186448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760793791
                                         uncertainty =       0.004398080075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760793791
                                         uncertainty =       0.004398080075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398040316
  error estimate for blocks of size 2^( 2) =       0.000407824892
  error estimate for blocks of size 2^( 3) =       0.000416895269
  error estimate for blocks of size 2^( 4) =       0.000423730357
  error estimate for blocks of size 2^( 5) =       0.000427686100
  error estimate for blocks of size 2^( 6) =       0.000428866073
  error estimate for blocks of size 2^( 7) =       0.000429526431

      target function =                  N/A
              le_mean =     -17.216219733212
             les_mean =     296.715093930250
             stat err =       0.000427452240
             autocorr =       1.153243644710
              std dev =       0.562914013372
             le_variance =       0.316872186451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760793793
                                         uncertainty =       0.004398080075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316760793793
                                         uncertainty =       0.004398080075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398040316
  error estimate for blocks of size 2^( 2) =       0.000407824892
  error estimate for blocks of size 2^( 3) =       0.000416895269
  error estimate for blocks of size 2^( 4) =       0.000423730357
  error estimate for blocks of size 2^( 5) =       0.000427686100
  error estimate for blocks of size 2^( 6) =       0.000428866073
  error estimate for blocks of size 2^( 7) =       0.000429526431

      target function =                  N/A
              le_mean =     -17.216219733212
             les_mean =     296.715093930253
             stat err =       0.000427452240
             autocorr =       1.153243644718
              std dev =       0.562914013374
             le_variance =       0.316872186453


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216219733212        initial  <--
     2.3283e+07     2.3283e+08             1.1633e-11       -17.216219733212
     9.3132e+07     9.3132e+08             2.9081e-12       -17.216219733212
     3.7253e+08     3.7253e+09             7.2720e-13       -17.216219733212

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4454
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7305e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2579
    reference variance = 0.316396
====================================================
  Execution time = 2.0359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1680e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316859060610
                                         uncertainty =       0.003401811658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316859060610
                                         uncertainty =       0.003401811658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397992971
  error estimate for blocks of size 2^( 2) =       0.000408043516
  error estimate for blocks of size 2^( 3) =       0.000416820073
  error estimate for blocks of size 2^( 4) =       0.000423047350
  error estimate for blocks of size 2^( 5) =       0.000426679751
  error estimate for blocks of size 2^( 6) =       0.000428219345
  error estimate for blocks of size 2^( 7) =       0.000430798987

      target function =                  N/A
              le_mean =     -17.215881048792
             les_mean =     296.703356937633
             stat err =       0.000427186358
             autocorr =       1.152083475019
              std dev =       0.562847057255
             le_variance =       0.316796809861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721588104879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215881048792       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215881048792       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215881048792       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215881048792       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215881067508       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215881048792       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215880935873       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.034337e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215881048792       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215881048792       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215881048792       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215881048792       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215881048792       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215881028400       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215881152211       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 2.585926e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215881048792       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215881048792       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215881048792       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215881048792       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215881871408       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215883658444       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215882019406       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 6.444759e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5890e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2297
    reference variance = 0.343977
====================================================
  Execution time = 1.9850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1380e-01
  Total weights = 2.0000e+06
  Execution time = 1.8334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313815246956
                                         uncertainty =       0.002397164957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313815246956
                                         uncertainty =       0.002397164957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396104162
  error estimate for blocks of size 2^( 2) =       0.000405484437
  error estimate for blocks of size 2^( 3) =       0.000414127619
  error estimate for blocks of size 2^( 4) =       0.000420113214
  error estimate for blocks of size 2^( 5) =       0.000424600000
  error estimate for blocks of size 2^( 6) =       0.000426429644
  error estimate for blocks of size 2^( 7) =       0.000427999484

      target function =                  N/A
              le_mean =     -17.216391535779
             les_mean =     296.717934370042
             stat err =       0.000424785586
             autocorr =       1.150060618306
              std dev =       0.560175877479
             le_variance =       0.313797013709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313815246956
                                         uncertainty =       0.002397164957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313815246956
                                         uncertainty =       0.002397164957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396104162
  error estimate for blocks of size 2^( 2) =       0.000405484437
  error estimate for blocks of size 2^( 3) =       0.000414127619
  error estimate for blocks of size 2^( 4) =       0.000420113214
  error estimate for blocks of size 2^( 5) =       0.000424600000
  error estimate for blocks of size 2^( 6) =       0.000426429644
  error estimate for blocks of size 2^( 7) =       0.000427999484

      target function =                  N/A
              le_mean =     -17.216391535779
             les_mean =     296.717934370042
             stat err =       0.000424785586
             autocorr =       1.150060618299
              std dev =       0.560175877479
             le_variance =       0.313797013709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313815246956
                                         uncertainty =       0.002397164957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313815246956
                                         uncertainty =       0.002397164957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396104162
  error estimate for blocks of size 2^( 2) =       0.000405484437
  error estimate for blocks of size 2^( 3) =       0.000414127619
  error estimate for blocks of size 2^( 4) =       0.000420113214
  error estimate for blocks of size 2^( 5) =       0.000424600000
  error estimate for blocks of size 2^( 6) =       0.000426429644
  error estimate for blocks of size 2^( 7) =       0.000427999484

      target function =                  N/A
              le_mean =     -17.216391535779
             les_mean =     296.717934370043
             stat err =       0.000424785586
             autocorr =       1.150060618299
              std dev =       0.560175877479
             le_variance =       0.313797013709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313815246956
                                         uncertainty =       0.002397164957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313815246956
                                         uncertainty =       0.002397164957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396104162
  error estimate for blocks of size 2^( 2) =       0.000405484437
  error estimate for blocks of size 2^( 3) =       0.000414127619
  error estimate for blocks of size 2^( 4) =       0.000420113214
  error estimate for blocks of size 2^( 5) =       0.000424600000
  error estimate for blocks of size 2^( 6) =       0.000426429644
  error estimate for blocks of size 2^( 7) =       0.000427999484

      target function =                  N/A
              le_mean =     -17.216391535779
             les_mean =     296.717934370043
             stat err =       0.000424785586
             autocorr =       1.150060618304
              std dev =       0.560175877479
             le_variance =       0.313797013709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216391535779        initial  <--
     2.3283e+08     2.3283e+09             1.0343e-12       -17.216391535779
     9.3132e+08     9.3132e+09             2.5859e-13       -17.216391535779
     3.7253e+09     3.7253e+10             6.4448e-14       -17.216391535779

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0846
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4979e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2747
    reference variance = 0.551437
====================================================
  Execution time = 2.0368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327137626438
                                         uncertainty =       0.005706958637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327137626438
                                         uncertainty =       0.005706958637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404370482
  error estimate for blocks of size 2^( 2) =       0.000413981762
  error estimate for blocks of size 2^( 3) =       0.000422671381
  error estimate for blocks of size 2^( 4) =       0.000429249515
  error estimate for blocks of size 2^( 5) =       0.000432212377
  error estimate for blocks of size 2^( 6) =       0.000435100998
  error estimate for blocks of size 2^( 7) =       0.000436066931

      target function =                  N/A
              le_mean =     -17.216661771238
             les_mean =     296.740473355738
             stat err =       0.000433157455
             autocorr =       1.147447158442
              std dev =       0.571866220395
             le_variance =       0.327030974029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666177124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216661771238       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661771238       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216661771238       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216661673232       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216661757735       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216661109444       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216662257692       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 8.858303e-14

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216661771238       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661771238       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216661771238       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216661771238       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216666036387       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216664537375       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216657273578       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216659704914       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 2.226276e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216661771238       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661771238       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216661771238       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216685873598       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216544317169       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216757066882       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216538761999       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216798170198       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216864211299       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216555418102       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216331633630       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215730644617       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216467453018       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215837181515       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215170887722       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214966467091       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.221013735885       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216888575555       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215942387112       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213780279811       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217270171703       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214906180730       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.218719925691       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216872487959       residual = 6.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.224299711728       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.227860291430       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.211454306619       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.220277732421       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.227977684632       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.382219456832       residual = 4.07e+00           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.206707092134       residual = 1.75e-02           smallest_sin_value = 9.90e-01
davidson iteration   31 stopping due to small subspace S singular value of 8.70e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 3.050172e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121869 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5916e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0928
    reference variance = 0.804976
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.5451e-01
  Total weights = 2.0000e+06
  Execution time = 1.8346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354625612739
                                         uncertainty =       0.036594103212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354625612739
                                         uncertainty =       0.036594103212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421014607
  error estimate for blocks of size 2^( 2) =       0.000429829510
  error estimate for blocks of size 2^( 3) =       0.000437885024
  error estimate for blocks of size 2^( 4) =       0.000443919736
  error estimate for blocks of size 2^( 5) =       0.000448694281
  error estimate for blocks of size 2^( 6) =       0.000453011854
  error estimate for blocks of size 2^( 7) =       0.000454605048

      target function =                  N/A
              le_mean =     -17.217130494765
             les_mean =     296.784088895092
             stat err =       0.000450057730
             autocorr =       1.142726037003
              std dev =       0.595404567159
             le_variance =       0.354506598594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354625612739
                                         uncertainty =       0.036594103212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354625612739
                                         uncertainty =       0.036594103212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421014607
  error estimate for blocks of size 2^( 2) =       0.000429829510
  error estimate for blocks of size 2^( 3) =       0.000437885024
  error estimate for blocks of size 2^( 4) =       0.000443919736
  error estimate for blocks of size 2^( 5) =       0.000448694281
  error estimate for blocks of size 2^( 6) =       0.000453011854
  error estimate for blocks of size 2^( 7) =       0.000454605048

      target function =                  N/A
              le_mean =     -17.217130494765
             les_mean =     296.784088895092
             stat err =       0.000450057730
             autocorr =       1.142726037003
              std dev =       0.595404567159
             le_variance =       0.354506598594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354625612739
                                         uncertainty =       0.036594103212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354625612739
                                         uncertainty =       0.036594103212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421014607
  error estimate for blocks of size 2^( 2) =       0.000429829510
  error estimate for blocks of size 2^( 3) =       0.000437885024
  error estimate for blocks of size 2^( 4) =       0.000443919736
  error estimate for blocks of size 2^( 5) =       0.000448694281
  error estimate for blocks of size 2^( 6) =       0.000453011854
  error estimate for blocks of size 2^( 7) =       0.000454605048

      target function =                  N/A
              le_mean =     -17.217130494765
             les_mean =     296.784088895092
             stat err =       0.000450057730
             autocorr =       1.142726037002
              std dev =       0.595404567159
             le_variance =       0.354506598594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354625612739
                                         uncertainty =       0.036594103212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354625612739
                                         uncertainty =       0.036594103212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421014607
  error estimate for blocks of size 2^( 2) =       0.000429829510
  error estimate for blocks of size 2^( 3) =       0.000437885024
  error estimate for blocks of size 2^( 4) =       0.000443919736
  error estimate for blocks of size 2^( 5) =       0.000448694281
  error estimate for blocks of size 2^( 6) =       0.000453011854
  error estimate for blocks of size 2^( 7) =       0.000454605048

      target function =                  N/A
              le_mean =     -17.217130494765
             les_mean =     296.784088895092
             stat err =       0.000450057730
             autocorr =       1.142726037008
              std dev =       0.595404567159
             le_variance =       0.354506598594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217130494765        initial  <--
     2.3283e+09     2.3283e+10             8.8583e-14       -17.217130494765
     9.3132e+09     9.3132e+10             2.2263e-14       -17.217130494765
     3.7253e+10     3.7253e+11             3.0502e-15       -17.217130494765

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.2241
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2764
    reference variance = 0.489451
====================================================
  Execution time = 2.0300e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1698e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316986742978
                                         uncertainty =       0.002856918548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316986742978
                                         uncertainty =       0.002856918548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398105615
  error estimate for blocks of size 2^( 2) =       0.000407559674
  error estimate for blocks of size 2^( 3) =       0.000416021489
  error estimate for blocks of size 2^( 4) =       0.000422770660
  error estimate for blocks of size 2^( 5) =       0.000426877088
  error estimate for blocks of size 2^( 6) =       0.000428198142
  error estimate for blocks of size 2^( 7) =       0.000429124158

      target function =                  N/A
              le_mean =     -17.217062146862
             les_mean =     296.744204972435
             stat err =       0.000426742512
             autocorr =       1.149040168494
              std dev =       0.563006360553
             le_variance =       0.316976162023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721706214686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217062146862       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217062146862       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217062146862       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217062146862       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217062146862       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217064508179       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217084004867       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217120889511       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217089424927       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217062883979       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217161837627       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216734467470       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217089276976       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217396130807       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217432829165       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.218560992592       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216555927449       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218622417176       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216366353467       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216153802716       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.219551381002       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215707589477       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.220163440625       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217409784862       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.221273944963       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.221537255967       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.208194079415       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.219997474112       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.227974967450       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.216114495198       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.255369928801       residual = 2.16e-01           smallest_sin_value = 9.99e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 1.337503e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217062146862       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217062146862       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217062146862       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217062134956       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217032763290       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217063490567       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217057215270       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217058665152       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216999686740       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217234518660       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217126443564       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215994177746       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217036748731       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216751847584       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215113809066       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217252116249       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216630233273       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216465011433       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217697760575       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.220240141701       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217042935729       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215027366912       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217683995866       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.218666620720       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.240425109673       residual = 8.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.212427826448       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.226749356134       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.169786077674       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.203225503710       residual = 4.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.293850749293       residual = 9.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.502877477605       residual = 1.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.229657622808       residual = 1.10e-01           smallest_sin_value = 9.98e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 3.316150e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217062146862       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217062146862       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217062146862       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217062146862       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217212598263       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217158265650       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213824124231       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.218313749325       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215177842048       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215800624208       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214233774169       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.226650454727       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.201800297761       residual = 3.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.197058239547       residual = 6.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.207096217838       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217450400771       residual = 4.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.180899446459       residual = 2.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217594561628       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.286843248801       residual = 7.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.211965430035       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.194298484993       residual = 8.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.173877419456       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.252209376506       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.239659238657       residual = 7.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.188224584538       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.153868241739       residual = 5.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.225720459652       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.328802885294       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.841486634714       residual = 6.00e+01           smallest_sin_value = 9.99e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 5.131495e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5932e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1917
    reference variance = 0.152082
====================================================
  Execution time = 1.9954e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1823e-01
  Total weights = 2.0000e+06
  Execution time = 1.8284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318326889336
                                         uncertainty =       0.003319871692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318326889336
                                         uncertainty =       0.003319871692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398894119
  error estimate for blocks of size 2^( 2) =       0.000408433170
  error estimate for blocks of size 2^( 3) =       0.000417570099
  error estimate for blocks of size 2^( 4) =       0.000423267585
  error estimate for blocks of size 2^( 5) =       0.000426821457
  error estimate for blocks of size 2^( 6) =       0.000428547477
  error estimate for blocks of size 2^( 7) =       0.000428197751

      target function =                  N/A
              le_mean =     -17.217126322033
             les_mean =     296.747671666676
             stat err =       0.000426708567
             autocorr =       1.144319918908
              std dev =       0.564121473574
             le_variance =       0.318233036947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318326889336
                                         uncertainty =       0.003319871692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318326889336
                                         uncertainty =       0.003319871692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398894119
  error estimate for blocks of size 2^( 2) =       0.000408433170
  error estimate for blocks of size 2^( 3) =       0.000417570099
  error estimate for blocks of size 2^( 4) =       0.000423267585
  error estimate for blocks of size 2^( 5) =       0.000426821457
  error estimate for blocks of size 2^( 6) =       0.000428547477
  error estimate for blocks of size 2^( 7) =       0.000428197751

      target function =                  N/A
              le_mean =     -17.217126322033
             les_mean =     296.747671666676
             stat err =       0.000426708567
             autocorr =       1.144319918910
              std dev =       0.564121473574
             le_variance =       0.318233036947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318326889336
                                         uncertainty =       0.003319871692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318326889336
                                         uncertainty =       0.003319871692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398894119
  error estimate for blocks of size 2^( 2) =       0.000408433170
  error estimate for blocks of size 2^( 3) =       0.000417570099
  error estimate for blocks of size 2^( 4) =       0.000423267585
  error estimate for blocks of size 2^( 5) =       0.000426821457
  error estimate for blocks of size 2^( 6) =       0.000428547477
  error estimate for blocks of size 2^( 7) =       0.000428197751

      target function =                  N/A
              le_mean =     -17.217126322033
             les_mean =     296.747671666676
             stat err =       0.000426708567
             autocorr =       1.144319918915
              std dev =       0.564121473574
             le_variance =       0.318233036947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318326889336
                                         uncertainty =       0.003319871692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318326889336
                                         uncertainty =       0.003319871692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398894119
  error estimate for blocks of size 2^( 2) =       0.000408433170
  error estimate for blocks of size 2^( 3) =       0.000417570099
  error estimate for blocks of size 2^( 4) =       0.000423267585
  error estimate for blocks of size 2^( 5) =       0.000426821457
  error estimate for blocks of size 2^( 6) =       0.000428547477
  error estimate for blocks of size 2^( 7) =       0.000428197751

      target function =                  N/A
              le_mean =     -17.217126322033
             les_mean =     296.747671666676
             stat err =       0.000426708567
             autocorr =       1.144319918913
              std dev =       0.564121473574
             le_variance =       0.318233036947


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217126322033        initial  <--
     2.3283e+10     2.3283e+11             1.3375e-14       -17.217126322033
     9.3132e+10     9.3132e+11             3.3162e-15       -17.217126322033
     3.7253e+11     3.7253e+12             5.1315e-16       -17.217126322033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1659
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1938
    reference variance = 0.204565
====================================================
  Execution time = 2.0453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1517e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314775756826
                                         uncertainty =       0.002728871255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314775756826
                                         uncertainty =       0.002728871255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396972240
  error estimate for blocks of size 2^( 2) =       0.000406786882
  error estimate for blocks of size 2^( 3) =       0.000415129755
  error estimate for blocks of size 2^( 4) =       0.000421541658
  error estimate for blocks of size 2^( 5) =       0.000424549179
  error estimate for blocks of size 2^( 6) =       0.000425741611
  error estimate for blocks of size 2^( 7) =       0.000425678585

      target function =                  N/A
              le_mean =     -17.217037469437
             les_mean =     296.741552984801
             stat err =       0.000424377758
             autocorr =       1.142838738135
              std dev =       0.561403525456
             le_variance =       0.315173918395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721703746944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217037469437       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217037469437       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217037469437       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217067307096       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217011527043       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216951791487       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217231691914       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216194938864       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217442183604       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216419089224       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216467031811       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.219996969602       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211883397613       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215266809007       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.219852027450       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211894930473       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.188690038828       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215979017958       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216474434890       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.209372251619       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213156762832       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.235875466685       residual = 6.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.225028978944       residual = 9.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217623817491       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.209166159538       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.133434405750       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.218353770884       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.327221160130       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.142264584971       residual = 8.48e-01           smallest_sin_value = 9.98e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+11 is 6.929374e-16

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217037469437       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217037469437       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217037469437       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217044010671       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216714117244       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.221136510047       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216116064762       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.220941992583       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.225111777726       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.225702602995       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211741559064       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216823315713       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.205853995888       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.207834461495       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.224150411045       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.291091884404       residual = 8.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.192097482219       residual = 9.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.212679313574       residual = 9.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.227230109266       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.263286665839       residual = 3.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.296207291641       residual = 9.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.308620806209       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.285975351548       residual = 7.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.565642621070       residual = 1.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.164386688201       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.421136718583       residual = 6.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.156266495669       residual = 9.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.107813821115       residual = 1.78e+00           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.503264601870       residual = 1.21e+01           smallest_sin_value = 9.93e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.33e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+11 is 4.659551e-17

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217037469437       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217037469437       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217037469437       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217037469437       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214976370814       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214138062990       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217694596324       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.209102883935       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.145419381067       residual = 7.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.234206223622       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.129882985653       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.273831081579       residual = 4.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.121318051768       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.244027245330       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.197168671446       residual = 5.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.501523478444       residual = 1.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.357034543736       residual = 3.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.071981226677       residual = 3.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.409250781421       residual = 5.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.102072388283       residual = 2.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.325484669900       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.927290011259       residual = 7.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.454831432045       residual = 8.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.141939040068       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.290448667209       residual = 1.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -15.405481420928       residual = 5.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.244039209479       residual = 6.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.232118787505       residual = 8.98e+00           smallest_sin_value = 9.99e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+12 is 1.164888e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6023e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.3752
    reference variance = 0.536509
====================================================
  Execution time = 2.0211e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1736e-01
  Total weights = 2.0000e+06
  Execution time = 1.8364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317382682680
                                         uncertainty =       0.004375477363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317382682680
                                         uncertainty =       0.004375477363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398348409
  error estimate for blocks of size 2^( 2) =       0.000408035475
  error estimate for blocks of size 2^( 3) =       0.000416753962
  error estimate for blocks of size 2^( 4) =       0.000422975889
  error estimate for blocks of size 2^( 5) =       0.000427474342
  error estimate for blocks of size 2^( 6) =       0.000428638741
  error estimate for blocks of size 2^( 7) =       0.000429840909

      target function =                  N/A
              le_mean =     -17.216705271174
             les_mean =     296.732303145259
             stat err =       0.000427232470
             autocorr =       1.150276722510
              std dev =       0.563349722177
             le_variance =       0.317362909476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317382682680
                                         uncertainty =       0.004375477363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317382682680
                                         uncertainty =       0.004375477363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398348409
  error estimate for blocks of size 2^( 2) =       0.000408035475
  error estimate for blocks of size 2^( 3) =       0.000416753962
  error estimate for blocks of size 2^( 4) =       0.000422975889
  error estimate for blocks of size 2^( 5) =       0.000427474342
  error estimate for blocks of size 2^( 6) =       0.000428638741
  error estimate for blocks of size 2^( 7) =       0.000429840909

      target function =                  N/A
              le_mean =     -17.216705271174
             les_mean =     296.732303145259
             stat err =       0.000427232470
             autocorr =       1.150276722513
              std dev =       0.563349722177
             le_variance =       0.317362909476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317382682680
                                         uncertainty =       0.004375477363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317382682680
                                         uncertainty =       0.004375477363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398348409
  error estimate for blocks of size 2^( 2) =       0.000408035475
  error estimate for blocks of size 2^( 3) =       0.000416753962
  error estimate for blocks of size 2^( 4) =       0.000422975889
  error estimate for blocks of size 2^( 5) =       0.000427474342
  error estimate for blocks of size 2^( 6) =       0.000428638741
  error estimate for blocks of size 2^( 7) =       0.000429840909

      target function =                  N/A
              le_mean =     -17.216705271174
             les_mean =     296.732303145259
             stat err =       0.000427232470
             autocorr =       1.150276722511
              std dev =       0.563349722177
             le_variance =       0.317362909476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317382682680
                                         uncertainty =       0.004375477363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317382682680
                                         uncertainty =       0.004375477363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398348409
  error estimate for blocks of size 2^( 2) =       0.000408035475
  error estimate for blocks of size 2^( 3) =       0.000416753962
  error estimate for blocks of size 2^( 4) =       0.000422975889
  error estimate for blocks of size 2^( 5) =       0.000427474342
  error estimate for blocks of size 2^( 6) =       0.000428638741
  error estimate for blocks of size 2^( 7) =       0.000429840909

      target function =                  N/A
              le_mean =     -17.216705271174
             les_mean =     296.732303145259
             stat err =       0.000427232470
             autocorr =       1.150276722509
              std dev =       0.563349722177
             le_variance =       0.317362909477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216705271174        initial  <--
     2.3283e+11     2.3283e+12             6.9294e-16       -17.216705271174
     9.3132e+11     9.3132e+12             4.6596e-17       -17.216705271174
     3.7253e+12     3.7253e+13             1.1649e-17       -17.216705271174

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4910
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5518e+01 secs
  Total Execution time = 2.2442e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
