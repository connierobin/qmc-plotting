Rank =    0  Free Memory = 67381 MB
Rank =    1  Free Memory = 67378 MB
Rank =    2  Free Memory = 67377 MB
Rank =    3  Free Memory = 67377 MB
Rank =    4  Free Memory = 67377 MB
Rank =    5  Free Memory = 67377 MB
Rank =    6  Free Memory = 67376 MB
Rank =    7  Free Memory = 67376 MB
Rank =    8  Free Memory = 67376 MB
Rank =    9  Free Memory = 67375 MB
Rank =   10  Free Memory = 67375 MB
Rank =   11  Free Memory = 67375 MB
Rank =   12  Free Memory = 67375 MB
Rank =   13  Free Memory = 67375 MB
Rank =   14  Free Memory = 67375 MB
Rank =   15  Free Memory = 67361 MB
Rank =   16  Free Memory = 67358 MB
Rank =   17  Free Memory = 67358 MB
Rank =   18  Free Memory = 67358 MB
Rank =   19  Free Memory = 67358 MB
Rank =   20  Free Memory = 67358 MB
Rank =   21  Free Memory = 67358 MB
Rank =   22  Free Memory = 67358 MB
Rank =   23  Free Memory = 67358 MB
Rank =   24  Free Memory = 67358 MB
Rank =   25  Free Memory = 67358 MB
Rank =   26  Free Memory = 67358 MB
Rank =   27  Free Memory = 67358 MB
Rank =   28  Free Memory = 67358 MB
Rank =   29  Free Memory = 67358 MB
Rank =   30  Free Memory = 67358 MB
Rank =   31  Free Memory = 67358 MB
Rank =   32  Free Memory = 67358 MB
Rank =   33  Free Memory = 67358 MB
Rank =   34  Free Memory = 67358 MB
Rank =   35  Free Memory = 67357 MB
Rank =   36  Free Memory = 67357 MB
Rank =   37  Free Memory = 67357 MB
Rank =   38  Free Memory = 67357 MB
Rank =   39  Free Memory = 67357 MB
Rank =   40  Free Memory = 71569 MB
Rank =   41  Free Memory = 71569 MB
Rank =   42  Free Memory = 71569 MB
Rank =   43  Free Memory = 71569 MB
Rank =   44  Free Memory = 71569 MB
Rank =   45  Free Memory = 71569 MB
Rank =   46  Free Memory = 71569 MB
Rank =   47  Free Memory = 71569 MB
Rank =   48  Free Memory = 71569 MB
Rank =   49  Free Memory = 71568 MB
Rank =   50  Free Memory = 71568 MB
Rank =   51  Free Memory = 71568 MB
Rank =   52  Free Memory = 71568 MB
Rank =   53  Free Memory = 71568 MB
Rank =   54  Free Memory = 71568 MB
Rank =   55  Free Memory = 71568 MB
Rank =   56  Free Memory = 71568 MB
Rank =   57  Free Memory = 71568 MB
Rank =   58  Free Memory = 71568 MB
Rank =   59  Free Memory = 71568 MB
Rank =   60  Free Memory = 71568 MB
Rank =   61  Free Memory = 71568 MB
Rank =   62  Free Memory = 71568 MB
Rank =   63  Free Memory = 71568 MB
Rank =   64  Free Memory = 71568 MB
Rank =   65  Free Memory = 71568 MB
Rank =   66  Free Memory = 71568 MB
Rank =   67  Free Memory = 71568 MB
Rank =   68  Free Memory = 71568 MB
Rank =   69  Free Memory = 71568 MB
Rank =   70  Free Memory = 71568 MB
Rank =   71  Free Memory = 71568 MB
Rank =   72  Free Memory = 71568 MB
Rank =   73  Free Memory = 71568 MB
Rank =   74  Free Memory = 71568 MB
Rank =   75  Free Memory = 71568 MB
Rank =   76  Free Memory = 71568 MB
Rank =   77  Free Memory = 71568 MB
Rank =   78  Free Memory = 71568 MB
Rank =   79  Free Memory = 71568 MB
Rank =   80  Free Memory = 75205 MB
Rank =   81  Free Memory = 75205 MB
Rank =   82  Free Memory = 75205 MB
Rank =   83  Free Memory = 75205 MB
Rank =   84  Free Memory = 75205 MB
Rank =   85  Free Memory = 75205 MB
Rank =   86  Free Memory = 75205 MB
Rank =   87  Free Memory = 75205 MB
Rank =   88  Free Memory = 75205 MB
Rank =   89  Free Memory = 75205 MB
Rank =   90  Free Memory = 75205 MB
Rank =   91  Free Memory = 75205 MB
Rank =   92  Free Memory = 75205 MB
Rank =   93  Free Memory = 75205 MB
Rank =   94  Free Memory = 75205 MB
Rank =   95  Free Memory = 75205 MB
Rank =   96  Free Memory = 75205 MB
Rank =   97  Free Memory = 75205 MB
Rank =   98  Free Memory = 75205 MB
Rank =   99  Free Memory = 75204 MB
Rank =  100  Free Memory = 75204 MB
Rank =  101  Free Memory = 75204 MB
Rank =  102  Free Memory = 75204 MB
Rank =  103  Free Memory = 75204 MB
Rank =  104  Free Memory = 75204 MB
Rank =  105  Free Memory = 75204 MB
Rank =  106  Free Memory = 75204 MB
Rank =  107  Free Memory = 75204 MB
Rank =  108  Free Memory = 75204 MB
Rank =  109  Free Memory = 75204 MB
Rank =  110  Free Memory = 75204 MB
Rank =  111  Free Memory = 75203 MB
Rank =  112  Free Memory = 75203 MB
Rank =  113  Free Memory = 75203 MB
Rank =  114  Free Memory = 75203 MB
Rank =  115  Free Memory = 75203 MB
Rank =  116  Free Memory = 75203 MB
Rank =  117  Free Memory = 75203 MB
Rank =  118  Free Memory = 75203 MB
Rank =  119  Free Memory = 75203 MB
Rank =  120  Free Memory = 70123 MB
Rank =  121  Free Memory = 70123 MB
  Input file(s): opt_h2o_1b1_gvptt_run002r.xml 
Rank =  122  Free Memory = 70123 MB
Rank =  127  Free Memory = 70123 MB
Rank =  123  Free Memory = 70123 MB
Rank =  124  Free Memory = 70123 MB
Rank =  125  Free Memory = 70123 MB
Rank =  126  Free Memory = 70123 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002r.xml

  Project = H2O
  date    = 2023-04-17 23:15:23 PDT
  host    = n0170.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 379

  Range of prime numbers to use as seeds over processors and threads = 2621-3637


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.091470e-01    1         1  ON     0
     uu_1                 1.427536e-01    1         1  ON     1
     uu_2                 4.132802e-02    1         1  ON     2
     uu_3                -2.109781e-02    1         1  ON     3
     uu_4                -6.616949e-02    1         1  ON     4
     uu_5                -1.002247e-01    1         1  ON     5
     uu_6                -1.268844e-01    1         1  ON     6
     uu_7                -1.398153e-01    1         1  ON     7
     uu_8                -1.320454e-01    1         1  ON     8
     uu_9                -1.020661e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.496162e-01    1         1  ON     0
     ud_1                 1.833616e-01    1         1  ON     1
     ud_2                 6.207938e-02    1         1  ON     2
     ud_3                -9.862251e-03    1         1  ON     3
     ud_4                -6.695652e-02    1         1  ON     4
     ud_5                -1.081720e-01    1         1  ON     5
     ud_6                -1.352314e-01    1         1  ON     6
     ud_7                -1.512314e-01    1         1  ON     7
     ud_8                -1.515949e-01    1         1  ON     8
     ud_9                -1.403381e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.654816e-01    1         1  ON     0
     eO_1                -4.430618e-01    1         1  ON     1
     eO_2                -2.033799e-02    1         1  ON     2
     eO_3                 3.021832e-01    1         1  ON     3
     eO_4                 5.276823e-01    1         1  ON     4
     eO_5                 4.870258e-01    1         1  ON     5
     eO_6                 2.567099e-01    1         1  ON     6
     eO_7                -4.610891e-02    1         1  ON     7
     eO_8                -2.198029e-01    1         1  ON     8
     eO_9                -7.874464e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.439988e-01    1         1  ON     0
     eH1_1                -1.430281e-01    1         1  ON     1
     eH1_2                -9.622624e-02    1         1  ON     2
     eH1_3                -4.199571e-02    1         1  ON     3
     eH1_4                 5.840212e-03    1         1  ON     4
     eH1_5                 4.022776e-02    1         1  ON     5
     eH1_6                 9.800089e-02    1         1  ON     6
     eH1_7                 1.513623e-01    1         1  ON     7
     eH1_8                 1.741854e-01    1         1  ON     8
     eH1_9                 5.972162e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.396082e-01    1         1  ON     0
     eH2_1                -1.392924e-01    1         1  ON     1
     eH2_2                -9.225741e-02    1         1  ON     2
     eH2_3                -3.809648e-02    1         1  ON     3
     eH2_4                 9.641697e-03    1         1  ON     4
     eH2_5                 4.295715e-02    1         1  ON     5
     eH2_6                 9.860463e-02    1         1  ON     6
     eH2_7                 1.505068e-01    1         1  ON     7
     eH2_8                 1.771436e-01    1         1  ON     8
     eH2_9                 4.758032e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.107708e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.0310e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 0.247277
====================================================
  Execution time = 2.0847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4195e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341943779660
                                         uncertainty =       0.006311523399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341943779660
                                         uncertainty =       0.006311523399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413492582
  error estimate for blocks of size 2^( 2) =       0.000426171034
  error estimate for blocks of size 2^( 3) =       0.000439144353
  error estimate for blocks of size 2^( 4) =       0.000451878114
  error estimate for blocks of size 2^( 5) =       0.000464053179
  error estimate for blocks of size 2^( 6) =       0.000472753073
  error estimate for blocks of size 2^( 7) =       0.000479398267

      target function =                  N/A
              le_mean =     -16.905562382173
             les_mean =     286.139991516665
             stat err =       0.000467020658
             autocorr =       1.275665288630
              std dev =       0.584766816859
             le_variance =       0.341952230100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690556238217e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905562382173       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905563858461       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905564460848       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905564145292       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905563874636       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905563621687       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905563366213       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905564046196       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905564220654       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905564192306       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.563009e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905562382173       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905562951578       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905563226397       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905563166182       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905563093681       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905563003311       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905562905218       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905563013678       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.342675e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905562382173       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905562546874       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905562635708       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905562628723       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905562615709       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905562586965       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905562565139       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905562582842       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.941351e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6438e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.093221e-01                 1 1 ON  0
uu_1  1.428108e-01                 1 1 ON  1
uu_2  4.129250e-02                 1 1 ON  2
uu_3  -2.110205e-02                1 1 ON  3
uu_4  -6.618715e-02                1 1 ON  4
uu_5  -1.003197e-01                1 1 ON  5
uu_6  -1.269409e-01                1 1 ON  6
uu_7  -1.398928e-01                1 1 ON  7
uu_8  -1.321265e-01                1 1 ON  8
uu_9  -1.021272e-01                1 1 ON  9
ud_0  4.496849e-01                 1 1 ON  10
ud_1  1.834402e-01                 1 1 ON  11
ud_2  6.210374e-02                 1 1 ON  12
ud_3  -9.870872e-03                1 1 ON  13
ud_4  -6.693645e-02                1 1 ON  14
ud_5  -1.081757e-01                1 1 ON  15
ud_6  -1.351962e-01                1 1 ON  16
ud_7  -1.513593e-01                1 1 ON  17
ud_8  -1.516249e-01                1 1 ON  18
ud_9  -1.403528e-01                1 1 ON  19
eO_0  -7.654802e-01                1 1 ON  20
eO_1  -4.430633e-01                1 1 ON  21
eO_2  -2.034727e-02                1 1 ON  22
eO_3  3.022018e-01                 1 1 ON  23
eO_4  5.277073e-01                 1 1 ON  24
eO_5  4.871477e-01                 1 1 ON  25
eO_6  2.567998e-01                 1 1 ON  26
eO_7  -4.609477e-02                1 1 ON  27
eO_8  -2.199334e-01                1 1 ON  28
eO_9  -7.885807e-02                1 1 ON  29
eH1_0 -2.442142e-01                1 1 ON  30
eH1_1 -1.431290e-01                1 1 ON  31
eH1_2 -9.632664e-02                1 1 ON  32
eH1_3 -4.204179e-02                1 1 ON  33
eH1_4 5.828687e-03                 1 1 ON  34
eH1_5 4.017719e-02                 1 1 ON  35
eH1_6 9.799035e-02                 1 1 ON  36
eH1_7 1.514502e-01                 1 1 ON  37
eH1_8 1.743727e-01                 1 1 ON  38
eH1_9 5.995589e-02                 1 1 ON  39
eH2_0 -2.397565e-01                1 1 ON  40
eH2_1 -1.393522e-01                1 1 ON  41
eH2_2 -9.226319e-02                1 1 ON  42
eH2_3 -3.823067e-02                1 1 ON  43
eH2_4 9.716282e-03                 1 1 ON  44
eH2_5 4.289972e-02                 1 1 ON  45
eH2_6 9.858778e-02                 1 1 ON  46
eH2_7 1.505979e-01                 1 1 ON  47
eH2_8 1.772339e-01                 1 1 ON  48
eH2_9 4.774575e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9252
    reference variance = 0.208261
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5284e-01
  Total weights = 2.0000e+06
  Execution time = 1.9040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352786072896
                                         uncertainty =       0.007323474039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352786072896
                                         uncertainty =       0.007323474039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419977337
  error estimate for blocks of size 2^( 2) =       0.000432374454
  error estimate for blocks of size 2^( 3) =       0.000444552588
  error estimate for blocks of size 2^( 4) =       0.000456311963
  error estimate for blocks of size 2^( 5) =       0.000467173173
  error estimate for blocks of size 2^( 6) =       0.000474254514
  error estimate for blocks of size 2^( 7) =       0.000479882426

      target function =                  N/A
              le_mean =     -16.906287400589
             les_mean =     286.175315421780
             stat err =       0.000469405519
             autocorr =       1.249236521697
              std dev =       0.593937645582
             le_variance =       0.352761926840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353008794294
                                         uncertainty =       0.007331230655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353008794294
                                         uncertainty =       0.007331230655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420109823
  error estimate for blocks of size 2^( 2) =       0.000432498866
  error estimate for blocks of size 2^( 3) =       0.000444670692
  error estimate for blocks of size 2^( 4) =       0.000456421985
  error estimate for blocks of size 2^( 5) =       0.000467278894
  error estimate for blocks of size 2^( 6) =       0.000474349729
  error estimate for blocks of size 2^( 7) =       0.000479981907

      target function =                  N/A
              le_mean =     -16.906285359930
             les_mean =     286.175469020921
             stat err =       0.000469508129
             autocorr =       1.248994596908
              std dev =       0.594125008761
             le_variance =       0.352984526036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352944980861
                                         uncertainty =       0.007327496083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352944980861
                                         uncertainty =       0.007327496083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420071866
  error estimate for blocks of size 2^( 2) =       0.000432462931
  error estimate for blocks of size 2^( 3) =       0.000444636970
  error estimate for blocks of size 2^( 4) =       0.000456390472
  error estimate for blocks of size 2^( 5) =       0.000467249249
  error estimate for blocks of size 2^( 6) =       0.000474321340
  error estimate for blocks of size 2^( 7) =       0.000479952143

      target function =                  N/A
              le_mean =     -16.906285680594
             les_mean =     286.175416082165
             stat err =       0.000469478301
             autocorr =       1.249061600473
              std dev =       0.594071329691
             le_variance =       0.352920744761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352808019509
                                         uncertainty =       0.007323967228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352808019509
                                         uncertainty =       0.007323967228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419990392
  error estimate for blocks of size 2^( 2) =       0.000432386606
  error estimate for blocks of size 2^( 3) =       0.000444564184
  error estimate for blocks of size 2^( 4) =       0.000456322710
  error estimate for blocks of size 2^( 5) =       0.000467183568
  error estimate for blocks of size 2^( 6) =       0.000474263593
  error estimate for blocks of size 2^( 7) =       0.000479892003

      target function =                  N/A
              le_mean =     -16.906287054146
             les_mean =     286.175325639673
             stat err =       0.000469415468
             autocorr =       1.249211812772
              std dev =       0.593956108538
             le_variance =       0.352783858869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906287400589        initial  <--
     2.5000e-01     2.5000e+00             9.5630e-04       -16.906285359930
     1.0000e+00     1.0000e+01             2.3427e-04       -16.906285680594
     4.0000e+00     4.0000e+01             5.9414e-05       -16.906287054146

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0523
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9186
    reference variance = 0.221767
====================================================
  Execution time = 2.0741e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4897e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349017379479
                                         uncertainty =       0.006129568374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349017379479
                                         uncertainty =       0.006129568374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417715741
  error estimate for blocks of size 2^( 2) =       0.000430168121
  error estimate for blocks of size 2^( 3) =       0.000443081737
  error estimate for blocks of size 2^( 4) =       0.000455505971
  error estimate for blocks of size 2^( 5) =       0.000465507529
  error estimate for blocks of size 2^( 6) =       0.000474285039
  error estimate for blocks of size 2^( 7) =       0.000481821416

      target function =                  N/A
              le_mean =     -16.905744015870
             les_mean =     286.153153435818
             stat err =       0.000469279989
             autocorr =       1.262125055235
              std dev =       0.590739265825
             le_variance =       0.348972880188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574401587e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744015870       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744006446       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905744017441       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905744015538       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905744226329       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905744327402       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905744315082       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905744323439       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.464905e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744015870       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744013355       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905744016221       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905744012793       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905744062848       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905744089532       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905744090006       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905744091943       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.126597e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744015870       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744015230       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905744015955       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905744014893       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905744027190       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905744033922       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905744034317       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905744034774       residual = 1.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 5.321720e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008689 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6273e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.091620e-01 1 1  ON 0
 uu_1                 1.427507e-01 1 1  ON 1
 uu_2                 4.132515e-02 1 1  ON 2
 uu_3                -2.110383e-02 1 1  ON 3
 uu_4                -6.616691e-02 1 1  ON 4
 uu_5                -1.002297e-01 1 1  ON 5
 uu_6                -1.268962e-01 1 1  ON 6
 uu_7                -1.398201e-01 1 1  ON 7
 uu_8                -1.320418e-01 1 1  ON 8
 uu_9                -1.020718e-01 1 1  ON 9
 ud_0                 4.496174e-01 1 1  ON 10
 ud_1                 1.833748e-01 1 1  ON 11
 ud_2                 6.207425e-02 1 1  ON 12
 ud_3                -9.857901e-03 1 1  ON 13
 ud_4                -6.694723e-02 1 1  ON 14
 ud_5                -1.081820e-01 1 1  ON 15
 ud_6                -1.352217e-01 1 1  ON 16
 ud_7                -1.512309e-01 1 1  ON 17
 ud_8                -1.516131e-01 1 1  ON 18
 ud_9                -1.403473e-01 1 1  ON 19
 eO_0                -7.654762e-01 1 1  ON 20
 eO_1                -4.430643e-01 1 1  ON 21
 eO_2                -2.033835e-02 1 1  ON 22
 eO_3                 3.021702e-01 1 1  ON 23
 eO_4                 5.276884e-01 1 1  ON 24
 eO_5                 4.870388e-01 1 1  ON 25
 eO_6                 2.567250e-01 1 1  ON 26
 eO_7                -4.610443e-02 1 1  ON 27
 eO_8                -2.198151e-01 1 1  ON 28
 eO_9                -7.875893e-02 1 1  ON 29
eH1_0                -2.440029e-01 1 1  ON 30
eH1_1                -1.430279e-01 1 1  ON 31
eH1_2                -9.621886e-02 1 1  ON 32
eH1_3                -4.200399e-02 1 1  ON 33
eH1_4                 5.831133e-03 1 1  ON 34
eH1_5                 4.022020e-02 1 1  ON 35
eH1_6                 9.798842e-02 1 1  ON 36
eH1_7                 1.513580e-01 1 1  ON 37
eH1_8                 1.742020e-01 1 1  ON 38
eH1_9                 5.974289e-02 1 1  ON 39
eH2_0                -2.396114e-01 1 1  ON 40
eH2_1                -1.392986e-01 1 1  ON 41
eH2_2                -9.226619e-02 1 1  ON 42
eH2_3                -3.810504e-02 1 1  ON 43
eH2_4                 9.631187e-03 1 1  ON 44
eH2_5                 4.295441e-02 1 1  ON 45
eH2_6                 9.860824e-02 1 1  ON 46
eH2_7                 1.505088e-01 1 1  ON 47
eH2_8                 1.771540e-01 1 1  ON 48
eH2_9                 4.760037e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9017
    reference variance = 0.265931
====================================================
  Execution time = 2.2796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3895e-01
  Total weights = 2.0000e+06
  Execution time = 1.9087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338870625646
                                         uncertainty =       0.004989353471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338870625646
                                         uncertainty =       0.004989353471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411672854
  error estimate for blocks of size 2^( 2) =       0.000424530867
  error estimate for blocks of size 2^( 3) =       0.000437387960
  error estimate for blocks of size 2^( 4) =       0.000450179160
  error estimate for blocks of size 2^( 5) =       0.000461989256
  error estimate for blocks of size 2^( 6) =       0.000470582068
  error estimate for blocks of size 2^( 7) =       0.000476104279

      target function =                  N/A
              le_mean =     -16.905871536381
             les_mean =     286.147441311784
             stat err =       0.000464713691
             autocorr =       1.274284718037
              std dev =       0.582193332713
             le_variance =       0.338949076656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338890776653
                                         uncertainty =       0.004990312418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338890776653
                                         uncertainty =       0.004990312418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411685081
  error estimate for blocks of size 2^( 2) =       0.000424542106
  error estimate for blocks of size 2^( 3) =       0.000437397517
  error estimate for blocks of size 2^( 4) =       0.000450188040
  error estimate for blocks of size 2^( 5) =       0.000461997747
  error estimate for blocks of size 2^( 6) =       0.000470590454
  error estimate for blocks of size 2^( 7) =       0.000476112608

      target function =                  N/A
              le_mean =     -16.905872061699
             les_mean =     286.147479208980
             stat err =       0.000464722212
             autocorr =       1.274255756271
              std dev =       0.582210625051
             le_variance =       0.338969211922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338880360020
                                         uncertainty =       0.004989908647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338880360020
                                         uncertainty =       0.004989908647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411678757
  error estimate for blocks of size 2^( 2) =       0.000424536257
  error estimate for blocks of size 2^( 3) =       0.000437392464
  error estimate for blocks of size 2^( 4) =       0.000450183341
  error estimate for blocks of size 2^( 5) =       0.000461993251
  error estimate for blocks of size 2^( 6) =       0.000470586014
  error estimate for blocks of size 2^( 7) =       0.000476108117

      target function =                  N/A
              le_mean =     -16.905871814208
             les_mean =     286.147460427284
             stat err =       0.000464717681
             autocorr =       1.274270053037
              std dev =       0.582201681843
             le_variance =       0.338958798341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338871818025
                                         uncertainty =       0.004989425509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338871818025
                                         uncertainty =       0.004989425509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411673577
  error estimate for blocks of size 2^( 2) =       0.000424531525
  error estimate for blocks of size 2^( 3) =       0.000437388505
  error estimate for blocks of size 2^( 4) =       0.000450179666
  error estimate for blocks of size 2^( 5) =       0.000461989739
  error estimate for blocks of size 2^( 6) =       0.000470582545
  error estimate for blocks of size 2^( 7) =       0.000476104739

      target function =                  N/A
              le_mean =     -16.905871570879
             les_mean =     286.147443668808
             stat err =       0.000464714172
             autocorr =       1.274282881910
              std dev =       0.582194355215
             le_variance =       0.338950267245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905871536381        initial
     2.5000e+00     2.5000e+01             8.4649e-05       -16.905872061699  <--
     1.0000e+01     1.0000e+02             2.1266e-05       -16.905871814208
     4.0000e+01     4.0000e+02             5.3217e-06       -16.905871570879

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.2380e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.092031e-01 1 1  ON 0
 uu_1                 1.427429e-01 1 1  ON 1
 uu_2                 4.131721e-02 1 1  ON 2
 uu_3                -2.111935e-02 1 1  ON 3
 uu_4                -6.616107e-02 1 1  ON 4
 uu_5                -1.002443e-01 1 1  ON 5
 uu_6                -1.269300e-01 1 1  ON 6
 uu_7                -1.398345e-01 1 1  ON 7
 uu_8                -1.320309e-01 1 1  ON 8
 uu_9                -1.020885e-01 1 1  ON 9
 ud_0                 4.496241e-01 1 1  ON 10
 ud_1                 1.834070e-01 1 1  ON 11
 ud_2                 6.206395e-02 1 1  ON 12
 ud_3                -9.845980e-03 1 1  ON 13
 ud_4                -6.692242e-02 1 1  ON 14
 ud_5                -1.082075e-01 1 1  ON 15
 ud_6                -1.351959e-01 1 1  ON 16
 ud_7                -1.512289e-01 1 1  ON 17
 ud_8                -1.516662e-01 1 1  ON 18
 ud_9                -1.403748e-01 1 1  ON 19
 eO_0                -7.654622e-01 1 1  ON 20
 eO_1                -4.430686e-01 1 1  ON 21
 eO_2                -2.034169e-02 1 1  ON 22
 eO_3                 3.021329e-01 1 1  ON 23
 eO_4                 5.277066e-01 1 1  ON 24
 eO_5                 4.870772e-01 1 1  ON 25
 eO_6                 2.567702e-01 1 1  ON 26
 eO_7                -4.609090e-02 1 1  ON 27
 eO_8                -2.198514e-01 1 1  ON 28
 eO_9                -7.880151e-02 1 1  ON 29
eH1_0                -2.440152e-01 1 1  ON 30
eH1_1                -1.430264e-01 1 1  ON 31
eH1_2                -9.620004e-02 1 1  ON 32
eH1_3                -4.202690e-02 1 1  ON 33
eH1_4                 5.804699e-03 1 1  ON 34
eH1_5                 4.019776e-02 1 1  ON 35
eH1_6                 9.795104e-02 1 1  ON 36
eH1_7                 1.513452e-01 1 1  ON 37
eH1_8                 1.742513e-01 1 1  ON 38
eH1_9                 5.980627e-02 1 1  ON 39
eH2_0                -2.396218e-01 1 1  ON 40
eH2_1                -1.393178e-01 1 1  ON 41
eH2_2                -9.229212e-02 1 1  ON 42
eH2_3                -3.813016e-02 1 1  ON 43
eH2_4                 9.600251e-03 1 1  ON 44
eH2_5                 4.294608e-02 1 1  ON 45
eH2_6                 9.861915e-02 1 1  ON 46
eH2_7                 1.505150e-01 1 1  ON 47
eH2_8                 1.771853e-01 1 1  ON 48
eH2_9                 4.766013e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8857
    reference variance = 0.148895
====================================================
  Execution time = 2.0901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4121e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341287455534
                                         uncertainty =       0.004791170707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341287455534
                                         uncertainty =       0.004791170707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413044645
  error estimate for blocks of size 2^( 2) =       0.000425507242
  error estimate for blocks of size 2^( 3) =       0.000438693293
  error estimate for blocks of size 2^( 4) =       0.000450898714
  error estimate for blocks of size 2^( 5) =       0.000462474804
  error estimate for blocks of size 2^( 6) =       0.000470881331
  error estimate for blocks of size 2^( 7) =       0.000475267216

      target function =                  N/A
              le_mean =     -16.906047870568
             les_mean =     286.155666188812
             stat err =       0.000464880516
             autocorr =       1.266743537717
              std dev =       0.584133338778
             le_variance =       0.341211757472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604787057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906047870568       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906049463536       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906049597951       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906049527694       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906050061481       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906049945824       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906049972392       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906049962411       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.163278e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906047870568       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906048358284       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906048435474       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906048401283       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906048548502       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906048498557       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906048498041       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906048478372       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.102274e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906047870568       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906047999753       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906048024105       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906048015075       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906048051541       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906048037833       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906048038444       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906048031147       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.047975e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6560e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.092608e-01 1 1  ON 0
 uu_1                 1.427635e-01 1 1  ON 1
 uu_2                 4.127414e-02 1 1  ON 2
 uu_3                -2.112601e-02 1 1  ON 3
 uu_4                -6.617930e-02 1 1  ON 4
 uu_5                -1.002499e-01 1 1  ON 5
 uu_6                -1.269728e-01 1 1  ON 6
 uu_7                -1.399149e-01 1 1  ON 7
 uu_8                -1.320438e-01 1 1  ON 8
 uu_9                -1.020631e-01 1 1  ON 9
 ud_0                 4.496021e-01 1 1  ON 10
 ud_1                 1.833911e-01 1 1  ON 11
 ud_2                 6.207964e-02 1 1  ON 12
 ud_3                -9.839407e-03 1 1  ON 13
 ud_4                -6.695962e-02 1 1  ON 14
 ud_5                -1.082039e-01 1 1  ON 15
 ud_6                -1.352088e-01 1 1  ON 16
 ud_7                -1.512249e-01 1 1  ON 17
 ud_8                -1.516151e-01 1 1  ON 18
 ud_9                -1.403663e-01 1 1  ON 19
 eO_0                -7.654874e-01 1 1  ON 20
 eO_1                -4.430343e-01 1 1  ON 21
 eO_2                -2.035432e-02 1 1  ON 22
 eO_3                 3.021151e-01 1 1  ON 23
 eO_4                 5.277015e-01 1 1  ON 24
 eO_5                 4.871128e-01 1 1  ON 25
 eO_6                 2.568041e-01 1 1  ON 26
 eO_7                -4.607117e-02 1 1  ON 27
 eO_8                -2.198713e-01 1 1  ON 28
 eO_9                -7.883763e-02 1 1  ON 29
eH1_0                -2.440904e-01 1 1  ON 30
eH1_1                -1.430847e-01 1 1  ON 31
eH1_2                -9.622916e-02 1 1  ON 32
eH1_3                -4.207474e-02 1 1  ON 33
eH1_4                 5.797775e-03 1 1  ON 34
eH1_5                 4.019585e-02 1 1  ON 35
eH1_6                 9.797490e-02 1 1  ON 36
eH1_7                 1.514031e-01 1 1  ON 37
eH1_8                 1.742915e-01 1 1  ON 38
eH1_9                 5.988730e-02 1 1  ON 39
eH2_0                -2.396856e-01 1 1  ON 40
eH2_1                -1.393020e-01 1 1  ON 41
eH2_2                -9.229894e-02 1 1  ON 42
eH2_3                -3.816104e-02 1 1  ON 43
eH2_4                 9.606657e-03 1 1  ON 44
eH2_5                 4.291933e-02 1 1  ON 45
eH2_6                 9.861746e-02 1 1  ON 46
eH2_7                 1.505276e-01 1 1  ON 47
eH2_8                 1.772207e-01 1 1  ON 48
eH2_9                 4.772411e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.916
    reference variance = 0.254296
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5127e-01
  Total weights = 2.0000e+06
  Execution time = 1.9043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351270725252
                                         uncertainty =       0.010097866543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351270725252
                                         uncertainty =       0.010097866543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419085789
  error estimate for blocks of size 2^( 2) =       0.000431406865
  error estimate for blocks of size 2^( 3) =       0.000444162391
  error estimate for blocks of size 2^( 4) =       0.000455457059
  error estimate for blocks of size 2^( 5) =       0.000466229201
  error estimate for blocks of size 2^( 6) =       0.000475461538
  error estimate for blocks of size 2^( 7) =       0.000480434480

      target function =                  N/A
              le_mean =     -16.906156813728
             les_mean =     286.169403832223
             stat err =       0.000469395569
             autocorr =       1.254504150703
              std dev =       0.592676806948
             le_variance =       0.351265797494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351298359232
                                         uncertainty =       0.010096213222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351298359232
                                         uncertainty =       0.010096213222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419102222
  error estimate for blocks of size 2^( 2) =       0.000431424081
  error estimate for blocks of size 2^( 3) =       0.000444180427
  error estimate for blocks of size 2^( 4) =       0.000455473943
  error estimate for blocks of size 2^( 5) =       0.000466245759
  error estimate for blocks of size 2^( 6) =       0.000475478503
  error estimate for blocks of size 2^( 7) =       0.000480447982

      target function =                  N/A
              le_mean =     -16.906158100651
             les_mean =     286.169474893557
             stat err =       0.000469411547
             autocorr =       1.254491174437
              std dev =       0.592700046389
             le_variance =       0.351293344989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351282778567
                                         uncertainty =       0.010096533352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351282778567
                                         uncertainty =       0.010096533352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419092945
  error estimate for blocks of size 2^( 2) =       0.000431414662
  error estimate for blocks of size 2^( 3) =       0.000444170978
  error estimate for blocks of size 2^( 4) =       0.000455464791
  error estimate for blocks of size 2^( 5) =       0.000466237036
  error estimate for blocks of size 2^( 6) =       0.000475470180
  error estimate for blocks of size 2^( 7) =       0.000480440832

      target function =                  N/A
              le_mean =     -16.906157951596
             les_mean =     286.169454302233
             stat err =       0.000469403210
             autocorr =       1.254502147464
              std dev =       0.592686927095
             le_variance =       0.351277793549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351272444105
                                         uncertainty =       0.010097682791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351272444105
                                         uncertainty =       0.010097682791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419086810
  error estimate for blocks of size 2^( 2) =       0.000431407960
  error estimate for blocks of size 2^( 3) =       0.000444163591
  error estimate for blocks of size 2^( 4) =       0.000455458127
  error estimate for blocks of size 2^( 5) =       0.000466230291
  error estimate for blocks of size 2^( 6) =       0.000475462757
  error estimate for blocks of size 2^( 7) =       0.000480435383

      target function =                  N/A
              le_mean =     -16.906156976230
             les_mean =     286.169411037879
             stat err =       0.000469396640
             autocorr =       1.254503760712
              std dev =       0.592678250472
             le_variance =       0.351267508583


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906156813728        initial
     6.2500e-01     6.2500e+00             3.1633e-04       -16.906158100651  <--
     2.5000e+00     2.5000e+01             8.1023e-05       -16.906157951596
     1.0000e+01     1.0000e+02             2.0480e-05       -16.906156976230

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0104e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.094040e-01 1 1  ON 0
 uu_1                 1.427945e-01 1 1  ON 1
 uu_2                 4.120618e-02 1 1  ON 2
 uu_3                -2.115642e-02 1 1  ON 3
 uu_4                -6.622162e-02 1 1  ON 4
 uu_5                -1.002906e-01 1 1  ON 5
 uu_6                -1.270845e-01 1 1  ON 6
 uu_7                -1.401361e-01 1 1  ON 7
 uu_8                -1.320854e-01 1 1  ON 8
 uu_9                -1.019898e-01 1 1  ON 9
 ud_0                 4.495532e-01 1 1  ON 10
 ud_1                 1.833556e-01 1 1  ON 11
 ud_2                 6.209176e-02 1 1  ON 12
 ud_3                -9.832294e-03 1 1  ON 13
 ud_4                -6.703664e-02 1 1  ON 14
 ud_5                -1.082155e-01 1 1  ON 15
 ud_6                -1.352334e-01 1 1  ON 16
 ud_7                -1.512139e-01 1 1  ON 17
 ud_8                -1.514713e-01 1 1  ON 18
 ud_9                -1.403392e-01 1 1  ON 19
 eO_0                -7.655415e-01 1 1  ON 20
 eO_1                -4.429662e-01 1 1  ON 21
 eO_2                -2.037558e-02 1 1  ON 22
 eO_3                 3.020648e-01 1 1  ON 23
 eO_4                 5.276784e-01 1 1  ON 24
 eO_5                 4.872146e-01 1 1  ON 25
 eO_6                 2.569065e-01 1 1  ON 26
 eO_7                -4.601360e-02 1 1  ON 27
 eO_8                -2.199290e-01 1 1  ON 28
 eO_9                -7.894200e-02 1 1  ON 29
eH1_0                -2.443078e-01 1 1  ON 30
eH1_1                -1.432482e-01 1 1  ON 31
eH1_2                -9.632909e-02 1 1  ON 32
eH1_3                -4.220328e-02 1 1  ON 33
eH1_4                 5.767661e-03 1 1  ON 34
eH1_5                 4.019003e-02 1 1  ON 35
eH1_6                 9.804787e-02 1 1  ON 36
eH1_7                 1.515741e-01 1 1  ON 37
eH1_8                 1.744097e-01 1 1  ON 38
eH1_9                 6.012260e-02 1 1  ON 39
eH2_0                -2.398526e-01 1 1  ON 40
eH2_1                -1.392833e-01 1 1  ON 41
eH2_2                -9.232300e-02 1 1  ON 42
eH2_3                -3.823361e-02 1 1  ON 43
eH2_4                 9.622229e-03 1 1  ON 44
eH2_5                 4.284499e-02 1 1  ON 45
eH2_6                 9.860903e-02 1 1  ON 46
eH2_7                 1.505628e-01 1 1  ON 47
eH2_8                 1.773235e-01 1 1  ON 48
eH2_9                 4.791004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6672e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9751
    reference variance = 0.766247
====================================================
  Execution time = 2.0662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3742e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337387826469
                                         uncertainty =       0.004386002537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337387826469
                                         uncertainty =       0.004386002537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410740978
  error estimate for blocks of size 2^( 2) =       0.000423663740
  error estimate for blocks of size 2^( 3) =       0.000436832947
  error estimate for blocks of size 2^( 4) =       0.000448826881
  error estimate for blocks of size 2^( 5) =       0.000458296745
  error estimate for blocks of size 2^( 6) =       0.000465425050
  error estimate for blocks of size 2^( 7) =       0.000469168944

      target function =                  N/A
              le_mean =     -16.905655763902
             les_mean =     286.138612940507
             stat err =       0.000460429405
             autocorr =       1.256579697207
              std dev =       0.580875461409
             le_variance =       0.337416301667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565576390e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905655763902       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905657457387       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905658274684       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905658307571       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905660354148       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905660474596       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905658685752       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905658655677       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905658376880       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905658836346       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905658920587       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.418376e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905655763902       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905656419171       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905656756519       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905656655774       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905657207365       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905657182223       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905657021391       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905656921907       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905656916273       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.549597e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905655763902       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905655953711       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905656056334       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905656009013       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905656051605       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905656103098       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905656119442       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905656101595       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.844245e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6249e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.095651e-01 1 1  ON 0
 uu_1                 1.427634e-01 1 1  ON 1
 uu_2                 4.123004e-02 1 1  ON 2
 uu_3                -2.110829e-02 1 1  ON 3
 uu_4                -6.628523e-02 1 1  ON 4
 uu_5                -1.004351e-01 1 1  ON 5
 uu_6                -1.271259e-01 1 1  ON 6
 uu_7                -1.401685e-01 1 1  ON 7
 uu_8                -1.321392e-01 1 1  ON 8
 uu_9                -1.021428e-01 1 1  ON 9
 ud_0                 4.496785e-01 1 1  ON 10
 ud_1                 1.833729e-01 1 1  ON 11
 ud_2                 6.214797e-02 1 1  ON 12
 ud_3                -9.823797e-03 1 1  ON 13
 ud_4                -6.698075e-02 1 1  ON 14
 ud_5                -1.082360e-01 1 1  ON 15
 ud_6                -1.351839e-01 1 1  ON 16
 ud_7                -1.511155e-01 1 1  ON 17
 ud_8                -1.515370e-01 1 1  ON 18
 ud_9                -1.405054e-01 1 1  ON 19
 eO_0                -7.654313e-01 1 1  ON 20
 eO_1                -4.430021e-01 1 1  ON 21
 eO_2                -2.036387e-02 1 1  ON 22
 eO_3                 3.020962e-01 1 1  ON 23
 eO_4                 5.276749e-01 1 1  ON 24
 eO_5                 4.872319e-01 1 1  ON 25
 eO_6                 2.570981e-01 1 1  ON 26
 eO_7                -4.587309e-02 1 1  ON 27
 eO_8                -2.201001e-01 1 1  ON 28
 eO_9                -7.917962e-02 1 1  ON 29
eH1_0                -2.443788e-01 1 1  ON 30
eH1_1                -1.433246e-01 1 1  ON 31
eH1_2                -9.643791e-02 1 1  ON 32
eH1_3                -4.236971e-02 1 1  ON 33
eH1_4                 5.728307e-03 1 1  ON 34
eH1_5                 4.015350e-02 1 1  ON 35
eH1_6                 9.787475e-02 1 1  ON 36
eH1_7                 1.515413e-01 1 1  ON 37
eH1_8                 1.747177e-01 1 1  ON 38
eH1_9                 6.047756e-02 1 1  ON 39
eH2_0                -2.399356e-01 1 1  ON 40
eH2_1                -1.393983e-01 1 1  ON 41
eH2_2                -9.245775e-02 1 1  ON 42
eH2_3                -3.834163e-02 1 1  ON 43
eH2_4                 9.520453e-03 1 1  ON 44
eH2_5                 4.268608e-02 1 1  ON 45
eH2_6                 9.871067e-02 1 1  ON 46
eH2_7                 1.507826e-01 1 1  ON 47
eH2_8                 1.774498e-01 1 1  ON 48
eH2_9                 4.818605e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9146
    reference variance = 0.198415
====================================================
  Execution time = 2.0369e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3780e-01
  Total weights = 2.0000e+06
  Execution time = 1.9061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337706548294
                                         uncertainty =       0.003266183802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337706548294
                                         uncertainty =       0.003266183802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410924046
  error estimate for blocks of size 2^( 2) =       0.000423997700
  error estimate for blocks of size 2^( 3) =       0.000437078669
  error estimate for blocks of size 2^( 4) =       0.000449933503
  error estimate for blocks of size 2^( 5) =       0.000461331540
  error estimate for blocks of size 2^( 6) =       0.000469417294
  error estimate for blocks of size 2^( 7) =       0.000475238396

      target function =                  N/A
              le_mean =     -16.905142800792
             les_mean =     286.121570089091
             stat err =       0.000463980183
             autocorr =       1.274898920762
              std dev =       0.581134358618
             le_variance =       0.337717142766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883934928
                                         uncertainty =       0.003267847519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883934928
                                         uncertainty =       0.003267847519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411031957
  error estimate for blocks of size 2^( 2) =       0.000424098794
  error estimate for blocks of size 2^( 3) =       0.000437172564
  error estimate for blocks of size 2^( 4) =       0.000450021495
  error estimate for blocks of size 2^( 5) =       0.000461415759
  error estimate for blocks of size 2^( 6) =       0.000469502185
  error estimate for blocks of size 2^( 7) =       0.000475322599

      target function =                  N/A
              le_mean =     -16.905145516538
             les_mean =     286.121839304893
             stat err =       0.000464065509
             autocorr =       1.274698299867
              std dev =       0.581286967454
             le_variance =       0.337894538532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337877090057
                                         uncertainty =       0.003267687304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337877090057
                                         uncertainty =       0.003267687304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411027788
  error estimate for blocks of size 2^( 2) =       0.000424096407
  error estimate for blocks of size 2^( 3) =       0.000437172041
  error estimate for blocks of size 2^( 4) =       0.000450021817
  error estimate for blocks of size 2^( 5) =       0.000461417053
  error estimate for blocks of size 2^( 6) =       0.000469502559
  error estimate for blocks of size 2^( 7) =       0.000475323455

      target function =                  N/A
              le_mean =     -16.905145007823
             les_mean =     286.121815251364
             stat err =       0.000464066221
             autocorr =       1.274728065181
              std dev =       0.581281072112
             le_variance =       0.337887684795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337740059587
                                         uncertainty =       0.003266466751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337740059587
                                         uncertainty =       0.003266466751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410944435
  error estimate for blocks of size 2^( 2) =       0.000424017161
  error estimate for blocks of size 2^( 3) =       0.000437097151
  error estimate for blocks of size 2^( 4) =       0.000449951093
  error estimate for blocks of size 2^( 5) =       0.000461348480
  error estimate for blocks of size 2^( 6) =       0.000469434047
  error estimate for blocks of size 2^( 7) =       0.000475255066

      target function =                  N/A
              le_mean =     -16.905143119892
             les_mean =     286.121614391852
             stat err =       0.000463997171
             autocorr =       1.274865767641
              std dev =       0.581163192836
             le_variance =       0.337750656707


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905142800792        initial
     1.5625e-01     1.5625e+00             1.4184e-03       -16.905145516538  <--
     6.2500e-01     6.2500e+00             3.5496e-04       -16.905145007823
     2.5000e+00     2.5000e+01             8.8442e-05       -16.905143119892

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9934e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.097146e-01 1 1  ON 0
 uu_1                 1.427860e-01 1 1  ON 1
 uu_2                 4.126946e-02 1 1  ON 2
 uu_3                -2.107273e-02 1 1  ON 3
 uu_4                -6.634463e-02 1 1  ON 4
 uu_5                -1.006580e-01 1 1  ON 5
 uu_6                -1.272801e-01 1 1  ON 6
 uu_7                -1.403123e-01 1 1  ON 7
 uu_8                -1.322592e-01 1 1  ON 8
 uu_9                -1.025524e-01 1 1  ON 9
 ud_0                 4.498762e-01 1 1  ON 10
 ud_1                 1.834849e-01 1 1  ON 11
 ud_2                 6.228030e-02 1 1  ON 12
 ud_3                -9.729080e-03 1 1  ON 13
 ud_4                -6.686870e-02 1 1  ON 14
 ud_5                -1.081919e-01 1 1  ON 15
 ud_6                -1.350895e-01 1 1  ON 16
 ud_7                -1.509330e-01 1 1  ON 17
 ud_8                -1.516168e-01 1 1  ON 18
 ud_9                -1.409282e-01 1 1  ON 19
 eO_0                -7.653218e-01 1 1  ON 20
 eO_1                -4.429729e-01 1 1  ON 21
 eO_2                -2.028158e-02 1 1  ON 22
 eO_3                 3.022192e-01 1 1  ON 23
 eO_4                 5.276759e-01 1 1  ON 24
 eO_5                 4.872777e-01 1 1  ON 25
 eO_6                 2.576177e-01 1 1  ON 26
 eO_7                -4.544017e-02 1 1  ON 27
 eO_8                -2.205776e-01 1 1  ON 28
 eO_9                -7.988215e-02 1 1  ON 29
eH1_0                -2.446237e-01 1 1  ON 30
eH1_1                -1.436118e-01 1 1  ON 31
eH1_2                -9.677036e-02 1 1  ON 32
eH1_3                -4.271919e-02 1 1  ON 33
eH1_4                 5.501948e-03 1 1  ON 34
eH1_5                 4.001577e-02 1 1  ON 35
eH1_6                 9.744262e-02 1 1  ON 36
eH1_7                 1.514535e-01 1 1  ON 37
eH1_8                 1.756238e-01 1 1  ON 38
eH1_9                 6.154098e-02 1 1  ON 39
eH2_0                -2.402256e-01 1 1  ON 40
eH2_1                -1.397492e-01 1 1  ON 41
eH2_2                -9.283848e-02 1 1  ON 42
eH2_3                -3.868759e-02 1 1  ON 43
eH2_4                 9.243427e-03 1 1  ON 44
eH2_5                 4.229249e-02 1 1  ON 45
eH2_6                 9.894530e-02 1 1  ON 46
eH2_7                 1.514081e-01 1 1  ON 47
eH2_8                 1.778510e-01 1 1  ON 48
eH2_9                 4.902547e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6191e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9917
    reference variance = 0.221471
====================================================
  Execution time = 2.0651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4424e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344285988242
                                         uncertainty =       0.005592088654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344285988242
                                         uncertainty =       0.005592088654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414876155
  error estimate for blocks of size 2^( 2) =       0.000427168097
  error estimate for blocks of size 2^( 3) =       0.000439883709
  error estimate for blocks of size 2^( 4) =       0.000451100899
  error estimate for blocks of size 2^( 5) =       0.000461407629
  error estimate for blocks of size 2^( 6) =       0.000467582852
  error estimate for blocks of size 2^( 7) =       0.000469997729

      target function =                  N/A
              le_mean =     -16.904795104513
             les_mean =     286.116341801376
             stat err =       0.000462522278
             autocorr =       1.242877603385
              std dev =       0.586723485067
             le_variance =       0.344244447929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690479510451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904795104513       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904796825925       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904796506562       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904795331962       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904796449498       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904797886629       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904797988098       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904799411712       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904797802767       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904799652128       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904800084402       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904800013356       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904800442596       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904800193893       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.218606e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904795104513       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904796283807       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904796601769       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904795815492       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904796250027       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904797223317       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904796161575       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904796867052       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904796963105       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904797084519       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.307774e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904795104513       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904795626392       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904795948855       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904795688288       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904795812653       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904795959227       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904795921990       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904795762820       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.243164e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6238e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.100257e-01 1 1  ON 0
 uu_1                 1.428093e-01 1 1  ON 1
 uu_2                 4.127669e-02 1 1  ON 2
 uu_3                -2.126365e-02 1 1  ON 3
 uu_4                -6.663346e-02 1 1  ON 4
 uu_5                -1.006972e-01 1 1  ON 5
 uu_6                -1.276616e-01 1 1  ON 6
 uu_7                -1.404286e-01 1 1  ON 7
 uu_8                -1.325571e-01 1 1  ON 8
 uu_9                -1.027083e-01 1 1  ON 9
 ud_0                 4.503859e-01 1 1  ON 10
 ud_1                 1.838239e-01 1 1  ON 11
 ud_2                 6.244925e-02 1 1  ON 12
 ud_3                -9.588902e-03 1 1  ON 13
 ud_4                -6.686788e-02 1 1  ON 14
 ud_5                -1.080295e-01 1 1  ON 15
 ud_6                -1.352614e-01 1 1  ON 16
 ud_7                -1.514474e-01 1 1  ON 17
 ud_8                -1.518456e-01 1 1  ON 18
 ud_9                -1.411590e-01 1 1  ON 19
 eO_0                -7.651787e-01 1 1  ON 20
 eO_1                -4.431120e-01 1 1  ON 21
 eO_2                -2.025252e-02 1 1  ON 22
 eO_3                 3.024127e-01 1 1  ON 23
 eO_4                 5.278779e-01 1 1  ON 24
 eO_5                 4.879565e-01 1 1  ON 25
 eO_6                 2.580829e-01 1 1  ON 26
 eO_7                -4.535264e-02 1 1  ON 27
 eO_8                -2.212605e-01 1 1  ON 28
 eO_9                -8.073253e-02 1 1  ON 29
eH1_0                -2.450021e-01 1 1  ON 30
eH1_1                -1.437437e-01 1 1  ON 31
eH1_2                -9.722082e-02 1 1  ON 32
eH1_3                -4.286709e-02 1 1  ON 33
eH1_4                 5.229182e-03 1 1  ON 34
eH1_5                 3.952374e-02 1 1  ON 35
eH1_6                 9.749656e-02 1 1  ON 36
eH1_7                 1.516643e-01 1 1  ON 37
eH1_8                 1.763802e-01 1 1  ON 38
eH1_9                 6.238011e-02 1 1  ON 39
eH2_0                -2.409232e-01 1 1  ON 40
eH2_1                -1.402753e-01 1 1  ON 41
eH2_2                -9.333845e-02 1 1  ON 42
eH2_3                -3.904227e-02 1 1  ON 43
eH2_4                 9.242508e-03 1 1  ON 44
eH2_5                 4.277974e-02 1 1  ON 45
eH2_6                 9.897831e-02 1 1  ON 46
eH2_7                 1.511108e-01 1 1  ON 47
eH2_8                 1.782849e-01 1 1  ON 48
eH2_9                 5.033324e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9376
    reference variance = 0.139606
====================================================
  Execution time = 2.0375e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3973e-01
  Total weights = 2.0000e+06
  Execution time = 1.9162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339356221377
                                         uncertainty =       0.004271653870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339356221377
                                         uncertainty =       0.004271653870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411918550
  error estimate for blocks of size 2^( 2) =       0.000424700058
  error estimate for blocks of size 2^( 3) =       0.000437761624
  error estimate for blocks of size 2^( 4) =       0.000449977250
  error estimate for blocks of size 2^( 5) =       0.000460189926
  error estimate for blocks of size 2^( 6) =       0.000468232904
  error estimate for blocks of size 2^( 7) =       0.000471712772

      target function =                  N/A
              le_mean =     -16.905523361942
             les_mean =     286.136073755637
             stat err =       0.000462528213
             autocorr =       1.260821938793
              std dev =       0.582540800419
             le_variance =       0.339353784153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339944875923
                                         uncertainty =       0.004277742869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339944875923
                                         uncertainty =       0.004277742869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412275744
  error estimate for blocks of size 2^( 2) =       0.000425039372
  error estimate for blocks of size 2^( 3) =       0.000438073190
  error estimate for blocks of size 2^( 4) =       0.000450266505
  error estimate for blocks of size 2^( 5) =       0.000460469267
  error estimate for blocks of size 2^( 6) =       0.000468502682
  error estimate for blocks of size 2^( 7) =       0.000471971175

      target function =                  N/A
              le_mean =     -16.905524567547
             les_mean =     286.136703312158
             stat err =       0.000462802407
             autocorr =       1.260130868452
              std dev =       0.583045948614
             le_variance =       0.339942578196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340121860778
                                         uncertainty =       0.004280123309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340121860778
                                         uncertainty =       0.004280123309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412383145
  error estimate for blocks of size 2^( 2) =       0.000425140973
  error estimate for blocks of size 2^( 3) =       0.000438168136
  error estimate for blocks of size 2^( 4) =       0.000450360036
  error estimate for blocks of size 2^( 5) =       0.000460569081
  error estimate for blocks of size 2^( 6) =       0.000468605360
  error estimate for blocks of size 2^( 7) =       0.000472073394

      target function =                  N/A
              le_mean =     -16.905525227865
             les_mean =     286.136902776847
             stat err =       0.000462901967
             autocorr =       1.260016522517
              std dev =       0.583197836878
             le_variance =       0.340119716939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339532361037
                                         uncertainty =       0.004273663017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339532361037
                                         uncertainty =       0.004273663017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412025492
  error estimate for blocks of size 2^( 2) =       0.000424801422
  error estimate for blocks of size 2^( 3) =       0.000437855177
  error estimate for blocks of size 2^( 4) =       0.000450065465
  error estimate for blocks of size 2^( 5) =       0.000460278140
  error estimate for blocks of size 2^( 6) =       0.000468320282
  error estimate for blocks of size 2^( 7) =       0.000471797438

      target function =                  N/A
              le_mean =     -16.905523299792
             les_mean =     286.136247881658
             stat err =       0.000462615331
             autocorr =       1.260642284963
              std dev =       0.582692038392
             le_variance =       0.339530011605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905523361942        initial
     3.9062e-02     3.9062e-01             5.2186e-03       -16.905524567547
     1.5625e-01     1.5625e+00             1.3078e-03       -16.905525227865  <--
     6.2500e-01     6.2500e+00             3.2432e-04       -16.905523299792

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9988e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.100257e-01 1 1  ON 0
 uu_1                 1.428093e-01 1 1  ON 1
 uu_2                 4.127669e-02 1 1  ON 2
 uu_3                -2.126365e-02 1 1  ON 3
 uu_4                -6.663346e-02 1 1  ON 4
 uu_5                -1.006972e-01 1 1  ON 5
 uu_6                -1.276616e-01 1 1  ON 6
 uu_7                -1.404286e-01 1 1  ON 7
 uu_8                -1.325571e-01 1 1  ON 8
 uu_9                -1.027083e-01 1 1  ON 9
 ud_0                 4.503859e-01 1 1  ON 10
 ud_1                 1.838239e-01 1 1  ON 11
 ud_2                 6.244925e-02 1 1  ON 12
 ud_3                -9.588902e-03 1 1  ON 13
 ud_4                -6.686788e-02 1 1  ON 14
 ud_5                -1.080295e-01 1 1  ON 15
 ud_6                -1.352614e-01 1 1  ON 16
 ud_7                -1.514474e-01 1 1  ON 17
 ud_8                -1.518456e-01 1 1  ON 18
 ud_9                -1.411590e-01 1 1  ON 19
 eO_0                -7.651787e-01 1 1  ON 20
 eO_1                -4.431120e-01 1 1  ON 21
 eO_2                -2.025252e-02 1 1  ON 22
 eO_3                 3.024127e-01 1 1  ON 23
 eO_4                 5.278779e-01 1 1  ON 24
 eO_5                 4.879565e-01 1 1  ON 25
 eO_6                 2.580829e-01 1 1  ON 26
 eO_7                -4.535264e-02 1 1  ON 27
 eO_8                -2.212605e-01 1 1  ON 28
 eO_9                -8.073253e-02 1 1  ON 29
eH1_0                -2.450021e-01 1 1  ON 30
eH1_1                -1.437437e-01 1 1  ON 31
eH1_2                -9.722082e-02 1 1  ON 32
eH1_3                -4.286709e-02 1 1  ON 33
eH1_4                 5.229182e-03 1 1  ON 34
eH1_5                 3.952374e-02 1 1  ON 35
eH1_6                 9.749656e-02 1 1  ON 36
eH1_7                 1.516643e-01 1 1  ON 37
eH1_8                 1.763802e-01 1 1  ON 38
eH1_9                 6.238011e-02 1 1  ON 39
eH2_0                -2.409232e-01 1 1  ON 40
eH2_1                -1.402753e-01 1 1  ON 41
eH2_2                -9.333845e-02 1 1  ON 42
eH2_3                -3.904227e-02 1 1  ON 43
eH2_4                 9.242508e-03 1 1  ON 44
eH2_5                 4.277974e-02 1 1  ON 45
eH2_6                 9.897831e-02 1 1  ON 46
eH2_7                 1.511108e-01 1 1  ON 47
eH2_8                 1.782849e-01 1 1  ON 48
eH2_9                 5.033324e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9102
    reference variance = 0.199771
====================================================
  Execution time = 2.0642e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3532e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335319920531
                                         uncertainty =       0.003108988648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335319920531
                                         uncertainty =       0.003108988648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409463504
  error estimate for blocks of size 2^( 2) =       0.000422910914
  error estimate for blocks of size 2^( 3) =       0.000436312201
  error estimate for blocks of size 2^( 4) =       0.000449071546
  error estimate for blocks of size 2^( 5) =       0.000459726839
  error estimate for blocks of size 2^( 6) =       0.000467106658
  error estimate for blocks of size 2^( 7) =       0.000473823406

      target function =                  N/A
              le_mean =     -16.905259633687
             les_mean =     286.123123837575
             stat err =       0.000462432112
             autocorr =       1.275456265163
              std dev =       0.579068841212
             le_variance =       0.335320722863


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690525963369e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905259633687       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905266945211       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905268095594       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905271987606       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905275281819       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905273298331       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905273879466       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905276226058       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905277548700       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905278800733       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905280540449       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905279507076       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905279073871       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905279022011       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.209574e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905259633687       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905263531702       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905264121483       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905266243392       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905267822855       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905267266538       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905267210887       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905267512987       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905267544333       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905267911713       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905267921873       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.302017e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905259633687       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905260993078       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905261255775       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905262091438       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905262412845       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905262700913       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905262499669       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905262452592       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905262461744       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.201425e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025366 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6321e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.097786e-01 1 1  ON 0
 uu_1                 1.428760e-01 1 1  ON 1
 uu_2                 4.123378e-02 1 1  ON 2
 uu_3                -2.130278e-02 1 1  ON 3
 uu_4                -6.663124e-02 1 1  ON 4
 uu_5                -1.006840e-01 1 1  ON 5
 uu_6                -1.278139e-01 1 1  ON 6
 uu_7                -1.404869e-01 1 1  ON 7
 uu_8                -1.328714e-01 1 1  ON 8
 uu_9                -1.031731e-01 1 1  ON 9
 ud_0                 4.502273e-01 1 1  ON 10
 ud_1                 1.839208e-01 1 1  ON 11
 ud_2                 6.253420e-02 1 1  ON 12
 ud_3                -9.448348e-03 1 1  ON 13
 ud_4                -6.648110e-02 1 1  ON 14
 ud_5                -1.077988e-01 1 1  ON 15
 ud_6                -1.351593e-01 1 1  ON 16
 ud_7                -1.508871e-01 1 1  ON 17
 ud_8                -1.524491e-01 1 1  ON 18
 ud_9                -1.418619e-01 1 1  ON 19
 eO_0                -7.654429e-01 1 1  ON 20
 eO_1                -4.432881e-01 1 1  ON 21
 eO_2                -2.024016e-02 1 1  ON 22
 eO_3                 3.020089e-01 1 1  ON 23
 eO_4                 5.280576e-01 1 1  ON 24
 eO_5                 4.888219e-01 1 1  ON 25
 eO_6                 2.589388e-01 1 1  ON 26
 eO_7                -4.454182e-02 1 1  ON 27
 eO_8                -2.220351e-01 1 1  ON 28
 eO_9                -8.172367e-02 1 1  ON 29
eH1_0                -2.452624e-01 1 1  ON 30
eH1_1                -1.440047e-01 1 1  ON 31
eH1_2                -9.729482e-02 1 1  ON 32
eH1_3                -4.316183e-02 1 1  ON 33
eH1_4                 4.571865e-03 1 1  ON 34
eH1_5                 3.923704e-02 1 1  ON 35
eH1_6                 9.689584e-02 1 1  ON 36
eH1_7                 1.518963e-01 1 1  ON 37
eH1_8                 1.774704e-01 1 1  ON 38
eH1_9                 6.340505e-02 1 1  ON 39
eH2_0                -2.415087e-01 1 1  ON 40
eH2_1                -1.407581e-01 1 1  ON 41
eH2_2                -9.390268e-02 1 1  ON 42
eH2_3                -3.938501e-02 1 1  ON 43
eH2_4                 8.675174e-03 1 1  ON 44
eH2_5                 4.234263e-02 1 1  ON 45
eH2_6                 9.887242e-02 1 1  ON 46
eH2_7                 1.517602e-01 1 1  ON 47
eH2_8                 1.793828e-01 1 1  ON 48
eH2_9                 5.163526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9116
    reference variance = 0.198236
====================================================
  Execution time = 2.0399e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4924e-01
  Total weights = 2.0000e+06
  Execution time = 1.9032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349592742227
                                         uncertainty =       0.005570766424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349592742227
                                         uncertainty =       0.005570766424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418050178
  error estimate for blocks of size 2^( 2) =       0.000430496794
  error estimate for blocks of size 2^( 3) =       0.000443577596
  error estimate for blocks of size 2^( 4) =       0.000455394851
  error estimate for blocks of size 2^( 5) =       0.000466250237
  error estimate for blocks of size 2^( 6) =       0.000474965178
  error estimate for blocks of size 2^( 7) =       0.000479888288

      target function =                  N/A
              le_mean =     -16.905711092975
             les_mean =     286.152599286440
             stat err =       0.000469124638
             autocorr =       1.259272329591
              std dev =       0.591212230998
             le_variance =       0.349531902081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349298734752
                                         uncertainty =       0.005560470823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349298734752
                                         uncertainty =       0.005560470823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417874279
  error estimate for blocks of size 2^( 2) =       0.000430324137
  error estimate for blocks of size 2^( 3) =       0.000443410305
  error estimate for blocks of size 2^( 4) =       0.000455229308
  error estimate for blocks of size 2^( 5) =       0.000466081494
  error estimate for blocks of size 2^( 6) =       0.000474783934
  error estimate for blocks of size 2^( 7) =       0.000479703454

      target function =                  N/A
              le_mean =     -16.905713449063
             les_mean =     286.152384873211
             stat err =       0.000468949547
             autocorr =       1.259392091554
              std dev =       0.590963472656
             le_variance =       0.349237826013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349016867794
                                         uncertainty =       0.005548059539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349016867794
                                         uncertainty =       0.005548059539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417705668
  error estimate for blocks of size 2^( 2) =       0.000430160450
  error estimate for blocks of size 2^( 3) =       0.000443254986
  error estimate for blocks of size 2^( 4) =       0.000455084257
  error estimate for blocks of size 2^( 5) =       0.000465946983
  error estimate for blocks of size 2^( 6) =       0.000474658482
  error estimate for blocks of size 2^( 7) =       0.000479580784

      target function =                  N/A
              le_mean =     -16.905713242267
             les_mean =     286.152096105675
             stat err =       0.000468817627
             autocorr =       1.259699992660
              std dev =       0.590725020961
             le_variance =       0.348956050389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349456691526
                                         uncertainty =       0.005564903751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349456691526
                                         uncertainty =       0.005564903751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417968812
  error estimate for blocks of size 2^( 2) =       0.000430417183
  error estimate for blocks of size 2^( 3) =       0.000443500798
  error estimate for blocks of size 2^( 4) =       0.000455320985
  error estimate for blocks of size 2^( 5) =       0.000466178544
  error estimate for blocks of size 2^( 6) =       0.000474893756
  error estimate for blocks of size 2^( 7) =       0.000479816255

      target function =                  N/A
              le_mean =     -16.905711298039
             les_mean =     286.152470173246
             stat err =       0.000469052385
             autocorr =       1.259374638950
              std dev =       0.591097162329
             le_variance =       0.349395855314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905711092975        initial
     3.9062e-02     3.9062e-01             5.2096e-03       -16.905713449063  <--
     1.5625e-01     1.5625e+00             1.3020e-03       -16.905713242267
     6.2500e-01     6.2500e+00             3.2014e-04       -16.905711298039

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 2.9950e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.096221e-01 1 1  ON 0
 uu_1                 1.428158e-01 1 1  ON 1
 uu_2                 4.110405e-02 1 1  ON 2
 uu_3                -2.143177e-02 1 1  ON 3
 uu_4                -6.679565e-02 1 1  ON 4
 uu_5                -1.009110e-01 1 1  ON 5
 uu_6                -1.283046e-01 1 1  ON 6
 uu_7                -1.410597e-01 1 1  ON 7
 uu_8                -1.334907e-01 1 1  ON 8
 uu_9                -1.042523e-01 1 1  ON 9
 ud_0                 4.505994e-01 1 1  ON 10
 ud_1                 1.843309e-01 1 1  ON 11
 ud_2                 6.293274e-02 1 1  ON 12
 ud_3                -9.023085e-03 1 1  ON 13
 ud_4                -6.600997e-02 1 1  ON 14
 ud_5                -1.074780e-01 1 1  ON 15
 ud_6                -1.350368e-01 1 1  ON 16
 ud_7                -1.507702e-01 1 1  ON 17
 ud_8                -1.530927e-01 1 1  ON 18
 ud_9                -1.433990e-01 1 1  ON 19
 eO_0                -7.661194e-01 1 1  ON 20
 eO_1                -4.439283e-01 1 1  ON 21
 eO_2                -2.058399e-02 1 1  ON 22
 eO_3                 3.016164e-01 1 1  ON 23
 eO_4                 5.286919e-01 1 1  ON 24
 eO_5                 4.909074e-01 1 1  ON 25
 eO_6                 2.612110e-01 1 1  ON 26
 eO_7                -4.222400e-02 1 1  ON 27
 eO_8                -2.240680e-01 1 1  ON 28
 eO_9                -8.460536e-02 1 1  ON 29
eH1_0                -2.460841e-01 1 1  ON 30
eH1_1                -1.448464e-01 1 1  ON 31
eH1_2                -9.810446e-02 1 1  ON 32
eH1_3                -4.408486e-02 1 1  ON 33
eH1_4                 3.359448e-03 1 1  ON 34
eH1_5                 3.824806e-02 1 1  ON 35
eH1_6                 9.552145e-02 1 1  ON 36
eH1_7                 1.524339e-01 1 1  ON 37
eH1_8                 1.805537e-01 1 1  ON 38
eH1_9                 6.647061e-02 1 1  ON 39
eH2_0                -2.430586e-01 1 1  ON 40
eH2_1                -1.422411e-01 1 1  ON 41
eH2_2                -9.537231e-02 1 1  ON 42
eH2_3                -4.077791e-02 1 1  ON 43
eH2_4                 7.284075e-03 1 1  ON 44
eH2_5                 4.119085e-02 1 1  ON 45
eH2_6                 9.836246e-02 1 1  ON 46
eH2_7                 1.534297e-01 1 1  ON 47
eH2_8                 1.826225e-01 1 1  ON 48
eH2_9                 5.554282e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6284e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.285906
====================================================
  Execution time = 2.0751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3620e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336213865311
                                         uncertainty =       0.003973445848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336213865311
                                         uncertainty =       0.003973445848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409998101
  error estimate for blocks of size 2^( 2) =       0.000422715634
  error estimate for blocks of size 2^( 3) =       0.000435824027
  error estimate for blocks of size 2^( 4) =       0.000447159082
  error estimate for blocks of size 2^( 5) =       0.000457034544
  error estimate for blocks of size 2^( 6) =       0.000462099859
  error estimate for blocks of size 2^( 7) =       0.000465090173

      target function =                  N/A
              le_mean =     -16.906467377053
             les_mean =     286.164835889452
             stat err =       0.000457845914
             autocorr =       1.247024526331
              std dev =       0.579824875459
             le_variance =       0.336196886201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690646737705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906467377053       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906476120068       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906475860202       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906478469271       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906480942223       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906477834366       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906476379130       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906477471133       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906474089773       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906478743231       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906483146577       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906486152431       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906487776644       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906491409072       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906490872290       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906491429495       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906491394100       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906492729590       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906491739212       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906491835197       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906492775391       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906493293794       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.469894e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906467377053       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906473999618       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906472793666       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906474662982       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906476065421       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906473893550       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906472943808       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906473897634       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906471803809       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906474575364       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906475992593       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906476633720       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906476850283       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906477195828       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906477183858       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 6.374897e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906467377053       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906470738545       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906469278841       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906470483798       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906470704910       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906469894717       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906470257590       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906470218262       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906469696685       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906470414563       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906470495929       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.599697e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.035944 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6447e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.099832e-01 1 1  ON 0
 uu_1                 1.434787e-01 1 1  ON 1
 uu_2                 4.181028e-02 1 1  ON 2
 uu_3                -2.083012e-02 1 1  ON 3
 uu_4                -6.620412e-02 1 1  ON 4
 uu_5                -1.011851e-01 1 1  ON 5
 uu_6                -1.288047e-01 1 1  ON 6
 uu_7                -1.427708e-01 1 1  ON 7
 uu_8                -1.362225e-01 1 1  ON 8
 uu_9                -1.066836e-01 1 1  ON 9
 ud_0                 4.514075e-01 1 1  ON 10
 ud_1                 1.854260e-01 1 1  ON 11
 ud_2                 6.391132e-02 1 1  ON 12
 ud_3                -7.743432e-03 1 1  ON 13
 ud_4                -6.513667e-02 1 1  ON 14
 ud_5                -1.069806e-01 1 1  ON 15
 ud_6                -1.345938e-01 1 1  ON 16
 ud_7                -1.515900e-01 1 1  ON 17
 ud_8                -1.545082e-01 1 1  ON 18
 ud_9                -1.442181e-01 1 1  ON 19
 eO_0                -7.662223e-01 1 1  ON 20
 eO_1                -4.431897e-01 1 1  ON 21
 eO_2                -2.049496e-02 1 1  ON 22
 eO_3                 3.022001e-01 1 1  ON 23
 eO_4                 5.298642e-01 1 1  ON 24
 eO_5                 4.932877e-01 1 1  ON 25
 eO_6                 2.635039e-01 1 1  ON 26
 eO_7                -4.159428e-02 1 1  ON 27
 eO_8                -2.276833e-01 1 1  ON 28
 eO_9                -8.828690e-02 1 1  ON 29
eH1_0                -2.475554e-01 1 1  ON 30
eH1_1                -1.459851e-01 1 1  ON 31
eH1_2                -9.879862e-02 1 1  ON 32
eH1_3                -4.487223e-02 1 1  ON 33
eH1_4                 3.053606e-03 1 1  ON 34
eH1_5                 3.859762e-02 1 1  ON 35
eH1_6                 9.637505e-02 1 1  ON 36
eH1_7                 1.526155e-01 1 1  ON 37
eH1_8                 1.817134e-01 1 1  ON 38
eH1_9                 6.882274e-02 1 1  ON 39
eH2_0                -2.446697e-01 1 1  ON 40
eH2_1                -1.438866e-01 1 1  ON 41
eH2_2                -9.678246e-02 1 1  ON 42
eH2_3                -4.279227e-02 1 1  ON 43
eH2_4                 5.969814e-03 1 1  ON 44
eH2_5                 3.988794e-02 1 1  ON 45
eH2_6                 9.750525e-02 1 1  ON 46
eH2_7                 1.534239e-01 1 1  ON 47
eH2_8                 1.854189e-01 1 1  ON 48
eH2_9                 6.191772e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8914
    reference variance = 0.360902
====================================================
  Execution time = 2.0414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4040e-01
  Total weights = 2.0000e+06
  Execution time = 2.6037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340726789989
                                         uncertainty =       0.004473591435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340726789989
                                         uncertainty =       0.004473591435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412705437
  error estimate for blocks of size 2^( 2) =       0.000425273312
  error estimate for blocks of size 2^( 3) =       0.000437989476
  error estimate for blocks of size 2^( 4) =       0.000450160904
  error estimate for blocks of size 2^( 5) =       0.000460872226
  error estimate for blocks of size 2^( 6) =       0.000469767090
  error estimate for blocks of size 2^( 7) =       0.000474965626

      target function =                  N/A
              le_mean =     -16.906739961135
             les_mean =     286.178507499092
             stat err =       0.000463941461
             autocorr =       1.263705835426
              std dev =       0.583653626716
             le_variance =       0.340651555979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340729732793
                                         uncertainty =       0.004483135619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340729732793
                                         uncertainty =       0.004483135619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412707230
  error estimate for blocks of size 2^( 2) =       0.000425262330
  error estimate for blocks of size 2^( 3) =       0.000437946671
  error estimate for blocks of size 2^( 4) =       0.000450065248
  error estimate for blocks of size 2^( 5) =       0.000460748056
  error estimate for blocks of size 2^( 6) =       0.000469653823
  error estimate for blocks of size 2^( 7) =       0.000474835579

      target function =                  N/A
              le_mean =     -16.906739696476
             les_mean =     286.178501509136
             stat err =       0.000463825677
             autocorr =       1.263064182080
              std dev =       0.583656161666
             le_variance =       0.340654515050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340253159563
                                         uncertainty =       0.004476338976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340253159563
                                         uncertainty =       0.004476338976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412418531
  error estimate for blocks of size 2^( 2) =       0.000424988322
  error estimate for blocks of size 2^( 3) =       0.000437688099
  error estimate for blocks of size 2^( 4) =       0.000449823032
  error estimate for blocks of size 2^( 5) =       0.000460516409
  error estimate for blocks of size 2^( 6) =       0.000469428416
  error estimate for blocks of size 2^( 7) =       0.000474632553

      target function =                  N/A
              le_mean =     -16.906744166413
             les_mean =     286.178176227511
             stat err =       0.000463600103
             autocorr =       1.263603165798
              std dev =       0.583247879590
             le_variance =       0.340178089047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340471899132
                                         uncertainty =       0.004472150218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340471899132
                                         uncertainty =       0.004472150218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412551036
  error estimate for blocks of size 2^( 2) =       0.000425122489
  error estimate for blocks of size 2^( 3) =       0.000437838920
  error estimate for blocks of size 2^( 4) =       0.000450006440
  error estimate for blocks of size 2^( 5) =       0.000460714869
  error estimate for blocks of size 2^( 6) =       0.000469613851
  error estimate for blocks of size 2^( 7) =       0.000474815605

      target function =                  N/A
              le_mean =     -16.906738804298
             les_mean =     286.178213541395
             stat err =       0.000463787691
             autocorr =       1.263813739398
              std dev =       0.583435270477
             le_variance =       0.340396714836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906739961135        initial
     9.7656e-03     9.7656e-02             2.4699e-02       -16.906739696476
     3.9062e-02     3.9062e-01             6.3749e-03       -16.906744166413  <--
     1.5625e-01     1.5625e+00             1.5997e-03       -16.906738804298

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.1545e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.099832e-01 1 1  ON 0
 uu_1                 1.434787e-01 1 1  ON 1
 uu_2                 4.181028e-02 1 1  ON 2
 uu_3                -2.083012e-02 1 1  ON 3
 uu_4                -6.620412e-02 1 1  ON 4
 uu_5                -1.011851e-01 1 1  ON 5
 uu_6                -1.288047e-01 1 1  ON 6
 uu_7                -1.427708e-01 1 1  ON 7
 uu_8                -1.362225e-01 1 1  ON 8
 uu_9                -1.066836e-01 1 1  ON 9
 ud_0                 4.514075e-01 1 1  ON 10
 ud_1                 1.854260e-01 1 1  ON 11
 ud_2                 6.391132e-02 1 1  ON 12
 ud_3                -7.743432e-03 1 1  ON 13
 ud_4                -6.513667e-02 1 1  ON 14
 ud_5                -1.069806e-01 1 1  ON 15
 ud_6                -1.345938e-01 1 1  ON 16
 ud_7                -1.515900e-01 1 1  ON 17
 ud_8                -1.545082e-01 1 1  ON 18
 ud_9                -1.442181e-01 1 1  ON 19
 eO_0                -7.662223e-01 1 1  ON 20
 eO_1                -4.431897e-01 1 1  ON 21
 eO_2                -2.049496e-02 1 1  ON 22
 eO_3                 3.022001e-01 1 1  ON 23
 eO_4                 5.298642e-01 1 1  ON 24
 eO_5                 4.932877e-01 1 1  ON 25
 eO_6                 2.635039e-01 1 1  ON 26
 eO_7                -4.159428e-02 1 1  ON 27
 eO_8                -2.276833e-01 1 1  ON 28
 eO_9                -8.828690e-02 1 1  ON 29
eH1_0                -2.475554e-01 1 1  ON 30
eH1_1                -1.459851e-01 1 1  ON 31
eH1_2                -9.879862e-02 1 1  ON 32
eH1_3                -4.487223e-02 1 1  ON 33
eH1_4                 3.053606e-03 1 1  ON 34
eH1_5                 3.859762e-02 1 1  ON 35
eH1_6                 9.637505e-02 1 1  ON 36
eH1_7                 1.526155e-01 1 1  ON 37
eH1_8                 1.817134e-01 1 1  ON 38
eH1_9                 6.882274e-02 1 1  ON 39
eH2_0                -2.446697e-01 1 1  ON 40
eH2_1                -1.438866e-01 1 1  ON 41
eH2_2                -9.678246e-02 1 1  ON 42
eH2_3                -4.279227e-02 1 1  ON 43
eH2_4                 5.969814e-03 1 1  ON 44
eH2_5                 3.988794e-02 1 1  ON 45
eH2_6                 9.750525e-02 1 1  ON 46
eH2_7                 1.534239e-01 1 1  ON 47
eH2_8                 1.854189e-01 1 1  ON 48
eH2_9                 6.191772e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8000e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9208
    reference variance = 0.496217
====================================================
  Execution time = 2.0801e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3571e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335759387884
                                         uncertainty =       0.002750170908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335759387884
                                         uncertainty =       0.002750170908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409700722
  error estimate for blocks of size 2^( 2) =       0.000422636641
  error estimate for blocks of size 2^( 3) =       0.000436397864
  error estimate for blocks of size 2^( 4) =       0.000448913090
  error estimate for blocks of size 2^( 5) =       0.000460633651
  error estimate for blocks of size 2^( 6) =       0.000469923265
  error estimate for blocks of size 2^( 7) =       0.000475441418

      target function =                  N/A
              le_mean =     -16.905811319554
             les_mean =     286.142165568426
             stat err =       0.000463727856
             autocorr =       1.281129140294
              std dev =       0.579404318172
             le_variance =       0.335709363917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581131955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811319554       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809974664       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905809740257       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905813120377       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905809485702       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905811668366       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905816710502       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905822168371       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905822840794       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905826071985       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905826286101       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905825263664       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905825680949       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905831398605       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905830148779       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905829304336       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905829670859       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905829251937       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905829394701       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905829797538       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905829836167       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905829876497       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.317728e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811319554       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905810104456       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905809910446       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812628543       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905809752729       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905810996606       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905814841780       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905816518030       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905817466814       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905818331590       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905817167792       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905817167704       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905816443846       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905817533002       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.827352e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811319554       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905810442879       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905810317693       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905811916433       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905810644653       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905810337213       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905812108239       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812737852       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905812624026       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905812506483       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905812688544       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905812486580       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.475219e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045783 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6433e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.102133e-01 1 1  ON 0
 uu_1                 1.432240e-01 1 1  ON 1
 uu_2                 4.128530e-02 1 1  ON 2
 uu_3                -2.155522e-02 1 1  ON 3
 uu_4                -6.764213e-02 1 1  ON 4
 uu_5                -1.026147e-01 1 1  ON 5
 uu_6                -1.297999e-01 1 1  ON 6
 uu_7                -1.439770e-01 1 1  ON 7
 uu_8                -1.358532e-01 1 1  ON 8
 uu_9                -1.059057e-01 1 1  ON 9
 ud_0                 4.521836e-01 1 1  ON 10
 ud_1                 1.855204e-01 1 1  ON 11
 ud_2                 6.426753e-02 1 1  ON 12
 ud_3                -7.658633e-03 1 1  ON 13
 ud_4                -6.526337e-02 1 1  ON 14
 ud_5                -1.072654e-01 1 1  ON 15
 ud_6                -1.352238e-01 1 1  ON 16
 ud_7                -1.520243e-01 1 1  ON 17
 ud_8                -1.534188e-01 1 1  ON 18
 ud_9                -1.428363e-01 1 1  ON 19
 eO_0                -7.665155e-01 1 1  ON 20
 eO_1                -4.433073e-01 1 1  ON 21
 eO_2                -2.033088e-02 1 1  ON 22
 eO_3                 3.032031e-01 1 1  ON 23
 eO_4                 5.312588e-01 1 1  ON 24
 eO_5                 4.939583e-01 1 1  ON 25
 eO_6                 2.650857e-01 1 1  ON 26
 eO_7                -4.129774e-02 1 1  ON 27
 eO_8                -2.286083e-01 1 1  ON 28
 eO_9                -9.150195e-02 1 1  ON 29
eH1_0                -2.498717e-01 1 1  ON 30
eH1_1                -1.487794e-01 1 1  ON 31
eH1_2                -1.012636e-01 1 1  ON 32
eH1_3                -4.672663e-02 1 1  ON 33
eH1_4                 2.185764e-03 1 1  ON 34
eH1_5                 3.766733e-02 1 1  ON 35
eH1_6                 9.540322e-02 1 1  ON 36
eH1_7                 1.542043e-01 1 1  ON 37
eH1_8                 1.855939e-01 1 1  ON 38
eH1_9                 7.465009e-02 1 1  ON 39
eH2_0                -2.477887e-01 1 1  ON 40
eH2_1                -1.461425e-01 1 1  ON 41
eH2_2                -9.855469e-02 1 1  ON 42
eH2_3                -4.351663e-02 1 1  ON 43
eH2_4                 4.824833e-03 1 1  ON 44
eH2_5                 3.946155e-02 1 1  ON 45
eH2_6                 9.749739e-02 1 1  ON 46
eH2_7                 1.560535e-01 1 1  ON 47
eH2_8                 1.877770e-01 1 1  ON 48
eH2_9                 6.646409e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9422
    reference variance = 0.274658
====================================================
  Execution time = 2.0403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3504e-01
  Total weights = 2.0000e+06
  Execution time = 1.9111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334313324058
                                         uncertainty =       0.007145279387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334313324058
                                         uncertainty =       0.007145279387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408855139
  error estimate for blocks of size 2^( 2) =       0.000421651283
  error estimate for blocks of size 2^( 3) =       0.000434970778
  error estimate for blocks of size 2^( 4) =       0.000447217896
  error estimate for blocks of size 2^( 5) =       0.000458507960
  error estimate for blocks of size 2^( 6) =       0.000466204315
  error estimate for blocks of size 2^( 7) =       0.000470634363

      target function =                  N/A
              le_mean =     -16.906085407817
             les_mean =     286.150048698048
             stat err =       0.000460641134
             autocorr =       1.269364976740
              std dev =       0.578208482144
             le_variance =       0.334325048823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330700796
                                         uncertainty =       0.007134254977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330700796
                                         uncertainty =       0.007134254977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409476744
  error estimate for blocks of size 2^( 2) =       0.000422272024
  error estimate for blocks of size 2^( 3) =       0.000435575050
  error estimate for blocks of size 2^( 4) =       0.000447797379
  error estimate for blocks of size 2^( 5) =       0.000459039784
  error estimate for blocks of size 2^( 6) =       0.000466674676
  error estimate for blocks of size 2^( 7) =       0.000471063368

      target function =                  N/A
              le_mean =     -16.906087519503
             les_mean =     286.151137457552
             stat err =       0.000461143802
             autocorr =       1.268277442818
              std dev =       0.579087565169
             le_variance =       0.335342408133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335776234186
                                         uncertainty =       0.007130601094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335776234186
                                         uncertainty =       0.007130601094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409748715
  error estimate for blocks of size 2^( 2) =       0.000422537899
  error estimate for blocks of size 2^( 3) =       0.000435843641
  error estimate for blocks of size 2^( 4) =       0.000448077514
  error estimate for blocks of size 2^( 5) =       0.000459329172
  error estimate for blocks of size 2^( 6) =       0.000466953717
  error estimate for blocks of size 2^( 7) =       0.000471342727

      target function =                  N/A
              le_mean =     -16.906092498148
             les_mean =     286.151751407090
             stat err =       0.000461425783
             autocorr =       1.268143832928
              std dev =       0.579472190059
             le_variance =       0.335788019052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334742208437
                                         uncertainty =       0.007139520485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334742208437
                                         uncertainty =       0.007139520485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409117296
  error estimate for blocks of size 2^( 2) =       0.000421905696
  error estimate for blocks of size 2^( 3) =       0.000435219867
  error estimate for blocks of size 2^( 4) =       0.000447463095
  error estimate for blocks of size 2^( 5) =       0.000458745992
  error estimate for blocks of size 2^( 6) =       0.000466422042
  error estimate for blocks of size 2^( 7) =       0.000470842738

      target function =                  N/A
              le_mean =     -16.906084193005
             les_mean =     286.150436497529
             stat err =       0.000460868467
             autocorr =       1.268990314606
              std dev =       0.578579228728
             le_variance =       0.334753923916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906085407817        initial
     9.7656e-03     9.7656e-02             2.3177e-02       -16.906087519503
     3.9062e-02     3.9062e-01             5.8274e-03       -16.906092498148  <--
     1.5625e-01     1.5625e+00             1.4752e-03       -16.906084193005

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 2.9987e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.102133e-01 1 1  ON 0
 uu_1                 1.432240e-01 1 1  ON 1
 uu_2                 4.128530e-02 1 1  ON 2
 uu_3                -2.155522e-02 1 1  ON 3
 uu_4                -6.764213e-02 1 1  ON 4
 uu_5                -1.026147e-01 1 1  ON 5
 uu_6                -1.297999e-01 1 1  ON 6
 uu_7                -1.439770e-01 1 1  ON 7
 uu_8                -1.358532e-01 1 1  ON 8
 uu_9                -1.059057e-01 1 1  ON 9
 ud_0                 4.521836e-01 1 1  ON 10
 ud_1                 1.855204e-01 1 1  ON 11
 ud_2                 6.426753e-02 1 1  ON 12
 ud_3                -7.658633e-03 1 1  ON 13
 ud_4                -6.526337e-02 1 1  ON 14
 ud_5                -1.072654e-01 1 1  ON 15
 ud_6                -1.352238e-01 1 1  ON 16
 ud_7                -1.520243e-01 1 1  ON 17
 ud_8                -1.534188e-01 1 1  ON 18
 ud_9                -1.428363e-01 1 1  ON 19
 eO_0                -7.665155e-01 1 1  ON 20
 eO_1                -4.433073e-01 1 1  ON 21
 eO_2                -2.033088e-02 1 1  ON 22
 eO_3                 3.032031e-01 1 1  ON 23
 eO_4                 5.312588e-01 1 1  ON 24
 eO_5                 4.939583e-01 1 1  ON 25
 eO_6                 2.650857e-01 1 1  ON 26
 eO_7                -4.129774e-02 1 1  ON 27
 eO_8                -2.286083e-01 1 1  ON 28
 eO_9                -9.150195e-02 1 1  ON 29
eH1_0                -2.498717e-01 1 1  ON 30
eH1_1                -1.487794e-01 1 1  ON 31
eH1_2                -1.012636e-01 1 1  ON 32
eH1_3                -4.672663e-02 1 1  ON 33
eH1_4                 2.185764e-03 1 1  ON 34
eH1_5                 3.766733e-02 1 1  ON 35
eH1_6                 9.540322e-02 1 1  ON 36
eH1_7                 1.542043e-01 1 1  ON 37
eH1_8                 1.855939e-01 1 1  ON 38
eH1_9                 7.465009e-02 1 1  ON 39
eH2_0                -2.477887e-01 1 1  ON 40
eH2_1                -1.461425e-01 1 1  ON 41
eH2_2                -9.855469e-02 1 1  ON 42
eH2_3                -4.351663e-02 1 1  ON 43
eH2_4                 4.824833e-03 1 1  ON 44
eH2_5                 3.946155e-02 1 1  ON 45
eH2_6                 9.749739e-02 1 1  ON 46
eH2_7                 1.560535e-01 1 1  ON 47
eH2_8                 1.877770e-01 1 1  ON 48
eH2_9                 6.646409e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6446e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9532
    reference variance = 0.217507
====================================================
  Execution time = 2.0812e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3813e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338173705391
                                         uncertainty =       0.002568216839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338173705391
                                         uncertainty =       0.002568216839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411176983
  error estimate for blocks of size 2^( 2) =       0.000424126499
  error estimate for blocks of size 2^( 3) =       0.000437287849
  error estimate for blocks of size 2^( 4) =       0.000449722671
  error estimate for blocks of size 2^( 5) =       0.000459269005
  error estimate for blocks of size 2^( 6) =       0.000465272417
  error estimate for blocks of size 2^( 7) =       0.000469989754

      target function =                  N/A
              le_mean =     -16.906686662663
             les_mean =     286.174186763524
             stat err =       0.000461063462
             autocorr =       1.257372106490
              std dev =       0.581492066258
             le_variance =       0.338133023120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690668666266e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906686662663       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906688196398       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906689189389       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906688449138       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906689956459       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906689972759       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906696020020       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906701005244       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906696753445       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906699341602       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906698075239       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906709307400       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906710989521       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906713543161       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906714946116       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906715814656       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906716775025       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906716706024       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906714395039       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906713726020       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906714107422       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906713968173       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.990917e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906686662663       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906687983034       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906689084504       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906688362970       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906688552614       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906690160942       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906694476415       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906694843099       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906693911201       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906695486973       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906693002756       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906695583077       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906696168556       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906696602912       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906696620298       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.967441e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906686662663       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906687510982       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906688636574       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906687990949       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906687217314       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906688440903       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906689144237       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906690295193       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906690141495       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906689853416       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906689528432       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906689895667       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.261896e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055712 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6454e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.099856e-01 1 1  ON 0
 uu_1                 1.433429e-01 1 1  ON 1
 uu_2                 4.161747e-02 1 1  ON 2
 uu_3                -2.118286e-02 1 1  ON 3
 uu_4                -6.678846e-02 1 1  ON 4
 uu_5                -1.016701e-01 1 1  ON 5
 uu_6                -1.295498e-01 1 1  ON 6
 uu_7                -1.435795e-01 1 1  ON 7
 uu_8                -1.369069e-01 1 1  ON 8
 uu_9                -1.099127e-01 1 1  ON 9
 ud_0                 4.525666e-01 1 1  ON 10
 ud_1                 1.864192e-01 1 1  ON 11
 ud_2                 6.516805e-02 1 1  ON 12
 ud_3                -6.735019e-03 1 1  ON 13
 ud_4                -6.426252e-02 1 1  ON 14
 ud_5                -1.062511e-01 1 1  ON 15
 ud_6                -1.347321e-01 1 1  ON 16
 ud_7                -1.517768e-01 1 1  ON 17
 ud_8                -1.543903e-01 1 1  ON 18
 ud_9                -1.455644e-01 1 1  ON 19
 eO_0                -7.660524e-01 1 1  ON 20
 eO_1                -4.428178e-01 1 1  ON 21
 eO_2                -1.979182e-02 1 1  ON 22
 eO_3                 3.037821e-01 1 1  ON 23
 eO_4                 5.317493e-01 1 1  ON 24
 eO_5                 4.961982e-01 1 1  ON 25
 eO_6                 2.674117e-01 1 1  ON 26
 eO_7                -3.983392e-02 1 1  ON 27
 eO_8                -2.321358e-01 1 1  ON 28
 eO_9                -9.583771e-02 1 1  ON 29
eH1_0                -2.502232e-01 1 1  ON 30
eH1_1                -1.491390e-01 1 1  ON 31
eH1_2                -1.020006e-01 1 1  ON 32
eH1_3                -4.778222e-02 1 1  ON 33
eH1_4                 2.049710e-04 1 1  ON 34
eH1_5                 3.510682e-02 1 1  ON 35
eH1_6                 9.436477e-02 1 1  ON 36
eH1_7                 1.532416e-01 1 1  ON 37
eH1_8                 1.885159e-01 1 1  ON 38
eH1_9                 7.961753e-02 1 1  ON 39
eH2_0                -2.492234e-01 1 1  ON 40
eH2_1                -1.463928e-01 1 1  ON 41
eH2_2                -9.914578e-02 1 1  ON 42
eH2_3                -4.479007e-02 1 1  ON 43
eH2_4                 4.255876e-03 1 1  ON 44
eH2_5                 3.871053e-02 1 1  ON 45
eH2_6                 9.583376e-02 1 1  ON 46
eH2_7                 1.563990e-01 1 1  ON 47
eH2_8                 1.905363e-01 1 1  ON 48
eH2_9                 7.053724e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8788
    reference variance = 0.227082
====================================================
  Execution time = 2.0553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3730e-01
  Total weights = 2.0000e+06
  Execution time = 1.9168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338057018284
                                         uncertainty =       0.003019500421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338057018284
                                         uncertainty =       0.003019500421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411109431
  error estimate for blocks of size 2^( 2) =       0.000424117437
  error estimate for blocks of size 2^( 3) =       0.000437457607
  error estimate for blocks of size 2^( 4) =       0.000449544057
  error estimate for blocks of size 2^( 5) =       0.000458824096
  error estimate for blocks of size 2^( 6) =       0.000465884765
  error estimate for blocks of size 2^( 7) =       0.000470383985

      target function =                  N/A
              le_mean =     -16.905564903285
             les_mean =     286.136146459142
             stat err =       0.000461159226
             autocorr =       1.258307899832
              std dev =       0.581396533340
             le_variance =       0.338021928980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337395188972
                                         uncertainty =       0.003011047143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337395188972
                                         uncertainty =       0.003011047143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410706826
  error estimate for blocks of size 2^( 2) =       0.000423720797
  error estimate for blocks of size 2^( 3) =       0.000437050085
  error estimate for blocks of size 2^( 4) =       0.000449117419
  error estimate for blocks of size 2^( 5) =       0.000458384408
  error estimate for blocks of size 2^( 6) =       0.000465466971
  error estimate for blocks of size 2^( 7) =       0.000469985316

      target function =                  N/A
              le_mean =     -16.905563672606
             les_mean =     286.135443113032
             stat err =       0.000460738528
             autocorr =       1.258476820291
              std dev =       0.580827162902
             le_variance =       0.337360193165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336642378950
                                         uncertainty =       0.003003190206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336642378950
                                         uncertainty =       0.003003190206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410248530
  error estimate for blocks of size 2^( 2) =       0.000423286605
  error estimate for blocks of size 2^( 3) =       0.000436645268
  error estimate for blocks of size 2^( 4) =       0.000448745404
  error estimate for blocks of size 2^( 5) =       0.000458039500
  error estimate for blocks of size 2^( 6) =       0.000465127635
  error estimate for blocks of size 2^( 7) =       0.000469649613

      target function =                  N/A
              le_mean =     -16.905567947734
             les_mean =     286.134835179511
             stat err =       0.000460390538
             autocorr =       1.259385567710
              std dev =       0.580179034739
             le_variance =       0.336607712351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337519870808
                                         uncertainty =       0.003013723084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337519870808
                                         uncertainty =       0.003013723084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410782778
  error estimate for blocks of size 2^( 2) =       0.000423804518
  error estimate for blocks of size 2^( 3) =       0.000437155935
  error estimate for blocks of size 2^( 4) =       0.000449251381
  error estimate for blocks of size 2^( 5) =       0.000458539027
  error estimate for blocks of size 2^( 6) =       0.000465602661
  error estimate for blocks of size 2^( 7) =       0.000470105934

      target function =                  N/A
              le_mean =     -16.905564058296
             les_mean =     286.135580941754
             stat err =       0.000460874751
             autocorr =       1.258755485661
              std dev =       0.580934575781
             le_variance =       0.337484981338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905564903285        initial
     9.7656e-03     9.7656e-02             1.9909e-02       -16.905563672606
     3.9062e-02     3.9062e-01             4.9674e-03       -16.905567947734  <--
     1.5625e-01     1.5625e+00             1.2619e-03       -16.905564058296

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.0161e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.099856e-01 1 1  ON 0
 uu_1                 1.433429e-01 1 1  ON 1
 uu_2                 4.161747e-02 1 1  ON 2
 uu_3                -2.118286e-02 1 1  ON 3
 uu_4                -6.678846e-02 1 1  ON 4
 uu_5                -1.016701e-01 1 1  ON 5
 uu_6                -1.295498e-01 1 1  ON 6
 uu_7                -1.435795e-01 1 1  ON 7
 uu_8                -1.369069e-01 1 1  ON 8
 uu_9                -1.099127e-01 1 1  ON 9
 ud_0                 4.525666e-01 1 1  ON 10
 ud_1                 1.864192e-01 1 1  ON 11
 ud_2                 6.516805e-02 1 1  ON 12
 ud_3                -6.735019e-03 1 1  ON 13
 ud_4                -6.426252e-02 1 1  ON 14
 ud_5                -1.062511e-01 1 1  ON 15
 ud_6                -1.347321e-01 1 1  ON 16
 ud_7                -1.517768e-01 1 1  ON 17
 ud_8                -1.543903e-01 1 1  ON 18
 ud_9                -1.455644e-01 1 1  ON 19
 eO_0                -7.660524e-01 1 1  ON 20
 eO_1                -4.428178e-01 1 1  ON 21
 eO_2                -1.979182e-02 1 1  ON 22
 eO_3                 3.037821e-01 1 1  ON 23
 eO_4                 5.317493e-01 1 1  ON 24
 eO_5                 4.961982e-01 1 1  ON 25
 eO_6                 2.674117e-01 1 1  ON 26
 eO_7                -3.983392e-02 1 1  ON 27
 eO_8                -2.321358e-01 1 1  ON 28
 eO_9                -9.583771e-02 1 1  ON 29
eH1_0                -2.502232e-01 1 1  ON 30
eH1_1                -1.491390e-01 1 1  ON 31
eH1_2                -1.020006e-01 1 1  ON 32
eH1_3                -4.778222e-02 1 1  ON 33
eH1_4                 2.049710e-04 1 1  ON 34
eH1_5                 3.510682e-02 1 1  ON 35
eH1_6                 9.436477e-02 1 1  ON 36
eH1_7                 1.532416e-01 1 1  ON 37
eH1_8                 1.885159e-01 1 1  ON 38
eH1_9                 7.961753e-02 1 1  ON 39
eH2_0                -2.492234e-01 1 1  ON 40
eH2_1                -1.463928e-01 1 1  ON 41
eH2_2                -9.914578e-02 1 1  ON 42
eH2_3                -4.479007e-02 1 1  ON 43
eH2_4                 4.255876e-03 1 1  ON 44
eH2_5                 3.871053e-02 1 1  ON 45
eH2_6                 9.583376e-02 1 1  ON 46
eH2_7                 1.563990e-01 1 1  ON 47
eH2_8                 1.905363e-01 1 1  ON 48
eH2_9                 7.053724e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6623e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9436
    reference variance = 0.192133
====================================================
  Execution time = 2.1197e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4004e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339809193378
                                         uncertainty =       0.004679171954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339809193378
                                         uncertainty =       0.004679171954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412337614
  error estimate for blocks of size 2^( 2) =       0.000424982099
  error estimate for blocks of size 2^( 3) =       0.000437906345
  error estimate for blocks of size 2^( 4) =       0.000450364785
  error estimate for blocks of size 2^( 5) =       0.000460123385
  error estimate for blocks of size 2^( 6) =       0.000469134185
  error estimate for blocks of size 2^( 7) =       0.000472677800

      target function =                  N/A
              le_mean =     -16.906547157819
             les_mean =     286.171381245020
             stat err =       0.000463075039
             autocorr =       1.261237389963
              std dev =       0.583133445679
             le_variance =       0.340044615470


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690654715782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906547157819       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906549383200       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906553492896       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906554773736       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906554847916       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906556896738       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906554150553       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906559372393       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906565381446       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906563084588       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906563148413       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906565092712       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906564608725       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906563387095       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906567595092       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906566807085       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906566564919       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906567649937       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906568078976       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906568355766       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906568470787       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.893616e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906547157819       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906549184051       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906552431278       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906553521016       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906553922186       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906555454665       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906553044828       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906556511718       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906558273099       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906556879463       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906557046253       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906556736082       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906556881264       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906556335132       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906556916311       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.993782e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906547157819       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906548649935       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906550428815       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906551326154       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906551999099       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906551978539       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906551455222       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906552378219       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906552426907       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906552114956       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906552367493       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.258752e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6839e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.106212e-01 1 1  ON 0
 uu_1                 1.436724e-01 1 1  ON 1
 uu_2                 4.198232e-02 1 1  ON 2
 uu_3                -2.083166e-02 1 1  ON 3
 uu_4                -6.671615e-02 1 1  ON 4
 uu_5                -1.018812e-01 1 1  ON 5
 uu_6                -1.301664e-01 1 1  ON 6
 uu_7                -1.442130e-01 1 1  ON 7
 uu_8                -1.375484e-01 1 1  ON 8
 uu_9                -1.120473e-01 1 1  ON 9
 ud_0                 4.533060e-01 1 1  ON 10
 ud_1                 1.871239e-01 1 1  ON 11
 ud_2                 6.559181e-02 1 1  ON 12
 ud_3                -6.332899e-03 1 1  ON 13
 ud_4                -6.400190e-02 1 1  ON 14
 ud_5                -1.061377e-01 1 1  ON 15
 ud_6                -1.341807e-01 1 1  ON 16
 ud_7                -1.526361e-01 1 1  ON 17
 ud_8                -1.540398e-01 1 1  ON 18
 ud_9                -1.447044e-01 1 1  ON 19
 eO_0                -7.649323e-01 1 1  ON 20
 eO_1                -4.417496e-01 1 1  ON 21
 eO_2                -1.912105e-02 1 1  ON 22
 eO_3                 3.052755e-01 1 1  ON 23
 eO_4                 5.338292e-01 1 1  ON 24
 eO_5                 4.976081e-01 1 1  ON 25
 eO_6                 2.670086e-01 1 1  ON 26
 eO_7                -3.989019e-02 1 1  ON 27
 eO_8                -2.351290e-01 1 1  ON 28
 eO_9                -9.950427e-02 1 1  ON 29
eH1_0                -2.516711e-01 1 1  ON 30
eH1_1                -1.508730e-01 1 1  ON 31
eH1_2                -1.035880e-01 1 1  ON 32
eH1_3                -4.855992e-02 1 1  ON 33
eH1_4                -3.917043e-04 1 1  ON 34
eH1_5                 3.418254e-02 1 1  ON 35
eH1_6                 9.413956e-02 1 1  ON 36
eH1_7                 1.540691e-01 1 1  ON 37
eH1_8                 1.903997e-01 1 1  ON 38
eH1_9                 8.420869e-02 1 1  ON 39
eH2_0                -2.499829e-01 1 1  ON 40
eH2_1                -1.483430e-01 1 1  ON 41
eH2_2                -1.007882e-01 1 1  ON 42
eH2_3                -4.584257e-02 1 1  ON 43
eH2_4                 3.249333e-03 1 1  ON 44
eH2_5                 3.855323e-02 1 1  ON 45
eH2_6                 9.682178e-02 1 1  ON 46
eH2_7                 1.556608e-01 1 1  ON 47
eH2_8                 1.920317e-01 1 1  ON 48
eH2_9                 7.553102e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8699
    reference variance = 0.227699
====================================================
  Execution time = 2.0538e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3294e-01
  Total weights = 2.0000e+06
  Execution time = 1.9045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559624600
                                         uncertainty =       0.002747514706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559624600
                                         uncertainty =       0.002747514706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407779170
  error estimate for blocks of size 2^( 2) =       0.000421033682
  error estimate for blocks of size 2^( 3) =       0.000434586241
  error estimate for blocks of size 2^( 4) =       0.000447173566
  error estimate for blocks of size 2^( 5) =       0.000459078941
  error estimate for blocks of size 2^( 6) =       0.000468465639
  error estimate for blocks of size 2^( 7) =       0.000475068447

      target function =                  N/A
              le_mean =     -16.905501131795
             les_mean =     286.128536053732
             stat err =       0.000462446649
             autocorr =       1.286095438073
              std dev =       0.576686832589
             le_variance =       0.332567702881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333074334694
                                         uncertainty =       0.002748947316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333074334694
                                         uncertainty =       0.002748947316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408094480
  error estimate for blocks of size 2^( 2) =       0.000421325283
  error estimate for blocks of size 2^( 3) =       0.000434839930
  error estimate for blocks of size 2^( 4) =       0.000447383376
  error estimate for blocks of size 2^( 5) =       0.000459251485
  error estimate for blocks of size 2^( 6) =       0.000468648829
  error estimate for blocks of size 2^( 7) =       0.000475231961

      target function =                  N/A
              le_mean =     -16.905494023416
             les_mean =     286.128810217659
             stat err =       0.000462628913
             autocorr =       1.285121244406
              std dev =       0.577132747683
             le_variance =       0.333082208448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333334585411
                                         uncertainty =       0.002748061549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333334585411
                                         uncertainty =       0.002748061549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408253730
  error estimate for blocks of size 2^( 2) =       0.000421474516
  error estimate for blocks of size 2^( 3) =       0.000434980956
  error estimate for blocks of size 2^( 4) =       0.000447513536
  error estimate for blocks of size 2^( 5) =       0.000459377165
  error estimate for blocks of size 2^( 6) =       0.000468783912
  error estimate for blocks of size 2^( 7) =       0.000475357263

      target function =                  N/A
              le_mean =     -16.905493305961
             les_mean =     286.129045966992
             stat err =       0.000462757969
             autocorr =       1.284835391144
              std dev =       0.577357961567
             le_variance =       0.333342215785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332813860922
                                         uncertainty =       0.002747522890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332813860922
                                         uncertainty =       0.002747522890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407934914
  error estimate for blocks of size 2^( 2) =       0.000421177208
  error estimate for blocks of size 2^( 3) =       0.000434715825
  error estimate for blocks of size 2^( 4) =       0.000447287204
  error estimate for blocks of size 2^( 5) =       0.000459179845
  error estimate for blocks of size 2^( 6) =       0.000468570190
  error estimate for blocks of size 2^( 7) =       0.000475160465

      target function =                  N/A
              le_mean =     -16.905496875254
             les_mean =     286.128646220143
             stat err =       0.000462549426
             autocorr =       1.285684889719
              std dev =       0.576907087257
             le_variance =       0.332821787327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905501131795        initial  <--
     9.7656e-03     9.7656e-02             1.8936e-02       -16.905494023416
     3.9062e-02     3.9062e-01             4.9938e-03       -16.905493305961
     1.5625e-01     1.5625e+00             1.2588e-03       -16.905496875254

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1612
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.099856e-01 1 1  ON 0
 uu_1                 1.433429e-01 1 1  ON 1
 uu_2                 4.161747e-02 1 1  ON 2
 uu_3                -2.118286e-02 1 1  ON 3
 uu_4                -6.678846e-02 1 1  ON 4
 uu_5                -1.016701e-01 1 1  ON 5
 uu_6                -1.295498e-01 1 1  ON 6
 uu_7                -1.435795e-01 1 1  ON 7
 uu_8                -1.369069e-01 1 1  ON 8
 uu_9                -1.099127e-01 1 1  ON 9
 ud_0                 4.525666e-01 1 1  ON 10
 ud_1                 1.864192e-01 1 1  ON 11
 ud_2                 6.516805e-02 1 1  ON 12
 ud_3                -6.735019e-03 1 1  ON 13
 ud_4                -6.426252e-02 1 1  ON 14
 ud_5                -1.062511e-01 1 1  ON 15
 ud_6                -1.347321e-01 1 1  ON 16
 ud_7                -1.517768e-01 1 1  ON 17
 ud_8                -1.543903e-01 1 1  ON 18
 ud_9                -1.455644e-01 1 1  ON 19
 eO_0                -7.660524e-01 1 1  ON 20
 eO_1                -4.428178e-01 1 1  ON 21
 eO_2                -1.979182e-02 1 1  ON 22
 eO_3                 3.037821e-01 1 1  ON 23
 eO_4                 5.317493e-01 1 1  ON 24
 eO_5                 4.961982e-01 1 1  ON 25
 eO_6                 2.674117e-01 1 1  ON 26
 eO_7                -3.983392e-02 1 1  ON 27
 eO_8                -2.321358e-01 1 1  ON 28
 eO_9                -9.583771e-02 1 1  ON 29
eH1_0                -2.502232e-01 1 1  ON 30
eH1_1                -1.491390e-01 1 1  ON 31
eH1_2                -1.020006e-01 1 1  ON 32
eH1_3                -4.778222e-02 1 1  ON 33
eH1_4                 2.049710e-04 1 1  ON 34
eH1_5                 3.510682e-02 1 1  ON 35
eH1_6                 9.436477e-02 1 1  ON 36
eH1_7                 1.532416e-01 1 1  ON 37
eH1_8                 1.885159e-01 1 1  ON 38
eH1_9                 7.961753e-02 1 1  ON 39
eH2_0                -2.492234e-01 1 1  ON 40
eH2_1                -1.463928e-01 1 1  ON 41
eH2_2                -9.914578e-02 1 1  ON 42
eH2_3                -4.479007e-02 1 1  ON 43
eH2_4                 4.255876e-03 1 1  ON 44
eH2_5                 3.871053e-02 1 1  ON 45
eH2_6                 9.583376e-02 1 1  ON 46
eH2_7                 1.563990e-01 1 1  ON 47
eH2_8                 1.905363e-01 1 1  ON 48
eH2_9                 7.053724e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8885
    reference variance = 0.610295
====================================================
  Execution time = 2.0889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2802e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328015595798
                                         uncertainty =       0.001943929637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328015595798
                                         uncertainty =       0.001943929637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404983809
  error estimate for blocks of size 2^( 2) =       0.000418167314
  error estimate for blocks of size 2^( 3) =       0.000431419810
  error estimate for blocks of size 2^( 4) =       0.000443870965
  error estimate for blocks of size 2^( 5) =       0.000455066579
  error estimate for blocks of size 2^( 6) =       0.000463740641
  error estimate for blocks of size 2^( 7) =       0.000467609506

      target function =                  N/A
              le_mean =     -16.905956810691
             les_mean =     286.139399292132
             stat err =       0.000457571923
             autocorr =       1.276566411817
              std dev =       0.572733595299
             le_variance =       0.328023771184


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595681069e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905956810691       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905956760465       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905959907069       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905960908236       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905960966632       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905962429880       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905963520138       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905962408673       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905962504763       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905962402059       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905962670964       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905962927224       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905963266890       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.892572e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905956810691       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905956783435       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905958199553       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905958661784       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905958513296       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905958681647       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905959007777       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905958754197       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905958656405       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905958722004       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.001788e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905956810691       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905956801058       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905957250756       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905957346546       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905957280820       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905957294249       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905957365019       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905957309999       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905957295331       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.524419e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6514e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.101111e-01 1 1  ON 0
 uu_1                 1.433011e-01 1 1  ON 1
 uu_2                 4.155949e-02 1 1  ON 2
 uu_3                -2.109907e-02 1 1  ON 3
 uu_4                -6.685698e-02 1 1  ON 4
 uu_5                -1.021103e-01 1 1  ON 5
 uu_6                -1.300043e-01 1 1  ON 6
 uu_7                -1.438775e-01 1 1  ON 7
 uu_8                -1.365052e-01 1 1  ON 8
 uu_9                -1.097235e-01 1 1  ON 9
 ud_0                 4.526597e-01 1 1  ON 10
 ud_1                 1.864032e-01 1 1  ON 11
 ud_2                 6.503187e-02 1 1  ON 12
 ud_3                -6.812212e-03 1 1  ON 13
 ud_4                -6.419509e-02 1 1  ON 14
 ud_5                -1.062537e-01 1 1  ON 15
 ud_6                -1.346604e-01 1 1  ON 16
 ud_7                -1.518465e-01 1 1  ON 17
 ud_8                -1.542899e-01 1 1  ON 18
 ud_9                -1.454740e-01 1 1  ON 19
 eO_0                -7.659637e-01 1 1  ON 20
 eO_1                -4.427710e-01 1 1  ON 21
 eO_2                -1.972384e-02 1 1  ON 22
 eO_3                 3.035633e-01 1 1  ON 23
 eO_4                 5.318526e-01 1 1  ON 24
 eO_5                 4.964614e-01 1 1  ON 25
 eO_6                 2.674464e-01 1 1  ON 26
 eO_7                -3.978689e-02 1 1  ON 27
 eO_8                -2.322648e-01 1 1  ON 28
 eO_9                -9.609390e-02 1 1  ON 29
eH1_0                -2.501708e-01 1 1  ON 30
eH1_1                -1.495422e-01 1 1  ON 31
eH1_2                -1.022338e-01 1 1  ON 32
eH1_3                -4.786595e-02 1 1  ON 33
eH1_4                 2.112794e-04 1 1  ON 34
eH1_5                 3.498873e-02 1 1  ON 35
eH1_6                 9.423344e-02 1 1  ON 36
eH1_7                 1.533332e-01 1 1  ON 37
eH1_8                 1.888210e-01 1 1  ON 38
eH1_9                 8.008419e-02 1 1  ON 39
eH2_0                -2.492045e-01 1 1  ON 40
eH2_1                -1.466993e-01 1 1  ON 41
eH2_2                -9.938714e-02 1 1  ON 42
eH2_3                -4.491181e-02 1 1  ON 43
eH2_4                 3.755697e-03 1 1  ON 44
eH2_5                 3.842070e-02 1 1  ON 45
eH2_6                 9.624719e-02 1 1  ON 46
eH2_7                 1.565787e-01 1 1  ON 47
eH2_8                 1.908087e-01 1 1  ON 48
eH2_9                 7.100001e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9166
    reference variance = 0.491652
====================================================
  Execution time = 2.0465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.0000e+06
  Execution time = 1.9212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338146948063
                                         uncertainty =       0.003519555646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338146948063
                                         uncertainty =       0.003519555646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411130994
  error estimate for blocks of size 2^( 2) =       0.000423630648
  error estimate for blocks of size 2^( 3) =       0.000437092988
  error estimate for blocks of size 2^( 4) =       0.000448782712
  error estimate for blocks of size 2^( 5) =       0.000459340406
  error estimate for blocks of size 2^( 6) =       0.000467672192
  error estimate for blocks of size 2^( 7) =       0.000471162606

      target function =                  N/A
              le_mean =     -16.906270355666
             les_mean =     286.160034557856
             stat err =       0.000461739479
             autocorr =       1.261344102876
              std dev =       0.581427027262
             le_variance =       0.338057388031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338553912437
                                         uncertainty =       0.003522545454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338553912437
                                         uncertainty =       0.003522545454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411378196
  error estimate for blocks of size 2^( 2) =       0.000423865607
  error estimate for blocks of size 2^( 3) =       0.000437315798
  error estimate for blocks of size 2^( 4) =       0.000448996619
  error estimate for blocks of size 2^( 5) =       0.000459545709
  error estimate for blocks of size 2^( 6) =       0.000467865932
  error estimate for blocks of size 2^( 7) =       0.000471358828

      target function =                  N/A
              le_mean =     -16.906274751042
             les_mean =     286.160589829149
             stat err =       0.000461941772
             autocorr =       1.260932772200
              std dev =       0.581776624380
             le_variance =       0.338464040675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338614752688
                                         uncertainty =       0.003523373108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338614752688
                                         uncertainty =       0.003523373108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411415176
  error estimate for blocks of size 2^( 2) =       0.000423899807
  error estimate for blocks of size 2^( 3) =       0.000437347266
  error estimate for blocks of size 2^( 4) =       0.000449027037
  error estimate for blocks of size 2^( 5) =       0.000459578676
  error estimate for blocks of size 2^( 6) =       0.000467899157
  error estimate for blocks of size 2^( 7) =       0.000471392721

      target function =                  N/A
              le_mean =     -16.906274992490
             les_mean =     286.160658846730
             stat err =       0.000461974398
             autocorr =       1.260884194527
              std dev =       0.581828921839
             le_variance =       0.338524894289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240884075
                                         uncertainty =       0.003520334892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240884075
                                         uncertainty =       0.003520334892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411188077
  error estimate for blocks of size 2^( 2) =       0.000423684440
  error estimate for blocks of size 2^( 3) =       0.000437143544
  error estimate for blocks of size 2^( 4) =       0.000448831048
  error estimate for blocks of size 2^( 5) =       0.000459387733
  error estimate for blocks of size 2^( 6) =       0.000467717552
  error estimate for blocks of size 2^( 7) =       0.000471208482

      target function =                  N/A
              le_mean =     -16.906270963881
             les_mean =     286.160149004908
             stat err =       0.000461786204
             autocorr =       1.261249131878
              std dev =       0.581507755609
             le_variance =       0.338151269833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906270355666        initial
     9.7656e-02     9.7656e-01             1.8926e-03       -16.906274751042
     3.9062e-01     3.9062e+00             5.0018e-04       -16.906274992490  <--
     1.5625e+00     1.5625e+01             1.5244e-04       -16.906270963881

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 3.0074e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.101111e-01 1 1  ON 0
 uu_1                 1.433011e-01 1 1  ON 1
 uu_2                 4.155949e-02 1 1  ON 2
 uu_3                -2.109907e-02 1 1  ON 3
 uu_4                -6.685698e-02 1 1  ON 4
 uu_5                -1.021103e-01 1 1  ON 5
 uu_6                -1.300043e-01 1 1  ON 6
 uu_7                -1.438775e-01 1 1  ON 7
 uu_8                -1.365052e-01 1 1  ON 8
 uu_9                -1.097235e-01 1 1  ON 9
 ud_0                 4.526597e-01 1 1  ON 10
 ud_1                 1.864032e-01 1 1  ON 11
 ud_2                 6.503187e-02 1 1  ON 12
 ud_3                -6.812212e-03 1 1  ON 13
 ud_4                -6.419509e-02 1 1  ON 14
 ud_5                -1.062537e-01 1 1  ON 15
 ud_6                -1.346604e-01 1 1  ON 16
 ud_7                -1.518465e-01 1 1  ON 17
 ud_8                -1.542899e-01 1 1  ON 18
 ud_9                -1.454740e-01 1 1  ON 19
 eO_0                -7.659637e-01 1 1  ON 20
 eO_1                -4.427710e-01 1 1  ON 21
 eO_2                -1.972384e-02 1 1  ON 22
 eO_3                 3.035633e-01 1 1  ON 23
 eO_4                 5.318526e-01 1 1  ON 24
 eO_5                 4.964614e-01 1 1  ON 25
 eO_6                 2.674464e-01 1 1  ON 26
 eO_7                -3.978689e-02 1 1  ON 27
 eO_8                -2.322648e-01 1 1  ON 28
 eO_9                -9.609390e-02 1 1  ON 29
eH1_0                -2.501708e-01 1 1  ON 30
eH1_1                -1.495422e-01 1 1  ON 31
eH1_2                -1.022338e-01 1 1  ON 32
eH1_3                -4.786595e-02 1 1  ON 33
eH1_4                 2.112794e-04 1 1  ON 34
eH1_5                 3.498873e-02 1 1  ON 35
eH1_6                 9.423344e-02 1 1  ON 36
eH1_7                 1.533332e-01 1 1  ON 37
eH1_8                 1.888210e-01 1 1  ON 38
eH1_9                 8.008419e-02 1 1  ON 39
eH2_0                -2.492045e-01 1 1  ON 40
eH2_1                -1.466993e-01 1 1  ON 41
eH2_2                -9.938714e-02 1 1  ON 42
eH2_3                -4.491181e-02 1 1  ON 43
eH2_4                 3.755697e-03 1 1  ON 44
eH2_5                 3.842070e-02 1 1  ON 45
eH2_6                 9.624719e-02 1 1  ON 46
eH2_7                 1.565787e-01 1 1  ON 47
eH2_8                 1.908087e-01 1 1  ON 48
eH2_9                 7.100001e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6596e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8529
    reference variance = 0.319513
====================================================
  Execution time = 2.0951e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4600e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346058452485
                                         uncertainty =       0.004508246574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346058452485
                                         uncertainty =       0.004508246574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415933072
  error estimate for blocks of size 2^( 2) =       0.000428893040
  error estimate for blocks of size 2^( 3) =       0.000441859823
  error estimate for blocks of size 2^( 4) =       0.000454711869
  error estimate for blocks of size 2^( 5) =       0.000465738459
  error estimate for blocks of size 2^( 6) =       0.000472812848
  error estimate for blocks of size 2^( 7) =       0.000478836301

      target function =                  N/A
              le_mean =     -16.906502314409
             les_mean =     286.175820975582
             stat err =       0.000468024869
             autocorr =       1.266166891240
              std dev =       0.588218192042
             le_variance =       0.346000641449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650231441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906502314409       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906503976575       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906504141086       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906505527020       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906506989586       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906508136156       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906508927248       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906507559752       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906508734323       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906509088373       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906509039823       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906509033761       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.562547e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906502314409       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906503098611       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906503140276       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906503987537       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906504193336       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906504431552       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906504658074       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906504524374       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906504558010       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906504727593       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 6.395537e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906502314409       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906502566336       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906502575635       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906502829580       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906502963546       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906502923445       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906502986362       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906502997073       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.543866e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073222 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6609e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.100251e-01 1 1  ON 0
 uu_1                 1.433667e-01 1 1  ON 1
 uu_2                 4.155895e-02 1 1  ON 2
 uu_3                -2.116549e-02 1 1  ON 3
 uu_4                -6.697123e-02 1 1  ON 4
 uu_5                -1.021249e-01 1 1  ON 5
 uu_6                -1.298438e-01 1 1  ON 6
 uu_7                -1.440124e-01 1 1  ON 7
 uu_8                -1.366912e-01 1 1  ON 8
 uu_9                -1.098205e-01 1 1  ON 9
 ud_0                 4.527135e-01 1 1  ON 10
 ud_1                 1.863844e-01 1 1  ON 11
 ud_2                 6.507756e-02 1 1  ON 12
 ud_3                -6.823860e-03 1 1  ON 13
 ud_4                -6.441644e-02 1 1  ON 14
 ud_5                -1.064856e-01 1 1  ON 15
 ud_6                -1.345128e-01 1 1  ON 16
 ud_7                -1.518583e-01 1 1  ON 17
 ud_8                -1.541500e-01 1 1  ON 18
 ud_9                -1.454015e-01 1 1  ON 19
 eO_0                -7.659420e-01 1 1  ON 20
 eO_1                -4.426875e-01 1 1  ON 21
 eO_2                -1.972682e-02 1 1  ON 22
 eO_3                 3.036287e-01 1 1  ON 23
 eO_4                 5.319348e-01 1 1  ON 24
 eO_5                 4.963361e-01 1 1  ON 25
 eO_6                 2.676272e-01 1 1  ON 26
 eO_7                -3.961235e-02 1 1  ON 27
 eO_8                -2.324628e-01 1 1  ON 28
 eO_9                -9.633768e-02 1 1  ON 29
eH1_0                -2.507142e-01 1 1  ON 30
eH1_1                -1.497312e-01 1 1  ON 31
eH1_2                -1.024539e-01 1 1  ON 32
eH1_3                -4.801936e-02 1 1  ON 33
eH1_4                -1.621732e-05 1 1  ON 34
eH1_5                 3.532158e-02 1 1  ON 35
eH1_6                 9.447326e-02 1 1  ON 36
eH1_7                 1.535208e-01 1 1  ON 37
eH1_8                 1.889608e-01 1 1  ON 38
eH1_9                 8.045001e-02 1 1  ON 39
eH2_0                -2.490383e-01 1 1  ON 40
eH2_1                -1.468756e-01 1 1  ON 41
eH2_2                -9.970530e-02 1 1  ON 42
eH2_3                -4.522275e-02 1 1  ON 43
eH2_4                 3.633132e-03 1 1  ON 44
eH2_5                 3.830212e-02 1 1  ON 45
eH2_6                 9.606962e-02 1 1  ON 46
eH2_7                 1.565175e-01 1 1  ON 47
eH2_8                 1.912197e-01 1 1  ON 48
eH2_9                 7.163956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.7737
    reference variance = 0.354165
====================================================
  Execution time = 2.0561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3456e-01
  Total weights = 2.0000e+06
  Execution time = 1.9103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334544240037
                                         uncertainty =       0.003283827793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334544240037
                                         uncertainty =       0.003283827793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408959608
  error estimate for blocks of size 2^( 2) =       0.000421841121
  error estimate for blocks of size 2^( 3) =       0.000434460850
  error estimate for blocks of size 2^( 4) =       0.000446608855
  error estimate for blocks of size 2^( 5) =       0.000458037781
  error estimate for blocks of size 2^( 6) =       0.000465193117
  error estimate for blocks of size 2^( 7) =       0.000469558751

      target function =                  N/A
              le_mean =     -16.905269840068
             les_mean =     286.122644119949
             stat err =       0.000459849626
             autocorr =       1.264360279476
              std dev =       0.578356223879
             le_variance =       0.334495921700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334712535088
                                         uncertainty =       0.003285392861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334712535088
                                         uncertainty =       0.003285392861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409062451
  error estimate for blocks of size 2^( 2) =       0.000421940152
  error estimate for blocks of size 2^( 3) =       0.000434556536
  error estimate for blocks of size 2^( 4) =       0.000446707429
  error estimate for blocks of size 2^( 5) =       0.000458130972
  error estimate for blocks of size 2^( 6) =       0.000465280687
  error estimate for blocks of size 2^( 7) =       0.000469627915

      target function =                  N/A
              le_mean =     -16.905268496484
             les_mean =     286.122766949045
             stat err =       0.000459936751
             autocorr =       1.264203511320
              std dev =       0.578501666529
             le_variance =       0.334664178177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334677820902
                                         uncertainty =       0.003285168857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334677820902
                                         uncertainty =       0.003285168857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409041215
  error estimate for blocks of size 2^( 2) =       0.000421919156
  error estimate for blocks of size 2^( 3) =       0.000434535522
  error estimate for blocks of size 2^( 4) =       0.000446686624
  error estimate for blocks of size 2^( 5) =       0.000458111371
  error estimate for blocks of size 2^( 6) =       0.000465262968
  error estimate for blocks of size 2^( 7) =       0.000469613807

      target function =                  N/A
              le_mean =     -16.905269300351
             les_mean =     286.122759381048
             stat err =       0.000459918692
             autocorr =       1.264235502909
              std dev =       0.578471633680
             le_variance =       0.334629430972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568622798
                                         uncertainty =       0.003284007004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568622798
                                         uncertainty =       0.003284007004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408974503
  error estimate for blocks of size 2^( 2) =       0.000421855203
  error estimate for blocks of size 2^( 3) =       0.000434474282
  error estimate for blocks of size 2^( 4) =       0.000446622866
  error estimate for blocks of size 2^( 5) =       0.000458051086
  error estimate for blocks of size 2^( 6) =       0.000465205483
  error estimate for blocks of size 2^( 7) =       0.000469568736

      target function =                  N/A
              le_mean =     -16.905269554755
             les_mean =     286.122658839674
             stat err =       0.000459862043
             autocorr =       1.264336461210
              std dev =       0.578377288640
             le_variance =       0.334520288014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905269840068        initial  <--
     9.7656e-02     9.7656e-01             2.5625e-03       -16.905268496484
     3.9062e-01     3.9062e+00             6.3955e-04       -16.905269300351
     1.5625e+00     1.5625e+01             1.5439e-04       -16.905269554755

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1703
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.101111e-01 1 1  ON 0
 uu_1                 1.433011e-01 1 1  ON 1
 uu_2                 4.155949e-02 1 1  ON 2
 uu_3                -2.109907e-02 1 1  ON 3
 uu_4                -6.685698e-02 1 1  ON 4
 uu_5                -1.021103e-01 1 1  ON 5
 uu_6                -1.300043e-01 1 1  ON 6
 uu_7                -1.438775e-01 1 1  ON 7
 uu_8                -1.365052e-01 1 1  ON 8
 uu_9                -1.097235e-01 1 1  ON 9
 ud_0                 4.526597e-01 1 1  ON 10
 ud_1                 1.864032e-01 1 1  ON 11
 ud_2                 6.503187e-02 1 1  ON 12
 ud_3                -6.812212e-03 1 1  ON 13
 ud_4                -6.419509e-02 1 1  ON 14
 ud_5                -1.062537e-01 1 1  ON 15
 ud_6                -1.346604e-01 1 1  ON 16
 ud_7                -1.518465e-01 1 1  ON 17
 ud_8                -1.542899e-01 1 1  ON 18
 ud_9                -1.454740e-01 1 1  ON 19
 eO_0                -7.659637e-01 1 1  ON 20
 eO_1                -4.427710e-01 1 1  ON 21
 eO_2                -1.972384e-02 1 1  ON 22
 eO_3                 3.035633e-01 1 1  ON 23
 eO_4                 5.318526e-01 1 1  ON 24
 eO_5                 4.964614e-01 1 1  ON 25
 eO_6                 2.674464e-01 1 1  ON 26
 eO_7                -3.978689e-02 1 1  ON 27
 eO_8                -2.322648e-01 1 1  ON 28
 eO_9                -9.609390e-02 1 1  ON 29
eH1_0                -2.501708e-01 1 1  ON 30
eH1_1                -1.495422e-01 1 1  ON 31
eH1_2                -1.022338e-01 1 1  ON 32
eH1_3                -4.786595e-02 1 1  ON 33
eH1_4                 2.112794e-04 1 1  ON 34
eH1_5                 3.498873e-02 1 1  ON 35
eH1_6                 9.423344e-02 1 1  ON 36
eH1_7                 1.533332e-01 1 1  ON 37
eH1_8                 1.888210e-01 1 1  ON 38
eH1_9                 8.008419e-02 1 1  ON 39
eH2_0                -2.492045e-01 1 1  ON 40
eH2_1                -1.466993e-01 1 1  ON 41
eH2_2                -9.938714e-02 1 1  ON 42
eH2_3                -4.491181e-02 1 1  ON 43
eH2_4                 3.755697e-03 1 1  ON 44
eH2_5                 3.842070e-02 1 1  ON 45
eH2_6                 9.624719e-02 1 1  ON 46
eH2_7                 1.565787e-01 1 1  ON 47
eH2_8                 1.908087e-01 1 1  ON 48
eH2_9                 7.100001e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6792e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.337604
====================================================
  Execution time = 2.3202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3540e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335216618509
                                         uncertainty =       0.002564716898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335216618509
                                         uncertainty =       0.002564716898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409513701
  error estimate for blocks of size 2^( 2) =       0.000421978595
  error estimate for blocks of size 2^( 3) =       0.000434881135
  error estimate for blocks of size 2^( 4) =       0.000446234237
  error estimate for blocks of size 2^( 5) =       0.000455877448
  error estimate for blocks of size 2^( 6) =       0.000464576060
  error estimate for blocks of size 2^( 7) =       0.000469920340

      target function =                  N/A
              le_mean =     -16.905859278497
             les_mean =     286.143480719271
             stat err =       0.000459152021
             autocorr =       1.257118240095
              std dev =       0.579139829949
             le_variance =       0.335402942633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585927850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905859278497       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905859551639       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905859536565       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905859713434       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905859870778       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905860005953       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905860306349       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905860274564       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905860174678       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.221588e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905859278497       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905859357636       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905859351148       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905859397199       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905859455063       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905859460822       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905859538484       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905859534474       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.391893e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905859278497       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905859299100       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905859297279       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905859308930       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905859324368       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905859325659       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905859344086       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905859343123       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.355065e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8846e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.101021e-01 1 1  ON 0
 uu_1                 1.432921e-01 1 1  ON 1
 uu_2                 4.154190e-02 1 1  ON 2
 uu_3                -2.110869e-02 1 1  ON 3
 uu_4                -6.684916e-02 1 1  ON 4
 uu_5                -1.021103e-01 1 1  ON 5
 uu_6                -1.300112e-01 1 1  ON 6
 uu_7                -1.438896e-01 1 1  ON 7
 uu_8                -1.365024e-01 1 1  ON 8
 uu_9                -1.097190e-01 1 1  ON 9
 ud_0                 4.527007e-01 1 1  ON 10
 ud_1                 1.863960e-01 1 1  ON 11
 ud_2                 6.504941e-02 1 1  ON 12
 ud_3                -6.817159e-03 1 1  ON 13
 ud_4                -6.422798e-02 1 1  ON 14
 ud_5                -1.062904e-01 1 1  ON 15
 ud_6                -1.346776e-01 1 1  ON 16
 ud_7                -1.518677e-01 1 1  ON 17
 ud_8                -1.542620e-01 1 1  ON 18
 ud_9                -1.454470e-01 1 1  ON 19
 eO_0                -7.659735e-01 1 1  ON 20
 eO_1                -4.427863e-01 1 1  ON 21
 eO_2                -1.971805e-02 1 1  ON 22
 eO_3                 3.035899e-01 1 1  ON 23
 eO_4                 5.318851e-01 1 1  ON 24
 eO_5                 4.964657e-01 1 1  ON 25
 eO_6                 2.674485e-01 1 1  ON 26
 eO_7                -3.978683e-02 1 1  ON 27
 eO_8                -2.322810e-01 1 1  ON 28
 eO_9                -9.612074e-02 1 1  ON 29
eH1_0                -2.501957e-01 1 1  ON 30
eH1_1                -1.495536e-01 1 1  ON 31
eH1_2                -1.022620e-01 1 1  ON 32
eH1_3                -4.789173e-02 1 1  ON 33
eH1_4                 2.119163e-04 1 1  ON 34
eH1_5                 3.497546e-02 1 1  ON 35
eH1_6                 9.422395e-02 1 1  ON 36
eH1_7                 1.533424e-01 1 1  ON 37
eH1_8                 1.888592e-01 1 1  ON 38
eH1_9                 8.013811e-02 1 1  ON 39
eH2_0                -2.491759e-01 1 1  ON 40
eH2_1                -1.467238e-01 1 1  ON 41
eH2_2                -9.942356e-02 1 1  ON 42
eH2_3                -4.494267e-02 1 1  ON 43
eH2_4                 3.728282e-03 1 1  ON 44
eH2_5                 3.840927e-02 1 1  ON 45
eH2_6                 9.624840e-02 1 1  ON 46
eH2_7                 1.565912e-01 1 1  ON 47
eH2_8                 1.908420e-01 1 1  ON 48
eH2_9                 7.105107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1596
    reference variance = 5.14145
====================================================
  Execution time = 2.0444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3425e-01
  Total weights = 2.0000e+06
  Execution time = 1.8945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334053540234
                                         uncertainty =       0.003160028736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334053540234
                                         uncertainty =       0.003160028736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408785406
  error estimate for blocks of size 2^( 2) =       0.000421305699
  error estimate for blocks of size 2^( 3) =       0.000434389674
  error estimate for blocks of size 2^( 4) =       0.000446480638
  error estimate for blocks of size 2^( 5) =       0.000456483067
  error estimate for blocks of size 2^( 6) =       0.000466192103
  error estimate for blocks of size 2^( 7) =       0.000472572573

      target function =                  N/A
              le_mean =     -16.905145718782
             les_mean =     286.118162622123
             stat err =       0.000460432095
             autocorr =       1.268645880971
              std dev =       0.578109864965
             le_variance =       0.334211015970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162021248
                                         uncertainty =       0.003161447744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162021248
                                         uncertainty =       0.003161447744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408851741
  error estimate for blocks of size 2^( 2) =       0.000421370038
  error estimate for blocks of size 2^( 3) =       0.000434451363
  error estimate for blocks of size 2^( 4) =       0.000446539268
  error estimate for blocks of size 2^( 5) =       0.000456539605
  error estimate for blocks of size 2^( 6) =       0.000466245451
  error estimate for blocks of size 2^( 7) =       0.000472626907

      target function =                  N/A
              le_mean =     -16.905145246365
             les_mean =     286.118255126276
             stat err =       0.000460487808
             autocorr =       1.268541175582
              std dev =       0.578203677570
             le_variance =       0.334319492755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334126781862
                                         uncertainty =       0.003161018708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334126781862
                                         uncertainty =       0.003161018708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408830182
  error estimate for blocks of size 2^( 2) =       0.000421349007
  error estimate for blocks of size 2^( 3) =       0.000434431406
  error estimate for blocks of size 2^( 4) =       0.000446520501
  error estimate for blocks of size 2^( 5) =       0.000456521875
  error estimate for blocks of size 2^( 6) =       0.000466228685
  error estimate for blocks of size 2^( 7) =       0.000472609485

      target function =                  N/A
              le_mean =     -16.905145473877
             les_mean =     286.118227560737
             stat err =       0.000460470136
             autocorr =       1.268577601394
              std dev =       0.578173187660
             le_variance =       0.334284234928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334063268169
                                         uncertainty =       0.003160162275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334063268169
                                         uncertainty =       0.003160162275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408791353
  error estimate for blocks of size 2^( 2) =       0.000421311447
  error estimate for blocks of size 2^( 3) =       0.000434395215
  error estimate for blocks of size 2^( 4) =       0.000446485936
  error estimate for blocks of size 2^( 5) =       0.000456488234
  error estimate for blocks of size 2^( 6) =       0.000466196973
  error estimate for blocks of size 2^( 7) =       0.000472577483

      target function =                  N/A
              le_mean =     -16.905145682869
             les_mean =     286.118171131793
             stat err =       0.000460437156
             autocorr =       1.268636860493
              std dev =       0.578118274993
             le_variance =       0.334220739881


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905145718782        initial  <--
     9.7656e-01     9.7656e+00             2.2216e-04       -16.905145246365
     3.9062e+00     3.9062e+01             5.3919e-05       -16.905145473877
     1.5625e+01     1.5625e+02             1.3551e-05       -16.905145682869

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0147
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.101111e-01 1 1  ON 0
 uu_1                 1.433011e-01 1 1  ON 1
 uu_2                 4.155949e-02 1 1  ON 2
 uu_3                -2.109907e-02 1 1  ON 3
 uu_4                -6.685698e-02 1 1  ON 4
 uu_5                -1.021103e-01 1 1  ON 5
 uu_6                -1.300043e-01 1 1  ON 6
 uu_7                -1.438775e-01 1 1  ON 7
 uu_8                -1.365052e-01 1 1  ON 8
 uu_9                -1.097235e-01 1 1  ON 9
 ud_0                 4.526597e-01 1 1  ON 10
 ud_1                 1.864032e-01 1 1  ON 11
 ud_2                 6.503187e-02 1 1  ON 12
 ud_3                -6.812212e-03 1 1  ON 13
 ud_4                -6.419509e-02 1 1  ON 14
 ud_5                -1.062537e-01 1 1  ON 15
 ud_6                -1.346604e-01 1 1  ON 16
 ud_7                -1.518465e-01 1 1  ON 17
 ud_8                -1.542899e-01 1 1  ON 18
 ud_9                -1.454740e-01 1 1  ON 19
 eO_0                -7.659637e-01 1 1  ON 20
 eO_1                -4.427710e-01 1 1  ON 21
 eO_2                -1.972384e-02 1 1  ON 22
 eO_3                 3.035633e-01 1 1  ON 23
 eO_4                 5.318526e-01 1 1  ON 24
 eO_5                 4.964614e-01 1 1  ON 25
 eO_6                 2.674464e-01 1 1  ON 26
 eO_7                -3.978689e-02 1 1  ON 27
 eO_8                -2.322648e-01 1 1  ON 28
 eO_9                -9.609390e-02 1 1  ON 29
eH1_0                -2.501708e-01 1 1  ON 30
eH1_1                -1.495422e-01 1 1  ON 31
eH1_2                -1.022338e-01 1 1  ON 32
eH1_3                -4.786595e-02 1 1  ON 33
eH1_4                 2.112794e-04 1 1  ON 34
eH1_5                 3.498873e-02 1 1  ON 35
eH1_6                 9.423344e-02 1 1  ON 36
eH1_7                 1.533332e-01 1 1  ON 37
eH1_8                 1.888210e-01 1 1  ON 38
eH1_9                 8.008419e-02 1 1  ON 39
eH2_0                -2.492045e-01 1 1  ON 40
eH2_1                -1.466993e-01 1 1  ON 41
eH2_2                -9.938714e-02 1 1  ON 42
eH2_3                -4.491181e-02 1 1  ON 43
eH2_4                 3.755697e-03 1 1  ON 44
eH2_5                 3.842070e-02 1 1  ON 45
eH2_6                 9.624719e-02 1 1  ON 46
eH2_7                 1.565787e-01 1 1  ON 47
eH2_8                 1.908087e-01 1 1  ON 48
eH2_9                 7.100001e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8989
    reference variance = 0.253061
====================================================
  Execution time = 2.0781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4794e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346800587110
                                         uncertainty =       0.006878402795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346800587110
                                         uncertainty =       0.006878402795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417098192
  error estimate for blocks of size 2^( 2) =       0.000429819136
  error estimate for blocks of size 2^( 3) =       0.000442775892
  error estimate for blocks of size 2^( 4) =       0.000455321227
  error estimate for blocks of size 2^( 5) =       0.000464398175
  error estimate for blocks of size 2^( 6) =       0.000474668929
  error estimate for blocks of size 2^( 7) =       0.000480525025

      target function =                  N/A
              le_mean =     -16.906318564677
             les_mean =     286.171549040689
             stat err =       0.000468728339
             autocorr =       1.262890822664
              std dev =       0.589865920626
             le_variance =       0.347941804316


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631856468e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906318564677       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906318595066       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906318591471       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906318575870       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906318551053       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906318586093       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906318600775       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906318603105       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.849273e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906318564677       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906318572390       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906318571593       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906318567580       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906318561097       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906318569838       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906318573307       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906318573854       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 7.156209e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906318564677       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906318566613       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906318566420       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906318565409       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906318563771       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906318565955       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906318566809       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906318566943       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.791139e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6354e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.101111e-01 1 1  ON 0
 uu_1                 1.432983e-01 1 1  ON 1
 uu_2                 4.156098e-02 1 1  ON 2
 uu_3                -2.109750e-02 1 1  ON 3
 uu_4                -6.685741e-02 1 1  ON 4
 uu_5                -1.021083e-01 1 1  ON 5
 uu_6                -1.300022e-01 1 1  ON 6
 uu_7                -1.438811e-01 1 1  ON 7
 uu_8                -1.365085e-01 1 1  ON 8
 uu_9                -1.097240e-01 1 1  ON 9
 ud_0                 4.526607e-01 1 1  ON 10
 ud_1                 1.864034e-01 1 1  ON 11
 ud_2                 6.503345e-02 1 1  ON 12
 ud_3                -6.812693e-03 1 1  ON 13
 ud_4                -6.419665e-02 1 1  ON 14
 ud_5                -1.062538e-01 1 1  ON 15
 ud_6                -1.346598e-01 1 1  ON 16
 ud_7                -1.518466e-01 1 1  ON 17
 ud_8                -1.542866e-01 1 1  ON 18
 ud_9                -1.454750e-01 1 1  ON 19
 eO_0                -7.659594e-01 1 1  ON 20
 eO_1                -4.427732e-01 1 1  ON 21
 eO_2                -1.972557e-02 1 1  ON 22
 eO_3                 3.035650e-01 1 1  ON 23
 eO_4                 5.318538e-01 1 1  ON 24
 eO_5                 4.964623e-01 1 1  ON 25
 eO_6                 2.674473e-01 1 1  ON 26
 eO_7                -3.978628e-02 1 1  ON 27
 eO_8                -2.322664e-01 1 1  ON 28
 eO_9                -9.609752e-02 1 1  ON 29
eH1_0                -2.501779e-01 1 1  ON 30
eH1_1                -1.495441e-01 1 1  ON 31
eH1_2                -1.022336e-01 1 1  ON 32
eH1_3                -4.786776e-02 1 1  ON 33
eH1_4                 2.142360e-04 1 1  ON 34
eH1_5                 3.499066e-02 1 1  ON 35
eH1_6                 9.423368e-02 1 1  ON 36
eH1_7                 1.533320e-01 1 1  ON 37
eH1_8                 1.888223e-01 1 1  ON 38
eH1_9                 8.008880e-02 1 1  ON 39
eH2_0                -2.492012e-01 1 1  ON 40
eH2_1                -1.466992e-01 1 1  ON 41
eH2_2                -9.938796e-02 1 1  ON 42
eH2_3                -4.491402e-02 1 1  ON 43
eH2_4                 3.751132e-03 1 1  ON 44
eH2_5                 3.841813e-02 1 1  ON 45
eH2_6                 9.624706e-02 1 1  ON 46
eH2_7                 1.565775e-01 1 1  ON 47
eH2_8                 1.908102e-01 1 1  ON 48
eH2_9                 7.100618e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.001
    reference variance = 0.335474
====================================================
  Execution time = 2.0472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4663e-01
  Total weights = 2.0000e+06
  Execution time = 1.9042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605084034
                                         uncertainty =       0.004869643162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605084034
                                         uncertainty =       0.004869643162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416312812
  error estimate for blocks of size 2^( 2) =       0.000429240214
  error estimate for blocks of size 2^( 3) =       0.000442209085
  error estimate for blocks of size 2^( 4) =       0.000455442357
  error estimate for blocks of size 2^( 5) =       0.000467002763
  error estimate for blocks of size 2^( 6) =       0.000471558569
  error estimate for blocks of size 2^( 7) =       0.000476991968

      target function =                  N/A
              le_mean =     -16.906032533477
             les_mean =     286.160568564770
             stat err =       0.000467748914
             autocorr =       1.262368133143
              std dev =       0.588755225120
             le_variance =       0.346632715106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346597425659
                                         uncertainty =       0.004869587335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346597425659
                                         uncertainty =       0.004869587335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416308210
  error estimate for blocks of size 2^( 2) =       0.000429235924
  error estimate for blocks of size 2^( 3) =       0.000442205111
  error estimate for blocks of size 2^( 4) =       0.000455438722
  error estimate for blocks of size 2^( 5) =       0.000466999069
  error estimate for blocks of size 2^( 6) =       0.000471555104
  error estimate for blocks of size 2^( 7) =       0.000476988741

      target function =                  N/A
              le_mean =     -16.906032597222
             les_mean =     286.160563056584
             stat err =       0.000467745409
             autocorr =       1.262377122699
              std dev =       0.588748716814
             le_variance =       0.346625051550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346601164093
                                         uncertainty =       0.004869614812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346601164093
                                         uncertainty =       0.004869614812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416310457
  error estimate for blocks of size 2^( 2) =       0.000429238019
  error estimate for blocks of size 2^( 3) =       0.000442207052
  error estimate for blocks of size 2^( 4) =       0.000455440499
  error estimate for blocks of size 2^( 5) =       0.000467000877
  error estimate for blocks of size 2^( 6) =       0.000471556803
  error estimate for blocks of size 2^( 7) =       0.000476990326

      target function =                  N/A
              le_mean =     -16.906032566066
             les_mean =     286.160565744080
             stat err =       0.000467747126
             autocorr =       1.262372767392
              std dev =       0.588751893857
             le_variance =       0.346628792520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346604590918
                                         uncertainty =       0.004869639605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346604590918
                                         uncertainty =       0.004869639605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416312516
  error estimate for blocks of size 2^( 2) =       0.000429239938
  error estimate for blocks of size 2^( 3) =       0.000442208830
  error estimate for blocks of size 2^( 4) =       0.000455442123
  error estimate for blocks of size 2^( 5) =       0.000467002526
  error estimate for blocks of size 2^( 6) =       0.000471558347
  error estimate for blocks of size 2^( 7) =       0.000476991762

      target function =                  N/A
              le_mean =     -16.906032537547
             les_mean =     286.160568208924
             stat err =       0.000467748689
             autocorr =       1.262368716927
              std dev =       0.588754806059
             le_variance =       0.346632221657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906032533477        initial
     9.7656e+00     9.7656e+01             2.8493e-05       -16.906032597222  <--
     3.9062e+01     3.9062e+02             7.1562e-06       -16.906032566066
     1.5625e+02     1.5625e+03             1.7911e-06       -16.906032537547

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 3.0034e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.101110e-01 1 1  ON 0
 uu_1                 1.432902e-01 1 1  ON 1
 uu_2                 4.156526e-02 1 1  ON 2
 uu_3                -2.109288e-02 1 1  ON 3
 uu_4                -6.685853e-02 1 1  ON 4
 uu_5                -1.021025e-01 1 1  ON 5
 uu_6                -1.299957e-01 1 1  ON 6
 uu_7                -1.438920e-01 1 1  ON 7
 uu_8                -1.365184e-01 1 1  ON 8
 uu_9                -1.097254e-01 1 1  ON 9
 ud_0                 4.526637e-01 1 1  ON 10
 ud_1                 1.864040e-01 1 1  ON 11
 ud_2                 6.503800e-02 1 1  ON 12
 ud_3                -6.814046e-03 1 1  ON 13
 ud_4                -6.420118e-02 1 1  ON 14
 ud_5                -1.062540e-01 1 1  ON 15
 ud_6                -1.346579e-01 1 1  ON 16
 ud_7                -1.518469e-01 1 1  ON 17
 ud_8                -1.542769e-01 1 1  ON 18
 ud_9                -1.454780e-01 1 1  ON 19
 eO_0                -7.659469e-01 1 1  ON 20
 eO_1                -4.427795e-01 1 1  ON 21
 eO_2                -1.973060e-02 1 1  ON 22
 eO_3                 3.035702e-01 1 1  ON 23
 eO_4                 5.318574e-01 1 1  ON 24
 eO_5                 4.964653e-01 1 1  ON 25
 eO_6                 2.674501e-01 1 1  ON 26
 eO_7                -3.978444e-02 1 1  ON 27
 eO_8                -2.322714e-01 1 1  ON 28
 eO_9                -9.610833e-02 1 1  ON 29
eH1_0                -2.501993e-01 1 1  ON 30
eH1_1                -1.495498e-01 1 1  ON 31
eH1_2                -1.022329e-01 1 1  ON 32
eH1_3                -4.787303e-02 1 1  ON 33
eH1_4                 2.229210e-04 1 1  ON 34
eH1_5                 3.499646e-02 1 1  ON 35
eH1_6                 9.423442e-02 1 1  ON 36
eH1_7                 1.533286e-01 1 1  ON 37
eH1_8                 1.888260e-01 1 1  ON 38
eH1_9                 8.010259e-02 1 1  ON 39
eH2_0                -2.491911e-01 1 1  ON 40
eH2_1                -1.466989e-01 1 1  ON 41
eH2_2                -9.939053e-02 1 1  ON 42
eH2_3                -4.492055e-02 1 1  ON 43
eH2_4                 3.737506e-03 1 1  ON 44
eH2_5                 3.841040e-02 1 1  ON 45
eH2_6                 9.624665e-02 1 1  ON 46
eH2_7                 1.565738e-01 1 1  ON 47
eH2_8                 1.908147e-01 1 1  ON 48
eH2_9                 7.102464e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6400e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8993
    reference variance = 0.36744
====================================================
  Execution time = 2.0832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336628141824
                                         uncertainty =       0.003976535304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336628141824
                                         uncertainty =       0.003976535304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410278349
  error estimate for blocks of size 2^( 2) =       0.000422785722
  error estimate for blocks of size 2^( 3) =       0.000435943152
  error estimate for blocks of size 2^( 4) =       0.000448019322
  error estimate for blocks of size 2^( 5) =       0.000458440480
  error estimate for blocks of size 2^( 6) =       0.000464766965
  error estimate for blocks of size 2^( 7) =       0.000470836533

      target function =                  N/A
              le_mean =     -16.906377871139
             les_mean =     286.162269200468
             stat err =       0.000460515825
             autocorr =       1.259887942119
              std dev =       0.580221205285
             le_variance =       0.336656647063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637787114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906377871139       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906377888005       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906378058387       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906378197060       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906378217656       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906378211873       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906378253257       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906378240826       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.579136e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906377871139       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906377875509       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906377920593       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906377954991       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906377962528       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906377961809       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906377973490       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906377970955       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.160869e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906377871139       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906377872242       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906377883683       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906377892254       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906377894299       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906377894175       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906377897172       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906377896619       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.411809e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6555e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.101089e-01 1 1  ON 0
 uu_1                 1.432826e-01 1 1  ON 1
 uu_2                 4.156502e-02 1 1  ON 2
 uu_3                -2.109610e-02 1 1  ON 3
 uu_4                -6.686623e-02 1 1  ON 4
 uu_5                -1.021011e-01 1 1  ON 5
 uu_6                -1.300039e-01 1 1  ON 6
 uu_7                -1.438990e-01 1 1  ON 7
 uu_8                -1.365109e-01 1 1  ON 8
 uu_9                -1.097162e-01 1 1  ON 9
 ud_0                 4.526675e-01 1 1  ON 10
 ud_1                 1.863947e-01 1 1  ON 11
 ud_2                 6.503908e-02 1 1  ON 12
 ud_3                -6.815328e-03 1 1  ON 13
 ud_4                -6.420797e-02 1 1  ON 14
 ud_5                -1.062676e-01 1 1  ON 15
 ud_6                -1.346531e-01 1 1  ON 16
 ud_7                -1.518457e-01 1 1  ON 17
 ud_8                -1.542666e-01 1 1  ON 18
 ud_9                -1.454727e-01 1 1  ON 19
 eO_0                -7.659314e-01 1 1  ON 20
 eO_1                -4.427796e-01 1 1  ON 21
 eO_2                -1.974496e-02 1 1  ON 22
 eO_3                 3.035754e-01 1 1  ON 23
 eO_4                 5.318574e-01 1 1  ON 24
 eO_5                 4.964711e-01 1 1  ON 25
 eO_6                 2.674506e-01 1 1  ON 26
 eO_7                -3.978127e-02 1 1  ON 27
 eO_8                -2.322760e-01 1 1  ON 28
 eO_9                -9.611883e-02 1 1  ON 29
eH1_0                -2.502063e-01 1 1  ON 30
eH1_1                -1.495645e-01 1 1  ON 31
eH1_2                -1.022430e-01 1 1  ON 32
eH1_3                -4.787217e-02 1 1  ON 33
eH1_4                 2.230894e-04 1 1  ON 34
eH1_5                 3.498705e-02 1 1  ON 35
eH1_6                 9.424430e-02 1 1  ON 36
eH1_7                 1.533276e-01 1 1  ON 37
eH1_8                 1.888341e-01 1 1  ON 38
eH1_9                 8.012216e-02 1 1  ON 39
eH2_0                -2.491835e-01 1 1  ON 40
eH2_1                -1.467048e-01 1 1  ON 41
eH2_2                -9.940254e-02 1 1  ON 42
eH2_3                -4.492068e-02 1 1  ON 43
eH2_4                 3.721510e-03 1 1  ON 44
eH2_5                 3.839652e-02 1 1  ON 45
eH2_6                 9.624918e-02 1 1  ON 46
eH2_7                 1.565798e-01 1 1  ON 47
eH2_8                 1.908235e-01 1 1  ON 48
eH2_9                 7.104625e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8863
    reference variance = 0.206333
====================================================
  Execution time = 2.0323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3923e-01
  Total weights = 2.0000e+06
  Execution time = 1.9063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879726809
                                         uncertainty =       0.003511434286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879726809
                                         uncertainty =       0.003511434286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411842666
  error estimate for blocks of size 2^( 2) =       0.000424817487
  error estimate for blocks of size 2^( 3) =       0.000437620382
  error estimate for blocks of size 2^( 4) =       0.000449610175
  error estimate for blocks of size 2^( 5) =       0.000460036825
  error estimate for blocks of size 2^( 6) =       0.000467840231
  error estimate for blocks of size 2^( 7) =       0.000472030208

      target function =                  N/A
              le_mean =     -16.906677441027
             les_mean =     286.174970688495
             stat err =       0.000462379360
             autocorr =       1.260474908804
              std dev =       0.582433483921
             le_variance =       0.339228763193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338896457526
                                         uncertainty =       0.003511798009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338896457526
                                         uncertainty =       0.003511798009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411852833
  error estimate for blocks of size 2^( 2) =       0.000424827754
  error estimate for blocks of size 2^( 3) =       0.000437630271
  error estimate for blocks of size 2^( 4) =       0.000449619260
  error estimate for blocks of size 2^( 5) =       0.000460045077
  error estimate for blocks of size 2^( 6) =       0.000467848409
  error estimate for blocks of size 2^( 7) =       0.000472036936

      target function =                  N/A
              le_mean =     -16.906677846535
             les_mean =     286.175001148733
             stat err =       0.000462387421
             autocorr =       1.260456626357
              std dev =       0.582447861893
             le_variance =       0.339245511823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338890031870
                                         uncertainty =       0.003511652713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338890031870
                                         uncertainty =       0.003511652713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411848930
  error estimate for blocks of size 2^( 2) =       0.000424823780
  error estimate for blocks of size 2^( 3) =       0.000437626432
  error estimate for blocks of size 2^( 4) =       0.000449615770
  error estimate for blocks of size 2^( 5) =       0.000460041956
  error estimate for blocks of size 2^( 6) =       0.000467845298
  error estimate for blocks of size 2^( 7) =       0.000472034523

      target function =                  N/A
              le_mean =     -16.906677666081
             les_mean =     286.174988617148
             stat err =       0.000462384387
             autocorr =       1.260463975894
              std dev =       0.582442342219
             le_variance =       0.339239082009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338881083682
                                         uncertainty =       0.003511462949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338881083682
                                         uncertainty =       0.003511462949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411843491
  error estimate for blocks of size 2^( 2) =       0.000424818315
  error estimate for blocks of size 2^( 3) =       0.000437621177
  error estimate for blocks of size 2^( 4) =       0.000449610912
  error estimate for blocks of size 2^( 5) =       0.000460037502
  error estimate for blocks of size 2^( 6) =       0.000467840898
  error estimate for blocks of size 2^( 7) =       0.000472030780

      target function =                  N/A
              le_mean =     -16.906677469662
             les_mean =     286.174973015515
             stat err =       0.000462380023
             autocorr =       1.260473476489
              std dev =       0.582434650382
             le_variance =       0.339230121966


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906677441027        initial
     2.4414e+00     2.4414e+01             8.5791e-05       -16.906677846535  <--
     9.7656e+00     9.7656e+01             2.1609e-05       -16.906677666081
     3.9062e+01     3.9062e+02             5.4118e-06       -16.906677469662

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9907e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.101015e-01 1 1  ON 0
 uu_1                 1.432613e-01 1 1  ON 1
 uu_2                 4.156292e-02 1 1  ON 2
 uu_3                -2.110521e-02 1 1  ON 3
 uu_4                -6.688793e-02 1 1  ON 4
 uu_5                -1.020987e-01 1 1  ON 5
 uu_6                -1.300273e-01 1 1  ON 6
 uu_7                -1.439196e-01 1 1  ON 7
 uu_8                -1.364886e-01 1 1  ON 8
 uu_9                -1.096885e-01 1 1  ON 9
 ud_0                 4.526743e-01 1 1  ON 10
 ud_1                 1.863713e-01 1 1  ON 11
 ud_2                 6.504033e-02 1 1  ON 12
 ud_3                -6.819091e-03 1 1  ON 13
 ud_4                -6.422760e-02 1 1  ON 14
 ud_5                -1.063047e-01 1 1  ON 15
 ud_6                -1.346407e-01 1 1  ON 16
 ud_7                -1.518421e-01 1 1  ON 17
 ud_8                -1.542358e-01 1 1  ON 18
 ud_9                -1.454567e-01 1 1  ON 19
 eO_0                -7.658880e-01 1 1  ON 20
 eO_1                -4.427801e-01 1 1  ON 21
 eO_2                -1.978395e-02 1 1  ON 22
 eO_3                 3.035899e-01 1 1  ON 23
 eO_4                 5.318570e-01 1 1  ON 24
 eO_5                 4.964882e-01 1 1  ON 25
 eO_6                 2.674524e-01 1 1  ON 26
 eO_7                -3.977173e-02 1 1  ON 27
 eO_8                -2.322894e-01 1 1  ON 28
 eO_9                -9.614992e-02 1 1  ON 29
eH1_0                -2.502280e-01 1 1  ON 30
eH1_1                -1.496060e-01 1 1  ON 31
eH1_2                -1.022722e-01 1 1  ON 32
eH1_3                -4.787148e-02 1 1  ON 33
eH1_4                 2.235078e-04 1 1  ON 34
eH1_5                 3.495912e-02 1 1  ON 35
eH1_6                 9.427347e-02 1 1  ON 36
eH1_7                 1.533248e-01 1 1  ON 37
eH1_8                 1.888580e-01 1 1  ON 38
eH1_9                 8.018025e-02 1 1  ON 39
eH2_0                -2.491616e-01 1 1  ON 40
eH2_1                -1.467224e-01 1 1  ON 41
eH2_2                -9.943726e-02 1 1  ON 42
eH2_3                -4.492285e-02 1 1  ON 43
eH2_4                 3.675726e-03 1 1  ON 44
eH2_5                 3.835474e-02 1 1  ON 45
eH2_6                 9.625648e-02 1 1  ON 46
eH2_7                 1.565979e-01 1 1  ON 47
eH2_8                 1.908498e-01 1 1  ON 48
eH2_9                 7.111043e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6470e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8814
    reference variance = 0.234145
====================================================
  Execution time = 2.0870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3583e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335776214048
                                         uncertainty =       0.003893249630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335776214048
                                         uncertainty =       0.003893249630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409774820
  error estimate for blocks of size 2^( 2) =       0.000422914691
  error estimate for blocks of size 2^( 3) =       0.000436637627
  error estimate for blocks of size 2^( 4) =       0.000449019899
  error estimate for blocks of size 2^( 5) =       0.000458792155
  error estimate for blocks of size 2^( 6) =       0.000467291736
  error estimate for blocks of size 2^( 7) =       0.000472335531

      target function =                  N/A
              le_mean =     -16.904424798461
             les_mean =     286.095408404406
             stat err =       0.000461859830
             autocorr =       1.270368884628
              std dev =       0.579509107338
             le_variance =       0.335830805488


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690442479846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904424798461       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904425727374       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904425326248       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904425839472       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904425562056       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904425758496       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904425958782       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904426270226       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904426093007       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.082204e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904424798461       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904425101649       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904424991892       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904425155475       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904425074926       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904425038498       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904425121314       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904425178023       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.036834e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904424798461       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904424880527       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904424852476       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904424896987       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904424877900       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904424860578       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904424881678       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904424892302       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.605860e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084364 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6458e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.101401e-01 1 1  ON 0
 uu_1                 1.432294e-01 1 1  ON 1
 uu_2                 4.154946e-02 1 1  ON 2
 uu_3                -2.111232e-02 1 1  ON 3
 uu_4                -6.686376e-02 1 1  ON 4
 uu_5                -1.021229e-01 1 1  ON 5
 uu_6                -1.300703e-01 1 1  ON 6
 uu_7                -1.439607e-01 1 1  ON 7
 uu_8                -1.364651e-01 1 1  ON 8
 uu_9                -1.096787e-01 1 1  ON 9
 ud_0                 4.527526e-01 1 1  ON 10
 ud_1                 1.863647e-01 1 1  ON 11
 ud_2                 6.503968e-02 1 1  ON 12
 ud_3                -6.834019e-03 1 1  ON 13
 ud_4                -6.425155e-02 1 1  ON 14
 ud_5                -1.063291e-01 1 1  ON 15
 ud_6                -1.346548e-01 1 1  ON 16
 ud_7                -1.518360e-01 1 1  ON 17
 ud_8                -1.542163e-01 1 1  ON 18
 ud_9                -1.454523e-01 1 1  ON 19
 eO_0                -7.658194e-01 1 1  ON 20
 eO_1                -4.428496e-01 1 1  ON 21
 eO_2                -1.981520e-02 1 1  ON 22
 eO_3                 3.036167e-01 1 1  ON 23
 eO_4                 5.319606e-01 1 1  ON 24
 eO_5                 4.964659e-01 1 1  ON 25
 eO_6                 2.674381e-01 1 1  ON 26
 eO_7                -3.974009e-02 1 1  ON 27
 eO_8                -2.323077e-01 1 1  ON 28
 eO_9                -9.620986e-02 1 1  ON 29
eH1_0                -2.502278e-01 1 1  ON 30
eH1_1                -1.496311e-01 1 1  ON 31
eH1_2                -1.023139e-01 1 1  ON 32
eH1_3                -4.791983e-02 1 1  ON 33
eH1_4                 2.125696e-04 1 1  ON 34
eH1_5                 3.497387e-02 1 1  ON 35
eH1_6                 9.424788e-02 1 1  ON 36
eH1_7                 1.533123e-01 1 1  ON 37
eH1_8                 1.889054e-01 1 1  ON 38
eH1_9                 8.027314e-02 1 1  ON 39
eH2_0                -2.491681e-01 1 1  ON 40
eH2_1                -1.467602e-01 1 1  ON 41
eH2_2                -9.943850e-02 1 1  ON 42
eH2_3                -4.496478e-02 1 1  ON 43
eH2_4                 3.639765e-03 1 1  ON 44
eH2_5                 3.828664e-02 1 1  ON 45
eH2_6                 9.631694e-02 1 1  ON 46
eH2_7                 1.566148e-01 1 1  ON 47
eH2_8                 1.908911e-01 1 1  ON 48
eH2_9                 7.118222e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.245481
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3826e-01
  Total weights = 2.0000e+06
  Execution time = 1.8901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338324978896
                                         uncertainty =       0.003371415816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338324978896
                                         uncertainty =       0.003371415816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205597
  error estimate for blocks of size 2^( 2) =       0.000424391844
  error estimate for blocks of size 2^( 3) =       0.000437686402
  error estimate for blocks of size 2^( 4) =       0.000450120642
  error estimate for blocks of size 2^( 5) =       0.000460384740
  error estimate for blocks of size 2^( 6) =       0.000467379818
  error estimate for blocks of size 2^( 7) =       0.000468265090

      target function =                  N/A
              le_mean =     -16.906122428750
             les_mean =     286.155155492691
             stat err =       0.000461537572
             autocorr =       1.259783999568
              std dev =       0.581532532113
             le_variance =       0.338180085906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338514592482
                                         uncertainty =       0.003373397390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338514592482
                                         uncertainty =       0.003373397390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411320773
  error estimate for blocks of size 2^( 2) =       0.000424505266
  error estimate for blocks of size 2^( 3) =       0.000437795634
  error estimate for blocks of size 2^( 4) =       0.000450223911
  error estimate for blocks of size 2^( 5) =       0.000460482238
  error estimate for blocks of size 2^( 6) =       0.000467469074
  error estimate for blocks of size 2^( 7) =       0.000468350898

      target function =                  N/A
              le_mean =     -16.906124823311
             les_mean =     286.155425929399
             stat err =       0.000461631530
             autocorr =       1.259591268550
              std dev =       0.581695416193
             le_variance =       0.338369557220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338477416076
                                         uncertainty =       0.003373086912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338477416076
                                         uncertainty =       0.003373086912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411298193
  error estimate for blocks of size 2^( 2) =       0.000424482181
  error estimate for blocks of size 2^( 3) =       0.000437773280
  error estimate for blocks of size 2^( 4) =       0.000450202855
  error estimate for blocks of size 2^( 5) =       0.000460463167
  error estimate for blocks of size 2^( 6) =       0.000467453067
  error estimate for blocks of size 2^( 7) =       0.000468336096

      target function =                  N/A
              le_mean =     -16.906123870233
             les_mean =     286.155356553783
             stat err =       0.000461613796
             autocorr =       1.259632788566
              std dev =       0.581663482869
             le_variance =       0.338332407303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338346424401
                                         uncertainty =       0.003371655409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338346424401
                                         uncertainty =       0.003371655409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411218625
  error estimate for blocks of size 2^( 2) =       0.000424404529
  error estimate for blocks of size 2^( 3) =       0.000437698597
  error estimate for blocks of size 2^( 4) =       0.000450132175
  error estimate for blocks of size 2^( 5) =       0.000460395757
  error estimate for blocks of size 2^( 6) =       0.000467390155
  error estimate for blocks of size 2^( 7) =       0.000468275145

      target function =                  N/A
              le_mean =     -16.906122608388
             les_mean =     286.155182995660
             stat err =       0.000461548308
             autocorr =       1.259762782320
              std dev =       0.581550956429
             le_variance =       0.338201514924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906122428750        initial
     6.1035e-01     6.1035e+00             4.0822e-04       -16.906124823311  <--
     2.4414e+00     2.4414e+01             1.0368e-04       -16.906123870233
     9.7656e+00     9.7656e+01             2.6059e-05       -16.906122608388

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9813e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.101929e-01 1 1  ON 0
 uu_1                 1.431589e-01 1 1  ON 1
 uu_2                 4.152257e-02 1 1  ON 2
 uu_3                -2.113134e-02 1 1  ON 3
 uu_4                -6.681710e-02 1 1  ON 4
 uu_5                -1.021724e-01 1 1  ON 5
 uu_6                -1.301732e-01 1 1  ON 6
 uu_7                -1.440820e-01 1 1  ON 7
 uu_8                -1.364020e-01 1 1  ON 8
 uu_9                -1.096482e-01 1 1  ON 9
 ud_0                 4.528759e-01 1 1  ON 10
 ud_1                 1.863686e-01 1 1  ON 11
 ud_2                 6.505469e-02 1 1  ON 12
 ud_3                -6.859113e-03 1 1  ON 13
 ud_4                -6.430710e-02 1 1  ON 14
 ud_5                -1.063826e-01 1 1  ON 15
 ud_6                -1.346788e-01 1 1  ON 16
 ud_7                -1.518241e-01 1 1  ON 17
 ud_8                -1.541602e-01 1 1  ON 18
 ud_9                -1.454356e-01 1 1  ON 19
 eO_0                -7.657142e-01 1 1  ON 20
 eO_1                -4.429759e-01 1 1  ON 21
 eO_2                -1.989928e-02 1 1  ON 22
 eO_3                 3.037015e-01 1 1  ON 23
 eO_4                 5.322652e-01 1 1  ON 24
 eO_5                 4.964109e-01 1 1  ON 25
 eO_6                 2.673974e-01 1 1  ON 26
 eO_7                -3.964837e-02 1 1  ON 27
 eO_8                -2.323627e-01 1 1  ON 28
 eO_9                -9.638983e-02 1 1  ON 29
eH1_0                -2.502421e-01 1 1  ON 30
eH1_1                -1.497103e-01 1 1  ON 31
eH1_2                -1.024373e-01 1 1  ON 32
eH1_3                -4.804822e-02 1 1  ON 33
eH1_4                 1.692609e-04 1 1  ON 34
eH1_5                 3.501698e-02 1 1  ON 35
eH1_6                 9.417847e-02 1 1  ON 36
eH1_7                 1.532781e-01 1 1  ON 37
eH1_8                 1.890470e-01 1 1  ON 38
eH1_9                 8.055299e-02 1 1  ON 39
eH2_0                -2.491986e-01 1 1  ON 40
eH2_1                -1.468584e-01 1 1  ON 41
eH2_2                -9.947124e-02 1 1  ON 42
eH2_3                -4.507937e-02 1 1  ON 43
eH2_4                 3.535331e-03 1 1  ON 44
eH2_5                 3.809287e-02 1 1  ON 45
eH2_6                 9.649209e-02 1 1  ON 46
eH2_7                 1.566678e-01 1 1  ON 47
eH2_8                 1.910166e-01 1 1  ON 48
eH2_9                 7.139924e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8481
    reference variance = 0.274103
====================================================
  Execution time = 2.0949e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4466e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344750269224
                                         uncertainty =       0.003978092802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344750269224
                                         uncertainty =       0.003978092802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415124183
  error estimate for blocks of size 2^( 2) =       0.000427906523
  error estimate for blocks of size 2^( 3) =       0.000440959492
  error estimate for blocks of size 2^( 4) =       0.000453377344
  error estimate for blocks of size 2^( 5) =       0.000463988688
  error estimate for blocks of size 2^( 6) =       0.000471095303
  error estimate for blocks of size 2^( 7) =       0.000476586593

      target function =                  N/A
              le_mean =     -16.906403550913
             les_mean =     286.171137028796
             stat err =       0.000466261982
             autocorr =       1.261548474224
              std dev =       0.587074249813
             le_variance =       0.344656174793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640355091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906403550913       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906403190226       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906403436682       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906402266291       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906402741793       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906402988531       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906404206695       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906404657865       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906404818733       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906404890540       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906404712538       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.434433e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906403550913       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906403382626       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906403408381       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906403432646       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906403157367       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906403202576       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906403574874       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906403677532       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906403666933       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.570111e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906403550913       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906403497211       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906403495502       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906403510221       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906403433843       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906403434120       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906403529693       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906403540550       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.026034e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6545e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.100505e-01 1 1  ON 0
 uu_1                 1.431533e-01 1 1  ON 1
 uu_2                 4.156037e-02 1 1  ON 2
 uu_3                -2.104700e-02 1 1  ON 3
 uu_4                -6.684085e-02 1 1  ON 4
 uu_5                -1.021920e-01 1 1  ON 5
 uu_6                -1.301519e-01 1 1  ON 6
 uu_7                -1.441507e-01 1 1  ON 7
 uu_8                -1.364376e-01 1 1  ON 8
 uu_9                -1.096784e-01 1 1  ON 9
 ud_0                 4.528174e-01 1 1  ON 10
 ud_1                 1.864364e-01 1 1  ON 11
 ud_2                 6.508858e-02 1 1  ON 12
 ud_3                -6.859884e-03 1 1  ON 13
 ud_4                -6.439235e-02 1 1  ON 14
 ud_5                -1.064542e-01 1 1  ON 15
 ud_6                -1.346592e-01 1 1  ON 16
 ud_7                -1.518890e-01 1 1  ON 17
 ud_8                -1.539931e-01 1 1  ON 18
 ud_9                -1.453767e-01 1 1  ON 19
 eO_0                -7.657947e-01 1 1  ON 20
 eO_1                -4.428997e-01 1 1  ON 21
 eO_2                -1.991833e-02 1 1  ON 22
 eO_3                 3.037216e-01 1 1  ON 23
 eO_4                 5.323824e-01 1 1  ON 24
 eO_5                 4.965110e-01 1 1  ON 25
 eO_6                 2.674168e-01 1 1  ON 26
 eO_7                -3.948771e-02 1 1  ON 27
 eO_8                -2.324692e-01 1 1  ON 28
 eO_9                -9.662577e-02 1 1  ON 29
eH1_0                -2.504425e-01 1 1  ON 30
eH1_1                -1.497051e-01 1 1  ON 31
eH1_2                -1.024913e-01 1 1  ON 32
eH1_3                -4.818636e-02 1 1  ON 33
eH1_4                 2.541218e-04 1 1  ON 34
eH1_5                 3.485743e-02 1 1  ON 35
eH1_6                 9.423627e-02 1 1  ON 36
eH1_7                 1.532329e-01 1 1  ON 37
eH1_8                 1.891358e-01 1 1  ON 38
eH1_9                 8.088037e-02 1 1  ON 39
eH2_0                -2.489772e-01 1 1  ON 40
eH2_1                -1.470276e-01 1 1  ON 41
eH2_2                -9.982596e-02 1 1  ON 42
eH2_3                -4.522558e-02 1 1  ON 43
eH2_4                 3.262347e-03 1 1  ON 44
eH2_5                 3.801824e-02 1 1  ON 45
eH2_6                 9.662667e-02 1 1  ON 46
eH2_7                 1.567413e-01 1 1  ON 47
eH2_8                 1.911944e-01 1 1  ON 48
eH2_9                 7.175625e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8676
    reference variance = 0.223889
====================================================
  Execution time = 2.0004e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3985e-01
  Total weights = 2.0000e+06
  Execution time = 1.8947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339931002551
                                         uncertainty =       0.004408810949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339931002551
                                         uncertainty =       0.004408810949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412270513
  error estimate for blocks of size 2^( 2) =       0.000424828904
  error estimate for blocks of size 2^( 3) =       0.000437775161
  error estimate for blocks of size 2^( 4) =       0.000450372749
  error estimate for blocks of size 2^( 5) =       0.000461273856
  error estimate for blocks of size 2^( 6) =       0.000468944233
  error estimate for blocks of size 2^( 7) =       0.000471877185

      target function =                  N/A
              le_mean =     -16.906134710428
             les_mean =     286.157324628793
             stat err =       0.000463117006
             autocorr =       1.261876669491
              std dev =       0.583038550724
             le_variance =       0.339933951631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339837490666
                                         uncertainty =       0.004415880259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339837490666
                                         uncertainty =       0.004415880259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412213780
  error estimate for blocks of size 2^( 2) =       0.000424775441
  error estimate for blocks of size 2^( 3) =       0.000437725955
  error estimate for blocks of size 2^( 4) =       0.000450321128
  error estimate for blocks of size 2^( 5) =       0.000461218042
  error estimate for blocks of size 2^( 6) =       0.000468889502
  error estimate for blocks of size 2^( 7) =       0.000471834636

      target function =                  N/A
              le_mean =     -16.906135697560
             les_mean =     286.157264455931
             stat err =       0.000463065827
             autocorr =       1.261945072293
              std dev =       0.582958318878
             le_variance =       0.339840401549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339759676504
                                         uncertainty =       0.004413954954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339759676504
                                         uncertainty =       0.004413954954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412166607
  error estimate for blocks of size 2^( 2) =       0.000424729281
  error estimate for blocks of size 2^( 3) =       0.000437681382
  error estimate for blocks of size 2^( 4) =       0.000450277861
  error estimate for blocks of size 2^( 5) =       0.000461176365
  error estimate for blocks of size 2^( 6) =       0.000468848201
  error estimate for blocks of size 2^( 7) =       0.000471792020

      target function =                  N/A
              le_mean =     -16.906135908057
             les_mean =     286.157193796406
             stat err =       0.000463023612
             autocorr =       1.262003820298
              std dev =       0.582891606210
             le_variance =       0.339762624590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339893949939
                                         uncertainty =       0.004409605702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339893949939
                                         uncertainty =       0.004409605702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412248045
  error estimate for blocks of size 2^( 2) =       0.000424807293
  error estimate for blocks of size 2^( 3) =       0.000437754781
  error estimate for blocks of size 2^( 4) =       0.000450352372
  error estimate for blocks of size 2^( 5) =       0.000461253149
  error estimate for blocks of size 2^( 6) =       0.000468923763
  error estimate for blocks of size 2^( 7) =       0.000471858476

      target function =                  N/A
              le_mean =     -16.906134895509
             les_mean =     286.157293836478
             stat err =       0.000463096940
             autocorr =       1.261904859122
              std dev =       0.583006776359
             le_variance =       0.339896901281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906134710428        initial
     1.5259e-01     1.5259e+00             1.4344e-03       -16.906135697560
     6.1035e-01     6.1035e+00             3.5701e-04       -16.906135908057  <--
     2.4414e+00     2.4414e+01             1.0260e-04       -16.906134895509

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9583e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.100505e-01 1 1  ON 0
 uu_1                 1.431533e-01 1 1  ON 1
 uu_2                 4.156037e-02 1 1  ON 2
 uu_3                -2.104700e-02 1 1  ON 3
 uu_4                -6.684085e-02 1 1  ON 4
 uu_5                -1.021920e-01 1 1  ON 5
 uu_6                -1.301519e-01 1 1  ON 6
 uu_7                -1.441507e-01 1 1  ON 7
 uu_8                -1.364376e-01 1 1  ON 8
 uu_9                -1.096784e-01 1 1  ON 9
 ud_0                 4.528174e-01 1 1  ON 10
 ud_1                 1.864364e-01 1 1  ON 11
 ud_2                 6.508858e-02 1 1  ON 12
 ud_3                -6.859884e-03 1 1  ON 13
 ud_4                -6.439235e-02 1 1  ON 14
 ud_5                -1.064542e-01 1 1  ON 15
 ud_6                -1.346592e-01 1 1  ON 16
 ud_7                -1.518890e-01 1 1  ON 17
 ud_8                -1.539931e-01 1 1  ON 18
 ud_9                -1.453767e-01 1 1  ON 19
 eO_0                -7.657947e-01 1 1  ON 20
 eO_1                -4.428997e-01 1 1  ON 21
 eO_2                -1.991833e-02 1 1  ON 22
 eO_3                 3.037216e-01 1 1  ON 23
 eO_4                 5.323824e-01 1 1  ON 24
 eO_5                 4.965110e-01 1 1  ON 25
 eO_6                 2.674168e-01 1 1  ON 26
 eO_7                -3.948771e-02 1 1  ON 27
 eO_8                -2.324692e-01 1 1  ON 28
 eO_9                -9.662577e-02 1 1  ON 29
eH1_0                -2.504425e-01 1 1  ON 30
eH1_1                -1.497051e-01 1 1  ON 31
eH1_2                -1.024913e-01 1 1  ON 32
eH1_3                -4.818636e-02 1 1  ON 33
eH1_4                 2.541218e-04 1 1  ON 34
eH1_5                 3.485743e-02 1 1  ON 35
eH1_6                 9.423627e-02 1 1  ON 36
eH1_7                 1.532329e-01 1 1  ON 37
eH1_8                 1.891358e-01 1 1  ON 38
eH1_9                 8.088037e-02 1 1  ON 39
eH2_0                -2.489772e-01 1 1  ON 40
eH2_1                -1.470276e-01 1 1  ON 41
eH2_2                -9.982596e-02 1 1  ON 42
eH2_3                -4.522558e-02 1 1  ON 43
eH2_4                 3.262347e-03 1 1  ON 44
eH2_5                 3.801824e-02 1 1  ON 45
eH2_6                 9.662667e-02 1 1  ON 46
eH2_7                 1.567413e-01 1 1  ON 47
eH2_8                 1.911944e-01 1 1  ON 48
eH2_9                 7.175625e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8809
    reference variance = 0.328975
====================================================
  Execution time = 2.0456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4619e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346339709621
                                         uncertainty =       0.006943878344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346339709621
                                         uncertainty =       0.006943878344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416045522
  error estimate for blocks of size 2^( 2) =       0.000428674587
  error estimate for blocks of size 2^( 3) =       0.000440674016
  error estimate for blocks of size 2^( 4) =       0.000452484680
  error estimate for blocks of size 2^( 5) =       0.000463187779
  error estimate for blocks of size 2^( 6) =       0.000470549789
  error estimate for blocks of size 2^( 7) =       0.000475840567

      target function =                  N/A
              le_mean =     -16.906674902181
             les_mean =     286.181843827144
             stat err =       0.000465515704
             autocorr =       1.251949954881
              std dev =       0.588377219303
             le_variance =       0.346187752194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690667490218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906674902181       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906674543708       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906674079811       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906673183800       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906673045753       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906673980869       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906674523886       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906675666652       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906675029357       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906675161891       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906675172740       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.619934e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906674902181       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906674750010       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906674493974       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906674031692       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906674052356       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906674272363       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906674457251       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906674658697       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906674594855       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.073070e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906674902181       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906674856097       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906674767394       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906674619076       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906674620511       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906674665162       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906674714136       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906674753705       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.014919e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091104 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6472e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.100207e-01 1 1  ON 0
 uu_1                 1.431405e-01 1 1  ON 1
 uu_2                 4.150218e-02 1 1  ON 2
 uu_3                -2.110322e-02 1 1  ON 3
 uu_4                -6.691940e-02 1 1  ON 4
 uu_5                -1.021379e-01 1 1  ON 5
 uu_6                -1.302235e-01 1 1  ON 6
 uu_7                -1.443034e-01 1 1  ON 7
 uu_8                -1.364765e-01 1 1  ON 8
 uu_9                -1.096144e-01 1 1  ON 9
 ud_0                 4.528986e-01 1 1  ON 10
 ud_1                 1.864814e-01 1 1  ON 11
 ud_2                 6.509812e-02 1 1  ON 12
 ud_3                -6.889627e-03 1 1  ON 13
 ud_4                -6.435171e-02 1 1  ON 14
 ud_5                -1.063850e-01 1 1  ON 15
 ud_6                -1.347441e-01 1 1  ON 16
 ud_7                -1.520457e-01 1 1  ON 17
 ud_8                -1.537496e-01 1 1  ON 18
 ud_9                -1.453917e-01 1 1  ON 19
 eO_0                -7.657968e-01 1 1  ON 20
 eO_1                -4.428836e-01 1 1  ON 21
 eO_2                -1.971182e-02 1 1  ON 22
 eO_3                 3.037914e-01 1 1  ON 23
 eO_4                 5.322910e-01 1 1  ON 24
 eO_5                 4.965856e-01 1 1  ON 25
 eO_6                 2.674430e-01 1 1  ON 26
 eO_7                -3.944228e-02 1 1  ON 27
 eO_8                -2.325666e-01 1 1  ON 28
 eO_9                -9.683437e-02 1 1  ON 29
eH1_0                -2.506977e-01 1 1  ON 30
eH1_1                -1.497246e-01 1 1  ON 31
eH1_2                -1.024211e-01 1 1  ON 32
eH1_3                -4.826163e-02 1 1  ON 33
eH1_4                 1.936986e-04 1 1  ON 34
eH1_5                 3.470145e-02 1 1  ON 35
eH1_6                 9.421587e-02 1 1  ON 36
eH1_7                 1.532299e-01 1 1  ON 37
eH1_8                 1.893236e-01 1 1  ON 38
eH1_9                 8.118379e-02 1 1  ON 39
eH2_0                -2.489886e-01 1 1  ON 40
eH2_1                -1.472695e-01 1 1  ON 41
eH2_2                -9.982613e-02 1 1  ON 42
eH2_3                -4.529672e-02 1 1  ON 43
eH2_4                 3.211843e-03 1 1  ON 44
eH2_5                 3.795157e-02 1 1  ON 45
eH2_6                 9.649904e-02 1 1  ON 46
eH2_7                 1.567052e-01 1 1  ON 47
eH2_8                 1.913275e-01 1 1  ON 48
eH2_9                 7.216356e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9435
    reference variance = 0.495315
====================================================
  Execution time = 2.0073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3930e-01
  Total weights = 2.0000e+06
  Execution time = 1.9045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339230088232
                                         uncertainty =       0.002998839269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339230088232
                                         uncertainty =       0.002998839269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411859274
  error estimate for blocks of size 2^( 2) =       0.000425205814
  error estimate for blocks of size 2^( 3) =       0.000438399431
  error estimate for blocks of size 2^( 4) =       0.000452072836
  error estimate for blocks of size 2^( 5) =       0.000463437790
  error estimate for blocks of size 2^( 6) =       0.000472645209
  error estimate for blocks of size 2^( 7) =       0.000480088765

      target function =                  N/A
              le_mean =     -16.906605000774
             les_mean =     286.172548606206
             stat err =       0.000467061150
             autocorr =       1.286026118945
              std dev =       0.582456971495
             le_variance =       0.339256123643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339306707519
                                         uncertainty =       0.003000937698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339306707519
                                         uncertainty =       0.003000937698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411905775
  error estimate for blocks of size 2^( 2) =       0.000425252521
  error estimate for blocks of size 2^( 3) =       0.000438446080
  error estimate for blocks of size 2^( 4) =       0.000452122735
  error estimate for blocks of size 2^( 5) =       0.000463487871
  error estimate for blocks of size 2^( 6) =       0.000472694823
  error estimate for blocks of size 2^( 7) =       0.000480135121

      target function =                  N/A
              le_mean =     -16.906605063310
             les_mean =     286.172627331778
             stat err =       0.000467110137
             autocorr =       1.286005493795
              std dev =       0.582522733200
             le_variance =       0.339332734695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339309987578
                                         uncertainty =       0.003000903993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339309987578
                                         uncertainty =       0.003000903993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411907776
  error estimate for blocks of size 2^( 2) =       0.000425254110
  error estimate for blocks of size 2^( 3) =       0.000438447173
  error estimate for blocks of size 2^( 4) =       0.000452123294
  error estimate for blocks of size 2^( 5) =       0.000463488239
  error estimate for blocks of size 2^( 6) =       0.000472694258
  error estimate for blocks of size 2^( 7) =       0.000480136173

      target function =                  N/A
              le_mean =     -16.906605032745
             les_mean =     286.172629595818
             stat err =       0.000467110491
             autocorr =       1.285994943606
              std dev =       0.582525563600
             le_variance =       0.339336032247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339242397042
                                         uncertainty =       0.002999141540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339242397042
                                         uncertainty =       0.002999141540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411866748
  error estimate for blocks of size 2^( 2) =       0.000425213251
  error estimate for blocks of size 2^( 3) =       0.000438406716
  error estimate for blocks of size 2^( 4) =       0.000452080529
  error estimate for blocks of size 2^( 5) =       0.000463445409
  error estimate for blocks of size 2^( 6) =       0.000472652528
  error estimate for blocks of size 2^( 7) =       0.000480095963

      target function =                  N/A
              le_mean =     -16.906604917101
             les_mean =     286.172558089218
             stat err =       0.000467068607
             autocorr =       1.286020512088
              std dev =       0.582467540660
             le_variance =       0.339268435923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906605000774        initial
     1.5259e-01     1.5259e+00             1.6199e-03       -16.906605063310  <--
     6.1035e-01     6.1035e+00             4.0731e-04       -16.906605032745
     2.4414e+00     2.4414e+01             1.0149e-04       -16.906604917101

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9653e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.099456e-01 1 1  ON 0
 uu_1                 1.430620e-01 1 1  ON 1
 uu_2                 4.137081e-02 1 1  ON 2
 uu_3                -2.126199e-02 1 1  ON 3
 uu_4                -6.705011e-02 1 1  ON 4
 uu_5                -1.021461e-01 1 1  ON 5
 uu_6                -1.303762e-01 1 1  ON 6
 uu_7                -1.446610e-01 1 1  ON 7
 uu_8                -1.366678e-01 1 1  ON 8
 uu_9                -1.094714e-01 1 1  ON 9
 ud_0                 4.530341e-01 1 1  ON 10
 ud_1                 1.865893e-01 1 1  ON 11
 ud_2                 6.517406e-02 1 1  ON 12
 ud_3                -6.847614e-03 1 1  ON 13
 ud_4                -6.425271e-02 1 1  ON 14
 ud_5                -1.062743e-01 1 1  ON 15
 ud_6                -1.348024e-01 1 1  ON 16
 ud_7                -1.523611e-01 1 1  ON 17
 ud_8                -1.532638e-01 1 1  ON 18
 ud_9                -1.454681e-01 1 1  ON 19
 eO_0                -7.657072e-01 1 1  ON 20
 eO_1                -4.427411e-01 1 1  ON 21
 eO_2                -1.936699e-02 1 1  ON 22
 eO_3                 3.039728e-01 1 1  ON 23
 eO_4                 5.321882e-01 1 1  ON 24
 eO_5                 4.967989e-01 1 1  ON 25
 eO_6                 2.675389e-01 1 1  ON 26
 eO_7                -3.933901e-02 1 1  ON 27
 eO_8                -2.328878e-01 1 1  ON 28
 eO_9                -9.746351e-02 1 1  ON 29
eH1_0                -2.512124e-01 1 1  ON 30
eH1_1                -1.498701e-01 1 1  ON 31
eH1_2                -1.024621e-01 1 1  ON 32
eH1_3                -4.841991e-02 1 1  ON 33
eH1_4                -1.655850e-05 1 1  ON 34
eH1_5                 3.433846e-02 1 1  ON 35
eH1_6                 9.412594e-02 1 1  ON 36
eH1_7                 1.532085e-01 1 1  ON 37
eH1_8                 1.898749e-01 1 1  ON 38
eH1_9                 8.209065e-02 1 1  ON 39
eH2_0                -2.491605e-01 1 1  ON 40
eH2_1                -1.476851e-01 1 1  ON 41
eH2_2                -9.997184e-02 1 1  ON 42
eH2_3                -4.549632e-02 1 1  ON 43
eH2_4                 3.012494e-03 1 1  ON 44
eH2_5                 3.776327e-02 1 1  ON 45
eH2_6                 9.614525e-02 1 1  ON 46
eH2_7                 1.565906e-01 1 1  ON 47
eH2_8                 1.917078e-01 1 1  ON 48
eH2_9                 7.337619e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8874
    reference variance = 0.267093
====================================================
  Execution time = 2.0465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3250e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332407472104
                                         uncertainty =       0.002398754334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332407472104
                                         uncertainty =       0.002398754334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407737496
  error estimate for blocks of size 2^( 2) =       0.000420565138
  error estimate for blocks of size 2^( 3) =       0.000433545874
  error estimate for blocks of size 2^( 4) =       0.000445297379
  error estimate for blocks of size 2^( 5) =       0.000455476643
  error estimate for blocks of size 2^( 6) =       0.000463493250
  error estimate for blocks of size 2^( 7) =       0.000468469264

      target function =                  N/A
              le_mean =     -16.906157934562
             les_mean =     286.150675674156
             stat err =       0.000458184134
             autocorr =       1.262754104904
              std dev =       0.576627897383
             le_variance =       0.332499732041


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615793456e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157934562       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906159243905       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906159795329       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906160388303       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906162073800       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906162117416       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161318387       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906163024841       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906163459692       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906163560939       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906164441598       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906164557203       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906164735861       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906164566641       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 4.300031e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157934562       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158836562       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906159002395       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906159967585       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906160328986       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906160639690       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906159968846       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906160346461       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906160329718       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906160407963       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.101634e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157934562       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158336448       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906158346393       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906158533223       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158870484       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158995167       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158933620       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158887790       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.713265e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6116e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.098725e-01 1 1  ON 0
 uu_1                 1.432085e-01 1 1  ON 1
 uu_2                 4.146748e-02 1 1  ON 2
 uu_3                -2.121359e-02 1 1  ON 3
 uu_4                -6.692005e-02 1 1  ON 4
 uu_5                -1.020636e-01 1 1  ON 5
 uu_6                -1.304506e-01 1 1  ON 6
 uu_7                -1.445513e-01 1 1  ON 7
 uu_8                -1.368805e-01 1 1  ON 8
 uu_9                -1.102812e-01 1 1  ON 9
 ud_0                 4.530485e-01 1 1  ON 10
 ud_1                 1.867980e-01 1 1  ON 11
 ud_2                 6.548670e-02 1 1  ON 12
 ud_3                -6.519068e-03 1 1  ON 13
 ud_4                -6.417211e-02 1 1  ON 14
 ud_5                -1.063466e-01 1 1  ON 15
 ud_6                -1.347419e-01 1 1  ON 16
 ud_7                -1.520851e-01 1 1  ON 17
 ud_8                -1.531412e-01 1 1  ON 18
 ud_9                -1.459248e-01 1 1  ON 19
 eO_0                -7.654419e-01 1 1  ON 20
 eO_1                -4.425187e-01 1 1  ON 21
 eO_2                -1.932774e-02 1 1  ON 22
 eO_3                 3.039992e-01 1 1  ON 23
 eO_4                 5.326039e-01 1 1  ON 24
 eO_5                 4.972000e-01 1 1  ON 25
 eO_6                 2.675409e-01 1 1  ON 26
 eO_7                -3.894469e-02 1 1  ON 27
 eO_8                -2.333279e-01 1 1  ON 28
 eO_9                -9.856514e-02 1 1  ON 29
eH1_0                -2.516965e-01 1 1  ON 30
eH1_1                -1.501933e-01 1 1  ON 31
eH1_2                -1.029400e-01 1 1  ON 32
eH1_3                -4.879732e-02 1 1  ON 33
eH1_4                -2.868792e-04 1 1  ON 34
eH1_5                 3.435903e-02 1 1  ON 35
eH1_6                 9.431761e-02 1 1  ON 36
eH1_7                 1.533919e-01 1 1  ON 37
eH1_8                 1.904423e-01 1 1  ON 38
eH1_9                 8.312898e-02 1 1  ON 39
eH2_0                -2.493551e-01 1 1  ON 40
eH2_1                -1.476034e-01 1 1  ON 41
eH2_2                -1.004127e-01 1 1  ON 42
eH2_3                -4.577268e-02 1 1  ON 43
eH2_4                 2.773026e-03 1 1  ON 44
eH2_5                 3.776874e-02 1 1  ON 45
eH2_6                 9.626872e-02 1 1  ON 46
eH2_7                 1.561288e-01 1 1  ON 47
eH2_8                 1.921550e-01 1 1  ON 48
eH2_9                 7.437080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.815
    reference variance = 0.194581
====================================================
  Execution time = 2.0038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3700e-01
  Total weights = 2.0000e+06
  Execution time = 1.8932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337189496385
                                         uncertainty =       0.003753596393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337189496385
                                         uncertainty =       0.003753596393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410610142
  error estimate for blocks of size 2^( 2) =       0.000423507316
  error estimate for blocks of size 2^( 3) =       0.000436191868
  error estimate for blocks of size 2^( 4) =       0.000448184720
  error estimate for blocks of size 2^( 5) =       0.000457781771
  error estimate for blocks of size 2^( 6) =       0.000463077107
  error estimate for blocks of size 2^( 7) =       0.000466927946

      target function =                  N/A
              le_mean =     -16.906388125213
             les_mean =     286.163160650002
             stat err =       0.000458992886
             autocorr =       1.249546905057
              std dev =       0.580690432370
             le_variance =       0.337201378246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336991868053
                                         uncertainty =       0.003747648317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336991868053
                                         uncertainty =       0.003747648317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410489676
  error estimate for blocks of size 2^( 2) =       0.000423390281
  error estimate for blocks of size 2^( 3) =       0.000436073858
  error estimate for blocks of size 2^( 4) =       0.000448063081
  error estimate for blocks of size 2^( 5) =       0.000457650932
  error estimate for blocks of size 2^( 6) =       0.000462947422
  error estimate for blocks of size 2^( 7) =       0.000466792905

      target function =                  N/A
              le_mean =     -16.906390091872
             les_mean =     286.163029318794
             stat err =       0.000458863585
             autocorr =       1.249576097962
              std dev =       0.580520067476
             le_variance =       0.337003548743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797885926
                                         uncertainty =       0.003743350993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797885926
                                         uncertainty =       0.003743350993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410371370
  error estimate for blocks of size 2^( 2) =       0.000423279084
  error estimate for blocks of size 2^( 3) =       0.000435970256
  error estimate for blocks of size 2^( 4) =       0.000447965362
  error estimate for blocks of size 2^( 5) =       0.000457554285
  error estimate for blocks of size 2^( 6) =       0.000462854796
  error estimate for blocks of size 2^( 7) =       0.000466705119

      target function =                  N/A
              le_mean =     -16.906390651943
             les_mean =     286.162854029767
             stat err =       0.000458769890
             autocorr =       1.249786146769
              std dev =       0.580352756564
             le_variance =       0.336809322051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337076516050
                                         uncertainty =       0.003750870576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337076516050
                                         uncertainty =       0.003750870576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410541273
  error estimate for blocks of size 2^( 2) =       0.000423441574
  error estimate for blocks of size 2^( 3) =       0.000436128810
  error estimate for blocks of size 2^( 4) =       0.000448123040
  error estimate for blocks of size 2^( 5) =       0.000457718429
  error estimate for blocks of size 2^( 6) =       0.000463015797
  error estimate for blocks of size 2^( 7) =       0.000466866700

      target function =                  N/A
              le_mean =     -16.906388293524
             les_mean =     286.163053236207
             stat err =       0.000458930992
             autocorr =       1.249629083350
              std dev =       0.580593035916
             le_variance =       0.337088273354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906388125213        initial
     3.8147e-02     3.8147e-01             4.3000e-03       -16.906390091872
     1.5259e-01     1.5259e+00             1.1016e-03       -16.906390651943  <--
     6.1035e-01     6.1035e+00             2.7133e-04       -16.906388293524

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9560e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.098725e-01 1 1  ON 0
 uu_1                 1.432085e-01 1 1  ON 1
 uu_2                 4.146748e-02 1 1  ON 2
 uu_3                -2.121359e-02 1 1  ON 3
 uu_4                -6.692005e-02 1 1  ON 4
 uu_5                -1.020636e-01 1 1  ON 5
 uu_6                -1.304506e-01 1 1  ON 6
 uu_7                -1.445513e-01 1 1  ON 7
 uu_8                -1.368805e-01 1 1  ON 8
 uu_9                -1.102812e-01 1 1  ON 9
 ud_0                 4.530485e-01 1 1  ON 10
 ud_1                 1.867980e-01 1 1  ON 11
 ud_2                 6.548670e-02 1 1  ON 12
 ud_3                -6.519068e-03 1 1  ON 13
 ud_4                -6.417211e-02 1 1  ON 14
 ud_5                -1.063466e-01 1 1  ON 15
 ud_6                -1.347419e-01 1 1  ON 16
 ud_7                -1.520851e-01 1 1  ON 17
 ud_8                -1.531412e-01 1 1  ON 18
 ud_9                -1.459248e-01 1 1  ON 19
 eO_0                -7.654419e-01 1 1  ON 20
 eO_1                -4.425187e-01 1 1  ON 21
 eO_2                -1.932774e-02 1 1  ON 22
 eO_3                 3.039992e-01 1 1  ON 23
 eO_4                 5.326039e-01 1 1  ON 24
 eO_5                 4.972000e-01 1 1  ON 25
 eO_6                 2.675409e-01 1 1  ON 26
 eO_7                -3.894469e-02 1 1  ON 27
 eO_8                -2.333279e-01 1 1  ON 28
 eO_9                -9.856514e-02 1 1  ON 29
eH1_0                -2.516965e-01 1 1  ON 30
eH1_1                -1.501933e-01 1 1  ON 31
eH1_2                -1.029400e-01 1 1  ON 32
eH1_3                -4.879732e-02 1 1  ON 33
eH1_4                -2.868792e-04 1 1  ON 34
eH1_5                 3.435903e-02 1 1  ON 35
eH1_6                 9.431761e-02 1 1  ON 36
eH1_7                 1.533919e-01 1 1  ON 37
eH1_8                 1.904423e-01 1 1  ON 38
eH1_9                 8.312898e-02 1 1  ON 39
eH2_0                -2.493551e-01 1 1  ON 40
eH2_1                -1.476034e-01 1 1  ON 41
eH2_2                -1.004127e-01 1 1  ON 42
eH2_3                -4.577268e-02 1 1  ON 43
eH2_4                 2.773026e-03 1 1  ON 44
eH2_5                 3.776874e-02 1 1  ON 45
eH2_6                 9.626872e-02 1 1  ON 46
eH2_7                 1.561288e-01 1 1  ON 47
eH2_8                 1.921550e-01 1 1  ON 48
eH2_9                 7.437080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5683e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8719
    reference variance = 0.264488
====================================================
  Execution time = 2.0382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4022e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340091243146
                                         uncertainty =       0.005451399202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340091243146
                                         uncertainty =       0.005451399202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412446619
  error estimate for blocks of size 2^( 2) =       0.000425278832
  error estimate for blocks of size 2^( 3) =       0.000438490282
  error estimate for blocks of size 2^( 4) =       0.000450971957
  error estimate for blocks of size 2^( 5) =       0.000461366510
  error estimate for blocks of size 2^( 6) =       0.000469270156
  error estimate for blocks of size 2^( 7) =       0.000473241101

      target function =                  N/A
              le_mean =     -16.906477756270
             les_mean =     286.169214380964
             stat err =       0.000463712431
             autocorr =       1.264043385137
              std dev =       0.583287602999
             le_variance =       0.340224427813


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647775627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906477756270       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906477935235       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906476216033       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906475740399       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906478199816       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906480032400       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906478838442       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906480944135       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906481798136       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906482387790       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906481795647       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906482521425       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906482151195       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906482968784       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 5.484991e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906477756270       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906477872318       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906476606735       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906476349060       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906477697701       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906478251777       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906478242711       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906478829721       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906478623811       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906478543465       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.364503e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906477756270       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906477804498       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906477195616       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906477132952       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906477439598       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906477536098       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906477812617       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906477896109       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906477816395       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.456939e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5995e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.100115e-01 1 1  ON 0
 uu_1                 1.429356e-01 1 1  ON 1
 uu_2                 4.136920e-02 1 1  ON 2
 uu_3                -2.128329e-02 1 1  ON 3
 uu_4                -6.704753e-02 1 1  ON 4
 uu_5                -1.024009e-01 1 1  ON 5
 uu_6                -1.307195e-01 1 1  ON 6
 uu_7                -1.447251e-01 1 1  ON 7
 uu_8                -1.373058e-01 1 1  ON 8
 uu_9                -1.101897e-01 1 1  ON 9
 ud_0                 4.530343e-01 1 1  ON 10
 ud_1                 1.868090e-01 1 1  ON 11
 ud_2                 6.562327e-02 1 1  ON 12
 ud_3                -6.450542e-03 1 1  ON 13
 ud_4                -6.410441e-02 1 1  ON 14
 ud_5                -1.064174e-01 1 1  ON 15
 ud_6                -1.345639e-01 1 1  ON 16
 ud_7                -1.520580e-01 1 1  ON 17
 ud_8                -1.532267e-01 1 1  ON 18
 ud_9                -1.455871e-01 1 1  ON 19
 eO_0                -7.647973e-01 1 1  ON 20
 eO_1                -4.419622e-01 1 1  ON 21
 eO_2                -1.959189e-02 1 1  ON 22
 eO_3                 3.041505e-01 1 1  ON 23
 eO_4                 5.325171e-01 1 1  ON 24
 eO_5                 4.972858e-01 1 1  ON 25
 eO_6                 2.679692e-01 1 1  ON 26
 eO_7                -3.873475e-02 1 1  ON 27
 eO_8                -2.341679e-01 1 1  ON 28
 eO_9                -9.934584e-02 1 1  ON 29
eH1_0                -2.519952e-01 1 1  ON 30
eH1_1                -1.507495e-01 1 1  ON 31
eH1_2                -1.037019e-01 1 1  ON 32
eH1_3                -4.892337e-02 1 1  ON 33
eH1_4                -7.181073e-04 1 1  ON 34
eH1_5                 3.421459e-02 1 1  ON 35
eH1_6                 9.457226e-02 1 1  ON 36
eH1_7                 1.534339e-01 1 1  ON 37
eH1_8                 1.908075e-01 1 1  ON 38
eH1_9                 8.447480e-02 1 1  ON 39
eH2_0                -2.492924e-01 1 1  ON 40
eH2_1                -1.478951e-01 1 1  ON 41
eH2_2                -1.009597e-01 1 1  ON 42
eH2_3                -4.616931e-02 1 1  ON 43
eH2_4                 2.520326e-03 1 1  ON 44
eH2_5                 3.757426e-02 1 1  ON 45
eH2_6                 9.586089e-02 1 1  ON 46
eH2_7                 1.559351e-01 1 1  ON 47
eH2_8                 1.928298e-01 1 1  ON 48
eH2_9                 7.573531e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9508
    reference variance = 0.559798
====================================================
  Execution time = 2.0065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6990e-01
  Total weights = 2.0000e+06
  Execution time = 1.8971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370037503216
                                         uncertainty =       0.021903435464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370037503216
                                         uncertainty =       0.021903435464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430063230
  error estimate for blocks of size 2^( 2) =       0.000442507249
  error estimate for blocks of size 2^( 3) =       0.000455098547
  error estimate for blocks of size 2^( 4) =       0.000467139367
  error estimate for blocks of size 2^( 5) =       0.000478263770
  error estimate for blocks of size 2^( 6) =       0.000488039330
  error estimate for blocks of size 2^( 7) =       0.000493048740

      target function =                  N/A
              le_mean =     -16.905579491512
             les_mean =     286.168526522127
             stat err =       0.000481622802
             autocorr =       1.254149922321
              std dev =       0.608201252270
             le_variance =       0.369908763263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369977604714
                                         uncertainty =       0.021880972616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369977604714
                                         uncertainty =       0.021880972616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430028339
  error estimate for blocks of size 2^( 2) =       0.000442475387
  error estimate for blocks of size 2^( 3) =       0.000455067966
  error estimate for blocks of size 2^( 4) =       0.000467104471
  error estimate for blocks of size 2^( 5) =       0.000478223815
  error estimate for blocks of size 2^( 6) =       0.000487987443
  error estimate for blocks of size 2^( 7) =       0.000492994781

      target function =                  N/A
              le_mean =     -16.905580265944
             les_mean =     286.168492688568
             stat err =       0.000481577627
             autocorr =       1.254118144945
              std dev =       0.608151909646
             le_variance =       0.369848745206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370031383676
                                         uncertainty =       0.021890227212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370031383676
                                         uncertainty =       0.021890227212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430059528
  error estimate for blocks of size 2^( 2) =       0.000442505628
  error estimate for blocks of size 2^( 3) =       0.000455097580
  error estimate for blocks of size 2^( 4) =       0.000467131922
  error estimate for blocks of size 2^( 5) =       0.000478250195
  error estimate for blocks of size 2^( 6) =       0.000488011620
  error estimate for blocks of size 2^( 7) =       0.000493017176

      target function =                  N/A
              le_mean =     -16.905578029286
             les_mean =     286.168470714048
             stat err =       0.000481602728
             autocorr =       1.254066971498
              std dev =       0.608196016694
             le_variance =       0.369902394723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370037667373
                                         uncertainty =       0.021902142149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370037667373
                                         uncertainty =       0.021902142149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430063282
  error estimate for blocks of size 2^( 2) =       0.000442507807
  error estimate for blocks of size 2^( 3) =       0.000455099251
  error estimate for blocks of size 2^( 4) =       0.000467138744
  error estimate for blocks of size 2^( 5) =       0.000478262063
  error estimate for blocks of size 2^( 6) =       0.000488034069
  error estimate for blocks of size 2^( 7) =       0.000493042658

      target function =                  N/A
              le_mean =     -16.905578587347
             les_mean =     286.168496041417
             stat err =       0.000481619384
             autocorr =       1.254131813605
              std dev =       0.608201326371
             le_variance =       0.369908853400


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905579491512        initial
     3.8147e-02     3.8147e-01             5.4850e-03       -16.905580265944  <--
     1.5259e-01     1.5259e+00             1.3645e-03       -16.905578029286
     6.1035e-01     6.1035e+00             3.4569e-04       -16.905578587347

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 2.9597e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.096588e-01 1 1  ON 0
 uu_1                 1.424740e-01 1 1  ON 1
 uu_2                 4.099755e-02 1 1  ON 2
 uu_3                -2.165941e-02 1 1  ON 3
 uu_4                -6.743022e-02 1 1  ON 4
 uu_5                -1.029159e-01 1 1  ON 5
 uu_6                -1.313088e-01 1 1  ON 6
 uu_7                -1.453625e-01 1 1  ON 7
 uu_8                -1.383577e-01 1 1  ON 8
 uu_9                -1.101200e-01 1 1  ON 9
 ud_0                 4.531929e-01 1 1  ON 10
 ud_1                 1.869576e-01 1 1  ON 11
 ud_2                 6.584373e-02 1 1  ON 12
 ud_3                -6.247598e-03 1 1  ON 13
 ud_4                -6.389099e-02 1 1  ON 14
 ud_5                -1.062123e-01 1 1  ON 15
 ud_6                -1.344446e-01 1 1  ON 16
 ud_7                -1.520070e-01 1 1  ON 17
 ud_8                -1.533463e-01 1 1  ON 18
 ud_9                -1.447602e-01 1 1  ON 19
 eO_0                -7.636138e-01 1 1  ON 20
 eO_1                -4.410241e-01 1 1  ON 21
 eO_2                -1.903314e-02 1 1  ON 22
 eO_3                 3.047294e-01 1 1  ON 23
 eO_4                 5.326579e-01 1 1  ON 24
 eO_5                 4.975386e-01 1 1  ON 25
 eO_6                 2.689803e-01 1 1  ON 26
 eO_7                -3.813769e-02 1 1  ON 27
 eO_8                -2.366973e-01 1 1  ON 28
 eO_9                -1.017513e-01 1 1  ON 29
eH1_0                -2.532126e-01 1 1  ON 30
eH1_1                -1.519557e-01 1 1  ON 31
eH1_2                -1.050123e-01 1 1  ON 32
eH1_3                -4.991413e-02 1 1  ON 33
eH1_4                -1.678411e-03 1 1  ON 34
eH1_5                 3.344154e-02 1 1  ON 35
eH1_6                 9.467340e-02 1 1  ON 36
eH1_7                 1.535663e-01 1 1  ON 37
eH1_8                 1.919657e-01 1 1  ON 38
eH1_9                 8.857981e-02 1 1  ON 39
eH2_0                -2.501203e-01 1 1  ON 40
eH2_1                -1.487970e-01 1 1  ON 41
eH2_2                -1.020422e-01 1 1  ON 42
eH2_3                -4.714526e-02 1 1  ON 43
eH2_4                 1.662897e-03 1 1  ON 44
eH2_5                 3.689517e-02 1 1  ON 45
eH2_6                 9.512088e-02 1 1  ON 46
eH2_7                 1.554328e-01 1 1  ON 47
eH2_8                 1.947038e-01 1 1  ON 48
eH2_9                 7.985579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5601e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.0215
    reference variance = 0.327338
====================================================
  Execution time = 2.0231e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4604e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973354217
                                         uncertainty =       0.003372893190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973354217
                                         uncertainty =       0.003372893190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415959779
  error estimate for blocks of size 2^( 2) =       0.000428847016
  error estimate for blocks of size 2^( 3) =       0.000441898870
  error estimate for blocks of size 2^( 4) =       0.000453530922
  error estimate for blocks of size 2^( 5) =       0.000464615533
  error estimate for blocks of size 2^( 6) =       0.000470428798
  error estimate for blocks of size 2^( 7) =       0.000474508906

      target function =                  N/A
              le_mean =     -16.907305709603
             les_mean =     286.203031260580
             stat err =       0.000465771040
             autocorr =       1.253840477741
              std dev =       0.588255960976
             le_variance =       0.346045075624


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690730570960e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907305709603       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907308533328       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907309740383       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907308638336       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907309049744       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907312428614       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907313947690       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907320590228       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907319905429       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907321875367       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907323956275       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907315007298       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.907316848387       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907319125943       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907319890991       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907319507377       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907320138992       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907321246762       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907320971299       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907321869800       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907322148568       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 2.036001e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907305709603       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907308230712       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907309227171       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907308536691       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907308678855       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907311036984       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907311036357       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907314102630       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907313632545       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907315410029       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907313879436       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907311743661       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.907312098463       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907312573205       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 5.244950e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907305709603       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907307474251       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907308069382       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907307912467       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907308007495       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907308683865       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907307690600       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907308925848       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907309209598       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907308967759       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907308887706       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.319776e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108872 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5817e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.094402e-01 1 1  ON 0
 uu_1                 1.429090e-01 1 1  ON 1
 uu_2                 4.124393e-02 1 1  ON 2
 uu_3                -2.146513e-02 1 1  ON 3
 uu_4                -6.729249e-02 1 1  ON 4
 uu_5                -1.025788e-01 1 1  ON 5
 uu_6                -1.311276e-01 1 1  ON 6
 uu_7                -1.461469e-01 1 1  ON 7
 uu_8                -1.393242e-01 1 1  ON 8
 uu_9                -1.111574e-01 1 1  ON 9
 ud_0                 4.543105e-01 1 1  ON 10
 ud_1                 1.880814e-01 1 1  ON 11
 ud_2                 6.677978e-02 1 1  ON 12
 ud_3                -5.387989e-03 1 1  ON 13
 ud_4                -6.322599e-02 1 1  ON 14
 ud_5                -1.052135e-01 1 1  ON 15
 ud_6                -1.336896e-01 1 1  ON 16
 ud_7                -1.511765e-01 1 1  ON 17
 ud_8                -1.543416e-01 1 1  ON 18
 ud_9                -1.471406e-01 1 1  ON 19
 eO_0                -7.639875e-01 1 1  ON 20
 eO_1                -4.412098e-01 1 1  ON 21
 eO_2                -1.837727e-02 1 1  ON 22
 eO_3                 3.062981e-01 1 1  ON 23
 eO_4                 5.343071e-01 1 1  ON 24
 eO_5                 4.989916e-01 1 1  ON 25
 eO_6                 2.698059e-01 1 1  ON 26
 eO_7                -3.744136e-02 1 1  ON 27
 eO_8                -2.385244e-01 1 1  ON 28
 eO_9                -1.054230e-01 1 1  ON 29
eH1_0                -2.539572e-01 1 1  ON 30
eH1_1                -1.528742e-01 1 1  ON 31
eH1_2                -1.057772e-01 1 1  ON 32
eH1_3                -5.109681e-02 1 1  ON 33
eH1_4                -2.541839e-03 1 1  ON 34
eH1_5                 3.221086e-02 1 1  ON 35
eH1_6                 9.428792e-02 1 1  ON 36
eH1_7                 1.547021e-01 1 1  ON 37
eH1_8                 1.931461e-01 1 1  ON 38
eH1_9                 9.187939e-02 1 1  ON 39
eH2_0                -2.513968e-01 1 1  ON 40
eH2_1                -1.501512e-01 1 1  ON 41
eH2_2                -1.029837e-01 1 1  ON 42
eH2_3                -4.854606e-02 1 1  ON 43
eH2_4                -1.679510e-04 1 1  ON 44
eH2_5                 3.456164e-02 1 1  ON 45
eH2_6                 9.518364e-02 1 1  ON 46
eH2_7                 1.558128e-01 1 1  ON 47
eH2_8                 1.961846e-01 1 1  ON 48
eH2_9                 8.510074e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9196
    reference variance = 0.445881
====================================================
  Execution time = 1.9900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3614e-01
  Total weights = 2.0000e+06
  Execution time = 1.8934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336169148994
                                         uncertainty =       0.003231510076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336169148994
                                         uncertainty =       0.003231510076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409968352
  error estimate for blocks of size 2^( 2) =       0.000422478548
  error estimate for blocks of size 2^( 3) =       0.000435691720
  error estimate for blocks of size 2^( 4) =       0.000447573911
  error estimate for blocks of size 2^( 5) =       0.000457502677
  error estimate for blocks of size 2^( 6) =       0.000464148646
  error estimate for blocks of size 2^( 7) =       0.000467733150

      target function =                  N/A
              le_mean =     -16.905851991219
             les_mean =     286.143979480205
             stat err =       0.000459239596
             autocorr =       1.254810050077
              std dev =       0.579782803550
             le_variance =       0.336148099292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341093047
                                         uncertainty =       0.003232915336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341093047
                                         uncertainty =       0.003232915336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410073270
  error estimate for blocks of size 2^( 2) =       0.000422568190
  error estimate for blocks of size 2^( 3) =       0.000435759978
  error estimate for blocks of size 2^( 4) =       0.000447614035
  error estimate for blocks of size 2^( 5) =       0.000457521198
  error estimate for blocks of size 2^( 6) =       0.000464148450
  error estimate for blocks of size 2^( 7) =       0.000467723142

      target function =                  N/A
              le_mean =     -16.905853169616
             les_mean =     286.144191398741
             stat err =       0.000459251706
             autocorr =       1.254234183146
              std dev =       0.579931180645
             le_variance =       0.336320174284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167977975
                                         uncertainty =       0.003232467306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167977975
                                         uncertainty =       0.003232467306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409967804
  error estimate for blocks of size 2^( 2) =       0.000422464132
  error estimate for blocks of size 2^( 3) =       0.000435664847
  error estimate for blocks of size 2^( 4) =       0.000447526465
  error estimate for blocks of size 2^( 5) =       0.000457455396
  error estimate for blocks of size 2^( 6) =       0.000464091394
  error estimate for blocks of size 2^( 7) =       0.000467668454

      target function =                  N/A
              le_mean =     -16.905856385493
             les_mean =     286.144127159962
             stat err =       0.000459185427
             autocorr =       1.254517401585
              std dev =       0.579782028967
             le_variance =       0.336147201113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336104736575
                                         uncertainty =       0.003231545918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336104736575
                                         uncertainty =       0.003231545918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409929115
  error estimate for blocks of size 2^( 2) =       0.000422436444
  error estimate for blocks of size 2^( 3) =       0.000435648904
  error estimate for blocks of size 2^( 4) =       0.000447528603
  error estimate for blocks of size 2^( 5) =       0.000457462035
  error estimate for blocks of size 2^( 6) =       0.000464106258
  error estimate for blocks of size 2^( 7) =       0.000467688613

      target function =                  N/A
              le_mean =     -16.905852098239
             les_mean =     286.143918757853
             stat err =       0.000459196377
             autocorr =       1.254814060408
              std dev =       0.579727313794
             le_variance =       0.336083758359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905851991219        initial
     9.5367e-03     9.5367e-02             2.0360e-02       -16.905853169616
     3.8147e-02     3.8147e-01             5.2449e-03       -16.905856385493  <--
     1.5259e-01     1.5259e+00             1.3198e-03       -16.905852098239

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 2.9431e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.094402e-01 1 1  ON 0
 uu_1                 1.429090e-01 1 1  ON 1
 uu_2                 4.124393e-02 1 1  ON 2
 uu_3                -2.146513e-02 1 1  ON 3
 uu_4                -6.729249e-02 1 1  ON 4
 uu_5                -1.025788e-01 1 1  ON 5
 uu_6                -1.311276e-01 1 1  ON 6
 uu_7                -1.461469e-01 1 1  ON 7
 uu_8                -1.393242e-01 1 1  ON 8
 uu_9                -1.111574e-01 1 1  ON 9
 ud_0                 4.543105e-01 1 1  ON 10
 ud_1                 1.880814e-01 1 1  ON 11
 ud_2                 6.677978e-02 1 1  ON 12
 ud_3                -5.387989e-03 1 1  ON 13
 ud_4                -6.322599e-02 1 1  ON 14
 ud_5                -1.052135e-01 1 1  ON 15
 ud_6                -1.336896e-01 1 1  ON 16
 ud_7                -1.511765e-01 1 1  ON 17
 ud_8                -1.543416e-01 1 1  ON 18
 ud_9                -1.471406e-01 1 1  ON 19
 eO_0                -7.639875e-01 1 1  ON 20
 eO_1                -4.412098e-01 1 1  ON 21
 eO_2                -1.837727e-02 1 1  ON 22
 eO_3                 3.062981e-01 1 1  ON 23
 eO_4                 5.343071e-01 1 1  ON 24
 eO_5                 4.989916e-01 1 1  ON 25
 eO_6                 2.698059e-01 1 1  ON 26
 eO_7                -3.744136e-02 1 1  ON 27
 eO_8                -2.385244e-01 1 1  ON 28
 eO_9                -1.054230e-01 1 1  ON 29
eH1_0                -2.539572e-01 1 1  ON 30
eH1_1                -1.528742e-01 1 1  ON 31
eH1_2                -1.057772e-01 1 1  ON 32
eH1_3                -5.109681e-02 1 1  ON 33
eH1_4                -2.541839e-03 1 1  ON 34
eH1_5                 3.221086e-02 1 1  ON 35
eH1_6                 9.428792e-02 1 1  ON 36
eH1_7                 1.547021e-01 1 1  ON 37
eH1_8                 1.931461e-01 1 1  ON 38
eH1_9                 9.187939e-02 1 1  ON 39
eH2_0                -2.513968e-01 1 1  ON 40
eH2_1                -1.501512e-01 1 1  ON 41
eH2_2                -1.029837e-01 1 1  ON 42
eH2_3                -4.854606e-02 1 1  ON 43
eH2_4                -1.679510e-04 1 1  ON 44
eH2_5                 3.456164e-02 1 1  ON 45
eH2_6                 9.518364e-02 1 1  ON 46
eH2_7                 1.558128e-01 1 1  ON 47
eH2_8                 1.961846e-01 1 1  ON 48
eH2_9                 8.510074e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5255e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8205
    reference variance = 0.193245
====================================================
  Execution time = 2.0707e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3572e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335769811981
                                         uncertainty =       0.002631549286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335769811981
                                         uncertainty =       0.002631549286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409705505
  error estimate for blocks of size 2^( 2) =       0.000423039023
  error estimate for blocks of size 2^( 3) =       0.000435959630
  error estimate for blocks of size 2^( 4) =       0.000448685168
  error estimate for blocks of size 2^( 5) =       0.000459793149
  error estimate for blocks of size 2^( 6) =       0.000465962346
  error estimate for blocks of size 2^( 7) =       0.000472587898

      target function =                  N/A
              le_mean =     -16.906891602935
             les_mean =     286.178700706441
             stat err =       0.000461757140
             autocorr =       1.270233731685
              std dev =       0.579411081106
             le_variance =       0.335717200909


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690689160293e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906891602935       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906895926983       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906897716831       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906901172406       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906902376476       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906901426566       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906901087095       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906902032948       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906908754997       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906912588745       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906912675709       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906912570293       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906914530100       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906916848895       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906916559472       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906915611738       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906915580574       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906916863994       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906916729434       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906916603315       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 2.415446e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906891602935       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906895381028       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906896946731       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906899483377       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906900169300       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906898959159       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906898828420       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906899448024       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906901966114       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906902709873       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906902317419       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906901996082       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906902202940       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906902610732       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 6.032937e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906891602935       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906894113227       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906895279190       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906896392938       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906896543943       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906895992596       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906895908632       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906896321249       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906896487934       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906896677609       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906896633703       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.509410e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117218 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6362e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.090514e-01 1 1  ON 0
 uu_1                 1.419241e-01 1 1  ON 1
 uu_2                 4.013017e-02 1 1  ON 2
 uu_3                -2.222840e-02 1 1  ON 3
 uu_4                -6.812906e-02 1 1  ON 4
 uu_5                -1.034310e-01 1 1  ON 5
 uu_6                -1.318390e-01 1 1  ON 6
 uu_7                -1.459025e-01 1 1  ON 7
 uu_8                -1.384643e-01 1 1  ON 8
 uu_9                -1.117466e-01 1 1  ON 9
 ud_0                 4.543549e-01 1 1  ON 10
 ud_1                 1.883080e-01 1 1  ON 11
 ud_2                 6.705825e-02 1 1  ON 12
 ud_3                -5.186017e-03 1 1  ON 13
 ud_4                -6.289122e-02 1 1  ON 14
 ud_5                -1.051329e-01 1 1  ON 15
 ud_6                -1.339622e-01 1 1  ON 16
 ud_7                -1.516976e-01 1 1  ON 17
 ud_8                -1.546956e-01 1 1  ON 18
 ud_9                -1.464730e-01 1 1  ON 19
 eO_0                -7.638144e-01 1 1  ON 20
 eO_1                -4.405425e-01 1 1  ON 21
 eO_2                -1.758001e-02 1 1  ON 22
 eO_3                 3.069912e-01 1 1  ON 23
 eO_4                 5.350968e-01 1 1  ON 24
 eO_5                 4.998752e-01 1 1  ON 25
 eO_6                 2.712447e-01 1 1  ON 26
 eO_7                -3.734227e-02 1 1  ON 27
 eO_8                -2.406742e-01 1 1  ON 28
 eO_9                -1.083660e-01 1 1  ON 29
eH1_0                -2.556833e-01 1 1  ON 30
eH1_1                -1.551220e-01 1 1  ON 31
eH1_2                -1.078258e-01 1 1  ON 32
eH1_3                -5.337337e-02 1 1  ON 33
eH1_4                -4.144836e-03 1 1  ON 34
eH1_5                 3.095577e-02 1 1  ON 35
eH1_6                 9.278589e-02 1 1  ON 36
eH1_7                 1.563690e-01 1 1  ON 37
eH1_8                 1.964733e-01 1 1  ON 38
eH1_9                 9.791233e-02 1 1  ON 39
eH2_0                -2.526588e-01 1 1  ON 40
eH2_1                -1.510983e-01 1 1  ON 41
eH2_2                -1.035743e-01 1 1  ON 42
eH2_3                -4.918295e-02 1 1  ON 43
eH2_4                -9.079177e-04 1 1  ON 44
eH2_5                 3.403161e-02 1 1  ON 45
eH2_6                 9.457634e-02 1 1  ON 46
eH2_7                 1.552552e-01 1 1  ON 47
eH2_8                 1.973443e-01 1 1  ON 48
eH2_9                 8.910891e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8389
    reference variance = 0.19601
====================================================
  Execution time = 2.0218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4891e-01
  Total weights = 2.0000e+06
  Execution time = 1.8993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349006555283
                                         uncertainty =       0.004258035997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349006555283
                                         uncertainty =       0.004258035997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417703789
  error estimate for blocks of size 2^( 2) =       0.000430307276
  error estimate for blocks of size 2^( 3) =       0.000442894735
  error estimate for blocks of size 2^( 4) =       0.000453401784
  error estimate for blocks of size 2^( 5) =       0.000463072862
  error estimate for blocks of size 2^( 6) =       0.000470410266
  error estimate for blocks of size 2^( 7) =       0.000471723324

      target function =                  N/A
              le_mean =     -16.906106312117
             les_mean =     286.165383372889
             stat err =       0.000464652059
             autocorr =       1.237425046810
              std dev =       0.590722363515
             le_variance =       0.348952910757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349115456948
                                         uncertainty =       0.004259609844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349115456948
                                         uncertainty =       0.004259609844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417769045
  error estimate for blocks of size 2^( 2) =       0.000430386420
  error estimate for blocks of size 2^( 3) =       0.000442986638
  error estimate for blocks of size 2^( 4) =       0.000453483187
  error estimate for blocks of size 2^( 5) =       0.000463144781
  error estimate for blocks of size 2^( 6) =       0.000470454781
  error estimate for blocks of size 2^( 7) =       0.000471716075

      target function =                  N/A
              le_mean =     -16.906098127358
             les_mean =     286.165215667479
             stat err =       0.000464699706
             autocorr =       1.237292214661
              std dev =       0.590814649589
             le_variance =       0.349061950169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348945495561
                                         uncertainty =       0.004257791773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348945495561
                                         uncertainty =       0.004257791773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417667346
  error estimate for blocks of size 2^( 2) =       0.000430297998
  error estimate for blocks of size 2^( 3) =       0.000442918851
  error estimate for blocks of size 2^( 4) =       0.000453431233
  error estimate for blocks of size 2^( 5) =       0.000463108317
  error estimate for blocks of size 2^( 6) =       0.000470429820
  error estimate for blocks of size 2^( 7) =       0.000471697345

      target function =                  N/A
              le_mean =     -16.906097407451
             les_mean =     286.165021399563
             stat err =       0.000464666679
             autocorr =       1.237718879836
              std dev =       0.590670825225
             le_variance =       0.348892023772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348956226857
                                         uncertainty =       0.004257337231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348956226857
                                         uncertainty =       0.004257337231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417673696
  error estimate for blocks of size 2^( 2) =       0.000430284893
  error estimate for blocks of size 2^( 3) =       0.000442882608
  error estimate for blocks of size 2^( 4) =       0.000453391214
  error estimate for blocks of size 2^( 5) =       0.000463065766
  error estimate for blocks of size 2^( 6) =       0.000470402411
  error estimate for blocks of size 2^( 7) =       0.000471701449

      target function =                  N/A
              le_mean =     -16.906102854638
             les_mean =     286.165216190510
             stat err =       0.000464640210
             autocorr =       1.237540242099
              std dev =       0.590679806112
             le_variance =       0.348902633349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906106312117        initial  <--
     9.5367e-03     9.5367e-02             2.4154e-02       -16.906098127358
     3.8147e-02     3.8147e-01             6.0329e-03       -16.906097407451
     1.5259e-01     1.5259e+00             1.5094e-03       -16.906102854638

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7614
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.094402e-01 1 1  ON 0
 uu_1                 1.429090e-01 1 1  ON 1
 uu_2                 4.124393e-02 1 1  ON 2
 uu_3                -2.146513e-02 1 1  ON 3
 uu_4                -6.729249e-02 1 1  ON 4
 uu_5                -1.025788e-01 1 1  ON 5
 uu_6                -1.311276e-01 1 1  ON 6
 uu_7                -1.461469e-01 1 1  ON 7
 uu_8                -1.393242e-01 1 1  ON 8
 uu_9                -1.111574e-01 1 1  ON 9
 ud_0                 4.543105e-01 1 1  ON 10
 ud_1                 1.880814e-01 1 1  ON 11
 ud_2                 6.677978e-02 1 1  ON 12
 ud_3                -5.387989e-03 1 1  ON 13
 ud_4                -6.322599e-02 1 1  ON 14
 ud_5                -1.052135e-01 1 1  ON 15
 ud_6                -1.336896e-01 1 1  ON 16
 ud_7                -1.511765e-01 1 1  ON 17
 ud_8                -1.543416e-01 1 1  ON 18
 ud_9                -1.471406e-01 1 1  ON 19
 eO_0                -7.639875e-01 1 1  ON 20
 eO_1                -4.412098e-01 1 1  ON 21
 eO_2                -1.837727e-02 1 1  ON 22
 eO_3                 3.062981e-01 1 1  ON 23
 eO_4                 5.343071e-01 1 1  ON 24
 eO_5                 4.989916e-01 1 1  ON 25
 eO_6                 2.698059e-01 1 1  ON 26
 eO_7                -3.744136e-02 1 1  ON 27
 eO_8                -2.385244e-01 1 1  ON 28
 eO_9                -1.054230e-01 1 1  ON 29
eH1_0                -2.539572e-01 1 1  ON 30
eH1_1                -1.528742e-01 1 1  ON 31
eH1_2                -1.057772e-01 1 1  ON 32
eH1_3                -5.109681e-02 1 1  ON 33
eH1_4                -2.541839e-03 1 1  ON 34
eH1_5                 3.221086e-02 1 1  ON 35
eH1_6                 9.428792e-02 1 1  ON 36
eH1_7                 1.547021e-01 1 1  ON 37
eH1_8                 1.931461e-01 1 1  ON 38
eH1_9                 9.187939e-02 1 1  ON 39
eH2_0                -2.513968e-01 1 1  ON 40
eH2_1                -1.501512e-01 1 1  ON 41
eH2_2                -1.029837e-01 1 1  ON 42
eH2_3                -4.854606e-02 1 1  ON 43
eH2_4                -1.679510e-04 1 1  ON 44
eH2_5                 3.456164e-02 1 1  ON 45
eH2_6                 9.518364e-02 1 1  ON 46
eH2_7                 1.558128e-01 1 1  ON 47
eH2_8                 1.961846e-01 1 1  ON 48
eH2_9                 8.510074e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6131e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9557
    reference variance = 0.241098
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3694e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336976649395
                                         uncertainty =       0.002514546727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336976649395
                                         uncertainty =       0.002514546727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410449420
  error estimate for blocks of size 2^( 2) =       0.000423380685
  error estimate for blocks of size 2^( 3) =       0.000436547582
  error estimate for blocks of size 2^( 4) =       0.000449401719
  error estimate for blocks of size 2^( 5) =       0.000461519338
  error estimate for blocks of size 2^( 6) =       0.000470492465
  error estimate for blocks of size 2^( 7) =       0.000475851362

      target function =                  N/A
              le_mean =     -16.905727822895
             les_mean =     286.140570506509
             stat err =       0.000464316221
             autocorr =       1.279700734650
              std dev =       0.580463136799
             le_variance =       0.336937453183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572782289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905727822895       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905729873804       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905732437439       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905731143249       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905729135942       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905730345889       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905732629861       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905734571401       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905733216253       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905732826368       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905732276155       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905732631226       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905733025142       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.258419e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905727822895       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905728678096       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905730044086       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905729170422       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905728610446       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905728940353       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905730083936       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905730092027       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905730015561       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.390011e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905727822895       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905728079553       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905728560323       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905728189742       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905728239519       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905728251058       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905728492210       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905728505150       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.342281e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5930e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.097706e-01 1 1  ON 0
 uu_1                 1.428470e-01 1 1  ON 1
 uu_2                 4.105487e-02 1 1  ON 2
 uu_3                -2.171183e-02 1 1  ON 3
 uu_4                -6.741253e-02 1 1  ON 4
 uu_5                -1.028697e-01 1 1  ON 5
 uu_6                -1.311988e-01 1 1  ON 6
 uu_7                -1.463415e-01 1 1  ON 7
 uu_8                -1.391368e-01 1 1  ON 8
 uu_9                -1.109714e-01 1 1  ON 9
 ud_0                 4.543669e-01 1 1  ON 10
 ud_1                 1.879307e-01 1 1  ON 11
 ud_2                 6.664052e-02 1 1  ON 12
 ud_3                -5.569519e-03 1 1  ON 13
 ud_4                -6.335616e-02 1 1  ON 14
 ud_5                -1.052662e-01 1 1  ON 15
 ud_6                -1.338064e-01 1 1  ON 16
 ud_7                -1.512453e-01 1 1  ON 17
 ud_8                -1.540415e-01 1 1  ON 18
 ud_9                -1.467769e-01 1 1  ON 19
 eO_0                -7.640516e-01 1 1  ON 20
 eO_1                -4.412873e-01 1 1  ON 21
 eO_2                -1.806249e-02 1 1  ON 22
 eO_3                 3.063445e-01 1 1  ON 23
 eO_4                 5.344196e-01 1 1  ON 24
 eO_5                 4.989859e-01 1 1  ON 25
 eO_6                 2.696801e-01 1 1  ON 26
 eO_7                -3.738426e-02 1 1  ON 27
 eO_8                -2.385355e-01 1 1  ON 28
 eO_9                -1.056598e-01 1 1  ON 29
eH1_0                -2.540531e-01 1 1  ON 30
eH1_1                -1.530847e-01 1 1  ON 31
eH1_2                -1.059803e-01 1 1  ON 32
eH1_3                -5.120833e-02 1 1  ON 33
eH1_4                -2.672352e-03 1 1  ON 34
eH1_5                 3.201979e-02 1 1  ON 35
eH1_6                 9.413389e-02 1 1  ON 36
eH1_7                 1.547422e-01 1 1  ON 37
eH1_8                 1.935650e-01 1 1  ON 38
eH1_9                 9.241268e-02 1 1  ON 39
eH2_0                -2.516513e-01 1 1  ON 40
eH2_1                -1.504903e-01 1 1  ON 41
eH2_2                -1.031234e-01 1 1  ON 42
eH2_3                -4.868868e-02 1 1  ON 43
eH2_4                -1.552660e-04 1 1  ON 44
eH2_5                 3.431860e-02 1 1  ON 45
eH2_6                 9.523754e-02 1 1  ON 46
eH2_7                 1.559457e-01 1 1  ON 47
eH2_8                 1.964397e-01 1 1  ON 48
eH2_9                 8.563974e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8595
    reference variance = 0.27198
====================================================
  Execution time = 2.2488e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3538e-01
  Total weights = 2.0000e+06
  Execution time = 1.9033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334924983392
                                         uncertainty =       0.003269289360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334924983392
                                         uncertainty =       0.003269289360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409305053
  error estimate for blocks of size 2^( 2) =       0.000422135054
  error estimate for blocks of size 2^( 3) =       0.000435552391
  error estimate for blocks of size 2^( 4) =       0.000447591500
  error estimate for blocks of size 2^( 5) =       0.000457496955
  error estimate for blocks of size 2^( 6) =       0.000464817518
  error estimate for blocks of size 2^( 7) =       0.000470120288

      target function =                  N/A
              le_mean =     -16.905921421427
             les_mean =     286.145240193249
             stat err =       0.000460006565
             autocorr =       1.263088690998
              std dev =       0.578844757535
             le_variance =       0.335061253326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335493822233
                                         uncertainty =       0.003274391041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335493822233
                                         uncertainty =       0.003274391041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409652155
  error estimate for blocks of size 2^( 2) =       0.000422472739
  error estimate for blocks of size 2^( 3) =       0.000435881008
  error estimate for blocks of size 2^( 4) =       0.000447906797
  error estimate for blocks of size 2^( 5) =       0.000457798984
  error estimate for blocks of size 2^( 6) =       0.000465098890
  error estimate for blocks of size 2^( 7) =       0.000470388243

      target function =                  N/A
              le_mean =     -16.905918379236
             les_mean =     286.145705854573
             stat err =       0.000460298229
             autocorr =       1.262548639904
              std dev =       0.579335634153
             le_variance =       0.335629777000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335577044647
                                         uncertainty =       0.003275833384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335577044647
                                         uncertainty =       0.003275833384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409702849
  error estimate for blocks of size 2^( 2) =       0.000422519371
  error estimate for blocks of size 2^( 3) =       0.000435924354
  error estimate for blocks of size 2^( 4) =       0.000447947078
  error estimate for blocks of size 2^( 5) =       0.000457841240
  error estimate for blocks of size 2^( 6) =       0.000465144006
  error estimate for blocks of size 2^( 7) =       0.000470431543

      target function =                  N/A
              le_mean =     -16.905918068404
             les_mean =     286.145778416080
             stat err =       0.000460340967
             autocorr =       1.262470630021
              std dev =       0.579407325085
             le_variance =       0.335712848362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335052341660
                                         uncertainty =       0.003270757844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335052341660
                                         uncertainty =       0.003270757844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409382782
  error estimate for blocks of size 2^( 2) =       0.000422209843
  error estimate for blocks of size 2^( 3) =       0.000435624572
  error estimate for blocks of size 2^( 4) =       0.000447660465
  error estimate for blocks of size 2^( 5) =       0.000457564010
  error estimate for blocks of size 2^( 6) =       0.000464881758
  error estimate for blocks of size 2^( 7) =       0.000470181179

      target function =                  N/A
              le_mean =     -16.905920635078
             les_mean =     286.145340876670
             stat err =       0.000460071853
             autocorr =       1.262967521343
              std dev =       0.578954682762
             le_variance =       0.335188524692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905921421427        initial  <--
     9.5367e-02     9.5367e-01             2.2584e-03       -16.905918379236
     3.8147e-01     3.8147e+00             5.3900e-04       -16.905918068404
     1.5259e+00     1.5259e+01             1.3423e-04       -16.905920635078

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0535
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.094402e-01 1 1  ON 0
 uu_1                 1.429090e-01 1 1  ON 1
 uu_2                 4.124393e-02 1 1  ON 2
 uu_3                -2.146513e-02 1 1  ON 3
 uu_4                -6.729249e-02 1 1  ON 4
 uu_5                -1.025788e-01 1 1  ON 5
 uu_6                -1.311276e-01 1 1  ON 6
 uu_7                -1.461469e-01 1 1  ON 7
 uu_8                -1.393242e-01 1 1  ON 8
 uu_9                -1.111574e-01 1 1  ON 9
 ud_0                 4.543105e-01 1 1  ON 10
 ud_1                 1.880814e-01 1 1  ON 11
 ud_2                 6.677978e-02 1 1  ON 12
 ud_3                -5.387989e-03 1 1  ON 13
 ud_4                -6.322599e-02 1 1  ON 14
 ud_5                -1.052135e-01 1 1  ON 15
 ud_6                -1.336896e-01 1 1  ON 16
 ud_7                -1.511765e-01 1 1  ON 17
 ud_8                -1.543416e-01 1 1  ON 18
 ud_9                -1.471406e-01 1 1  ON 19
 eO_0                -7.639875e-01 1 1  ON 20
 eO_1                -4.412098e-01 1 1  ON 21
 eO_2                -1.837727e-02 1 1  ON 22
 eO_3                 3.062981e-01 1 1  ON 23
 eO_4                 5.343071e-01 1 1  ON 24
 eO_5                 4.989916e-01 1 1  ON 25
 eO_6                 2.698059e-01 1 1  ON 26
 eO_7                -3.744136e-02 1 1  ON 27
 eO_8                -2.385244e-01 1 1  ON 28
 eO_9                -1.054230e-01 1 1  ON 29
eH1_0                -2.539572e-01 1 1  ON 30
eH1_1                -1.528742e-01 1 1  ON 31
eH1_2                -1.057772e-01 1 1  ON 32
eH1_3                -5.109681e-02 1 1  ON 33
eH1_4                -2.541839e-03 1 1  ON 34
eH1_5                 3.221086e-02 1 1  ON 35
eH1_6                 9.428792e-02 1 1  ON 36
eH1_7                 1.547021e-01 1 1  ON 37
eH1_8                 1.931461e-01 1 1  ON 38
eH1_9                 9.187939e-02 1 1  ON 39
eH2_0                -2.513968e-01 1 1  ON 40
eH2_1                -1.501512e-01 1 1  ON 41
eH2_2                -1.029837e-01 1 1  ON 42
eH2_3                -4.854606e-02 1 1  ON 43
eH2_4                -1.679510e-04 1 1  ON 44
eH2_5                 3.456164e-02 1 1  ON 45
eH2_6                 9.518364e-02 1 1  ON 46
eH2_7                 1.558128e-01 1 1  ON 47
eH2_8                 1.961846e-01 1 1  ON 48
eH2_9                 8.510074e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7991e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9069
    reference variance = 0.297387
====================================================
  Execution time = 2.0472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6747e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367529301118
                                         uncertainty =       0.029773283708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367529301118
                                         uncertainty =       0.029773283708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428641732
  error estimate for blocks of size 2^( 2) =       0.000440918948
  error estimate for blocks of size 2^( 3) =       0.000453366990
  error estimate for blocks of size 2^( 4) =       0.000464655597
  error estimate for blocks of size 2^( 5) =       0.000476251098
  error estimate for blocks of size 2^( 6) =       0.000481497796
  error estimate for blocks of size 2^( 7) =       0.000485436446

      target function =                  N/A
              le_mean =     -16.905909804324
             les_mean =     286.177253597138
             stat err =       0.000476960234
             autocorr =       1.238156213236
              std dev =       0.606190950876
             le_variance =       0.367467468924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590980432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905909804324       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905910101833       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905910317653       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905910735694       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905910984872       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905911178865       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905911326733       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905911219358       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.289633e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905909804324       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905909891950       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905909952743       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905910063745       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905910128217       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905910161030       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905910201964       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905910183154       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.846831e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905909804324       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905909827252       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905909843040       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905909871204       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905909887489       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905909894065       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905909904232       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905909900228       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.469795e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6090e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.094405e-01 1 1  ON 0
 uu_1                 1.428978e-01 1 1  ON 1
 uu_2                 4.124336e-02 1 1  ON 2
 uu_3                -2.147345e-02 1 1  ON 3
 uu_4                -6.730266e-02 1 1  ON 4
 uu_5                -1.025870e-01 1 1  ON 5
 uu_6                -1.311327e-01 1 1  ON 6
 uu_7                -1.461671e-01 1 1  ON 7
 uu_8                -1.393007e-01 1 1  ON 8
 uu_9                -1.111475e-01 1 1  ON 9
 ud_0                 4.543371e-01 1 1  ON 10
 ud_1                 1.880581e-01 1 1  ON 11
 ud_2                 6.678592e-02 1 1  ON 12
 ud_3                -5.415445e-03 1 1  ON 13
 ud_4                -6.320870e-02 1 1  ON 14
 ud_5                -1.052370e-01 1 1  ON 15
 ud_6                -1.336948e-01 1 1  ON 16
 ud_7                -1.512161e-01 1 1  ON 17
 ud_8                -1.543038e-01 1 1  ON 18
 ud_9                -1.470989e-01 1 1  ON 19
 eO_0                -7.639982e-01 1 1  ON 20
 eO_1                -4.412175e-01 1 1  ON 21
 eO_2                -1.833117e-02 1 1  ON 22
 eO_3                 3.062917e-01 1 1  ON 23
 eO_4                 5.343167e-01 1 1  ON 24
 eO_5                 4.989859e-01 1 1  ON 25
 eO_6                 2.698238e-01 1 1  ON 26
 eO_7                -3.744814e-02 1 1  ON 27
 eO_8                -2.385285e-01 1 1  ON 28
 eO_9                -1.054493e-01 1 1  ON 29
eH1_0                -2.539968e-01 1 1  ON 30
eH1_1                -1.529168e-01 1 1  ON 31
eH1_2                -1.057681e-01 1 1  ON 32
eH1_3                -5.109840e-02 1 1  ON 33
eH1_4                -2.538216e-03 1 1  ON 34
eH1_5                 3.220167e-02 1 1  ON 35
eH1_6                 9.427855e-02 1 1  ON 36
eH1_7                 1.547000e-01 1 1  ON 37
eH1_8                 1.931680e-01 1 1  ON 38
eH1_9                 9.193786e-02 1 1  ON 39
eH2_0                -2.513892e-01 1 1  ON 40
eH2_1                -1.501688e-01 1 1  ON 41
eH2_2                -1.030091e-01 1 1  ON 42
eH2_3                -4.855594e-02 1 1  ON 43
eH2_4                -1.825679e-04 1 1  ON 44
eH2_5                 3.456574e-02 1 1  ON 45
eH2_6                 9.517175e-02 1 1  ON 46
eH2_7                 1.558073e-01 1 1  ON 47
eH2_8                 1.961963e-01 1 1  ON 48
eH2_9                 8.515222e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8892
    reference variance = 0.178276
====================================================
  Execution time = 1.9958e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3951e-01
  Total weights = 2.0000e+06
  Execution time = 1.9084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339567906764
                                         uncertainty =       0.004028696970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339567906764
                                         uncertainty =       0.004028696970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411996942
  error estimate for blocks of size 2^( 2) =       0.000424920288
  error estimate for blocks of size 2^( 3) =       0.000438647231
  error estimate for blocks of size 2^( 4) =       0.000451119913
  error estimate for blocks of size 2^( 5) =       0.000461888506
  error estimate for blocks of size 2^( 6) =       0.000471108882
  error estimate for blocks of size 2^( 7) =       0.000476937829

      target function =                  N/A
              le_mean =     -16.905662106398
             les_mean =     286.140894047188
             stat err =       0.000465263783
             autocorr =       1.275294562828
              std dev =       0.582651663709
             le_variance =       0.339482961223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339638867927
                                         uncertainty =       0.004029170531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339638867927
                                         uncertainty =       0.004029170531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412039972
  error estimate for blocks of size 2^( 2) =       0.000424961726
  error estimate for blocks of size 2^( 3) =       0.000438687920
  error estimate for blocks of size 2^( 4) =       0.000451158498
  error estimate for blocks of size 2^( 5) =       0.000461924119
  error estimate for blocks of size 2^( 6) =       0.000471141687
  error estimate for blocks of size 2^( 7) =       0.000476969870

      target function =                  N/A
              le_mean =     -16.905662375971
             les_mean =     286.140974076881
             stat err =       0.000465298543
             autocorr =       1.275218747639
              std dev =       0.582712516025
             le_variance =       0.339553876333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339613053061
                                         uncertainty =       0.004029014650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339613053061
                                         uncertainty =       0.004029014650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412024319
  error estimate for blocks of size 2^( 2) =       0.000424946595
  error estimate for blocks of size 2^( 3) =       0.000438673055
  error estimate for blocks of size 2^( 4) =       0.000451144303
  error estimate for blocks of size 2^( 5) =       0.000461911054
  error estimate for blocks of size 2^( 6) =       0.000471129746
  error estimate for blocks of size 2^( 7) =       0.000476958604

      target function =                  N/A
              le_mean =     -16.905662233032
             les_mean =     286.140943446792
             stat err =       0.000465285927
             autocorr =       1.275246477410
              std dev =       0.582690380222
             le_variance =       0.339528079204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339573892988
                                         uncertainty =       0.004028740048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339573892988
                                         uncertainty =       0.004028740048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412000573
  error estimate for blocks of size 2^( 2) =       0.000424923774
  error estimate for blocks of size 2^( 3) =       0.000438650655
  error estimate for blocks of size 2^( 4) =       0.000451123139
  error estimate for blocks of size 2^( 5) =       0.000461891484
  error estimate for blocks of size 2^( 6) =       0.000471111636
  error estimate for blocks of size 2^( 7) =       0.000476940589

      target function =                  N/A
              le_mean =     -16.905662118162
             les_mean =     286.140900427417
             stat err =       0.000465266712
             autocorr =       1.275288150204
              std dev =       0.582656797521
             le_variance =       0.339488943698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905662106398        initial
     9.5367e-01     9.5367e+00             2.2896e-04       -16.905662375971  <--
     3.8147e+00     3.8147e+01             5.8468e-05       -16.905662233032
     1.5259e+01     1.5259e+02             1.4698e-05       -16.905662118162

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 2.9544e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.094375e-01 1 1  ON 0
 uu_1                 1.428726e-01 1 1  ON 1
 uu_2                 4.123312e-02 1 1  ON 2
 uu_3                -2.149716e-02 1 1  ON 3
 uu_4                -6.732853e-02 1 1  ON 4
 uu_5                -1.026102e-01 1 1  ON 5
 uu_6                -1.311485e-01 1 1  ON 6
 uu_7                -1.462249e-01 1 1  ON 7
 uu_8                -1.392336e-01 1 1  ON 8
 uu_9                -1.111179e-01 1 1  ON 9
 ud_0                 4.543865e-01 1 1  ON 10
 ud_1                 1.880165e-01 1 1  ON 11
 ud_2                 6.678926e-02 1 1  ON 12
 ud_3                -5.470594e-03 1 1  ON 13
 ud_4                -6.318278e-02 1 1  ON 14
 ud_5                -1.052869e-01 1 1  ON 15
 ud_6                -1.337136e-01 1 1  ON 16
 ud_7                -1.513289e-01 1 1  ON 17
 ud_8                -1.541963e-01 1 1  ON 18
 ud_9                -1.469767e-01 1 1  ON 19
 eO_0                -7.640292e-01 1 1  ON 20
 eO_1                -4.412332e-01 1 1  ON 21
 eO_2                -1.821407e-02 1 1  ON 22
 eO_3                 3.062826e-01 1 1  ON 23
 eO_4                 5.343457e-01 1 1  ON 24
 eO_5                 4.989707e-01 1 1  ON 25
 eO_6                 2.698742e-01 1 1  ON 26
 eO_7                -3.746786e-02 1 1  ON 27
 eO_8                -2.385402e-01 1 1  ON 28
 eO_9                -1.055258e-01 1 1  ON 29
eH1_0                -2.541126e-01 1 1  ON 30
eH1_1                -1.530228e-01 1 1  ON 31
eH1_2                -1.057546e-01 1 1  ON 32
eH1_3                -5.110659e-02 1 1  ON 33
eH1_4                -2.527934e-03 1 1  ON 34
eH1_5                 3.217548e-02 1 1  ON 35
eH1_6                 9.425000e-02 1 1  ON 36
eH1_7                 1.546932e-01 1 1  ON 37
eH1_8                 1.932322e-01 1 1  ON 38
eH1_9                 9.210835e-02 1 1  ON 39
eH2_0                -2.513712e-01 1 1  ON 40
eH2_1                -1.502233e-01 1 1  ON 41
eH2_2                -1.030736e-01 1 1  ON 42
eH2_3                -4.859121e-02 1 1  ON 43
eH2_4                -2.242165e-04 1 1  ON 44
eH2_5                 3.457919e-02 1 1  ON 45
eH2_6                 9.513830e-02 1 1  ON 46
eH2_7                 1.557916e-01 1 1  ON 47
eH2_8                 1.962307e-01 1 1  ON 48
eH2_9                 8.530238e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5641e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8727
    reference variance = 0.282899
====================================================
  Execution time = 2.0336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110647964
                                         uncertainty =       0.002662417786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110647964
                                         uncertainty =       0.002662417786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409818090
  error estimate for blocks of size 2^( 2) =       0.000422441779
  error estimate for blocks of size 2^( 3) =       0.000435608390
  error estimate for blocks of size 2^( 4) =       0.000447765336
  error estimate for blocks of size 2^( 5) =       0.000457524644
  error estimate for blocks of size 2^( 6) =       0.000465820961
  error estimate for blocks of size 2^( 7) =       0.000468167039

      target function =                  N/A
              le_mean =     -16.905957714200
             les_mean =     286.147307799442
             stat err =       0.000459819495
             autocorr =       1.258903704860
              std dev =       0.579570300362
             le_variance =       0.335901733061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595771420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905957714200       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905957717395       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905958438515       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905958571645       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905959442356       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905959684665       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905959253564       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905958794385       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905959185112       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905959288741       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 6.747908e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905957714200       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905957715369       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905958007096       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905958057519       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905958530560       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905958535220       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905958498358       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905958375449       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.633461e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905957714200       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905957714531       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905957803265       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905957824635       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905957982152       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905957990307       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905957982082       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905957957340       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.148209e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126814 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5913e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.094866e-01 1 1  ON 0
 uu_1                 1.428605e-01 1 1  ON 1
 uu_2                 4.119990e-02 1 1  ON 2
 uu_3                -2.148388e-02 1 1  ON 3
 uu_4                -6.731306e-02 1 1  ON 4
 uu_5                -1.026350e-01 1 1  ON 5
 uu_6                -1.311017e-01 1 1  ON 6
 uu_7                -1.462065e-01 1 1  ON 7
 uu_8                -1.393512e-01 1 1  ON 8
 uu_9                -1.112178e-01 1 1  ON 9
 ud_0                 4.544116e-01 1 1  ON 10
 ud_1                 1.881065e-01 1 1  ON 11
 ud_2                 6.679425e-02 1 1  ON 12
 ud_3                -5.393461e-03 1 1  ON 13
 ud_4                -6.314010e-02 1 1  ON 14
 ud_5                -1.053185e-01 1 1  ON 15
 ud_6                -1.336833e-01 1 1  ON 16
 ud_7                -1.514120e-01 1 1  ON 17
 ud_8                -1.542193e-01 1 1  ON 18
 ud_9                -1.470148e-01 1 1  ON 19
 eO_0                -7.640050e-01 1 1  ON 20
 eO_1                -4.412034e-01 1 1  ON 21
 eO_2                -1.811760e-02 1 1  ON 22
 eO_3                 3.063002e-01 1 1  ON 23
 eO_4                 5.344351e-01 1 1  ON 24
 eO_5                 4.989639e-01 1 1  ON 25
 eO_6                 2.699060e-01 1 1  ON 26
 eO_7                -3.749592e-02 1 1  ON 27
 eO_8                -2.386360e-01 1 1  ON 28
 eO_9                -1.056566e-01 1 1  ON 29
eH1_0                -2.541646e-01 1 1  ON 30
eH1_1                -1.530584e-01 1 1  ON 31
eH1_2                -1.057388e-01 1 1  ON 32
eH1_3                -5.115045e-02 1 1  ON 33
eH1_4                -2.524163e-03 1 1  ON 34
eH1_5                 3.219845e-02 1 1  ON 35
eH1_6                 9.415487e-02 1 1  ON 36
eH1_7                 1.546547e-01 1 1  ON 37
eH1_8                 1.932915e-01 1 1  ON 38
eH1_9                 9.225479e-02 1 1  ON 39
eH2_0                -2.514166e-01 1 1  ON 40
eH2_1                -1.503500e-01 1 1  ON 41
eH2_2                -1.031648e-01 1 1  ON 42
eH2_3                -4.858521e-02 1 1  ON 43
eH2_4                -2.915606e-04 1 1  ON 44
eH2_5                 3.461827e-02 1 1  ON 45
eH2_6                 9.514375e-02 1 1  ON 46
eH2_7                 1.558139e-01 1 1  ON 47
eH2_8                 1.963169e-01 1 1  ON 48
eH2_9                 8.546572e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.0415
    reference variance = 0.466977
====================================================
  Execution time = 2.0050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4016e-01
  Total weights = 2.0000e+06
  Execution time = 1.9025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340207891786
                                         uncertainty =       0.003766158416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340207891786
                                         uncertainty =       0.003766158416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412405376
  error estimate for blocks of size 2^( 2) =       0.000425127416
  error estimate for blocks of size 2^( 3) =       0.000437708144
  error estimate for blocks of size 2^( 4) =       0.000450421244
  error estimate for blocks of size 2^( 5) =       0.000459903166
  error estimate for blocks of size 2^( 6) =       0.000466793795
  error estimate for blocks of size 2^( 7) =       0.000469916643

      target function =                  N/A
              le_mean =     -16.906198474220
             les_mean =     286.159703067923
             stat err =       0.000461758712
             autocorr =       1.253665169437
              std dev =       0.583229275925
             le_variance =       0.340156388296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340241519351
                                         uncertainty =       0.003765780039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340241519351
                                         uncertainty =       0.003765780039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412425812
  error estimate for blocks of size 2^( 2) =       0.000425145470
  error estimate for blocks of size 2^( 3) =       0.000437723553
  error estimate for blocks of size 2^( 4) =       0.000450432916
  error estimate for blocks of size 2^( 5) =       0.000459913766
  error estimate for blocks of size 2^( 6) =       0.000466804212
  error estimate for blocks of size 2^( 7) =       0.000469931974

      target function =                  N/A
              le_mean =     -16.906197706449
             les_mean =     286.159710819862
             stat err =       0.000461770717
             autocorr =       1.253606115417
              std dev =       0.583258176476
             le_variance =       0.340190100426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340224211420
                                         uncertainty =       0.003765758435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340224211420
                                         uncertainty =       0.003765758435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412415318
  error estimate for blocks of size 2^( 2) =       0.000425135719
  error estimate for blocks of size 2^( 3) =       0.000437715134
  error estimate for blocks of size 2^( 4) =       0.000450426400
  error estimate for blocks of size 2^( 5) =       0.000459908431
  error estimate for blocks of size 2^( 6) =       0.000466797945
  error estimate for blocks of size 2^( 7) =       0.000469924872

      target function =                  N/A
              le_mean =     -16.906197898650
             les_mean =     286.159700007502
             stat err =       0.000461764412
             autocorr =       1.253635675102
              std dev =       0.583243336230
             le_variance =       0.340172789257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340208326620
                                         uncertainty =       0.003766096049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340208326620
                                         uncertainty =       0.003766096049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412405648
  error estimate for blocks of size 2^( 2) =       0.000425127435
  error estimate for blocks of size 2^( 3) =       0.000437708012
  error estimate for blocks of size 2^( 4) =       0.000450420918
  error estimate for blocks of size 2^( 5) =       0.000459902863
  error estimate for blocks of size 2^( 6) =       0.000466793276
  error estimate for blocks of size 2^( 7) =       0.000469916748

      target function =                  N/A
              le_mean =     -16.906198362055
             les_mean =     286.159699724526
             stat err =       0.000461758451
             autocorr =       1.253662098969
              std dev =       0.583229660999
             le_variance =       0.340156837469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906198474220        initial  <--
     2.3842e-01     2.3842e+00             6.7479e-04       -16.906197706449
     9.5367e-01     9.5367e+00             1.6335e-04       -16.906197898650
     3.8147e+00     3.8147e+01             4.1482e-05       -16.906198362055

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6359
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.094375e-01 1 1  ON 0
 uu_1                 1.428726e-01 1 1  ON 1
 uu_2                 4.123312e-02 1 1  ON 2
 uu_3                -2.149716e-02 1 1  ON 3
 uu_4                -6.732853e-02 1 1  ON 4
 uu_5                -1.026102e-01 1 1  ON 5
 uu_6                -1.311485e-01 1 1  ON 6
 uu_7                -1.462249e-01 1 1  ON 7
 uu_8                -1.392336e-01 1 1  ON 8
 uu_9                -1.111179e-01 1 1  ON 9
 ud_0                 4.543865e-01 1 1  ON 10
 ud_1                 1.880165e-01 1 1  ON 11
 ud_2                 6.678926e-02 1 1  ON 12
 ud_3                -5.470594e-03 1 1  ON 13
 ud_4                -6.318278e-02 1 1  ON 14
 ud_5                -1.052869e-01 1 1  ON 15
 ud_6                -1.337136e-01 1 1  ON 16
 ud_7                -1.513289e-01 1 1  ON 17
 ud_8                -1.541963e-01 1 1  ON 18
 ud_9                -1.469767e-01 1 1  ON 19
 eO_0                -7.640292e-01 1 1  ON 20
 eO_1                -4.412332e-01 1 1  ON 21
 eO_2                -1.821407e-02 1 1  ON 22
 eO_3                 3.062826e-01 1 1  ON 23
 eO_4                 5.343457e-01 1 1  ON 24
 eO_5                 4.989707e-01 1 1  ON 25
 eO_6                 2.698742e-01 1 1  ON 26
 eO_7                -3.746786e-02 1 1  ON 27
 eO_8                -2.385402e-01 1 1  ON 28
 eO_9                -1.055258e-01 1 1  ON 29
eH1_0                -2.541126e-01 1 1  ON 30
eH1_1                -1.530228e-01 1 1  ON 31
eH1_2                -1.057546e-01 1 1  ON 32
eH1_3                -5.110659e-02 1 1  ON 33
eH1_4                -2.527934e-03 1 1  ON 34
eH1_5                 3.217548e-02 1 1  ON 35
eH1_6                 9.425000e-02 1 1  ON 36
eH1_7                 1.546932e-01 1 1  ON 37
eH1_8                 1.932322e-01 1 1  ON 38
eH1_9                 9.210835e-02 1 1  ON 39
eH2_0                -2.513712e-01 1 1  ON 40
eH2_1                -1.502233e-01 1 1  ON 41
eH2_2                -1.030736e-01 1 1  ON 42
eH2_3                -4.859121e-02 1 1  ON 43
eH2_4                -2.242165e-04 1 1  ON 44
eH2_5                 3.457919e-02 1 1  ON 45
eH2_6                 9.513830e-02 1 1  ON 46
eH2_7                 1.557916e-01 1 1  ON 47
eH2_8                 1.962307e-01 1 1  ON 48
eH2_9                 8.530238e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8977
    reference variance = 0.183357
====================================================
  Execution time = 2.0503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3306e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333141040299
                                         uncertainty =       0.002964172336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333141040299
                                         uncertainty =       0.002964172336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408083395
  error estimate for blocks of size 2^( 2) =       0.000421020550
  error estimate for blocks of size 2^( 3) =       0.000434176881
  error estimate for blocks of size 2^( 4) =       0.000446611552
  error estimate for blocks of size 2^( 5) =       0.000458284688
  error estimate for blocks of size 2^( 6) =       0.000465429158
  error estimate for blocks of size 2^( 7) =       0.000469178605

      target function =                  N/A
              le_mean =     -16.906568294597
             les_mean =     286.165115448050
             stat err =       0.000459876001
             autocorr =       1.269941291781
              std dev =       0.577117071916
             le_variance =       0.333064114697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690656829460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906568294597       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906568465484       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906568536694       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906568590585       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906568562662       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906568533505       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906568507389       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906568526024       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 9.216336e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906568294597       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906568339936       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906568359924       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906568372917       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906568364394       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906568356958       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906568347651       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.230469e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906568294597       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906568306108       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906568311264       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906568314479       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906568312245       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906568310364       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906568307853       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.602534e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6167e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.094396e-01 1 1  ON 0
 uu_1                 1.428650e-01 1 1  ON 1
 uu_2                 4.124016e-02 1 1  ON 2
 uu_3                -2.150201e-02 1 1  ON 3
 uu_4                -6.732516e-02 1 1  ON 4
 uu_5                -1.026199e-01 1 1  ON 5
 uu_6                -1.311555e-01 1 1  ON 6
 uu_7                -1.462158e-01 1 1  ON 7
 uu_8                -1.392373e-01 1 1  ON 8
 uu_9                -1.111238e-01 1 1  ON 9
 ud_0                 4.543720e-01 1 1  ON 10
 ud_1                 1.880223e-01 1 1  ON 11
 ud_2                 6.678440e-02 1 1  ON 12
 ud_3                -5.469838e-03 1 1  ON 13
 ud_4                -6.317217e-02 1 1  ON 14
 ud_5                -1.052915e-01 1 1  ON 15
 ud_6                -1.337096e-01 1 1  ON 16
 ud_7                -1.513222e-01 1 1  ON 17
 ud_8                -1.541888e-01 1 1  ON 18
 ud_9                -1.469765e-01 1 1  ON 19
 eO_0                -7.640238e-01 1 1  ON 20
 eO_1                -4.412321e-01 1 1  ON 21
 eO_2                -1.820335e-02 1 1  ON 22
 eO_3                 3.062828e-01 1 1  ON 23
 eO_4                 5.343469e-01 1 1  ON 24
 eO_5                 4.989665e-01 1 1  ON 25
 eO_6                 2.698781e-01 1 1  ON 26
 eO_7                -3.746418e-02 1 1  ON 27
 eO_8                -2.385466e-01 1 1  ON 28
 eO_9                -1.055385e-01 1 1  ON 29
eH1_0                -2.541135e-01 1 1  ON 30
eH1_1                -1.530299e-01 1 1  ON 31
eH1_2                -1.057701e-01 1 1  ON 32
eH1_3                -5.111128e-02 1 1  ON 33
eH1_4                -2.545384e-03 1 1  ON 34
eH1_5                 3.217450e-02 1 1  ON 35
eH1_6                 9.424718e-02 1 1  ON 36
eH1_7                 1.547010e-01 1 1  ON 37
eH1_8                 1.932468e-01 1 1  ON 38
eH1_9                 9.213066e-02 1 1  ON 39
eH2_0                -2.513862e-01 1 1  ON 40
eH2_1                -1.502286e-01 1 1  ON 41
eH2_2                -1.030725e-01 1 1  ON 42
eH2_3                -4.860068e-02 1 1  ON 43
eH2_4                -2.291335e-04 1 1  ON 44
eH2_5                 3.458472e-02 1 1  ON 45
eH2_6                 9.515050e-02 1 1  ON 46
eH2_7                 1.557894e-01 1 1  ON 47
eH2_8                 1.962344e-01 1 1  ON 48
eH2_9                 8.531782e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9415
    reference variance = 0.479308
====================================================
  Execution time = 1.9961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4013e-01
  Total weights = 2.0000e+06
  Execution time = 1.8985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340180493971
                                         uncertainty =       0.004091178173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340180493971
                                         uncertainty =       0.004091178173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412399774
  error estimate for blocks of size 2^( 2) =       0.000424994979
  error estimate for blocks of size 2^( 3) =       0.000437559485
  error estimate for blocks of size 2^( 4) =       0.000449511323
  error estimate for blocks of size 2^( 5) =       0.000459594799
  error estimate for blocks of size 2^( 6) =       0.000465439114
  error estimate for blocks of size 2^( 7) =       0.000469829952

      target function =                  N/A
              le_mean =     -16.905734927934
             les_mean =     286.144020430544
             stat err =       0.000461093797
             autocorr =       1.250091271033
              std dev =       0.583221353377
             le_variance =       0.340147147035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134561442
                                         uncertainty =       0.004090340449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134561442
                                         uncertainty =       0.004090340449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412371932
  error estimate for blocks of size 2^( 2) =       0.000424968521
  error estimate for blocks of size 2^( 3) =       0.000437534172
  error estimate for blocks of size 2^( 4) =       0.000449486780
  error estimate for blocks of size 2^( 5) =       0.000459571380
  error estimate for blocks of size 2^( 6) =       0.000465416665
  error estimate for blocks of size 2^( 7) =       0.000469808337

      target function =                  N/A
              le_mean =     -16.905735286863
             les_mean =     286.143986639733
             stat err =       0.000461070790
             autocorr =       1.250135317503
              std dev =       0.583181978706
             le_variance =       0.340101220287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340152747335
                                         uncertainty =       0.004090669936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340152747335
                                         uncertainty =       0.004090669936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412382955
  error estimate for blocks of size 2^( 2) =       0.000424978960
  error estimate for blocks of size 2^( 3) =       0.000437544107
  error estimate for blocks of size 2^( 4) =       0.000449496373
  error estimate for blocks of size 2^( 5) =       0.000459580504
  error estimate for blocks of size 2^( 6) =       0.000465425372
  error estimate for blocks of size 2^( 7) =       0.000469816737

      target function =                  N/A
              le_mean =     -16.905735144265
             les_mean =     286.144000001430
             stat err =       0.000461079747
             autocorr =       1.250117051598
              std dev =       0.583197568118
             le_variance =       0.340119403459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340176898251
                                         uncertainty =       0.004091112652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340176898251
                                         uncertainty =       0.004091112652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412397594
  error estimate for blocks of size 2^( 2) =       0.000424992903
  error estimate for blocks of size 2^( 3) =       0.000437557491
  error estimate for blocks of size 2^( 4) =       0.000449509383
  error estimate for blocks of size 2^( 5) =       0.000459592944
  error estimate for blocks of size 2^( 6) =       0.000465437330
  error estimate for blocks of size 2^( 7) =       0.000469828237

      target function =                  N/A
              le_mean =     -16.905734955745
             les_mean =     286.144017775554
             stat err =       0.000461091974
             autocorr =       1.250094597714
              std dev =       0.583218271086
             le_variance =       0.340143551728


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905734927934        initial
     2.3842e+00     2.3842e+01             9.2163e-05       -16.905735286863  <--
     9.5367e+00     9.5367e+01             2.2305e-05       -16.905735144265
     3.8147e+01     3.8147e+02             5.6025e-06       -16.905734955745

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.9493e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.094459e-01 1 1  ON 0
 uu_1                 1.428481e-01 1 1  ON 1
 uu_2                 4.125453e-02 1 1  ON 2
 uu_3                -2.151353e-02 1 1  ON 3
 uu_4                -6.732023e-02 1 1  ON 4
 uu_5                -1.026458e-01 1 1  ON 5
 uu_6                -1.311763e-01 1 1  ON 6
 uu_7                -1.461904e-01 1 1  ON 7
 uu_8                -1.392492e-01 1 1  ON 8
 uu_9                -1.111419e-01 1 1  ON 9
 ud_0                 4.543369e-01 1 1  ON 10
 ud_1                 1.880331e-01 1 1  ON 11
 ud_2                 6.677298e-02 1 1  ON 12
 ud_3                -5.465659e-03 1 1  ON 13
 ud_4                -6.314617e-02 1 1  ON 14
 ud_5                -1.053033e-01 1 1  ON 15
 ud_6                -1.336992e-01 1 1  ON 16
 ud_7                -1.513026e-01 1 1  ON 17
 ud_8                -1.541652e-01 1 1  ON 18
 ud_9                -1.469758e-01 1 1  ON 19
 eO_0                -7.640054e-01 1 1  ON 20
 eO_1                -4.412269e-01 1 1  ON 21
 eO_2                -1.817373e-02 1 1  ON 22
 eO_3                 3.062855e-01 1 1  ON 23
 eO_4                 5.343502e-01 1 1  ON 24
 eO_5                 4.989534e-01 1 1  ON 25
 eO_6                 2.698897e-01 1 1  ON 26
 eO_7                -3.745304e-02 1 1  ON 27
 eO_8                -2.385665e-01 1 1  ON 28
 eO_9                -1.055784e-01 1 1  ON 29
eH1_0                -2.541190e-01 1 1  ON 30
eH1_1                -1.530538e-01 1 1  ON 31
eH1_2                -1.058157e-01 1 1  ON 32
eH1_3                -5.112950e-02 1 1  ON 33
eH1_4                -2.593732e-03 1 1  ON 34
eH1_5                 3.217188e-02 1 1  ON 35
eH1_6                 9.423760e-02 1 1  ON 36
eH1_7                 1.547246e-01 1 1  ON 37
eH1_8                 1.932919e-01 1 1  ON 38
eH1_9                 9.220052e-02 1 1  ON 39
eH2_0                -2.514305e-01 1 1  ON 40
eH2_1                -1.502416e-01 1 1  ON 41
eH2_2                -1.030714e-01 1 1  ON 42
eH2_3                -4.862927e-02 1 1  ON 43
eH2_4                -2.464777e-04 1 1  ON 44
eH2_5                 3.459934e-02 1 1  ON 45
eH2_6                 9.518742e-02 1 1  ON 46
eH2_7                 1.557833e-01 1 1  ON 47
eH2_8                 1.962463e-01 1 1  ON 48
eH2_9                 8.536635e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5669e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9788
    reference variance = 0.356829
====================================================
  Execution time = 2.0381e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4232e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372550126
                                         uncertainty =       0.003777647489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372550126
                                         uncertainty =       0.003777647489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413713750
  error estimate for blocks of size 2^( 2) =       0.000426371619
  error estimate for blocks of size 2^( 3) =       0.000439548534
  error estimate for blocks of size 2^( 4) =       0.000452746800
  error estimate for blocks of size 2^( 5) =       0.000464784631
  error estimate for blocks of size 2^( 6) =       0.000472695459
  error estimate for blocks of size 2^( 7) =       0.000477556667

      target function =                  N/A
              le_mean =     -16.906300801314
             les_mean =     286.165324747875
             stat err =       0.000466945889
             autocorr =       1.273893735957
              std dev =       0.585079596732
             le_variance =       0.342318134512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630080131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300801314       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906301550740       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906301638162       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906302014832       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906302454035       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906302248494       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906302247154       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906302318552       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906302233639       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.308981e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300801314       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906301019370       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906301062325       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906301209769       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906301302982       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906301239842       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906301218065       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906301235736       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 8.767996e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300801314       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300858157       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300871283       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906300912962       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906300935182       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300918660       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906300910974       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.215094e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5947e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.094702e-01 1 1  ON 0
 uu_1                 1.428391e-01 1 1  ON 1
 uu_2                 4.123969e-02 1 1  ON 2
 uu_3                -2.151001e-02 1 1  ON 3
 uu_4                -6.735432e-02 1 1  ON 4
 uu_5                -1.026669e-01 1 1  ON 5
 uu_6                -1.312182e-01 1 1  ON 6
 uu_7                -1.461895e-01 1 1  ON 7
 uu_8                -1.392288e-01 1 1  ON 8
 uu_9                -1.111298e-01 1 1  ON 9
 ud_0                 4.543698e-01 1 1  ON 10
 ud_1                 1.880126e-01 1 1  ON 11
 ud_2                 6.674058e-02 1 1  ON 12
 ud_3                -5.478493e-03 1 1  ON 13
 ud_4                -6.317298e-02 1 1  ON 14
 ud_5                -1.053079e-01 1 1  ON 15
 ud_6                -1.336949e-01 1 1  ON 16
 ud_7                -1.513173e-01 1 1  ON 17
 ud_8                -1.540775e-01 1 1  ON 18
 ud_9                -1.469368e-01 1 1  ON 19
 eO_0                -7.640314e-01 1 1  ON 20
 eO_1                -4.412139e-01 1 1  ON 21
 eO_2                -1.814870e-02 1 1  ON 22
 eO_3                 3.063055e-01 1 1  ON 23
 eO_4                 5.343932e-01 1 1  ON 24
 eO_5                 4.989647e-01 1 1  ON 25
 eO_6                 2.698616e-01 1 1  ON 26
 eO_7                -3.744328e-02 1 1  ON 27
 eO_8                -2.385816e-01 1 1  ON 28
 eO_9                -1.056216e-01 1 1  ON 29
eH1_0                -2.541703e-01 1 1  ON 30
eH1_1                -1.530861e-01 1 1  ON 31
eH1_2                -1.058318e-01 1 1  ON 32
eH1_3                -5.116511e-02 1 1  ON 33
eH1_4                -2.566133e-03 1 1  ON 34
eH1_5                 3.217725e-02 1 1  ON 35
eH1_6                 9.422856e-02 1 1  ON 36
eH1_7                 1.547311e-01 1 1  ON 37
eH1_8                 1.933186e-01 1 1  ON 38
eH1_9                 9.226429e-02 1 1  ON 39
eH2_0                -2.514909e-01 1 1  ON 40
eH2_1                -1.503085e-01 1 1  ON 41
eH2_2                -1.030582e-01 1 1  ON 42
eH2_3                -4.865781e-02 1 1  ON 43
eH2_4                -2.245380e-04 1 1  ON 44
eH2_5                 3.462928e-02 1 1  ON 45
eH2_6                 9.520198e-02 1 1  ON 46
eH2_7                 1.557566e-01 1 1  ON 47
eH2_8                 1.962731e-01 1 1  ON 48
eH2_9                 8.544214e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9964
    reference variance = 0.262175
====================================================
  Execution time = 2.0026e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4220e-01
  Total weights = 2.0000e+06
  Execution time = 1.8990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342240698561
                                         uncertainty =       0.005438700246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342240698561
                                         uncertainty =       0.005438700246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413608301
  error estimate for blocks of size 2^( 2) =       0.000426760060
  error estimate for blocks of size 2^( 3) =       0.000440176817
  error estimate for blocks of size 2^( 4) =       0.000452897919
  error estimate for blocks of size 2^( 5) =       0.000462462850
  error estimate for blocks of size 2^( 6) =       0.000472238671
  error estimate for blocks of size 2^( 7) =       0.000475376432

      target function =                  N/A
              le_mean =     -16.905741062422
             les_mean =     286.146224351495
             stat err =       0.000465743968
             autocorr =       1.267990459676
              std dev =       0.584930468424
             le_variance =       0.342143652891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342387787538
                                         uncertainty =       0.005439894853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342387787538
                                         uncertainty =       0.005439894853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413697181
  error estimate for blocks of size 2^( 2) =       0.000426846433
  error estimate for blocks of size 2^( 3) =       0.000440261627
  error estimate for blocks of size 2^( 4) =       0.000452980657
  error estimate for blocks of size 2^( 5) =       0.000462542057
  error estimate for blocks of size 2^( 6) =       0.000472315149
  error estimate for blocks of size 2^( 7) =       0.000475449987

      target function =                  N/A
              le_mean =     -16.905741361059
             les_mean =     286.146381511023
             stat err =       0.000465821962
             autocorr =       1.267870210619
              std dev =       0.585056164105
             le_variance =       0.342290715157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342350287045
                                         uncertainty =       0.005439768614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342350287045
                                         uncertainty =       0.005439768614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413674519
  error estimate for blocks of size 2^( 2) =       0.000426824106
  error estimate for blocks of size 2^( 3) =       0.000440239350
  error estimate for blocks of size 2^( 4) =       0.000452958818
  error estimate for blocks of size 2^( 5) =       0.000462521330
  error estimate for blocks of size 2^( 6) =       0.000472294984
  error estimate for blocks of size 2^( 7) =       0.000475430957

      target function =                  N/A
              le_mean =     -16.905741343020
             les_mean =     286.146343401762
             stat err =       0.000465801522
             autocorr =       1.267897849752
              std dev =       0.585024115560
             le_variance =       0.342253215786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342256849317
                                         uncertainty =       0.005438874930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342256849317
                                         uncertainty =       0.005438874930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413618060
  error estimate for blocks of size 2^( 2) =       0.000426769472
  error estimate for blocks of size 2^( 3) =       0.000440185988
  error estimate for blocks of size 2^( 4) =       0.000452906842
  error estimate for blocks of size 2^( 5) =       0.000462471437
  error estimate for blocks of size 2^( 6) =       0.000472246932
  error estimate for blocks of size 2^( 7) =       0.000475384428

      target function =                  N/A
              le_mean =     -16.905741091359
             les_mean =     286.146241476833
             stat err =       0.000465752410
             autocorr =       1.267976585266
              std dev =       0.584944270726
             le_variance =       0.342159799855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905741062422        initial
     5.9605e-01     5.9605e+00             3.3090e-04       -16.905741361059  <--
     2.3842e+00     2.3842e+01             8.7680e-05       -16.905741343020
     9.5367e+00     9.5367e+01             2.2151e-05       -16.905741091359

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 2.9568e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.095204e-01 1 1  ON 0
 uu_1                 1.428174e-01 1 1  ON 1
 uu_2                 4.121585e-02 1 1  ON 2
 uu_3                -2.152467e-02 1 1  ON 3
 uu_4                -6.743944e-02 1 1  ON 4
 uu_5                -1.027337e-01 1 1  ON 5
 uu_6                -1.313179e-01 1 1  ON 6
 uu_7                -1.461966e-01 1 1  ON 7
 uu_8                -1.391764e-01 1 1  ON 8
 uu_9                -1.110935e-01 1 1  ON 9
 ud_0                 4.544113e-01 1 1  ON 10
 ud_1                 1.879672e-01 1 1  ON 11
 ud_2                 6.667311e-02 1 1  ON 12
 ud_3                -5.522041e-03 1 1  ON 13
 ud_4                -6.322577e-02 1 1  ON 14
 ud_5                -1.053293e-01 1 1  ON 15
 ud_6                -1.336733e-01 1 1  ON 16
 ud_7                -1.513546e-01 1 1  ON 17
 ud_8                -1.538343e-01 1 1  ON 18
 ud_9                -1.468212e-01 1 1  ON 19
 eO_0                -7.640988e-01 1 1  ON 20
 eO_1                -4.411826e-01 1 1  ON 21
 eO_2                -1.808872e-02 1 1  ON 22
 eO_3                 3.063743e-01 1 1  ON 23
 eO_4                 5.345179e-01 1 1  ON 24
 eO_5                 4.990038e-01 1 1  ON 25
 eO_6                 2.697836e-01 1 1  ON 26
 eO_7                -3.741744e-02 1 1  ON 27
 eO_8                -2.386280e-01 1 1  ON 28
 eO_9                -1.057505e-01 1 1  ON 29
eH1_0                -2.543118e-01 1 1  ON 30
eH1_1                -1.531831e-01 1 1  ON 31
eH1_2                -1.058867e-01 1 1  ON 32
eH1_3                -5.125838e-02 1 1  ON 33
eH1_4                -2.508756e-03 1 1  ON 34
eH1_5                 3.219730e-02 1 1  ON 35
eH1_6                 9.420581e-02 1 1  ON 36
eH1_7                 1.547507e-01 1 1  ON 37
eH1_8                 1.933973e-01 1 1  ON 38
eH1_9                 9.245469e-02 1 1  ON 39
eH2_0                -2.516627e-01 1 1  ON 40
eH2_1                -1.504704e-01 1 1  ON 41
eH2_2                -1.030531e-01 1 1  ON 42
eH2_3                -4.872975e-02 1 1  ON 43
eH2_4                -1.811831e-04 1 1  ON 44
eH2_5                 3.471129e-02 1 1  ON 45
eH2_6                 9.524756e-02 1 1  ON 46
eH2_7                 1.556801e-01 1 1  ON 47
eH2_8                 1.963521e-01 1 1  ON 48
eH2_9                 8.566812e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5525e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8225
    reference variance = 0.342374
====================================================
  Execution time = 2.1033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3644e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336571147804
                                         uncertainty =       0.003149011598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336571147804
                                         uncertainty =       0.003149011598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410146967
  error estimate for blocks of size 2^( 2) =       0.000422753223
  error estimate for blocks of size 2^( 3) =       0.000435897094
  error estimate for blocks of size 2^( 4) =       0.000447999665
  error estimate for blocks of size 2^( 5) =       0.000458160453
  error estimate for blocks of size 2^( 6) =       0.000464323400
  error estimate for blocks of size 2^( 7) =       0.000468888981

      target function =                  N/A
              le_mean =     -16.905811786963
             les_mean =     286.142913077105
             stat err =       0.000459843125
             autocorr =       1.257014786055
              std dev =       0.580035403325
             le_variance =       0.336441069110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581178696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811786963       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812225534       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811822285       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905813617195       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905814253137       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905813910594       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905813565283       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905813142795       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905813903642       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905814090954       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905813981066       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 1.366289e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811786963       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905811988127       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811744749       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812071551       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812684981       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812420021       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905812225403       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812170189       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905812304404       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.401955e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811786963       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905811850517       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811764577       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905811817035       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812015390       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905811932927       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905811872833       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905811881193       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 9.466250e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6551e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.095495e-01 1 1  ON 0
 uu_1                 1.428089e-01 1 1  ON 1
 uu_2                 4.113534e-02 1 1  ON 2
 uu_3                -2.157857e-02 1 1  ON 3
 uu_4                -6.751877e-02 1 1  ON 4
 uu_5                -1.028385e-01 1 1  ON 5
 uu_6                -1.312964e-01 1 1  ON 6
 uu_7                -1.461496e-01 1 1  ON 7
 uu_8                -1.391787e-01 1 1  ON 8
 uu_9                -1.111311e-01 1 1  ON 9
 ud_0                 4.545309e-01 1 1  ON 10
 ud_1                 1.880098e-01 1 1  ON 11
 ud_2                 6.662012e-02 1 1  ON 12
 ud_3                -5.564167e-03 1 1  ON 13
 ud_4                -6.318266e-02 1 1  ON 14
 ud_5                -1.054455e-01 1 1  ON 15
 ud_6                -1.336840e-01 1 1  ON 16
 ud_7                -1.514311e-01 1 1  ON 17
 ud_8                -1.536983e-01 1 1  ON 18
 ud_9                -1.466906e-01 1 1  ON 19
 eO_0                -7.643012e-01 1 1  ON 20
 eO_1                -4.411829e-01 1 1  ON 21
 eO_2                -1.778328e-02 1 1  ON 22
 eO_3                 3.064749e-01 1 1  ON 23
 eO_4                 5.347161e-01 1 1  ON 24
 eO_5                 4.990234e-01 1 1  ON 25
 eO_6                 2.696412e-01 1 1  ON 26
 eO_7                -3.738317e-02 1 1  ON 27
 eO_8                -2.387150e-01 1 1  ON 28
 eO_9                -1.059436e-01 1 1  ON 29
eH1_0                -2.544711e-01 1 1  ON 30
eH1_1                -1.533952e-01 1 1  ON 31
eH1_2                -1.059701e-01 1 1  ON 32
eH1_3                -5.135707e-02 1 1  ON 33
eH1_4                -2.612937e-03 1 1  ON 34
eH1_5                 3.228592e-02 1 1  ON 35
eH1_6                 9.416238e-02 1 1  ON 36
eH1_7                 1.548077e-01 1 1  ON 37
eH1_8                 1.935472e-01 1 1  ON 38
eH1_9                 9.279489e-02 1 1  ON 39
eH2_0                -2.516688e-01 1 1  ON 40
eH2_1                -1.504675e-01 1 1  ON 41
eH2_2                -1.030784e-01 1 1  ON 42
eH2_3                -4.879173e-02 1 1  ON 43
eH2_4                -3.828384e-04 1 1  ON 44
eH2_5                 3.467291e-02 1 1  ON 45
eH2_6                 9.520270e-02 1 1  ON 46
eH2_7                 1.556540e-01 1 1  ON 47
eH2_8                 1.964672e-01 1 1  ON 48
eH2_9                 8.594376e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9274
    reference variance = 0.203329
====================================================
  Execution time = 2.0125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3745e-01
  Total weights = 2.0000e+06
  Execution time = 1.9073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354543533
                                         uncertainty =       0.003464833180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354543533
                                         uncertainty =       0.003464833180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410660187
  error estimate for blocks of size 2^( 2) =       0.000423990979
  error estimate for blocks of size 2^( 3) =       0.000437155788
  error estimate for blocks of size 2^( 4) =       0.000450605897
  error estimate for blocks of size 2^( 5) =       0.000462095542
  error estimate for blocks of size 2^( 6) =       0.000469369439
  error estimate for blocks of size 2^( 7) =       0.000477904109

      target function =                  N/A
              le_mean =     -16.905632198844
             les_mean =     286.137683452040
             stat err =       0.000464993747
             autocorr =       1.282121031266
              std dev =       0.580761205725
             le_variance =       0.337283578075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337753584982
                                         uncertainty =       0.003470525271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337753584982
                                         uncertainty =       0.003470525271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410902949
  error estimate for blocks of size 2^( 2) =       0.000424223914
  error estimate for blocks of size 2^( 3) =       0.000437376049
  error estimate for blocks of size 2^( 4) =       0.000450820005
  error estimate for blocks of size 2^( 5) =       0.000462304128
  error estimate for blocks of size 2^( 6) =       0.000469564299
  error estimate for blocks of size 2^( 7) =       0.000478089583

      target function =                  N/A
              le_mean =     -16.905633350827
             les_mean =     286.138121291521
             stat err =       0.000465194504
             autocorr =       1.281712538408
              std dev =       0.581104523952
             le_variance =       0.337682467758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337696180797
                                         uncertainty =       0.003469867504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337696180797
                                         uncertainty =       0.003469867504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410868054
  error estimate for blocks of size 2^( 2) =       0.000424189421
  error estimate for blocks of size 2^( 3) =       0.000437342577
  error estimate for blocks of size 2^( 4) =       0.000450787053
  error estimate for blocks of size 2^( 5) =       0.000462272643
  error estimate for blocks of size 2^( 6) =       0.000469536020
  error estimate for blocks of size 2^( 7) =       0.000478063342

      target function =                  N/A
              le_mean =     -16.905633060544
             les_mean =     286.138054124547
             stat err =       0.000465164764
             autocorr =       1.281766362165
              std dev =       0.581055174328
             le_variance =       0.337625115614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410824044
                                         uncertainty =       0.003465671197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410824044
                                         uncertainty =       0.003465671197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410694440
  error estimate for blocks of size 2^( 2) =       0.000424023568
  error estimate for blocks of size 2^( 3) =       0.000437186404
  error estimate for blocks of size 2^( 4) =       0.000450635583
  error estimate for blocks of size 2^( 5) =       0.000462124632
  error estimate for blocks of size 2^( 6) =       0.000469396799
  error estimate for blocks of size 2^( 7) =       0.000477930080

      target function =                  N/A
              le_mean =     -16.905632316067
             les_mean =     286.137743682705
             stat err =       0.000465021773
             autocorr =       1.282061711359
              std dev =       0.580809646384
             le_variance =       0.337339845333


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905632198844        initial
     1.4901e-01     1.4901e+00             1.3663e-03       -16.905633350827  <--
     5.9605e-01     5.9605e+00             3.4020e-04       -16.905633060544
     2.3842e+00     2.3842e+01             9.4662e-05       -16.905632316067

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 2.9713e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.095682e-01 1 1  ON 0
 uu_1                 1.427534e-01 1 1  ON 1
 uu_2                 4.100387e-02 1 1  ON 2
 uu_3                -2.173912e-02 1 1  ON 3
 uu_4                -6.770480e-02 1 1  ON 4
 uu_5                -1.030634e-01 1 1  ON 5
 uu_6                -1.313013e-01 1 1  ON 6
 uu_7                -1.460835e-01 1 1  ON 7
 uu_8                -1.392070e-01 1 1  ON 8
 uu_9                -1.112432e-01 1 1  ON 9
 ud_0                 4.547143e-01 1 1  ON 10
 ud_1                 1.880870e-01 1 1  ON 11
 ud_2                 6.659031e-02 1 1  ON 12
 ud_3                -5.618716e-03 1 1  ON 13
 ud_4                -6.320945e-02 1 1  ON 14
 ud_5                -1.055971e-01 1 1  ON 15
 ud_6                -1.336833e-01 1 1  ON 16
 ud_7                -1.515429e-01 1 1  ON 17
 ud_8                -1.534252e-01 1 1  ON 18
 ud_9                -1.463324e-01 1 1  ON 19
 eO_0                -7.645452e-01 1 1  ON 20
 eO_1                -4.411703e-01 1 1  ON 21
 eO_2                -1.730116e-02 1 1  ON 22
 eO_3                 3.068808e-01 1 1  ON 23
 eO_4                 5.352031e-01 1 1  ON 24
 eO_5                 4.991426e-01 1 1  ON 25
 eO_6                 2.692723e-01 1 1  ON 26
 eO_7                -3.731789e-02 1 1  ON 27
 eO_8                -2.389897e-01 1 1  ON 28
 eO_9                -1.065280e-01 1 1  ON 29
eH1_0                -2.549538e-01 1 1  ON 30
eH1_1                -1.538620e-01 1 1  ON 31
eH1_2                -1.062611e-01 1 1  ON 32
eH1_3                -5.168176e-02 1 1  ON 33
eH1_4                -2.883527e-03 1 1  ON 34
eH1_5                 3.237537e-02 1 1  ON 35
eH1_6                 9.405174e-02 1 1  ON 36
eH1_7                 1.550003e-01 1 1  ON 37
eH1_8                 1.939859e-01 1 1  ON 38
eH1_9                 9.382098e-02 1 1  ON 39
eH2_0                -2.517299e-01 1 1  ON 40
eH2_1                -1.505629e-01 1 1  ON 41
eH2_2                -1.032042e-01 1 1  ON 42
eH2_3                -4.895442e-02 1 1  ON 43
eH2_4                -7.833701e-04 1 1  ON 44
eH2_5                 3.448413e-02 1 1  ON 45
eH2_6                 9.507769e-02 1 1  ON 46
eH2_7                 1.556059e-01 1 1  ON 47
eH2_8                 1.968067e-01 1 1  ON 48
eH2_9                 8.677708e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8925
    reference variance = 0.200789
====================================================
  Execution time = 2.2838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4441e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344387258274
                                         uncertainty =       0.004772593938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344387258274
                                         uncertainty =       0.004772593938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414973023
  error estimate for blocks of size 2^( 2) =       0.000427829153
  error estimate for blocks of size 2^( 3) =       0.000440304440
  error estimate for blocks of size 2^( 4) =       0.000452275245
  error estimate for blocks of size 2^( 5) =       0.000462865281
  error estimate for blocks of size 2^( 6) =       0.000472243727
  error estimate for blocks of size 2^( 7) =       0.000477680218

      target function =                  N/A
              le_mean =     -16.905666197334
             les_mean =     286.145954623857
             stat err =       0.000466266118
             autocorr =       1.262490111895
              std dev =       0.586860477779
             le_variance =       0.344405220379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566619733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905666197334       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905667252163       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667252548       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905668047722       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905670066565       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905667275844       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905666231029       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905671088352       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905674606518       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905675145571       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905675293747       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905674647376       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905674061273       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905673881733       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-02 is 6.296901e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905666197334       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905666862324       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667366783       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905668247620       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905669101782       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905667171619       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905667882835       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905669323938       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905669364677       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905669501380       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905669406280       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905669208926       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 1.612744e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905666197334       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905666465659       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667163763       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905667495621       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905667370622       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905666912255       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905667189266       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905667344149       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905667375757       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.992212e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140320 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8391e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.095180e-01 1 1  ON 0
 uu_1                 1.426134e-01 1 1  ON 1
 uu_2                 4.075712e-02 1 1  ON 2
 uu_3                -2.192176e-02 1 1  ON 3
 uu_4                -6.789519e-02 1 1  ON 4
 uu_5                -1.031888e-01 1 1  ON 5
 uu_6                -1.316319e-01 1 1  ON 6
 uu_7                -1.460912e-01 1 1  ON 7
 uu_8                -1.390775e-01 1 1  ON 8
 uu_9                -1.111898e-01 1 1  ON 9
 ud_0                 4.545925e-01 1 1  ON 10
 ud_1                 1.880148e-01 1 1  ON 11
 ud_2                 6.646603e-02 1 1  ON 12
 ud_3                -5.659638e-03 1 1  ON 13
 ud_4                -6.327052e-02 1 1  ON 14
 ud_5                -1.055989e-01 1 1  ON 15
 ud_6                -1.337132e-01 1 1  ON 16
 ud_7                -1.515898e-01 1 1  ON 17
 ud_8                -1.531810e-01 1 1  ON 18
 ud_9                -1.455877e-01 1 1  ON 19
 eO_0                -7.642997e-01 1 1  ON 20
 eO_1                -4.409076e-01 1 1  ON 21
 eO_2                -1.727437e-02 1 1  ON 22
 eO_3                 3.069115e-01 1 1  ON 23
 eO_4                 5.353341e-01 1 1  ON 24
 eO_5                 4.991927e-01 1 1  ON 25
 eO_6                 2.693954e-01 1 1  ON 26
 eO_7                -3.700546e-02 1 1  ON 27
 eO_8                -2.392321e-01 1 1  ON 28
 eO_9                -1.073056e-01 1 1  ON 29
eH1_0                -2.554750e-01 1 1  ON 30
eH1_1                -1.538010e-01 1 1  ON 31
eH1_2                -1.066389e-01 1 1  ON 32
eH1_3                -5.186286e-02 1 1  ON 33
eH1_4                -3.345187e-03 1 1  ON 34
eH1_5                 3.232674e-02 1 1  ON 35
eH1_6                 9.351340e-02 1 1  ON 36
eH1_7                 1.549185e-01 1 1  ON 37
eH1_8                 1.944931e-01 1 1  ON 38
eH1_9                 9.519188e-02 1 1  ON 39
eH2_0                -2.525000e-01 1 1  ON 40
eH2_1                -1.512080e-01 1 1  ON 41
eH2_2                -1.037586e-01 1 1  ON 42
eH2_3                -4.917814e-02 1 1  ON 43
eH2_4                -9.033191e-04 1 1  ON 44
eH2_5                 3.398515e-02 1 1  ON 45
eH2_6                 9.533459e-02 1 1  ON 46
eH2_7                 1.555807e-01 1 1  ON 47
eH2_8                 1.975689e-01 1 1  ON 48
eH2_9                 8.838982e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9236
    reference variance = 0.312047
====================================================
  Execution time = 2.0447e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3265e-01
  Total weights = 2.0000e+06
  Execution time = 1.8968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332611760509
                                         uncertainty =       0.003745434721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332611760509
                                         uncertainty =       0.003745434721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407798903
  error estimate for blocks of size 2^( 2) =       0.000420359605
  error estimate for blocks of size 2^( 3) =       0.000432621574
  error estimate for blocks of size 2^( 4) =       0.000445500036
  error estimate for blocks of size 2^( 5) =       0.000455797369
  error estimate for blocks of size 2^( 6) =       0.000465062648
  error estimate for blocks of size 2^( 7) =       0.000470112196

      target function =                  N/A
              le_mean =     -16.905697870170
             les_mean =     286.135220201546
             stat err =       0.000459118062
             autocorr =       1.267525342552
              std dev =       0.576714739183
             le_variance =       0.332599890391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332675506730
                                         uncertainty =       0.003740340900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332675506730
                                         uncertainty =       0.003740340900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407837906
  error estimate for blocks of size 2^( 2) =       0.000420400884
  error estimate for blocks of size 2^( 3) =       0.000432666539
  error estimate for blocks of size 2^( 4) =       0.000445542565
  error estimate for blocks of size 2^( 5) =       0.000455825617
  error estimate for blocks of size 2^( 6) =       0.000465071777
  error estimate for blocks of size 2^( 7) =       0.000470082367

      target function =                  N/A
              le_mean =     -16.905700786108
             les_mean =     286.135382418337
             stat err =       0.000459130582
             autocorr =       1.267352031785
              std dev =       0.576769898007
             le_variance =       0.332663515247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725853833
                                         uncertainty =       0.003738005716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725853833
                                         uncertainty =       0.003738005716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407868733
  error estimate for blocks of size 2^( 2) =       0.000420429143
  error estimate for blocks of size 2^( 3) =       0.000432692200
  error estimate for blocks of size 2^( 4) =       0.000445566898
  error estimate for blocks of size 2^( 5) =       0.000455852288
  error estimate for blocks of size 2^( 6) =       0.000465107511
  error estimate for blocks of size 2^( 7) =       0.000470120347

      target function =                  N/A
              le_mean =     -16.905701359304
             les_mean =     286.135452089780
             stat err =       0.000459161761
             autocorr =       1.267332577721
              std dev =       0.576813493392
             le_variance =       0.332713806159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332645335419
                                         uncertainty =       0.003743224306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332645335419
                                         uncertainty =       0.003743224306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407819454
  error estimate for blocks of size 2^( 2) =       0.000420379320
  error estimate for blocks of size 2^( 3) =       0.000432640604
  error estimate for blocks of size 2^( 4) =       0.000445517601
  error estimate for blocks of size 2^( 5) =       0.000455812831
  error estimate for blocks of size 2^( 6) =       0.000465077147
  error estimate for blocks of size 2^( 7) =       0.000470119428

      target function =                  N/A
              le_mean =     -16.905698217815
             les_mean =     286.135265479843
             stat err =       0.000459131752
             autocorr =       1.267473178054
              std dev =       0.576743803013
             le_variance =       0.332633414313


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905697870170        initial
     3.7253e-02     3.7253e-01             6.2969e-03       -16.905700786108
     1.4901e-01     1.4901e+00             1.6127e-03       -16.905701359304  <--
     5.9605e-01     5.9605e+00             3.9922e-04       -16.905698217815

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 2.9979e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.095180e-01 1 1  ON 0
 uu_1                 1.426134e-01 1 1  ON 1
 uu_2                 4.075712e-02 1 1  ON 2
 uu_3                -2.192176e-02 1 1  ON 3
 uu_4                -6.789519e-02 1 1  ON 4
 uu_5                -1.031888e-01 1 1  ON 5
 uu_6                -1.316319e-01 1 1  ON 6
 uu_7                -1.460912e-01 1 1  ON 7
 uu_8                -1.390775e-01 1 1  ON 8
 uu_9                -1.111898e-01 1 1  ON 9
 ud_0                 4.545925e-01 1 1  ON 10
 ud_1                 1.880148e-01 1 1  ON 11
 ud_2                 6.646603e-02 1 1  ON 12
 ud_3                -5.659638e-03 1 1  ON 13
 ud_4                -6.327052e-02 1 1  ON 14
 ud_5                -1.055989e-01 1 1  ON 15
 ud_6                -1.337132e-01 1 1  ON 16
 ud_7                -1.515898e-01 1 1  ON 17
 ud_8                -1.531810e-01 1 1  ON 18
 ud_9                -1.455877e-01 1 1  ON 19
 eO_0                -7.642997e-01 1 1  ON 20
 eO_1                -4.409076e-01 1 1  ON 21
 eO_2                -1.727437e-02 1 1  ON 22
 eO_3                 3.069115e-01 1 1  ON 23
 eO_4                 5.353341e-01 1 1  ON 24
 eO_5                 4.991927e-01 1 1  ON 25
 eO_6                 2.693954e-01 1 1  ON 26
 eO_7                -3.700546e-02 1 1  ON 27
 eO_8                -2.392321e-01 1 1  ON 28
 eO_9                -1.073056e-01 1 1  ON 29
eH1_0                -2.554750e-01 1 1  ON 30
eH1_1                -1.538010e-01 1 1  ON 31
eH1_2                -1.066389e-01 1 1  ON 32
eH1_3                -5.186286e-02 1 1  ON 33
eH1_4                -3.345187e-03 1 1  ON 34
eH1_5                 3.232674e-02 1 1  ON 35
eH1_6                 9.351340e-02 1 1  ON 36
eH1_7                 1.549185e-01 1 1  ON 37
eH1_8                 1.944931e-01 1 1  ON 38
eH1_9                 9.519188e-02 1 1  ON 39
eH2_0                -2.525000e-01 1 1  ON 40
eH2_1                -1.512080e-01 1 1  ON 41
eH2_2                -1.037586e-01 1 1  ON 42
eH2_3                -4.917814e-02 1 1  ON 43
eH2_4                -9.033191e-04 1 1  ON 44
eH2_5                 3.398515e-02 1 1  ON 45
eH2_6                 9.533459e-02 1 1  ON 46
eH2_7                 1.555807e-01 1 1  ON 47
eH2_8                 1.975689e-01 1 1  ON 48
eH2_9                 8.838982e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8378e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8283
    reference variance = 0.252985
====================================================
  Execution time = 2.0330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5048e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350508731445
                                         uncertainty =       0.006647444722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350508731445
                                         uncertainty =       0.006647444722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418615513
  error estimate for blocks of size 2^( 2) =       0.000431307453
  error estimate for blocks of size 2^( 3) =       0.000444301693
  error estimate for blocks of size 2^( 4) =       0.000456923579
  error estimate for blocks of size 2^( 5) =       0.000468758664
  error estimate for blocks of size 2^( 6) =       0.000477972273
  error estimate for blocks of size 2^( 7) =       0.000482277594

      target function =                  N/A
              le_mean =     -16.904992497267
             les_mean =     286.129249053625
             stat err =       0.000471483028
             autocorr =       1.268532183345
              std dev =       0.592011736557
             le_variance =       0.350477896221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690499249727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904992497267       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904991935057       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904993830414       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904996380026       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904997883579       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904998054922       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904997608861       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904995655394       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904997604110       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904998099244       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904998328567       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904998483038       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904999636035       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904999204824       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-02 is 6.140542e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904992497267       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904992120955       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904993152294       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904994948755       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904994746497       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904994979732       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904994086165       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904994099217       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904994413239       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904994795273       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904994621464       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904994581933       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 1.627195e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904992497267       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904992335246       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904992697339       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904993202710       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904993254134       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904993390000       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904992980068       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904992991008       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904993103138       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.989877e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145291 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5972e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.095244e-01 1 1  ON 0
 uu_1                 1.421970e-01 1 1  ON 1
 uu_2                 4.053944e-02 1 1  ON 2
 uu_3                -2.215489e-02 1 1  ON 3
 uu_4                -6.811955e-02 1 1  ON 4
 uu_5                -1.033519e-01 1 1  ON 5
 uu_6                -1.314581e-01 1 1  ON 6
 uu_7                -1.461181e-01 1 1  ON 7
 uu_8                -1.389898e-01 1 1  ON 8
 uu_9                -1.112863e-01 1 1  ON 9
 ud_0                 4.543823e-01 1 1  ON 10
 ud_1                 1.880186e-01 1 1  ON 11
 ud_2                 6.624935e-02 1 1  ON 12
 ud_3                -6.008427e-03 1 1  ON 13
 ud_4                -6.355395e-02 1 1  ON 14
 ud_5                -1.060575e-01 1 1  ON 15
 ud_6                -1.341635e-01 1 1  ON 16
 ud_7                -1.520718e-01 1 1  ON 17
 ud_8                -1.524087e-01 1 1  ON 18
 ud_9                -1.442488e-01 1 1  ON 19
 eO_0                -7.642503e-01 1 1  ON 20
 eO_1                -4.407771e-01 1 1  ON 21
 eO_2                -1.717387e-02 1 1  ON 22
 eO_3                 3.071863e-01 1 1  ON 23
 eO_4                 5.354839e-01 1 1  ON 24
 eO_5                 4.993364e-01 1 1  ON 25
 eO_6                 2.696522e-01 1 1  ON 26
 eO_7                -3.725359e-02 1 1  ON 27
 eO_8                -2.393151e-01 1 1  ON 28
 eO_9                -1.079757e-01 1 1  ON 29
eH1_0                -2.557298e-01 1 1  ON 30
eH1_1                -1.542486e-01 1 1  ON 31
eH1_2                -1.068710e-01 1 1  ON 32
eH1_3                -5.214638e-02 1 1  ON 33
eH1_4                -3.543315e-03 1 1  ON 34
eH1_5                 3.169821e-02 1 1  ON 35
eH1_6                 9.371916e-02 1 1  ON 36
eH1_7                 1.554805e-01 1 1  ON 37
eH1_8                 1.948225e-01 1 1  ON 38
eH1_9                 9.607176e-02 1 1  ON 39
eH2_0                -2.529056e-01 1 1  ON 40
eH2_1                -1.516106e-01 1 1  ON 41
eH2_2                -1.041006e-01 1 1  ON 42
eH2_3                -4.959151e-02 1 1  ON 43
eH2_4                -1.112818e-03 1 1  ON 44
eH2_5                 3.363131e-02 1 1  ON 45
eH2_6                 9.545817e-02 1 1  ON 46
eH2_7                 1.552999e-01 1 1  ON 47
eH2_8                 1.977545e-01 1 1  ON 48
eH2_9                 9.001702e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9174
    reference variance = 0.286206
====================================================
  Execution time = 1.9930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3980e-01
  Total weights = 2.0000e+06
  Execution time = 1.8922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339700834083
                                         uncertainty =       0.003783152231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339700834083
                                         uncertainty =       0.003783152231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412199162
  error estimate for blocks of size 2^( 2) =       0.000424557292
  error estimate for blocks of size 2^( 3) =       0.000437323744
  error estimate for blocks of size 2^( 4) =       0.000449536783
  error estimate for blocks of size 2^( 5) =       0.000460620982
  error estimate for blocks of size 2^( 6) =       0.000468242261
  error estimate for blocks of size 2^( 7) =       0.000472330266

      target function =                  N/A
              le_mean =     -16.906299370112
             les_mean =     286.162774520586
             stat err =       0.000462682573
             autocorr =       1.259946413512
              std dev =       0.582937645576
             le_variance =       0.339816298630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339804006170
                                         uncertainty =       0.003780961032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339804006170
                                         uncertainty =       0.003780961032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412261911
  error estimate for blocks of size 2^( 2) =       0.000424631757
  error estimate for blocks of size 2^( 3) =       0.000437405122
  error estimate for blocks of size 2^( 4) =       0.000449622736
  error estimate for blocks of size 2^( 5) =       0.000460702660
  error estimate for blocks of size 2^( 6) =       0.000468313411
  error estimate for blocks of size 2^( 7) =       0.000472405110

      target function =                  N/A
              le_mean =     -16.906297054625
             les_mean =     286.162799696408
             stat err =       0.000462760979
             autocorr =       1.259989823695
              std dev =       0.583026386328
             le_variance =       0.339919767154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339673480161
                                         uncertainty =       0.003777919773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339673480161
                                         uncertainty =       0.003777919773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412182703
  error estimate for blocks of size 2^( 2) =       0.000424553593
  error estimate for blocks of size 2^( 3) =       0.000437326568
  error estimate for blocks of size 2^( 4) =       0.000449547458
  error estimate for blocks of size 2^( 5) =       0.000460630132
  error estimate for blocks of size 2^( 6) =       0.000468245140
  error estimate for blocks of size 2^( 7) =       0.000472330115

      target function =                  N/A
              le_mean =     -16.906296278435
             les_mean =     286.162642846054
             stat err =       0.000462688211
             autocorr =       1.260077748426
              std dev =       0.582914369105
             le_variance =       0.339789161709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669797355
                                         uncertainty =       0.003781607365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669797355
                                         uncertainty =       0.003781607365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412180351
  error estimate for blocks of size 2^( 2) =       0.000424541290
  error estimate for blocks of size 2^( 3) =       0.000437308953
  error estimate for blocks of size 2^( 4) =       0.000449523948
  error estimate for blocks of size 2^( 5) =       0.000460608079
  error estimate for blocks of size 2^( 6) =       0.000468229089
  error estimate for blocks of size 2^( 7) =       0.000472315521

      target function =                  N/A
              le_mean =     -16.906298349741
             les_mean =     286.162709004144
             stat err =       0.000462669159
             autocorr =       1.259988359930
              std dev =       0.582911042604
             le_variance =       0.339785283589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906299370112        initial  <--
     3.7253e-02     3.7253e-01             6.1405e-03       -16.906297054625
     1.4901e-01     1.4901e+00             1.6272e-03       -16.906296278435
     5.9605e-01     5.9605e+00             3.9899e-04       -16.906298349741

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4350
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.095180e-01 1 1  ON 0
 uu_1                 1.426134e-01 1 1  ON 1
 uu_2                 4.075712e-02 1 1  ON 2
 uu_3                -2.192176e-02 1 1  ON 3
 uu_4                -6.789519e-02 1 1  ON 4
 uu_5                -1.031888e-01 1 1  ON 5
 uu_6                -1.316319e-01 1 1  ON 6
 uu_7                -1.460912e-01 1 1  ON 7
 uu_8                -1.390775e-01 1 1  ON 8
 uu_9                -1.111898e-01 1 1  ON 9
 ud_0                 4.545925e-01 1 1  ON 10
 ud_1                 1.880148e-01 1 1  ON 11
 ud_2                 6.646603e-02 1 1  ON 12
 ud_3                -5.659638e-03 1 1  ON 13
 ud_4                -6.327052e-02 1 1  ON 14
 ud_5                -1.055989e-01 1 1  ON 15
 ud_6                -1.337132e-01 1 1  ON 16
 ud_7                -1.515898e-01 1 1  ON 17
 ud_8                -1.531810e-01 1 1  ON 18
 ud_9                -1.455877e-01 1 1  ON 19
 eO_0                -7.642997e-01 1 1  ON 20
 eO_1                -4.409076e-01 1 1  ON 21
 eO_2                -1.727437e-02 1 1  ON 22
 eO_3                 3.069115e-01 1 1  ON 23
 eO_4                 5.353341e-01 1 1  ON 24
 eO_5                 4.991927e-01 1 1  ON 25
 eO_6                 2.693954e-01 1 1  ON 26
 eO_7                -3.700546e-02 1 1  ON 27
 eO_8                -2.392321e-01 1 1  ON 28
 eO_9                -1.073056e-01 1 1  ON 29
eH1_0                -2.554750e-01 1 1  ON 30
eH1_1                -1.538010e-01 1 1  ON 31
eH1_2                -1.066389e-01 1 1  ON 32
eH1_3                -5.186286e-02 1 1  ON 33
eH1_4                -3.345187e-03 1 1  ON 34
eH1_5                 3.232674e-02 1 1  ON 35
eH1_6                 9.351340e-02 1 1  ON 36
eH1_7                 1.549185e-01 1 1  ON 37
eH1_8                 1.944931e-01 1 1  ON 38
eH1_9                 9.519188e-02 1 1  ON 39
eH2_0                -2.525000e-01 1 1  ON 40
eH2_1                -1.512080e-01 1 1  ON 41
eH2_2                -1.037586e-01 1 1  ON 42
eH2_3                -4.917814e-02 1 1  ON 43
eH2_4                -9.033191e-04 1 1  ON 44
eH2_5                 3.398515e-02 1 1  ON 45
eH2_6                 9.533459e-02 1 1  ON 46
eH2_7                 1.555807e-01 1 1  ON 47
eH2_8                 1.975689e-01 1 1  ON 48
eH2_9                 8.838982e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9
    reference variance = 0.357598
====================================================
  Execution time = 2.0438e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3789e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337795546656
                                         uncertainty =       0.003736942122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337795546656
                                         uncertainty =       0.003736942122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411027116
  error estimate for blocks of size 2^( 2) =       0.000423938058
  error estimate for blocks of size 2^( 3) =       0.000436603967
  error estimate for blocks of size 2^( 4) =       0.000449461004
  error estimate for blocks of size 2^( 5) =       0.000460395504
  error estimate for blocks of size 2^( 6) =       0.000468258271
  error estimate for blocks of size 2^( 7) =       0.000472550881

      target function =                  N/A
              le_mean =     -16.905730080147
             les_mean =     286.141595953868
             stat err =       0.000462666415
             autocorr =       1.267053646911
              std dev =       0.581280121810
             le_variance =       0.337886580011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573008015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905730080147       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905729973120       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905729591089       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905729925545       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905728904983       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905729386280       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905729500612       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905729654411       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905729692392       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 4.927852e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905730080147       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905730045942       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905729936740       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905730045220       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905729665735       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905729789480       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905729772498       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905729806166       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.547484e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905730080147       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905730070956       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905730042931       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905730073044       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905729964977       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905729996108       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905729986620       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905729991984       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.154121e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6019e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.094931e-01 1 1  ON 0
 uu_1                 1.426020e-01 1 1  ON 1
 uu_2                 4.077143e-02 1 1  ON 2
 uu_3                -2.194895e-02 1 1  ON 3
 uu_4                -6.787984e-02 1 1  ON 4
 uu_5                -1.032059e-01 1 1  ON 5
 uu_6                -1.315956e-01 1 1  ON 6
 uu_7                -1.461106e-01 1 1  ON 7
 uu_8                -1.390778e-01 1 1  ON 8
 uu_9                -1.112106e-01 1 1  ON 9
 ud_0                 4.546067e-01 1 1  ON 10
 ud_1                 1.880506e-01 1 1  ON 11
 ud_2                 6.650316e-02 1 1  ON 12
 ud_3                -5.610413e-03 1 1  ON 13
 ud_4                -6.329085e-02 1 1  ON 14
 ud_5                -1.054996e-01 1 1  ON 15
 ud_6                -1.337318e-01 1 1  ON 16
 ud_7                -1.516132e-01 1 1  ON 17
 ud_8                -1.531913e-01 1 1  ON 18
 ud_9                -1.456803e-01 1 1  ON 19
 eO_0                -7.642483e-01 1 1  ON 20
 eO_1                -4.409112e-01 1 1  ON 21
 eO_2                -1.723126e-02 1 1  ON 22
 eO_3                 3.069118e-01 1 1  ON 23
 eO_4                 5.353240e-01 1 1  ON 24
 eO_5                 4.992490e-01 1 1  ON 25
 eO_6                 2.694484e-01 1 1  ON 26
 eO_7                -3.701040e-02 1 1  ON 27
 eO_8                -2.392905e-01 1 1  ON 28
 eO_9                -1.074080e-01 1 1  ON 29
eH1_0                -2.555442e-01 1 1  ON 30
eH1_1                -1.539557e-01 1 1  ON 31
eH1_2                -1.066372e-01 1 1  ON 32
eH1_3                -5.190493e-02 1 1  ON 33
eH1_4                -3.310380e-03 1 1  ON 34
eH1_5                 3.236868e-02 1 1  ON 35
eH1_6                 9.351043e-02 1 1  ON 36
eH1_7                 1.549448e-01 1 1  ON 37
eH1_8                 1.945392e-01 1 1  ON 38
eH1_9                 9.529647e-02 1 1  ON 39
eH2_0                -2.525363e-01 1 1  ON 40
eH2_1                -1.512088e-01 1 1  ON 41
eH2_2                -1.037669e-01 1 1  ON 42
eH2_3                -4.924214e-02 1 1  ON 43
eH2_4                -8.897769e-04 1 1  ON 44
eH2_5                 3.399259e-02 1 1  ON 45
eH2_6                 9.531038e-02 1 1  ON 46
eH2_7                 1.555575e-01 1 1  ON 47
eH2_8                 1.975720e-01 1 1  ON 48
eH2_9                 8.851108e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8355
    reference variance = 1.63795
====================================================
  Execution time = 1.9956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5008e-01
  Total weights = 2.0000e+06
  Execution time = 1.9017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350123364169
                                         uncertainty =       0.007335702741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350123364169
                                         uncertainty =       0.007335702741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418407639
  error estimate for blocks of size 2^( 2) =       0.000431349141
  error estimate for blocks of size 2^( 3) =       0.000443782543
  error estimate for blocks of size 2^( 4) =       0.000455907769
  error estimate for blocks of size 2^( 5) =       0.000466418581
  error estimate for blocks of size 2^( 6) =       0.000476272792
  error estimate for blocks of size 2^( 7) =       0.000481053781

      target function =                  N/A
              le_mean =     -16.906074380663
             les_mean =     286.165480694176
             stat err =       0.000469913231
             autocorr =       1.261351523173
              std dev =       0.591717757651
             le_variance =       0.350129904720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350016006788
                                         uncertainty =       0.007334117793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350016006788
                                         uncertainty =       0.007334117793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418343500
  error estimate for blocks of size 2^( 2) =       0.000431286662
  error estimate for blocks of size 2^( 3) =       0.000443723240
  error estimate for blocks of size 2^( 4) =       0.000455851181
  error estimate for blocks of size 2^( 5) =       0.000466361051
  error estimate for blocks of size 2^( 6) =       0.000476217239
  error estimate for blocks of size 2^( 7) =       0.000481005659

      target function =                  N/A
              le_mean =     -16.906072766676
             les_mean =     286.165318784373
             stat err =       0.000469858782
             autocorr =       1.261445952834
              std dev =       0.591627050802
             le_variance =       0.350022567241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350029470919
                                         uncertainty =       0.007334381635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350029470919
                                         uncertainty =       0.007334381635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418351547
  error estimate for blocks of size 2^( 2) =       0.000431294607
  error estimate for blocks of size 2^( 3) =       0.000443730983
  error estimate for blocks of size 2^( 4) =       0.000455858612
  error estimate for blocks of size 2^( 5) =       0.000466368808
  error estimate for blocks of size 2^( 6) =       0.000476224441
  error estimate for blocks of size 2^( 7) =       0.000481011662

      target function =                  N/A
              le_mean =     -16.906072947531
             les_mean =     286.165338365443
             stat err =       0.000469865881
             autocorr =       1.261435537712
              std dev =       0.591638431168
             le_variance =       0.350036033235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350109831944
                                         uncertainty =       0.007335505460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350109831944
                                         uncertainty =       0.007335505460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418399555
  error estimate for blocks of size 2^( 2) =       0.000431341281
  error estimate for blocks of size 2^( 3) =       0.000443775124
  error estimate for blocks of size 2^( 4) =       0.000455900706
  error estimate for blocks of size 2^( 5) =       0.000466411417
  error estimate for blocks of size 2^( 6) =       0.000476265842
  error estimate for blocks of size 2^( 7) =       0.000481047733

      target function =                  N/A
              le_mean =     -16.906074148634
             les_mean =     286.165459319651
             stat err =       0.000469906425
             autocorr =       1.261363724892
              std dev =       0.591706325454
             le_variance =       0.350116375582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906074380663        initial  <--
     3.7253e-01     3.7253e+00             4.9279e-04       -16.906072766676
     1.4901e+00     1.4901e+01             1.5475e-04       -16.906072947531
     5.9605e+00     5.9605e+01             4.1541e-05       -16.906074148634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5164
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.095180e-01 1 1  ON 0
 uu_1                 1.426134e-01 1 1  ON 1
 uu_2                 4.075712e-02 1 1  ON 2
 uu_3                -2.192176e-02 1 1  ON 3
 uu_4                -6.789519e-02 1 1  ON 4
 uu_5                -1.031888e-01 1 1  ON 5
 uu_6                -1.316319e-01 1 1  ON 6
 uu_7                -1.460912e-01 1 1  ON 7
 uu_8                -1.390775e-01 1 1  ON 8
 uu_9                -1.111898e-01 1 1  ON 9
 ud_0                 4.545925e-01 1 1  ON 10
 ud_1                 1.880148e-01 1 1  ON 11
 ud_2                 6.646603e-02 1 1  ON 12
 ud_3                -5.659638e-03 1 1  ON 13
 ud_4                -6.327052e-02 1 1  ON 14
 ud_5                -1.055989e-01 1 1  ON 15
 ud_6                -1.337132e-01 1 1  ON 16
 ud_7                -1.515898e-01 1 1  ON 17
 ud_8                -1.531810e-01 1 1  ON 18
 ud_9                -1.455877e-01 1 1  ON 19
 eO_0                -7.642997e-01 1 1  ON 20
 eO_1                -4.409076e-01 1 1  ON 21
 eO_2                -1.727437e-02 1 1  ON 22
 eO_3                 3.069115e-01 1 1  ON 23
 eO_4                 5.353341e-01 1 1  ON 24
 eO_5                 4.991927e-01 1 1  ON 25
 eO_6                 2.693954e-01 1 1  ON 26
 eO_7                -3.700546e-02 1 1  ON 27
 eO_8                -2.392321e-01 1 1  ON 28
 eO_9                -1.073056e-01 1 1  ON 29
eH1_0                -2.554750e-01 1 1  ON 30
eH1_1                -1.538010e-01 1 1  ON 31
eH1_2                -1.066389e-01 1 1  ON 32
eH1_3                -5.186286e-02 1 1  ON 33
eH1_4                -3.345187e-03 1 1  ON 34
eH1_5                 3.232674e-02 1 1  ON 35
eH1_6                 9.351340e-02 1 1  ON 36
eH1_7                 1.549185e-01 1 1  ON 37
eH1_8                 1.944931e-01 1 1  ON 38
eH1_9                 9.519188e-02 1 1  ON 39
eH2_0                -2.525000e-01 1 1  ON 40
eH2_1                -1.512080e-01 1 1  ON 41
eH2_2                -1.037586e-01 1 1  ON 42
eH2_3                -4.917814e-02 1 1  ON 43
eH2_4                -9.033191e-04 1 1  ON 44
eH2_5                 3.398515e-02 1 1  ON 45
eH2_6                 9.533459e-02 1 1  ON 46
eH2_7                 1.555807e-01 1 1  ON 47
eH2_8                 1.975689e-01 1 1  ON 48
eH2_9                 8.838982e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8985
    reference variance = 0.613577
====================================================
  Execution time = 2.0182e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4185e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341828758284
                                         uncertainty =       0.006242518947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341828758284
                                         uncertainty =       0.006242518947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413432295
  error estimate for blocks of size 2^( 2) =       0.000426103705
  error estimate for blocks of size 2^( 3) =       0.000438701665
  error estimate for blocks of size 2^( 4) =       0.000451257580
  error estimate for blocks of size 2^( 5) =       0.000461598528
  error estimate for blocks of size 2^( 6) =       0.000468040089
  error estimate for blocks of size 2^( 7) =       0.000471280411

      target function =                  N/A
              le_mean =     -16.906361984272
             les_mean =     286.166927896987
             stat err =       0.000463044152
             autocorr =       1.254399903061
              std dev =       0.584681558348
             le_variance =       0.341852524672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636198427e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361984272       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362128779       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906362204205       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906362250954       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906362195771       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906362144550       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362171565       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906362188507       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 6.482865e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361984272       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362021386       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906362042151       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906362057880       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906362040426       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906362028975       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362034621       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.560043e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361984272       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361993614       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361998939       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906362003151       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361998560       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361995787       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361997124       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.907523e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5811e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.095217e-01 1 1  ON 0
 uu_1                 1.426140e-01 1 1  ON 1
 uu_2                 4.076027e-02 1 1  ON 2
 uu_3                -2.192437e-02 1 1  ON 3
 uu_4                -6.789596e-02 1 1  ON 4
 uu_5                -1.031884e-01 1 1  ON 5
 uu_6                -1.316393e-01 1 1  ON 6
 uu_7                -1.460984e-01 1 1  ON 7
 uu_8                -1.390783e-01 1 1  ON 8
 uu_9                -1.111901e-01 1 1  ON 9
 ud_0                 4.545886e-01 1 1  ON 10
 ud_1                 1.880147e-01 1 1  ON 11
 ud_2                 6.647090e-02 1 1  ON 12
 ud_3                -5.660577e-03 1 1  ON 13
 ud_4                -6.327372e-02 1 1  ON 14
 ud_5                -1.055951e-01 1 1  ON 15
 ud_6                -1.337166e-01 1 1  ON 16
 ud_7                -1.515886e-01 1 1  ON 17
 ud_8                -1.531788e-01 1 1  ON 18
 ud_9                -1.455835e-01 1 1  ON 19
 eO_0                -7.642951e-01 1 1  ON 20
 eO_1                -4.409130e-01 1 1  ON 21
 eO_2                -1.727069e-02 1 1  ON 22
 eO_3                 3.069148e-01 1 1  ON 23
 eO_4                 5.353404e-01 1 1  ON 24
 eO_5                 4.991906e-01 1 1  ON 25
 eO_6                 2.693988e-01 1 1  ON 26
 eO_7                -3.700633e-02 1 1  ON 27
 eO_8                -2.392351e-01 1 1  ON 28
 eO_9                -1.073136e-01 1 1  ON 29
eH1_0                -2.554749e-01 1 1  ON 30
eH1_1                -1.538084e-01 1 1  ON 31
eH1_2                -1.066358e-01 1 1  ON 32
eH1_3                -5.186767e-02 1 1  ON 33
eH1_4                -3.345229e-03 1 1  ON 34
eH1_5                 3.232472e-02 1 1  ON 35
eH1_6                 9.351046e-02 1 1  ON 36
eH1_7                 1.549158e-01 1 1  ON 37
eH1_8                 1.944958e-01 1 1  ON 38
eH1_9                 9.520392e-02 1 1  ON 39
eH2_0                -2.525007e-01 1 1  ON 40
eH2_1                -1.512057e-01 1 1  ON 41
eH2_2                -1.037644e-01 1 1  ON 42
eH2_3                -4.917953e-02 1 1  ON 43
eH2_4                -9.111896e-04 1 1  ON 44
eH2_5                 3.397410e-02 1 1  ON 45
eH2_6                 9.533368e-02 1 1  ON 46
eH2_7                 1.555824e-01 1 1  ON 47
eH2_8                 1.975737e-01 1 1  ON 48
eH2_9                 8.840543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8873
    reference variance = 0.310095
====================================================
  Execution time = 1.9908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4264e-01
  Total weights = 2.0000e+06
  Execution time = 1.9013e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341551671705
                                         uncertainty =       0.003979881852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341551671705
                                         uncertainty =       0.003979881852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413914868
  error estimate for blocks of size 2^( 2) =       0.000426759305
  error estimate for blocks of size 2^( 3) =       0.000440090947
  error estimate for blocks of size 2^( 4) =       0.000452560246
  error estimate for blocks of size 2^( 5) =       0.000461981639
  error estimate for blocks of size 2^( 6) =       0.000472348631
  error estimate for blocks of size 2^( 7) =       0.000477045545

      target function =                  N/A
              le_mean =     -16.906265213348
             les_mean =     286.164454328420
             stat err =       0.000465984015
             autocorr =       1.267418335099
              std dev =       0.585364019814
             le_variance =       0.342651035693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341527923221
                                         uncertainty =       0.003979342598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341527923221
                                         uncertainty =       0.003979342598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413900383
  error estimate for blocks of size 2^( 2) =       0.000426745801
  error estimate for blocks of size 2^( 3) =       0.000440078132
  error estimate for blocks of size 2^( 4) =       0.000452548038
  error estimate for blocks of size 2^( 5) =       0.000461970333
  error estimate for blocks of size 2^( 6) =       0.000472337806
  error estimate for blocks of size 2^( 7) =       0.000477035104

      target function =                  N/A
              le_mean =     -16.906265189085
             les_mean =     286.164429526919
             stat err =       0.000465972820
             autocorr =       1.267446140888
              std dev =       0.585343535513
             le_variance =       0.342627054567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341539129916
                                         uncertainty =       0.003979592650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341539129916
                                         uncertainty =       0.003979592650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413907207
  error estimate for blocks of size 2^( 2) =       0.000426752168
  error estimate for blocks of size 2^( 3) =       0.000440084192
  error estimate for blocks of size 2^( 4) =       0.000452553823
  error estimate for blocks of size 2^( 5) =       0.000461975738
  error estimate for blocks of size 2^( 6) =       0.000472343008
  error estimate for blocks of size 2^( 7) =       0.000477040129

      target function =                  N/A
              le_mean =     -16.906265204485
             les_mean =     286.164441344767
             stat err =       0.000465978175
             autocorr =       1.267433479271
              std dev =       0.585353185436
             le_variance =       0.342638351700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341550064323
                                         uncertainty =       0.003979844801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341550064323
                                         uncertainty =       0.003979844801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413913886
  error estimate for blocks of size 2^( 2) =       0.000426758391
  error estimate for blocks of size 2^( 3) =       0.000440090082
  error estimate for blocks of size 2^( 4) =       0.000452559423
  error estimate for blocks of size 2^( 5) =       0.000461980883
  error estimate for blocks of size 2^( 6) =       0.000472347909
  error estimate for blocks of size 2^( 7) =       0.000477044850

      target function =                  N/A
              le_mean =     -16.906265211959
             les_mean =     286.164452656021
             stat err =       0.000465983266
             autocorr =       1.267420272661
              std dev =       0.585362631420
             le_variance =       0.342649410263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906265213348        initial  <--
     3.7253e+00     3.7253e+01             6.4829e-05       -16.906265189085
     1.4901e+01     1.4901e+02             1.5600e-05       -16.906265204485
     5.9605e+01     5.9605e+02             3.9075e-06       -16.906265211959

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4595
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.095180e-01 1 1  ON 0
 uu_1                 1.426134e-01 1 1  ON 1
 uu_2                 4.075712e-02 1 1  ON 2
 uu_3                -2.192176e-02 1 1  ON 3
 uu_4                -6.789519e-02 1 1  ON 4
 uu_5                -1.031888e-01 1 1  ON 5
 uu_6                -1.316319e-01 1 1  ON 6
 uu_7                -1.460912e-01 1 1  ON 7
 uu_8                -1.390775e-01 1 1  ON 8
 uu_9                -1.111898e-01 1 1  ON 9
 ud_0                 4.545925e-01 1 1  ON 10
 ud_1                 1.880148e-01 1 1  ON 11
 ud_2                 6.646603e-02 1 1  ON 12
 ud_3                -5.659638e-03 1 1  ON 13
 ud_4                -6.327052e-02 1 1  ON 14
 ud_5                -1.055989e-01 1 1  ON 15
 ud_6                -1.337132e-01 1 1  ON 16
 ud_7                -1.515898e-01 1 1  ON 17
 ud_8                -1.531810e-01 1 1  ON 18
 ud_9                -1.455877e-01 1 1  ON 19
 eO_0                -7.642997e-01 1 1  ON 20
 eO_1                -4.409076e-01 1 1  ON 21
 eO_2                -1.727437e-02 1 1  ON 22
 eO_3                 3.069115e-01 1 1  ON 23
 eO_4                 5.353341e-01 1 1  ON 24
 eO_5                 4.991927e-01 1 1  ON 25
 eO_6                 2.693954e-01 1 1  ON 26
 eO_7                -3.700546e-02 1 1  ON 27
 eO_8                -2.392321e-01 1 1  ON 28
 eO_9                -1.073056e-01 1 1  ON 29
eH1_0                -2.554750e-01 1 1  ON 30
eH1_1                -1.538010e-01 1 1  ON 31
eH1_2                -1.066389e-01 1 1  ON 32
eH1_3                -5.186286e-02 1 1  ON 33
eH1_4                -3.345187e-03 1 1  ON 34
eH1_5                 3.232674e-02 1 1  ON 35
eH1_6                 9.351340e-02 1 1  ON 36
eH1_7                 1.549185e-01 1 1  ON 37
eH1_8                 1.944931e-01 1 1  ON 38
eH1_9                 9.519188e-02 1 1  ON 39
eH2_0                -2.525000e-01 1 1  ON 40
eH2_1                -1.512080e-01 1 1  ON 41
eH2_2                -1.037586e-01 1 1  ON 42
eH2_3                -4.917814e-02 1 1  ON 43
eH2_4                -9.033191e-04 1 1  ON 44
eH2_5                 3.398515e-02 1 1  ON 45
eH2_6                 9.533459e-02 1 1  ON 46
eH2_7                 1.555807e-01 1 1  ON 47
eH2_8                 1.975689e-01 1 1  ON 48
eH2_9                 8.838982e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5281e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8843
    reference variance = 0.341354
====================================================
  Execution time = 2.0283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4476e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344820779864
                                         uncertainty =       0.004680004515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344820779864
                                         uncertainty =       0.004680004515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415186910
  error estimate for blocks of size 2^( 2) =       0.000428407260
  error estimate for blocks of size 2^( 3) =       0.000441675497
  error estimate for blocks of size 2^( 4) =       0.000454057123
  error estimate for blocks of size 2^( 5) =       0.000463381806
  error estimate for blocks of size 2^( 6) =       0.000469849064
  error estimate for blocks of size 2^( 7) =       0.000474961862

      target function =                  N/A
              le_mean =     -16.905720301543
             les_mean =     286.148139082432
             stat err =       0.000465562464
             autocorr =       1.257385969495
              std dev =       0.587162959324
             le_variance =       0.344760340802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572030154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905720301543       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905720310114       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905720316368       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905720319745       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905720325333       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905720328491       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905720330242       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905720329438       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 4.736757e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905720301543       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905720303696       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905720305272       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905720306118       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905720307517       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905720308322       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905720308765       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905720308564       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.184594e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905720301543       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905720302082       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905720302477       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905720302688       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905720303038       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905720303241       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905720303352       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905720303301       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.961739e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153190 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5895e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.095182e-01 1 1  ON 0
 uu_1                 1.426131e-01 1 1  ON 1
 uu_2                 4.075692e-02 1 1  ON 2
 uu_3                -2.192222e-02 1 1  ON 3
 uu_4                -6.789538e-02 1 1  ON 4
 uu_5                -1.031884e-01 1 1  ON 5
 uu_6                -1.316319e-01 1 1  ON 6
 uu_7                -1.460916e-01 1 1  ON 7
 uu_8                -1.390777e-01 1 1  ON 8
 uu_9                -1.111900e-01 1 1  ON 9
 ud_0                 4.545920e-01 1 1  ON 10
 ud_1                 1.880155e-01 1 1  ON 11
 ud_2                 6.646649e-02 1 1  ON 12
 ud_3                -5.659485e-03 1 1  ON 13
 ud_4                -6.327073e-02 1 1  ON 14
 ud_5                -1.055981e-01 1 1  ON 15
 ud_6                -1.337143e-01 1 1  ON 16
 ud_7                -1.515897e-01 1 1  ON 17
 ud_8                -1.531811e-01 1 1  ON 18
 ud_9                -1.455876e-01 1 1  ON 19
 eO_0                -7.642991e-01 1 1  ON 20
 eO_1                -4.409080e-01 1 1  ON 21
 eO_2                -1.727427e-02 1 1  ON 22
 eO_3                 3.069117e-01 1 1  ON 23
 eO_4                 5.353342e-01 1 1  ON 24
 eO_5                 4.991930e-01 1 1  ON 25
 eO_6                 2.693962e-01 1 1  ON 26
 eO_7                -3.700543e-02 1 1  ON 27
 eO_8                -2.392328e-01 1 1  ON 28
 eO_9                -1.073064e-01 1 1  ON 29
eH1_0                -2.554756e-01 1 1  ON 30
eH1_1                -1.538019e-01 1 1  ON 31
eH1_2                -1.066388e-01 1 1  ON 32
eH1_3                -5.186389e-02 1 1  ON 33
eH1_4                -3.344582e-03 1 1  ON 34
eH1_5                 3.232678e-02 1 1  ON 35
eH1_6                 9.351330e-02 1 1  ON 36
eH1_7                 1.549186e-01 1 1  ON 37
eH1_8                 1.944938e-01 1 1  ON 38
eH1_9                 9.519296e-02 1 1  ON 39
eH2_0                -2.525003e-01 1 1  ON 40
eH2_1                -1.512085e-01 1 1  ON 41
eH2_2                -1.037590e-01 1 1  ON 42
eH2_3                -4.917863e-02 1 1  ON 43
eH2_4                -9.032167e-04 1 1  ON 44
eH2_5                 3.398558e-02 1 1  ON 45
eH2_6                 9.533417e-02 1 1  ON 46
eH2_7                 1.555804e-01 1 1  ON 47
eH2_8                 1.975692e-01 1 1  ON 48
eH2_9                 8.839101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.963
    reference variance = 0.226705
====================================================
  Execution time = 1.9927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4196e-01
  Total weights = 2.0000e+06
  Execution time = 1.8944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342076681584
                                         uncertainty =       0.006564358186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342076681584
                                         uncertainty =       0.006564358186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413498141
  error estimate for blocks of size 2^( 2) =       0.000426326170
  error estimate for blocks of size 2^( 3) =       0.000439435978
  error estimate for blocks of size 2^( 4) =       0.000451670220
  error estimate for blocks of size 2^( 5) =       0.000462611845
  error estimate for blocks of size 2^( 6) =       0.000469170593
  error estimate for blocks of size 2^( 7) =       0.000472835520

      target function =                  N/A
              le_mean =     -16.905986713047
             les_mean =     286.154347996122
             stat err =       0.000464072044
             autocorr =       1.259574012452
              std dev =       0.584774679168
             le_variance =       0.341961425396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072798662
                                         uncertainty =       0.006564309485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072798662
                                         uncertainty =       0.006564309485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413495794
  error estimate for blocks of size 2^( 2) =       0.000426323952
  error estimate for blocks of size 2^( 3) =       0.000439433873
  error estimate for blocks of size 2^( 4) =       0.000451668197
  error estimate for blocks of size 2^( 5) =       0.000462609907
  error estimate for blocks of size 2^( 6) =       0.000469168686
  error estimate for blocks of size 2^( 7) =       0.000472833692

      target function =                  N/A
              le_mean =     -16.905986736647
             les_mean =     286.154344912182
             stat err =       0.000464070120
             autocorr =       1.259577867555
              std dev =       0.584771359998
             le_variance =       0.341957543474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342074721180
                                         uncertainty =       0.006564333615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342074721180
                                         uncertainty =       0.006564333615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413496956
  error estimate for blocks of size 2^( 2) =       0.000426325050
  error estimate for blocks of size 2^( 3) =       0.000439434915
  error estimate for blocks of size 2^( 4) =       0.000451669198
  error estimate for blocks of size 2^( 5) =       0.000462610866
  error estimate for blocks of size 2^( 6) =       0.000469169630
  error estimate for blocks of size 2^( 7) =       0.000472834597

      target function =                  N/A
              le_mean =     -16.905986724907
             les_mean =     286.154346437257
             stat err =       0.000464071073
             autocorr =       1.259575958591
              std dev =       0.584773003395
             le_variance =       0.341959465500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342076435920
                                         uncertainty =       0.006564355108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342076435920
                                         uncertainty =       0.006564355108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413497993
  error estimate for blocks of size 2^( 2) =       0.000426326030
  error estimate for blocks of size 2^( 3) =       0.000439435844
  error estimate for blocks of size 2^( 4) =       0.000451670092
  error estimate for blocks of size 2^( 5) =       0.000462611722
  error estimate for blocks of size 2^( 6) =       0.000469170472
  error estimate for blocks of size 2^( 7) =       0.000472835405

      target function =                  N/A
              le_mean =     -16.905986714529
             les_mean =     286.154347800659
             stat err =       0.000464071923
             autocorr =       1.259574256312
              std dev =       0.584774469172
             le_variance =       0.341961179796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905986713047        initial
     3.7253e+01     3.7253e+02             4.7368e-06       -16.905986736647  <--
     1.4901e+02     1.4901e+03             1.1846e-06       -16.905986724907
     5.9605e+02     5.9605e+03             2.9617e-07       -16.905986714529

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 2.9454e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.095185e-01 1 1  ON 0
 uu_1                 1.426121e-01 1 1  ON 1
 uu_2                 4.075632e-02 1 1  ON 2
 uu_3                -2.192359e-02 1 1  ON 3
 uu_4                -6.789593e-02 1 1  ON 4
 uu_5                -1.031872e-01 1 1  ON 5
 uu_6                -1.316319e-01 1 1  ON 6
 uu_7                -1.460925e-01 1 1  ON 7
 uu_8                -1.390781e-01 1 1  ON 8
 uu_9                -1.111906e-01 1 1  ON 9
 ud_0                 4.545903e-01 1 1  ON 10
 ud_1                 1.880176e-01 1 1  ON 11
 ud_2                 6.646786e-02 1 1  ON 12
 ud_3                -5.659024e-03 1 1  ON 13
 ud_4                -6.327135e-02 1 1  ON 14
 ud_5                -1.055958e-01 1 1  ON 15
 ud_6                -1.337175e-01 1 1  ON 16
 ud_7                -1.515893e-01 1 1  ON 17
 ud_8                -1.531814e-01 1 1  ON 18
 ud_9                -1.455875e-01 1 1  ON 19
 eO_0                -7.642972e-01 1 1  ON 20
 eO_1                -4.409093e-01 1 1  ON 21
 eO_2                -1.727398e-02 1 1  ON 22
 eO_3                 3.069122e-01 1 1  ON 23
 eO_4                 5.353345e-01 1 1  ON 24
 eO_5                 4.991940e-01 1 1  ON 25
 eO_6                 2.693986e-01 1 1  ON 26
 eO_7                -3.700532e-02 1 1  ON 27
 eO_8                -2.392350e-01 1 1  ON 28
 eO_9                -1.073089e-01 1 1  ON 29
eH1_0                -2.554776e-01 1 1  ON 30
eH1_1                -1.538049e-01 1 1  ON 31
eH1_2                -1.066383e-01 1 1  ON 32
eH1_3                -5.186695e-02 1 1  ON 33
eH1_4                -3.342783e-03 1 1  ON 34
eH1_5                 3.232691e-02 1 1  ON 35
eH1_6                 9.351300e-02 1 1  ON 36
eH1_7                 1.549189e-01 1 1  ON 37
eH1_8                 1.944957e-01 1 1  ON 38
eH1_9                 9.519620e-02 1 1  ON 39
eH2_0                -2.525012e-01 1 1  ON 40
eH2_1                -1.512097e-01 1 1  ON 41
eH2_2                -1.037601e-01 1 1  ON 42
eH2_3                -4.918008e-02 1 1  ON 43
eH2_4                -9.029144e-04 1 1  ON 44
eH2_5                 3.398687e-02 1 1  ON 45
eH2_6                 9.533292e-02 1 1  ON 46
eH2_7                 1.555797e-01 1 1  ON 47
eH2_8                 1.975701e-01 1 1  ON 48
eH2_9                 8.839456e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9177
    reference variance = 0.414966
====================================================
  Execution time = 2.0378e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4752e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347408774422
                                         uncertainty =       0.004460070505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347408774422
                                         uncertainty =       0.004460070505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416843497
  error estimate for blocks of size 2^( 2) =       0.000429712834
  error estimate for blocks of size 2^( 3) =       0.000443366160
  error estimate for blocks of size 2^( 4) =       0.000455797124
  error estimate for blocks of size 2^( 5) =       0.000467858041
  error estimate for blocks of size 2^( 6) =       0.000476423418
  error estimate for blocks of size 2^( 7) =       0.000483353770

      target function =                  N/A
              le_mean =     -16.905941392379
             les_mean =     286.158371190134
             stat err =       0.000470858088
             autocorr =       1.275951037323
              std dev =       0.589505726284
             le_variance =       0.347517001322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594139238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941392379       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905941460356       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905941420237       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905941451161       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905941583581       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905941611290       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905941596495       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905941588504       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.790427e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941392379       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905941409491       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905941399188       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905941406939       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905941440202       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905941447562       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905941444208       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905941442074       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 6.982534e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941392379       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905941396665       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905941394071       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905941396010       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905941404335       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905941406203       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905941405388       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905941404848       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.746101e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165496 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9311e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.095180e-01 1 1  ON 0
 uu_1                 1.426088e-01 1 1  ON 1
 uu_2                 4.075455e-02 1 1  ON 2
 uu_3                -2.192820e-02 1 1  ON 3
 uu_4                -6.789695e-02 1 1  ON 4
 uu_5                -1.031869e-01 1 1  ON 5
 uu_6                -1.316359e-01 1 1  ON 6
 uu_7                -1.460967e-01 1 1  ON 7
 uu_8                -1.390736e-01 1 1  ON 8
 uu_9                -1.111853e-01 1 1  ON 9
 ud_0                 4.545854e-01 1 1  ON 10
 ud_1                 1.880168e-01 1 1  ON 11
 ud_2                 6.646747e-02 1 1  ON 12
 ud_3                -5.659591e-03 1 1  ON 13
 ud_4                -6.327552e-02 1 1  ON 14
 ud_5                -1.055951e-01 1 1  ON 15
 ud_6                -1.337202e-01 1 1  ON 16
 ud_7                -1.515896e-01 1 1  ON 17
 ud_8                -1.531759e-01 1 1  ON 18
 ud_9                -1.455821e-01 1 1  ON 19
 eO_0                -7.642956e-01 1 1  ON 20
 eO_1                -4.409114e-01 1 1  ON 21
 eO_2                -1.727563e-02 1 1  ON 22
 eO_3                 3.069140e-01 1 1  ON 23
 eO_4                 5.353354e-01 1 1  ON 24
 eO_5                 4.991953e-01 1 1  ON 25
 eO_6                 2.693964e-01 1 1  ON 26
 eO_7                -3.700533e-02 1 1  ON 27
 eO_8                -2.392334e-01 1 1  ON 28
 eO_9                -1.073101e-01 1 1  ON 29
eH1_0                -2.554754e-01 1 1  ON 30
eH1_1                -1.538091e-01 1 1  ON 31
eH1_2                -1.066429e-01 1 1  ON 32
eH1_3                -5.186756e-02 1 1  ON 33
eH1_4                -3.344269e-03 1 1  ON 34
eH1_5                 3.232163e-02 1 1  ON 35
eH1_6                 9.351424e-02 1 1  ON 36
eH1_7                 1.549201e-01 1 1  ON 37
eH1_8                 1.944983e-01 1 1  ON 38
eH1_9                 9.520319e-02 1 1  ON 39
eH2_0                -2.525022e-01 1 1  ON 40
eH2_1                -1.512128e-01 1 1  ON 41
eH2_2                -1.037620e-01 1 1  ON 42
eH2_3                -4.918118e-02 1 1  ON 43
eH2_4                -9.058856e-04 1 1  ON 44
eH2_5                 3.398636e-02 1 1  ON 45
eH2_6                 9.533182e-02 1 1  ON 46
eH2_7                 1.555804e-01 1 1  ON 47
eH2_8                 1.975733e-01 1 1  ON 48
eH2_9                 8.840090e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8174
    reference variance = 0.281555
====================================================
  Execution time = 2.0622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3625e-01
  Total weights = 2.0000e+06
  Execution time = 1.8972e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335392938794
                                         uncertainty =       0.003088415561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335392938794
                                         uncertainty =       0.003088415561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410033455
  error estimate for blocks of size 2^( 2) =       0.000423055786
  error estimate for blocks of size 2^( 3) =       0.000436241277
  error estimate for blocks of size 2^( 4) =       0.000448597230
  error estimate for blocks of size 2^( 5) =       0.000458719543
  error estimate for blocks of size 2^( 6) =       0.000466417881
  error estimate for blocks of size 2^( 7) =       0.000471884920

      target function =                  N/A
              le_mean =     -16.905660853668
             les_mean =     286.137623600307
             stat err =       0.000461404893
             autocorr =       1.266268507239
              std dev =       0.579874873725
             le_variance =       0.336254869177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381743563
                                         uncertainty =       0.003088282017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381743563
                                         uncertainty =       0.003088282017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410026630
  error estimate for blocks of size 2^( 2) =       0.000423049457
  error estimate for blocks of size 2^( 3) =       0.000436235406
  error estimate for blocks of size 2^( 4) =       0.000448591601
  error estimate for blocks of size 2^( 5) =       0.000458714357
  error estimate for blocks of size 2^( 6) =       0.000466412931
  error estimate for blocks of size 2^( 7) =       0.000471880191

      target function =                  N/A
              le_mean =     -16.905660666137
             les_mean =     286.137606065675
             stat err =       0.000461399770
             autocorr =       1.266282542186
              std dev =       0.579865221607
             le_variance =       0.336243675229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335387118402
                                         uncertainty =       0.003088347050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335387118402
                                         uncertainty =       0.003088347050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410029907
  error estimate for blocks of size 2^( 2) =       0.000423052493
  error estimate for blocks of size 2^( 3) =       0.000436238220
  error estimate for blocks of size 2^( 4) =       0.000448594297
  error estimate for blocks of size 2^( 5) =       0.000458716842
  error estimate for blocks of size 2^( 6) =       0.000466415305
  error estimate for blocks of size 2^( 7) =       0.000471882460

      target function =                  N/A
              le_mean =     -16.905660757850
             les_mean =     286.137614540818
             stat err =       0.000461402226
             autocorr =       1.266275781744
              std dev =       0.579869855601
             le_variance =       0.336249049434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335392203878
                                         uncertainty =       0.003088406944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335392203878
                                         uncertainty =       0.003088406944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410033007
  error estimate for blocks of size 2^( 2) =       0.000423055370
  error estimate for blocks of size 2^( 3) =       0.000436240891
  error estimate for blocks of size 2^( 4) =       0.000448596859
  error estimate for blocks of size 2^( 5) =       0.000458719202
  error estimate for blocks of size 2^( 6) =       0.000466417555
  error estimate for blocks of size 2^( 7) =       0.000471884609

      target function =                  N/A
              le_mean =     -16.905660841591
             les_mean =     286.137622457134
             stat err =       0.000461404556
             autocorr =       1.266269424817
              std dev =       0.579874240111
             le_variance =       0.336254134344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905660853668        initial  <--
     9.3132e+00     9.3132e+01             2.7904e-05       -16.905660666137
     3.7253e+01     3.7253e+02             6.9825e-06       -16.905660757850
     1.4901e+02     1.4901e+03             1.7461e-06       -16.905660841591

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1649
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.095185e-01 1 1  ON 0
 uu_1                 1.426121e-01 1 1  ON 1
 uu_2                 4.075632e-02 1 1  ON 2
 uu_3                -2.192359e-02 1 1  ON 3
 uu_4                -6.789593e-02 1 1  ON 4
 uu_5                -1.031872e-01 1 1  ON 5
 uu_6                -1.316319e-01 1 1  ON 6
 uu_7                -1.460925e-01 1 1  ON 7
 uu_8                -1.390781e-01 1 1  ON 8
 uu_9                -1.111906e-01 1 1  ON 9
 ud_0                 4.545903e-01 1 1  ON 10
 ud_1                 1.880176e-01 1 1  ON 11
 ud_2                 6.646786e-02 1 1  ON 12
 ud_3                -5.659024e-03 1 1  ON 13
 ud_4                -6.327135e-02 1 1  ON 14
 ud_5                -1.055958e-01 1 1  ON 15
 ud_6                -1.337175e-01 1 1  ON 16
 ud_7                -1.515893e-01 1 1  ON 17
 ud_8                -1.531814e-01 1 1  ON 18
 ud_9                -1.455875e-01 1 1  ON 19
 eO_0                -7.642972e-01 1 1  ON 20
 eO_1                -4.409093e-01 1 1  ON 21
 eO_2                -1.727398e-02 1 1  ON 22
 eO_3                 3.069122e-01 1 1  ON 23
 eO_4                 5.353345e-01 1 1  ON 24
 eO_5                 4.991940e-01 1 1  ON 25
 eO_6                 2.693986e-01 1 1  ON 26
 eO_7                -3.700532e-02 1 1  ON 27
 eO_8                -2.392350e-01 1 1  ON 28
 eO_9                -1.073089e-01 1 1  ON 29
eH1_0                -2.554776e-01 1 1  ON 30
eH1_1                -1.538049e-01 1 1  ON 31
eH1_2                -1.066383e-01 1 1  ON 32
eH1_3                -5.186695e-02 1 1  ON 33
eH1_4                -3.342783e-03 1 1  ON 34
eH1_5                 3.232691e-02 1 1  ON 35
eH1_6                 9.351300e-02 1 1  ON 36
eH1_7                 1.549189e-01 1 1  ON 37
eH1_8                 1.944957e-01 1 1  ON 38
eH1_9                 9.519620e-02 1 1  ON 39
eH2_0                -2.525012e-01 1 1  ON 40
eH2_1                -1.512097e-01 1 1  ON 41
eH2_2                -1.037601e-01 1 1  ON 42
eH2_3                -4.918008e-02 1 1  ON 43
eH2_4                -9.029144e-04 1 1  ON 44
eH2_5                 3.398687e-02 1 1  ON 45
eH2_6                 9.533292e-02 1 1  ON 46
eH2_7                 1.555797e-01 1 1  ON 47
eH2_8                 1.975701e-01 1 1  ON 48
eH2_9                 8.839456e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9182
    reference variance = 0.19792
====================================================
  Execution time = 2.0184e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3926e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339188655862
                                         uncertainty =       0.003861024251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339188655862
                                         uncertainty =       0.003861024251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411864272
  error estimate for blocks of size 2^( 2) =       0.000424419939
  error estimate for blocks of size 2^( 3) =       0.000437822608
  error estimate for blocks of size 2^( 4) =       0.000449672727
  error estimate for blocks of size 2^( 5) =       0.000461950294
  error estimate for blocks of size 2^( 6) =       0.000468497773
  error estimate for blocks of size 2^( 7) =       0.000473724365

      target function =                  N/A
              le_mean =     -16.905232993227
             les_mean =     286.126166743470
             stat err =       0.000463461290
             autocorr =       1.266247762528
              std dev =       0.582464039934
             le_variance =       0.339264357817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690523299323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905232993227       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905233002622       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905233008416       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905233005761       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905233003746       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905233003807       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905233002929       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905233003663       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.418854e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905232993227       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905232995579       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905232997032       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905232996367       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905232995862       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905232995877       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905232995657       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905232995841       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 6.049349e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905232993227       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905232993815       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905232994179       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905232994012       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905232993885       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905232993890       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905232993834       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905232993880       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.512475e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168102 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5729e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.095189e-01 1 1  ON 0
 uu_1                 1.426120e-01 1 1  ON 1
 uu_2                 4.075642e-02 1 1  ON 2
 uu_3                -2.192359e-02 1 1  ON 3
 uu_4                -6.789613e-02 1 1  ON 4
 uu_5                -1.031872e-01 1 1  ON 5
 uu_6                -1.316322e-01 1 1  ON 6
 uu_7                -1.460931e-01 1 1  ON 7
 uu_8                -1.390781e-01 1 1  ON 8
 uu_9                -1.111904e-01 1 1  ON 9
 ud_0                 4.545901e-01 1 1  ON 10
 ud_1                 1.880173e-01 1 1  ON 11
 ud_2                 6.646793e-02 1 1  ON 12
 ud_3                -5.659169e-03 1 1  ON 13
 ud_4                -6.327144e-02 1 1  ON 14
 ud_5                -1.055955e-01 1 1  ON 15
 ud_6                -1.337175e-01 1 1  ON 16
 ud_7                -1.515894e-01 1 1  ON 17
 ud_8                -1.531812e-01 1 1  ON 18
 ud_9                -1.455872e-01 1 1  ON 19
 eO_0                -7.642968e-01 1 1  ON 20
 eO_1                -4.409094e-01 1 1  ON 21
 eO_2                -1.727432e-02 1 1  ON 22
 eO_3                 3.069126e-01 1 1  ON 23
 eO_4                 5.353344e-01 1 1  ON 24
 eO_5                 4.991940e-01 1 1  ON 25
 eO_6                 2.693987e-01 1 1  ON 26
 eO_7                -3.700549e-02 1 1  ON 27
 eO_8                -2.392351e-01 1 1  ON 28
 eO_9                -1.073091e-01 1 1  ON 29
eH1_0                -2.554774e-01 1 1  ON 30
eH1_1                -1.538049e-01 1 1  ON 31
eH1_2                -1.066383e-01 1 1  ON 32
eH1_3                -5.186714e-02 1 1  ON 33
eH1_4                -3.343000e-03 1 1  ON 34
eH1_5                 3.232655e-02 1 1  ON 35
eH1_6                 9.351277e-02 1 1  ON 36
eH1_7                 1.549191e-01 1 1  ON 37
eH1_8                 1.944958e-01 1 1  ON 38
eH1_9                 9.519663e-02 1 1  ON 39
eH2_0                -2.525014e-01 1 1  ON 40
eH2_1                -1.512102e-01 1 1  ON 41
eH2_2                -1.037603e-01 1 1  ON 42
eH2_3                -4.918017e-02 1 1  ON 43
eH2_4                -9.028985e-04 1 1  ON 44
eH2_5                 3.398687e-02 1 1  ON 45
eH2_6                 9.533277e-02 1 1  ON 46
eH2_7                 1.555798e-01 1 1  ON 47
eH2_8                 1.975704e-01 1 1  ON 48
eH2_9                 8.839517e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0633
    reference variance = 0.383344
====================================================
  Execution time = 2.0081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3881e-01
  Total weights = 2.0000e+06
  Execution time = 1.9127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338700251810
                                         uncertainty =       0.003273021886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338700251810
                                         uncertainty =       0.003273021886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411587352
  error estimate for blocks of size 2^( 2) =       0.000424626362
  error estimate for blocks of size 2^( 3) =       0.000437297900
  error estimate for blocks of size 2^( 4) =       0.000448802119
  error estimate for blocks of size 2^( 5) =       0.000459530702
  error estimate for blocks of size 2^( 6) =       0.000466773376
  error estimate for blocks of size 2^( 7) =       0.000471601116

      target function =                  N/A
              le_mean =     -16.906242946319
             les_mean =     286.159858686691
             stat err =       0.000461676828
             autocorr =       1.258207051928
              std dev =       0.582072414867
             le_variance =       0.338808296149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699601806
                                         uncertainty =       0.003273014914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699601806
                                         uncertainty =       0.003273014914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411586957
  error estimate for blocks of size 2^( 2) =       0.000424626010
  error estimate for blocks of size 2^( 3) =       0.000437297585
  error estimate for blocks of size 2^( 4) =       0.000448801838
  error estimate for blocks of size 2^( 5) =       0.000459530404
  error estimate for blocks of size 2^( 6) =       0.000466773053
  error estimate for blocks of size 2^( 7) =       0.000471600822

      target function =                  N/A
              le_mean =     -16.906242952379
             les_mean =     286.159858241097
             stat err =       0.000461676529
             autocorr =       1.258207838516
              std dev =       0.582071856090
             le_variance =       0.338807645653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699926159
                                         uncertainty =       0.003273018386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699926159
                                         uncertainty =       0.003273018386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411587154
  error estimate for blocks of size 2^( 2) =       0.000424626186
  error estimate for blocks of size 2^( 3) =       0.000437297742
  error estimate for blocks of size 2^( 4) =       0.000448801978
  error estimate for blocks of size 2^( 5) =       0.000459530553
  error estimate for blocks of size 2^( 6) =       0.000466773214
  error estimate for blocks of size 2^( 7) =       0.000471600969

      target function =                  N/A
              le_mean =     -16.906242949347
             les_mean =     286.159858463197
             stat err =       0.000461676679
             autocorr =       1.258207446302
              std dev =       0.582072134921
             le_variance =       0.338807970251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338700211082
                                         uncertainty =       0.003273021448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338700211082
                                         uncertainty =       0.003273021448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411587327
  error estimate for blocks of size 2^( 2) =       0.000424626340
  error estimate for blocks of size 2^( 3) =       0.000437297880
  error estimate for blocks of size 2^( 4) =       0.000448802101
  error estimate for blocks of size 2^( 5) =       0.000459530683
  error estimate for blocks of size 2^( 6) =       0.000466773356
  error estimate for blocks of size 2^( 7) =       0.000471601098

      target function =                  N/A
              le_mean =     -16.906242946697
             les_mean =     286.159858658722
             stat err =       0.000461676810
             autocorr =       1.258207101258
              std dev =       0.582072379855
             le_variance =       0.338808255390


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906242946319        initial
     9.3132e+01     9.3132e+02             2.4189e-06       -16.906242952379  <--
     3.7253e+02     3.7253e+03             6.0493e-07       -16.906242949347
     1.4901e+03     1.4901e+04             1.5125e-07       -16.906242946697

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 2.9674e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.095200e-01 1 1  ON 0
 uu_1                 1.426115e-01 1 1  ON 1
 uu_2                 4.075673e-02 1 1  ON 2
 uu_3                -2.192362e-02 1 1  ON 3
 uu_4                -6.789673e-02 1 1  ON 4
 uu_5                -1.031874e-01 1 1  ON 5
 uu_6                -1.316330e-01 1 1  ON 6
 uu_7                -1.460946e-01 1 1  ON 7
 uu_8                -1.390783e-01 1 1  ON 8
 uu_9                -1.111898e-01 1 1  ON 9
 ud_0                 4.545895e-01 1 1  ON 10
 ud_1                 1.880166e-01 1 1  ON 11
 ud_2                 6.646812e-02 1 1  ON 12
 ud_3                -5.659601e-03 1 1  ON 13
 ud_4                -6.327173e-02 1 1  ON 14
 ud_5                -1.055948e-01 1 1  ON 15
 ud_6                -1.337175e-01 1 1  ON 16
 ud_7                -1.515895e-01 1 1  ON 17
 ud_8                -1.531808e-01 1 1  ON 18
 ud_9                -1.455862e-01 1 1  ON 19
 eO_0                -7.642955e-01 1 1  ON 20
 eO_1                -4.409098e-01 1 1  ON 21
 eO_2                -1.727532e-02 1 1  ON 22
 eO_3                 3.069137e-01 1 1  ON 23
 eO_4                 5.353343e-01 1 1  ON 24
 eO_5                 4.991941e-01 1 1  ON 25
 eO_6                 2.693992e-01 1 1  ON 26
 eO_7                -3.700601e-02 1 1  ON 27
 eO_8                -2.392353e-01 1 1  ON 28
 eO_9                -1.073096e-01 1 1  ON 29
eH1_0                -2.554767e-01 1 1  ON 30
eH1_1                -1.538050e-01 1 1  ON 31
eH1_2                -1.066384e-01 1 1  ON 32
eH1_3                -5.186772e-02 1 1  ON 33
eH1_4                -3.343650e-03 1 1  ON 34
eH1_5                 3.232546e-02 1 1  ON 35
eH1_6                 9.351207e-02 1 1  ON 36
eH1_7                 1.549196e-01 1 1  ON 37
eH1_8                 1.944961e-01 1 1  ON 38
eH1_9                 9.519792e-02 1 1  ON 39
eH2_0                -2.525021e-01 1 1  ON 40
eH2_1                -1.512115e-01 1 1  ON 41
eH2_2                -1.037609e-01 1 1  ON 42
eH2_3                -4.918042e-02 1 1  ON 43
eH2_4                -9.028511e-04 1 1  ON 44
eH2_5                 3.398686e-02 1 1  ON 45
eH2_6                 9.533229e-02 1 1  ON 46
eH2_7                 1.555800e-01 1 1  ON 47
eH2_8                 1.975711e-01 1 1  ON 48
eH2_9                 8.839698e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5412e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8609
    reference variance = 0.263054
====================================================
  Execution time = 2.0141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3875e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338840095648
                                         uncertainty =       0.003036941849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338840095648
                                         uncertainty =       0.003036941849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411549968
  error estimate for blocks of size 2^( 2) =       0.000424338759
  error estimate for blocks of size 2^( 3) =       0.000437517706
  error estimate for blocks of size 2^( 4) =       0.000450691295
  error estimate for blocks of size 2^( 5) =       0.000461784569
  error estimate for blocks of size 2^( 6) =       0.000470655556
  error estimate for blocks of size 2^( 7) =       0.000473340841

      target function =                  N/A
              le_mean =     -16.906438297290
             les_mean =     286.166402483769
             stat err =       0.000464118065
             autocorr =       1.271779444210
              std dev =       0.582019546982
             le_variance =       0.338746753069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643829729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906438297290       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906438305520       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906438308833       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906438305083       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906438325964       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906438317514       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906438309282       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 8.616135e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906438297290       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906438299357       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906438300182       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906438299255       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906438304528       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906438302436       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906438300339       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.157636e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906438297290       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906438297807       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906438298013       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906438297782       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906438299104       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906438298583       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906438298056       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 5.396284e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5778e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.095197e-01 1 1  ON 0
 uu_1                 1.426103e-01 1 1  ON 1
 uu_2                 4.075682e-02 1 1  ON 2
 uu_3                -2.192350e-02 1 1  ON 3
 uu_4                -6.789607e-02 1 1  ON 4
 uu_5                -1.031869e-01 1 1  ON 5
 uu_6                -1.316347e-01 1 1  ON 6
 uu_7                -1.460953e-01 1 1  ON 7
 uu_8                -1.390784e-01 1 1  ON 8
 uu_9                -1.111897e-01 1 1  ON 9
 ud_0                 4.545886e-01 1 1  ON 10
 ud_1                 1.880159e-01 1 1  ON 11
 ud_2                 6.646895e-02 1 1  ON 12
 ud_3                -5.660175e-03 1 1  ON 13
 ud_4                -6.327226e-02 1 1  ON 14
 ud_5                -1.055943e-01 1 1  ON 15
 ud_6                -1.337172e-01 1 1  ON 16
 ud_7                -1.515884e-01 1 1  ON 17
 ud_8                -1.531798e-01 1 1  ON 18
 ud_9                -1.455858e-01 1 1  ON 19
 eO_0                -7.642942e-01 1 1  ON 20
 eO_1                -4.409091e-01 1 1  ON 21
 eO_2                -1.727676e-02 1 1  ON 22
 eO_3                 3.069141e-01 1 1  ON 23
 eO_4                 5.353351e-01 1 1  ON 24
 eO_5                 4.991943e-01 1 1  ON 25
 eO_6                 2.693992e-01 1 1  ON 26
 eO_7                -3.700607e-02 1 1  ON 27
 eO_8                -2.392359e-01 1 1  ON 28
 eO_9                -1.073107e-01 1 1  ON 29
eH1_0                -2.554772e-01 1 1  ON 30
eH1_1                -1.538058e-01 1 1  ON 31
eH1_2                -1.066390e-01 1 1  ON 32
eH1_3                -5.186879e-02 1 1  ON 33
eH1_4                -3.343075e-03 1 1  ON 34
eH1_5                 3.232532e-02 1 1  ON 35
eH1_6                 9.351158e-02 1 1  ON 36
eH1_7                 1.549193e-01 1 1  ON 37
eH1_8                 1.944967e-01 1 1  ON 38
eH1_9                 9.520008e-02 1 1  ON 39
eH2_0                -2.525020e-01 1 1  ON 40
eH2_1                -1.512123e-01 1 1  ON 41
eH2_2                -1.037614e-01 1 1  ON 42
eH2_3                -4.918186e-02 1 1  ON 43
eH2_4                -9.027596e-04 1 1  ON 44
eH2_5                 3.398689e-02 1 1  ON 45
eH2_6                 9.533221e-02 1 1  ON 46
eH2_7                 1.555799e-01 1 1  ON 47
eH2_8                 1.975718e-01 1 1  ON 48
eH2_9                 8.839894e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.953
    reference variance = 0.214314
====================================================
  Execution time = 1.9966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3620e-01
  Total weights = 2.0000e+06
  Execution time = 1.9168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336084994409
                                         uncertainty =       0.002956213440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336084994409
                                         uncertainty =       0.002956213440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410001127
  error estimate for blocks of size 2^( 2) =       0.000423011442
  error estimate for blocks of size 2^( 3) =       0.000436371798
  error estimate for blocks of size 2^( 4) =       0.000449142118
  error estimate for blocks of size 2^( 5) =       0.000459922551
  error estimate for blocks of size 2^( 6) =       0.000467008590
  error estimate for blocks of size 2^( 7) =       0.000469275520

      target function =                  N/A
              le_mean =     -16.906024125817
             les_mean =     286.149853423164
             stat err =       0.000461337195
             autocorr =       1.266096591199
              std dev =       0.579829154638
             le_variance =       0.336201848569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079502139
                                         uncertainty =       0.002956165498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079502139
                                         uncertainty =       0.002956165498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409997778
  error estimate for blocks of size 2^( 2) =       0.000423008402
  error estimate for blocks of size 2^( 3) =       0.000436369003
  error estimate for blocks of size 2^( 4) =       0.000449139485
  error estimate for blocks of size 2^( 5) =       0.000459919885
  error estimate for blocks of size 2^( 6) =       0.000467005779
  error estimate for blocks of size 2^( 7) =       0.000469272715

      target function =                  N/A
              le_mean =     -16.906024098723
             les_mean =     286.149847013954
             stat err =       0.000461334466
             autocorr =       1.266102299562
              std dev =       0.579824417783
             le_variance =       0.336196355457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336082219196
                                         uncertainty =       0.002956189230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336082219196
                                         uncertainty =       0.002956189230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409999435
  error estimate for blocks of size 2^( 2) =       0.000423009906
  error estimate for blocks of size 2^( 3) =       0.000436370386
  error estimate for blocks of size 2^( 4) =       0.000449140789
  error estimate for blocks of size 2^( 5) =       0.000459921205
  error estimate for blocks of size 2^( 6) =       0.000467007170
  error estimate for blocks of size 2^( 7) =       0.000469274103

      target function =                  N/A
              le_mean =     -16.906024112007
             les_mean =     286.149850180585
             stat err =       0.000461335817
             autocorr =       1.266099481145
              std dev =       0.579826761140
             le_variance =       0.336199072934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336084646549
                                         uncertainty =       0.002956210406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336084646549
                                         uncertainty =       0.002956210406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410000915
  error estimate for blocks of size 2^( 2) =       0.000423011250
  error estimate for blocks of size 2^( 3) =       0.000436371621
  error estimate for blocks of size 2^( 4) =       0.000449141951
  error estimate for blocks of size 2^( 5) =       0.000459922382
  error estimate for blocks of size 2^( 6) =       0.000467008412
  error estimate for blocks of size 2^( 7) =       0.000469275342

      target function =                  N/A
              le_mean =     -16.906024124078
             les_mean =     286.149853016453
             stat err =       0.000461337022
             autocorr =       1.266096953589
              std dev =       0.579828854625
             le_variance =       0.336201500656


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906024125817        initial  <--
     2.3283e+01     2.3283e+02             8.6161e-06       -16.906024098723
     9.3132e+01     9.3132e+02             2.1576e-06       -16.906024112007
     3.7253e+02     3.7253e+03             5.3963e-07       -16.906024124078

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5981
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.095200e-01 1 1  ON 0
 uu_1                 1.426115e-01 1 1  ON 1
 uu_2                 4.075673e-02 1 1  ON 2
 uu_3                -2.192362e-02 1 1  ON 3
 uu_4                -6.789673e-02 1 1  ON 4
 uu_5                -1.031874e-01 1 1  ON 5
 uu_6                -1.316330e-01 1 1  ON 6
 uu_7                -1.460946e-01 1 1  ON 7
 uu_8                -1.390783e-01 1 1  ON 8
 uu_9                -1.111898e-01 1 1  ON 9
 ud_0                 4.545895e-01 1 1  ON 10
 ud_1                 1.880166e-01 1 1  ON 11
 ud_2                 6.646812e-02 1 1  ON 12
 ud_3                -5.659601e-03 1 1  ON 13
 ud_4                -6.327173e-02 1 1  ON 14
 ud_5                -1.055948e-01 1 1  ON 15
 ud_6                -1.337175e-01 1 1  ON 16
 ud_7                -1.515895e-01 1 1  ON 17
 ud_8                -1.531808e-01 1 1  ON 18
 ud_9                -1.455862e-01 1 1  ON 19
 eO_0                -7.642955e-01 1 1  ON 20
 eO_1                -4.409098e-01 1 1  ON 21
 eO_2                -1.727532e-02 1 1  ON 22
 eO_3                 3.069137e-01 1 1  ON 23
 eO_4                 5.353343e-01 1 1  ON 24
 eO_5                 4.991941e-01 1 1  ON 25
 eO_6                 2.693992e-01 1 1  ON 26
 eO_7                -3.700601e-02 1 1  ON 27
 eO_8                -2.392353e-01 1 1  ON 28
 eO_9                -1.073096e-01 1 1  ON 29
eH1_0                -2.554767e-01 1 1  ON 30
eH1_1                -1.538050e-01 1 1  ON 31
eH1_2                -1.066384e-01 1 1  ON 32
eH1_3                -5.186772e-02 1 1  ON 33
eH1_4                -3.343650e-03 1 1  ON 34
eH1_5                 3.232546e-02 1 1  ON 35
eH1_6                 9.351207e-02 1 1  ON 36
eH1_7                 1.549196e-01 1 1  ON 37
eH1_8                 1.944961e-01 1 1  ON 38
eH1_9                 9.519792e-02 1 1  ON 39
eH2_0                -2.525021e-01 1 1  ON 40
eH2_1                -1.512115e-01 1 1  ON 41
eH2_2                -1.037609e-01 1 1  ON 42
eH2_3                -4.918042e-02 1 1  ON 43
eH2_4                -9.028511e-04 1 1  ON 44
eH2_5                 3.398686e-02 1 1  ON 45
eH2_6                 9.533229e-02 1 1  ON 46
eH2_7                 1.555800e-01 1 1  ON 47
eH2_8                 1.975711e-01 1 1  ON 48
eH2_9                 8.839698e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5383e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.7792
    reference variance = 0.35687
====================================================
  Execution time = 2.0206e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3943e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339476042521
                                         uncertainty =       0.003008542498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339476042521
                                         uncertainty =       0.003008542498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411963218
  error estimate for blocks of size 2^( 2) =       0.000424572320
  error estimate for blocks of size 2^( 3) =       0.000437132462
  error estimate for blocks of size 2^( 4) =       0.000450155189
  error estimate for blocks of size 2^( 5) =       0.000461836752
  error estimate for blocks of size 2^( 6) =       0.000471554710
  error estimate for blocks of size 2^( 7) =       0.000476022251

      target function =                  N/A
              le_mean =     -16.905737705752
             les_mean =     286.143394592524
             stat err =       0.000464892226
             autocorr =       1.273466962783
              std dev =       0.582603970601
             le_variance =       0.339427386560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573770575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737705752       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737705034       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737705096       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737705227       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737704938       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737705098       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737706229       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 9.153046e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737705752       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737705572       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737705588       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737705620       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737705548       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737705588       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737705869       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.288967e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737705752       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737705707       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737705711       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737705718       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737705701       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737705712       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737705781       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.722858e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172557 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5862e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.095199e-01 1 1  ON 0
 uu_1                 1.426115e-01 1 1  ON 1
 uu_2                 4.075673e-02 1 1  ON 2
 uu_3                -2.192371e-02 1 1  ON 3
 uu_4                -6.789669e-02 1 1  ON 4
 uu_5                -1.031874e-01 1 1  ON 5
 uu_6                -1.316331e-01 1 1  ON 6
 uu_7                -1.460948e-01 1 1  ON 7
 uu_8                -1.390783e-01 1 1  ON 8
 uu_9                -1.111898e-01 1 1  ON 9
 ud_0                 4.545894e-01 1 1  ON 10
 ud_1                 1.880166e-01 1 1  ON 11
 ud_2                 6.646817e-02 1 1  ON 12
 ud_3                -5.659650e-03 1 1  ON 13
 ud_4                -6.327184e-02 1 1  ON 14
 ud_5                -1.055948e-01 1 1  ON 15
 ud_6                -1.337177e-01 1 1  ON 16
 ud_7                -1.515895e-01 1 1  ON 17
 ud_8                -1.531806e-01 1 1  ON 18
 ud_9                -1.455861e-01 1 1  ON 19
 eO_0                -7.642955e-01 1 1  ON 20
 eO_1                -4.409097e-01 1 1  ON 21
 eO_2                -1.727525e-02 1 1  ON 22
 eO_3                 3.069138e-01 1 1  ON 23
 eO_4                 5.353342e-01 1 1  ON 24
 eO_5                 4.991941e-01 1 1  ON 25
 eO_6                 2.693992e-01 1 1  ON 26
 eO_7                -3.700599e-02 1 1  ON 27
 eO_8                -2.392353e-01 1 1  ON 28
 eO_9                -1.073097e-01 1 1  ON 29
eH1_0                -2.554767e-01 1 1  ON 30
eH1_1                -1.538052e-01 1 1  ON 31
eH1_2                -1.066384e-01 1 1  ON 32
eH1_3                -5.186770e-02 1 1  ON 33
eH1_4                -3.343631e-03 1 1  ON 34
eH1_5                 3.232551e-02 1 1  ON 35
eH1_6                 9.351198e-02 1 1  ON 36
eH1_7                 1.549195e-01 1 1  ON 37
eH1_8                 1.944962e-01 1 1  ON 38
eH1_9                 9.519810e-02 1 1  ON 39
eH2_0                -2.525022e-01 1 1  ON 40
eH2_1                -1.512116e-01 1 1  ON 41
eH2_2                -1.037609e-01 1 1  ON 42
eH2_3                -4.918058e-02 1 1  ON 43
eH2_4                -9.027126e-04 1 1  ON 44
eH2_5                 3.398670e-02 1 1  ON 45
eH2_6                 9.533221e-02 1 1  ON 46
eH2_7                 1.555801e-01 1 1  ON 47
eH2_8                 1.975713e-01 1 1  ON 48
eH2_9                 8.839721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9857
    reference variance = 0.239923
====================================================
  Execution time = 2.0004e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4022e-01
  Total weights = 2.0000e+06
  Execution time = 1.9034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741457701
                                         uncertainty =       0.004940147231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741457701
                                         uncertainty =       0.004940147231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412443754
  error estimate for blocks of size 2^( 2) =       0.000424459484
  error estimate for blocks of size 2^( 3) =       0.000436850717
  error estimate for blocks of size 2^( 4) =       0.000448206254
  error estimate for blocks of size 2^( 5) =       0.000457871428
  error estimate for blocks of size 2^( 6) =       0.000465592258
  error estimate for blocks of size 2^( 7) =       0.000470208598

      target function =                  N/A
              le_mean =     -16.906371777829
             les_mean =     286.165626220781
             stat err =       0.000460469635
             autocorr =       1.246443307184
              std dev =       0.583283550877
             le_variance =       0.340219700724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741142443
                                         uncertainty =       0.004940144435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741142443
                                         uncertainty =       0.004940144435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412443562
  error estimate for blocks of size 2^( 2) =       0.000424459304
  error estimate for blocks of size 2^( 3) =       0.000436850545
  error estimate for blocks of size 2^( 4) =       0.000448206094
  error estimate for blocks of size 2^( 5) =       0.000457871280
  error estimate for blocks of size 2^( 6) =       0.000465592111
  error estimate for blocks of size 2^( 7) =       0.000470208479

      target function =                  N/A
              le_mean =     -16.906371778856
             les_mean =     286.165625939036
             stat err =       0.000460469491
             autocorr =       1.246443687499
              std dev =       0.583283279590
             le_variance =       0.340219384249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741299756
                                         uncertainty =       0.004940145829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741299756
                                         uncertainty =       0.004940145829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412443658
  error estimate for blocks of size 2^( 2) =       0.000424459394
  error estimate for blocks of size 2^( 3) =       0.000436850630
  error estimate for blocks of size 2^( 4) =       0.000448206174
  error estimate for blocks of size 2^( 5) =       0.000457871354
  error estimate for blocks of size 2^( 6) =       0.000465592185
  error estimate for blocks of size 2^( 7) =       0.000470208538

      target function =                  N/A
              le_mean =     -16.906371778341
             les_mean =     286.165626079544
             stat err =       0.000460469563
             autocorr =       1.246443497648
              std dev =       0.583283414962
             le_variance =       0.340219542169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741437947
                                         uncertainty =       0.004940147056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741437947
                                         uncertainty =       0.004940147056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412443742
  error estimate for blocks of size 2^( 2) =       0.000424459473
  error estimate for blocks of size 2^( 3) =       0.000436850706
  error estimate for blocks of size 2^( 4) =       0.000448206244
  error estimate for blocks of size 2^( 5) =       0.000457871419
  error estimate for blocks of size 2^( 6) =       0.000465592249
  error estimate for blocks of size 2^( 7) =       0.000470208590

      target function =                  N/A
              le_mean =     -16.906371777893
             les_mean =     286.165626203113
             stat err =       0.000460469626
             autocorr =       1.246443331011
              std dev =       0.583283533879
             le_variance =       0.340219680894


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906371777829        initial
     2.3283e+02     2.3283e+03             9.1530e-07       -16.906371778856  <--
     9.3132e+02     9.3132e+03             2.2890e-07       -16.906371778341
     3.7253e+03     3.7253e+04             5.7229e-08       -16.906371777893

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 2.9568e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.095198e-01 1 1  ON 0
 uu_1                 1.426114e-01 1 1  ON 1
 uu_2                 4.075674e-02 1 1  ON 2
 uu_3                -2.192398e-02 1 1  ON 3
 uu_4                -6.789656e-02 1 1  ON 4
 uu_5                -1.031873e-01 1 1  ON 5
 uu_6                -1.316333e-01 1 1  ON 6
 uu_7                -1.460951e-01 1 1  ON 7
 uu_8                -1.390783e-01 1 1  ON 8
 uu_9                -1.111895e-01 1 1  ON 9
 ud_0                 4.545893e-01 1 1  ON 10
 ud_1                 1.880166e-01 1 1  ON 11
 ud_2                 6.646829e-02 1 1  ON 12
 ud_3                -5.659797e-03 1 1  ON 13
 ud_4                -6.327216e-02 1 1  ON 14
 ud_5                -1.055945e-01 1 1  ON 15
 ud_6                -1.337183e-01 1 1  ON 16
 ud_7                -1.515892e-01 1 1  ON 17
 ud_8                -1.531803e-01 1 1  ON 18
 ud_9                -1.455858e-01 1 1  ON 19
 eO_0                -7.642957e-01 1 1  ON 20
 eO_1                -4.409094e-01 1 1  ON 21
 eO_2                -1.727504e-02 1 1  ON 22
 eO_3                 3.069140e-01 1 1  ON 23
 eO_4                 5.353339e-01 1 1  ON 24
 eO_5                 4.991940e-01 1 1  ON 25
 eO_6                 2.693992e-01 1 1  ON 26
 eO_7                -3.700596e-02 1 1  ON 27
 eO_8                -2.392353e-01 1 1  ON 28
 eO_9                -1.073100e-01 1 1  ON 29
eH1_0                -2.554768e-01 1 1  ON 30
eH1_1                -1.538056e-01 1 1  ON 31
eH1_2                -1.066386e-01 1 1  ON 32
eH1_3                -5.186764e-02 1 1  ON 33
eH1_4                -3.343573e-03 1 1  ON 34
eH1_5                 3.232566e-02 1 1  ON 35
eH1_6                 9.351170e-02 1 1  ON 36
eH1_7                 1.549194e-01 1 1  ON 37
eH1_8                 1.944964e-01 1 1  ON 38
eH1_9                 9.519861e-02 1 1  ON 39
eH2_0                -2.525025e-01 1 1  ON 40
eH2_1                -1.512120e-01 1 1  ON 41
eH2_2                -1.037608e-01 1 1  ON 42
eH2_3                -4.918107e-02 1 1  ON 43
eH2_4                -9.022974e-04 1 1  ON 44
eH2_5                 3.398624e-02 1 1  ON 45
eH2_6                 9.533196e-02 1 1  ON 46
eH2_7                 1.555803e-01 1 1  ON 47
eH2_8                 1.975717e-01 1 1  ON 48
eH2_9                 8.839790e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5438e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9344
    reference variance = 0.191386
====================================================
  Execution time = 2.0164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4245e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342431767017
                                         uncertainty =       0.006315297922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342431767017
                                         uncertainty =       0.006315297922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413791697
  error estimate for blocks of size 2^( 2) =       0.000426276645
  error estimate for blocks of size 2^( 3) =       0.000439745034
  error estimate for blocks of size 2^( 4) =       0.000451473278
  error estimate for blocks of size 2^( 5) =       0.000461136124
  error estimate for blocks of size 2^( 6) =       0.000468553459
  error estimate for blocks of size 2^( 7) =       0.000475732505

      target function =                  N/A
              le_mean =     -16.905660297274
             les_mean =     286.143797052076
             stat err =       0.000464223842
             autocorr =       1.258610466549
              std dev =       0.585189829444
             le_variance =       0.342447136485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566029727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905660297274       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905660302560       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905660316364       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905660316301       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905660315181       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905660313423       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905660314899       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905660314871       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.585961e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905660297274       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905660298599       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905660302068       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905660302055       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905660301778       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905660301333       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905660301699       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905660301694       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 8.988259e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905660297274       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905660297605       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905660298474       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905660298471       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905660298401       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905660298290       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905660298381       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905660298381       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.248532e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5743e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.095201e-01 1 1  ON 0
 uu_1                 1.426114e-01 1 1  ON 1
 uu_2                 4.075680e-02 1 1  ON 2
 uu_3                -2.192428e-02 1 1  ON 3
 uu_4                -6.789630e-02 1 1  ON 4
 uu_5                -1.031876e-01 1 1  ON 5
 uu_6                -1.316335e-01 1 1  ON 6
 uu_7                -1.460956e-01 1 1  ON 7
 uu_8                -1.390785e-01 1 1  ON 8
 uu_9                -1.111894e-01 1 1  ON 9
 ud_0                 4.545894e-01 1 1  ON 10
 ud_1                 1.880163e-01 1 1  ON 11
 ud_2                 6.646852e-02 1 1  ON 12
 ud_3                -5.659795e-03 1 1  ON 13
 ud_4                -6.327233e-02 1 1  ON 14
 ud_5                -1.055947e-01 1 1  ON 15
 ud_6                -1.337182e-01 1 1  ON 16
 ud_7                -1.515887e-01 1 1  ON 17
 ud_8                -1.531801e-01 1 1  ON 18
 ud_9                -1.455857e-01 1 1  ON 19
 eO_0                -7.642951e-01 1 1  ON 20
 eO_1                -4.409097e-01 1 1  ON 21
 eO_2                -1.727500e-02 1 1  ON 22
 eO_3                 3.069137e-01 1 1  ON 23
 eO_4                 5.353344e-01 1 1  ON 24
 eO_5                 4.991945e-01 1 1  ON 25
 eO_6                 2.693993e-01 1 1  ON 26
 eO_7                -3.700597e-02 1 1  ON 27
 eO_8                -2.392355e-01 1 1  ON 28
 eO_9                -1.073106e-01 1 1  ON 29
eH1_0                -2.554770e-01 1 1  ON 30
eH1_1                -1.538061e-01 1 1  ON 31
eH1_2                -1.066386e-01 1 1  ON 32
eH1_3                -5.186806e-02 1 1  ON 33
eH1_4                -3.343719e-03 1 1  ON 34
eH1_5                 3.232553e-02 1 1  ON 35
eH1_6                 9.351168e-02 1 1  ON 36
eH1_7                 1.549195e-01 1 1  ON 37
eH1_8                 1.944967e-01 1 1  ON 38
eH1_9                 9.519945e-02 1 1  ON 39
eH2_0                -2.525025e-01 1 1  ON 40
eH2_1                -1.512118e-01 1 1  ON 41
eH2_2                -1.037617e-01 1 1  ON 42
eH2_3                -4.918103e-02 1 1  ON 43
eH2_4                -9.025500e-04 1 1  ON 44
eH2_5                 3.398594e-02 1 1  ON 45
eH2_6                 9.533194e-02 1 1  ON 46
eH2_7                 1.555804e-01 1 1  ON 47
eH2_8                 1.975721e-01 1 1  ON 48
eH2_9                 8.839861e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8502
    reference variance = 0.157409
====================================================
  Execution time = 1.9898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4382e-01
  Total weights = 2.0000e+06
  Execution time = 1.9164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343806301328
                                         uncertainty =       0.006300630208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343806301328
                                         uncertainty =       0.006300630208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414621760
  error estimate for blocks of size 2^( 2) =       0.000427350518
  error estimate for blocks of size 2^( 3) =       0.000439974525
  error estimate for blocks of size 2^( 4) =       0.000452386008
  error estimate for blocks of size 2^( 5) =       0.000462365229
  error estimate for blocks of size 2^( 6) =       0.000469068047
  error estimate for blocks of size 2^( 7) =       0.000473796754

      target function =                  N/A
              le_mean =     -16.906404042027
             les_mean =     286.170319867942
             stat err =       0.000464404009
             autocorr =       1.254549320754
              std dev =       0.586363716117
             le_variance =       0.343822407579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343807186102
                                         uncertainty =       0.006300668817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343807186102
                                         uncertainty =       0.006300668817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414622293
  error estimate for blocks of size 2^( 2) =       0.000427351034
  error estimate for blocks of size 2^( 3) =       0.000439975026
  error estimate for blocks of size 2^( 4) =       0.000452386477
  error estimate for blocks of size 2^( 5) =       0.000462365717
  error estimate for blocks of size 2^( 6) =       0.000469068446
  error estimate for blocks of size 2^( 7) =       0.000473797137

      target function =                  N/A
              le_mean =     -16.906404047321
             les_mean =     286.170320931236
             stat err =       0.000464404444
             autocorr =       1.254548443222
              std dev =       0.586364470175
             le_variance =       0.343823291883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343806746810
                                         uncertainty =       0.006300649639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343806746810
                                         uncertainty =       0.006300649639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414622028
  error estimate for blocks of size 2^( 2) =       0.000427350778
  error estimate for blocks of size 2^( 3) =       0.000439974777
  error estimate for blocks of size 2^( 4) =       0.000452386244
  error estimate for blocks of size 2^( 5) =       0.000462365475
  error estimate for blocks of size 2^( 6) =       0.000469068248
  error estimate for blocks of size 2^( 7) =       0.000473796947

      target function =                  N/A
              le_mean =     -16.906404044673
             les_mean =     286.170320402641
             stat err =       0.000464404228
             autocorr =       1.254548879718
              std dev =       0.586364095784
             le_variance =       0.343822852825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343806357105
                                         uncertainty =       0.006300632641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343806357105
                                         uncertainty =       0.006300632641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414621794
  error estimate for blocks of size 2^( 2) =       0.000427350551
  error estimate for blocks of size 2^( 3) =       0.000439974556
  error estimate for blocks of size 2^( 4) =       0.000452386037
  error estimate for blocks of size 2^( 5) =       0.000462365260
  error estimate for blocks of size 2^( 6) =       0.000469068073
  error estimate for blocks of size 2^( 7) =       0.000473796778

      target function =                  N/A
              le_mean =     -16.906404042357
             les_mean =     286.170319934848
             stat err =       0.000464404037
             autocorr =       1.254549265556
              std dev =       0.586363763654
             le_variance =       0.343822463327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906404042027        initial
     5.8208e+01     5.8208e+02             3.5860e-06       -16.906404047321  <--
     2.3283e+02     2.3283e+03             8.9883e-07       -16.906404044673
     9.3132e+02     9.3132e+03             2.2485e-07       -16.906404042357

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.9535e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.095210e-01 1 1  ON 0
 uu_1                 1.426115e-01 1 1  ON 1
 uu_2                 4.075700e-02 1 1  ON 2
 uu_3                -2.192516e-02 1 1  ON 3
 uu_4                -6.789552e-02 1 1  ON 4
 uu_5                -1.031884e-01 1 1  ON 5
 uu_6                -1.316344e-01 1 1  ON 6
 uu_7                -1.460968e-01 1 1  ON 7
 uu_8                -1.390790e-01 1 1  ON 8
 uu_9                -1.111892e-01 1 1  ON 9
 ud_0                 4.545899e-01 1 1  ON 10
 ud_1                 1.880155e-01 1 1  ON 11
 ud_2                 6.646922e-02 1 1  ON 12
 ud_3                -5.659784e-03 1 1  ON 13
 ud_4                -6.327282e-02 1 1  ON 14
 ud_5                -1.055950e-01 1 1  ON 15
 ud_6                -1.337181e-01 1 1  ON 16
 ud_7                -1.515872e-01 1 1  ON 17
 ud_8                -1.531795e-01 1 1  ON 18
 ud_9                -1.455854e-01 1 1  ON 19
 eO_0                -7.642936e-01 1 1  ON 20
 eO_1                -4.409108e-01 1 1  ON 21
 eO_2                -1.727490e-02 1 1  ON 22
 eO_3                 3.069127e-01 1 1  ON 23
 eO_4                 5.353360e-01 1 1  ON 24
 eO_5                 4.991958e-01 1 1  ON 25
 eO_6                 2.693994e-01 1 1  ON 26
 eO_7                -3.700602e-02 1 1  ON 27
 eO_8                -2.392361e-01 1 1  ON 28
 eO_9                -1.073122e-01 1 1  ON 29
eH1_0                -2.554774e-01 1 1  ON 30
eH1_1                -1.538077e-01 1 1  ON 31
eH1_2                -1.066385e-01 1 1  ON 32
eH1_3                -5.186930e-02 1 1  ON 33
eH1_4                -3.344161e-03 1 1  ON 34
eH1_5                 3.232513e-02 1 1  ON 35
eH1_6                 9.351163e-02 1 1  ON 36
eH1_7                 1.549198e-01 1 1  ON 37
eH1_8                 1.944976e-01 1 1  ON 38
eH1_9                 9.520199e-02 1 1  ON 39
eH2_0                -2.525023e-01 1 1  ON 40
eH2_1                -1.512112e-01 1 1  ON 41
eH2_2                -1.037644e-01 1 1  ON 42
eH2_3                -4.918092e-02 1 1  ON 43
eH2_4                -9.033054e-04 1 1  ON 44
eH2_5                 3.398503e-02 1 1  ON 45
eH2_6                 9.533188e-02 1 1  ON 46
eH2_7                 1.555807e-01 1 1  ON 47
eH2_8                 1.975731e-01 1 1  ON 48
eH2_9                 8.840074e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5299e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8573
    reference variance = 0.365839
====================================================
  Execution time = 2.0188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3523e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335245473345
                                         uncertainty =       0.003244077801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335245473345
                                         uncertainty =       0.003244077801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409411187
  error estimate for blocks of size 2^( 2) =       0.000421861379
  error estimate for blocks of size 2^( 3) =       0.000433776404
  error estimate for blocks of size 2^( 4) =       0.000446001279
  error estimate for blocks of size 2^( 5) =       0.000456073188
  error estimate for blocks of size 2^( 6) =       0.000462132196
  error estimate for blocks of size 2^( 7) =       0.000467005028

      target function =                  N/A
              le_mean =     -16.906290919753
             les_mean =     286.157907536153
             stat err =       0.000457802923
             autocorr =       1.250367596365
              std dev =       0.578994853554
             le_variance =       0.335235040443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629091975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906290919753       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906290995282       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906291000842       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906290999733       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906291037895       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906291041229       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906291050829       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906291049819       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.132794e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906290919753       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906290938765       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906290940134       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906290939912       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906290949528       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906290950412       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906290952833       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.611518e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906290919753       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906290924514       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906290924855       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906290924803       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906290927212       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906290927436       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906290928043       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 6.534522e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5801e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.095213e-01 1 1  ON 0
 uu_1                 1.426114e-01 1 1  ON 1
 uu_2                 4.075883e-02 1 1  ON 2
 uu_3                -2.192428e-02 1 1  ON 3
 uu_4                -6.789509e-02 1 1  ON 4
 uu_5                -1.031895e-01 1 1  ON 5
 uu_6                -1.316331e-01 1 1  ON 6
 uu_7                -1.460970e-01 1 1  ON 7
 uu_8                -1.390813e-01 1 1  ON 8
 uu_9                -1.111914e-01 1 1  ON 9
 ud_0                 4.545908e-01 1 1  ON 10
 ud_1                 1.880170e-01 1 1  ON 11
 ud_2                 6.647060e-02 1 1  ON 12
 ud_3                -5.659829e-03 1 1  ON 13
 ud_4                -6.327269e-02 1 1  ON 14
 ud_5                -1.055946e-01 1 1  ON 15
 ud_6                -1.337186e-01 1 1  ON 16
 ud_7                -1.515874e-01 1 1  ON 17
 ud_8                -1.531812e-01 1 1  ON 18
 ud_9                -1.455854e-01 1 1  ON 19
 eO_0                -7.642911e-01 1 1  ON 20
 eO_1                -4.409118e-01 1 1  ON 21
 eO_2                -1.727619e-02 1 1  ON 22
 eO_3                 3.069140e-01 1 1  ON 23
 eO_4                 5.353369e-01 1 1  ON 24
 eO_5                 4.991978e-01 1 1  ON 25
 eO_6                 2.694005e-01 1 1  ON 26
 eO_7                -3.700647e-02 1 1  ON 27
 eO_8                -2.392383e-01 1 1  ON 28
 eO_9                -1.073145e-01 1 1  ON 29
eH1_0                -2.554772e-01 1 1  ON 30
eH1_1                -1.538097e-01 1 1  ON 31
eH1_2                -1.066377e-01 1 1  ON 32
eH1_3                -5.187111e-02 1 1  ON 33
eH1_4                -3.342987e-03 1 1  ON 34
eH1_5                 3.232454e-02 1 1  ON 35
eH1_6                 9.350999e-02 1 1  ON 36
eH1_7                 1.549195e-01 1 1  ON 37
eH1_8                 1.944989e-01 1 1  ON 38
eH1_9                 9.520460e-02 1 1  ON 39
eH2_0                -2.525045e-01 1 1  ON 40
eH2_1                -1.512093e-01 1 1  ON 41
eH2_2                -1.037649e-01 1 1  ON 42
eH2_3                -4.918069e-02 1 1  ON 43
eH2_4                -9.025014e-04 1 1  ON 44
eH2_5                 3.398459e-02 1 1  ON 45
eH2_6                 9.533035e-02 1 1  ON 46
eH2_7                 1.555801e-01 1 1  ON 47
eH2_8                 1.975728e-01 1 1  ON 48
eH2_9                 8.840296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9704
    reference variance = 0.179953
====================================================
  Execution time = 2.1425e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4457e-01
  Total weights = 2.0000e+06
  Execution time = 2.1324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344638153679
                                         uncertainty =       0.007872579468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344638153679
                                         uncertainty =       0.007872579468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415070837
  error estimate for blocks of size 2^( 2) =       0.000427904916
  error estimate for blocks of size 2^( 3) =       0.000441153076
  error estimate for blocks of size 2^( 4) =       0.000453784281
  error estimate for blocks of size 2^( 5) =       0.000464456349
  error estimate for blocks of size 2^( 6) =       0.000474179473
  error estimate for blocks of size 2^( 7) =       0.000479865729

      target function =                  N/A
              le_mean =     -16.905492228479
             les_mean =     286.140234914433
             stat err =       0.000468071458
             autocorr =       1.271685962352
              std dev =       0.586998807124
             le_variance =       0.344567599565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344632258433
                                         uncertainty =       0.007872431758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344632258433
                                         uncertainty =       0.007872431758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415067286
  error estimate for blocks of size 2^( 2) =       0.000427901537
  error estimate for blocks of size 2^( 3) =       0.000441149794
  error estimate for blocks of size 2^( 4) =       0.000453781003
  error estimate for blocks of size 2^( 5) =       0.000464453264
  error estimate for blocks of size 2^( 6) =       0.000474176271
  error estimate for blocks of size 2^( 7) =       0.000479862649

      target function =                  N/A
              le_mean =     -16.905492220670
             les_mean =     286.140228755195
             stat err =       0.000468068297
             autocorr =       1.271690542400
              std dev =       0.586993785619
             le_variance =       0.344561704355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344635231551
                                         uncertainty =       0.007872509393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344635231551
                                         uncertainty =       0.007872509393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415069077
  error estimate for blocks of size 2^( 2) =       0.000427903235
  error estimate for blocks of size 2^( 3) =       0.000441151438
  error estimate for blocks of size 2^( 4) =       0.000453782642
  error estimate for blocks of size 2^( 5) =       0.000464454802
  error estimate for blocks of size 2^( 6) =       0.000474177855
  error estimate for blocks of size 2^( 7) =       0.000479864186

      target function =                  N/A
              le_mean =     -16.905492221855
             les_mean =     286.140231768422
             stat err =       0.000468069871
             autocorr =       1.271688125911
              std dev =       0.586996318136
             le_variance =       0.344564677505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344637785911
                                         uncertainty =       0.007872570637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344637785911
                                         uncertainty =       0.007872570637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415070616
  error estimate for blocks of size 2^( 2) =       0.000427904705
  error estimate for blocks of size 2^( 3) =       0.000441152870
  error estimate for blocks of size 2^( 4) =       0.000453784074
  error estimate for blocks of size 2^( 5) =       0.000464456155
  error estimate for blocks of size 2^( 6) =       0.000474179269
  error estimate for blocks of size 2^( 7) =       0.000479865535

      target function =                  N/A
              le_mean =     -16.905492227627
             les_mean =     286.140234517895
             stat err =       0.000468071258
             autocorr =       1.271686234843
              std dev =       0.586998493870
             le_variance =       0.344567231805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905492228479        initial  <--
     1.4552e+01     1.4552e+02             1.1328e-05       -16.905492220670
     5.8208e+01     5.8208e+02             2.6115e-06       -16.905492221855
     2.3283e+02     2.3283e+03             6.5345e-07       -16.905492227627

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2246
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.095210e-01 1 1  ON 0
 uu_1                 1.426115e-01 1 1  ON 1
 uu_2                 4.075700e-02 1 1  ON 2
 uu_3                -2.192516e-02 1 1  ON 3
 uu_4                -6.789552e-02 1 1  ON 4
 uu_5                -1.031884e-01 1 1  ON 5
 uu_6                -1.316344e-01 1 1  ON 6
 uu_7                -1.460968e-01 1 1  ON 7
 uu_8                -1.390790e-01 1 1  ON 8
 uu_9                -1.111892e-01 1 1  ON 9
 ud_0                 4.545899e-01 1 1  ON 10
 ud_1                 1.880155e-01 1 1  ON 11
 ud_2                 6.646922e-02 1 1  ON 12
 ud_3                -5.659784e-03 1 1  ON 13
 ud_4                -6.327282e-02 1 1  ON 14
 ud_5                -1.055950e-01 1 1  ON 15
 ud_6                -1.337181e-01 1 1  ON 16
 ud_7                -1.515872e-01 1 1  ON 17
 ud_8                -1.531795e-01 1 1  ON 18
 ud_9                -1.455854e-01 1 1  ON 19
 eO_0                -7.642936e-01 1 1  ON 20
 eO_1                -4.409108e-01 1 1  ON 21
 eO_2                -1.727490e-02 1 1  ON 22
 eO_3                 3.069127e-01 1 1  ON 23
 eO_4                 5.353360e-01 1 1  ON 24
 eO_5                 4.991958e-01 1 1  ON 25
 eO_6                 2.693994e-01 1 1  ON 26
 eO_7                -3.700602e-02 1 1  ON 27
 eO_8                -2.392361e-01 1 1  ON 28
 eO_9                -1.073122e-01 1 1  ON 29
eH1_0                -2.554774e-01 1 1  ON 30
eH1_1                -1.538077e-01 1 1  ON 31
eH1_2                -1.066385e-01 1 1  ON 32
eH1_3                -5.186930e-02 1 1  ON 33
eH1_4                -3.344161e-03 1 1  ON 34
eH1_5                 3.232513e-02 1 1  ON 35
eH1_6                 9.351163e-02 1 1  ON 36
eH1_7                 1.549198e-01 1 1  ON 37
eH1_8                 1.944976e-01 1 1  ON 38
eH1_9                 9.520199e-02 1 1  ON 39
eH2_0                -2.525023e-01 1 1  ON 40
eH2_1                -1.512112e-01 1 1  ON 41
eH2_2                -1.037644e-01 1 1  ON 42
eH2_3                -4.918092e-02 1 1  ON 43
eH2_4                -9.033054e-04 1 1  ON 44
eH2_5                 3.398503e-02 1 1  ON 45
eH2_6                 9.533188e-02 1 1  ON 46
eH2_7                 1.555807e-01 1 1  ON 47
eH2_8                 1.975731e-01 1 1  ON 48
eH2_9                 8.840074e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9276
    reference variance = 0.120029
====================================================
  Execution time = 2.0241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4593e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346019121553
                                         uncertainty =       0.006084550089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346019121553
                                         uncertainty =       0.006084550089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415890240
  error estimate for blocks of size 2^( 2) =       0.000429016725
  error estimate for blocks of size 2^( 3) =       0.000442110584
  error estimate for blocks of size 2^( 4) =       0.000455385768
  error estimate for blocks of size 2^( 5) =       0.000466874725
  error estimate for blocks of size 2^( 6) =       0.000475478605
  error estimate for blocks of size 2^( 7) =       0.000476671939

      target function =                  N/A
              le_mean =     -16.905722520164
             les_mean =     286.149383138942
             stat err =       0.000468602759
             autocorr =       1.269557064098
              std dev =       0.588157617596
             le_variance =       0.345929383136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572252016e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905722520164       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905722520487       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905722524794       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905722524571       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905722527655       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905722527547       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905722527416       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905722527489       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.646311e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905722520164       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905722520245       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905722521323       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905722521266       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905722522038       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905722522011       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905722521979       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905722521997       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 4.115991e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905722520164       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905722520184       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905722520454       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905722520439       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905722520632       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905722520627       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905722520618       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905722520621       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.029011e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180132 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5821e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.095208e-01 1 1  ON 0
 uu_1                 1.426113e-01 1 1  ON 1
 uu_2                 4.075708e-02 1 1  ON 2
 uu_3                -2.192526e-02 1 1  ON 3
 uu_4                -6.789563e-02 1 1  ON 4
 uu_5                -1.031885e-01 1 1  ON 5
 uu_6                -1.316344e-01 1 1  ON 6
 uu_7                -1.460966e-01 1 1  ON 7
 uu_8                -1.390789e-01 1 1  ON 8
 uu_9                -1.111891e-01 1 1  ON 9
 ud_0                 4.545896e-01 1 1  ON 10
 ud_1                 1.880157e-01 1 1  ON 11
 ud_2                 6.646931e-02 1 1  ON 12
 ud_3                -5.659674e-03 1 1  ON 13
 ud_4                -6.327288e-02 1 1  ON 14
 ud_5                -1.055947e-01 1 1  ON 15
 ud_6                -1.337183e-01 1 1  ON 16
 ud_7                -1.515871e-01 1 1  ON 17
 ud_8                -1.531795e-01 1 1  ON 18
 ud_9                -1.455855e-01 1 1  ON 19
 eO_0                -7.642936e-01 1 1  ON 20
 eO_1                -4.409107e-01 1 1  ON 21
 eO_2                -1.727513e-02 1 1  ON 22
 eO_3                 3.069128e-01 1 1  ON 23
 eO_4                 5.353360e-01 1 1  ON 24
 eO_5                 4.991961e-01 1 1  ON 25
 eO_6                 2.693994e-01 1 1  ON 26
 eO_7                -3.700601e-02 1 1  ON 27
 eO_8                -2.392362e-01 1 1  ON 28
 eO_9                -1.073124e-01 1 1  ON 29
eH1_0                -2.554775e-01 1 1  ON 30
eH1_1                -1.538078e-01 1 1  ON 31
eH1_2                -1.066387e-01 1 1  ON 32
eH1_3                -5.186948e-02 1 1  ON 33
eH1_4                -3.344321e-03 1 1  ON 34
eH1_5                 3.232517e-02 1 1  ON 35
eH1_6                 9.351195e-02 1 1  ON 36
eH1_7                 1.549200e-01 1 1  ON 37
eH1_8                 1.944976e-01 1 1  ON 38
eH1_9                 9.520220e-02 1 1  ON 39
eH2_0                -2.525024e-01 1 1  ON 40
eH2_1                -1.512111e-01 1 1  ON 41
eH2_2                -1.037646e-01 1 1  ON 42
eH2_3                -4.918098e-02 1 1  ON 43
eH2_4                -9.033325e-04 1 1  ON 44
eH2_5                 3.398487e-02 1 1  ON 45
eH2_6                 9.533177e-02 1 1  ON 46
eH2_7                 1.555806e-01 1 1  ON 47
eH2_8                 1.975732e-01 1 1  ON 48
eH2_9                 8.840115e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8734
    reference variance = 0.240512
====================================================
  Execution time = 1.9974e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.8722e-01
  Total weights = 2.0000e+06
  Execution time = 1.9069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387327531287
                                         uncertainty =       0.053566168856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387327531287
                                         uncertainty =       0.053566168856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440009227
  error estimate for blocks of size 2^( 2) =       0.000452016967
  error estimate for blocks of size 2^( 3) =       0.000464032011
  error estimate for blocks of size 2^( 4) =       0.000474776703
  error estimate for blocks of size 2^( 5) =       0.000485819571
  error estimate for blocks of size 2^( 6) =       0.000492493253
  error estimate for blocks of size 2^( 7) =       0.000497037239

      target function =                  N/A
              le_mean =     -16.905059328338
             les_mean =     286.168246940714
             stat err =       0.000487531692
             autocorr =       1.227671394097
              std dev =       0.622267016388
             le_variance =       0.387216239685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387325909674
                                         uncertainty =       0.053566066406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387325909674
                                         uncertainty =       0.053566066406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440008306
  error estimate for blocks of size 2^( 2) =       0.000452016082
  error estimate for blocks of size 2^( 3) =       0.000464031165
  error estimate for blocks of size 2^( 4) =       0.000474775882
  error estimate for blocks of size 2^( 5) =       0.000485818740
  error estimate for blocks of size 2^( 6) =       0.000492492414
  error estimate for blocks of size 2^( 7) =       0.000497036422

      target function =                  N/A
              le_mean =     -16.905059339270
             les_mean =     286.168245689606
             stat err =       0.000487530865
             autocorr =       1.227672368165
              std dev =       0.622265714120
             le_variance =       0.387214618969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387326718506
                                         uncertainty =       0.053566117464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387326718506
                                         uncertainty =       0.053566117464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440008765
  error estimate for blocks of size 2^( 2) =       0.000452016524
  error estimate for blocks of size 2^( 3) =       0.000464031587
  error estimate for blocks of size 2^( 4) =       0.000474776292
  error estimate for blocks of size 2^( 5) =       0.000485819155
  error estimate for blocks of size 2^( 6) =       0.000492492833
  error estimate for blocks of size 2^( 7) =       0.000497036830

      target function =                  N/A
              le_mean =     -16.905059333813
             les_mean =     286.168246313497
             stat err =       0.000487531277
             autocorr =       1.227671882326
              std dev =       0.622266363668
             le_variance =       0.387215427353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387327429626
                                         uncertainty =       0.053566162427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387327429626
                                         uncertainty =       0.053566162427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440009169
  error estimate for blocks of size 2^( 2) =       0.000452016912
  error estimate for blocks of size 2^( 3) =       0.000464031958
  error estimate for blocks of size 2^( 4) =       0.000474776652
  error estimate for blocks of size 2^( 5) =       0.000485819519
  error estimate for blocks of size 2^( 6) =       0.000492493200
  error estimate for blocks of size 2^( 7) =       0.000497037188

      target function =                  N/A
              le_mean =     -16.905059329023
             les_mean =     286.168246862253
             stat err =       0.000487531640
             autocorr =       1.227671455155
              std dev =       0.622266934747
             le_variance =       0.387216138080


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905059328338        initial
     1.4552e+02     1.4552e+03             1.6463e-06       -16.905059339270  <--
     5.8208e+02     5.8208e+03             4.1160e-07       -16.905059333813
     2.3283e+03     2.3283e+04             1.0290e-07       -16.905059329023

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 2.9553e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.095201e-01 1 1  ON 0
 uu_1                 1.426108e-01 1 1  ON 1
 uu_2                 4.075731e-02 1 1  ON 2
 uu_3                -2.192554e-02 1 1  ON 3
 uu_4                -6.789597e-02 1 1  ON 4
 uu_5                -1.031887e-01 1 1  ON 5
 uu_6                -1.316344e-01 1 1  ON 6
 uu_7                -1.460961e-01 1 1  ON 7
 uu_8                -1.390784e-01 1 1  ON 8
 uu_9                -1.111890e-01 1 1  ON 9
 ud_0                 4.545888e-01 1 1  ON 10
 ud_1                 1.880161e-01 1 1  ON 11
 ud_2                 6.646956e-02 1 1  ON 12
 ud_3                -5.659344e-03 1 1  ON 13
 ud_4                -6.327304e-02 1 1  ON 14
 ud_5                -1.055939e-01 1 1  ON 15
 ud_6                -1.337190e-01 1 1  ON 16
 ud_7                -1.515868e-01 1 1  ON 17
 ud_8                -1.531793e-01 1 1  ON 18
 ud_9                -1.455855e-01 1 1  ON 19
 eO_0                -7.642936e-01 1 1  ON 20
 eO_1                -4.409103e-01 1 1  ON 21
 eO_2                -1.727579e-02 1 1  ON 22
 eO_3                 3.069134e-01 1 1  ON 23
 eO_4                 5.353363e-01 1 1  ON 24
 eO_5                 4.991968e-01 1 1  ON 25
 eO_6                 2.693994e-01 1 1  ON 26
 eO_7                -3.700597e-02 1 1  ON 27
 eO_8                -2.392365e-01 1 1  ON 28
 eO_9                -1.073131e-01 1 1  ON 29
eH1_0                -2.554777e-01 1 1  ON 30
eH1_1                -1.538082e-01 1 1  ON 31
eH1_2                -1.066395e-01 1 1  ON 32
eH1_3                -5.187002e-02 1 1  ON 33
eH1_4                -3.344801e-03 1 1  ON 34
eH1_5                 3.232526e-02 1 1  ON 35
eH1_6                 9.351291e-02 1 1  ON 36
eH1_7                 1.549206e-01 1 1  ON 37
eH1_8                 1.944978e-01 1 1  ON 38
eH1_9                 9.520282e-02 1 1  ON 39
eH2_0                -2.525027e-01 1 1  ON 40
eH2_1                -1.512111e-01 1 1  ON 41
eH2_2                -1.037652e-01 1 1  ON 42
eH2_3                -4.918115e-02 1 1  ON 43
eH2_4                -9.034138e-04 1 1  ON 44
eH2_5                 3.398438e-02 1 1  ON 45
eH2_6                 9.533144e-02 1 1  ON 46
eH2_7                 1.555806e-01 1 1  ON 47
eH2_8                 1.975736e-01 1 1  ON 48
eH2_9                 8.840239e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5384e+01 secs
  Total Execution time = 2.2556e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
