Rank =    0  Free Memory = 86102 MB
Rank =    1  Free Memory = 86101 MB
Rank =    2  Free Memory = 86101 MB
Rank =    3  Free Memory = 86101 MB
Rank =    4  Free Memory = 86101 MB
Rank =    5  Free Memory = 86100 MB
Rank =    6  Free Memory = 86100 MB
Rank =    7  Free Memory = 86100 MB
Rank =    8  Free Memory = 86100 MB
Rank =    9  Free Memory = 86099 MB
Rank =   10  Free Memory = 86099 MB
Rank =   11  Free Memory = 86099 MB
Rank =   12  Free Memory = 86099 MB
Rank =   13  Free Memory = 86099 MB
Rank =   14  Free Memory = 86099 MB
Rank =   15  Free Memory = 86086 MB
Rank =   16  Free Memory = 86086 MB
Rank =   17  Free Memory = 86086 MB
Rank =   18  Free Memory = 86086 MB
Rank =   19  Free Memory = 86086 MB
Rank =   20  Free Memory = 86086 MB
Rank =   21  Free Memory = 86086 MB
Rank =   22  Free Memory = 86086 MB
Rank =   23  Free Memory = 86086 MB
Rank =   24  Free Memory = 86086 MB
Rank =   25  Free Memory = 86086 MB
Rank =   26  Free Memory = 86086 MB
Rank =   27  Free Memory = 86086 MB
Rank =   28  Free Memory = 86086 MB
Rank =   29  Free Memory = 86086 MB
Rank =   30  Free Memory = 86086 MB
Rank =   31  Free Memory = 86086 MB
Rank =   32  Free Memory = 88147 MB
Rank =   33  Free Memory = 88147 MB
Rank =   34  Free Memory = 88147 MB
Rank =   35  Free Memory = 88147 MB
Rank =   36  Free Memory = 88147 MB
Rank =   37  Free Memory = 88147 MB
Rank =   38  Free Memory = 88147 MB
Rank =   39  Free Memory = 88147 MB
Rank =   40  Free Memory = 88147 MB
Rank =   41  Free Memory = 88147 MB
Rank =   42  Free Memory = 88147 MB
Rank =   43  Free Memory = 88147 MB
Rank =   44  Free Memory = 88147 MB
Rank =   45  Free Memory = 88147 MB
Rank =   46  Free Memory = 88147 MB
Rank =   47  Free Memory = 88147 MB
Rank =   48  Free Memory = 88147 MB
Rank =   49  Free Memory = 88146 MB
Rank =   50  Free Memory = 88146 MB
Rank =   51  Free Memory = 88146 MB
Rank =   52  Free Memory = 88146 MB
Rank =   53  Free Memory = 88146 MB
Rank =   54  Free Memory = 88146 MB
Rank =   55  Free Memory = 88146 MB
Rank =   56  Free Memory = 88146 MB
Rank =   57  Free Memory = 88146 MB
Rank =   58  Free Memory = 88146 MB
Rank =   59  Free Memory = 88146 MB
Rank =   60  Free Memory = 88146 MB
Rank =   61  Free Memory = 88146 MB
Rank =   62  Free Memory = 88146 MB
Rank =   63  Free Memory = 88146 MB
Rank =   64  Free Memory = 88244 MB
Rank =   65  Free Memory = 88244 MB
Rank =   66  Free Memory = 88244 MB
Rank =   67  Free Memory = 88244 MB
Rank =   68  Free Memory = 88244 MB
Rank =   69  Free Memory = 88244 MB
Rank =   70  Free Memory = 88244 MB
Rank =   71  Free Memory = 88244 MB
Rank =   72  Free Memory = 88244 MB
Rank =   73  Free Memory = 88244 MB
Rank =   74  Free Memory = 88244 MB
Rank =   75  Free Memory = 88244 MB
Rank =   76  Free Memory = 88244 MB
Rank =   77  Free Memory = 88244 MB
Rank =   78  Free Memory = 88244 MB
Rank =   79  Free Memory = 88244 MB
Rank =   80  Free Memory = 88244 MB
Rank =   81  Free Memory = 88244 MB
Rank =   82  Free Memory = 88244 MB
Rank =   83  Free Memory = 88244 MB
Rank =   84  Free Memory = 88244 MB
Rank =   85  Free Memory = 88244 MB
Rank =   86  Free Memory = 88244 MB
Rank =   87  Free Memory = 88244 MB
Rank =   88  Free Memory = 88244 MB
Rank =   89  Free Memory = 88244 MB
Rank =   90  Free Memory = 88244 MB
Rank =   91  Free Memory = 88244 MB
Rank =   92  Free Memory = 88244 MB
Rank =   93  Free Memory = 88244 MB
Rank =   94  Free Memory = 88244 MB
Rank =   95  Free Memory = 88244 MB
Rank =   96  Free Memory = 86620 MB
Rank =   97  Free Memory = 86620 MB
Rank =   98  Free Memory = 86620 MB
Rank =   99  Free Memory = 86620 MB
Rank =  100  Free Memory = 86620 MB
Rank =  101  Free Memory = 86620 MB
Rank =  102  Free Memory = 86620 MB
Rank =  103  Free Memory = 86620 MB
Rank =  104  Free Memory = 86620 MB
Rank =  105  Free Memory = 86620 MB
Rank =  106  Free Memory = 86620 MB
Rank =  107  Free Memory = 86620 MB
Rank =  108  Free Memory = 86620 MB
Rank =  109  Free Memory = 86620 MB
Rank =  110  Free Memory = 86620 MB
Rank =  111  Free Memory = 86620 MB
Rank =  112  Free Memory = 86620 MB
Rank =  113  Free Memory = 86620 MB
Rank =  114  Free Memory = 86620 MB
Rank =  115  Free Memory = 86620 MB
Rank =  116  Free Memory = 86620 MB
Rank =  117  Free Memory = 86620 MB
Rank =  118  Free Memory = 86620 MB
Rank =  119  Free Memory = 86620 MB
Rank =  120  Free Memory = 86620 MB
Rank =  121  Free Memory = 86620 MB
Rank =  122  Free Memory = 86620 MB
Rank =  123  Free Memory = 86620 MB
Rank =  124  Free Memory = 86620 MB
Rank =  125  Free Memory = 86620 MB
Rank =  126  Free Memory = 86620 MB
Rank =  127  Free Memory = 86620 MB
  Input file(s): opt_h2o_1b1_gvptt_run002h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002h.xml

  Project = H2O
  date    = 2023-04-01 14:35:59 PDT
  host    = n0103.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 959

  Range of prime numbers to use as seeds over processors and threads = 7573-8737


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.083072e-01    1         1  ON     0
     uu_1                 1.418335e-01    1         1  ON     1
     uu_2                 4.068477e-02    1         1  ON     2
     uu_3                -2.080713e-02    1         1  ON     3
     uu_4                -6.473429e-02    1         1  ON     4
     uu_5                -9.793577e-02    1         1  ON     5
     uu_6                -1.234358e-01    1         1  ON     6
     uu_7                -1.362238e-01    1         1  ON     7
     uu_8                -1.288475e-01    1         1  ON     8
     uu_9                -9.825879e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.456881e-01    1         1  ON     0
     ud_1                 1.799366e-01    1         1  ON     1
     ud_2                 5.927749e-02    1         1  ON     2
     ud_3                -1.165626e-02    1         1  ON     3
     ud_4                -6.783081e-02    1         1  ON     4
     ud_5                -1.080207e-01    1         1  ON     5
     ud_6                -1.341316e-01    1         1  ON     6
     ud_7                -1.495930e-01    1         1  ON     7
     ud_8                -1.492243e-01    1         1  ON     8
     ud_9                -1.372082e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.596337e-01    1         1  ON     0
     eO_1                -4.383757e-01    1         1  ON     1
     eO_2                -1.685553e-02    1         1  ON     2
     eO_3                 3.022898e-01    1         1  ON     3
     eO_4                 5.214676e-01    1         1  ON     4
     eO_5                 4.756440e-01    1         1  ON     5
     eO_6                 2.443873e-01    1         1  ON     6
     eO_7                -5.235253e-02    1         1  ON     7
     eO_8                -2.096183e-01    1         1  ON     8
     eO_9                -6.833303e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.362296e-01    1         1  ON     0
     eH1_1                -1.368989e-01    1         1  ON     1
     eH1_2                -9.137783e-02    1         1  ON     2
     eH1_3                -3.798124e-02    1         1  ON     3
     eH1_4                 8.899478e-03    1         1  ON     4
     eH1_5                 4.250220e-02    1         1  ON     5
     eH1_6                 9.881533e-02    1         1  ON     6
     eH1_7                 1.478830e-01    1         1  ON     7
     eH1_8                 1.618586e-01    1         1  ON     8
     eH1_9                 4.685982e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.329655e-01    1         1  ON     0
     eH2_1                -1.337629e-01    1         1  ON     1
     eH2_2                -8.814995e-02    1         1  ON     2
     eH2_3                -3.494031e-02    1         1  ON     3
     eH2_4                 1.228326e-02    1         1  ON     4
     eH2_5                 4.599478e-02    1         1  ON     5
     eH2_6                 1.017750e-01    1         1  ON     6
     eH2_7                 1.496309e-01    1         1  ON     7
     eH2_8                 1.671744e-01    1         1  ON     8
     eH2_9                 3.091025e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.442465e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.7440e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8676
    reference variance = 0.203243
====================================================
  Execution time = 3.4777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.8747e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387577816716
                                         uncertainty =       0.045721416242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387577816716
                                         uncertainty =       0.045721416242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440154183
  error estimate for blocks of size 2^( 2) =       0.000452418174
  error estimate for blocks of size 2^( 3) =       0.000464897936
  error estimate for blocks of size 2^( 4) =       0.000476919228
  error estimate for blocks of size 2^( 5) =       0.000487192700
  error estimate for blocks of size 2^( 6) =       0.000494326118
  error estimate for blocks of size 2^( 7) =       0.000499893689

      target function =                  N/A
              le_mean =     -16.906042765079
             les_mean =     286.201753190123
             stat err =       0.000489582934
             autocorr =       1.237208440009
              std dev =       0.622472014783
             le_variance =       0.387471409189


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690604276508e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906042765079       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906043582990       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906043587659       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906045155020       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906044228000       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043894328       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906044031281       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906044410814       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906044363956       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906044448802       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.112433e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906042765079       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906043076461       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906043106566       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906043462428       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906043526914       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043478684       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906043411882       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906043361898       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.273668e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906042765079       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906042854629       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906042869900       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906042956122       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906042982734       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906042989600       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906042987764       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906042964747       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.825526e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4092e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.082556e-01                 1 1 ON  0
uu_1  1.418898e-01                 1 1 ON  1
uu_2  4.079266e-02                 1 1 ON  2
uu_3  -2.086633e-02                1 1 ON  3
uu_4  -6.476488e-02                1 1 ON  4
uu_5  -9.797445e-02                1 1 ON  5
uu_6  -1.235022e-01                1 1 ON  6
uu_7  -1.362597e-01                1 1 ON  7
uu_8  -1.288121e-01                1 1 ON  8
uu_9  -9.835722e-02                1 1 ON  9
ud_0  4.458290e-01                 1 1 ON  10
ud_1  1.799453e-01                 1 1 ON  11
ud_2  5.932448e-02                 1 1 ON  12
ud_3  -1.162397e-02                1 1 ON  13
ud_4  -6.786072e-02                1 1 ON  14
ud_5  -1.080323e-01                1 1 ON  15
ud_6  -1.341061e-01                1 1 ON  16
ud_7  -1.494655e-01                1 1 ON  17
ud_8  -1.493748e-01                1 1 ON  18
ud_9  -1.373304e-01                1 1 ON  19
eO_0  -7.597919e-01                1 1 ON  20
eO_1  -4.385155e-01                1 1 ON  21
eO_2  -1.693693e-02                1 1 ON  22
eO_3  3.023553e-01                 1 1 ON  23
eO_4  5.216950e-01                 1 1 ON  24
eO_5  4.758340e-01                 1 1 ON  25
eO_6  2.445315e-01                 1 1 ON  26
eO_7  -5.225810e-02                1 1 ON  27
eO_8  -2.097869e-01                1 1 ON  28
eO_9  -6.848342e-02                1 1 ON  29
eH1_0 -2.362707e-01                1 1 ON  30
eH1_1 -1.370098e-01                1 1 ON  31
eH1_2 -9.143051e-02                1 1 ON  32
eH1_3 -3.803553e-02                1 1 ON  33
eH1_4 8.910828e-03                 1 1 ON  34
eH1_5 4.248858e-02                 1 1 ON  35
eH1_6 9.875283e-02                 1 1 ON  36
eH1_7 1.479038e-01                 1 1 ON  37
eH1_8 1.620157e-01                 1 1 ON  38
eH1_9 4.701390e-02                 1 1 ON  39
eH2_0 -2.331649e-01                1 1 ON  40
eH2_1 -1.338241e-01                1 1 ON  41
eH2_2 -8.828138e-02                1 1 ON  42
eH2_3 -3.497722e-02                1 1 ON  43
eH2_4 1.226361e-02                 1 1 ON  44
eH2_5 4.602045e-02                 1 1 ON  45
eH2_6 1.018312e-01                 1 1 ON  46
eH2_7 1.496907e-01                 1 1 ON  47
eH2_8 1.673166e-01                 1 1 ON  48
eH2_9 3.107725e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9353
    reference variance = 0.287998
====================================================
  Execution time = 3.4096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4307e-01
  Total weights = 2.0000e+06
  Execution time = 3.1853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343054565818
                                         uncertainty =       0.005611304275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343054565818
                                         uncertainty =       0.005611304275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414117304
  error estimate for blocks of size 2^( 2) =       0.000426943768
  error estimate for blocks of size 2^( 3) =       0.000439855444
  error estimate for blocks of size 2^( 4) =       0.000450490098
  error estimate for blocks of size 2^( 5) =       0.000461474562
  error estimate for blocks of size 2^( 6) =       0.000468411156
  error estimate for blocks of size 2^( 7) =       0.000475391780

      target function =                  N/A
              le_mean =     -16.904623805760
             les_mean =     286.109292126397
             stat err =       0.000463941899
             autocorr =       1.255106083977
              std dev =       0.585650308322
             le_variance =       0.342986283638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343268389916
                                         uncertainty =       0.005617633425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343268389916
                                         uncertainty =       0.005617633425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414246281
  error estimate for blocks of size 2^( 2) =       0.000427065168
  error estimate for blocks of size 2^( 3) =       0.000439968380
  error estimate for blocks of size 2^( 4) =       0.000450593482
  error estimate for blocks of size 2^( 5) =       0.000461576081
  error estimate for blocks of size 2^( 6) =       0.000468510184
  error estimate for blocks of size 2^( 7) =       0.000475492513

      target function =                  N/A
              le_mean =     -16.904627253578
             les_mean =     286.109622373658
             stat err =       0.000464043065
             autocorr =       1.254871733486
              std dev =       0.585832708927
             le_variance =       0.343199962849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343216579326
                                         uncertainty =       0.005616159524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343216579326
                                         uncertainty =       0.005616159524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414215026
  error estimate for blocks of size 2^( 2) =       0.000427035241
  error estimate for blocks of size 2^( 3) =       0.000439940693
  error estimate for blocks of size 2^( 4) =       0.000450568327
  error estimate for blocks of size 2^( 5) =       0.000461553004
  error estimate for blocks of size 2^( 6) =       0.000468487702
  error estimate for blocks of size 2^( 7) =       0.000475472060

      target function =                  N/A
              le_mean =     -16.904626338170
             les_mean =     286.109539636999
             stat err =       0.000464020273
             autocorr =       1.254937833872
              std dev =       0.585788507407
             le_variance =       0.343148175410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343080708082
                                         uncertainty =       0.005612072680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343080708082
                                         uncertainty =       0.005612072680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414133073
  error estimate for blocks of size 2^( 2) =       0.000426958535
  error estimate for blocks of size 2^( 3) =       0.000439869265
  error estimate for blocks of size 2^( 4) =       0.000450502850
  error estimate for blocks of size 2^( 5) =       0.000461487416
  error estimate for blocks of size 2^( 6) =       0.000468423712
  error estimate for blocks of size 2^( 7) =       0.000475405053

      target function =                  N/A
              le_mean =     -16.904624138531
             les_mean =     286.109329498386
             stat err =       0.000463954758
             autocorr =       1.255080073846
              std dev =       0.585672608950
             le_variance =       0.343012404875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904623805760        initial
     2.5000e-01     2.5000e+00             8.1124e-04       -16.904627253578  <--
     1.0000e+00     1.0000e+01             2.2737e-04       -16.904626338170
     4.0000e+00     4.0000e+01             5.8255e-05       -16.904624138531

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.0121e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.082762e-01 1 1  ON 0
 uu_1                 1.420028e-01 1 1  ON 1
 uu_2                 4.090819e-02 1 1  ON 2
 uu_3                -2.095669e-02 1 1  ON 3
 uu_4                -6.487544e-02 1 1  ON 4
 uu_5                -9.813332e-02 1 1  ON 5
 uu_6                -1.236696e-01 1 1  ON 6
 uu_7                -1.363707e-01 1 1  ON 7
 uu_8                -1.287089e-01 1 1  ON 8
 uu_9                -9.862879e-02 1 1  ON 9
 ud_0                 4.460847e-01 1 1  ON 10
 ud_1                 1.800803e-01 1 1  ON 11
 ud_2                 5.947050e-02 1 1  ON 12
 ud_3                -1.153013e-02 1 1  ON 13
 ud_4                -6.788451e-02 1 1  ON 14
 ud_5                -1.080579e-01 1 1  ON 15
 ud_6                -1.340752e-01 1 1  ON 16
 ud_7                -1.492054e-01 1 1  ON 17
 ud_8                -1.497143e-01 1 1  ON 18
 ud_9                -1.376587e-01 1 1  ON 19
 eO_0                -7.602488e-01 1 1  ON 20
 eO_1                -4.389007e-01 1 1  ON 21
 eO_2                -1.712213e-02 1 1  ON 22
 eO_3                 3.024854e-01 1 1  ON 23
 eO_4                 5.222789e-01 1 1  ON 24
 eO_5                 4.764223e-01 1 1  ON 25
 eO_6                 2.449788e-01 1 1  ON 26
 eO_7                -5.196454e-02 1 1  ON 27
 eO_8                -2.102788e-01 1 1  ON 28
 eO_9                -6.893689e-02 1 1  ON 29
eH1_0                -2.364334e-01 1 1  ON 30
eH1_1                -1.372585e-01 1 1  ON 31
eH1_2                -9.160021e-02 1 1  ON 32
eH1_3                -3.818515e-02 1 1  ON 33
eH1_4                 8.859819e-03 1 1  ON 34
eH1_5                 4.243133e-02 1 1  ON 35
eH1_6                 9.859798e-02 1 1  ON 36
eH1_7                 1.479730e-01 1 1  ON 37
eH1_8                 1.624901e-01 1 1  ON 38
eH1_9                 4.748728e-02 1 1  ON 39
eH2_0                -2.336694e-01 1 1  ON 40
eH2_1                -1.340593e-01 1 1  ON 41
eH2_2                -8.859007e-02 1 1  ON 42
eH2_3                -3.514201e-02 1 1  ON 43
eH2_4                 1.217058e-02 1 1  ON 44
eH2_5                 4.603938e-02 1 1  ON 45
eH2_6                 1.019816e-01 1 1  ON 46
eH2_7                 1.498792e-01 1 1  ON 47
eH2_8                 1.677553e-01 1 1  ON 48
eH2_9                 3.159171e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8675
    reference variance = 0.193919
====================================================
  Execution time = 3.4958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3860e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338663673662
                                         uncertainty =       0.004318723191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338663673662
                                         uncertainty =       0.004318723191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411460557
  error estimate for blocks of size 2^( 2) =       0.000424266100
  error estimate for blocks of size 2^( 3) =       0.000437150182
  error estimate for blocks of size 2^( 4) =       0.000449653168
  error estimate for blocks of size 2^( 5) =       0.000459870536
  error estimate for blocks of size 2^( 6) =       0.000468263475
  error estimate for blocks of size 2^( 7) =       0.000473139394

      target function =                  N/A
              le_mean =     -16.905915230952
             les_mean =     286.148569206534
             stat err =       0.000462731643
             autocorr =       1.264742110690
              std dev =       0.581893099877
             le_variance =       0.338599579684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591523095e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905915230952       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905914412020       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905914135711       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905914153139       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905915004177       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905918413884       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905922645250       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905921924190       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905921247858       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905922260484       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905921965976       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905921549856       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905921519956       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.237909e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905915230952       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905914689477       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905914461776       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905914082635       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905914331700       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905916108446       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905916035379       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905916219906       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905916148824       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905916321179       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.062610e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905915230952       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905915001047       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905914883198       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905914605133       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905914967496       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905915041700       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905915107095       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905915133424       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905915137221       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.661233e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011041 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4037e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.084510e-01 1 1  ON 0
 uu_1                 1.419560e-01 1 1  ON 1
 uu_2                 4.100608e-02 1 1  ON 2
 uu_3                -2.093507e-02 1 1  ON 3
 uu_4                -6.489714e-02 1 1  ON 4
 uu_5                -9.818536e-02 1 1  ON 5
 uu_6                -1.239783e-01 1 1  ON 6
 uu_7                -1.363444e-01 1 1  ON 7
 uu_8                -1.290449e-01 1 1  ON 8
 uu_9                -9.912053e-02 1 1  ON 9
 ud_0                 4.460470e-01 1 1  ON 10
 ud_1                 1.800439e-01 1 1  ON 11
 ud_2                 5.970238e-02 1 1  ON 12
 ud_3                -1.148868e-02 1 1  ON 13
 ud_4                -6.791614e-02 1 1  ON 14
 ud_5                -1.079746e-01 1 1  ON 15
 ud_6                -1.341056e-01 1 1  ON 16
 ud_7                -1.493050e-01 1 1  ON 17
 ud_8                -1.496864e-01 1 1  ON 18
 ud_9                -1.377022e-01 1 1  ON 19
 eO_0                -7.602728e-01 1 1  ON 20
 eO_1                -4.391854e-01 1 1  ON 21
 eO_2                -1.748396e-02 1 1  ON 22
 eO_3                 3.021876e-01 1 1  ON 23
 eO_4                 5.225570e-01 1 1  ON 24
 eO_5                 4.772689e-01 1 1  ON 25
 eO_6                 2.456193e-01 1 1  ON 26
 eO_7                -5.155232e-02 1 1  ON 27
 eO_8                -2.108486e-01 1 1  ON 28
 eO_9                -6.948954e-02 1 1  ON 29
eH1_0                -2.370364e-01 1 1  ON 30
eH1_1                -1.372669e-01 1 1  ON 31
eH1_2                -9.189535e-02 1 1  ON 32
eH1_3                -3.846913e-02 1 1  ON 33
eH1_4                 8.905473e-03 1 1  ON 34
eH1_5                 4.217549e-02 1 1  ON 35
eH1_6                 9.825367e-02 1 1  ON 36
eH1_7                 1.482188e-01 1 1  ON 37
eH1_8                 1.632292e-01 1 1  ON 38
eH1_9                 4.818451e-02 1 1  ON 39
eH2_0                -2.342229e-01 1 1  ON 40
eH2_1                -1.346139e-01 1 1  ON 41
eH2_2                -8.866717e-02 1 1  ON 42
eH2_3                -3.520046e-02 1 1  ON 43
eH2_4                 1.205704e-02 1 1  ON 44
eH2_5                 4.568062e-02 1 1  ON 45
eH2_6                 1.016453e-01 1 1  ON 46
eH2_7                 1.499223e-01 1 1  ON 47
eH2_8                 1.685991e-01 1 1  ON 48
eH2_9                 3.265432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9353
    reference variance = 0.671125
====================================================
  Execution time = 3.4474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3869e-01
  Total weights = 2.0000e+06
  Execution time = 3.1932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338144421632
                                         uncertainty =       0.004702374561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338144421632
                                         uncertainty =       0.004702374561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411640667
  error estimate for blocks of size 2^( 2) =       0.000424502542
  error estimate for blocks of size 2^( 3) =       0.000438070370
  error estimate for blocks of size 2^( 4) =       0.000450760013
  error estimate for blocks of size 2^( 5) =       0.000461973492
  error estimate for blocks of size 2^( 6) =       0.000471104453
  error estimate for blocks of size 2^( 7) =       0.000477768986

      target function =                  N/A
              le_mean =     -16.905943956883
             les_mean =     286.149836982057
             stat err =       0.000465401736
             autocorr =       1.278260740242
              std dev =       0.582147814762
             le_variance =       0.338896078232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337866992715
                                         uncertainty =       0.004695599809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337866992715
                                         uncertainty =       0.004695599809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411472023
  error estimate for blocks of size 2^( 2) =       0.000424344553
  error estimate for blocks of size 2^( 3) =       0.000437922038
  error estimate for blocks of size 2^( 4) =       0.000450607806
  error estimate for blocks of size 2^( 5) =       0.000461816697
  error estimate for blocks of size 2^( 6) =       0.000470950803
  error estimate for blocks of size 2^( 7) =       0.000477607279

      target function =                  N/A
              le_mean =     -16.905949122825
             les_mean =     286.149734025026
             stat err =       0.000465245646
             autocorr =       1.278450781718
              std dev =       0.581909314907
             le_variance =       0.338618450776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337732336347
                                         uncertainty =       0.004694573714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337732336347
                                         uncertainty =       0.004694573714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411390098
  error estimate for blocks of size 2^( 2) =       0.000424268037
  error estimate for blocks of size 2^( 3) =       0.000437854746
  error estimate for blocks of size 2^( 4) =       0.000450549896
  error estimate for blocks of size 2^( 5) =       0.000461767609
  error estimate for blocks of size 2^( 6) =       0.000470915826
  error estimate for blocks of size 2^( 7) =       0.000477579485

      target function =                  N/A
              le_mean =     -16.905949745737
             les_mean =     286.149620261156
             stat err =       0.000465203204
             autocorr =       1.278726681148
              std dev =       0.581793455623
             le_variance =       0.338483625006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338050597864
                                         uncertainty =       0.004700679429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338050597864
                                         uncertainty =       0.004700679429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411583643
  error estimate for blocks of size 2^( 2) =       0.000424449223
  error estimate for blocks of size 2^( 3) =       0.000438021519
  error estimate for blocks of size 2^( 4) =       0.000450712848
  error estimate for blocks of size 2^( 5) =       0.000461927922
  error estimate for blocks of size 2^( 6) =       0.000471063771
  error estimate for blocks of size 2^( 7) =       0.000477729249

      target function =                  N/A
              le_mean =     -16.905944673154
             les_mean =     286.149767312211
             stat err =       0.000465358448
             autocorr =       1.278377124981
              std dev =       0.582067169543
             le_variance =       0.338802189860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905943956883        initial
     6.2500e-02     6.2500e-01             4.2379e-03       -16.905949122825
     2.5000e-01     2.5000e+00             1.0626e-03       -16.905949745737  <--
     1.0000e+00     1.0000e+01             2.6612e-04       -16.905944673154

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.0519e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.084510e-01 1 1  ON 0
 uu_1                 1.419560e-01 1 1  ON 1
 uu_2                 4.100608e-02 1 1  ON 2
 uu_3                -2.093507e-02 1 1  ON 3
 uu_4                -6.489714e-02 1 1  ON 4
 uu_5                -9.818536e-02 1 1  ON 5
 uu_6                -1.239783e-01 1 1  ON 6
 uu_7                -1.363444e-01 1 1  ON 7
 uu_8                -1.290449e-01 1 1  ON 8
 uu_9                -9.912053e-02 1 1  ON 9
 ud_0                 4.460470e-01 1 1  ON 10
 ud_1                 1.800439e-01 1 1  ON 11
 ud_2                 5.970238e-02 1 1  ON 12
 ud_3                -1.148868e-02 1 1  ON 13
 ud_4                -6.791614e-02 1 1  ON 14
 ud_5                -1.079746e-01 1 1  ON 15
 ud_6                -1.341056e-01 1 1  ON 16
 ud_7                -1.493050e-01 1 1  ON 17
 ud_8                -1.496864e-01 1 1  ON 18
 ud_9                -1.377022e-01 1 1  ON 19
 eO_0                -7.602728e-01 1 1  ON 20
 eO_1                -4.391854e-01 1 1  ON 21
 eO_2                -1.748396e-02 1 1  ON 22
 eO_3                 3.021876e-01 1 1  ON 23
 eO_4                 5.225570e-01 1 1  ON 24
 eO_5                 4.772689e-01 1 1  ON 25
 eO_6                 2.456193e-01 1 1  ON 26
 eO_7                -5.155232e-02 1 1  ON 27
 eO_8                -2.108486e-01 1 1  ON 28
 eO_9                -6.948954e-02 1 1  ON 29
eH1_0                -2.370364e-01 1 1  ON 30
eH1_1                -1.372669e-01 1 1  ON 31
eH1_2                -9.189535e-02 1 1  ON 32
eH1_3                -3.846913e-02 1 1  ON 33
eH1_4                 8.905473e-03 1 1  ON 34
eH1_5                 4.217549e-02 1 1  ON 35
eH1_6                 9.825367e-02 1 1  ON 36
eH1_7                 1.482188e-01 1 1  ON 37
eH1_8                 1.632292e-01 1 1  ON 38
eH1_9                 4.818451e-02 1 1  ON 39
eH2_0                -2.342229e-01 1 1  ON 40
eH2_1                -1.346139e-01 1 1  ON 41
eH2_2                -8.866717e-02 1 1  ON 42
eH2_3                -3.520046e-02 1 1  ON 43
eH2_4                 1.205704e-02 1 1  ON 44
eH2_5                 4.568062e-02 1 1  ON 45
eH2_6                 1.016453e-01 1 1  ON 46
eH2_7                 1.499223e-01 1 1  ON 47
eH2_8                 1.685991e-01 1 1  ON 48
eH2_9                 3.265432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4563e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9275
    reference variance = 0.236289
====================================================
  Execution time = 3.4540e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3377e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333750099723
                                         uncertainty =       0.002775351009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333750099723
                                         uncertainty =       0.002775351009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408517388
  error estimate for blocks of size 2^( 2) =       0.000420993152
  error estimate for blocks of size 2^( 3) =       0.000433686194
  error estimate for blocks of size 2^( 4) =       0.000445953958
  error estimate for blocks of size 2^( 5) =       0.000456831188
  error estimate for blocks of size 2^( 6) =       0.000466355417
  error estimate for blocks of size 2^( 7) =       0.000470791321

      target function =                  N/A
              le_mean =     -16.906607644918
             les_mean =     286.167154804950
             stat err =       0.000459982971
             autocorr =       1.267834061237
              std dev =       0.577730830607
             le_variance =       0.333772912634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660764492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906607644918       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906610220623       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906612081370       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906612213993       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906609823712       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906614715610       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906616998336       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906616508818       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906618767105       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906619479101       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906620317523       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906619508216       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906619629607       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.427376e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906607644918       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906609210972       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906610299157       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906611067603       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906609108438       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906610628566       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906611373679       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906610848292       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906611083252       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906611434802       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.137780e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906607644918       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906608254762       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906608722367       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906609162561       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906608365899       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906608906255       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906608814688       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906608750746       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.327499e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3680e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.082128e-01 1 1  ON 0
 uu_1                 1.419050e-01 1 1  ON 1
 uu_2                 4.117926e-02 1 1  ON 2
 uu_3                -2.074166e-02 1 1  ON 3
 uu_4                -6.499490e-02 1 1  ON 4
 uu_5                -9.819326e-02 1 1  ON 5
 uu_6                -1.240630e-01 1 1  ON 6
 uu_7                -1.364260e-01 1 1  ON 7
 uu_8                -1.291858e-01 1 1  ON 8
 uu_9                -9.958810e-02 1 1  ON 9
 ud_0                 4.463787e-01 1 1  ON 10
 ud_1                 1.804666e-01 1 1  ON 11
 ud_2                 5.997131e-02 1 1  ON 12
 ud_3                -1.118044e-02 1 1  ON 13
 ud_4                -6.789917e-02 1 1  ON 14
 ud_5                -1.079828e-01 1 1  ON 15
 ud_6                -1.340997e-01 1 1  ON 16
 ud_7                -1.493601e-01 1 1  ON 17
 ud_8                -1.501108e-01 1 1  ON 18
 ud_9                -1.384059e-01 1 1  ON 19
 eO_0                -7.607826e-01 1 1  ON 20
 eO_1                -4.397075e-01 1 1  ON 21
 eO_2                -1.787566e-02 1 1  ON 22
 eO_3                 3.024528e-01 1 1  ON 23
 eO_4                 5.232428e-01 1 1  ON 24
 eO_5                 4.781827e-01 1 1  ON 25
 eO_6                 2.462142e-01 1 1  ON 26
 eO_7                -5.129799e-02 1 1  ON 27
 eO_8                -2.114486e-01 1 1  ON 28
 eO_9                -7.008716e-02 1 1  ON 29
eH1_0                -2.370852e-01 1 1  ON 30
eH1_1                -1.375880e-01 1 1  ON 31
eH1_2                -9.210338e-02 1 1  ON 32
eH1_3                -3.866960e-02 1 1  ON 33
eH1_4                 8.639015e-03 1 1  ON 34
eH1_5                 4.194648e-02 1 1  ON 35
eH1_6                 9.802832e-02 1 1  ON 36
eH1_7                 1.485986e-01 1 1  ON 37
eH1_8                 1.639206e-01 1 1  ON 38
eH1_9                 4.872496e-02 1 1  ON 39
eH2_0                -2.349046e-01 1 1  ON 40
eH2_1                -1.350541e-01 1 1  ON 41
eH2_2                -8.895403e-02 1 1  ON 42
eH2_3                -3.529489e-02 1 1  ON 43
eH2_4                 1.170979e-02 1 1  ON 44
eH2_5                 4.567768e-02 1 1  ON 45
eH2_6                 1.016330e-01 1 1  ON 46
eH2_7                 1.501920e-01 1 1  ON 47
eH2_8                 1.693223e-01 1 1  ON 48
eH2_9                 3.351210e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.924
    reference variance = 0.15253
====================================================
  Execution time = 3.6260e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4710e-01
  Total weights = 2.0000e+06
  Execution time = 3.1866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347297812818
                                         uncertainty =       0.007499898619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347297812818
                                         uncertainty =       0.007499898619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416668920
  error estimate for blocks of size 2^( 2) =       0.000429460234
  error estimate for blocks of size 2^( 3) =       0.000442708369
  error estimate for blocks of size 2^( 4) =       0.000455572591
  error estimate for blocks of size 2^( 5) =       0.000466140820
  error estimate for blocks of size 2^( 6) =       0.000474043233
  error estimate for blocks of size 2^( 7) =       0.000479930252

      target function =                  N/A
              le_mean =     -16.905908912120
             les_mean =     286.156981948982
             stat err =       0.000468921724
             autocorr =       1.266538780802
              std dev =       0.589258837612
             le_variance =       0.347225977703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347302264795
                                         uncertainty =       0.007484025168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347302264795
                                         uncertainty =       0.007484025168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416671498
  error estimate for blocks of size 2^( 2) =       0.000429463621
  error estimate for blocks of size 2^( 3) =       0.000442699821
  error estimate for blocks of size 2^( 4) =       0.000455546522
  error estimate for blocks of size 2^( 5) =       0.000466096276
  error estimate for blocks of size 2^( 6) =       0.000473980423
  error estimate for blocks of size 2^( 7) =       0.000479860403

      target function =                  N/A
              le_mean =     -16.905907492138
             les_mean =     286.156938233861
             stat err =       0.000468870906
             autocorr =       1.266248610259
              std dev =       0.589262483730
             le_variance =       0.347230274732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347042473592
                                         uncertainty =       0.007476538089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347042473592
                                         uncertainty =       0.007476538089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416515643
  error estimate for blocks of size 2^( 2) =       0.000429313020
  error estimate for blocks of size 2^( 3) =       0.000442560264
  error estimate for blocks of size 2^( 4) =       0.000455421239
  error estimate for blocks of size 2^( 5) =       0.000465979880
  error estimate for blocks of size 2^( 6) =       0.000473876156
  error estimate for blocks of size 2^( 7) =       0.000479752945

      target function =                  N/A
              le_mean =     -16.905905515259
             les_mean =     286.156611679653
             stat err =       0.000468757555
             autocorr =       1.266583792556
              std dev =       0.589042071738
             le_variance =       0.346970562277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347214772638
                                         uncertainty =       0.007494525790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347214772638
                                         uncertainty =       0.007494525790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416619088
  error estimate for blocks of size 2^( 2) =       0.000429412091
  error estimate for blocks of size 2^( 3) =       0.000442660834
  error estimate for blocks of size 2^( 4) =       0.000455525706
  error estimate for blocks of size 2^( 5) =       0.000466092827
  error estimate for blocks of size 2^( 6) =       0.000473994826
  error estimate for blocks of size 2^( 7) =       0.000479879690

      target function =                  N/A
              le_mean =     -16.905907794842
             les_mean =     286.156861123474
             stat err =       0.000468873262
             autocorr =       1.266579943743
              std dev =       0.589188364919
             le_variance =       0.347142929356


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905908912120        initial  <--
     6.2500e-02     6.2500e-01             3.4274e-03       -16.905907492138
     2.5000e-01     2.5000e+00             9.1378e-04       -16.905905515259
     1.0000e+00     1.0000e+01             2.3275e-04       -16.905907794842

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.2470
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.084510e-01 1 1  ON 0
 uu_1                 1.419560e-01 1 1  ON 1
 uu_2                 4.100608e-02 1 1  ON 2
 uu_3                -2.093507e-02 1 1  ON 3
 uu_4                -6.489714e-02 1 1  ON 4
 uu_5                -9.818536e-02 1 1  ON 5
 uu_6                -1.239783e-01 1 1  ON 6
 uu_7                -1.363444e-01 1 1  ON 7
 uu_8                -1.290449e-01 1 1  ON 8
 uu_9                -9.912053e-02 1 1  ON 9
 ud_0                 4.460470e-01 1 1  ON 10
 ud_1                 1.800439e-01 1 1  ON 11
 ud_2                 5.970238e-02 1 1  ON 12
 ud_3                -1.148868e-02 1 1  ON 13
 ud_4                -6.791614e-02 1 1  ON 14
 ud_5                -1.079746e-01 1 1  ON 15
 ud_6                -1.341056e-01 1 1  ON 16
 ud_7                -1.493050e-01 1 1  ON 17
 ud_8                -1.496864e-01 1 1  ON 18
 ud_9                -1.377022e-01 1 1  ON 19
 eO_0                -7.602728e-01 1 1  ON 20
 eO_1                -4.391854e-01 1 1  ON 21
 eO_2                -1.748396e-02 1 1  ON 22
 eO_3                 3.021876e-01 1 1  ON 23
 eO_4                 5.225570e-01 1 1  ON 24
 eO_5                 4.772689e-01 1 1  ON 25
 eO_6                 2.456193e-01 1 1  ON 26
 eO_7                -5.155232e-02 1 1  ON 27
 eO_8                -2.108486e-01 1 1  ON 28
 eO_9                -6.948954e-02 1 1  ON 29
eH1_0                -2.370364e-01 1 1  ON 30
eH1_1                -1.372669e-01 1 1  ON 31
eH1_2                -9.189535e-02 1 1  ON 32
eH1_3                -3.846913e-02 1 1  ON 33
eH1_4                 8.905473e-03 1 1  ON 34
eH1_5                 4.217549e-02 1 1  ON 35
eH1_6                 9.825367e-02 1 1  ON 36
eH1_7                 1.482188e-01 1 1  ON 37
eH1_8                 1.632292e-01 1 1  ON 38
eH1_9                 4.818451e-02 1 1  ON 39
eH2_0                -2.342229e-01 1 1  ON 40
eH2_1                -1.346139e-01 1 1  ON 41
eH2_2                -8.866717e-02 1 1  ON 42
eH2_3                -3.520046e-02 1 1  ON 43
eH2_4                 1.205704e-02 1 1  ON 44
eH2_5                 4.568062e-02 1 1  ON 45
eH2_6                 1.016453e-01 1 1  ON 46
eH2_7                 1.499223e-01 1 1  ON 47
eH2_8                 1.685991e-01 1 1  ON 48
eH2_9                 3.265432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5934e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8954
    reference variance = 0.324799
====================================================
  Execution time = 3.6441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3874e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337965186352
                                         uncertainty =       0.004531963993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337965186352
                                         uncertainty =       0.004531963993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411543019
  error estimate for blocks of size 2^( 2) =       0.000424342827
  error estimate for blocks of size 2^( 3) =       0.000438608139
  error estimate for blocks of size 2^( 4) =       0.000450805286
  error estimate for blocks of size 2^( 5) =       0.000461953960
  error estimate for blocks of size 2^( 6) =       0.000469338176
  error estimate for blocks of size 2^( 7) =       0.000475935618

      target function =                  N/A
              le_mean =     -16.906255226406
             les_mean =     286.160200923568
             stat err =       0.000464508260
             autocorr =       1.273961796297
              std dev =       0.582009718599
             le_variance =       0.338735312543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690625522641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906255226406       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906254990315       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906254990180       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906255224101       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906254960214       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906256403521       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906256258759       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906256262131       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906256174460       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.325508e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906255226406       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906255151555       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906255117317       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906255141931       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906255028624       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906255383106       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906255410104       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906255398853       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906255388788       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.100936e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906255226406       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906255206349       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906255194232       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906255197064       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906255161543       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906255247961       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906255259710       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906255257739       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.727272e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5879e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.084339e-01 1 1  ON 0
 uu_1                 1.419531e-01 1 1  ON 1
 uu_2                 4.098443e-02 1 1  ON 2
 uu_3                -2.089572e-02 1 1  ON 3
 uu_4                -6.494736e-02 1 1  ON 4
 uu_5                -9.821806e-02 1 1  ON 5
 uu_6                -1.240128e-01 1 1  ON 6
 uu_7                -1.363623e-01 1 1  ON 7
 uu_8                -1.290357e-01 1 1  ON 8
 uu_9                -9.911311e-02 1 1  ON 9
 ud_0                 4.460844e-01 1 1  ON 10
 ud_1                 1.800777e-01 1 1  ON 11
 ud_2                 5.966893e-02 1 1  ON 12
 ud_3                -1.148675e-02 1 1  ON 13
 ud_4                -6.791495e-02 1 1  ON 14
 ud_5                -1.080013e-01 1 1  ON 15
 ud_6                -1.341139e-01 1 1  ON 16
 ud_7                -1.493206e-01 1 1  ON 17
 ud_8                -1.496869e-01 1 1  ON 18
 ud_9                -1.377186e-01 1 1  ON 19
 eO_0                -7.603271e-01 1 1  ON 20
 eO_1                -4.392044e-01 1 1  ON 21
 eO_2                -1.748429e-02 1 1  ON 22
 eO_3                 3.021431e-01 1 1  ON 23
 eO_4                 5.225943e-01 1 1  ON 24
 eO_5                 4.773790e-01 1 1  ON 25
 eO_6                 2.456829e-01 1 1  ON 26
 eO_7                -5.153850e-02 1 1  ON 27
 eO_8                -2.108909e-01 1 1  ON 28
 eO_9                -6.954573e-02 1 1  ON 29
eH1_0                -2.371241e-01 1 1  ON 30
eH1_1                -1.373623e-01 1 1  ON 31
eH1_2                -9.186107e-02 1 1  ON 32
eH1_3                -3.846004e-02 1 1  ON 33
eH1_4                 8.892787e-03 1 1  ON 34
eH1_5                 4.219831e-02 1 1  ON 35
eH1_6                 9.824236e-02 1 1  ON 36
eH1_7                 1.482165e-01 1 1  ON 37
eH1_8                 1.632835e-01 1 1  ON 38
eH1_9                 4.826406e-02 1 1  ON 39
eH2_0                -2.342670e-01 1 1  ON 40
eH2_1                -1.346745e-01 1 1  ON 41
eH2_2                -8.876333e-02 1 1  ON 42
eH2_3                -3.518296e-02 1 1  ON 43
eH2_4                 1.203378e-02 1 1  ON 44
eH2_5                 4.567542e-02 1 1  ON 45
eH2_6                 1.016150e-01 1 1  ON 46
eH2_7                 1.499680e-01 1 1  ON 47
eH2_8                 1.686751e-01 1 1  ON 48
eH2_9                 3.276253e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9805
    reference variance = 0.41501
====================================================
  Execution time = 3.4128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4065e-01
  Total weights = 2.0000e+06
  Execution time = 3.1606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340639349227
                                         uncertainty =       0.006071940595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340639349227
                                         uncertainty =       0.006071940595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412679067
  error estimate for blocks of size 2^( 2) =       0.000425093506
  error estimate for blocks of size 2^( 3) =       0.000437991865
  error estimate for blocks of size 2^( 4) =       0.000450689329
  error estimate for blocks of size 2^( 5) =       0.000461143142
  error estimate for blocks of size 2^( 6) =       0.000467544549
  error estimate for blocks of size 2^( 7) =       0.000471029558

      target function =                  N/A
              le_mean =     -16.905522497629
             les_mean =     286.137298772821
             stat err =       0.000462601644
             autocorr =       1.256578033380
              std dev =       0.583616333978
             le_variance =       0.340608025286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340754323823
                                         uncertainty =       0.006071780901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340754323823
                                         uncertainty =       0.006071780901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412748707
  error estimate for blocks of size 2^( 2) =       0.000425158596
  error estimate for blocks of size 2^( 3) =       0.000438052316
  error estimate for blocks of size 2^( 4) =       0.000450743794
  error estimate for blocks of size 2^( 5) =       0.000461193542
  error estimate for blocks of size 2^( 6) =       0.000467594910
  error estimate for blocks of size 2^( 7) =       0.000471079231

      target function =                  N/A
              le_mean =     -16.905522810102
             les_mean =     286.137424303004
             stat err =       0.000462652869
             autocorr =       1.256432253900
              std dev =       0.583714819492
             le_variance =       0.340722990494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340716048882
                                         uncertainty =       0.006071787202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340716048882
                                         uncertainty =       0.006071787202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412725534
  error estimate for blocks of size 2^( 2) =       0.000425136809
  error estimate for blocks of size 2^( 3) =       0.000438032153
  error estimate for blocks of size 2^( 4) =       0.000450725618
  error estimate for blocks of size 2^( 5) =       0.000461177250
  error estimate for blocks of size 2^( 6) =       0.000467579030
  error estimate for blocks of size 2^( 7) =       0.000471063895

      target function =                  N/A
              le_mean =     -16.905522637734
             les_mean =     286.137380216617
             stat err =       0.000462636448
             autocorr =       1.256484151127
              std dev =       0.583682047025
             le_variance =       0.340684732019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340650058621
                                         uncertainty =       0.006071918875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340650058621
                                         uncertainty =       0.006071918875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412685556
  error estimate for blocks of size 2^( 2) =       0.000425099532
  error estimate for blocks of size 2^( 3) =       0.000437997476
  error estimate for blocks of size 2^( 4) =       0.000450694383
  error estimate for blocks of size 2^( 5) =       0.000461147930
  error estimate for blocks of size 2^( 6) =       0.000467549411
  error estimate for blocks of size 2^( 7) =       0.000471034399

      target function =                  N/A
              le_mean =     -16.905522499553
             les_mean =     286.137309549131
             stat err =       0.000462606531
             autocorr =       1.256565063849
              std dev =       0.583625510543
             le_variance =       0.340618736557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905522497629        initial
     6.2500e-01     6.2500e+00             4.3255e-04       -16.905522810102  <--
     2.5000e+00     2.5000e+01             1.1009e-04       -16.905522637734
     1.0000e+01     1.0000e+02             2.7273e-05       -16.905522499553

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 5.0018e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.083875e-01 1 1  ON 0
 uu_1                 1.419403e-01 1 1  ON 1
 uu_2                 4.094765e-02 1 1  ON 2
 uu_3                -2.084277e-02 1 1  ON 3
 uu_4                -6.504960e-02 1 1  ON 4
 uu_5                -9.832130e-02 1 1  ON 5
 uu_6                -1.241140e-01 1 1  ON 6
 uu_7                -1.364183e-01 1 1  ON 7
 uu_8                -1.290108e-01 1 1  ON 8
 uu_9                -9.909016e-02 1 1  ON 9
 ud_0                 4.461784e-01 1 1  ON 10
 ud_1                 1.801455e-01 1 1  ON 11
 ud_2                 5.962463e-02 1 1  ON 12
 ud_3                -1.148984e-02 1 1  ON 13
 ud_4                -6.791582e-02 1 1  ON 14
 ud_5                -1.080673e-01 1 1  ON 15
 ud_6                -1.341456e-01 1 1  ON 16
 ud_7                -1.493675e-01 1 1  ON 17
 ud_8                -1.496881e-01 1 1  ON 18
 ud_9                -1.377653e-01 1 1  ON 19
 eO_0                -7.604632e-01 1 1  ON 20
 eO_1                -4.392821e-01 1 1  ON 21
 eO_2                -1.750816e-02 1 1  ON 22
 eO_3                 3.020367e-01 1 1  ON 23
 eO_4                 5.226988e-01 1 1  ON 24
 eO_5                 4.777014e-01 1 1  ON 25
 eO_6                 2.458733e-01 1 1  ON 26
 eO_7                -5.149748e-02 1 1  ON 27
 eO_8                -2.110154e-01 1 1  ON 28
 eO_9                -6.971147e-02 1 1  ON 29
eH1_0                -2.373808e-01 1 1  ON 30
eH1_1                -1.375775e-01 1 1  ON 31
eH1_2                -9.181267e-02 1 1  ON 32
eH1_3                -3.844803e-02 1 1  ON 33
eH1_4                 8.866222e-03 1 1  ON 34
eH1_5                 4.225565e-02 1 1  ON 35
eH1_6                 9.820737e-02 1 1  ON 36
eH1_7                 1.482096e-01 1 1  ON 37
eH1_8                 1.634437e-01 1 1  ON 38
eH1_9                 4.849910e-02 1 1  ON 39
eH2_0                -2.344049e-01 1 1  ON 40
eH2_1                -1.348586e-01 1 1  ON 41
eH2_2                -8.899930e-02 1 1  ON 42
eH2_3                -3.518589e-02 1 1  ON 43
eH2_4                 1.198025e-02 1 1  ON 44
eH2_5                 4.565886e-02 1 1  ON 45
eH2_6                 1.015266e-01 1 1  ON 46
eH2_7                 1.501043e-01 1 1  ON 47
eH2_8                 1.689015e-01 1 1  ON 48
eH2_9                 3.308303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5903e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8955
    reference variance = 0.274846
====================================================
  Execution time = 3.4952e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5732e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349008191167
                                         uncertainty =       0.012537256537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349008191167
                                         uncertainty =       0.012537256537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417679188
  error estimate for blocks of size 2^( 2) =       0.000430656903
  error estimate for blocks of size 2^( 3) =       0.000443616387
  error estimate for blocks of size 2^( 4) =       0.000456174392
  error estimate for blocks of size 2^( 5) =       0.000466142721
  error estimate for blocks of size 2^( 6) =       0.000474156610
  error estimate for blocks of size 2^( 7) =       0.000480212027

      target function =                  N/A
              le_mean =     -16.905867556858
             les_mean =     286.157269484327
             stat err =       0.000469171437
             autocorr =       1.261762039662
              std dev =       0.590687572885
             le_variance =       0.348911808761


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586755686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905867556858       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905868805615       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905868477342       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905870336115       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905869064402       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905868754833       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905870571678       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905870811335       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905870361206       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905870511115       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905870602268       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.290626e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905867556858       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905868113339       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905868046351       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905868186053       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905868380160       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905868273745       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905868246860       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905868600406       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905868459186       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.240421e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905867556858       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905867729813       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905867724564       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905867696469       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905867816536       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905867805067       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905867769036       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905867824905       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.293760e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4533e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.085443e-01 1 1  ON 0
 uu_1                 1.419599e-01 1 1  ON 1
 uu_2                 4.095811e-02 1 1  ON 2
 uu_3                -2.094324e-02 1 1  ON 3
 uu_4                -6.507607e-02 1 1  ON 4
 uu_5                -9.831489e-02 1 1  ON 5
 uu_6                -1.243787e-01 1 1  ON 6
 uu_7                -1.365325e-01 1 1  ON 7
 uu_8                -1.288998e-01 1 1  ON 8
 uu_9                -9.917803e-02 1 1  ON 9
 ud_0                 4.462148e-01 1 1  ON 10
 ud_1                 1.802368e-01 1 1  ON 11
 ud_2                 5.974355e-02 1 1  ON 12
 ud_3                -1.142513e-02 1 1  ON 13
 ud_4                -6.787764e-02 1 1  ON 14
 ud_5                -1.080698e-01 1 1  ON 15
 ud_6                -1.342064e-01 1 1  ON 16
 ud_7                -1.494874e-01 1 1  ON 17
 ud_8                -1.497438e-01 1 1  ON 18
 ud_9                -1.378581e-01 1 1  ON 19
 eO_0                -7.605654e-01 1 1  ON 20
 eO_1                -4.393865e-01 1 1  ON 21
 eO_2                -1.761822e-02 1 1  ON 22
 eO_3                 3.020132e-01 1 1  ON 23
 eO_4                 5.228068e-01 1 1  ON 24
 eO_5                 4.779075e-01 1 1  ON 25
 eO_6                 2.461901e-01 1 1  ON 26
 eO_7                -5.139037e-02 1 1  ON 27
 eO_8                -2.111628e-01 1 1  ON 28
 eO_9                -6.992519e-02 1 1  ON 29
eH1_0                -2.375481e-01 1 1  ON 30
eH1_1                -1.378172e-01 1 1  ON 31
eH1_2                -9.201151e-02 1 1  ON 32
eH1_3                -3.848588e-02 1 1  ON 33
eH1_4                 8.771695e-03 1 1  ON 34
eH1_5                 4.224633e-02 1 1  ON 35
eH1_6                 9.818224e-02 1 1  ON 36
eH1_7                 1.483068e-01 1 1  ON 37
eH1_8                 1.637642e-01 1 1  ON 38
eH1_9                 4.882314e-02 1 1  ON 39
eH2_0                -2.347211e-01 1 1  ON 40
eH2_1                -1.349993e-01 1 1  ON 41
eH2_2                -8.905266e-02 1 1  ON 42
eH2_3                -3.533565e-02 1 1  ON 43
eH2_4                 1.199292e-02 1 1  ON 44
eH2_5                 4.573440e-02 1 1  ON 45
eH2_6                 1.013666e-01 1 1  ON 46
eH2_7                 1.502215e-01 1 1  ON 47
eH2_8                 1.692042e-01 1 1  ON 48
eH2_9                 3.340614e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8796
    reference variance = 0.383731
====================================================
  Execution time = 3.4309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3397e-01
  Total weights = 2.0000e+06
  Execution time = 3.1873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333904269000
                                         uncertainty =       0.004382969741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333904269000
                                         uncertainty =       0.004382969741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408644397
  error estimate for blocks of size 2^( 2) =       0.000421599409
  error estimate for blocks of size 2^( 3) =       0.000435086511
  error estimate for blocks of size 2^( 4) =       0.000447853190
  error estimate for blocks of size 2^( 5) =       0.000458773760
  error estimate for blocks of size 2^( 6) =       0.000466617302
  error estimate for blocks of size 2^( 7) =       0.000471398830

      target function =                  N/A
              le_mean =     -16.904957746282
             les_mean =     286.111576723632
             stat err =       0.000461160771
             autocorr =       1.273543003864
              std dev =       0.577910448984
             le_variance =       0.333980487045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333921612595
                                         uncertainty =       0.004383990622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333921612595
                                         uncertainty =       0.004383990622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408654917
  error estimate for blocks of size 2^( 2) =       0.000421611406
  error estimate for blocks of size 2^( 3) =       0.000435096953
  error estimate for blocks of size 2^( 4) =       0.000447856839
  error estimate for blocks of size 2^( 5) =       0.000458771647
  error estimate for blocks of size 2^( 6) =       0.000466613064
  error estimate for blocks of size 2^( 7) =       0.000471399634

      target function =                  N/A
              le_mean =     -16.904957580224
             les_mean =     286.111588304607
             stat err =       0.000461160296
             autocorr =       1.273474815791
              std dev =       0.577925325997
             le_variance =       0.333997682429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333876616818
                                         uncertainty =       0.004384937780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333876616818
                                         uncertainty =       0.004384937780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408627382
  error estimate for blocks of size 2^( 2) =       0.000421584638
  error estimate for blocks of size 2^( 3) =       0.000435072332
  error estimate for blocks of size 2^( 4) =       0.000447836255
  error estimate for blocks of size 2^( 5) =       0.000458753997
  error estimate for blocks of size 2^( 6) =       0.000466597004
  error estimate for blocks of size 2^( 7) =       0.000471383173

      target function =                  N/A
              le_mean =     -16.904956707886
             les_mean =     286.111513803419
             stat err =       0.000461142607
             autocorr =       1.273548740224
              std dev =       0.577886385788
             le_variance =       0.333952674879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333891540077
                                         uncertainty =       0.004383240691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333891540077
                                         uncertainty =       0.004383240691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408636594
  error estimate for blocks of size 2^( 2) =       0.000421592189
  error estimate for blocks of size 2^( 3) =       0.000435079600
  error estimate for blocks of size 2^( 4) =       0.000447846068
  error estimate for blocks of size 2^( 5) =       0.000458766393
  error estimate for blocks of size 2^( 6) =       0.000466609923
  error estimate for blocks of size 2^( 7) =       0.000471392062

      target function =                  N/A
              le_mean =     -16.904957441444
             les_mean =     286.111553662593
             stat err =       0.000461153611
             autocorr =       1.273552099001
              std dev =       0.577899413852
             le_variance =       0.333967732531


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904957746282        initial  <--
     1.5625e-01     1.5625e+00             1.2906e-03       -16.904957580224
     6.2500e-01     6.2500e+00             3.2404e-04       -16.904956707886
     2.5000e+00     2.5000e+01             8.2938e-05       -16.904957441444

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.3151
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.083875e-01 1 1  ON 0
 uu_1                 1.419403e-01 1 1  ON 1
 uu_2                 4.094765e-02 1 1  ON 2
 uu_3                -2.084277e-02 1 1  ON 3
 uu_4                -6.504960e-02 1 1  ON 4
 uu_5                -9.832130e-02 1 1  ON 5
 uu_6                -1.241140e-01 1 1  ON 6
 uu_7                -1.364183e-01 1 1  ON 7
 uu_8                -1.290108e-01 1 1  ON 8
 uu_9                -9.909016e-02 1 1  ON 9
 ud_0                 4.461784e-01 1 1  ON 10
 ud_1                 1.801455e-01 1 1  ON 11
 ud_2                 5.962463e-02 1 1  ON 12
 ud_3                -1.148984e-02 1 1  ON 13
 ud_4                -6.791582e-02 1 1  ON 14
 ud_5                -1.080673e-01 1 1  ON 15
 ud_6                -1.341456e-01 1 1  ON 16
 ud_7                -1.493675e-01 1 1  ON 17
 ud_8                -1.496881e-01 1 1  ON 18
 ud_9                -1.377653e-01 1 1  ON 19
 eO_0                -7.604632e-01 1 1  ON 20
 eO_1                -4.392821e-01 1 1  ON 21
 eO_2                -1.750816e-02 1 1  ON 22
 eO_3                 3.020367e-01 1 1  ON 23
 eO_4                 5.226988e-01 1 1  ON 24
 eO_5                 4.777014e-01 1 1  ON 25
 eO_6                 2.458733e-01 1 1  ON 26
 eO_7                -5.149748e-02 1 1  ON 27
 eO_8                -2.110154e-01 1 1  ON 28
 eO_9                -6.971147e-02 1 1  ON 29
eH1_0                -2.373808e-01 1 1  ON 30
eH1_1                -1.375775e-01 1 1  ON 31
eH1_2                -9.181267e-02 1 1  ON 32
eH1_3                -3.844803e-02 1 1  ON 33
eH1_4                 8.866222e-03 1 1  ON 34
eH1_5                 4.225565e-02 1 1  ON 35
eH1_6                 9.820737e-02 1 1  ON 36
eH1_7                 1.482096e-01 1 1  ON 37
eH1_8                 1.634437e-01 1 1  ON 38
eH1_9                 4.849910e-02 1 1  ON 39
eH2_0                -2.344049e-01 1 1  ON 40
eH2_1                -1.348586e-01 1 1  ON 41
eH2_2                -8.899930e-02 1 1  ON 42
eH2_3                -3.518589e-02 1 1  ON 43
eH2_4                 1.198025e-02 1 1  ON 44
eH2_5                 4.565886e-02 1 1  ON 45
eH2_6                 1.015266e-01 1 1  ON 46
eH2_7                 1.501043e-01 1 1  ON 47
eH2_8                 1.689015e-01 1 1  ON 48
eH2_9                 3.308303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4856e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.954
    reference variance = 0.524576
====================================================
  Execution time = 3.4581e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3635e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336406063189
                                         uncertainty =       0.004339220179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336406063189
                                         uncertainty =       0.004339220179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410090482
  error estimate for blocks of size 2^( 2) =       0.000422815683
  error estimate for blocks of size 2^( 3) =       0.000436112437
  error estimate for blocks of size 2^( 4) =       0.000448123232
  error estimate for blocks of size 2^( 5) =       0.000458436033
  error estimate for blocks of size 2^( 6) =       0.000464534564
  error estimate for blocks of size 2^( 7) =       0.000469210011

      target function =                  N/A
              le_mean =     -16.905201185778
             les_mean =     286.122175369581
             stat err =       0.000460075960
             autocorr =       1.258634707601
              std dev =       0.579955520812
             le_variance =       0.336348406120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690520118578e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905201185778       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905200579043       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905200645560       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905200691654       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905200951906       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905201015836       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905200923555       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905200946075       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.380118e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905201185778       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905201013383       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905201029158       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905201040132       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905201102014       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905201115817       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905201097887       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905201105633       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.481062e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905201185778       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905201141156       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905201145012       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905201147642       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905201162743       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905201165975       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905201161925       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905201164050       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.725611e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024629 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4078e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.083924e-01 1 1  ON 0
 uu_1                 1.419562e-01 1 1  ON 1
 uu_2                 4.095879e-02 1 1  ON 2
 uu_3                -2.084017e-02 1 1  ON 3
 uu_4                -6.504500e-02 1 1  ON 4
 uu_5                -9.832972e-02 1 1  ON 5
 uu_6                -1.241354e-01 1 1  ON 6
 uu_7                -1.364335e-01 1 1  ON 7
 uu_8                -1.290227e-01 1 1  ON 8
 uu_9                -9.910277e-02 1 1  ON 9
 ud_0                 4.461963e-01 1 1  ON 10
 ud_1                 1.801591e-01 1 1  ON 11
 ud_2                 5.962352e-02 1 1  ON 12
 ud_3                -1.147433e-02 1 1  ON 13
 ud_4                -6.790584e-02 1 1  ON 14
 ud_5                -1.080633e-01 1 1  ON 15
 ud_6                -1.341372e-01 1 1  ON 16
 ud_7                -1.493678e-01 1 1  ON 17
 ud_8                -1.497197e-01 1 1  ON 18
 ud_9                -1.377842e-01 1 1  ON 19
 eO_0                -7.604698e-01 1 1  ON 20
 eO_1                -4.392941e-01 1 1  ON 21
 eO_2                -1.752965e-02 1 1  ON 22
 eO_3                 3.020312e-01 1 1  ON 23
 eO_4                 5.227274e-01 1 1  ON 24
 eO_5                 4.777362e-01 1 1  ON 25
 eO_6                 2.459040e-01 1 1  ON 26
 eO_7                -5.148867e-02 1 1  ON 27
 eO_8                -2.110469e-01 1 1  ON 28
 eO_9                -6.973398e-02 1 1  ON 29
eH1_0                -2.373907e-01 1 1  ON 30
eH1_1                -1.375987e-01 1 1  ON 31
eH1_2                -9.182105e-02 1 1  ON 32
eH1_3                -3.845610e-02 1 1  ON 33
eH1_4                 8.855441e-03 1 1  ON 34
eH1_5                 4.226313e-02 1 1  ON 35
eH1_6                 9.821583e-02 1 1  ON 36
eH1_7                 1.482087e-01 1 1  ON 37
eH1_8                 1.634663e-01 1 1  ON 38
eH1_9                 4.852076e-02 1 1  ON 39
eH2_0                -2.344180e-01 1 1  ON 40
eH2_1                -1.348654e-01 1 1  ON 41
eH2_2                -8.901333e-02 1 1  ON 42
eH2_3                -3.521635e-02 1 1  ON 43
eH2_4                 1.197783e-02 1 1  ON 44
eH2_5                 4.564758e-02 1 1  ON 45
eH2_6                 1.015277e-01 1 1  ON 46
eH2_7                 1.501219e-01 1 1  ON 47
eH2_8                 1.689318e-01 1 1  ON 48
eH2_9                 3.311231e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9213
    reference variance = 0.241535
====================================================
  Execution time = 3.4565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3614e-01
  Total weights = 2.0000e+06
  Execution time = 3.1473e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336106827677
                                         uncertainty =       0.003280689555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336106827677
                                         uncertainty =       0.003280689555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409955366
  error estimate for blocks of size 2^( 2) =       0.000422915457
  error estimate for blocks of size 2^( 3) =       0.000436253988
  error estimate for blocks of size 2^( 4) =       0.000449046429
  error estimate for blocks of size 2^( 5) =       0.000460791111
  error estimate for blocks of size 2^( 6) =       0.000469626292
  error estimate for blocks of size 2^( 7) =       0.000476101812

      target function =                  N/A
              le_mean =     -16.905824898258
             les_mean =     286.143042126116
             stat err =       0.000463891411
             autocorr =       1.280440826147
              std dev =       0.579764438042
             le_variance =       0.336126803618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336149420549
                                         uncertainty =       0.003280822116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336149420549
                                         uncertainty =       0.003280822116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409981351
  error estimate for blocks of size 2^( 2) =       0.000422939513
  error estimate for blocks of size 2^( 3) =       0.000436275933
  error estimate for blocks of size 2^( 4) =       0.000449066484
  error estimate for blocks of size 2^( 5) =       0.000460811352
  error estimate for blocks of size 2^( 6) =       0.000469647175
  error estimate for blocks of size 2^( 7) =       0.000476120052

      target function =                  N/A
              le_mean =     -16.905825120968
             les_mean =     286.143092269365
             stat err =       0.000463911266
             autocorr =       1.280388111850
              std dev =       0.579801187220
             le_variance =       0.336169416702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336132290491
                                         uncertainty =       0.003280766877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336132290491
                                         uncertainty =       0.003280766877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409970899
  error estimate for blocks of size 2^( 2) =       0.000422929822
  error estimate for blocks of size 2^( 3) =       0.000436267128
  error estimate for blocks of size 2^( 4) =       0.000449058526
  error estimate for blocks of size 2^( 5) =       0.000460803354
  error estimate for blocks of size 2^( 6) =       0.000469638922
  error estimate for blocks of size 2^( 7) =       0.000476112818

      target function =                  N/A
              le_mean =     -16.905825016576
             les_mean =     286.143071599550
             stat err =       0.000463903405
             autocorr =       1.280410005444
              std dev =       0.579786405956
             le_variance =       0.336152276532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336110162042
                                         uncertainty =       0.003280699490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336110162042
                                         uncertainty =       0.003280699490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409957400
  error estimate for blocks of size 2^( 2) =       0.000422917337
  error estimate for blocks of size 2^( 3) =       0.000436255707
  error estimate for blocks of size 2^( 4) =       0.000449048013
  error estimate for blocks of size 2^( 5) =       0.000460792716
  error estimate for blocks of size 2^( 6) =       0.000469627949
  error estimate for blocks of size 2^( 7) =       0.000476103252

      target function =                  N/A
              le_mean =     -16.905824912279
             les_mean =     286.143045935810
             stat err =       0.000463892983
             autocorr =       1.280436796088
              std dev =       0.579767314729
             le_variance =       0.336130139228


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905824898258        initial
     1.5625e+00     1.5625e+01             1.3801e-04       -16.905825120968  <--
     6.2500e+00     6.2500e+01             3.4811e-05       -16.905825016576
     2.5000e+01     2.5000e+02             8.7256e-06       -16.905824912279

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 5.2253e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.084099e-01 1 1  ON 0
 uu_1                 1.419997e-01 1 1  ON 1
 uu_2                 4.099033e-02 1 1  ON 2
 uu_3                -2.083004e-02 1 1  ON 3
 uu_4                -6.503466e-02 1 1  ON 4
 uu_5                -9.835370e-02 1 1  ON 5
 uu_6                -1.241964e-01 1 1  ON 6
 uu_7                -1.364784e-01 1 1  ON 7
 uu_8                -1.290584e-01 1 1  ON 8
 uu_9                -9.914027e-02 1 1  ON 9
 ud_0                 4.462448e-01 1 1  ON 10
 ud_1                 1.801948e-01 1 1  ON 11
 ud_2                 5.963151e-02 1 1  ON 12
 ud_3                -1.143367e-02 1 1  ON 13
 ud_4                -6.787308e-02 1 1  ON 14
 ud_5                -1.080517e-01 1 1  ON 15
 ud_6                -1.341133e-01 1 1  ON 16
 ud_7                -1.493669e-01 1 1  ON 17
 ud_8                -1.498126e-01 1 1  ON 18
 ud_9                -1.378411e-01 1 1  ON 19
 eO_0                -7.604927e-01 1 1  ON 20
 eO_1                -4.393270e-01 1 1  ON 21
 eO_2                -1.759212e-02 1 1  ON 22
 eO_3                 3.020140e-01 1 1  ON 23
 eO_4                 5.228131e-01 1 1  ON 24
 eO_5                 4.778394e-01 1 1  ON 25
 eO_6                 2.459949e-01 1 1  ON 26
 eO_7                -5.146278e-02 1 1  ON 27
 eO_8                -2.111404e-01 1 1  ON 28
 eO_9                -6.980074e-02 1 1  ON 29
eH1_0                -2.374212e-01 1 1  ON 30
eH1_1                -1.376586e-01 1 1  ON 31
eH1_2                -9.184947e-02 1 1  ON 32
eH1_3                -3.847968e-02 1 1  ON 33
eH1_4                 8.825522e-03 1 1  ON 34
eH1_5                 4.228502e-02 1 1  ON 35
eH1_6                 9.824124e-02 1 1  ON 36
eH1_7                 1.482062e-01 1 1  ON 37
eH1_8                 1.635330e-01 1 1  ON 38
eH1_9                 4.858468e-02 1 1  ON 39
eH2_0                -2.344562e-01 1 1  ON 40
eH2_1                -1.348901e-01 1 1  ON 41
eH2_2                -8.905634e-02 1 1  ON 42
eH2_3                -3.530022e-02 1 1  ON 43
eH2_4                 1.196727e-02 1 1  ON 44
eH2_5                 4.561544e-02 1 1  ON 45
eH2_6                 1.015315e-01 1 1  ON 46
eH2_7                 1.501742e-01 1 1  ON 47
eH2_8                 1.690217e-01 1 1  ON 48
eH2_9                 3.319890e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.6440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.898
    reference variance = 0.343984
====================================================
  Execution time = 3.6377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3400e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333952386361
                                         uncertainty =       0.003426097796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333952386361
                                         uncertainty =       0.003426097796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408656211
  error estimate for blocks of size 2^( 2) =       0.000421599612
  error estimate for blocks of size 2^( 3) =       0.000435068944
  error estimate for blocks of size 2^( 4) =       0.000447526115
  error estimate for blocks of size 2^( 5) =       0.000458366946
  error estimate for blocks of size 2^( 6) =       0.000466524296
  error estimate for blocks of size 2^( 7) =       0.000472165552

      target function =                  N/A
              le_mean =     -16.905742192984
             les_mean =     286.138118726766
             stat err =       0.000461145727
             autocorr =       1.273386289026
              std dev =       0.577927156415
             le_variance =       0.333999798121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574219298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905742192984       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905742338914       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905743699164       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905743718437       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905744137688       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905744173749       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905744642221       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905744334986       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905744518008       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.604203e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905742192984       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905742242221       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905742692446       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905742719620       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905742839758       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905742800213       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905742837942       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905742822829       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.416697e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905742192984       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905742206472       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905742329152       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905742339133       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905742374029       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905742357788       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905742355934       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905742359564       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.537931e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5768e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.084003e-01 1 1  ON 0
 uu_1                 1.420227e-01 1 1  ON 1
 uu_2                 4.100297e-02 1 1  ON 2
 uu_3                -2.079043e-02 1 1  ON 3
 uu_4                -6.500592e-02 1 1  ON 4
 uu_5                -9.835600e-02 1 1  ON 5
 uu_6                -1.242451e-01 1 1  ON 6
 uu_7                -1.365418e-01 1 1  ON 7
 uu_8                -1.291036e-01 1 1  ON 8
 uu_9                -9.921205e-02 1 1  ON 9
 ud_0                 4.462280e-01 1 1  ON 10
 ud_1                 1.802370e-01 1 1  ON 11
 ud_2                 5.967957e-02 1 1  ON 12
 ud_3                -1.141089e-02 1 1  ON 13
 ud_4                -6.789388e-02 1 1  ON 14
 ud_5                -1.080308e-01 1 1  ON 15
 ud_6                -1.340524e-01 1 1  ON 16
 ud_7                -1.493743e-01 1 1  ON 17
 ud_8                -1.498657e-01 1 1  ON 18
 ud_9                -1.378882e-01 1 1  ON 19
 eO_0                -7.605260e-01 1 1  ON 20
 eO_1                -4.393445e-01 1 1  ON 21
 eO_2                -1.770678e-02 1 1  ON 22
 eO_3                 3.019863e-01 1 1  ON 23
 eO_4                 5.229141e-01 1 1  ON 24
 eO_5                 4.779811e-01 1 1  ON 25
 eO_6                 2.461185e-01 1 1  ON 26
 eO_7                -5.143541e-02 1 1  ON 27
 eO_8                -2.112382e-01 1 1  ON 28
 eO_9                -6.988838e-02 1 1  ON 29
eH1_0                -2.374639e-01 1 1  ON 30
eH1_1                -1.377056e-01 1 1  ON 31
eH1_2                -9.194106e-02 1 1  ON 32
eH1_3                -3.849528e-02 1 1  ON 33
eH1_4                 8.788149e-03 1 1  ON 34
eH1_5                 4.219856e-02 1 1  ON 35
eH1_6                 9.828118e-02 1 1  ON 36
eH1_7                 1.482838e-01 1 1  ON 37
eH1_8                 1.636210e-01 1 1  ON 38
eH1_9                 4.869516e-02 1 1  ON 39
eH2_0                -2.344898e-01 1 1  ON 40
eH2_1                -1.349558e-01 1 1  ON 41
eH2_2                -8.907048e-02 1 1  ON 42
eH2_3                -3.532129e-02 1 1  ON 43
eH2_4                 1.191666e-02 1 1  ON 44
eH2_5                 4.558071e-02 1 1  ON 45
eH2_6                 1.015122e-01 1 1  ON 46
eH2_7                 1.501798e-01 1 1  ON 47
eH2_8                 1.691109e-01 1 1  ON 48
eH2_9                 3.333207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9662
    reference variance = 0.287044
====================================================
  Execution time = 3.3937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.4064e-01
  Total weights = 2.0000e+06
  Execution time = 3.1541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340798267531
                                         uncertainty =       0.004290628276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340798267531
                                         uncertainty =       0.004290628276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412732142
  error estimate for blocks of size 2^( 2) =       0.000424927748
  error estimate for blocks of size 2^( 3) =       0.000437829494
  error estimate for blocks of size 2^( 4) =       0.000450057278
  error estimate for blocks of size 2^( 5) =       0.000460881191
  error estimate for blocks of size 2^( 6) =       0.000468057603
  error estimate for blocks of size 2^( 7) =       0.000474582718

      target function =                  N/A
              le_mean =     -16.904407067151
             les_mean =     286.099673764003
             stat err =       0.000463394698
             autocorr =       1.260565848261
              std dev =       0.583691393135
             le_variance =       0.340695642419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340687547370
                                         uncertainty =       0.004288900249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340687547370
                                         uncertainty =       0.004288900249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412665078
  error estimate for blocks of size 2^( 2) =       0.000424863448
  error estimate for blocks of size 2^( 3) =       0.000437763538
  error estimate for blocks of size 2^( 4) =       0.000449991993
  error estimate for blocks of size 2^( 5) =       0.000460814521
  error estimate for blocks of size 2^( 6) =       0.000467993271
  error estimate for blocks of size 2^( 7) =       0.000474523368

      target function =                  N/A
              le_mean =     -16.904407560350
             les_mean =     286.099579728773
             stat err =       0.000463330788
             autocorr =       1.260627812758
              std dev =       0.583596549560
             le_variance =       0.340584932658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340692441387
                                         uncertainty =       0.004288981792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340692441387
                                         uncertainty =       0.004288981792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412668046
  error estimate for blocks of size 2^( 2) =       0.000424866564
  error estimate for blocks of size 2^( 3) =       0.000437768221
  error estimate for blocks of size 2^( 4) =       0.000449997745
  error estimate for blocks of size 2^( 5) =       0.000460821669
  error estimate for blocks of size 2^( 6) =       0.000468000608
  error estimate for blocks of size 2^( 7) =       0.000474530759

      target function =                  N/A
              le_mean =     -16.904407325488
             les_mean =     286.099576687590
             stat err =       0.000463337695
             autocorr =       1.260647263128
              std dev =       0.583600746987
             le_variance =       0.340589831884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340782012279
                                         uncertainty =       0.004290380889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340782012279
                                         uncertainty =       0.004290380889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412722297
  error estimate for blocks of size 2^( 2) =       0.000424918356
  error estimate for blocks of size 2^( 3) =       0.000437820140
  error estimate for blocks of size 2^( 4) =       0.000450048227
  error estimate for blocks of size 2^( 5) =       0.000460872179
  error estimate for blocks of size 2^( 6) =       0.000468048984
  error estimate for blocks of size 2^( 7) =       0.000474574884

      target function =                  N/A
              le_mean =     -16.904407093589
             les_mean =     286.099658405129
             stat err =       0.000463386068
             autocorr =       1.260579034868
              std dev =       0.583677470614
             le_variance =       0.340679389702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904407067151        initial
     3.9062e-01     3.9062e+00             5.6042e-04       -16.904407560350  <--
     1.5625e+00     1.5625e+01             1.4167e-04       -16.904407325488
     6.2500e+00     6.2500e+01             3.5379e-05       -16.904407093589

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.9801e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.084030e-01 1 1  ON 0
 uu_1                 1.420823e-01 1 1  ON 1
 uu_2                 4.105142e-02 1 1  ON 2
 uu_3                -2.069841e-02 1 1  ON 3
 uu_4                -6.493640e-02 1 1  ON 4
 uu_5                -9.837803e-02 1 1  ON 5
 uu_6                -1.243735e-01 1 1  ON 6
 uu_7                -1.367177e-01 1 1  ON 7
 uu_8                -1.292403e-01 1 1  ON 8
 uu_9                -9.942856e-02 1 1  ON 9
 ud_0                 4.462593e-01 1 1  ON 10
 ud_1                 1.803391e-01 1 1  ON 11
 ud_2                 5.977934e-02 1 1  ON 12
 ud_3                -1.134538e-02 1 1  ON 13
 ud_4                -6.792299e-02 1 1  ON 14
 ud_5                -1.079923e-01 1 1  ON 15
 ud_6                -1.339410e-01 1 1  ON 16
 ud_7                -1.493665e-01 1 1  ON 17
 ud_8                -1.500013e-01 1 1  ON 18
 ud_9                -1.380294e-01 1 1  ON 19
 eO_0                -7.606193e-01 1 1  ON 20
 eO_1                -4.394548e-01 1 1  ON 21
 eO_2                -1.795257e-02 1 1  ON 22
 eO_3                 3.018860e-01 1 1  ON 23
 eO_4                 5.231828e-01 1 1  ON 24
 eO_5                 4.783999e-01 1 1  ON 25
 eO_6                 2.464936e-01 1 1  ON 26
 eO_7                -5.134794e-02 1 1  ON 27
 eO_8                -2.115303e-01 1 1  ON 28
 eO_9                -7.015131e-02 1 1  ON 29
eH1_0                -2.375974e-01 1 1  ON 30
eH1_1                -1.378661e-01 1 1  ON 31
eH1_2                -9.215996e-02 1 1  ON 32
eH1_3                -3.858459e-02 1 1  ON 33
eH1_4                 8.691558e-03 1 1  ON 34
eH1_5                 4.195130e-02 1 1  ON 35
eH1_6                 9.838648e-02 1 1  ON 36
eH1_7                 1.485138e-01 1 1  ON 37
eH1_8                 1.638866e-01 1 1  ON 38
eH1_9                 4.902627e-02 1 1  ON 39
eH2_0                -2.345962e-01 1 1  ON 40
eH2_1                -1.351122e-01 1 1  ON 41
eH2_2                -8.914164e-02 1 1  ON 42
eH2_3                -3.538977e-02 1 1  ON 43
eH2_4                 1.178486e-02 1 1  ON 44
eH2_5                 4.545821e-02 1 1  ON 45
eH2_6                 1.014513e-01 1 1  ON 46
eH2_7                 1.501995e-01 1 1  ON 47
eH2_8                 1.693781e-01 1 1  ON 48
eH2_9                 3.372994e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5630e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8507
    reference variance = 0.269456
====================================================
  Execution time = 3.4600e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3963e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339747777748
                                         uncertainty =       0.003908424016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339747777748
                                         uncertainty =       0.003908424016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412086524
  error estimate for blocks of size 2^( 2) =       0.000425004213
  error estimate for blocks of size 2^( 3) =       0.000438191438
  error estimate for blocks of size 2^( 4) =       0.000451323870
  error estimate for blocks of size 2^( 5) =       0.000461195372
  error estimate for blocks of size 2^( 6) =       0.000469021270
  error estimate for blocks of size 2^( 7) =       0.000472483210

      target function =                  N/A
              le_mean =     -16.905284782323
             les_mean =     286.128284008059
             stat err =       0.000463505930
             autocorr =       1.265125953994
              std dev =       0.582778351031
             le_variance =       0.339630606431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690528478232e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905284782323       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905283773442       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905284882285       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905286452426       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905287795385       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905288108636       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905288866095       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905289534017       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905289297948       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905289583160       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905290408399       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905290346797       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.104381e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905284782323       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905284319329       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905284717218       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905285228260       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905286010267       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905285624918       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905285976503       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905286079687       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905285946989       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.479581e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905284782323       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905284636006       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905284742429       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905284872162       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905285101857       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905285077303       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905285020865       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905285098750       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.381299e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3884e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.082559e-01 1 1  ON 0
 uu_1                 1.420899e-01 1 1  ON 1
 uu_2                 4.099305e-02 1 1  ON 2
 uu_3                -2.077339e-02 1 1  ON 3
 uu_4                -6.512110e-02 1 1  ON 4
 uu_5                -9.840024e-02 1 1  ON 5
 uu_6                -1.243405e-01 1 1  ON 6
 uu_7                -1.367376e-01 1 1  ON 7
 uu_8                -1.292455e-01 1 1  ON 8
 uu_9                -9.949282e-02 1 1  ON 9
 ud_0                 4.465121e-01 1 1  ON 10
 ud_1                 1.805511e-01 1 1  ON 11
 ud_2                 5.994479e-02 1 1  ON 12
 ud_3                -1.119935e-02 1 1  ON 13
 ud_4                -6.796688e-02 1 1  ON 14
 ud_5                -1.081043e-01 1 1  ON 15
 ud_6                -1.343068e-01 1 1  ON 16
 ud_7                -1.493801e-01 1 1  ON 17
 ud_8                -1.502439e-01 1 1  ON 18
 ud_9                -1.382738e-01 1 1  ON 19
 eO_0                -7.610142e-01 1 1  ON 20
 eO_1                -4.396870e-01 1 1  ON 21
 eO_2                -1.809726e-02 1 1  ON 22
 eO_3                 3.019743e-01 1 1  ON 23
 eO_4                 5.233977e-01 1 1  ON 24
 eO_5                 4.787670e-01 1 1  ON 25
 eO_6                 2.470416e-01 1 1  ON 26
 eO_7                -5.104576e-02 1 1  ON 27
 eO_8                -2.118750e-01 1 1  ON 28
 eO_9                -7.050414e-02 1 1  ON 29
eH1_0                -2.378819e-01 1 1  ON 30
eH1_1                -1.383588e-01 1 1  ON 31
eH1_2                -9.254850e-02 1 1  ON 32
eH1_3                -3.896771e-02 1 1  ON 33
eH1_4                 8.611647e-03 1 1  ON 34
eH1_5                 4.220872e-02 1 1  ON 35
eH1_6                 9.853642e-02 1 1  ON 36
eH1_7                 1.486930e-01 1 1  ON 37
eH1_8                 1.644148e-01 1 1  ON 38
eH1_9                 4.947488e-02 1 1  ON 39
eH2_0                -2.347840e-01 1 1  ON 40
eH2_1                -1.351571e-01 1 1  ON 41
eH2_2                -8.932520e-02 1 1  ON 42
eH2_3                -3.563539e-02 1 1  ON 43
eH2_4                 1.159918e-02 1 1  ON 44
eH2_5                 4.544936e-02 1 1  ON 45
eH2_6                 1.014184e-01 1 1  ON 46
eH2_7                 1.502503e-01 1 1  ON 47
eH2_8                 1.697558e-01 1 1  ON 48
eH2_9                 3.421549e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8775
    reference variance = 0.299904
====================================================
  Execution time = 3.4022e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3332e-01
  Total weights = 2.0000e+06
  Execution time = 3.1626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333074920492
                                         uncertainty =       0.002706358683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333074920492
                                         uncertainty =       0.002706358683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408185449
  error estimate for blocks of size 2^( 2) =       0.000421412169
  error estimate for blocks of size 2^( 3) =       0.000434834964
  error estimate for blocks of size 2^( 4) =       0.000447577464
  error estimate for blocks of size 2^( 5) =       0.000459241495
  error estimate for blocks of size 2^( 6) =       0.000468122753
  error estimate for blocks of size 2^( 7) =       0.000472003707

      target function =                  N/A
              le_mean =     -16.905975341591
             les_mean =     286.145232805734
             stat err =       0.000461736355
             autocorr =       1.279596670881
              std dev =       0.577261398227
             le_variance =       0.333230721883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374540246
                                         uncertainty =       0.002707906907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374540246
                                         uncertainty =       0.002707906907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408368724
  error estimate for blocks of size 2^( 2) =       0.000421588668
  error estimate for blocks of size 2^( 3) =       0.000434997694
  error estimate for blocks of size 2^( 4) =       0.000447724149
  error estimate for blocks of size 2^( 5) =       0.000459374672
  error estimate for blocks of size 2^( 6) =       0.000468246143
  error estimate for blocks of size 2^( 7) =       0.000472126339

      target function =                  N/A
              le_mean =     -16.905977570756
             les_mean =     286.145607485540
             stat err =       0.000461867826
             autocorr =       1.279176503568
              std dev =       0.577520587868
             le_variance =       0.333530029411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333264547738
                                         uncertainty =       0.002707104527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333264547738
                                         uncertainty =       0.002707104527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408301336
  error estimate for blocks of size 2^( 2) =       0.000421523193
  error estimate for blocks of size 2^( 3) =       0.000434937128
  error estimate for blocks of size 2^( 4) =       0.000447669968
  error estimate for blocks of size 2^( 5) =       0.000459327279
  error estimate for blocks of size 2^( 6) =       0.000468201758
  error estimate for blocks of size 2^( 7) =       0.000472083886

      target function =                  N/A
              le_mean =     -16.905977210049
             les_mean =     286.145485221723
             stat err =       0.000461820723
             autocorr =       1.279337797478
              std dev =       0.577425286713
             le_variance =       0.333419961736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333104472998
                                         uncertainty =       0.002706512490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333104472998
                                         uncertainty =       0.002706512490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408203507
  error estimate for blocks of size 2^( 2) =       0.000421429365
  error estimate for blocks of size 2^( 3) =       0.000434850815
  error estimate for blocks of size 2^( 4) =       0.000447591854
  error estimate for blocks of size 2^( 5) =       0.000459255185
  error estimate for blocks of size 2^( 6) =       0.000468135217
  error estimate for blocks of size 2^( 7) =       0.000472016025

      target function =                  N/A
              le_mean =     -16.905975481483
             les_mean =     286.145267019493
             stat err =       0.000461749570
             autocorr =       1.279556707021
              std dev =       0.577286935248
             le_variance =       0.333260205608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905975341591        initial
     9.7656e-02     9.7656e-01             2.1044e-03       -16.905977570756  <--
     3.9062e-01     3.9062e+00             5.4796e-04       -16.905977210049
     1.5625e+00     1.5625e+01             1.3813e-04       -16.905975481483

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.9935e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.081575e-01 1 1  ON 0
 uu_1                 1.420265e-01 1 1  ON 1
 uu_2                 4.085856e-02 1 1  ON 2
 uu_3                -2.096143e-02 1 1  ON 3
 uu_4                -6.545210e-02 1 1  ON 4
 uu_5                -9.864275e-02 1 1  ON 5
 uu_6                -1.245708e-01 1 1  ON 6
 uu_7                -1.369193e-01 1 1  ON 7
 uu_8                -1.292515e-01 1 1  ON 8
 uu_9                -9.964231e-02 1 1  ON 9
 ud_0                 4.470628e-01 1 1  ON 10
 ud_1                 1.810521e-01 1 1  ON 11
 ud_2                 6.035272e-02 1 1  ON 12
 ud_3                -1.090585e-02 1 1  ON 13
 ud_4                -6.795578e-02 1 1  ON 14
 ud_5                -1.083352e-01 1 1  ON 15
 ud_6                -1.348790e-01 1 1  ON 16
 ud_7                -1.497770e-01 1 1  ON 17
 ud_8                -1.508860e-01 1 1  ON 18
 ud_9                -1.389321e-01 1 1  ON 19
 eO_0                -7.619361e-01 1 1  ON 20
 eO_1                -4.403441e-01 1 1  ON 21
 eO_2                -1.849408e-02 1 1  ON 22
 eO_3                 3.020779e-01 1 1  ON 23
 eO_4                 5.239215e-01 1 1  ON 24
 eO_5                 4.798587e-01 1 1  ON 25
 eO_6                 2.485885e-01 1 1  ON 26
 eO_7                -5.014509e-02 1 1  ON 27
 eO_8                -2.128554e-01 1 1  ON 28
 eO_9                -7.155917e-02 1 1  ON 29
eH1_0                -2.389208e-01 1 1  ON 30
eH1_1                -1.394817e-01 1 1  ON 31
eH1_2                -9.352547e-02 1 1  ON 32
eH1_3                -3.988380e-02 1 1  ON 33
eH1_4                 8.205831e-03 1 1  ON 34
eH1_5                 4.252193e-02 1 1  ON 35
eH1_6                 9.897155e-02 1 1  ON 36
eH1_7                 1.492566e-01 1 1  ON 37
eH1_8                 1.659910e-01 1 1  ON 38
eH1_9                 5.084312e-02 1 1  ON 39
eH2_0                -2.352743e-01 1 1  ON 40
eH2_1                -1.355382e-01 1 1  ON 41
eH2_2                -8.988933e-02 1 1  ON 42
eH2_3                -3.616586e-02 1 1  ON 43
eH2_4                 1.109368e-02 1 1  ON 44
eH2_5                 4.528273e-02 1 1  ON 45
eH2_6                 1.013713e-01 1 1  ON 46
eH2_7                 1.504090e-01 1 1  ON 47
eH2_8                 1.708729e-01 1 1  ON 48
eH2_9                 3.569304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3826e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.280898
====================================================
  Execution time = 3.4939e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3244e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332430042558
                                         uncertainty =       0.003001497562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332430042558
                                         uncertainty =       0.003001497562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407702260
  error estimate for blocks of size 2^( 2) =       0.000421101035
  error estimate for blocks of size 2^( 3) =       0.000434850509
  error estimate for blocks of size 2^( 4) =       0.000447240935
  error estimate for blocks of size 2^( 5) =       0.000457528424
  error estimate for blocks of size 2^( 6) =       0.000466579049
  error estimate for blocks of size 2^( 7) =       0.000473357902

      target function =                  N/A
              le_mean =     -16.905746735709
             les_mean =     286.136714791166
             stat err =       0.000461176577
             autocorr =       1.279523440230
              std dev =       0.576578065365
             le_variance =       0.332442265460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574673571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746735709       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749364081       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905751971590       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905751256514       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905754656244       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905756657607       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905759942927       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760305907       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905760457957       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905762828459       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905763524920       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905763270362       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905764261363       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905764818745       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905765058222       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905764812932       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 8.560232e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746735709       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748806818       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905750335997       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749915947       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905752413285       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905753265917       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905753951969       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905753181821       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905752903933       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905753475101       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905753552679       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.164489e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746735709       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905747856395       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748463558       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748598101       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749420693       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749862554       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749853627       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749563164       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749471474       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.461029e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4209e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.084981e-01 1 1  ON 0
 uu_1                 1.419789e-01 1 1  ON 1
 uu_2                 4.081665e-02 1 1  ON 2
 uu_3                -2.112748e-02 1 1  ON 3
 uu_4                -6.542737e-02 1 1  ON 4
 uu_5                -9.890809e-02 1 1  ON 5
 uu_6                -1.249697e-01 1 1  ON 6
 uu_7                -1.374052e-01 1 1  ON 7
 uu_8                -1.298241e-01 1 1  ON 8
 uu_9                -1.001319e-01 1 1  ON 9
 ud_0                 4.479499e-01 1 1  ON 10
 ud_1                 1.816299e-01 1 1  ON 11
 ud_2                 6.081116e-02 1 1  ON 12
 ud_3                -1.071901e-02 1 1  ON 13
 ud_4                -6.768222e-02 1 1  ON 14
 ud_5                -1.085855e-01 1 1  ON 15
 ud_6                -1.350696e-01 1 1  ON 16
 ud_7                -1.505201e-01 1 1  ON 17
 ud_8                -1.508613e-01 1 1  ON 18
 ud_9                -1.391353e-01 1 1  ON 19
 eO_0                -7.630718e-01 1 1  ON 20
 eO_1                -4.413360e-01 1 1  ON 21
 eO_2                -1.882973e-02 1 1  ON 22
 eO_3                 3.021825e-01 1 1  ON 23
 eO_4                 5.247462e-01 1 1  ON 24
 eO_5                 4.816800e-01 1 1  ON 25
 eO_6                 2.503773e-01 1 1  ON 26
 eO_7                -4.940714e-02 1 1  ON 27
 eO_8                -2.142075e-01 1 1  ON 28
 eO_9                -7.287109e-02 1 1  ON 29
eH1_0                -2.401746e-01 1 1  ON 30
eH1_1                -1.403645e-01 1 1  ON 31
eH1_2                -9.383278e-02 1 1  ON 32
eH1_3                -4.027681e-02 1 1  ON 33
eH1_4                 7.814742e-03 1 1  ON 34
eH1_5                 4.211480e-02 1 1  ON 35
eH1_6                 9.893866e-02 1 1  ON 36
eH1_7                 1.497055e-01 1 1  ON 37
eH1_8                 1.676474e-01 1 1  ON 38
eH1_9                 5.244856e-02 1 1  ON 39
eH2_0                -2.355860e-01 1 1  ON 40
eH2_1                -1.361732e-01 1 1  ON 41
eH2_2                -9.032500e-02 1 1  ON 42
eH2_3                -3.654152e-02 1 1  ON 43
eH2_4                 1.092969e-02 1 1  ON 44
eH2_5                 4.475439e-02 1 1  ON 45
eH2_6                 1.005155e-01 1 1  ON 46
eH2_7                 1.502340e-01 1 1  ON 47
eH2_8                 1.721257e-01 1 1  ON 48
eH2_9                 3.785753e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9466
    reference variance = 0.166818
====================================================
  Execution time = 3.4575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4266e-01
  Total weights = 2.0000e+06
  Execution time = 3.1385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342323335753
                                         uncertainty =       0.004159284643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342323335753
                                         uncertainty =       0.004159284643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413655098
  error estimate for blocks of size 2^( 2) =       0.000426584205
  error estimate for blocks of size 2^( 3) =       0.000439877294
  error estimate for blocks of size 2^( 4) =       0.000452221097
  error estimate for blocks of size 2^( 5) =       0.000462813684
  error estimate for blocks of size 2^( 6) =       0.000471725016
  error estimate for blocks of size 2^( 7) =       0.000476697362

      target function =                  N/A
              le_mean =     -16.904973664182
             les_mean =     286.120355495252
             stat err =       0.000465864290
             autocorr =       1.268358667737
              std dev =       0.584996649293
             le_variance =       0.342221079684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343231370522
                                         uncertainty =       0.004178824923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343231370522
                                         uncertainty =       0.004178824923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414203331
  error estimate for blocks of size 2^( 2) =       0.000427112622
  error estimate for blocks of size 2^( 3) =       0.000440366867
  error estimate for blocks of size 2^( 4) =       0.000452663054
  error estimate for blocks of size 2^( 5) =       0.000463222951
  error estimate for blocks of size 2^( 6) =       0.000472110483
  error estimate for blocks of size 2^( 7) =       0.000477063717

      target function =                  N/A
              le_mean =     -16.904978185296
             les_mean =     286.121416072598
             stat err =       0.000466265051
             autocorr =       1.267180712984
              std dev =       0.585771968294
             le_variance =       0.343128798839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343217644015
                                         uncertainty =       0.004181561093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343217644015
                                         uncertainty =       0.004181561093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414195060
  error estimate for blocks of size 2^( 2) =       0.000427104000
  error estimate for blocks of size 2^( 3) =       0.000440362832
  error estimate for blocks of size 2^( 4) =       0.000452668408
  error estimate for blocks of size 2^( 5) =       0.000463237733
  error estimate for blocks of size 2^( 6) =       0.000472137511
  error estimate for blocks of size 2^( 7) =       0.000477099955

      target function =                  N/A
              le_mean =     -16.904977396710
             les_mean =     286.121375706489
             stat err =       0.000466285902
             autocorr =       1.267344662267
              std dev =       0.585760270746
             le_variance =       0.343115094785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535361919
                                         uncertainty =       0.004165114600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535361919
                                         uncertainty =       0.004165114600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413783169
  error estimate for blocks of size 2^( 2) =       0.000426706934
  error estimate for blocks of size 2^( 3) =       0.000439992088
  error estimate for blocks of size 2^( 4) =       0.000452328299
  error estimate for blocks of size 2^( 5) =       0.000462916747
  error estimate for blocks of size 2^( 6) =       0.000471825613
  error estimate for blocks of size 2^( 7) =       0.000476795705

      target function =                  N/A
              le_mean =     -16.904974094793
             les_mean =     286.120581996875
             stat err =       0.000465966591
             autocorr =       1.268130407584
              std dev =       0.585177769979
             le_variance =       0.342433022478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904973664182        initial
     2.4414e-02     2.4414e-01             8.5602e-03       -16.904978185296  <--
     9.7656e-02     9.7656e-01             2.1645e-03       -16.904977396710
     3.9062e-01     3.9062e+00             5.4610e-04       -16.904974094793

*****************************************************************************
Applying the update for shift_i =   2.4414e-02     and shift_s =   2.4414e-01
*****************************************************************************

  Execution time = 5.0342e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9225
    reference variance = 0.242984
====================================================
  Execution time = 3.8210e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3634e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336124498982
                                         uncertainty =       0.003469412596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336124498982
                                         uncertainty =       0.003469412596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410084742
  error estimate for blocks of size 2^( 2) =       0.000423052850
  error estimate for blocks of size 2^( 3) =       0.000436010242
  error estimate for blocks of size 2^( 4) =       0.000447154890
  error estimate for blocks of size 2^( 5) =       0.000458462877
  error estimate for blocks of size 2^( 6) =       0.000467430733
  error estimate for blocks of size 2^( 7) =       0.000471126707

      target function =                  N/A
              le_mean =     -16.905397101692
             les_mean =     286.128789989234
             stat err =       0.000461043802
             autocorr =       1.263971126399
              std dev =       0.579947404095
             le_variance =       0.336338991517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690539710169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905397101692       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905396367704       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905400102614       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905399984662       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905400762730       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905401437081       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905411261197       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905409164599       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905422444588       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905421136758       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905429136632       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905433017589       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905434248602       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905433033766       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905431929432       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905430989678       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905431938275       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905432538848       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905431089068       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905430575605       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905432775050       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905432789870       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905433370938       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 3.652176e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905397101692       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905396425426       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905399834455       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905399538959       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905400173591       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905400953186       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905407807165       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905404307699       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905409663016       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905409479491       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905410113333       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905410508813       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905410511028       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905409970176       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905409716905       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905409377200       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 9.078637e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905397101692       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905396587251       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905399128086       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905398816445       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905399068119       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905400024500       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905401114165       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905400661269       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905401742059       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905401431259       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905401571370       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.254129e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7477e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.083732e-01 1 1  ON 0
 uu_1                 1.415561e-01 1 1  ON 1
 uu_2                 4.029829e-02 1 1  ON 2
 uu_3                -2.203043e-02 1 1  ON 3
 uu_4                -6.678661e-02 1 1  ON 4
 uu_5                -1.005749e-01 1 1  ON 5
 uu_6                -1.278557e-01 1 1  ON 6
 uu_7                -1.407638e-01 1 1  ON 7
 uu_8                -1.324369e-01 1 1  ON 8
 uu_9                -1.023968e-01 1 1  ON 9
 ud_0                 4.503796e-01 1 1  ON 10
 ud_1                 1.838809e-01 1 1  ON 11
 ud_2                 6.260952e-02 1 1  ON 12
 ud_3                -9.255432e-03 1 1  ON 13
 ud_4                -6.675727e-02 1 1  ON 14
 ud_5                -1.080846e-01 1 1  ON 15
 ud_6                -1.352166e-01 1 1  ON 16
 ud_7                -1.517309e-01 1 1  ON 17
 ud_8                -1.517846e-01 1 1  ON 18
 ud_9                -1.425411e-01 1 1  ON 19
 eO_0                -7.656670e-01 1 1  ON 20
 eO_1                -4.435494e-01 1 1  ON 21
 eO_2                -1.955200e-02 1 1  ON 22
 eO_3                 3.040581e-01 1 1  ON 23
 eO_4                 5.282535e-01 1 1  ON 24
 eO_5                 4.878659e-01 1 1  ON 25
 eO_6                 2.579853e-01 1 1  ON 26
 eO_7                -4.434596e-02 1 1  ON 27
 eO_8                -2.220651e-01 1 1  ON 28
 eO_9                -8.259673e-02 1 1  ON 29
eH1_0                -2.444287e-01 1 1  ON 30
eH1_1                -1.444626e-01 1 1  ON 31
eH1_2                -9.814465e-02 1 1  ON 32
eH1_3                -4.402393e-02 1 1  ON 33
eH1_4                 2.784514e-03 1 1  ON 34
eH1_5                 3.852450e-02 1 1  ON 35
eH1_6                 9.813885e-02 1 1  ON 36
eH1_7                 1.510217e-01 1 1  ON 37
eH1_8                 1.770104e-01 1 1  ON 38
eH1_9                 6.644207e-02 1 1  ON 39
eH2_0                -2.407846e-01 1 1  ON 40
eH2_1                -1.409990e-01 1 1  ON 41
eH2_2                -9.488781e-02 1 1  ON 42
eH2_3                -4.052830e-02 1 1  ON 43
eH2_4                 6.986567e-03 1 1  ON 44
eH2_5                 4.201485e-02 1 1  ON 45
eH2_6                 9.975538e-02 1 1  ON 46
eH2_7                 1.516381e-01 1 1  ON 47
eH2_8                 1.803377e-01 1 1  ON 48
eH2_9                 5.299125e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9302
    reference variance = 0.252881
====================================================
  Execution time = 3.3879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4067e-01
  Total weights = 2.0000e+06
  Execution time = 3.1898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340290410671
                                         uncertainty =       0.003007190505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340290410671
                                         uncertainty =       0.003007190505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412494454
  error estimate for blocks of size 2^( 2) =       0.000425104483
  error estimate for blocks of size 2^( 3) =       0.000439147023
  error estimate for blocks of size 2^( 4) =       0.000451380347
  error estimate for blocks of size 2^( 5) =       0.000462114610
  error estimate for blocks of size 2^( 6) =       0.000470171528
  error estimate for blocks of size 2^( 7) =       0.000478438957

      target function =                  N/A
              le_mean =     -16.905521692752
             les_mean =     286.136966883867
             stat err =       0.000465526361
             autocorr =       1.273656533191
              std dev =       0.583355251900
             le_variance =       0.340303349919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340980151960
                                         uncertainty =       0.003011764537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340980151960
                                         uncertainty =       0.003011764537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412912120
  error estimate for blocks of size 2^( 2) =       0.000425504663
  error estimate for blocks of size 2^( 3) =       0.000439511182
  error estimate for blocks of size 2^( 4) =       0.000451680124
  error estimate for blocks of size 2^( 5) =       0.000462357379
  error estimate for blocks of size 2^( 6) =       0.000470333717
  error estimate for blocks of size 2^( 7) =       0.000478559726

      target function =                  N/A
              le_mean =     -16.905518845003
             les_mean =     286.137560086489
             stat err =       0.000465732737
             autocorr =       1.272208432138
              std dev =       0.583945920633
             le_variance =       0.340992838224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341033317396
                                         uncertainty =       0.003012997957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341033317396
                                         uncertainty =       0.003012997957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412944471
  error estimate for blocks of size 2^( 2) =       0.000425536820
  error estimate for blocks of size 2^( 3) =       0.000439546355
  error estimate for blocks of size 2^( 4) =       0.000451732938
  error estimate for blocks of size 2^( 5) =       0.000462433224
  error estimate for blocks of size 2^( 6) =       0.000470426107
  error estimate for blocks of size 2^( 7) =       0.000478654211

      target function =                  N/A
              le_mean =     -16.905516817932
             les_mean =     286.137544983395
             stat err =       0.000465811620
             autocorr =       1.272440033952
              std dev =       0.583991671635
             le_variance =       0.341046272539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340461276649
                                         uncertainty =       0.003008816240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340461276649
                                         uncertainty =       0.003008816240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412598052
  error estimate for blocks of size 2^( 2) =       0.000425202609
  error estimate for blocks of size 2^( 3) =       0.000439236491
  error estimate for blocks of size 2^( 4) =       0.000451460865
  error estimate for blocks of size 2^( 5) =       0.000462189090
  error estimate for blocks of size 2^( 6) =       0.000470231946
  error estimate for blocks of size 2^( 7) =       0.000478490561

      target function =                  N/A
              le_mean =     -16.905518429854
             les_mean =     286.137027517569
             stat err =       0.000465593116
             autocorr =       1.273382136387
              std dev =       0.583501761490
             le_variance =       0.340474305662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905521692752        initial  <--
     6.1035e-03     6.1035e-02             3.6522e-02       -16.905518845003
     2.4414e-02     2.4414e-01             9.0786e-03       -16.905516817932
     9.7656e-02     9.7656e-01             2.2541e-03       -16.905518429854

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.9271
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.7410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9442
    reference variance = 0.19389
====================================================
  Execution time = 3.4673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3043e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330380192645
                                         uncertainty =       0.002868648131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330380192645
                                         uncertainty =       0.002868648131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406465073
  error estimate for blocks of size 2^( 2) =       0.000419343902
  error estimate for blocks of size 2^( 3) =       0.000432529278
  error estimate for blocks of size 2^( 4) =       0.000445041302
  error estimate for blocks of size 2^( 5) =       0.000454674830
  error estimate for blocks of size 2^( 6) =       0.000462674188
  error estimate for blocks of size 2^( 7) =       0.000469630314

      target function =                  N/A
              le_mean =     -16.906308861824
             les_mean =     286.153706877817
             stat err =       0.000458005159
             autocorr =       1.269679980451
              std dev =       0.574828419303
             le_variance =       0.330427711639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630886182e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906308861824       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906309748336       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313362776       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313161099       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906314619023       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313945715       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906314233829       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906315055482       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906314604576       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906315332590       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906316329731       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906316669418       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906316542165       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.408624e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906308861824       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906309389597       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906311135338       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906311872739       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906311748702       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906311384271       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906311706641       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906311495443       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906311478900       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906311590856       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 8.478929e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906308861824       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906309063368       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906309293930       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906309776334       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906309880527       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906309844646       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906309860010       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906309860309       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.097702e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052591 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3760e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.088247e-01 1 1  ON 0
 uu_1                 1.420480e-01 1 1  ON 1
 uu_2                 4.100191e-02 1 1  ON 2
 uu_3                -2.104550e-02 1 1  ON 3
 uu_4                -6.587156e-02 1 1  ON 4
 uu_5                -9.970521e-02 1 1  ON 5
 uu_6                -1.262382e-01 1 1  ON 6
 uu_7                -1.390157e-01 1 1  ON 7
 uu_8                -1.314034e-01 1 1  ON 8
 uu_9                -1.019741e-01 1 1  ON 9
 ud_0                 4.490736e-01 1 1  ON 10
 ud_1                 1.828402e-01 1 1  ON 11
 ud_2                 6.203877e-02 1 1  ON 12
 ud_3                -9.724610e-03 1 1  ON 13
 ud_4                -6.720066e-02 1 1  ON 14
 ud_5                -1.084547e-01 1 1  ON 15
 ud_6                -1.356093e-01 1 1  ON 16
 ud_7                -1.510377e-01 1 1  ON 17
 ud_8                -1.511669e-01 1 1  ON 18
 ud_9                -1.397589e-01 1 1  ON 19
 eO_0                -7.652224e-01 1 1  ON 20
 eO_1                -4.431298e-01 1 1  ON 21
 eO_2                -2.044508e-02 1 1  ON 22
 eO_3                 3.023218e-01 1 1  ON 23
 eO_4                 5.269426e-01 1 1  ON 24
 eO_5                 4.862770e-01 1 1  ON 25
 eO_6                 2.556578e-01 1 1  ON 26
 eO_7                -4.690247e-02 1 1  ON 27
 eO_8                -2.184022e-01 1 1  ON 28
 eO_9                -7.728612e-02 1 1  ON 29
eH1_0                -2.421903e-01 1 1  ON 30
eH1_1                -1.425316e-01 1 1  ON 31
eH1_2                -9.591520e-02 1 1  ON 32
eH1_3                -4.214450e-02 1 1  ON 33
eH1_4                 5.880639e-03 1 1  ON 34
eH1_5                 4.028867e-02 1 1  ON 35
eH1_6                 9.824956e-02 1 1  ON 36
eH1_7                 1.510186e-01 1 1  ON 37
eH1_8                 1.731706e-01 1 1  ON 38
eH1_9                 5.821132e-02 1 1  ON 39
eH2_0                -2.374690e-01 1 1  ON 40
eH2_1                -1.378949e-01 1 1  ON 41
eH2_2                -9.179238e-02 1 1  ON 42
eH2_3                -3.795797e-02 1 1  ON 43
eH2_4                 9.874805e-03 1 1  ON 44
eH2_5                 4.343978e-02 1 1  ON 45
eH2_6                 9.913573e-02 1 1  ON 46
eH2_7                 1.495387e-01 1 1  ON 47
eH2_8                 1.756190e-01 1 1  ON 48
eH2_9                 4.502477e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9463
    reference variance = 0.581678
====================================================
  Execution time = 3.4605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3953e-01
  Total weights = 2.0000e+06
  Execution time = 3.1811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338858308198
                                         uncertainty =       0.003473326933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338858308198
                                         uncertainty =       0.003473326933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412262917
  error estimate for blocks of size 2^( 2) =       0.000425356878
  error estimate for blocks of size 2^( 3) =       0.000438072728
  error estimate for blocks of size 2^( 4) =       0.000450677429
  error estimate for blocks of size 2^( 5) =       0.000461298119
  error estimate for blocks of size 2^( 6) =       0.000469589613
  error estimate for blocks of size 2^( 7) =       0.000473918028

      target function =                  N/A
              le_mean =     -16.905913073994
             les_mean =     286.149818121206
             stat err =       0.000463870797
             autocorr =       1.266034442626
              std dev =       0.583027808703
             le_variance =       0.339921425721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338331685742
                                         uncertainty =       0.003466361511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338331685742
                                         uncertainty =       0.003466361511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411940859
  error estimate for blocks of size 2^( 2) =       0.000425057380
  error estimate for blocks of size 2^( 3) =       0.000437789992
  error estimate for blocks of size 2^( 4) =       0.000450406991
  error estimate for blocks of size 2^( 5) =       0.000461029180
  error estimate for blocks of size 2^( 6) =       0.000469331402
  error estimate for blocks of size 2^( 7) =       0.000473664485

      target function =                  N/A
              le_mean =     -16.905909539144
             les_mean =     286.149167718272
             stat err =       0.000463608015
             autocorr =       1.266578555229
              std dev =       0.582572349359
             le_variance =       0.339390542238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338084851237
                                         uncertainty =       0.003463569959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338084851237
                                         uncertainty =       0.003463569959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411790548
  error estimate for blocks of size 2^( 2) =       0.000424916019
  error estimate for blocks of size 2^( 3) =       0.000437658806
  error estimate for blocks of size 2^( 4) =       0.000450285730
  error estimate for blocks of size 2^( 5) =       0.000460916073
  error estimate for blocks of size 2^( 6) =       0.000469226277
  error estimate for blocks of size 2^( 7) =       0.000473560994

      target function =                  N/A
              le_mean =     -16.905908326587
             les_mean =     286.148879088242
             stat err =       0.000463497268
             autocorr =       1.266897882122
              std dev =       0.582359777853
             le_variance =       0.339142910861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338677679644
                                         uncertainty =       0.003471055858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338677679644
                                         uncertainty =       0.003471055858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412152683
  error estimate for blocks of size 2^( 2) =       0.000425253865
  error estimate for blocks of size 2^( 3) =       0.000437975885
  error estimate for blocks of size 2^( 4) =       0.000450586012
  error estimate for blocks of size 2^( 5) =       0.000461209230
  error estimate for blocks of size 2^( 6) =       0.000469505297
  error estimate for blocks of size 2^( 7) =       0.000473835519

      target function =                  N/A
              le_mean =     -16.905911732361
             les_mean =     286.149591001328
             stat err =       0.000463784014
             autocorr =       1.266237839312
              std dev =       0.582871914575
             le_variance =       0.339739668800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905913073994        initial  <--
     6.1035e-02     6.1035e-01             3.4086e-03       -16.905909539144
     2.4414e-01     2.4414e+00             8.4789e-04       -16.905908326587
     9.7656e-01     9.7656e+00             2.0977e-04       -16.905911732361

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.5906
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9813
    reference variance = 0.3473
====================================================
  Execution time = 3.4714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4482e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344704991892
                                         uncertainty =       0.005981942412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344704991892
                                         uncertainty =       0.005981942412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415224332
  error estimate for blocks of size 2^( 2) =       0.000428048136
  error estimate for blocks of size 2^( 3) =       0.000440986170
  error estimate for blocks of size 2^( 4) =       0.000453641495
  error estimate for blocks of size 2^( 5) =       0.000464300314
  error estimate for blocks of size 2^( 6) =       0.000472897567
  error estimate for blocks of size 2^( 7) =       0.000476503524

      target function =                  N/A
              le_mean =     -16.906068304732
             les_mean =     286.159967843310
             stat err =       0.000466835725
             autocorr =       1.264045122608
              std dev =       0.587215881474
             le_variance =       0.344822491455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606830473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906068304732       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906069099869       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906069606772       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906069931802       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906069959913       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906070170447       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906070306099       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906070362940       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906070250553       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.428821e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906068304732       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906068540200       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906068727345       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906068831760       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906068831049       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906068858798       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906068907002       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906068927332       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.338253e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906068304732       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906068366446       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906068419245       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906068447038       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906068447334       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906068452114       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906068463946       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906068469696       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.095432e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055461 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3859e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.088180e-01 1 1  ON 0
 uu_1                 1.421395e-01 1 1  ON 1
 uu_2                 4.085802e-02 1 1  ON 2
 uu_3                -2.129409e-02 1 1  ON 3
 uu_4                -6.585561e-02 1 1  ON 4
 uu_5                -9.963784e-02 1 1  ON 5
 uu_6                -1.260955e-01 1 1  ON 6
 uu_7                -1.389502e-01 1 1  ON 7
 uu_8                -1.311917e-01 1 1  ON 8
 uu_9                -1.014879e-01 1 1  ON 9
 ud_0                 4.492666e-01 1 1  ON 10
 ud_1                 1.828446e-01 1 1  ON 11
 ud_2                 6.187886e-02 1 1  ON 12
 ud_3                -9.873821e-03 1 1  ON 13
 ud_4                -6.714687e-02 1 1  ON 14
 ud_5                -1.085186e-01 1 1  ON 15
 ud_6                -1.354007e-01 1 1  ON 16
 ud_7                -1.511860e-01 1 1  ON 17
 ud_8                -1.511803e-01 1 1  ON 18
 ud_9                -1.397125e-01 1 1  ON 19
 eO_0                -7.653963e-01 1 1  ON 20
 eO_1                -4.431792e-01 1 1  ON 21
 eO_2                -1.998780e-02 1 1  ON 22
 eO_3                 3.023709e-01 1 1  ON 23
 eO_4                 5.268123e-01 1 1  ON 24
 eO_5                 4.858431e-01 1 1  ON 25
 eO_6                 2.552023e-01 1 1  ON 26
 eO_7                -4.704011e-02 1 1  ON 27
 eO_8                -2.180366e-01 1 1  ON 28
 eO_9                -7.685326e-02 1 1  ON 29
eH1_0                -2.422945e-01 1 1  ON 30
eH1_1                -1.421973e-01 1 1  ON 31
eH1_2                -9.546991e-02 1 1  ON 32
eH1_3                -4.178497e-02 1 1  ON 33
eH1_4                 6.540615e-03 1 1  ON 34
eH1_5                 4.072293e-02 1 1  ON 35
eH1_6                 9.812985e-02 1 1  ON 36
eH1_7                 1.506072e-01 1 1  ON 37
eH1_8                 1.724051e-01 1 1  ON 38
eH1_9                 5.743095e-02 1 1  ON 39
eH2_0                -2.371135e-01 1 1  ON 40
eH2_1                -1.378036e-01 1 1  ON 41
eH2_2                -9.176794e-02 1 1  ON 42
eH2_3                -3.775173e-02 1 1  ON 43
eH2_4                 9.906075e-03 1 1  ON 44
eH2_5                 4.332703e-02 1 1  ON 45
eH2_6                 9.906371e-02 1 1  ON 46
eH2_7                 1.498284e-01 1 1  ON 47
eH2_8                 1.755229e-01 1 1  ON 48
eH2_9                 4.433665e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.496244
====================================================
  Execution time = 3.4002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3810e-01
  Total weights = 2.0000e+06
  Execution time = 3.1892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338198838631
                                         uncertainty =       0.003119498249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338198838631
                                         uncertainty =       0.003119498249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411185014
  error estimate for blocks of size 2^( 2) =       0.000423962570
  error estimate for blocks of size 2^( 3) =       0.000436863314
  error estimate for blocks of size 2^( 4) =       0.000449696938
  error estimate for blocks of size 2^( 5) =       0.000460770985
  error estimate for blocks of size 2^( 6) =       0.000468980669
  error estimate for blocks of size 2^( 7) =       0.000473328464

      target function =                  N/A
              le_mean =     -16.905345394093
             les_mean =     286.128848955617
             stat err =       0.000463194264
             autocorr =       1.268971269810
              std dev =       0.581503423140
             le_variance =       0.338146231123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338086895216
                                         uncertainty =       0.003118271416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338086895216
                                         uncertainty =       0.003118271416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411116964
  error estimate for blocks of size 2^( 2) =       0.000423894308
  error estimate for blocks of size 2^( 3) =       0.000436796291
  error estimate for blocks of size 2^( 4) =       0.000449630538
  error estimate for blocks of size 2^( 5) =       0.000460707883
  error estimate for blocks of size 2^( 6) =       0.000468920464
  error estimate for blocks of size 2^( 7) =       0.000473265231

      target function =                  N/A
              le_mean =     -16.905345086779
             les_mean =     286.128726650588
             stat err =       0.000463131029
             autocorr =       1.269044824642
              std dev =       0.581407186503
             le_variance =       0.338034316518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338098909222
                                         uncertainty =       0.003118608531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338098909222
                                         uncertainty =       0.003118608531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411124269
  error estimate for blocks of size 2^( 2) =       0.000423902378
  error estimate for blocks of size 2^( 3) =       0.000436804892
  error estimate for blocks of size 2^( 4) =       0.000449639420
  error estimate for blocks of size 2^( 5) =       0.000460716269
  error estimate for blocks of size 2^( 6) =       0.000468928174
  error estimate for blocks of size 2^( 7) =       0.000473273463

      target function =                  N/A
              le_mean =     -16.905345264945
             les_mean =     286.128744686450
             stat err =       0.000463139332
             autocorr =       1.269045230626
              std dev =       0.581417516491
             le_variance =       0.338046328483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338184737245
                                         uncertainty =       0.003119379556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338184737245
                                         uncertainty =       0.003119379556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411176442
  error estimate for blocks of size 2^( 2) =       0.000423954082
  error estimate for blocks of size 2^( 3) =       0.000436855081
  error estimate for blocks of size 2^( 4) =       0.000449688841
  error estimate for blocks of size 2^( 5) =       0.000460763283
  error estimate for blocks of size 2^( 6) =       0.000468973273
  error estimate for blocks of size 2^( 7) =       0.000473320710

      target function =                  N/A
              le_mean =     -16.905345367172
             les_mean =     286.128833947920
             stat err =       0.000463186527
             autocorr =       1.268981781879
              std dev =       0.581491301421
             le_variance =       0.338132133629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905345394093        initial  <--
     6.1035e-01     6.1035e+00             3.4288e-04       -16.905345086779
     2.4414e+00     2.4414e+01             8.3383e-05       -16.905345264945
     9.7656e+00     9.7656e+01             2.0954e-05       -16.905345367172

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.0245
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3890e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9067
    reference variance = 0.339488
====================================================
  Execution time = 3.5628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4845e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348489652212
                                         uncertainty =       0.007844792210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348489652212
                                         uncertainty =       0.007844792210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417404969
  error estimate for blocks of size 2^( 2) =       0.000430272511
  error estimate for blocks of size 2^( 3) =       0.000443422338
  error estimate for blocks of size 2^( 4) =       0.000455158675
  error estimate for blocks of size 2^( 5) =       0.000466347964
  error estimate for blocks of size 2^( 6) =       0.000475117705
  error estimate for blocks of size 2^( 7) =       0.000481477011

      target function =                  N/A
              le_mean =     -16.905780831769
             les_mean =     286.153879173408
             stat err =       0.000469525339
             autocorr =       1.265327188260
              std dev =       0.590299767760
             le_variance =       0.348453815817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578083177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780831769       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780849041       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780840311       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780847787       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780829503       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780852971       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780867885       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780879269       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.339932e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780831769       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780836189       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780834228       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780835788       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780830834       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780836507       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780840667       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780843420       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.088012e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780831769       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780832881       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780832406       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780832775       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780831512       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780832916       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780833983       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780834665       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.721987e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4776e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.088310e-01 1 1  ON 0
 uu_1                 1.420945e-01 1 1  ON 1
 uu_2                 4.083361e-02 1 1  ON 2
 uu_3                -2.129377e-02 1 1  ON 3
 uu_4                -6.580217e-02 1 1  ON 4
 uu_5                -9.963979e-02 1 1  ON 5
 uu_6                -1.260449e-01 1 1  ON 6
 uu_7                -1.389378e-01 1 1  ON 7
 uu_8                -1.311690e-01 1 1  ON 8
 uu_9                -1.014923e-01 1 1  ON 9
 ud_0                 4.493113e-01 1 1  ON 10
 ud_1                 1.828225e-01 1 1  ON 11
 ud_2                 6.186997e-02 1 1  ON 12
 ud_3                -9.907382e-03 1 1  ON 13
 ud_4                -6.714073e-02 1 1  ON 14
 ud_5                -1.085356e-01 1 1  ON 15
 ud_6                -1.354118e-01 1 1  ON 16
 ud_7                -1.511960e-01 1 1  ON 17
 ud_8                -1.511665e-01 1 1  ON 18
 ud_9                -1.396811e-01 1 1  ON 19
 eO_0                -7.653898e-01 1 1  ON 20
 eO_1                -4.431720e-01 1 1  ON 21
 eO_2                -1.998801e-02 1 1  ON 22
 eO_3                 3.023688e-01 1 1  ON 23
 eO_4                 5.267910e-01 1 1  ON 24
 eO_5                 4.857983e-01 1 1  ON 25
 eO_6                 2.551830e-01 1 1  ON 26
 eO_7                -4.705997e-02 1 1  ON 27
 eO_8                -2.179940e-01 1 1  ON 28
 eO_9                -7.680686e-02 1 1  ON 29
eH1_0                -2.422754e-01 1 1  ON 30
eH1_1                -1.422384e-01 1 1  ON 31
eH1_2                -9.541065e-02 1 1  ON 32
eH1_3                -4.176452e-02 1 1  ON 33
eH1_4                 6.571186e-03 1 1  ON 34
eH1_5                 4.071149e-02 1 1  ON 35
eH1_6                 9.816203e-02 1 1  ON 36
eH1_7                 1.506119e-01 1 1  ON 37
eH1_8                 1.723607e-01 1 1  ON 38
eH1_9                 5.737077e-02 1 1  ON 39
eH2_0                -2.370773e-01 1 1  ON 40
eH2_1                -1.377266e-01 1 1  ON 41
eH2_2                -9.173603e-02 1 1  ON 42
eH2_3                -3.775163e-02 1 1  ON 43
eH2_4                 9.912714e-03 1 1  ON 44
eH2_5                 4.334152e-02 1 1  ON 45
eH2_6                 9.908218e-02 1 1  ON 46
eH2_7                 1.497870e-01 1 1  ON 47
eH2_8                 1.754674e-01 1 1  ON 48
eH2_9                 4.426415e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9421
    reference variance = 0.323886
====================================================
  Execution time = 3.5065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3941e-01
  Total weights = 2.0000e+06
  Execution time = 3.1672e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339366524803
                                         uncertainty =       0.003599139430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339366524803
                                         uncertainty =       0.003599139430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411954648
  error estimate for blocks of size 2^( 2) =       0.000424777687
  error estimate for blocks of size 2^( 3) =       0.000437733460
  error estimate for blocks of size 2^( 4) =       0.000449114365
  error estimate for blocks of size 2^( 5) =       0.000458939428
  error estimate for blocks of size 2^( 6) =       0.000465544325
  error estimate for blocks of size 2^( 7) =       0.000470896735

      target function =                  N/A
              le_mean =     -16.905704174824
             les_mean =     286.142246741377
             stat err =       0.000461123713
             autocorr =       1.252956800615
              std dev =       0.582591850640
             le_variance =       0.339413264432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339341385901
                                         uncertainty =       0.003598622663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339341385901
                                         uncertainty =       0.003598622663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411939387
  error estimate for blocks of size 2^( 2) =       0.000424763041
  error estimate for blocks of size 2^( 3) =       0.000437719528
  error estimate for blocks of size 2^( 4) =       0.000449101329
  error estimate for blocks of size 2^( 5) =       0.000458926578
  error estimate for blocks of size 2^( 6) =       0.000465532069
  error estimate for blocks of size 2^( 7) =       0.000470885079

      target function =                  N/A
              le_mean =     -16.905703887236
             les_mean =     286.142211870915
             stat err =       0.000461111264
             autocorr =       1.252981978067
              std dev =       0.582570268472
             le_variance =       0.339388117707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339353460564
                                         uncertainty =       0.003598870063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339353460564
                                         uncertainty =       0.003598870063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411946718
  error estimate for blocks of size 2^( 2) =       0.000424770076
  error estimate for blocks of size 2^( 3) =       0.000437726221
  error estimate for blocks of size 2^( 4) =       0.000449107593
  error estimate for blocks of size 2^( 5) =       0.000458932754
  error estimate for blocks of size 2^( 6) =       0.000465537963
  error estimate for blocks of size 2^( 7) =       0.000470890688

      target function =                  N/A
              le_mean =     -16.905704023715
             les_mean =     286.142228563945
             stat err =       0.000461117249
             autocorr =       1.252969916379
              std dev =       0.582580634939
             le_variance =       0.339400196206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339364874825
                                         uncertainty =       0.003599105393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339364874825
                                         uncertainty =       0.003599105393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411953647
  error estimate for blocks of size 2^( 2) =       0.000424776725
  error estimate for blocks of size 2^( 3) =       0.000437732546
  error estimate for blocks of size 2^( 4) =       0.000449113509
  error estimate for blocks of size 2^( 5) =       0.000458938585
  error estimate for blocks of size 2^( 6) =       0.000465543522
  error estimate for blocks of size 2^( 7) =       0.000470895972

      target function =                  N/A
              le_mean =     -16.905704155614
             les_mean =     286.142244441381
             stat err =       0.000461122897
             autocorr =       1.252958457511
              std dev =       0.582590434141
             le_variance =       0.339411613953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905704174824        initial  <--
     6.1035e+00     6.1035e+01             4.3399e-05       -16.905703887236
     2.4414e+01     2.4414e+02             1.0880e-05       -16.905704023715
     9.7656e+01     9.7656e+02             2.7220e-06       -16.905704155614

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.9421
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.877
    reference variance = 0.166512
====================================================
  Execution time = 3.4135e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4932e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349177240717
                                         uncertainty =       0.005128653236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349177240717
                                         uncertainty =       0.005128653236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417925059
  error estimate for blocks of size 2^( 2) =       0.000430978724
  error estimate for blocks of size 2^( 3) =       0.000443911594
  error estimate for blocks of size 2^( 4) =       0.000457761490
  error estimate for blocks of size 2^( 5) =       0.000468836941
  error estimate for blocks of size 2^( 6) =       0.000477580502
  error estimate for blocks of size 2^( 7) =       0.000483556041

      target function =                  N/A
              le_mean =     -16.904587562880
             les_mean =     286.114403206164
             stat err =       0.000471933743
             autocorr =       1.275161630099
              std dev =       0.591035286383
             le_variance =       0.349322709749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690458756288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904587562880       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904587566694       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904587568201       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904587562502       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904587568733       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904587566070       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904587569643       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.874366e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904587562880       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904587563835       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904587564211       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904587562786       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904587564349       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904587563682       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904587564570       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.707714e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904587562880       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904587563119       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904587563213       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904587562857       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904587563247       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904587563081       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904587563302       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.428297e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3400e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.088363e-01 1 1  ON 0
 uu_1                 1.420893e-01 1 1  ON 1
 uu_2                 4.083264e-02 1 1  ON 2
 uu_3                -2.129563e-02 1 1  ON 3
 uu_4                -6.580160e-02 1 1  ON 4
 uu_5                -9.964285e-02 1 1  ON 5
 uu_6                -1.260402e-01 1 1  ON 6
 uu_7                -1.389347e-01 1 1  ON 7
 uu_8                -1.311687e-01 1 1  ON 8
 uu_9                -1.014901e-01 1 1  ON 9
 ud_0                 4.493185e-01 1 1  ON 10
 ud_1                 1.828245e-01 1 1  ON 11
 ud_2                 6.186998e-02 1 1  ON 12
 ud_3                -9.907770e-03 1 1  ON 13
 ud_4                -6.714302e-02 1 1  ON 14
 ud_5                -1.085360e-01 1 1  ON 15
 ud_6                -1.354157e-01 1 1  ON 16
 ud_7                -1.511956e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396839e-01 1 1  ON 19
 eO_0                -7.653846e-01 1 1  ON 20
 eO_1                -4.431733e-01 1 1  ON 21
 eO_2                -1.998662e-02 1 1  ON 22
 eO_3                 3.023699e-01 1 1  ON 23
 eO_4                 5.267872e-01 1 1  ON 24
 eO_5                 4.857963e-01 1 1  ON 25
 eO_6                 2.551756e-01 1 1  ON 26
 eO_7                -4.706141e-02 1 1  ON 27
 eO_8                -2.179906e-01 1 1  ON 28
 eO_9                -7.680288e-02 1 1  ON 29
eH1_0                -2.422769e-01 1 1  ON 30
eH1_1                -1.422370e-01 1 1  ON 31
eH1_2                -9.540420e-02 1 1  ON 32
eH1_3                -4.176540e-02 1 1  ON 33
eH1_4                 6.575860e-03 1 1  ON 34
eH1_5                 4.071720e-02 1 1  ON 35
eH1_6                 9.816328e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723554e-01 1 1  ON 38
eH1_9                 5.736407e-02 1 1  ON 39
eH2_0                -2.370704e-01 1 1  ON 40
eH2_1                -1.377265e-01 1 1  ON 41
eH2_2                -9.173545e-02 1 1  ON 42
eH2_3                -3.775243e-02 1 1  ON 43
eH2_4                 9.914643e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908446e-02 1 1  ON 46
eH2_7                 1.497880e-01 1 1  ON 47
eH2_8                 1.754643e-01 1 1  ON 48
eH2_9                 4.425411e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9196
    reference variance = 0.287649
====================================================
  Execution time = 3.3417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4154e-01
  Total weights = 2.0000e+06
  Execution time = 3.1495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341650091426
                                         uncertainty =       0.005714213048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341650091426
                                         uncertainty =       0.005714213048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413245942
  error estimate for blocks of size 2^( 2) =       0.000426240346
  error estimate for blocks of size 2^( 3) =       0.000439919020
  error estimate for blocks of size 2^( 4) =       0.000451646326
  error estimate for blocks of size 2^( 5) =       0.000462282082
  error estimate for blocks of size 2^( 6) =       0.000470950361
  error estimate for blocks of size 2^( 7) =       0.000476022403

      target function =                  N/A
              le_mean =     -16.906136111655
             les_mean =     286.158982471621
             stat err =       0.000465225293
             autocorr =       1.267387565282
              std dev =       0.584418015278
             le_variance =       0.341544416581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341647900668
                                         uncertainty =       0.005714232480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341647900668
                                         uncertainty =       0.005714232480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413244617
  error estimate for blocks of size 2^( 2) =       0.000426239095
  error estimate for blocks of size 2^( 3) =       0.000439917838
  error estimate for blocks of size 2^( 4) =       0.000451645159
  error estimate for blocks of size 2^( 5) =       0.000462280918
  error estimate for blocks of size 2^( 6) =       0.000470949235
  error estimate for blocks of size 2^( 7) =       0.000476021380

      target function =                  N/A
              le_mean =     -16.906136087599
             les_mean =     286.158979468065
             stat err =       0.000465224173
             autocorr =       1.267389590010
              std dev =       0.584416141484
             le_variance =       0.341542226427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341648994550
                                         uncertainty =       0.005714222857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341648994550
                                         uncertainty =       0.005714222857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413245278
  error estimate for blocks of size 2^( 2) =       0.000426239720
  error estimate for blocks of size 2^( 3) =       0.000439918428
  error estimate for blocks of size 2^( 4) =       0.000451645742
  error estimate for blocks of size 2^( 5) =       0.000462281499
  error estimate for blocks of size 2^( 6) =       0.000470949797
  error estimate for blocks of size 2^( 7) =       0.000476021891

      target function =                  N/A
              le_mean =     -16.906136099536
             les_mean =     286.158980965284
             stat err =       0.000465224732
             autocorr =       1.267388579619
              std dev =       0.584417077099
             le_variance =       0.341543320005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341649954263
                                         uncertainty =       0.005714214277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341649954263
                                         uncertainty =       0.005714214277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413245859
  error estimate for blocks of size 2^( 2) =       0.000426240268
  error estimate for blocks of size 2^( 3) =       0.000439918946
  error estimate for blocks of size 2^( 4) =       0.000451646253
  error estimate for blocks of size 2^( 5) =       0.000462282009
  error estimate for blocks of size 2^( 6) =       0.000470950291
  error estimate for blocks of size 2^( 7) =       0.000476022339

      target function =                  N/A
              le_mean =     -16.906136110137
             les_mean =     286.158982283153
             stat err =       0.000465225223
             autocorr =       1.267387692141
              std dev =       0.584417897960
             le_variance =       0.341544279456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906136111655        initial  <--
     6.1035e+01     6.1035e+02             3.8744e-06       -16.906136087599
     2.4414e+02     2.4414e+03             9.7077e-07       -16.906136099536
     9.7656e+02     9.7656e+03             2.4283e-07       -16.906136110137

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.2527
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9156
    reference variance = 0.300671
====================================================
  Execution time = 3.4662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342734877682
                                         uncertainty =       0.004824708965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342734877682
                                         uncertainty =       0.004824708965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413929337
  error estimate for blocks of size 2^( 2) =       0.000427222450
  error estimate for blocks of size 2^( 3) =       0.000441369587
  error estimate for blocks of size 2^( 4) =       0.000454635015
  error estimate for blocks of size 2^( 5) =       0.000467450212
  error estimate for blocks of size 2^( 6) =       0.000477793325
  error estimate for blocks of size 2^( 7) =       0.000483613203

      target function =                  N/A
              le_mean =     -16.905860840037
             les_mean =     286.150805563696
             stat err =       0.000470872939
             autocorr =       1.294061891316
              std dev =       0.585384482486
             le_variance =       0.342674992335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586084004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905860840037       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905860840715       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905860839812       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905860840445       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905860840562       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905860840909       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905860840970       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905860840639       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.185310e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905860840037       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905860840207       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905860839981       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905860840139       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905860840168       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905860840256       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905860840272       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905860840187       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.046481e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905860840037       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905860840079       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905860840023       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905860840063       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905860840074       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905860840091       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905860840092       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905860840083       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.616298e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3792e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420893e-01 1 1  ON 1
 uu_2                 4.083277e-02 1 1  ON 2
 uu_3                -2.129606e-02 1 1  ON 3
 uu_4                -6.580118e-02 1 1  ON 4
 uu_5                -9.964313e-02 1 1  ON 5
 uu_6                -1.260402e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311687e-01 1 1  ON 8
 uu_9                -1.014898e-01 1 1  ON 9
 ud_0                 4.493186e-01 1 1  ON 10
 ud_1                 1.828243e-01 1 1  ON 11
 ud_2                 6.186962e-02 1 1  ON 12
 ud_3                -9.907850e-03 1 1  ON 13
 ud_4                -6.714289e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511656e-01 1 1  ON 18
 ud_9                -1.396836e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998631e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706178e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680233e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540418e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576301e-03 1 1  ON 34
eH1_5                 4.071738e-02 1 1  ON 35
eH1_6                 9.816337e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736350e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377257e-01 1 1  ON 41
eH2_2                -9.173528e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915077e-03 1 1  ON 44
eH2_5                 4.334432e-02 1 1  ON 45
eH2_6                 9.908432e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425336e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9357
    reference variance = 0.316157
====================================================
  Execution time = 3.3075e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3621e-01
  Total weights = 2.0000e+06
  Execution time = 3.1512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336219428608
                                         uncertainty =       0.003527745264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336219428608
                                         uncertainty =       0.003527745264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410008244
  error estimate for blocks of size 2^( 2) =       0.000423122884
  error estimate for blocks of size 2^( 3) =       0.000436918652
  error estimate for blocks of size 2^( 4) =       0.000449849185
  error estimate for blocks of size 2^( 5) =       0.000462228957
  error estimate for blocks of size 2^( 6) =       0.000473215973
  error estimate for blocks of size 2^( 7) =       0.000480052035

      target function =                  N/A
              le_mean =     -16.904586160989
             les_mean =     286.101246626546
             stat err =       0.000466336538
             autocorr =       1.293640815428
              std dev =       0.579839219405
             le_variance =       0.336213520360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336219269203
                                         uncertainty =       0.003527744197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336219269203
                                         uncertainty =       0.003527744197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410008147
  error estimate for blocks of size 2^( 2) =       0.000423122793
  error estimate for blocks of size 2^( 3) =       0.000436918565
  error estimate for blocks of size 2^( 4) =       0.000449849100
  error estimate for blocks of size 2^( 5) =       0.000462228869
  error estimate for blocks of size 2^( 6) =       0.000473215886
  error estimate for blocks of size 2^( 7) =       0.000480051955

      target function =                  N/A
              le_mean =     -16.904586159925
             les_mean =     286.101246431167
             stat err =       0.000466336453
             autocorr =       1.293640956741
              std dev =       0.579839081935
             le_variance =       0.336213360940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336219348886
                                         uncertainty =       0.003527744731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336219348886
                                         uncertainty =       0.003527744731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410008195
  error estimate for blocks of size 2^( 2) =       0.000423122838
  error estimate for blocks of size 2^( 3) =       0.000436918609
  error estimate for blocks of size 2^( 4) =       0.000449849142
  error estimate for blocks of size 2^( 5) =       0.000462228913
  error estimate for blocks of size 2^( 6) =       0.000473215930
  error estimate for blocks of size 2^( 7) =       0.000480051995

      target function =                  N/A
              le_mean =     -16.904586160457
             les_mean =     286.101246528824
             stat err =       0.000466336495
             autocorr =       1.293640886107
              std dev =       0.579839150653
             le_variance =       0.336213440630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336219418642
                                         uncertainty =       0.003527745198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336219418642
                                         uncertainty =       0.003527745198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410008238
  error estimate for blocks of size 2^( 2) =       0.000423122878
  error estimate for blocks of size 2^( 3) =       0.000436918647
  error estimate for blocks of size 2^( 4) =       0.000449849180
  error estimate for blocks of size 2^( 5) =       0.000462228952
  error estimate for blocks of size 2^( 6) =       0.000473215967
  error estimate for blocks of size 2^( 7) =       0.000480052030

      target function =                  N/A
              le_mean =     -16.904586160922
             les_mean =     286.101246614329
             stat err =       0.000466336532
             autocorr =       1.293640824268
              std dev =       0.579839210810
             le_variance =       0.336213510393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904586160989        initial  <--
     6.1035e+02     6.1035e+03             4.1853e-07       -16.904586159925
     2.4414e+03     2.4414e+04             1.0465e-07       -16.904586160457
     9.7656e+03     9.7656e+04             2.6163e-08       -16.904586160922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.9212
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2719e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8448
    reference variance = 0.570636
====================================================
  Execution time = 3.4718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4409e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343889387317
                                         uncertainty =       0.004623433047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343889387317
                                         uncertainty =       0.004623433047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414782316
  error estimate for blocks of size 2^( 2) =       0.000427572933
  error estimate for blocks of size 2^( 3) =       0.000440348119
  error estimate for blocks of size 2^( 4) =       0.000451822998
  error estimate for blocks of size 2^( 5) =       0.000460999019
  error estimate for blocks of size 2^( 6) =       0.000468967343
  error estimate for blocks of size 2^( 7) =       0.000473457504

      target function =                  N/A
              le_mean =     -16.906584550257
             les_mean =     286.176689721767
             stat err =       0.000463811716
             autocorr =       1.250382727528
              std dev =       0.586590776274
             le_variance =       0.344088738810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658455026e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906584550257       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906584550236       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906584550221       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906584550233       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906584550319       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906584550343       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906584550364       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906584550362       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.522114e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906584550257       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906584550252       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906584550248       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906584550251       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906584550272       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906584550278       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906584550299       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906584550297       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 8.805294e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906584550257       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906584550256       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906584550255       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906584550256       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906584550261       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906584550220       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906584550319       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906584550592       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.201325e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065936 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3995e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907870e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998624e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680230e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540409e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576403e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816337e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736344e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775252e-02 1 1  ON 43
eH2_4                 9.915098e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425328e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.965
    reference variance = 0.253937
====================================================
  Execution time = 3.4946e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4043e-01
  Total weights = 2.0000e+06
  Execution time = 3.1615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340525290423
                                         uncertainty =       0.004041378391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340525290423
                                         uncertainty =       0.004041378391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412569155
  error estimate for blocks of size 2^( 2) =       0.000425031587
  error estimate for blocks of size 2^( 3) =       0.000437809214
  error estimate for blocks of size 2^( 4) =       0.000449584398
  error estimate for blocks of size 2^( 5) =       0.000458521135
  error estimate for blocks of size 2^( 6) =       0.000465264824
  error estimate for blocks of size 2^( 7) =       0.000471212112

      target function =                  N/A
              le_mean =     -16.905917913017
             les_mean =     286.150486926674
             stat err =       0.000461145617
             autocorr =       1.249345796892
              std dev =       0.583460894324
             le_variance =       0.340426615205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340525241579
                                         uncertainty =       0.004041377756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340525241579
                                         uncertainty =       0.004041377756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412569125
  error estimate for blocks of size 2^( 2) =       0.000425031558
  error estimate for blocks of size 2^( 3) =       0.000437809186
  error estimate for blocks of size 2^( 4) =       0.000449584371
  error estimate for blocks of size 2^( 5) =       0.000458521109
  error estimate for blocks of size 2^( 6) =       0.000465264799
  error estimate for blocks of size 2^( 7) =       0.000471212087

      target function =                  N/A
              le_mean =     -16.905917912992
             les_mean =     286.150486876996
             stat err =       0.000461145592
             autocorr =       1.249345835997
              std dev =       0.583460852476
             le_variance =       0.340426566373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340525266000
                                         uncertainty =       0.004041378074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340525266000
                                         uncertainty =       0.004041378074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412569140
  error estimate for blocks of size 2^( 2) =       0.000425031573
  error estimate for blocks of size 2^( 3) =       0.000437809200
  error estimate for blocks of size 2^( 4) =       0.000449584385
  error estimate for blocks of size 2^( 5) =       0.000458521122
  error estimate for blocks of size 2^( 6) =       0.000465264811
  error estimate for blocks of size 2^( 7) =       0.000471212099

      target function =                  N/A
              le_mean =     -16.905917913005
             les_mean =     286.150486901834
             stat err =       0.000461145604
             autocorr =       1.249345816443
              std dev =       0.583460873399
             le_variance =       0.340426590787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340525287370
                                         uncertainty =       0.004041378352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340525287370
                                         uncertainty =       0.004041378352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412569153
  error estimate for blocks of size 2^( 2) =       0.000425031585
  error estimate for blocks of size 2^( 3) =       0.000437809212
  error estimate for blocks of size 2^( 4) =       0.000449584396
  error estimate for blocks of size 2^( 5) =       0.000458521134
  error estimate for blocks of size 2^( 6) =       0.000465264823
  error estimate for blocks of size 2^( 7) =       0.000471212110

      target function =                  N/A
              le_mean =     -16.905917913016
             les_mean =     286.150486923569
             stat err =       0.000461145616
             autocorr =       1.249345799332
              std dev =       0.583460891708
             le_variance =       0.340426612153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905917913017        initial  <--
     6.1035e+03     6.1035e+04             3.5221e-08       -16.905917912992
     2.4414e+04     2.4414e+05             8.8053e-09       -16.905917913005
     9.7656e+04     9.7656e+05             2.2013e-09       -16.905917913016

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.8433
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4844e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.0306
    reference variance = 0.38783
====================================================
  Execution time = 3.4139e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3687e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3278e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336915112706
                                         uncertainty =       0.003533562631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336915112706
                                         uncertainty =       0.003533562631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410408814
  error estimate for blocks of size 2^( 2) =       0.000423451499
  error estimate for blocks of size 2^( 3) =       0.000436826397
  error estimate for blocks of size 2^( 4) =       0.000450214473
  error estimate for blocks of size 2^( 5) =       0.000462513572
  error estimate for blocks of size 2^( 6) =       0.000471820265
  error estimate for blocks of size 2^( 7) =       0.000479572477

      target function =                  N/A
              le_mean =     -16.904943874948
             les_mean =     286.113998035229
             stat err =       0.000466030197
             autocorr =       1.289421058671
              std dev =       0.580405710263
             le_variance =       0.336870788506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690494387495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904943874948       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904943874953       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904943874963       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904943874966       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904943874951       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904943875001       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904943874954       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904943874882       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.173654e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904943874948       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904943874950       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904943874952       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904943874952       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904943874953       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904943874953       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904943874996       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904943874952       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 7.934135e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904943874948       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904943874949       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904943874949       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904943875552       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904943874950       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904943874468       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904943874726       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904943874978       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 1.983533e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3474e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915102e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.913
    reference variance = 0.352989
====================================================
  Execution time = 3.3350e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3835e-01
  Total weights = 2.0000e+06
  Execution time = 3.1406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291533826
                                         uncertainty =       0.004175571043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291533826
                                         uncertainty =       0.004175571043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411307519
  error estimate for blocks of size 2^( 2) =       0.000424237405
  error estimate for blocks of size 2^( 3) =       0.000437993264
  error estimate for blocks of size 2^( 4) =       0.000450310696
  error estimate for blocks of size 2^( 5) =       0.000462598272
  error estimate for blocks of size 2^( 6) =       0.000472689214
  error estimate for blocks of size 2^( 7) =       0.000481011992

      target function =                  N/A
              le_mean =     -16.905185983413
             les_mean =     286.123660715153
             stat err =       0.000466652544
             autocorr =       1.287223552440
              std dev =       0.581676671829
             le_variance =       0.338347750550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291534166
                                         uncertainty =       0.004175571048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291534166
                                         uncertainty =       0.004175571048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411307519
  error estimate for blocks of size 2^( 2) =       0.000424237405
  error estimate for blocks of size 2^( 3) =       0.000437993264
  error estimate for blocks of size 2^( 4) =       0.000450310697
  error estimate for blocks of size 2^( 5) =       0.000462598272
  error estimate for blocks of size 2^( 6) =       0.000472689215
  error estimate for blocks of size 2^( 7) =       0.000481011993

      target function =                  N/A
              le_mean =     -16.905185983413
             les_mean =     286.123660715494
             stat err =       0.000466652544
             autocorr =       1.287223552140
              std dev =       0.581676672122
             le_variance =       0.338347750891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291533996
                                         uncertainty =       0.004175571046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291533996
                                         uncertainty =       0.004175571046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411307519
  error estimate for blocks of size 2^( 2) =       0.000424237405
  error estimate for blocks of size 2^( 3) =       0.000437993264
  error estimate for blocks of size 2^( 4) =       0.000450310697
  error estimate for blocks of size 2^( 5) =       0.000462598272
  error estimate for blocks of size 2^( 6) =       0.000472689214
  error estimate for blocks of size 2^( 7) =       0.000481011993

      target function =                  N/A
              le_mean =     -16.905185983413
             les_mean =     286.123660715324
             stat err =       0.000466652544
             autocorr =       1.287223552300
              std dev =       0.581676671976
             le_variance =       0.338347750721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291533847
                                         uncertainty =       0.004175571043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291533847
                                         uncertainty =       0.004175571043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411307519
  error estimate for blocks of size 2^( 2) =       0.000424237405
  error estimate for blocks of size 2^( 3) =       0.000437993264
  error estimate for blocks of size 2^( 4) =       0.000450310697
  error estimate for blocks of size 2^( 5) =       0.000462598272
  error estimate for blocks of size 2^( 6) =       0.000472689214
  error estimate for blocks of size 2^( 7) =       0.000481011993

      target function =                  N/A
              le_mean =     -16.905185983413
             les_mean =     286.123660715174
             stat err =       0.000466652544
             autocorr =       1.287223552422
              std dev =       0.581676671848
             le_variance =       0.338347750572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905185983413        initial  <--
     6.1035e+04     6.1035e+05             3.1737e-09       -16.905185983413
     2.4414e+05     2.4414e+06             7.9341e-10       -16.905185983413
     9.7656e+05     9.7656e+06             1.9835e-10       -16.905185983413

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.1400
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9542
    reference variance = 0.174736
====================================================
  Execution time = 3.4296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3678e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336794925705
                                         uncertainty =       0.002607964150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336794925705
                                         uncertainty =       0.002607964150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410353451
  error estimate for blocks of size 2^( 2) =       0.000422836562
  error estimate for blocks of size 2^( 3) =       0.000435586846
  error estimate for blocks of size 2^( 4) =       0.000448234261
  error estimate for blocks of size 2^( 5) =       0.000458548948
  error estimate for blocks of size 2^( 6) =       0.000466993796
  error estimate for blocks of size 2^( 7) =       0.000474175395

      target function =                  N/A
              le_mean =     -16.906551744335
             les_mean =     286.168271624497
             stat err =       0.000461988100
             autocorr =       1.267492499749
              std dev =       0.580327415359
             le_variance =       0.336779909018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655174433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906551744335       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906551744337       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906551744337       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906551744308       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906551744832       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906551744716       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906551744484       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906551744486       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.068082e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906551744335       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906551744335       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906551744335       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906551744336       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906551743712       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906551749206       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906551747257       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906551745343       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.017013e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906551744335       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906551744335       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906551744335       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906551742682       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906551744335       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906551744378       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906551738866       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906551745197       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.542569e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3432e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706180e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9448
    reference variance = 0.231258
====================================================
  Execution time = 3.3575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.6541e-01
  Total weights = 2.0000e+06
  Execution time = 3.1638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365450209943
                                         uncertainty =       0.028061573546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365450209943
                                         uncertainty =       0.028061573546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427438847
  error estimate for blocks of size 2^( 2) =       0.000439570307
  error estimate for blocks of size 2^( 3) =       0.000453027110
  error estimate for blocks of size 2^( 4) =       0.000466747865
  error estimate for blocks of size 2^( 5) =       0.000477616743
  error estimate for blocks of size 2^( 6) =       0.000484691439
  error estimate for blocks of size 2^( 7) =       0.000487290224

      target function =                  N/A
              le_mean =     -16.905347796403
             les_mean =     286.156191870633
             stat err =       0.000479086568
             autocorr =       1.256261381865
              std dev =       0.604489814630
             le_variance =       0.365407935991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365450209345
                                         uncertainty =       0.028061573522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365450209345
                                         uncertainty =       0.028061573522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427438847
  error estimate for blocks of size 2^( 2) =       0.000439570307
  error estimate for blocks of size 2^( 3) =       0.000453027109
  error estimate for blocks of size 2^( 4) =       0.000466747864
  error estimate for blocks of size 2^( 5) =       0.000477616743
  error estimate for blocks of size 2^( 6) =       0.000484691439
  error estimate for blocks of size 2^( 7) =       0.000487290224

      target function =                  N/A
              le_mean =     -16.905347796404
             les_mean =     286.156191870088
             stat err =       0.000479086567
             autocorr =       1.256261382337
              std dev =       0.604489814136
             le_variance =       0.365407935394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365450209644
                                         uncertainty =       0.028061573534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365450209644
                                         uncertainty =       0.028061573534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427438847
  error estimate for blocks of size 2^( 2) =       0.000439570307
  error estimate for blocks of size 2^( 3) =       0.000453027109
  error estimate for blocks of size 2^( 4) =       0.000466747864
  error estimate for blocks of size 2^( 5) =       0.000477616743
  error estimate for blocks of size 2^( 6) =       0.000484691439
  error estimate for blocks of size 2^( 7) =       0.000487290224

      target function =                  N/A
              le_mean =     -16.905347796404
             les_mean =     286.156191870361
             stat err =       0.000479086568
             autocorr =       1.256261382094
              std dev =       0.604489814383
             le_variance =       0.365407935693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365450209906
                                         uncertainty =       0.028061573544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365450209906
                                         uncertainty =       0.028061573544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427438847
  error estimate for blocks of size 2^( 2) =       0.000439570307
  error estimate for blocks of size 2^( 3) =       0.000453027109
  error estimate for blocks of size 2^( 4) =       0.000466747865
  error estimate for blocks of size 2^( 5) =       0.000477616743
  error estimate for blocks of size 2^( 6) =       0.000484691439
  error estimate for blocks of size 2^( 7) =       0.000487290224

      target function =                  N/A
              le_mean =     -16.905347796403
             les_mean =     286.156191870599
             stat err =       0.000479086568
             autocorr =       1.256261381884
              std dev =       0.604489814599
             le_variance =       0.365407935954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905347796403        initial
     6.1035e+05     6.1035e+06             4.0681e-10       -16.905347796404  <--
     2.4414e+06     2.4414e+07             1.0170e-10       -16.905347796404
     9.7656e+06     9.7656e+07             2.5426e-11       -16.905347796403

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 4.9500e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8874
    reference variance = 0.228538
====================================================
  Execution time = 3.4042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3986e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339791882025
                                         uncertainty =       0.003036391740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339791882025
                                         uncertainty =       0.003036391740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412226194
  error estimate for blocks of size 2^( 2) =       0.000425201554
  error estimate for blocks of size 2^( 3) =       0.000438773929
  error estimate for blocks of size 2^( 4) =       0.000451837223
  error estimate for blocks of size 2^( 5) =       0.000462562692
  error estimate for blocks of size 2^( 6) =       0.000470873457
  error estimate for blocks of size 2^( 7) =       0.000476272663

      target function =                  N/A
              le_mean =     -16.905108341632
             les_mean =     286.122548743247
             stat err =       0.000465386509
             autocorr =       1.274548622971
              std dev =       0.582975875022
             le_variance =       0.339860870857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690510834163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905108341632       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905108341636       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905108341636       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905108341634       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905108341636       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905108341531       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905108341670       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905108341646       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.919391e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905108341632       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905108341633       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905108341633       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905108341633       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905108341584       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905108342140       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905108341589       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905108341121       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.798478e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905108341632       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905108341632       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905108341632       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905108341632       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905108341191       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905108341786       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905108342030       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905108341633       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.199620e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074021 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3127e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8784
    reference variance = 0.686568
====================================================
  Execution time = 3.5252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4370e-01
  Total weights = 2.0000e+06
  Execution time = 3.1504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343631157088
                                         uncertainty =       0.003713714090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343631157088
                                         uncertainty =       0.003713714090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414549424
  error estimate for blocks of size 2^( 2) =       0.000427495326
  error estimate for blocks of size 2^( 3) =       0.000440433787
  error estimate for blocks of size 2^( 4) =       0.000452327079
  error estimate for blocks of size 2^( 5) =       0.000462016225
  error estimate for blocks of size 2^( 6) =       0.000468448660
  error estimate for blocks of size 2^( 7) =       0.000474228361

      target function =                  N/A
              le_mean =     -16.905509786162
             les_mean =     286.139963408130
             stat err =       0.000464255081
             autocorr =       1.254182391531
              std dev =       0.586261417774
             le_variance =       0.343702449971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343631155611
                                         uncertainty =       0.003713714076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343631155611
                                         uncertainty =       0.003713714076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414549423
  error estimate for blocks of size 2^( 2) =       0.000427495325
  error estimate for blocks of size 2^( 3) =       0.000440433786
  error estimate for blocks of size 2^( 4) =       0.000452327078
  error estimate for blocks of size 2^( 5) =       0.000462016225
  error estimate for blocks of size 2^( 6) =       0.000468448659
  error estimate for blocks of size 2^( 7) =       0.000474228360

      target function =                  N/A
              le_mean =     -16.905509786151
             les_mean =     286.139963406295
             stat err =       0.000464255080
             autocorr =       1.254182392770
              std dev =       0.586261416514
             le_variance =       0.343702448493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343631156349
                                         uncertainty =       0.003713714083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343631156349
                                         uncertainty =       0.003713714083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414549424
  error estimate for blocks of size 2^( 2) =       0.000427495326
  error estimate for blocks of size 2^( 3) =       0.000440433786
  error estimate for blocks of size 2^( 4) =       0.000452327078
  error estimate for blocks of size 2^( 5) =       0.000462016225
  error estimate for blocks of size 2^( 6) =       0.000468448659
  error estimate for blocks of size 2^( 7) =       0.000474228360

      target function =                  N/A
              le_mean =     -16.905509786156
             les_mean =     286.139963407213
             stat err =       0.000464255081
             autocorr =       1.254182392157
              std dev =       0.586261417144
             le_variance =       0.343702449232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343631156996
                                         uncertainty =       0.003713714089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343631156996
                                         uncertainty =       0.003713714089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414549424
  error estimate for blocks of size 2^( 2) =       0.000427495326
  error estimate for blocks of size 2^( 3) =       0.000440433787
  error estimate for blocks of size 2^( 4) =       0.000452327079
  error estimate for blocks of size 2^( 5) =       0.000462016225
  error estimate for blocks of size 2^( 6) =       0.000468448660
  error estimate for blocks of size 2^( 7) =       0.000474228361

      target function =                  N/A
              le_mean =     -16.905509786161
             les_mean =     286.139963408015
             stat err =       0.000464255081
             autocorr =       1.254182391613
              std dev =       0.586261417695
             le_variance =       0.343702449878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905509786162        initial  <--
     1.5259e+05     1.5259e+06             1.9194e-09       -16.905509786151
     6.1035e+05     6.1035e+06             4.7985e-10       -16.905509786156
     2.4414e+06     2.4414e+07             1.1996e-10       -16.905509786161

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5996
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.7740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.202235
====================================================
  Execution time = 3.4187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7657e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376708009910
                                         uncertainty =       0.038244242727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376708009910
                                         uncertainty =       0.038244242727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433916887
  error estimate for blocks of size 2^( 2) =       0.000446001087
  error estimate for blocks of size 2^( 3) =       0.000458452387
  error estimate for blocks of size 2^( 4) =       0.000470316369
  error estimate for blocks of size 2^( 5) =       0.000480034925
  error estimate for blocks of size 2^( 6) =       0.000486190633
  error estimate for blocks of size 2^( 7) =       0.000489357564

      target function =                  N/A
              le_mean =     -16.905958944630
             les_mean =     286.188015378710
             stat err =       0.000481474873
             autocorr =       1.231215714858
              std dev =       0.613651146402
             le_variance =       0.376567729480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595894463e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905958944630       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905958944630       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905958944631       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905958944631       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905958944631       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905958944829       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905958945105       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905958944614       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.495906e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905958944630       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905958944630       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905958944630       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905958944630       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905958945387       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905958944750       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905958946718       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905958946151       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.739765e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905958944630       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905958944630       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905958944630       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905958947770       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905958944630       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905958958096       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905958943933       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905958955312       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 9.349406e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3364e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.992
    reference variance = 0.509015
====================================================
  Execution time = 3.3130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3822e-01
  Total weights = 2.0000e+06
  Execution time = 3.1540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207938225
                                         uncertainty =       0.003226256572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207938225
                                         uncertainty =       0.003226256572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411228006
  error estimate for blocks of size 2^( 2) =       0.000424357194
  error estimate for blocks of size 2^( 3) =       0.000437480166
  error estimate for blocks of size 2^( 4) =       0.000449320133
  error estimate for blocks of size 2^( 5) =       0.000459965429
  error estimate for blocks of size 2^( 6) =       0.000468575317
  error estimate for blocks of size 2^( 7) =       0.000473839995

      target function =                  N/A
              le_mean =     -16.905561722307
             les_mean =     286.136233923215
             stat err =       0.000462925219
             autocorr =       1.267232530615
              std dev =       0.581564223104
             le_variance =       0.338216945595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207938173
                                         uncertainty =       0.003226256572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207938173
                                         uncertainty =       0.003226256572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411228006
  error estimate for blocks of size 2^( 2) =       0.000424357194
  error estimate for blocks of size 2^( 3) =       0.000437480166
  error estimate for blocks of size 2^( 4) =       0.000449320133
  error estimate for blocks of size 2^( 5) =       0.000459965429
  error estimate for blocks of size 2^( 6) =       0.000468575317
  error estimate for blocks of size 2^( 7) =       0.000473839995

      target function =                  N/A
              le_mean =     -16.905561722306
             les_mean =     286.136233923139
             stat err =       0.000462925218
             autocorr =       1.267232530648
              std dev =       0.581564223059
             le_variance =       0.338216945543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207938199
                                         uncertainty =       0.003226256572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207938199
                                         uncertainty =       0.003226256572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411228006
  error estimate for blocks of size 2^( 2) =       0.000424357194
  error estimate for blocks of size 2^( 3) =       0.000437480166
  error estimate for blocks of size 2^( 4) =       0.000449320133
  error estimate for blocks of size 2^( 5) =       0.000459965429
  error estimate for blocks of size 2^( 6) =       0.000468575317
  error estimate for blocks of size 2^( 7) =       0.000473839995

      target function =                  N/A
              le_mean =     -16.905561722307
             les_mean =     286.136233923177
             stat err =       0.000462925218
             autocorr =       1.267232530628
              std dev =       0.581564223082
             le_variance =       0.338216945569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207938222
                                         uncertainty =       0.003226256572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207938222
                                         uncertainty =       0.003226256572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411228006
  error estimate for blocks of size 2^( 2) =       0.000424357194
  error estimate for blocks of size 2^( 3) =       0.000437480166
  error estimate for blocks of size 2^( 4) =       0.000449320133
  error estimate for blocks of size 2^( 5) =       0.000459965429
  error estimate for blocks of size 2^( 6) =       0.000468575317
  error estimate for blocks of size 2^( 7) =       0.000473839995

      target function =                  N/A
              le_mean =     -16.905561722307
             les_mean =     286.136233923210
             stat err =       0.000462925219
             autocorr =       1.267232530611
              std dev =       0.581564223102
             le_variance =       0.338216945592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905561722307        initial  <--
     1.5259e+06     1.5259e+07             1.4959e-10       -16.905561722306
     6.1035e+06     6.1035e+07             3.7398e-11       -16.905561722307
     2.4414e+07     2.4414e+08             9.3494e-12       -16.905561722307

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.9915
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8472
    reference variance = 0.247465
====================================================
  Execution time = 3.3493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336881915266
                                         uncertainty =       0.003398056576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336881915266
                                         uncertainty =       0.003398056576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410447511
  error estimate for blocks of size 2^( 2) =       0.000423236873
  error estimate for blocks of size 2^( 3) =       0.000436468211
  error estimate for blocks of size 2^( 4) =       0.000449937292
  error estimate for blocks of size 2^( 5) =       0.000460822121
  error estimate for blocks of size 2^( 6) =       0.000471654143
  error estimate for blocks of size 2^( 7) =       0.000476547408

      target function =                  N/A
              le_mean =     -16.905324365981
             les_mean =     286.126926068691
             stat err =       0.000464740241
             autocorr =       1.282051011648
              std dev =       0.580460436320
             le_variance =       0.336934318133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690532436598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905324365981       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905324365981       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905324365981       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905324359300       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905324356362       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905324365981       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905324365918       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905324357784       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.592277e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905324365981       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905324365981       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905324365981       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905324362420       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905324366465       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905324372213       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905324335808       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905324416539       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.980790e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905324365981       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905324365981       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905324365981       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905324284358       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905324365981       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905324371321       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905324371129       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905324339163       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 9.952079e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2626e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9264
    reference variance = 0.432472
====================================================
  Execution time = 3.3440e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4311e-01
  Total weights = 2.0000e+06
  Execution time = 3.1566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343088069703
                                         uncertainty =       0.007412350161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343088069703
                                         uncertainty =       0.007412350161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414193900
  error estimate for blocks of size 2^( 2) =       0.000427129921
  error estimate for blocks of size 2^( 3) =       0.000440177982
  error estimate for blocks of size 2^( 4) =       0.000452613657
  error estimate for blocks of size 2^( 5) =       0.000463764454
  error estimate for blocks of size 2^( 6) =       0.000471206984
  error estimate for blocks of size 2^( 7) =       0.000474947172

      target function =                  N/A
              le_mean =     -16.905739705195
             les_mean =     286.147147982518
             stat err =       0.000465633067
             autocorr =       1.263805468732
              std dev =       0.585758631399
             le_variance =       0.343113174258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343088069693
                                         uncertainty =       0.007412350161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343088069693
                                         uncertainty =       0.007412350161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414193900
  error estimate for blocks of size 2^( 2) =       0.000427129921
  error estimate for blocks of size 2^( 3) =       0.000440177982
  error estimate for blocks of size 2^( 4) =       0.000452613657
  error estimate for blocks of size 2^( 5) =       0.000463764454
  error estimate for blocks of size 2^( 6) =       0.000471206984
  error estimate for blocks of size 2^( 7) =       0.000474947172

      target function =                  N/A
              le_mean =     -16.905739705195
             les_mean =     286.147147982510
             stat err =       0.000465633067
             autocorr =       1.263805468742
              std dev =       0.585758631391
             le_variance =       0.343113174249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343088069698
                                         uncertainty =       0.007412350161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343088069698
                                         uncertainty =       0.007412350161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414193900
  error estimate for blocks of size 2^( 2) =       0.000427129921
  error estimate for blocks of size 2^( 3) =       0.000440177982
  error estimate for blocks of size 2^( 4) =       0.000452613657
  error estimate for blocks of size 2^( 5) =       0.000463764454
  error estimate for blocks of size 2^( 6) =       0.000471206984
  error estimate for blocks of size 2^( 7) =       0.000474947172

      target function =                  N/A
              le_mean =     -16.905739705195
             les_mean =     286.147147982514
             stat err =       0.000465633067
             autocorr =       1.263805468739
              std dev =       0.585758631395
             le_variance =       0.343113174254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343088069702
                                         uncertainty =       0.007412350161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343088069702
                                         uncertainty =       0.007412350161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414193900
  error estimate for blocks of size 2^( 2) =       0.000427129921
  error estimate for blocks of size 2^( 3) =       0.000440177982
  error estimate for blocks of size 2^( 4) =       0.000452613657
  error estimate for blocks of size 2^( 5) =       0.000463764454
  error estimate for blocks of size 2^( 6) =       0.000471206984
  error estimate for blocks of size 2^( 7) =       0.000474947172

      target function =                  N/A
              le_mean =     -16.905739705195
             les_mean =     286.147147982518
             stat err =       0.000465633067
             autocorr =       1.263805468736
              std dev =       0.585758631399
             le_variance =       0.343113174258


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905739705195        initial
     1.5259e+07     1.5259e+08             1.5923e-11       -16.905739705195  <--
     6.1035e+07     6.1035e+08             3.9808e-12       -16.905739705195
     2.4414e+08     2.4414e+09             9.9521e-13       -16.905739705195

*****************************************************************************
Applying the update for shift_i =   1.5259e+07     and shift_s =   1.5259e+08
*****************************************************************************

  Execution time = 4.9263e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580116e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8705
    reference variance = 0.197013
====================================================
  Execution time = 3.3908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3869e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338674080203
                                         uncertainty =       0.002945099192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338674080203
                                         uncertainty =       0.002945099192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411517144
  error estimate for blocks of size 2^( 2) =       0.000424517185
  error estimate for blocks of size 2^( 3) =       0.000437686746
  error estimate for blocks of size 2^( 4) =       0.000450596041
  error estimate for blocks of size 2^( 5) =       0.000460862387
  error estimate for blocks of size 2^( 6) =       0.000469088549
  error estimate for blocks of size 2^( 7) =       0.000473734783

      target function =                  N/A
              le_mean =     -16.905743843984
             les_mean =     286.142867467947
             stat err =       0.000463570440
             autocorr =       1.268982418555
              std dev =       0.581973125563
             le_variance =       0.338692718878


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574384398e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905743843984       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905743843984       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905743843984       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905743842908       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905743843439       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905743844510       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905743845683       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905743844366       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 5.557350e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905743843984       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905743843984       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905743843984       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905743848609       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905743845740       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905743850520       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905743845354       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905743852510       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.389350e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905743843984       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905743843984       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905743843984       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905743832864       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905743880492       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905743844635       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905743842840       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905743838749       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.473375e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3245e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9248
    reference variance = 0.191194
====================================================
  Execution time = 3.5024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3731e-01
  Total weights = 2.0000e+06
  Execution time = 3.1512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337340780252
                                         uncertainty =       0.003085104213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337340780252
                                         uncertainty =       0.003085104213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410675095
  error estimate for blocks of size 2^( 2) =       0.000423543041
  error estimate for blocks of size 2^( 3) =       0.000437141815
  error estimate for blocks of size 2^( 4) =       0.000449312150
  error estimate for blocks of size 2^( 5) =       0.000460285888
  error estimate for blocks of size 2^( 6) =       0.000470512305
  error estimate for blocks of size 2^( 7) =       0.000478851083

      target function =                  N/A
              le_mean =     -16.905765778305
             les_mean =     286.142224449984
             stat err =       0.000464740357
             autocorr =       1.280631089054
              std dev =       0.580782289429
             le_variance =       0.337308067714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337340780246
                                         uncertainty =       0.003085104213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337340780246
                                         uncertainty =       0.003085104213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410675095
  error estimate for blocks of size 2^( 2) =       0.000423543041
  error estimate for blocks of size 2^( 3) =       0.000437141815
  error estimate for blocks of size 2^( 4) =       0.000449312150
  error estimate for blocks of size 2^( 5) =       0.000460285888
  error estimate for blocks of size 2^( 6) =       0.000470512305
  error estimate for blocks of size 2^( 7) =       0.000478851083

      target function =                  N/A
              le_mean =     -16.905765778306
             les_mean =     286.142224449987
             stat err =       0.000464740357
             autocorr =       1.280631089067
              std dev =       0.580782289424
             le_variance =       0.337308067709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337340780249
                                         uncertainty =       0.003085104213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337340780249
                                         uncertainty =       0.003085104213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410675095
  error estimate for blocks of size 2^( 2) =       0.000423543041
  error estimate for blocks of size 2^( 3) =       0.000437141815
  error estimate for blocks of size 2^( 4) =       0.000449312150
  error estimate for blocks of size 2^( 5) =       0.000460285888
  error estimate for blocks of size 2^( 6) =       0.000470512305
  error estimate for blocks of size 2^( 7) =       0.000478851083

      target function =                  N/A
              le_mean =     -16.905765778306
             les_mean =     286.142224449985
             stat err =       0.000464740357
             autocorr =       1.280631089061
              std dev =       0.580782289426
             le_variance =       0.337308067711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337340780252
                                         uncertainty =       0.003085104213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337340780252
                                         uncertainty =       0.003085104213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410675095
  error estimate for blocks of size 2^( 2) =       0.000423543041
  error estimate for blocks of size 2^( 3) =       0.000437141815
  error estimate for blocks of size 2^( 4) =       0.000449312150
  error estimate for blocks of size 2^( 5) =       0.000460285888
  error estimate for blocks of size 2^( 6) =       0.000470512305
  error estimate for blocks of size 2^( 7) =       0.000478851083

      target function =                  N/A
              le_mean =     -16.905765778305
             les_mean =     286.142224449984
             stat err =       0.000464740357
             autocorr =       1.280631089064
              std dev =       0.580782289428
             le_variance =       0.337308067714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905765778305        initial
     3.8147e+06     3.8147e+07             5.5574e-11       -16.905765778306  <--
     1.5259e+07     1.5259e+08             1.3893e-11       -16.905765778306
     6.1035e+07     6.1035e+08             3.4734e-12       -16.905765778305

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 5.0879e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4179e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9852
    reference variance = 0.379399
====================================================
  Execution time = 3.6268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3337e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333237030229
                                         uncertainty =       0.002195422370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333237030229
                                         uncertainty =       0.002195422370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408269913
  error estimate for blocks of size 2^( 2) =       0.000421033328
  error estimate for blocks of size 2^( 3) =       0.000434816991
  error estimate for blocks of size 2^( 4) =       0.000446941546
  error estimate for blocks of size 2^( 5) =       0.000457171868
  error estimate for blocks of size 2^( 6) =       0.000464221424
  error estimate for blocks of size 2^( 7) =       0.000469333750

      target function =                  N/A
              le_mean =     -16.906136207106
             les_mean =     286.150809930563
             stat err =       0.000459417147
             autocorr =       1.266250553406
              std dev =       0.577380848334
             le_variance =       0.333368644023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613620711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136207106       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136207106       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906136207106       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906136207053       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906136207106       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136207131       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906136206860       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906136206815       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.598146e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136207106       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136207106       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906136207106       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906136207106       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906136206354       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136209684       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906136205855       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906136203973       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.495363e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136207106       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136207106       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906136207106       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906136206341       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906136209479       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136201504       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906136204589       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906136187189       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.623841e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5438e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9106
    reference variance = 0.275278
====================================================
  Execution time = 3.3119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4458e-01
  Total weights = 2.0000e+06
  Execution time = 3.1460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344537632004
                                         uncertainty =       0.006654593763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344537632004
                                         uncertainty =       0.006654593763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415076445
  error estimate for blocks of size 2^( 2) =       0.000428210920
  error estimate for blocks of size 2^( 3) =       0.000441220829
  error estimate for blocks of size 2^( 4) =       0.000454827341
  error estimate for blocks of size 2^( 5) =       0.000467509988
  error estimate for blocks of size 2^( 6) =       0.000477659660
  error estimate for blocks of size 2^( 7) =       0.000485947472

      target function =                  N/A
              le_mean =     -16.905349511249
             les_mean =     286.135418836177
             stat err =       0.000471486115
             autocorr =       1.290273084136
              std dev =       0.587006738443
             le_variance =       0.344576910977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344537631716
                                         uncertainty =       0.006654593757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344537631716
                                         uncertainty =       0.006654593757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415076445
  error estimate for blocks of size 2^( 2) =       0.000428210920
  error estimate for blocks of size 2^( 3) =       0.000441220829
  error estimate for blocks of size 2^( 4) =       0.000454827340
  error estimate for blocks of size 2^( 5) =       0.000467509988
  error estimate for blocks of size 2^( 6) =       0.000477659660
  error estimate for blocks of size 2^( 7) =       0.000485947472

      target function =                  N/A
              le_mean =     -16.905349511249
             les_mean =     286.135418835876
             stat err =       0.000471486115
             autocorr =       1.290273084413
              std dev =       0.587006738197
             le_variance =       0.344576910689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344537631860
                                         uncertainty =       0.006654593760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344537631860
                                         uncertainty =       0.006654593760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415076445
  error estimate for blocks of size 2^( 2) =       0.000428210920
  error estimate for blocks of size 2^( 3) =       0.000441220829
  error estimate for blocks of size 2^( 4) =       0.000454827340
  error estimate for blocks of size 2^( 5) =       0.000467509988
  error estimate for blocks of size 2^( 6) =       0.000477659660
  error estimate for blocks of size 2^( 7) =       0.000485947472

      target function =                  N/A
              le_mean =     -16.905349511249
             les_mean =     286.135418836026
             stat err =       0.000471486115
             autocorr =       1.290273084277
              std dev =       0.587006738320
             le_variance =       0.344576910833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344537631986
                                         uncertainty =       0.006654593763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344537631986
                                         uncertainty =       0.006654593763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415076445
  error estimate for blocks of size 2^( 2) =       0.000428210920
  error estimate for blocks of size 2^( 3) =       0.000441220829
  error estimate for blocks of size 2^( 4) =       0.000454827340
  error estimate for blocks of size 2^( 5) =       0.000467509988
  error estimate for blocks of size 2^( 6) =       0.000477659660
  error estimate for blocks of size 2^( 7) =       0.000485947472

      target function =                  N/A
              le_mean =     -16.905349511249
             les_mean =     286.135418836158
             stat err =       0.000471486115
             autocorr =       1.290273084155
              std dev =       0.587006738427
             le_variance =       0.344576910959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905349511249        initial  <--
     9.5367e+05     9.5367e+06             2.5981e-10       -16.905349511249
     3.8147e+06     3.8147e+07             6.4954e-11       -16.905349511249
     1.5259e+07     1.5259e+08             1.6238e-11       -16.905349511249

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.9338
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4434e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8729
    reference variance = 0.247378
====================================================
  Execution time = 3.4644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3726e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337056838401
                                         uncertainty =       0.004025445502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337056838401
                                         uncertainty =       0.004025445502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410646916
  error estimate for blocks of size 2^( 2) =       0.000423570595
  error estimate for blocks of size 2^( 3) =       0.000437462040
  error estimate for blocks of size 2^( 4) =       0.000451852403
  error estimate for blocks of size 2^( 5) =       0.000464319608
  error estimate for blocks of size 2^( 6) =       0.000476634211
  error estimate for blocks of size 2^( 7) =       0.000482626021

      target function =                  N/A
              le_mean =     -16.905108584317
             les_mean =     286.119957858456
             stat err =       0.000468858061
             autocorr =       1.303603874515
              std dev =       0.580742438224
             le_variance =       0.337261779555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690510858432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905108584317       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905108584317       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905108584317       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905108584317       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905108584102       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905108582832       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905108584834       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905108584317       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.603395e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905108584317       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905108584317       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905108584317       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905108575037       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905108578217       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905108564668       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905108552173       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905108586273       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 6.508161e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905108584317       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905108584317       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905108584317       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905108599086       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905108583789       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905108661616       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905108611148       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905108605305       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 1.627321e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3975e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8895
    reference variance = 0.218987
====================================================
  Execution time = 3.3225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3184e-01
  Total weights = 2.0000e+06
  Execution time = 3.1504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331795692407
                                         uncertainty =       0.002632712540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331795692407
                                         uncertainty =       0.002632712540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407330989
  error estimate for blocks of size 2^( 2) =       0.000420122582
  error estimate for blocks of size 2^( 3) =       0.000433366309
  error estimate for blocks of size 2^( 4) =       0.000445299098
  error estimate for blocks of size 2^( 5) =       0.000455469978
  error estimate for blocks of size 2^( 6) =       0.000461861124
  error estimate for blocks of size 2^( 7) =       0.000465187911

      target function =                  N/A
              le_mean =     -16.905215281746
             les_mean =     286.118140625468
             stat err =       0.000456954528
             autocorr =       1.258493759949
              std dev =       0.576053009025
             le_variance =       0.331837069206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331795692389
                                         uncertainty =       0.002632712540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331795692389
                                         uncertainty =       0.002632712540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407330989
  error estimate for blocks of size 2^( 2) =       0.000420122582
  error estimate for blocks of size 2^( 3) =       0.000433366309
  error estimate for blocks of size 2^( 4) =       0.000445299098
  error estimate for blocks of size 2^( 5) =       0.000455469978
  error estimate for blocks of size 2^( 6) =       0.000461861124
  error estimate for blocks of size 2^( 7) =       0.000465187911

      target function =                  N/A
              le_mean =     -16.905215281746
             les_mean =     286.118140625451
             stat err =       0.000456954528
             autocorr =       1.258493759974
              std dev =       0.576053009009
             le_variance =       0.331837069188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331795692398
                                         uncertainty =       0.002632712540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331795692398
                                         uncertainty =       0.002632712540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407330989
  error estimate for blocks of size 2^( 2) =       0.000420122582
  error estimate for blocks of size 2^( 3) =       0.000433366309
  error estimate for blocks of size 2^( 4) =       0.000445299098
  error estimate for blocks of size 2^( 5) =       0.000455469978
  error estimate for blocks of size 2^( 6) =       0.000461861124
  error estimate for blocks of size 2^( 7) =       0.000465187911

      target function =                  N/A
              le_mean =     -16.905215281746
             les_mean =     286.118140625459
             stat err =       0.000456954528
             autocorr =       1.258493759961
              std dev =       0.576053009017
             le_variance =       0.331837069197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331795692406
                                         uncertainty =       0.002632712540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331795692406
                                         uncertainty =       0.002632712540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407330989
  error estimate for blocks of size 2^( 2) =       0.000420122582
  error estimate for blocks of size 2^( 3) =       0.000433366309
  error estimate for blocks of size 2^( 4) =       0.000445299098
  error estimate for blocks of size 2^( 5) =       0.000455469978
  error estimate for blocks of size 2^( 6) =       0.000461861124
  error estimate for blocks of size 2^( 7) =       0.000465187911

      target function =                  N/A
              le_mean =     -16.905215281746
             les_mean =     286.118140625467
             stat err =       0.000456954528
             autocorr =       1.258493759950
              std dev =       0.576053009024
             le_variance =       0.331837069205


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905215281746        initial
     9.5367e+06     9.5367e+07             2.6034e-11       -16.905215281746  <--
     3.8147e+07     3.8147e+08             6.5082e-12       -16.905215281746
     1.5259e+08     1.5259e+09             1.6273e-12       -16.905215281746

*****************************************************************************
Applying the update for shift_i =   9.5367e+06     and shift_s =   9.5367e+07
*****************************************************************************

  Execution time = 4.9069e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.013
    reference variance = 0.61659
====================================================
  Execution time = 3.4657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5670e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356721769861
                                         uncertainty =       0.016592795187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356721769861
                                         uncertainty =       0.016592795187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422314919
  error estimate for blocks of size 2^( 2) =       0.000434878643
  error estimate for blocks of size 2^( 3) =       0.000448306969
  error estimate for blocks of size 2^( 4) =       0.000461051796
  error estimate for blocks of size 2^( 5) =       0.000471648426
  error estimate for blocks of size 2^( 6) =       0.000479498970
  error estimate for blocks of size 2^( 7) =       0.000487180294

      target function =                  N/A
              le_mean =     -16.905340067636
             les_mean =     286.147222406375
             stat err =       0.000474844872
             autocorr =       1.264243283938
              std dev =       0.597243486611
             le_variance =       0.356699782300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534006764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905340067636       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905340067636       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905340067636       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905340067728       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905340068357       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905340068146       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905340067796       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905340067704       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.080484e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905340067636       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905340067636       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905340067636       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905340069640       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905340075646       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905340068895       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905340057257       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905340055017       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.701189e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905340067636       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905340067636       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905340067636       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905340057923       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905340061468       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905340047050       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905340064096       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905340081210       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 6.752972e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3952e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9095
    reference variance = 0.274476
====================================================
  Execution time = 3.3257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4619e-01
  Total weights = 2.0000e+06
  Execution time = 3.1664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345962511650
                                         uncertainty =       0.010620291379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345962511650
                                         uncertainty =       0.010620291379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416048599
  error estimate for blocks of size 2^( 2) =       0.000429029031
  error estimate for blocks of size 2^( 3) =       0.000442370788
  error estimate for blocks of size 2^( 4) =       0.000455029114
  error estimate for blocks of size 2^( 5) =       0.000466335863
  error estimate for blocks of size 2^( 6) =       0.000473853565
  error estimate for blocks of size 2^( 7) =       0.000478309518

      target function =                  N/A
              le_mean =     -16.905173826445
             les_mean =     286.131094801940
             stat err =       0.000468382015
             autocorr =       1.267395890460
              std dev =       0.588381570692
             le_variance =       0.346192872730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345962511627
                                         uncertainty =       0.010620291381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345962511627
                                         uncertainty =       0.010620291381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416048599
  error estimate for blocks of size 2^( 2) =       0.000429029031
  error estimate for blocks of size 2^( 3) =       0.000442370788
  error estimate for blocks of size 2^( 4) =       0.000455029114
  error estimate for blocks of size 2^( 5) =       0.000466335863
  error estimate for blocks of size 2^( 6) =       0.000473853565
  error estimate for blocks of size 2^( 7) =       0.000478309518

      target function =                  N/A
              le_mean =     -16.905173826444
             les_mean =     286.131094801914
             stat err =       0.000468382015
             autocorr =       1.267395890470
              std dev =       0.588381570672
             le_variance =       0.346192872706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345962511639
                                         uncertainty =       0.010620291380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345962511639
                                         uncertainty =       0.010620291380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416048599
  error estimate for blocks of size 2^( 2) =       0.000429029031
  error estimate for blocks of size 2^( 3) =       0.000442370788
  error estimate for blocks of size 2^( 4) =       0.000455029114
  error estimate for blocks of size 2^( 5) =       0.000466335863
  error estimate for blocks of size 2^( 6) =       0.000473853565
  error estimate for blocks of size 2^( 7) =       0.000478309518

      target function =                  N/A
              le_mean =     -16.905173826445
             les_mean =     286.131094801927
             stat err =       0.000468382015
             autocorr =       1.267395890469
              std dev =       0.588381570682
             le_variance =       0.346192872718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345962511649
                                         uncertainty =       0.010620291380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345962511649
                                         uncertainty =       0.010620291380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416048599
  error estimate for blocks of size 2^( 2) =       0.000429029031
  error estimate for blocks of size 2^( 3) =       0.000442370788
  error estimate for blocks of size 2^( 4) =       0.000455029114
  error estimate for blocks of size 2^( 5) =       0.000466335863
  error estimate for blocks of size 2^( 6) =       0.000473853565
  error estimate for blocks of size 2^( 7) =       0.000478309518

      target function =                  N/A
              le_mean =     -16.905173826445
             les_mean =     286.131094801939
             stat err =       0.000468382015
             autocorr =       1.267395890456
              std dev =       0.588381570690
             le_variance =       0.346192872728


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905173826445        initial  <--
     2.3842e+06     2.3842e+07             1.0805e-10       -16.905173826444
     9.5367e+06     9.5367e+07             2.7012e-11       -16.905173826445
     3.8147e+07     3.8147e+08             6.7530e-12       -16.905173826445

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.8229
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4838e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9355
    reference variance = 0.275811
====================================================
  Execution time = 3.6602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5116e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351126307443
                                         uncertainty =       0.009276009276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351126307443
                                         uncertainty =       0.009276009276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419022512
  error estimate for blocks of size 2^( 2) =       0.000431248462
  error estimate for blocks of size 2^( 3) =       0.000444411291
  error estimate for blocks of size 2^( 4) =       0.000456623015
  error estimate for blocks of size 2^( 5) =       0.000466591014
  error estimate for blocks of size 2^( 6) =       0.000476049790
  error estimate for blocks of size 2^( 7) =       0.000481300972

      target function =                  N/A
              le_mean =     -16.905759178801
             les_mean =     286.155852967385
             stat err =       0.000470141197
             autocorr =       1.258872961840
              std dev =       0.592587319614
             le_variance =       0.351159731367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575917880e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905759178801       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759178800       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759178800       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905759178800       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905759178948       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905759212948       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905759186509       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905759181678       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 8.446027e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905759178801       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759178800       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759178800       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905759178800       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905759171106       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905759169272       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905759179016       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905759199314       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.111265e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905759178801       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759178801       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759178800       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905759178800       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905759413212       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905759185598       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905759240411       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905759667857       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 5.277008e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5810e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9121
    reference variance = 0.206826
====================================================
  Execution time = 3.3274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3931e-01
  Total weights = 2.0000e+06
  Execution time = 3.1546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339350069241
                                         uncertainty =       0.005627937045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339350069241
                                         uncertainty =       0.005627937045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411894656
  error estimate for blocks of size 2^( 2) =       0.000424614724
  error estimate for blocks of size 2^( 3) =       0.000437368142
  error estimate for blocks of size 2^( 4) =       0.000448938192
  error estimate for blocks of size 2^( 5) =       0.000460270896
  error estimate for blocks of size 2^( 6) =       0.000468725167
  error estimate for blocks of size 2^( 7) =       0.000472592586

      target function =                  N/A
              le_mean =     -16.905090443727
             les_mean =     286.121397156991
             stat err =       0.000462631710
             autocorr =       1.261532604660
              std dev =       0.582507009436
             le_variance =       0.339314416042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339350069229
                                         uncertainty =       0.005627937045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339350069229
                                         uncertainty =       0.005627937045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411894656
  error estimate for blocks of size 2^( 2) =       0.000424614724
  error estimate for blocks of size 2^( 3) =       0.000437368141
  error estimate for blocks of size 2^( 4) =       0.000448938192
  error estimate for blocks of size 2^( 5) =       0.000460270896
  error estimate for blocks of size 2^( 6) =       0.000468725167
  error estimate for blocks of size 2^( 7) =       0.000472592586

      target function =                  N/A
              le_mean =     -16.905090443728
             les_mean =     286.121397156980
             stat err =       0.000462631710
             autocorr =       1.261532604670
              std dev =       0.582507009426
             le_variance =       0.339314416031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339350069235
                                         uncertainty =       0.005627937045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339350069235
                                         uncertainty =       0.005627937045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411894656
  error estimate for blocks of size 2^( 2) =       0.000424614724
  error estimate for blocks of size 2^( 3) =       0.000437368142
  error estimate for blocks of size 2^( 4) =       0.000448938192
  error estimate for blocks of size 2^( 5) =       0.000460270896
  error estimate for blocks of size 2^( 6) =       0.000468725167
  error estimate for blocks of size 2^( 7) =       0.000472592586

      target function =                  N/A
              le_mean =     -16.905090443727
             les_mean =     286.121397156986
             stat err =       0.000462631710
             autocorr =       1.261532604665
              std dev =       0.582507009431
             le_variance =       0.339314416036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339350069240
                                         uncertainty =       0.005627937045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339350069240
                                         uncertainty =       0.005627937045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411894656
  error estimate for blocks of size 2^( 2) =       0.000424614724
  error estimate for blocks of size 2^( 3) =       0.000437368142
  error estimate for blocks of size 2^( 4) =       0.000448938192
  error estimate for blocks of size 2^( 5) =       0.000460270896
  error estimate for blocks of size 2^( 6) =       0.000468725167
  error estimate for blocks of size 2^( 7) =       0.000472592586

      target function =                  N/A
              le_mean =     -16.905090443727
             les_mean =     286.121397156990
             stat err =       0.000462631710
             autocorr =       1.261532604666
              std dev =       0.582507009435
             le_variance =       0.339314416041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905090443727        initial
     2.3842e+07     2.3842e+08             8.4460e-12       -16.905090443728  <--
     9.5367e+07     9.5367e+08             2.1113e-12       -16.905090443727
     3.8147e+08     3.8147e+09             5.2770e-13       -16.905090443727

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 4.9149e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8943
    reference variance = 0.231684
====================================================
  Execution time = 3.4231e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3292e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332932285603
                                         uncertainty =       0.002424216598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332932285603
                                         uncertainty =       0.002424216598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407997244
  error estimate for blocks of size 2^( 2) =       0.000421044082
  error estimate for blocks of size 2^( 3) =       0.000434435123
  error estimate for blocks of size 2^( 4) =       0.000446758381
  error estimate for blocks of size 2^( 5) =       0.000459276282
  error estimate for blocks of size 2^( 6) =       0.000466512381
  error estimate for blocks of size 2^( 7) =       0.000471314952

      target function =                  N/A
              le_mean =     -16.905724372402
             les_mean =     286.136439891431
             stat err =       0.000460965499
             autocorr =       1.276504601817
              std dev =       0.576995235923
             le_variance =       0.332923502277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572437240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905724372402       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905724372402       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905724372402       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905724372402       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905724373954       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905724371332       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905724372014       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905724373197       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 4.070104e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905724372402       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905724372402       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905724372402       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905724372402       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905724372402       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905724372796       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905724372550       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905724367759       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.017520e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905724372402       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905724372402       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905724372402       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905724372473       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905724353616       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905724315383       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905724421655       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905724454042       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.543884e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3644e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.0145
    reference variance = 0.904868
====================================================
  Execution time = 3.3286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3638e-01
  Total weights = 2.0000e+06
  Execution time = 3.1373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339487029
                                         uncertainty =       0.003621911424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339487029
                                         uncertainty =       0.003621911424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410109229
  error estimate for blocks of size 2^( 2) =       0.000423122883
  error estimate for blocks of size 2^( 3) =       0.000436708296
  error estimate for blocks of size 2^( 4) =       0.000450324689
  error estimate for blocks of size 2^( 5) =       0.000461767602
  error estimate for blocks of size 2^( 6) =       0.000471172531
  error estimate for blocks of size 2^( 7) =       0.000477746809

      target function =                  N/A
              le_mean =     -16.905447486267
             les_mean =     286.130533701786
             stat err =       0.000465252908
             autocorr =       1.287001660334
              std dev =       0.579982033391
             le_variance =       0.336379159056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339487003
                                         uncertainty =       0.003621911424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339487003
                                         uncertainty =       0.003621911424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410109229
  error estimate for blocks of size 2^( 2) =       0.000423122883
  error estimate for blocks of size 2^( 3) =       0.000436708296
  error estimate for blocks of size 2^( 4) =       0.000450324689
  error estimate for blocks of size 2^( 5) =       0.000461767602
  error estimate for blocks of size 2^( 6) =       0.000471172531
  error estimate for blocks of size 2^( 7) =       0.000477746809

      target function =                  N/A
              le_mean =     -16.905447486267
             les_mean =     286.130533701758
             stat err =       0.000465252908
             autocorr =       1.287001660354
              std dev =       0.579982033369
             le_variance =       0.336379159031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339487016
                                         uncertainty =       0.003621911424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339487016
                                         uncertainty =       0.003621911424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410109229
  error estimate for blocks of size 2^( 2) =       0.000423122883
  error estimate for blocks of size 2^( 3) =       0.000436708296
  error estimate for blocks of size 2^( 4) =       0.000450324689
  error estimate for blocks of size 2^( 5) =       0.000461767602
  error estimate for blocks of size 2^( 6) =       0.000471172531
  error estimate for blocks of size 2^( 7) =       0.000477746809

      target function =                  N/A
              le_mean =     -16.905447486267
             les_mean =     286.130533701772
             stat err =       0.000465252908
             autocorr =       1.287001660355
              std dev =       0.579982033380
             le_variance =       0.336379159044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339487027
                                         uncertainty =       0.003621911424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339487027
                                         uncertainty =       0.003621911424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410109229
  error estimate for blocks of size 2^( 2) =       0.000423122883
  error estimate for blocks of size 2^( 3) =       0.000436708296
  error estimate for blocks of size 2^( 4) =       0.000450324689
  error estimate for blocks of size 2^( 5) =       0.000461767602
  error estimate for blocks of size 2^( 6) =       0.000471172531
  error estimate for blocks of size 2^( 7) =       0.000477746809

      target function =                  N/A
              le_mean =     -16.905447486267
             les_mean =     286.130533701784
             stat err =       0.000465252908
             autocorr =       1.287001660347
              std dev =       0.579982033390
             le_variance =       0.336379159055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905447486267        initial  <--
     5.9605e+06     5.9605e+07             4.0701e-11       -16.905447486267
     2.3842e+07     2.3842e+08             1.0175e-11       -16.905447486267
     9.5367e+07     9.5367e+08             2.5439e-12       -16.905447486267

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.0454
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8764
    reference variance = 0.305872
====================================================
  Execution time = 3.4148e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4334e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343420896684
                                         uncertainty =       0.004488009699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343420896684
                                         uncertainty =       0.004488009699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414330024
  error estimate for blocks of size 2^( 2) =       0.000426714614
  error estimate for blocks of size 2^( 3) =       0.000438947341
  error estimate for blocks of size 2^( 4) =       0.000450257695
  error estimate for blocks of size 2^( 5) =       0.000460668053
  error estimate for blocks of size 2^( 6) =       0.000466234487
  error estimate for blocks of size 2^( 7) =       0.000471224111

      target function =                  N/A
              le_mean =     -16.906135309645
             les_mean =     286.160749674120
             stat err =       0.000462096086
             autocorr =       1.243860768203
              std dev =       0.585951139394
             le_variance =       0.343338737757


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613530965e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906135309645       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906135309645       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906135309645       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906135309591       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906135279430       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906135326037       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906135306115       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906135323447       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 3.662578e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906135309645       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906135309645       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906135309645       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906135309645       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906135473743       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906135333631       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906135312469       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906135391548       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 9.157278e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906135309645       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906135309645       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906135309645       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906135309645       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906135007827       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906135309577       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906135778014       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906134608500       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.289413e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3290e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8963
    reference variance = 0.345711
====================================================
  Execution time = 3.3320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3458e-01
  Total weights = 2.0000e+06
  Execution time = 3.1394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334618553325
                                         uncertainty =       0.002497489344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334618553325
                                         uncertainty =       0.002497489344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409013456
  error estimate for blocks of size 2^( 2) =       0.000422098817
  error estimate for blocks of size 2^( 3) =       0.000435102320
  error estimate for blocks of size 2^( 4) =       0.000447537059
  error estimate for blocks of size 2^( 5) =       0.000458832330
  error estimate for blocks of size 2^( 6) =       0.000466042430
  error estimate for blocks of size 2^( 7) =       0.000470789359

      target function =                  N/A
              le_mean =     -16.906009374261
             les_mean =     286.147736810025
             stat err =       0.000460800295
             autocorr =       1.269259152123
              std dev =       0.578432376960
             le_variance =       0.334584014715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334618553323
                                         uncertainty =       0.002497489344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334618553323
                                         uncertainty =       0.002497489344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409013456
  error estimate for blocks of size 2^( 2) =       0.000422098817
  error estimate for blocks of size 2^( 3) =       0.000435102320
  error estimate for blocks of size 2^( 4) =       0.000447537059
  error estimate for blocks of size 2^( 5) =       0.000458832330
  error estimate for blocks of size 2^( 6) =       0.000466042430
  error estimate for blocks of size 2^( 7) =       0.000470789359

      target function =                  N/A
              le_mean =     -16.906009374261
             les_mean =     286.147736810022
             stat err =       0.000460800295
             autocorr =       1.269259152126
              std dev =       0.578432376958
             le_variance =       0.334584014713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334618553324
                                         uncertainty =       0.002497489344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334618553324
                                         uncertainty =       0.002497489344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409013456
  error estimate for blocks of size 2^( 2) =       0.000422098817
  error estimate for blocks of size 2^( 3) =       0.000435102320
  error estimate for blocks of size 2^( 4) =       0.000447537059
  error estimate for blocks of size 2^( 5) =       0.000458832330
  error estimate for blocks of size 2^( 6) =       0.000466042430
  error estimate for blocks of size 2^( 7) =       0.000470789359

      target function =                  N/A
              le_mean =     -16.906009374261
             les_mean =     286.147736810023
             stat err =       0.000460800295
             autocorr =       1.269259152131
              std dev =       0.578432376959
             le_variance =       0.334584014714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334618553325
                                         uncertainty =       0.002497489344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334618553325
                                         uncertainty =       0.002497489344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409013456
  error estimate for blocks of size 2^( 2) =       0.000422098817
  error estimate for blocks of size 2^( 3) =       0.000435102320
  error estimate for blocks of size 2^( 4) =       0.000447537059
  error estimate for blocks of size 2^( 5) =       0.000458832330
  error estimate for blocks of size 2^( 6) =       0.000466042430
  error estimate for blocks of size 2^( 7) =       0.000470789359

      target function =                  N/A
              le_mean =     -16.906009374261
             les_mean =     286.147736810025
             stat err =       0.000460800295
             autocorr =       1.269259152121
              std dev =       0.578432376960
             le_variance =       0.334584014715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906009374261        initial
     5.9605e+07     5.9605e+08             3.6626e-12       -16.906009374261
     2.3842e+08     2.3842e+09             9.1573e-13       -16.906009374261
     9.5367e+08     9.5367e+09             2.2894e-13       -16.906009374261  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e+08     and shift_s =   9.5367e+09
*****************************************************************************

  Execution time = 4.9173e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9394
    reference variance = 0.44735
====================================================
  Execution time = 3.5844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3361e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333659298663
                                         uncertainty =       0.002635946038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333659298663
                                         uncertainty =       0.002635946038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408415804
  error estimate for blocks of size 2^( 2) =       0.000421046447
  error estimate for blocks of size 2^( 3) =       0.000434386585
  error estimate for blocks of size 2^( 4) =       0.000447418755
  error estimate for blocks of size 2^( 5) =       0.000458168411
  error estimate for blocks of size 2^( 6) =       0.000466635526
  error estimate for blocks of size 2^( 7) =       0.000474459059

      target function =                  N/A
              le_mean =     -16.905370332149
             les_mean =     286.125152838847
             stat err =       0.000461670437
             autocorr =       1.277788728054
              std dev =       0.577587169658
             le_variance =       0.333606938554


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690537033215e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905370332149       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905370332149       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905370332149       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905370332149       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905370332149       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905370322256       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905370478710       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905370360061       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 8.775669e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905370332149       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905370332149       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905370332149       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905370353721       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905370357727       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905370288609       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905370129196       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905369991655       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.193910e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905370332149       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905370332149       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905370332149       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905371730194       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905366884516       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905370378596       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905371739363       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905367816548       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 5.480683e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102611 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4988e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8931
    reference variance = 0.348001
====================================================
  Execution time = 3.6368e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3746e-01
  Total weights = 2.0000e+06
  Execution time = 3.1569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337484344280
                                         uncertainty =       0.003703323297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337484344280
                                         uncertainty =       0.003703323297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410767122
  error estimate for blocks of size 2^( 2) =       0.000423390522
  error estimate for blocks of size 2^( 3) =       0.000435926840
  error estimate for blocks of size 2^( 4) =       0.000447451794
  error estimate for blocks of size 2^( 5) =       0.000458394626
  error estimate for blocks of size 2^( 6) =       0.000466607336
  error estimate for blocks of size 2^( 7) =       0.000472909095

      target function =                  N/A
              le_mean =     -16.905764332384
             les_mean =     286.142326749665
             stat err =       0.000461340713
             autocorr =       1.261398224066
              std dev =       0.580912434260
             le_variance =       0.337459256278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337484344280
                                         uncertainty =       0.003703323297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337484344280
                                         uncertainty =       0.003703323297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410767122
  error estimate for blocks of size 2^( 2) =       0.000423390522
  error estimate for blocks of size 2^( 3) =       0.000435926840
  error estimate for blocks of size 2^( 4) =       0.000447451794
  error estimate for blocks of size 2^( 5) =       0.000458394626
  error estimate for blocks of size 2^( 6) =       0.000466607336
  error estimate for blocks of size 2^( 7) =       0.000472909095

      target function =                  N/A
              le_mean =     -16.905764332384
             les_mean =     286.142326749664
             stat err =       0.000461340713
             autocorr =       1.261398224073
              std dev =       0.580912434260
             le_variance =       0.337459256277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337484344280
                                         uncertainty =       0.003703323297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337484344280
                                         uncertainty =       0.003703323297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410767122
  error estimate for blocks of size 2^( 2) =       0.000423390522
  error estimate for blocks of size 2^( 3) =       0.000435926840
  error estimate for blocks of size 2^( 4) =       0.000447451794
  error estimate for blocks of size 2^( 5) =       0.000458394626
  error estimate for blocks of size 2^( 6) =       0.000466607336
  error estimate for blocks of size 2^( 7) =       0.000472909095

      target function =                  N/A
              le_mean =     -16.905764332384
             les_mean =     286.142326749664
             stat err =       0.000461340713
             autocorr =       1.261398224066
              std dev =       0.580912434260
             le_variance =       0.337459256278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337484344280
                                         uncertainty =       0.003703323297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337484344280
                                         uncertainty =       0.003703323297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410767122
  error estimate for blocks of size 2^( 2) =       0.000423390522
  error estimate for blocks of size 2^( 3) =       0.000435926840
  error estimate for blocks of size 2^( 4) =       0.000447451794
  error estimate for blocks of size 2^( 5) =       0.000458394626
  error estimate for blocks of size 2^( 6) =       0.000466607336
  error estimate for blocks of size 2^( 7) =       0.000472909095

      target function =                  N/A
              le_mean =     -16.905764332384
             les_mean =     286.142326749665
             stat err =       0.000461340713
             autocorr =       1.261398224070
              std dev =       0.580912434260
             le_variance =       0.337459256278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905764332384        initial  <--
     2.3842e+08     2.3842e+09             8.7757e-13       -16.905764332384
     9.5367e+08     9.5367e+09             2.1939e-13       -16.905764332384
     3.8147e+09     3.8147e+10             5.4807e-14       -16.905764332384

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.2911
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.7285e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8486
    reference variance = 0.258691
====================================================
  Execution time = 3.4509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3866e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338641057543
                                         uncertainty =       0.003843589491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338641057543
                                         uncertainty =       0.003843589491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411496571
  error estimate for blocks of size 2^( 2) =       0.000424475557
  error estimate for blocks of size 2^( 3) =       0.000437439002
  error estimate for blocks of size 2^( 4) =       0.000450343697
  error estimate for blocks of size 2^( 5) =       0.000461675422
  error estimate for blocks of size 2^( 6) =       0.000470685343
  error estimate for blocks of size 2^( 7) =       0.000474010595

      target function =                  N/A
              le_mean =     -16.904675446127
             les_mean =     286.106710625137
             stat err =       0.000464178764
             autocorr =       1.272442291052
              std dev =       0.581944031301
             le_variance =       0.338658855566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690467544613e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904675446127       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904675446127       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904675446127       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904675004086       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904675446127       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904674683891       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904677016896       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904674533657       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 1.059029e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904675446127       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904675446127       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904675446127       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904676176181       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904674499293       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904672155045       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904675463427       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904680587521       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904676354525       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 2.639134e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904675446127       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904675446127       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904675446127       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904679973948       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904658184973       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904681220299       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904670584598       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904720881537       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904670756138       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904616027053       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904759927764       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904505847858       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904336885163       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904351480539       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904032729051       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904264754261       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904553736890       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905382616968       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904764759336       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905305800698       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905371879712       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905201208993       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.902736314915       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.903370000754       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903852185430       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906614692765       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903224953405       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905292290755       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906018650654       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.898106380415       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.904141037074       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.907556858120       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.901315291302       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.902392428928       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.906274974238       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.905512353992       residual = 1.65e-04           smallest_sin_value = 9.98e-01
davidson iteration   36 stopping due to small subspace S singular value of 9.58e-01
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 6.217977e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3720e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9593
    reference variance = 0.375056
====================================================
  Execution time = 3.3314e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4243e-01
  Total weights = 2.0000e+06
  Execution time = 3.1462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342352330741
                                         uncertainty =       0.004757811470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342352330741
                                         uncertainty =       0.004757811470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413783778
  error estimate for blocks of size 2^( 2) =       0.000426545359
  error estimate for blocks of size 2^( 3) =       0.000439639787
  error estimate for blocks of size 2^( 4) =       0.000451307747
  error estimate for blocks of size 2^( 5) =       0.000462326328
  error estimate for blocks of size 2^( 6) =       0.000470243844
  error estimate for blocks of size 2^( 7) =       0.000475357354

      target function =                  N/A
              le_mean =     -16.905745741362
             les_mean =     286.146672929437
             stat err =       0.000464808818
             autocorr =       1.261832758406
              std dev =       0.585178630069
             le_variance =       0.342434029090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342352330741
                                         uncertainty =       0.004757811470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342352330741
                                         uncertainty =       0.004757811470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413783778
  error estimate for blocks of size 2^( 2) =       0.000426545359
  error estimate for blocks of size 2^( 3) =       0.000439639787
  error estimate for blocks of size 2^( 4) =       0.000451307747
  error estimate for blocks of size 2^( 5) =       0.000462326328
  error estimate for blocks of size 2^( 6) =       0.000470243844
  error estimate for blocks of size 2^( 7) =       0.000475357354

      target function =                  N/A
              le_mean =     -16.905745741362
             les_mean =     286.146672929437
             stat err =       0.000464808818
             autocorr =       1.261832758406
              std dev =       0.585178630069
             le_variance =       0.342434029090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342352330741
                                         uncertainty =       0.004757811470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342352330741
                                         uncertainty =       0.004757811470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413783778
  error estimate for blocks of size 2^( 2) =       0.000426545359
  error estimate for blocks of size 2^( 3) =       0.000439639787
  error estimate for blocks of size 2^( 4) =       0.000451307747
  error estimate for blocks of size 2^( 5) =       0.000462326328
  error estimate for blocks of size 2^( 6) =       0.000470243844
  error estimate for blocks of size 2^( 7) =       0.000475357354

      target function =                  N/A
              le_mean =     -16.905745741362
             les_mean =     286.146672929437
             stat err =       0.000464808818
             autocorr =       1.261832758405
              std dev =       0.585178630069
             le_variance =       0.342434029090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342352330741
                                         uncertainty =       0.004757811470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342352330741
                                         uncertainty =       0.004757811470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413783778
  error estimate for blocks of size 2^( 2) =       0.000426545359
  error estimate for blocks of size 2^( 3) =       0.000439639787
  error estimate for blocks of size 2^( 4) =       0.000451307747
  error estimate for blocks of size 2^( 5) =       0.000462326328
  error estimate for blocks of size 2^( 6) =       0.000470243844
  error estimate for blocks of size 2^( 7) =       0.000475357354

      target function =                  N/A
              le_mean =     -16.905745741362
             les_mean =     286.146672929437
             stat err =       0.000464808818
             autocorr =       1.261832758406
              std dev =       0.585178630069
             le_variance =       0.342434029090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905745741362        initial  <--
     2.3842e+09     2.3842e+10             1.0590e-13       -16.905745741362
     9.5367e+09     9.5367e+10             2.6391e-14       -16.905745741362
     3.8147e+10     3.8147e+11             6.2180e-15       -16.905745741362

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.2403
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2966e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8821
    reference variance = 0.24139
====================================================
  Execution time = 3.4143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4116e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341183500942
                                         uncertainty =       0.003695902759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341183500942
                                         uncertainty =       0.003695902759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413011906
  error estimate for blocks of size 2^( 2) =       0.000425683945
  error estimate for blocks of size 2^( 3) =       0.000438723235
  error estimate for blocks of size 2^( 4) =       0.000450993433
  error estimate for blocks of size 2^( 5) =       0.000462892204
  error estimate for blocks of size 2^( 6) =       0.000469698077
  error estimate for blocks of size 2^( 7) =       0.000474968288

      target function =                  N/A
              le_mean =     -16.905920090529
             les_mean =     286.151291605995
             stat err =       0.000464638001
             autocorr =       1.265622855665
              std dev =       0.584087039079
             le_variance =       0.341157669220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592009053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905920090529       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905920090529       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905920090529       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905920090529       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905920090529       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933801919       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905918271210       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905941942450       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905910274830       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906020101829       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905897943718       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905991953649       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905755791216       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906059163630       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905521297356       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905977960401       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905073865546       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906422147258       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904998562040       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906000258758       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906714518147       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905866231555       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.907656471670       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905265219555       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906159412856       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.907301035627       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906520787689       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906691112745       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906817640175       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.903453976537       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.907074754328       residual = 2.24e-04           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.905413300762       residual = 5.08e-05           smallest_sin_value = 9.96e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 8.276515e-15

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905920090529       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905920090529       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905920090529       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905949550539       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905920090529       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905899665140       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905939752285       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905954664471       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905728802933       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905459225696       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908326985543       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905517701810       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.903138994778       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908731210229       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908039298419       residual = 6.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905990968546       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908038674312       residual = 6.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.912027268397       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904509415336       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.900992715741       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908376193048       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.912604756172       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.912683409706       residual = 6.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907584630136       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.895805439920       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.900110099007       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906313862820       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.911908496361       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.912143279961       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.908843923529       residual = 1.01e-03           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.911713541423       residual = 4.44e-03           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.896286693929       residual = 1.25e-02           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.21e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 2.068308e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905920090529       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905920090529       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905920090529       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905920090529       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905900241822       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905882902442       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906486848661       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905517131527       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904834405379       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908091680258       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906359535957       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906799754460       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910235932818       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904352455332       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.901509599868       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907416711610       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905249478624       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910021440596       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907525498670       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.903263540009       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906548529769       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.897637529934       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.902262706636       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.926980854086       residual = 6.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.892218457265       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.925309620546       residual = 4.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.942236484538       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.950626476205       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.887524842467       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.903746439345       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.857121137818       residual = 2.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.889911180577       residual = 4.38e-02           smallest_sin_value = 9.97e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.854554030500       residual = 3.56e-01           smallest_sin_value = 9.93e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.40e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 4.861727e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169004 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3487e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9015
    reference variance = 0.208537
====================================================
  Execution time = 3.3726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3883e-01
  Total weights = 2.0000e+06
  Execution time = 3.1575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338741301773
                                         uncertainty =       0.005061171345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338741301773
                                         uncertainty =       0.005061171345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602526
  error estimate for blocks of size 2^( 2) =       0.000424460320
  error estimate for blocks of size 2^( 3) =       0.000437561595
  error estimate for blocks of size 2^( 4) =       0.000449791432
  error estimate for blocks of size 2^( 5) =       0.000460915236
  error estimate for blocks of size 2^( 6) =       0.000468195532
  error estimate for blocks of size 2^( 7) =       0.000475573178

      target function =                  N/A
              le_mean =     -16.905065830863
             les_mean =     286.120083855795
             stat err =       0.000463618844
             autocorr =       1.268720907916
              std dev =       0.582093875083
             le_variance =       0.338833279409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338741301773
                                         uncertainty =       0.005061171345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338741301773
                                         uncertainty =       0.005061171345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602526
  error estimate for blocks of size 2^( 2) =       0.000424460320
  error estimate for blocks of size 2^( 3) =       0.000437561595
  error estimate for blocks of size 2^( 4) =       0.000449791432
  error estimate for blocks of size 2^( 5) =       0.000460915236
  error estimate for blocks of size 2^( 6) =       0.000468195532
  error estimate for blocks of size 2^( 7) =       0.000475573178

      target function =                  N/A
              le_mean =     -16.905065830863
             les_mean =     286.120083855795
             stat err =       0.000463618844
             autocorr =       1.268720907913
              std dev =       0.582093875083
             le_variance =       0.338833279409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338741301773
                                         uncertainty =       0.005061171345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338741301773
                                         uncertainty =       0.005061171345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602526
  error estimate for blocks of size 2^( 2) =       0.000424460320
  error estimate for blocks of size 2^( 3) =       0.000437561595
  error estimate for blocks of size 2^( 4) =       0.000449791432
  error estimate for blocks of size 2^( 5) =       0.000460915236
  error estimate for blocks of size 2^( 6) =       0.000468195532
  error estimate for blocks of size 2^( 7) =       0.000475573178

      target function =                  N/A
              le_mean =     -16.905065830863
             les_mean =     286.120083855795
             stat err =       0.000463618844
             autocorr =       1.268720907914
              std dev =       0.582093875083
             le_variance =       0.338833279409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338741301773
                                         uncertainty =       0.005061171345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338741301773
                                         uncertainty =       0.005061171345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602526
  error estimate for blocks of size 2^( 2) =       0.000424460320
  error estimate for blocks of size 2^( 3) =       0.000437561595
  error estimate for blocks of size 2^( 4) =       0.000449791432
  error estimate for blocks of size 2^( 5) =       0.000460915236
  error estimate for blocks of size 2^( 6) =       0.000468195532
  error estimate for blocks of size 2^( 7) =       0.000475573178

      target function =                  N/A
              le_mean =     -16.905065830863
             les_mean =     286.120083855795
             stat err =       0.000463618844
             autocorr =       1.268720907909
              std dev =       0.582093875083
             le_variance =       0.338833279409


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905065830863        initial  <--
     2.3842e+10     2.3842e+11             8.2765e-15       -16.905065830863
     9.5367e+10     9.5367e+11             2.0683e-15       -16.905065830863
     3.8147e+11     3.8147e+12             4.8617e-16       -16.905065830863

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.6368
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3129e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9321
    reference variance = 0.563241
====================================================
  Execution time = 3.4848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4075e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340763002323
                                         uncertainty =       0.003897760721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340763002323
                                         uncertainty =       0.003897760721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412766083
  error estimate for blocks of size 2^( 2) =       0.000425307657
  error estimate for blocks of size 2^( 3) =       0.000438065926
  error estimate for blocks of size 2^( 4) =       0.000450148446
  error estimate for blocks of size 2^( 5) =       0.000459590776
  error estimate for blocks of size 2^( 6) =       0.000466447899
  error estimate for blocks of size 2^( 7) =       0.000469364415

      target function =                  N/A
              le_mean =     -16.906326619229
             les_mean =     286.164631264961
             stat err =       0.000461387884
             autocorr =       1.249465769128
              std dev =       0.583739393303
             le_variance =       0.340751679294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632661923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906326619229       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906326619229       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906326619229       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906326619229       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906415019156       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906289361664       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906353459981       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906496363732       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905523876133       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905765456401       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906403321506       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.899877831015       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904824672908       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908866668233       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.900590825592       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.903799523746       residual = 9.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.891680359166       residual = 2.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908756484998       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.901758040169       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.897508864841       residual = 9.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909577098186       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.897999444328       residual = 8.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.894277072584       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.912665031327       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.898230350005       residual = 8.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.914541270597       residual = 9.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903204647240       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.917683873188       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.894207530691       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.905484992785       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.902237982548       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.899277676561       residual = 8.54e-03           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.936023405144       residual = 1.23e-01           smallest_sin_value = 9.98e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.880122849794       residual = 1.25e-01           smallest_sin_value = 9.95e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.938053384698       residual = 1.40e-01           smallest_sin_value = 9.93e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.26e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 8.252909e-16

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906326619229       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906326619229       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906326619229       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906326619229       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188102 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3856e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8479
    reference variance = 0.364947
====================================================
  Execution time = 3.5301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6184e-01
  Total weights = 2.0000e+06
  Execution time = 3.1548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361947611251
                                         uncertainty =       0.013587634478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361947611251
                                         uncertainty =       0.013587634478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425348003
  error estimate for blocks of size 2^( 2) =       0.000438095260
  error estimate for blocks of size 2^( 3) =       0.000450932027
  error estimate for blocks of size 2^( 4) =       0.000463126183
  error estimate for blocks of size 2^( 5) =       0.000473806583
  error estimate for blocks of size 2^( 6) =       0.000482085361
  error estimate for blocks of size 2^( 7) =       0.000488113255

      target function =                  N/A
              le_mean =     -16.905527371322
             les_mean =     286.158697369441
             stat err =       0.000476782845
             autocorr =       1.256470930123
              std dev =       0.601532915026
             le_variance =       0.361841847859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361947611251
                                         uncertainty =       0.013587634478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361947611251
                                         uncertainty =       0.013587634478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425348003
  error estimate for blocks of size 2^( 2) =       0.000438095260
  error estimate for blocks of size 2^( 3) =       0.000450932027
  error estimate for blocks of size 2^( 4) =       0.000463126183
  error estimate for blocks of size 2^( 5) =       0.000473806583
  error estimate for blocks of size 2^( 6) =       0.000482085361
  error estimate for blocks of size 2^( 7) =       0.000488113255

      target function =                  N/A
              le_mean =     -16.905527371322
             les_mean =     286.158697369441
             stat err =       0.000476782845
             autocorr =       1.256470930126
              std dev =       0.601532915026
             le_variance =       0.361841847859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361947611251
                                         uncertainty =       0.013587634478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361947611251
                                         uncertainty =       0.013587634478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425348003
  error estimate for blocks of size 2^( 2) =       0.000438095260
  error estimate for blocks of size 2^( 3) =       0.000450932027
  error estimate for blocks of size 2^( 4) =       0.000463126183
  error estimate for blocks of size 2^( 5) =       0.000473806583
  error estimate for blocks of size 2^( 6) =       0.000482085361
  error estimate for blocks of size 2^( 7) =       0.000488113255

      target function =                  N/A
              le_mean =     -16.905527371322
             les_mean =     286.158697369441
             stat err =       0.000476782845
             autocorr =       1.256470930123
              std dev =       0.601532915026
             le_variance =       0.361841847859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361947611251
                                         uncertainty =       0.013587634478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361947611251
                                         uncertainty =       0.013587634478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425348003
  error estimate for blocks of size 2^( 2) =       0.000438095260
  error estimate for blocks of size 2^( 3) =       0.000450932027
  error estimate for blocks of size 2^( 4) =       0.000463126183
  error estimate for blocks of size 2^( 5) =       0.000473806583
  error estimate for blocks of size 2^( 6) =       0.000482085361
  error estimate for blocks of size 2^( 7) =       0.000488113255

      target function =                  N/A
              le_mean =     -16.905527371322
             les_mean =     286.158697369441
             stat err =       0.000476782845
             autocorr =       1.256470930123
              std dev =       0.601532915026
             le_variance =       0.361841847859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905527371322        initial  <--
     2.3842e+11     2.3842e+12             8.2529e-16       -16.905527371322
     9.5367e+11     9.5367e+12             0.0000e+00       -16.905527371322
     3.8147e+12     3.8147e+13             0.0000e+00       -16.905527371322

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.1976
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5059e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9592
    reference variance = 0.821205
====================================================
  Execution time = 3.3912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4417e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344265933538
                                         uncertainty =       0.005326354641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344265933538
                                         uncertainty =       0.005326354641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414831403
  error estimate for blocks of size 2^( 2) =       0.000427832720
  error estimate for blocks of size 2^( 3) =       0.000441284845
  error estimate for blocks of size 2^( 4) =       0.000454152851
  error estimate for blocks of size 2^( 5) =       0.000462980325
  error estimate for blocks of size 2^( 6) =       0.000469816381
  error estimate for blocks of size 2^( 7) =       0.000474685370

      target function =                  N/A
              le_mean =     -16.904660782994
             les_mean =     286.111726202399
             stat err =       0.000465408732
             autocorr =       1.258710348630
              std dev =       0.586660196697
             le_variance =       0.344170186388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690466078299e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904660782994       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904660782994       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904660782994       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904660782994       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904476989998       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904660782994       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.902442268932       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909165253600       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.878098619995       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.917211810756       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909908712971       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.933788603352       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.885631218790       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.879729632479       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910129373576       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.793934439220       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.978573783841       residual = 7.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.788958872849       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.902840696508       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.054830302083       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.834822786394       residual = 5.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.561671819160       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.644928719075       residual = 9.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.702379101488       residual = 5.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.942094256354       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.937315159522       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.889165618444       residual = 6.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.870893419554       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.567929027217       residual = 1.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.982548150612       residual = 1.01e+00           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.573397556981       residual = 1.46e+01           smallest_sin_value = 9.91e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.26e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+12 is 8.277957e-17

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904660782994       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904660782994       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904660782994       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904660782994       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904660782994       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904660783004       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916342643081       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.951187113693       residual = 2.95e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906651401562       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.989881636819       residual = 8.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.838251530805       residual = 5.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.888334943924       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.653894250323       residual = 8.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.202410000639       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.449679156437       residual = 2.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.941129894870       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.313594756609       residual = 4.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.222457275570       residual = 1.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.949965666669       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.012262684946       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.840244843018       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -15.972766505073       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -15.723189317759       residual = 1.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.445699906925       residual = 3.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -15.317574742678       residual = 3.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -15.940657241684       residual = 1.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.830845455891       residual = 2.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.631805874490       residual = 7.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.604699588094       residual = 6.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.996667061393       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -15.783347239052       residual = 1.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.347152441541       residual = 4.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -15.881799034796       residual = 1.42e+02           smallest_sin_value = 9.97e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 1.548375e-17

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904660782994       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904660782994       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904660782994       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904194134955       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.875117359837       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903772271191       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903817751662       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.874177264480       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.010148730803       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.612900489960       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.120287586968       residual = 7.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.155582677599       residual = 6.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.395855588467       residual = 3.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -15.522932201115       residual = 2.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.806248022274       residual = 1.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.013658690063       residual = 2.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -18.661049357550       residual = 4.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -18.067645815679       residual = 1.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.129867128389       residual = 7.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.919850145182       residual = 3.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.239331401537       residual = 7.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -18.488860236911       residual = 3.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.083836974031       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.025504811169       residual = 3.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -19.037406427792       residual = 6.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -19.108205583997       residual = 6.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -18.296065474458       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -20.278445380839       residual = 1.51e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -15.161390735301       residual = 4.02e+02           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.707162095509       residual = 1.80e+01           smallest_sin_value = 9.97e-01
davidson iteration   30:   krylov dim =  31   energy =     -19.176947221622       residual = 5.97e+02           smallest_sin_value = 9.96e-01
davidson iteration   31:   krylov dim =  32   energy =     -14.342678024069       residual = 7.95e+02           smallest_sin_value = 9.96e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 1.017817e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3088e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8983
    reference variance = 0.385644
====================================================
  Execution time = 3.3195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3475e-01
  Total weights = 2.0000e+06
  Execution time = 3.1608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682154952
                                         uncertainty =       0.002679767650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682154952
                                         uncertainty =       0.002679767650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409113639
  error estimate for blocks of size 2^( 2) =       0.000421870472
  error estimate for blocks of size 2^( 3) =       0.000435223655
  error estimate for blocks of size 2^( 4) =       0.000447542374
  error estimate for blocks of size 2^( 5) =       0.000459285237
  error estimate for blocks of size 2^( 6) =       0.000467285776
  error estimate for blocks of size 2^( 7) =       0.000472003932

      target function =                  N/A
              le_mean =     -16.905870959885
             les_mean =     286.143220684471
             stat err =       0.000461529330
             autocorr =       1.272655015889
              std dev =       0.578574057118
             le_variance =       0.334747939570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682154952
                                         uncertainty =       0.002679767650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682154952
                                         uncertainty =       0.002679767650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409113639
  error estimate for blocks of size 2^( 2) =       0.000421870472
  error estimate for blocks of size 2^( 3) =       0.000435223655
  error estimate for blocks of size 2^( 4) =       0.000447542374
  error estimate for blocks of size 2^( 5) =       0.000459285237
  error estimate for blocks of size 2^( 6) =       0.000467285776
  error estimate for blocks of size 2^( 7) =       0.000472003932

      target function =                  N/A
              le_mean =     -16.905870959885
             les_mean =     286.143220684471
             stat err =       0.000461529330
             autocorr =       1.272655015889
              std dev =       0.578574057118
             le_variance =       0.334747939570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682154952
                                         uncertainty =       0.002679767650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682154952
                                         uncertainty =       0.002679767650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409113639
  error estimate for blocks of size 2^( 2) =       0.000421870472
  error estimate for blocks of size 2^( 3) =       0.000435223655
  error estimate for blocks of size 2^( 4) =       0.000447542374
  error estimate for blocks of size 2^( 5) =       0.000459285237
  error estimate for blocks of size 2^( 6) =       0.000467285776
  error estimate for blocks of size 2^( 7) =       0.000472003932

      target function =                  N/A
              le_mean =     -16.905870959885
             les_mean =     286.143220684471
             stat err =       0.000461529330
             autocorr =       1.272655015889
              std dev =       0.578574057118
             le_variance =       0.334747939570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682154952
                                         uncertainty =       0.002679767650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682154952
                                         uncertainty =       0.002679767650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409113639
  error estimate for blocks of size 2^( 2) =       0.000421870472
  error estimate for blocks of size 2^( 3) =       0.000435223655
  error estimate for blocks of size 2^( 4) =       0.000447542374
  error estimate for blocks of size 2^( 5) =       0.000459285237
  error estimate for blocks of size 2^( 6) =       0.000467285776
  error estimate for blocks of size 2^( 7) =       0.000472003932

      target function =                  N/A
              le_mean =     -16.905870959885
             les_mean =     286.143220684471
             stat err =       0.000461529330
             autocorr =       1.272655015889
              std dev =       0.578574057118
             le_variance =       0.334747939570


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905870959885        initial  <--
     2.3842e+12     2.3842e+13             8.2780e-17       -16.905870959885
     9.5367e+12     9.5367e+13             1.5484e-17       -16.905870959885
     3.8147e+13     3.8147e+14             1.0178e-18       -16.905870959885

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.1180
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8507
    reference variance = 0.273336
====================================================
  Execution time = 3.3734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4612e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346147262637
                                         uncertainty =       0.008556848544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346147262637
                                         uncertainty =       0.008556848544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416002389
  error estimate for blocks of size 2^( 2) =       0.000428699977
  error estimate for blocks of size 2^( 3) =       0.000442377619
  error estimate for blocks of size 2^( 4) =       0.000454216396
  error estimate for blocks of size 2^( 5) =       0.000466444576
  error estimate for blocks of size 2^( 6) =       0.000475330437
  error estimate for blocks of size 2^( 7) =       0.000480786241

      target function =                  N/A
              le_mean =     -16.906423618660
             les_mean =     286.173275375946
             stat err =       0.000469194413
             autocorr =       1.272078797480
              std dev =       0.588316220586
             le_variance =       0.346115975405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642361866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906423618660       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906423618660       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.71e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906423618660       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906423618660       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.70e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906423618660       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906423618660       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.70e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230983 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2933e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8961
    reference variance = 0.307348
====================================================
  Execution time = 3.3602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.4564e-01
  Total weights = 2.0000e+06
  Execution time = 3.1456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688872088
                                         uncertainty =       0.007014806929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688872088
                                         uncertainty =       0.007014806929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415718715
  error estimate for blocks of size 2^( 2) =       0.000428309828
  error estimate for blocks of size 2^( 3) =       0.000441285132
  error estimate for blocks of size 2^( 4) =       0.000452932532
  error estimate for blocks of size 2^( 5) =       0.000463193177
  error estimate for blocks of size 2^( 6) =       0.000472418979
  error estimate for blocks of size 2^( 7) =       0.000475865490

      target function =                  N/A
              le_mean =     -16.904480999278
             les_mean =     286.107121782578
             stat err =       0.000466102544
             autocorr =       1.257082540512
              std dev =       0.587915045259
             le_variance =       0.345644100442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688872088
                                         uncertainty =       0.007014806929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688872088
                                         uncertainty =       0.007014806929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415718715
  error estimate for blocks of size 2^( 2) =       0.000428309828
  error estimate for blocks of size 2^( 3) =       0.000441285132
  error estimate for blocks of size 2^( 4) =       0.000452932532
  error estimate for blocks of size 2^( 5) =       0.000463193177
  error estimate for blocks of size 2^( 6) =       0.000472418979
  error estimate for blocks of size 2^( 7) =       0.000475865490

      target function =                  N/A
              le_mean =     -16.904480999278
             les_mean =     286.107121782578
             stat err =       0.000466102544
             autocorr =       1.257082540512
              std dev =       0.587915045259
             le_variance =       0.345644100442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688872088
                                         uncertainty =       0.007014806929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688872088
                                         uncertainty =       0.007014806929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415718715
  error estimate for blocks of size 2^( 2) =       0.000428309828
  error estimate for blocks of size 2^( 3) =       0.000441285132
  error estimate for blocks of size 2^( 4) =       0.000452932532
  error estimate for blocks of size 2^( 5) =       0.000463193177
  error estimate for blocks of size 2^( 6) =       0.000472418979
  error estimate for blocks of size 2^( 7) =       0.000475865490

      target function =                  N/A
              le_mean =     -16.904480999278
             les_mean =     286.107121782578
             stat err =       0.000466102544
             autocorr =       1.257082540512
              std dev =       0.587915045259
             le_variance =       0.345644100442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688872088
                                         uncertainty =       0.007014806929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688872088
                                         uncertainty =       0.007014806929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415718715
  error estimate for blocks of size 2^( 2) =       0.000428309828
  error estimate for blocks of size 2^( 3) =       0.000441285132
  error estimate for blocks of size 2^( 4) =       0.000452932532
  error estimate for blocks of size 2^( 5) =       0.000463193177
  error estimate for blocks of size 2^( 6) =       0.000472418979
  error estimate for blocks of size 2^( 7) =       0.000475865490

      target function =                  N/A
              le_mean =     -16.904480999278
             les_mean =     286.107121782578
             stat err =       0.000466102544
             autocorr =       1.257082540512
              std dev =       0.587915045259
             le_variance =       0.345644100442


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904480999278        initial  <--
     2.3842e+13     2.3842e+14             0.0000e+00       -16.904480999278
     9.5367e+13     9.5367e+14             0.0000e+00       -16.904480999278
     3.8147e+14     3.8147e+15             0.0000e+00       -16.904480999278

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4632
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2402e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8419
    reference variance = 0.184554
====================================================
  Execution time = 3.4021e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3524e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334857638315
                                         uncertainty =       0.004181209570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334857638315
                                         uncertainty =       0.004181209570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409416859
  error estimate for blocks of size 2^( 2) =       0.000422649778
  error estimate for blocks of size 2^( 3) =       0.000435948118
  error estimate for blocks of size 2^( 4) =       0.000448567727
  error estimate for blocks of size 2^( 5) =       0.000457987521
  error estimate for blocks of size 2^( 6) =       0.000466058135
  error estimate for blocks of size 2^( 7) =       0.000470450905

      target function =                  N/A
              le_mean =     -16.905302618395
             les_mean =     286.124500780857
             stat err =       0.000460766072
             autocorr =       1.266571004212
              std dev =       0.579002874745
             le_variance =       0.335244328964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690530261840e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905302618395       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905302618395       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905302618395       residual = 9.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905302618395       residual = 7.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.866127917942       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.034080273413       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.628629548761       residual = 7.66e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211471247080       residual = 1.05e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.224650864107       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.825573938206       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -18.231808106335       residual = 2.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -14.780398594204       residual = 6.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -18.196043072122       residual = 2.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -15.120744031125       residual = 4.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.535325407841       residual = 6.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -14.777108759042       residual = 6.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.406215305153       residual = 5.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   17 stopping due to too large eigenvalue change
davidson solver did not converge after         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+14 is 1.449042e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905302618395       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905302618395       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905302618395       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905302618395       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -18.052056467469       residual = 1.96e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214554055266       residual = 2.55e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -15.290391145107       residual = 4.82e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -13.046617827105       residual = 1.84e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -12.810187381139       residual = 2.77e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.188446516766       residual = 4.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 3.622605e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905302618395       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905302618395       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905302618395       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.593120616666       residual = 6.54e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -20.657486561975       residual = 1.58e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 9.056513e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236800 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3420e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8123
    reference variance = 0.224712
====================================================
  Execution time = 3.4988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3722e-01
  Total weights = 2.0000e+06
  Execution time = 3.1475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337300097947
                                         uncertainty =       0.003749977163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337300097947
                                         uncertainty =       0.003749977163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410623309
  error estimate for blocks of size 2^( 2) =       0.000423720828
  error estimate for blocks of size 2^( 3) =       0.000436772956
  error estimate for blocks of size 2^( 4) =       0.000448861715
  error estimate for blocks of size 2^( 5) =       0.000459629690
  error estimate for blocks of size 2^( 6) =       0.000466564411
  error estimate for blocks of size 2^( 7) =       0.000469822629

      target function =                  N/A
              le_mean =     -16.905801934588
             les_mean =     286.143361886669
             stat err =       0.000461219611
             autocorr =       1.261619328043
              std dev =       0.580709052584
             le_variance =       0.337223003753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337300097947
                                         uncertainty =       0.003749977163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337300097947
                                         uncertainty =       0.003749977163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410623309
  error estimate for blocks of size 2^( 2) =       0.000423720828
  error estimate for blocks of size 2^( 3) =       0.000436772956
  error estimate for blocks of size 2^( 4) =       0.000448861715
  error estimate for blocks of size 2^( 5) =       0.000459629690
  error estimate for blocks of size 2^( 6) =       0.000466564411
  error estimate for blocks of size 2^( 7) =       0.000469822629

      target function =                  N/A
              le_mean =     -16.905801934588
             les_mean =     286.143361886669
             stat err =       0.000461219611
             autocorr =       1.261619328043
              std dev =       0.580709052584
             le_variance =       0.337223003753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337300097947
                                         uncertainty =       0.003749977163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337300097947
                                         uncertainty =       0.003749977163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410623309
  error estimate for blocks of size 2^( 2) =       0.000423720828
  error estimate for blocks of size 2^( 3) =       0.000436772956
  error estimate for blocks of size 2^( 4) =       0.000448861715
  error estimate for blocks of size 2^( 5) =       0.000459629690
  error estimate for blocks of size 2^( 6) =       0.000466564411
  error estimate for blocks of size 2^( 7) =       0.000469822629

      target function =                  N/A
              le_mean =     -16.905801934588
             les_mean =     286.143361886669
             stat err =       0.000461219611
             autocorr =       1.261619328043
              std dev =       0.580709052584
             le_variance =       0.337223003753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337300097947
                                         uncertainty =       0.003749977163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337300097947
                                         uncertainty =       0.003749977163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410623309
  error estimate for blocks of size 2^( 2) =       0.000423720828
  error estimate for blocks of size 2^( 3) =       0.000436772956
  error estimate for blocks of size 2^( 4) =       0.000448861715
  error estimate for blocks of size 2^( 5) =       0.000459629690
  error estimate for blocks of size 2^( 6) =       0.000466564411
  error estimate for blocks of size 2^( 7) =       0.000469822629

      target function =                  N/A
              le_mean =     -16.905801934588
             les_mean =     286.143361886669
             stat err =       0.000461219611
             autocorr =       1.261619328043
              std dev =       0.580709052584
             le_variance =       0.337223003753


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905801934588        initial  <--
     2.3842e+14     2.3842e+15             1.4490e-19       -16.905801934588
     9.5367e+14     9.5367e+15             3.6226e-20       -16.905801934588
     3.8147e+15     3.8147e+16             9.0565e-21       -16.905801934588

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9132
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.7339e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.88
    reference variance = 0.252231
====================================================
  Execution time = 3.3893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336414079399
                                         uncertainty =       0.003148210353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336414079399
                                         uncertainty =       0.003148210353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410279549
  error estimate for blocks of size 2^( 2) =       0.000422995951
  error estimate for blocks of size 2^( 3) =       0.000436640193
  error estimate for blocks of size 2^( 4) =       0.000450007130
  error estimate for blocks of size 2^( 5) =       0.000461865800
  error estimate for blocks of size 2^( 6) =       0.000471418188
  error estimate for blocks of size 2^( 7) =       0.000478519203

      target function =                  N/A
              le_mean =     -16.905298239454
             les_mean =     286.125767013255
             stat err =       0.000465452580
             autocorr =       1.287037335654
              std dev =       0.580222902584
             le_variance =       0.336658616683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690529823945e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905298239454       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905298239454       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905298239454       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905298239454       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905298239454       residual = 3.27e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905298239454       residual = 2.21e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -14.237332455240       residual = 9.36e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -18.258052784532       residual = 2.39e+02           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 7.619254e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905298239454       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905298239454       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905298239454       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905298239456       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905298239455       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 1.904814e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3112e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8533
    reference variance = 0.16785
====================================================
  Execution time = 3.3484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4469e-01
  Total weights = 2.0000e+06
  Execution time = 3.1529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344721875051
                                         uncertainty =       0.007332150475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344721875051
                                         uncertainty =       0.007332150475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415145437
  error estimate for blocks of size 2^( 2) =       0.000428107049
  error estimate for blocks of size 2^( 3) =       0.000441935892
  error estimate for blocks of size 2^( 4) =       0.000453985393
  error estimate for blocks of size 2^( 5) =       0.000464862552
  error estimate for blocks of size 2^( 6) =       0.000472781328
  error estimate for blocks of size 2^( 7) =       0.000478517277

      target function =                  N/A
              le_mean =     -16.905982572305
             les_mean =     286.156938030664
             stat err =       0.000467536637
             autocorr =       1.268325605478
              std dev =       0.587104307549
             le_variance =       0.344691467943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344721875051
                                         uncertainty =       0.007332150475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344721875051
                                         uncertainty =       0.007332150475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415145437
  error estimate for blocks of size 2^( 2) =       0.000428107049
  error estimate for blocks of size 2^( 3) =       0.000441935892
  error estimate for blocks of size 2^( 4) =       0.000453985393
  error estimate for blocks of size 2^( 5) =       0.000464862552
  error estimate for blocks of size 2^( 6) =       0.000472781328
  error estimate for blocks of size 2^( 7) =       0.000478517277

      target function =                  N/A
              le_mean =     -16.905982572305
             les_mean =     286.156938030664
             stat err =       0.000467536637
             autocorr =       1.268325605478
              std dev =       0.587104307549
             le_variance =       0.344691467943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344721875051
                                         uncertainty =       0.007332150475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344721875051
                                         uncertainty =       0.007332150475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415145437
  error estimate for blocks of size 2^( 2) =       0.000428107049
  error estimate for blocks of size 2^( 3) =       0.000441935892
  error estimate for blocks of size 2^( 4) =       0.000453985393
  error estimate for blocks of size 2^( 5) =       0.000464862552
  error estimate for blocks of size 2^( 6) =       0.000472781328
  error estimate for blocks of size 2^( 7) =       0.000478517277

      target function =                  N/A
              le_mean =     -16.905982572305
             les_mean =     286.156938030664
             stat err =       0.000467536637
             autocorr =       1.268325605478
              std dev =       0.587104307549
             le_variance =       0.344691467943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344721875051
                                         uncertainty =       0.007332150475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344721875051
                                         uncertainty =       0.007332150475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415145437
  error estimate for blocks of size 2^( 2) =       0.000428107049
  error estimate for blocks of size 2^( 3) =       0.000441935892
  error estimate for blocks of size 2^( 4) =       0.000453985393
  error estimate for blocks of size 2^( 5) =       0.000464862552
  error estimate for blocks of size 2^( 6) =       0.000472781328
  error estimate for blocks of size 2^( 7) =       0.000478517277

      target function =                  N/A
              le_mean =     -16.905982572305
             les_mean =     286.156938030664
             stat err =       0.000467536637
             autocorr =       1.268325605478
              std dev =       0.587104307549
             le_variance =       0.344691467943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905982572305        initial  <--
     2.3842e+15     2.3842e+16             0.0000e+00       -16.905982572305
     9.5367e+15     9.5367e+16             7.6193e-21       -16.905982572305
     3.8147e+16     3.8147e+17             1.9048e-21       -16.905982572305

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.3144
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2432e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8979
    reference variance = 0.280426
====================================================
  Execution time = 3.3628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4006e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340136945778
                                         uncertainty =       0.003391618910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340136945778
                                         uncertainty =       0.003391618910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412349910
  error estimate for blocks of size 2^( 2) =       0.000425523418
  error estimate for blocks of size 2^( 3) =       0.000438967136
  error estimate for blocks of size 2^( 4) =       0.000451376949
  error estimate for blocks of size 2^( 5) =       0.000461996257
  error estimate for blocks of size 2^( 6) =       0.000468658043
  error estimate for blocks of size 2^( 7) =       0.000472122827

      target function =                  N/A
              le_mean =     -16.905345409675
             les_mean =     286.130768146474
             stat err =       0.000463538519
             autocorr =       1.263687967259
              std dev =       0.583150834763
             le_variance =       0.340064896085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534540968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905345409675       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905345409675       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905345409675       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905345409675       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905345409675       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905345409675       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239704 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2808e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8192
    reference variance = 0.490295
====================================================
  Execution time = 3.3416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4268e-01
  Total weights = 2.0000e+06
  Execution time = 3.1691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342692527922
                                         uncertainty =       0.003957557607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342692527922
                                         uncertainty =       0.003957557607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413930699
  error estimate for blocks of size 2^( 2) =       0.000425635071
  error estimate for blocks of size 2^( 3) =       0.000439281071
  error estimate for blocks of size 2^( 4) =       0.000452628054
  error estimate for blocks of size 2^( 5) =       0.000465660008
  error estimate for blocks of size 2^( 6) =       0.000475632195
  error estimate for blocks of size 2^( 7) =       0.000484226816

      target function =                  N/A
              le_mean =     -16.906052048471
             les_mean =     286.157272941843
             stat err =       0.000469536768
             autocorr =       1.286719665545
              std dev =       0.585386408765
             le_variance =       0.342677247567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342692527922
                                         uncertainty =       0.003957557607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342692527922
                                         uncertainty =       0.003957557607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413930699
  error estimate for blocks of size 2^( 2) =       0.000425635071
  error estimate for blocks of size 2^( 3) =       0.000439281071
  error estimate for blocks of size 2^( 4) =       0.000452628054
  error estimate for blocks of size 2^( 5) =       0.000465660008
  error estimate for blocks of size 2^( 6) =       0.000475632195
  error estimate for blocks of size 2^( 7) =       0.000484226816

      target function =                  N/A
              le_mean =     -16.906052048471
             les_mean =     286.157272941843
             stat err =       0.000469536768
             autocorr =       1.286719665545
              std dev =       0.585386408765
             le_variance =       0.342677247567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342692527922
                                         uncertainty =       0.003957557607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342692527922
                                         uncertainty =       0.003957557607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413930699
  error estimate for blocks of size 2^( 2) =       0.000425635071
  error estimate for blocks of size 2^( 3) =       0.000439281071
  error estimate for blocks of size 2^( 4) =       0.000452628054
  error estimate for blocks of size 2^( 5) =       0.000465660008
  error estimate for blocks of size 2^( 6) =       0.000475632195
  error estimate for blocks of size 2^( 7) =       0.000484226816

      target function =                  N/A
              le_mean =     -16.906052048471
             les_mean =     286.157272941843
             stat err =       0.000469536768
             autocorr =       1.286719665545
              std dev =       0.585386408765
             le_variance =       0.342677247567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342692527922
                                         uncertainty =       0.003957557607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342692527922
                                         uncertainty =       0.003957557607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413930699
  error estimate for blocks of size 2^( 2) =       0.000425635071
  error estimate for blocks of size 2^( 3) =       0.000439281071
  error estimate for blocks of size 2^( 4) =       0.000452628054
  error estimate for blocks of size 2^( 5) =       0.000465660008
  error estimate for blocks of size 2^( 6) =       0.000475632195
  error estimate for blocks of size 2^( 7) =       0.000484226816

      target function =                  N/A
              le_mean =     -16.906052048471
             les_mean =     286.157272941843
             stat err =       0.000469536768
             autocorr =       1.286719665545
              std dev =       0.585386408765
             le_variance =       0.342677247567


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906052048471        initial  <--
     2.3842e+16     2.3842e+17             0.0000e+00       -16.906052048471
     9.5367e+16     9.5367e+17             0.0000e+00       -16.906052048471
     3.8147e+17     3.8147e+18             0.0000e+00       -16.906052048471

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.3568
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2180e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8357
    reference variance = 0.285893
====================================================
  Execution time = 3.3934e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3907e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338694653247
                                         uncertainty =       0.003657191214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338694653247
                                         uncertainty =       0.003657191214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411748121
  error estimate for blocks of size 2^( 2) =       0.000424885741
  error estimate for blocks of size 2^( 3) =       0.000438405366
  error estimate for blocks of size 2^( 4) =       0.000451225060
  error estimate for blocks of size 2^( 5) =       0.000461339124
  error estimate for blocks of size 2^( 6) =       0.000469016128
  error estimate for blocks of size 2^( 7) =       0.000473865673

      target function =                  N/A
              le_mean =     -16.904263644853
             les_mean =     286.093202236084
             stat err =       0.000463861496
             autocorr =       1.269151293166
              std dev =       0.582299777545
             le_variance =       0.339073030929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690426364485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904263644853       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904263644853       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904263644853       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904263644853       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904263644853       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904263644853       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2972e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8967
    reference variance = 0.176765
====================================================
  Execution time = 3.5836e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4112e-01
  Total weights = 2.0000e+06
  Execution time = 3.1606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180697417
                                         uncertainty =       0.005358552830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180697417
                                         uncertainty =       0.005358552830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412991904
  error estimate for blocks of size 2^( 2) =       0.000425930310
  error estimate for blocks of size 2^( 3) =       0.000440095657
  error estimate for blocks of size 2^( 4) =       0.000453764624
  error estimate for blocks of size 2^( 5) =       0.000465868320
  error estimate for blocks of size 2^( 6) =       0.000472732661
  error estimate for blocks of size 2^( 7) =       0.000478649945

      target function =                  N/A
              le_mean =     -16.905597464653
             les_mean =     286.140350092602
             stat err =       0.000467753888
             autocorr =       1.282778682271
              std dev =       0.584058752430
             le_variance =       0.341124626290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180697417
                                         uncertainty =       0.005358552830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180697417
                                         uncertainty =       0.005358552830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412991904
  error estimate for blocks of size 2^( 2) =       0.000425930310
  error estimate for blocks of size 2^( 3) =       0.000440095657
  error estimate for blocks of size 2^( 4) =       0.000453764624
  error estimate for blocks of size 2^( 5) =       0.000465868320
  error estimate for blocks of size 2^( 6) =       0.000472732661
  error estimate for blocks of size 2^( 7) =       0.000478649945

      target function =                  N/A
              le_mean =     -16.905597464653
             les_mean =     286.140350092602
             stat err =       0.000467753888
             autocorr =       1.282778682271
              std dev =       0.584058752430
             le_variance =       0.341124626290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180697417
                                         uncertainty =       0.005358552830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180697417
                                         uncertainty =       0.005358552830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412991904
  error estimate for blocks of size 2^( 2) =       0.000425930310
  error estimate for blocks of size 2^( 3) =       0.000440095657
  error estimate for blocks of size 2^( 4) =       0.000453764624
  error estimate for blocks of size 2^( 5) =       0.000465868320
  error estimate for blocks of size 2^( 6) =       0.000472732661
  error estimate for blocks of size 2^( 7) =       0.000478649945

      target function =                  N/A
              le_mean =     -16.905597464653
             les_mean =     286.140350092602
             stat err =       0.000467753888
             autocorr =       1.282778682271
              std dev =       0.584058752430
             le_variance =       0.341124626290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180697417
                                         uncertainty =       0.005358552830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180697417
                                         uncertainty =       0.005358552830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412991904
  error estimate for blocks of size 2^( 2) =       0.000425930310
  error estimate for blocks of size 2^( 3) =       0.000440095657
  error estimate for blocks of size 2^( 4) =       0.000453764624
  error estimate for blocks of size 2^( 5) =       0.000465868320
  error estimate for blocks of size 2^( 6) =       0.000472732661
  error estimate for blocks of size 2^( 7) =       0.000478649945

      target function =                  N/A
              le_mean =     -16.905597464653
             les_mean =     286.140350092602
             stat err =       0.000467753888
             autocorr =       1.282778682271
              std dev =       0.584058752430
             le_variance =       0.341124626290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905597464653        initial  <--
     2.3842e+17     2.3842e+18             0.0000e+00       -16.905597464653
     9.5367e+17     9.5367e+18             0.0000e+00       -16.905597464653
     3.8147e+18     3.8147e+19             0.0000e+00       -16.905597464653

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.7650
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9037
    reference variance = 0.229981
====================================================
  Execution time = 3.5899e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4327e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343205036718
                                         uncertainty =       0.004606674906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343205036718
                                         uncertainty =       0.004606674906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414289018
  error estimate for blocks of size 2^( 2) =       0.000427180814
  error estimate for blocks of size 2^( 3) =       0.000440647956
  error estimate for blocks of size 2^( 4) =       0.000453268185
  error estimate for blocks of size 2^( 5) =       0.000463908778
  error estimate for blocks of size 2^( 6) =       0.000472699544
  error estimate for blocks of size 2^( 7) =       0.000478104827

      target function =                  N/A
              le_mean =     -16.906506572313
             les_mean =     286.173235088318
             stat err =       0.000466995334
             autocorr =       1.270627470007
              std dev =       0.585893147492
             le_variance =       0.343270780278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650657231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506572313       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506572313       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906506572313       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+18 is 2.180951e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506572313       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506572313       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906506572313       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 5.452378e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506572313       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506572313       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5095e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8403
    reference variance = 0.352601
====================================================
  Execution time = 3.3512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3814e-01
  Total weights = 2.0000e+06
  Execution time = 3.1438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156279173
                                         uncertainty =       0.003690858540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156279173
                                         uncertainty =       0.003690858540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411180497
  error estimate for blocks of size 2^( 2) =       0.000423723880
  error estimate for blocks of size 2^( 3) =       0.000436522755
  error estimate for blocks of size 2^( 4) =       0.000448530274
  error estimate for blocks of size 2^( 5) =       0.000459299650
  error estimate for blocks of size 2^( 6) =       0.000468152149
  error estimate for blocks of size 2^( 7) =       0.000472714460

      target function =                  N/A
              le_mean =     -16.905532388505
             les_mean =     286.135163971381
             stat err =       0.000462174133
             autocorr =       1.263415664647
              std dev =       0.581497034953
             le_variance =       0.338138801659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156279173
                                         uncertainty =       0.003690858540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156279173
                                         uncertainty =       0.003690858540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411180497
  error estimate for blocks of size 2^( 2) =       0.000423723880
  error estimate for blocks of size 2^( 3) =       0.000436522755
  error estimate for blocks of size 2^( 4) =       0.000448530274
  error estimate for blocks of size 2^( 5) =       0.000459299650
  error estimate for blocks of size 2^( 6) =       0.000468152149
  error estimate for blocks of size 2^( 7) =       0.000472714460

      target function =                  N/A
              le_mean =     -16.905532388505
             les_mean =     286.135163971381
             stat err =       0.000462174133
             autocorr =       1.263415664647
              std dev =       0.581497034953
             le_variance =       0.338138801659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156279173
                                         uncertainty =       0.003690858540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156279173
                                         uncertainty =       0.003690858540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411180497
  error estimate for blocks of size 2^( 2) =       0.000423723880
  error estimate for blocks of size 2^( 3) =       0.000436522755
  error estimate for blocks of size 2^( 4) =       0.000448530274
  error estimate for blocks of size 2^( 5) =       0.000459299650
  error estimate for blocks of size 2^( 6) =       0.000468152149
  error estimate for blocks of size 2^( 7) =       0.000472714460

      target function =                  N/A
              le_mean =     -16.905532388505
             les_mean =     286.135163971381
             stat err =       0.000462174133
             autocorr =       1.263415664647
              std dev =       0.581497034953
             le_variance =       0.338138801659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156279173
                                         uncertainty =       0.003690858540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156279173
                                         uncertainty =       0.003690858540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411180497
  error estimate for blocks of size 2^( 2) =       0.000423723880
  error estimate for blocks of size 2^( 3) =       0.000436522755
  error estimate for blocks of size 2^( 4) =       0.000448530274
  error estimate for blocks of size 2^( 5) =       0.000459299650
  error estimate for blocks of size 2^( 6) =       0.000468152149
  error estimate for blocks of size 2^( 7) =       0.000472714460

      target function =                  N/A
              le_mean =     -16.905532388505
             les_mean =     286.135163971381
             stat err =       0.000462174133
             autocorr =       1.263415664647
              std dev =       0.581497034953
             le_variance =       0.338138801659


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905532388505        initial  <--
     2.3842e+18     2.3842e+19             2.1810e-23       -16.905532388505
     9.5367e+18     9.5367e+19             5.4524e-24       -16.905532388505
     3.8147e+19     3.8147e+20             0.0000e+00       -16.905532388505

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.3672
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9287
    reference variance = 0.300093
====================================================
  Execution time = 3.4404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3931e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339363751191
                                         uncertainty =       0.003416237937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339363751191
                                         uncertainty =       0.003416237937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411892058
  error estimate for blocks of size 2^( 2) =       0.000424755121
  error estimate for blocks of size 2^( 3) =       0.000437373345
  error estimate for blocks of size 2^( 4) =       0.000448879392
  error estimate for blocks of size 2^( 5) =       0.000459398648
  error estimate for blocks of size 2^( 6) =       0.000467092595
  error estimate for blocks of size 2^( 7) =       0.000470055974

      target function =                  N/A
              le_mean =     -16.906512432712
             les_mean =     286.169472602639
             stat err =       0.000461356652
             autocorr =       1.254604203379
              std dev =       0.582503334632
             le_variance =       0.339310134857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690651243271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906512432712       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906512432712       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906512432712       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906512432712       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906512432712       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906512432712       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243283 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3698e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9886
    reference variance = 0.42102
====================================================
  Execution time = 3.3510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4915e-01
  Total weights = 2.0000e+06
  Execution time = 3.1507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117806320
                                         uncertainty =       0.005685286900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117806320
                                         uncertainty =       0.005685286900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417821934
  error estimate for blocks of size 2^( 2) =       0.000430562323
  error estimate for blocks of size 2^( 3) =       0.000444111371
  error estimate for blocks of size 2^( 4) =       0.000456649022
  error estimate for blocks of size 2^( 5) =       0.000468750488
  error estimate for blocks of size 2^( 6) =       0.000477133944
  error estimate for blocks of size 2^( 7) =       0.000481807677

      target function =                  N/A
              le_mean =     -16.905199489601
             les_mean =     286.134919945783
             stat err =       0.000471085283
             autocorr =       1.271207958873
              std dev =       0.590889445803
             le_variance =       0.349150337161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117806320
                                         uncertainty =       0.005685286900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117806320
                                         uncertainty =       0.005685286900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417821934
  error estimate for blocks of size 2^( 2) =       0.000430562323
  error estimate for blocks of size 2^( 3) =       0.000444111371
  error estimate for blocks of size 2^( 4) =       0.000456649022
  error estimate for blocks of size 2^( 5) =       0.000468750488
  error estimate for blocks of size 2^( 6) =       0.000477133944
  error estimate for blocks of size 2^( 7) =       0.000481807677

      target function =                  N/A
              le_mean =     -16.905199489601
             les_mean =     286.134919945783
             stat err =       0.000471085283
             autocorr =       1.271207958873
              std dev =       0.590889445803
             le_variance =       0.349150337161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117806320
                                         uncertainty =       0.005685286900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117806320
                                         uncertainty =       0.005685286900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417821934
  error estimate for blocks of size 2^( 2) =       0.000430562323
  error estimate for blocks of size 2^( 3) =       0.000444111371
  error estimate for blocks of size 2^( 4) =       0.000456649022
  error estimate for blocks of size 2^( 5) =       0.000468750488
  error estimate for blocks of size 2^( 6) =       0.000477133944
  error estimate for blocks of size 2^( 7) =       0.000481807677

      target function =                  N/A
              le_mean =     -16.905199489601
             les_mean =     286.134919945783
             stat err =       0.000471085283
             autocorr =       1.271207958873
              std dev =       0.590889445803
             le_variance =       0.349150337161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117806320
                                         uncertainty =       0.005685286900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117806320
                                         uncertainty =       0.005685286900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417821934
  error estimate for blocks of size 2^( 2) =       0.000430562323
  error estimate for blocks of size 2^( 3) =       0.000444111371
  error estimate for blocks of size 2^( 4) =       0.000456649022
  error estimate for blocks of size 2^( 5) =       0.000468750488
  error estimate for blocks of size 2^( 6) =       0.000477133944
  error estimate for blocks of size 2^( 7) =       0.000481807677

      target function =                  N/A
              le_mean =     -16.905199489601
             les_mean =     286.134919945783
             stat err =       0.000471085283
             autocorr =       1.271207958873
              std dev =       0.590889445803
             le_variance =       0.349150337161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905199489601        initial  <--
     2.3842e+19     2.3842e+20             0.0000e+00       -16.905199489601
     9.5367e+19     9.5367e+20             0.0000e+00       -16.905199489601
     3.8147e+20     3.8147e+21             0.0000e+00       -16.905199489601

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.3796
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3082e+01 secs
  Total Execution time = 3.7702e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
