Rank =    0  Free Memory = 84680 MB
Rank =    1  Free Memory = 84680 MB
Rank =    2  Free Memory = 84680 MB
Rank =    3  Free Memory = 84680 MB
Rank =    4  Free Memory = 84679 MB
Rank =    5  Free Memory = 84678 MB
Rank =    6  Free Memory = 84678 MB
Rank =    7  Free Memory = 84678 MB
Rank =    8  Free Memory = 84678 MB
Rank =    9  Free Memory = 84677 MB
Rank =   10  Free Memory = 84677 MB
Rank =   11  Free Memory = 84677 MB
Rank =   12  Free Memory = 84677 MB
Rank =   13  Free Memory = 84677 MB
Rank =   14  Free Memory = 84677 MB
Rank =   15  Free Memory = 84665 MB
Rank =   16  Free Memory = 84665 MB
Rank =   17  Free Memory = 84665 MB
Rank =   18  Free Memory = 84665 MB
Rank =   19  Free Memory = 84665 MB
Rank =   20  Free Memory = 84665 MB
Rank =   21  Free Memory = 84665 MB
Rank =   22  Free Memory = 84665 MB
Rank =   23  Free Memory = 84665 MB
Rank =   24  Free Memory = 84665 MB
Rank =   25  Free Memory = 84665 MB
Rank =   26  Free Memory = 84665 MB
Rank =   27  Free Memory = 84665 MB
Rank =   28  Free Memory = 84664 MB
Rank =   29  Free Memory = 84664 MB
Rank =   30  Free Memory = 84664 MB
Rank =   31  Free Memory = 84664 MB
Rank =   32  Free Memory = 84347 MB
Rank =   33  Free Memory = 84347 MB
Rank =   34  Free Memory = 84347 MB
Rank =   35  Free Memory = 84347 MB
Rank =   36  Free Memory = 84347 MB
Rank =   37  Free Memory = 84347 MB
Rank =   38  Free Memory = 84347 MB
Rank =   39  Free Memory = 84347 MB
Rank =   40  Free Memory = 84347 MB
Rank =   41  Free Memory = 84347 MB
Rank =   42  Free Memory = 84347 MB
Rank =   43  Free Memory = 84347 MB
Rank =   44  Free Memory = 84347 MB
Rank =   45  Free Memory = 84347 MB
Rank =   46  Free Memory = 84347 MB
Rank =   47  Free Memory = 84347 MB
Rank =   48  Free Memory = 84347 MB
Rank =   49  Free Memory = 84347 MB
Rank =   50  Free Memory = 84347 MB
Rank =   51  Free Memory = 84347 MB
Rank =   52  Free Memory = 84347 MB
Rank =   53  Free Memory = 84347 MB
Rank =   54  Free Memory = 84347 MB
Rank =   55  Free Memory = 84347 MB
Rank =   56  Free Memory = 84347 MB
Rank =   57  Free Memory = 84347 MB
Rank =   58  Free Memory = 84347 MB
Rank =   59  Free Memory = 84347 MB
Rank =   60  Free Memory = 84347 MB
Rank =   61  Free Memory = 84347 MB
Rank =   62  Free Memory = 84347 MB
Rank =   63  Free Memory = 84347 MB
Rank =   64  Free Memory = 90050 MB
Rank =   65  Free Memory = 90050 MB
Rank =   66  Free Memory = 90050 MB
Rank =   67  Free Memory = 90050 MB
Rank =   68  Free Memory = 90050 MB
Rank =   69  Free Memory = 90050 MB
Rank =   70  Free Memory = 90050 MB
Rank =   71  Free Memory = 90050 MB
Rank =   72  Free Memory = 90050 MB
Rank =   73  Free Memory = 90049 MB
Rank =   74  Free Memory = 90049 MB
Rank =   75  Free Memory = 90049 MB
Rank =   76  Free Memory = 90049 MB
Rank =   77  Free Memory = 90049 MB
Rank =   78  Free Memory = 90049 MB
Rank =   79  Free Memory = 90049 MB
Rank =   80  Free Memory = 90049 MB
Rank =   81  Free Memory = 90049 MB
Rank =   82  Free Memory = 90049 MB
Rank =   83  Free Memory = 90049 MB
Rank =   84  Free Memory = 90049 MB
Rank =   85  Free Memory = 90049 MB
Rank =   86  Free Memory = 90049 MB
Rank =   87  Free Memory = 90049 MB
Rank =   88  Free Memory = 90049 MB
Rank =   89  Free Memory = 90049 MB
Rank =   90  Free Memory = 90049 MB
Rank =   91  Free Memory = 90049 MB
Rank =   92  Free Memory = 90049 MB
Rank =   93  Free Memory = 90049 MB
Rank =   94  Free Memory = 90049 MB
Rank =   95  Free Memory = 90049 MB
Rank =   96  Free Memory = 84566 MB
Rank =   97  Free Memory = 84566 MB
Rank =   98  Free Memory = 84566 MB
Rank =   99  Free Memory = 84566 MB
Rank =  100  Free Memory = 84565 MB
Rank =  101  Free Memory = 84565 MB
Rank =  102  Free Memory = 84565 MB
Rank =  103  Free Memory = 84565 MB
Rank =  104  Free Memory = 84565 MB
Rank =  105  Free Memory = 84565 MB
Rank =  106  Free Memory = 84565 MB
Rank =  107  Free Memory = 84565 MB
Rank =  108  Free Memory = 84565 MB
Rank =  109  Free Memory = 84565 MB
Rank =  110  Free Memory = 84565 MB
Rank =  111  Free Memory = 84565 MB
Rank =  112  Free Memory = 84565 MB
Rank =  113  Free Memory = 84565 MB
Rank =  114  Free Memory = 84564 MB
Rank =  115  Free Memory = 84564 MB
Rank =  116  Free Memory = 84564 MB
Rank =  117  Free Memory = 84564 MB
Rank =  118  Free Memory = 84564 MB
Rank =  119  Free Memory = 84564 MB
Rank =  120  Free Memory = 84564 MB
Rank =  121  Free Memory = 84564 MB
Rank =  122  Free Memory = 84564 MB
Rank =  123  Free Memory = 84564 MB
Rank =  124  Free Memory = 84564 MB
Rank =  125  Free Memory = 84564 MB
Rank =  126  Free Memory = 84564 MB
Rank =  127  Free Memory = 84564 MB
  Input file(s): opt_h2o_1b1_gvptt_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run001d.xml

  Project = H2O
  date    = 2023-03-03 17:39:51 PST
  host    = n0120.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 359

  Range of prime numbers to use as seeds over processors and threads = 2437-3499


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.061255e-01    1         1  ON     0
     uu_1                 1.401879e-01    1         1  ON     1
     uu_2                 3.931336e-02    1         1  ON     2
     uu_3                -2.177256e-02    1         1  ON     3
     uu_4                -6.509318e-02    1         1  ON     4
     uu_5                -9.722250e-02    1         1  ON     5
     uu_6                -1.225928e-01    1         1  ON     6
     uu_7                -1.336857e-01    1         1  ON     7
     uu_8                -1.237559e-01    1         1  ON     8
     uu_9                -9.270349e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.373969e-01    1         1  ON     0
     ud_1                 1.739203e-01    1         1  ON     1
     ud_2                 5.807385e-02    1         1  ON     2
     ud_3                -9.878417e-03    1         1  ON     3
     ud_4                -6.606243e-02    1         1  ON     4
     ud_5                -1.062732e-01    1         1  ON     5
     ud_6                -1.324187e-01    1         1  ON     6
     ud_7                -1.474633e-01    1         1  ON     7
     ud_8                -1.480275e-01    1         1  ON     8
     ud_9                -1.348801e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.451167e-01    1         1  ON     0
     eO_1                -4.293914e-01    1         1  ON     1
     eO_2                -1.740982e-02    1         1  ON     2
     eO_3                 2.937061e-01    1         1  ON     3
     eO_4                 5.100005e-01    1         1  ON     4
     eO_5                 4.657192e-01    1         1  ON     5
     eO_6                 2.379491e-01    1         1  ON     6
     eO_7                -5.379792e-02    1         1  ON     7
     eO_8                -2.014651e-01    1         1  ON     8
     eO_9                -6.249137e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.295776e-01    1         1  ON     0
     eH1_1                -1.328394e-01    1         1  ON     1
     eH1_2                -8.836656e-02    1         1  ON     2
     eH1_3                -3.579943e-02    1         1  ON     3
     eH1_4                 1.148869e-02    1         1  ON     4
     eH1_5                 4.493843e-02    1         1  ON     5
     eH1_6                 9.811544e-02    1         1  ON     6
     eH1_7                 1.427584e-01    1         1  ON     7
     eH1_8                 1.535413e-01    1         1  ON     8
     eH1_9                 3.976692e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.276247e-01    1         1  ON     0
     eH2_1                -1.316652e-01    1         1  ON     1
     eH2_2                -8.697796e-02    1         1  ON     2
     eH2_3                -3.441158e-02    1         1  ON     3
     eH2_4                 1.344332e-02    1         1  ON     4
     eH2_5                 4.777088e-02    1         1  ON     5
     eH2_6                 1.022765e-01    1         1  ON     6
     eH2_7                 1.499910e-01    1         1  ON     7
     eH2_8                 1.620639e-01    1         1  ON     8
     eH2_9                 2.279057e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.626006e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.8094e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8689
    reference variance = 0.304021
====================================================
  Execution time = 2.1558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536500254
                                         uncertainty =       0.004366120968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536500254
                                         uncertainty =       0.004366120968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409614060
  error estimate for blocks of size 2^( 2) =       0.000422181173
  error estimate for blocks of size 2^( 3) =       0.000435042821
  error estimate for blocks of size 2^( 4) =       0.000446497675
  error estimate for blocks of size 2^( 5) =       0.000456361743
  error estimate for blocks of size 2^( 6) =       0.000460711825
  error estimate for blocks of size 2^( 7) =       0.000465007668

      target function =                  N/A
              le_mean =     -16.906361294162
             les_mean =     286.160619396652
             stat err =       0.000457144728
             autocorr =       1.245540119536
              std dev =       0.579281758464
             le_variance =       0.335567355689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690636129416e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361294162       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906374003348       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906381974056       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906380408886       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906380929669       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906385653076       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906385888497       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906385897718       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906385581729       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906386562734       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906386972500       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906386645591       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.249920e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361294162       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906366220075       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906369802705       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906369675824       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906369275141       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906369973779       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906370279690       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906370532309       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906370598837       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906370556947       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 7.405511e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361294162       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362722106       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363858674       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363899792       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906363807801       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906363903347       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906363845191       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906363987446       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906363989192       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 2.273010e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7088e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.061048e-01                 1 1 ON  0
uu_1  1.401338e-01                 1 1 ON  1
uu_2  3.942006e-02                 1 1 ON  2
uu_3  -2.164848e-02                1 1 ON  3
uu_4  -6.490494e-02                1 1 ON  4
uu_5  -9.718459e-02                1 1 ON  5
uu_6  -1.224532e-01                1 1 ON  6
uu_7  -1.338486e-01                1 1 ON  7
uu_8  -1.240577e-01                1 1 ON  8
uu_9  -9.289298e-02                1 1 ON  9
ud_0  4.381165e-01                 1 1 ON  10
ud_1  1.746608e-01                 1 1 ON  11
ud_2  5.789124e-02                 1 1 ON  12
ud_3  -1.022621e-02                1 1 ON  13
ud_4  -6.617029e-02                1 1 ON  14
ud_5  -1.064181e-01                1 1 ON  15
ud_6  -1.324491e-01                1 1 ON  16
ud_7  -1.475889e-01                1 1 ON  17
ud_8  -1.482910e-01                1 1 ON  18
ud_9  -1.351176e-01                1 1 ON  19
eO_0  -7.457674e-01                1 1 ON  20
eO_1  -4.295809e-01                1 1 ON  21
eO_2  -1.719032e-02                1 1 ON  22
eO_3  2.942399e-01                 1 1 ON  23
eO_4  5.101826e-01                 1 1 ON  24
eO_5  4.658346e-01                 1 1 ON  25
eO_6  2.381794e-01                 1 1 ON  26
eO_7  -5.381420e-02                1 1 ON  27
eO_8  -2.017352e-01                1 1 ON  28
eO_9  -6.263055e-02                1 1 ON  29
eH1_0 -2.300625e-01                1 1 ON  30
eH1_1 -1.330051e-01                1 1 ON  31
eH1_2 -8.834697e-02                1 1 ON  32
eH1_3 -3.576392e-02                1 1 ON  33
eH1_4 1.158190e-02                 1 1 ON  34
eH1_5 4.494640e-02                 1 1 ON  35
eH1_6 9.819333e-02                 1 1 ON  36
eH1_7 1.429238e-01                 1 1 ON  37
eH1_8 1.537151e-01                 1 1 ON  38
eH1_9 3.987016e-02                 1 1 ON  39
eH2_0 -2.280121e-01                1 1 ON  40
eH2_1 -1.318526e-01                1 1 ON  41
eH2_2 -8.690639e-02                1 1 ON  42
eH2_3 -3.426758e-02                1 1 ON  43
eH2_4 1.359565e-02                 1 1 ON  44
eH2_5 4.784809e-02                 1 1 ON  45
eH2_6 1.022000e-01                 1 1 ON  46
eH2_7 1.499175e-01                 1 1 ON  47
eH2_8 1.621494e-01                 1 1 ON  48
eH2_9 2.298095e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9221
    reference variance = 0.27996
====================================================
  Execution time = 2.1005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4538e-01
  Total weights = 2.0000e+06
  Execution time = 1.9120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344952980044
                                         uncertainty =       0.006010779450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344952980044
                                         uncertainty =       0.006010779450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415354358
  error estimate for blocks of size 2^( 2) =       0.000427831609
  error estimate for blocks of size 2^( 3) =       0.000440300056
  error estimate for blocks of size 2^( 4) =       0.000451898620
  error estimate for blocks of size 2^( 5) =       0.000461228761
  error estimate for blocks of size 2^( 6) =       0.000468799179
  error estimate for blocks of size 2^( 7) =       0.000471655585

      target function =                  N/A
              le_mean =     -16.906031521530
             les_mean =     286.158940119555
             stat err =       0.000463395536
             autocorr =       1.244704184033
              std dev =       0.587399766020
             le_variance =       0.345038485120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346053912138
                                         uncertainty =       0.006016722954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346053912138
                                         uncertainty =       0.006016722954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416017319
  error estimate for blocks of size 2^( 2) =       0.000428427170
  error estimate for blocks of size 2^( 3) =       0.000440815517
  error estimate for blocks of size 2^( 4) =       0.000452365839
  error estimate for blocks of size 2^( 5) =       0.000461672869
  error estimate for blocks of size 2^( 6) =       0.000469192450
  error estimate for blocks of size 2^( 7) =       0.000472025629

      target function =                  N/A
              le_mean =     -16.906037015146
             les_mean =     286.160228203464
             stat err =       0.000463814197
             autocorr =       1.242983185979
              std dev =       0.588337334386
             le_variance =       0.346140819032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345662039912
                                         uncertainty =       0.006011135675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345662039912
                                         uncertainty =       0.006011135675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415781498
  error estimate for blocks of size 2^( 2) =       0.000428209049
  error estimate for blocks of size 2^( 3) =       0.000440617208
  error estimate for blocks of size 2^( 4) =       0.000452180420
  error estimate for blocks of size 2^( 5) =       0.000461495790
  error estimate for blocks of size 2^( 6) =       0.000469021075
  error estimate for blocks of size 2^( 7) =       0.000471852892

      target function =                  N/A
              le_mean =     -16.906033645294
             les_mean =     286.159721951084
             stat err =       0.000463637544
             autocorr =       1.243445841505
              std dev =       0.588003833452
             le_variance =       0.345748508154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345038042706
                                         uncertainty =       0.006010352418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345038042706
                                         uncertainty =       0.006010352418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415405633
  error estimate for blocks of size 2^( 2) =       0.000427875289
  error estimate for blocks of size 2^( 3) =       0.000440334574
  error estimate for blocks of size 2^( 4) =       0.000451927781
  error estimate for blocks of size 2^( 5) =       0.000461255869
  error estimate for blocks of size 2^( 6) =       0.000468819132
  error estimate for blocks of size 2^( 7) =       0.000471671409

      target function =                  N/A
              le_mean =     -16.906030614868
             les_mean =     286.158994658603
             stat err =       0.000463418548
             autocorr =       1.244520516273
              std dev =       0.587472280449
             le_variance =       0.345123680296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906031521530        initial
     2.5000e-01     2.5000e+00             2.2499e-03       -16.906037015146  <--
     1.0000e+00     1.0000e+01             7.4055e-04       -16.906033645294
     4.0000e+00     4.0000e+01             2.2730e-04       -16.906030614868

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0554e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.062213e-01 1 1  ON 0
 uu_1                 1.402183e-01 1 1  ON 1
 uu_2                 3.964408e-02 1 1  ON 2
 uu_3                -2.139844e-02 1 1  ON 3
 uu_4                -6.460061e-02 1 1  ON 4
 uu_5                -9.703475e-02 1 1  ON 5
 uu_6                -1.222689e-01 1 1  ON 6
 uu_7                -1.342079e-01 1 1  ON 7
 uu_8                -1.248343e-01 1 1  ON 8
 uu_9                -9.345758e-02 1 1  ON 9
 ud_0                 4.396468e-01 1 1  ON 10
 ud_1                 1.758257e-01 1 1  ON 11
 ud_2                 5.797714e-02 1 1  ON 12
 ud_3                -1.071956e-02 1 1  ON 13
 ud_4                -6.648044e-02 1 1  ON 14
 ud_5                -1.067146e-01 1 1  ON 15
 ud_6                -1.325534e-01 1 1  ON 16
 ud_7                -1.478314e-01 1 1  ON 17
 ud_8                -1.488964e-01 1 1  ON 18
 ud_9                -1.357820e-01 1 1  ON 19
 eO_0                -7.471537e-01 1 1  ON 20
 eO_1                -4.301052e-01 1 1  ON 21
 eO_2                -1.689322e-02 1 1  ON 22
 eO_3                 2.952561e-01 1 1  ON 23
 eO_4                 5.108577e-01 1 1  ON 24
 eO_5                 4.663123e-01 1 1  ON 25
 eO_6                 2.388657e-01 1 1  ON 26
 eO_7                -5.380426e-02 1 1  ON 27
 eO_8                -2.025194e-01 1 1  ON 28
 eO_9                -6.305087e-02 1 1  ON 29
eH1_0                -2.312566e-01 1 1  ON 30
eH1_1                -1.334565e-01 1 1  ON 31
eH1_2                -8.842519e-02 1 1  ON 32
eH1_3                -3.573300e-02 1 1  ON 33
eH1_4                 1.170879e-02 1 1  ON 34
eH1_5                 4.497380e-02 1 1  ON 35
eH1_6                 9.844803e-02 1 1  ON 36
eH1_7                 1.434188e-01 1 1  ON 37
eH1_8                 1.542567e-01 1 1  ON 38
eH1_9                 4.019479e-02 1 1  ON 39
eH2_0                -2.289774e-01 1 1  ON 40
eH2_1                -1.322584e-01 1 1  ON 41
eH2_2                -8.682306e-02 1 1  ON 42
eH2_3                -3.398580e-02 1 1  ON 43
eH2_4                 1.391511e-02 1 1  ON 44
eH2_5                 4.803327e-02 1 1  ON 45
eH2_6                 1.020425e-01 1 1  ON 46
eH2_7                 1.497218e-01 1 1  ON 47
eH2_8                 1.624133e-01 1 1  ON 48
eH2_9                 2.355996e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.935
    reference variance = 0.281499
====================================================
  Execution time = 2.0988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4176e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341862218730
                                         uncertainty =       0.004930263828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341862218730
                                         uncertainty =       0.004930263828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413375142
  error estimate for blocks of size 2^( 2) =       0.000425598280
  error estimate for blocks of size 2^( 3) =       0.000439391900
  error estimate for blocks of size 2^( 4) =       0.000452770375
  error estimate for blocks of size 2^( 5) =       0.000464146157
  error estimate for blocks of size 2^( 6) =       0.000472592498
  error estimate for blocks of size 2^( 7) =       0.000478326639

      target function =                  N/A
              le_mean =     -16.906473297564
             les_mean =     286.170597207002
             stat err =       0.000466958917
             autocorr =       1.276052760480
              std dev =       0.584600732678
             le_variance =       0.341758016648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647329756e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906473297564       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906477462387       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906475918013       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906476453677       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906481153429       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906484496101       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906482705949       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906483406442       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906485266203       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906486411068       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906486953310       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906486231081       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906486331443       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906486595055       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906486653040       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.115471e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906473297564       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906475727128       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906474425331       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906475668180       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906477355542       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906478369963       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906478158507       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906477508544       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906477938424       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906478202279       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906478243711       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.448375e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906473297564       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906474208677       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906473612391       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906474388348       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906474671024       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906474726736       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906474933019       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906474714371       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906474786537       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.031446e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060510 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6559e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.062970e-01 1 1  ON 0
 uu_1                 1.405395e-01 1 1  ON 1
 uu_2                 4.001413e-02 1 1  ON 2
 uu_3                -2.101190e-02 1 1  ON 3
 uu_4                -6.465697e-02 1 1  ON 4
 uu_5                -9.715786e-02 1 1  ON 5
 uu_6                -1.226989e-01 1 1  ON 6
 uu_7                -1.342159e-01 1 1  ON 7
 uu_8                -1.254723e-01 1 1  ON 8
 uu_9                -9.409813e-02 1 1  ON 9
 ud_0                 4.410219e-01 1 1  ON 10
 ud_1                 1.764083e-01 1 1  ON 11
 ud_2                 5.790775e-02 1 1  ON 12
 ud_3                -1.125632e-02 1 1  ON 13
 ud_4                -6.684532e-02 1 1  ON 14
 ud_5                -1.068627e-01 1 1  ON 15
 ud_6                -1.328617e-01 1 1  ON 16
 ud_7                -1.480911e-01 1 1  ON 17
 ud_8                -1.492258e-01 1 1  ON 18
 ud_9                -1.360268e-01 1 1  ON 19
 eO_0                -7.486021e-01 1 1  ON 20
 eO_1                -4.308926e-01 1 1  ON 21
 eO_2                -1.667640e-02 1 1  ON 22
 eO_3                 2.958353e-01 1 1  ON 23
 eO_4                 5.117059e-01 1 1  ON 24
 eO_5                 4.674092e-01 1 1  ON 25
 eO_6                 2.393619e-01 1 1  ON 26
 eO_7                -5.360854e-02 1 1  ON 27
 eO_8                -2.031765e-01 1 1  ON 28
 eO_9                -6.356882e-02 1 1  ON 29
eH1_0                -2.325162e-01 1 1  ON 30
eH1_1                -1.340663e-01 1 1  ON 31
eH1_2                -8.857662e-02 1 1  ON 32
eH1_3                -3.584675e-02 1 1  ON 33
eH1_4                 1.159983e-02 1 1  ON 34
eH1_5                 4.526282e-02 1 1  ON 35
eH1_6                 9.861638e-02 1 1  ON 36
eH1_7                 1.437267e-01 1 1  ON 37
eH1_8                 1.549629e-01 1 1  ON 38
eH1_9                 4.091145e-02 1 1  ON 39
eH2_0                -2.300801e-01 1 1  ON 40
eH2_1                -1.324581e-01 1 1  ON 41
eH2_2                -8.685856e-02 1 1  ON 42
eH2_3                -3.400109e-02 1 1  ON 43
eH2_4                 1.385291e-02 1 1  ON 44
eH2_5                 4.812481e-02 1 1  ON 45
eH2_6                 1.020438e-01 1 1  ON 46
eH2_7                 1.498596e-01 1 1  ON 47
eH2_8                 1.627353e-01 1 1  ON 48
eH2_9                 2.430729e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9321
    reference variance = 0.147826
====================================================
  Execution time = 2.0141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3600e-01
  Total weights = 2.0000e+06
  Execution time = 1.9066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334968631896
                                         uncertainty =       0.003044900161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334968631896
                                         uncertainty =       0.003044900161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409324536
  error estimate for blocks of size 2^( 2) =       0.000422101123
  error estimate for blocks of size 2^( 3) =       0.000435581537
  error estimate for blocks of size 2^( 4) =       0.000447511158
  error estimate for blocks of size 2^( 5) =       0.000458744319
  error estimate for blocks of size 2^( 6) =       0.000465956830
  error estimate for blocks of size 2^( 7) =       0.000472657055

      target function =                  N/A
              le_mean =     -16.906064936800
             les_mean =     286.150124631229
             stat err =       0.000461217341
             autocorr =       1.269625680190
              std dev =       0.578872310165
             le_variance =       0.335093151476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336687487266
                                         uncertainty =       0.003064262351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336687487266
                                         uncertainty =       0.003064262351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410372656
  error estimate for blocks of size 2^( 2) =       0.000423084081
  error estimate for blocks of size 2^( 3) =       0.000436481850
  error estimate for blocks of size 2^( 4) =       0.000448342207
  error estimate for blocks of size 2^( 5) =       0.000459521759
  error estimate for blocks of size 2^( 6) =       0.000466719667
  error estimate for blocks of size 2^( 7) =       0.000473384150

      target function =                  N/A
              le_mean =     -16.906062586678
             les_mean =     286.151763450259
             stat err =       0.000461991946
             autocorr =       1.267394966514
              std dev =       0.580354576102
             le_variance =       0.336811434003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336820029065
                                         uncertainty =       0.003066929548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336820029065
                                         uncertainty =       0.003066929548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410453101
  error estimate for blocks of size 2^( 2) =       0.000423158418
  error estimate for blocks of size 2^( 3) =       0.000436557258
  error estimate for blocks of size 2^( 4) =       0.000448424191
  error estimate for blocks of size 2^( 5) =       0.000459608931
  error estimate for blocks of size 2^( 6) =       0.000466813577
  error estimate for blocks of size 2^( 7) =       0.000473477885

      target function =                  N/A
              le_mean =     -16.906065474326
             les_mean =     286.151993149716
             stat err =       0.000462081146
             autocorr =       1.267387488230
              std dev =       0.580468341942
             le_variance =       0.336943495996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335312241772
                                         uncertainty =       0.003049147955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335312241772
                                         uncertainty =       0.003049147955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409534180
  error estimate for blocks of size 2^( 2) =       0.000422296091
  error estimate for blocks of size 2^( 3) =       0.000435760802
  error estimate for blocks of size 2^( 4) =       0.000447678476
  error estimate for blocks of size 2^( 5) =       0.000458902469
  error estimate for blocks of size 2^( 6) =       0.000466114548
  error estimate for blocks of size 2^( 7) =       0.000472808764

      target function =                  N/A
              le_mean =     -16.906063469715
             les_mean =     286.150418362856
             stat err =       0.000461376064
             autocorr =       1.269199266256
              std dev =       0.579168791057
             le_variance =       0.335436488534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906064936800        initial
     6.2500e-02     6.2500e-01             4.1155e-03       -16.906062586678
     2.5000e-01     2.5000e+00             1.4484e-03       -16.906065474326  <--
     1.0000e+00     1.0000e+01             5.0314e-04       -16.906063469715

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9869e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.062970e-01 1 1  ON 0
 uu_1                 1.405395e-01 1 1  ON 1
 uu_2                 4.001413e-02 1 1  ON 2
 uu_3                -2.101190e-02 1 1  ON 3
 uu_4                -6.465697e-02 1 1  ON 4
 uu_5                -9.715786e-02 1 1  ON 5
 uu_6                -1.226989e-01 1 1  ON 6
 uu_7                -1.342159e-01 1 1  ON 7
 uu_8                -1.254723e-01 1 1  ON 8
 uu_9                -9.409813e-02 1 1  ON 9
 ud_0                 4.410219e-01 1 1  ON 10
 ud_1                 1.764083e-01 1 1  ON 11
 ud_2                 5.790775e-02 1 1  ON 12
 ud_3                -1.125632e-02 1 1  ON 13
 ud_4                -6.684532e-02 1 1  ON 14
 ud_5                -1.068627e-01 1 1  ON 15
 ud_6                -1.328617e-01 1 1  ON 16
 ud_7                -1.480911e-01 1 1  ON 17
 ud_8                -1.492258e-01 1 1  ON 18
 ud_9                -1.360268e-01 1 1  ON 19
 eO_0                -7.486021e-01 1 1  ON 20
 eO_1                -4.308926e-01 1 1  ON 21
 eO_2                -1.667640e-02 1 1  ON 22
 eO_3                 2.958353e-01 1 1  ON 23
 eO_4                 5.117059e-01 1 1  ON 24
 eO_5                 4.674092e-01 1 1  ON 25
 eO_6                 2.393619e-01 1 1  ON 26
 eO_7                -5.360854e-02 1 1  ON 27
 eO_8                -2.031765e-01 1 1  ON 28
 eO_9                -6.356882e-02 1 1  ON 29
eH1_0                -2.325162e-01 1 1  ON 30
eH1_1                -1.340663e-01 1 1  ON 31
eH1_2                -8.857662e-02 1 1  ON 32
eH1_3                -3.584675e-02 1 1  ON 33
eH1_4                 1.159983e-02 1 1  ON 34
eH1_5                 4.526282e-02 1 1  ON 35
eH1_6                 9.861638e-02 1 1  ON 36
eH1_7                 1.437267e-01 1 1  ON 37
eH1_8                 1.549629e-01 1 1  ON 38
eH1_9                 4.091145e-02 1 1  ON 39
eH2_0                -2.300801e-01 1 1  ON 40
eH2_1                -1.324581e-01 1 1  ON 41
eH2_2                -8.685856e-02 1 1  ON 42
eH2_3                -3.400109e-02 1 1  ON 43
eH2_4                 1.385291e-02 1 1  ON 44
eH2_5                 4.812481e-02 1 1  ON 45
eH2_6                 1.020438e-01 1 1  ON 46
eH2_7                 1.498596e-01 1 1  ON 47
eH2_8                 1.627353e-01 1 1  ON 48
eH2_9                 2.430729e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6434e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8579
    reference variance = 0.221895
====================================================
  Execution time = 2.0606e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3394e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333969525050
                                         uncertainty =       0.002793820392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333969525050
                                         uncertainty =       0.002793820392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408619223
  error estimate for blocks of size 2^( 2) =       0.000421960072
  error estimate for blocks of size 2^( 3) =       0.000435851816
  error estimate for blocks of size 2^( 4) =       0.000448698545
  error estimate for blocks of size 2^( 5) =       0.000459538350
  error estimate for blocks of size 2^( 6) =       0.000467377624
  error estimate for blocks of size 2^( 7) =       0.000470039115

      target function =                  N/A
              le_mean =     -16.905516681624
             les_mean =     286.130433444336
             stat err =       0.000461413409
             autocorr =       1.275095857356
              std dev =       0.577874846865
             le_variance =       0.333939338639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690551668162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905516681624       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905516346615       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905517351280       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905516967390       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905520973140       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905524905933       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905529105968       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905529324955       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905530171588       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905530972277       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905531800695       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905530957950       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905531031720       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905530606198       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.359603e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905516681624       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905516476655       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905517095074       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905516535457       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905518715073       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905520184723       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905520982758       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905521038903       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905520908807       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905521171016       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905521116189       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.519451e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905516681624       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905516601328       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905516846624       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905516603914       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905517125116       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905517564246       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905517744565       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905517727554       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905517755920       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.537615e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6116e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.065640e-01 1 1  ON 0
 uu_1                 1.405246e-01 1 1  ON 1
 uu_2                 3.975408e-02 1 1  ON 2
 uu_3                -2.121881e-02 1 1  ON 3
 uu_4                -6.462765e-02 1 1  ON 4
 uu_5                -9.747199e-02 1 1  ON 5
 uu_6                -1.230367e-01 1 1  ON 6
 uu_7                -1.343096e-01 1 1  ON 7
 uu_8                -1.256506e-01 1 1  ON 8
 uu_9                -9.419072e-02 1 1  ON 9
 ud_0                 4.419598e-01 1 1  ON 10
 ud_1                 1.769621e-01 1 1  ON 11
 ud_2                 5.798277e-02 1 1  ON 12
 ud_3                -1.169761e-02 1 1  ON 13
 ud_4                -6.735296e-02 1 1  ON 14
 ud_5                -1.073083e-01 1 1  ON 15
 ud_6                -1.330254e-01 1 1  ON 16
 ud_7                -1.484471e-01 1 1  ON 17
 ud_8                -1.491046e-01 1 1  ON 18
 ud_9                -1.359108e-01 1 1  ON 19
 eO_0                -7.501216e-01 1 1  ON 20
 eO_1                -4.317068e-01 1 1  ON 21
 eO_2                -1.662425e-02 1 1  ON 22
 eO_3                 2.964542e-01 1 1  ON 23
 eO_4                 5.130404e-01 1 1  ON 24
 eO_5                 4.682414e-01 1 1  ON 25
 eO_6                 2.397221e-01 1 1  ON 26
 eO_7                -5.354095e-02 1 1  ON 27
 eO_8                -2.036296e-01 1 1  ON 28
 eO_9                -6.399978e-02 1 1  ON 29
eH1_0                -2.335519e-01 1 1  ON 30
eH1_1                -1.346880e-01 1 1  ON 31
eH1_2                -8.883778e-02 1 1  ON 32
eH1_3                -3.605507e-02 1 1  ON 33
eH1_4                 1.138338e-02 1 1  ON 34
eH1_5                 4.530265e-02 1 1  ON 35
eH1_6                 9.877581e-02 1 1  ON 36
eH1_7                 1.443740e-01 1 1  ON 37
eH1_8                 1.557659e-01 1 1  ON 38
eH1_9                 4.159868e-02 1 1  ON 39
eH2_0                -2.313062e-01 1 1  ON 40
eH2_1                -1.329624e-01 1 1  ON 41
eH2_2                -8.711211e-02 1 1  ON 42
eH2_3                -3.395424e-02 1 1  ON 43
eH2_4                 1.378012e-02 1 1  ON 44
eH2_5                 4.816793e-02 1 1  ON 45
eH2_6                 1.021081e-01 1 1  ON 46
eH2_7                 1.500091e-01 1 1  ON 47
eH2_8                 1.633469e-01 1 1  ON 48
eH2_9                 2.528715e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9149
    reference variance = 0.239056
====================================================
  Execution time = 2.0589e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3145e-01
  Total weights = 2.0000e+06
  Execution time = 1.8979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605339009
                                         uncertainty =       0.002774675506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605339009
                                         uncertainty =       0.002774675506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406616891
  error estimate for blocks of size 2^( 2) =       0.000419670579
  error estimate for blocks of size 2^( 3) =       0.000432850168
  error estimate for blocks of size 2^( 4) =       0.000445503155
  error estimate for blocks of size 2^( 5) =       0.000457223204
  error estimate for blocks of size 2^( 6) =       0.000464534858
  error estimate for blocks of size 2^( 7) =       0.000466971604

      target function =                  N/A
              le_mean =     -16.905831707370
             les_mean =     286.137820145101
             stat err =       0.000458558205
             autocorr =       1.271797908555
              std dev =       0.575043122307
             le_variance =       0.330674592512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332236683399
                                         uncertainty =       0.002784545424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332236683399
                                         uncertainty =       0.002784545424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407618809
  error estimate for blocks of size 2^( 2) =       0.000420630709
  error estimate for blocks of size 2^( 3) =       0.000433750248
  error estimate for blocks of size 2^( 4) =       0.000446354157
  error estimate for blocks of size 2^( 5) =       0.000458038778
  error estimate for blocks of size 2^( 6) =       0.000465297404
  error estimate for blocks of size 2^( 7) =       0.000467724158

      target function =                  N/A
              le_mean =     -16.905830865128
             les_mean =     286.139423260635
             stat err =       0.000459353624
             autocorr =       1.269947780316
              std dev =       0.576460047601
             le_variance =       0.332306186480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332172463887
                                         uncertainty =       0.002785021785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332172463887
                                         uncertainty =       0.002785021785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407579429
  error estimate for blocks of size 2^( 2) =       0.000420588969
  error estimate for blocks of size 2^( 3) =       0.000433710967
  error estimate for blocks of size 2^( 4) =       0.000446324212
  error estimate for blocks of size 2^( 5) =       0.000458020972
  error estimate for blocks of size 2^( 6) =       0.000465293717
  error estimate for blocks of size 2^( 7) =       0.000467721331

      target function =                  N/A
              le_mean =     -16.905829075486
             les_mean =     286.139298545049
             stat err =       0.000459340058
             autocorr =       1.270118168925
              std dev =       0.576404356009
             le_variance =       0.332241981626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330892847384
                                         uncertainty =       0.002776668372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330892847384
                                         uncertainty =       0.002776668372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406793661
  error estimate for blocks of size 2^( 2) =       0.000419837956
  error estimate for blocks of size 2^( 3) =       0.000433006048
  error estimate for blocks of size 2^( 4) =       0.000445651818
  error estimate for blocks of size 2^( 5) =       0.000457368337
  error estimate for blocks of size 2^( 6) =       0.000464673801
  error estimate for blocks of size 2^( 7) =       0.000467108476

      target function =                  N/A
              le_mean =     -16.905830151767
             les_mean =     286.138055119644
             stat err =       0.000458700608
             autocorr =       1.271482184386
              std dev =       0.575293112007
             le_variance =       0.330962164722


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905831707370        initial  <--
     6.2500e-02     6.2500e-01             4.3596e-03       -16.905830865128
     2.5000e-01     2.5000e+00             1.5195e-03       -16.905829075486
     1.0000e+00     1.0000e+01             4.5376e-04       -16.905830151767

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1558
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.062970e-01 1 1  ON 0
 uu_1                 1.405395e-01 1 1  ON 1
 uu_2                 4.001413e-02 1 1  ON 2
 uu_3                -2.101190e-02 1 1  ON 3
 uu_4                -6.465697e-02 1 1  ON 4
 uu_5                -9.715786e-02 1 1  ON 5
 uu_6                -1.226989e-01 1 1  ON 6
 uu_7                -1.342159e-01 1 1  ON 7
 uu_8                -1.254723e-01 1 1  ON 8
 uu_9                -9.409813e-02 1 1  ON 9
 ud_0                 4.410219e-01 1 1  ON 10
 ud_1                 1.764083e-01 1 1  ON 11
 ud_2                 5.790775e-02 1 1  ON 12
 ud_3                -1.125632e-02 1 1  ON 13
 ud_4                -6.684532e-02 1 1  ON 14
 ud_5                -1.068627e-01 1 1  ON 15
 ud_6                -1.328617e-01 1 1  ON 16
 ud_7                -1.480911e-01 1 1  ON 17
 ud_8                -1.492258e-01 1 1  ON 18
 ud_9                -1.360268e-01 1 1  ON 19
 eO_0                -7.486021e-01 1 1  ON 20
 eO_1                -4.308926e-01 1 1  ON 21
 eO_2                -1.667640e-02 1 1  ON 22
 eO_3                 2.958353e-01 1 1  ON 23
 eO_4                 5.117059e-01 1 1  ON 24
 eO_5                 4.674092e-01 1 1  ON 25
 eO_6                 2.393619e-01 1 1  ON 26
 eO_7                -5.360854e-02 1 1  ON 27
 eO_8                -2.031765e-01 1 1  ON 28
 eO_9                -6.356882e-02 1 1  ON 29
eH1_0                -2.325162e-01 1 1  ON 30
eH1_1                -1.340663e-01 1 1  ON 31
eH1_2                -8.857662e-02 1 1  ON 32
eH1_3                -3.584675e-02 1 1  ON 33
eH1_4                 1.159983e-02 1 1  ON 34
eH1_5                 4.526282e-02 1 1  ON 35
eH1_6                 9.861638e-02 1 1  ON 36
eH1_7                 1.437267e-01 1 1  ON 37
eH1_8                 1.549629e-01 1 1  ON 38
eH1_9                 4.091145e-02 1 1  ON 39
eH2_0                -2.300801e-01 1 1  ON 40
eH2_1                -1.324581e-01 1 1  ON 41
eH2_2                -8.685856e-02 1 1  ON 42
eH2_3                -3.400109e-02 1 1  ON 43
eH2_4                 1.385291e-02 1 1  ON 44
eH2_5                 4.812481e-02 1 1  ON 45
eH2_6                 1.020438e-01 1 1  ON 46
eH2_7                 1.498596e-01 1 1  ON 47
eH2_8                 1.627353e-01 1 1  ON 48
eH2_9                 2.430729e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9129
    reference variance = 0.252038
====================================================
  Execution time = 2.0592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334512860232
                                         uncertainty =       0.003527903318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334512860232
                                         uncertainty =       0.003527903318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408974014
  error estimate for blocks of size 2^( 2) =       0.000421905712
  error estimate for blocks of size 2^( 3) =       0.000435286029
  error estimate for blocks of size 2^( 4) =       0.000447067646
  error estimate for blocks of size 2^( 5) =       0.000458599344
  error estimate for blocks of size 2^( 6) =       0.000465677049
  error estimate for blocks of size 2^( 7) =       0.000471014786

      target function =                  N/A
              le_mean =     -16.905780035100
             les_mean =     286.139917916731
             stat err =       0.000460589706
             autocorr =       1.268343906243
              std dev =       0.578376597743
             le_variance =       0.334519488817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578003510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780035100       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905782671674       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905783781760       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905784290768       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905784280968       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905783493032       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905783830600       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905784163282       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905784424500       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.116151e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780035100       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780827609       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905781152897       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905781345840       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905781375715       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905781107956       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905781162177       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905781196571       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905781267926       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.630184e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780035100       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780243783       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780329665       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780383147       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780394106       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780322286       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780333102       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780338611       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.384040e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6190e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.063562e-01 1 1  ON 0
 uu_1                 1.405651e-01 1 1  ON 1
 uu_2                 4.002285e-02 1 1  ON 2
 uu_3                -2.100019e-02 1 1  ON 3
 uu_4                -6.462705e-02 1 1  ON 4
 uu_5                -9.714383e-02 1 1  ON 5
 uu_6                -1.227347e-01 1 1  ON 6
 uu_7                -1.342841e-01 1 1  ON 7
 uu_8                -1.255453e-01 1 1  ON 8
 uu_9                -9.415644e-02 1 1  ON 9
 ud_0                 4.411849e-01 1 1  ON 10
 ud_1                 1.764983e-01 1 1  ON 11
 ud_2                 5.793018e-02 1 1  ON 12
 ud_3                -1.131713e-02 1 1  ON 13
 ud_4                -6.691253e-02 1 1  ON 14
 ud_5                -1.068879e-01 1 1  ON 15
 ud_6                -1.328929e-01 1 1  ON 16
 ud_7                -1.481156e-01 1 1  ON 17
 ud_8                -1.492674e-01 1 1  ON 18
 ud_9                -1.360508e-01 1 1  ON 19
 eO_0                -7.487630e-01 1 1  ON 20
 eO_1                -4.309670e-01 1 1  ON 21
 eO_2                -1.666236e-02 1 1  ON 22
 eO_3                 2.959463e-01 1 1  ON 23
 eO_4                 5.118380e-01 1 1  ON 24
 eO_5                 4.674561e-01 1 1  ON 25
 eO_6                 2.394102e-01 1 1  ON 26
 eO_7                -5.359385e-02 1 1  ON 27
 eO_8                -2.032517e-01 1 1  ON 28
 eO_9                -6.362008e-02 1 1  ON 29
eH1_0                -2.326053e-01 1 1  ON 30
eH1_1                -1.341173e-01 1 1  ON 31
eH1_2                -8.858016e-02 1 1  ON 32
eH1_3                -3.582637e-02 1 1  ON 33
eH1_4                 1.156039e-02 1 1  ON 34
eH1_5                 4.524354e-02 1 1  ON 35
eH1_6                 9.863238e-02 1 1  ON 36
eH1_7                 1.437363e-01 1 1  ON 37
eH1_8                 1.550250e-01 1 1  ON 38
eH1_9                 4.099249e-02 1 1  ON 39
eH2_0                -2.302312e-01 1 1  ON 40
eH2_1                -1.325102e-01 1 1  ON 41
eH2_2                -8.686097e-02 1 1  ON 42
eH2_3                -3.397028e-02 1 1  ON 43
eH2_4                 1.386332e-02 1 1  ON 44
eH2_5                 4.810754e-02 1 1  ON 45
eH2_6                 1.020735e-01 1 1  ON 46
eH2_7                 1.498729e-01 1 1  ON 47
eH2_8                 1.627927e-01 1 1  ON 48
eH2_9                 2.438459e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.918
    reference variance = 0.282768
====================================================
  Execution time = 2.0424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3134e-01
  Total weights = 2.0000e+06
  Execution time = 1.8984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331266333195
                                         uncertainty =       0.002775430968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331266333195
                                         uncertainty =       0.002775430968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406959038
  error estimate for blocks of size 2^( 2) =       0.000420093626
  error estimate for blocks of size 2^( 3) =       0.000433624692
  error estimate for blocks of size 2^( 4) =       0.000447040702
  error estimate for blocks of size 2^( 5) =       0.000458488351
  error estimate for blocks of size 2^( 6) =       0.000468600087
  error estimate for blocks of size 2^( 7) =       0.000475049401

      target function =                  N/A
              le_mean =     -16.905996681718
             les_mean =     286.143954953963
             stat err =       0.000462294635
             autocorr =       1.290435526841
              std dev =       0.575526990944
             le_variance =       0.331231317305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331630612722
                                         uncertainty =       0.002779279342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331630612722
                                         uncertainty =       0.002779279342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407182820
  error estimate for blocks of size 2^( 2) =       0.000420303267
  error estimate for blocks of size 2^( 3) =       0.000433817796
  error estimate for blocks of size 2^( 4) =       0.000447216791
  error estimate for blocks of size 2^( 5) =       0.000458652564
  error estimate for blocks of size 2^( 6) =       0.000468756403
  error estimate for blocks of size 2^( 7) =       0.000475199143

      target function =                  N/A
              le_mean =     -16.905997519024
             les_mean =     286.144347646023
             stat err =       0.000462456225
             autocorr =       1.289918783995
              std dev =       0.575843467084
             le_variance =       0.331595698583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331488998041
                                         uncertainty =       0.002777813706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331488998041
                                         uncertainty =       0.002777813706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407095836
  error estimate for blocks of size 2^( 2) =       0.000420221843
  error estimate for blocks of size 2^( 3) =       0.000433742945
  error estimate for blocks of size 2^( 4) =       0.000447148897
  error estimate for blocks of size 2^( 5) =       0.000458589297
  error estimate for blocks of size 2^( 6) =       0.000468695807
  error estimate for blocks of size 2^( 7) =       0.000475141110

      target function =                  N/A
              le_mean =     -16.905996998231
             les_mean =     286.144188378620
             stat err =       0.000462393778
             autocorr =       1.290121584189
              std dev =       0.575720453141
             le_variance =       0.331454040165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331296126730
                                         uncertainty =       0.002775753424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331296126730
                                         uncertainty =       0.002775753424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406977345
  error estimate for blocks of size 2^( 2) =       0.000420110796
  error estimate for blocks of size 2^( 3) =       0.000433640543
  error estimate for blocks of size 2^( 4) =       0.000447055235
  error estimate for blocks of size 2^( 5) =       0.000458501926
  error estimate for blocks of size 2^( 6) =       0.000468612942
  error estimate for blocks of size 2^( 7) =       0.000475061733

      target function =                  N/A
              le_mean =     -16.905996708127
             les_mean =     286.143985648571
             stat err =       0.000462307959
             autocorr =       1.290393811383
              std dev =       0.575552881151
             le_variance =       0.331261119001


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905996681718        initial
     6.2500e-01     6.2500e+00             6.1162e-04       -16.905997519024  <--
     2.5000e+00     2.5000e+01             1.6302e-04       -16.905996998231
     1.0000e+01     1.0000e+02             4.3840e-05       -16.905996708127

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.3890e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.065153e-01 1 1  ON 0
 uu_1                 1.406456e-01 1 1  ON 1
 uu_2                 4.006712e-02 1 1  ON 2
 uu_3                -2.096846e-02 1 1  ON 3
 uu_4                -6.456468e-02 1 1  ON 4
 uu_5                -9.711320e-02 1 1  ON 5
 uu_6                -1.228167e-01 1 1  ON 6
 uu_7                -1.344705e-01 1 1  ON 7
 uu_8                -1.257603e-01 1 1  ON 8
 uu_9                -9.432889e-02 1 1  ON 9
 ud_0                 4.415745e-01 1 1  ON 10
 ud_1                 1.767347e-01 1 1  ON 11
 ud_2                 5.799945e-02 1 1  ON 12
 ud_3                -1.143976e-02 1 1  ON 13
 ud_4                -6.708168e-02 1 1  ON 14
 ud_5                -1.069630e-01 1 1  ON 15
 ud_6                -1.329714e-01 1 1  ON 16
 ud_7                -1.481766e-01 1 1  ON 17
 ud_8                -1.493827e-01 1 1  ON 18
 ud_9                -1.361207e-01 1 1  ON 19
 eO_0                -7.492137e-01 1 1  ON 20
 eO_1                -4.311768e-01 1 1  ON 21
 eO_2                -1.662842e-02 1 1  ON 22
 eO_3                 2.962399e-01 1 1  ON 23
 eO_4                 5.122195e-01 1 1  ON 24
 eO_5                 4.676044e-01 1 1  ON 25
 eO_6                 2.395529e-01 1 1  ON 26
 eO_7                -5.355163e-02 1 1  ON 27
 eO_8                -2.034695e-01 1 1  ON 28
 eO_9                -6.376854e-02 1 1  ON 29
eH1_0                -2.328625e-01 1 1  ON 30
eH1_1                -1.342523e-01 1 1  ON 31
eH1_2                -8.860427e-02 1 1  ON 32
eH1_3                -3.578694e-02 1 1  ON 33
eH1_4                 1.146314e-02 1 1  ON 34
eH1_5                 4.518556e-02 1 1  ON 35
eH1_6                 9.868116e-02 1 1  ON 36
eH1_7                 1.437671e-01 1 1  ON 37
eH1_8                 1.552051e-01 1 1  ON 38
eH1_9                 4.122651e-02 1 1  ON 39
eH2_0                -2.306576e-01 1 1  ON 40
eH2_1                -1.326447e-01 1 1  ON 41
eH2_2                -8.687941e-02 1 1  ON 42
eH2_3                -3.390064e-02 1 1  ON 43
eH2_4                 1.389249e-02 1 1  ON 44
eH2_5                 4.806120e-02 1 1  ON 45
eH2_6                 1.021610e-01 1 1  ON 46
eH2_7                 1.499129e-01 1 1  ON 47
eH2_8                 1.629581e-01 1 1  ON 48
eH2_9                 2.460747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0090e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8794
    reference variance = 0.19113
====================================================
  Execution time = 2.0765e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331131288224
                                         uncertainty =       0.002866823079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331131288224
                                         uncertainty =       0.002866823079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406833711
  error estimate for blocks of size 2^( 2) =       0.000419664269
  error estimate for blocks of size 2^( 3) =       0.000432599502
  error estimate for blocks of size 2^( 4) =       0.000445446705
  error estimate for blocks of size 2^( 5) =       0.000456075317
  error estimate for blocks of size 2^( 6) =       0.000463837727
  error estimate for blocks of size 2^( 7) =       0.000468501587

      target function =                  N/A
              le_mean =     -16.905820909864
             les_mean =     286.137807807915
             stat err =       0.000458465334
             autocorr =       1.269928123569
              std dev =       0.575349751933
             le_variance =       0.331027337050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582090986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905820909864       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905819871515       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905823190324       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905827229114       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905829675787       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905829766290       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905827981661       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905829311185       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905829066044       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905828856211       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905828681712       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905828659688       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.800916e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905820909864       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905820445095       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905821147400       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905822863552       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905824782153       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905823864453       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905823682532       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905823813952       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905823767220       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.897268e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905820909864       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905820765057       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905820898769       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905821353906       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905822008829       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905821799758       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905821690066       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905821742663       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905821727526       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.605653e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6377e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.067565e-01 1 1  ON 0
 uu_1                 1.407831e-01 1 1  ON 1
 uu_2                 4.003718e-02 1 1  ON 2
 uu_3                -2.105461e-02 1 1  ON 3
 uu_4                -6.446096e-02 1 1  ON 4
 uu_5                -9.728599e-02 1 1  ON 5
 uu_6                -1.229568e-01 1 1  ON 6
 uu_7                -1.346219e-01 1 1  ON 7
 uu_8                -1.259445e-01 1 1  ON 8
 uu_9                -9.445387e-02 1 1  ON 9
 ud_0                 4.420268e-01 1 1  ON 10
 ud_1                 1.769553e-01 1 1  ON 11
 ud_2                 5.804793e-02 1 1  ON 12
 ud_3                -1.156991e-02 1 1  ON 13
 ud_4                -6.714790e-02 1 1  ON 14
 ud_5                -1.069037e-01 1 1  ON 15
 ud_6                -1.330635e-01 1 1  ON 16
 ud_7                -1.481672e-01 1 1  ON 17
 ud_8                -1.495667e-01 1 1  ON 18
 ud_9                -1.363964e-01 1 1  ON 19
 eO_0                -7.498034e-01 1 1  ON 20
 eO_1                -4.313689e-01 1 1  ON 21
 eO_2                -1.652865e-02 1 1  ON 22
 eO_3                 2.965361e-01 1 1  ON 23
 eO_4                 5.125609e-01 1 1  ON 24
 eO_5                 4.678905e-01 1 1  ON 25
 eO_6                 2.397811e-01 1 1  ON 26
 eO_7                -5.342449e-02 1 1  ON 27
 eO_8                -2.038000e-01 1 1  ON 28
 eO_9                -6.401509e-02 1 1  ON 29
eH1_0                -2.333890e-01 1 1  ON 30
eH1_1                -1.344602e-01 1 1  ON 31
eH1_2                -8.870870e-02 1 1  ON 32
eH1_3                -3.576055e-02 1 1  ON 33
eH1_4                 1.134311e-02 1 1  ON 34
eH1_5                 4.510290e-02 1 1  ON 35
eH1_6                 9.887416e-02 1 1  ON 36
eH1_7                 1.440294e-01 1 1  ON 37
eH1_8                 1.555189e-01 1 1  ON 38
eH1_9                 4.145369e-02 1 1  ON 39
eH2_0                -2.310841e-01 1 1  ON 40
eH2_1                -1.328573e-01 1 1  ON 41
eH2_2                -8.692476e-02 1 1  ON 42
eH2_3                -3.383735e-02 1 1  ON 43
eH2_4                 1.373719e-02 1 1  ON 44
eH2_5                 4.795476e-02 1 1  ON 45
eH2_6                 1.023031e-01 1 1  ON 46
eH2_7                 1.500765e-01 1 1  ON 47
eH2_8                 1.632509e-01 1 1  ON 48
eH2_9                 2.488005e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.196939
====================================================
  Execution time = 2.0182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3483e-01
  Total weights = 2.0000e+06
  Execution time = 1.8856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334320881970
                                         uncertainty =       0.003881290061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334320881970
                                         uncertainty =       0.003881290061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408923836
  error estimate for blocks of size 2^( 2) =       0.000421589383
  error estimate for blocks of size 2^( 3) =       0.000434941634
  error estimate for blocks of size 2^( 4) =       0.000448016853
  error estimate for blocks of size 2^( 5) =       0.000459608740
  error estimate for blocks of size 2^( 6) =       0.000468427492
  error estimate for blocks of size 2^( 7) =       0.000476243887

      target function =                  N/A
              le_mean =     -16.905826835153
             les_mean =     286.141418220195
             stat err =       0.000463074243
             autocorr =       1.282379002386
              std dev =       0.578305634791
             le_variance =       0.334437407231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335247998328
                                         uncertainty =       0.003894396841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335247998328
                                         uncertainty =       0.003894396841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409490515
  error estimate for blocks of size 2^( 2) =       0.000422123333
  error estimate for blocks of size 2^( 3) =       0.000435440416
  error estimate for blocks of size 2^( 4) =       0.000448488070
  error estimate for blocks of size 2^( 5) =       0.000460058824
  error estimate for blocks of size 2^( 6) =       0.000468887009
  error estimate for blocks of size 2^( 7) =       0.000476707411

      target function =                  N/A
              le_mean =     -16.905826559911
             les_mean =     286.142336469070
             stat err =       0.000463535328
             autocorr =       1.281380133946
              std dev =       0.579107039301
             le_variance =       0.335364962967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110298129
                                         uncertainty =       0.003891435216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110298129
                                         uncertainty =       0.003891435216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409406397
  error estimate for blocks of size 2^( 2) =       0.000422042876
  error estimate for blocks of size 2^( 3) =       0.000435366092
  error estimate for blocks of size 2^( 4) =       0.000448419346
  error estimate for blocks of size 2^( 5) =       0.000459993912
  error estimate for blocks of size 2^( 6) =       0.000468820442
  error estimate for blocks of size 2^( 7) =       0.000476639971

      target function =                  N/A
              le_mean =     -16.905826777910
             les_mean =     286.142206072988
             stat err =       0.000463468418
             autocorr =       1.281536682125
              std dev =       0.578988079235
             le_variance =       0.335227195897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334445362637
                                         uncertainty =       0.003882822837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334445362637
                                         uncertainty =       0.003882822837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408999967
  error estimate for blocks of size 2^( 2) =       0.000421660714
  error estimate for blocks of size 2^( 3) =       0.000435008373
  error estimate for blocks of size 2^( 4) =       0.000448080058
  error estimate for blocks of size 2^( 5) =       0.000459669141
  error estimate for blocks of size 2^( 6) =       0.000468488777
  error estimate for blocks of size 2^( 7) =       0.000476305605

      target function =                  N/A
              le_mean =     -16.905826578048
             les_mean =     286.141534066433
             stat err =       0.000463135895
             autocorr =       1.282243003024
              std dev =       0.578413300904
             le_variance =       0.334561946663


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905826835153        initial  <--
     1.5625e-01     1.5625e+00             1.8009e-03       -16.905826559911
     6.2500e-01     6.2500e+00             5.8973e-04       -16.905826777910
     2.5000e+00     2.5000e+01             1.6057e-04       -16.905826578048

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6802
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.065153e-01 1 1  ON 0
 uu_1                 1.406456e-01 1 1  ON 1
 uu_2                 4.006712e-02 1 1  ON 2
 uu_3                -2.096846e-02 1 1  ON 3
 uu_4                -6.456468e-02 1 1  ON 4
 uu_5                -9.711320e-02 1 1  ON 5
 uu_6                -1.228167e-01 1 1  ON 6
 uu_7                -1.344705e-01 1 1  ON 7
 uu_8                -1.257603e-01 1 1  ON 8
 uu_9                -9.432889e-02 1 1  ON 9
 ud_0                 4.415745e-01 1 1  ON 10
 ud_1                 1.767347e-01 1 1  ON 11
 ud_2                 5.799945e-02 1 1  ON 12
 ud_3                -1.143976e-02 1 1  ON 13
 ud_4                -6.708168e-02 1 1  ON 14
 ud_5                -1.069630e-01 1 1  ON 15
 ud_6                -1.329714e-01 1 1  ON 16
 ud_7                -1.481766e-01 1 1  ON 17
 ud_8                -1.493827e-01 1 1  ON 18
 ud_9                -1.361207e-01 1 1  ON 19
 eO_0                -7.492137e-01 1 1  ON 20
 eO_1                -4.311768e-01 1 1  ON 21
 eO_2                -1.662842e-02 1 1  ON 22
 eO_3                 2.962399e-01 1 1  ON 23
 eO_4                 5.122195e-01 1 1  ON 24
 eO_5                 4.676044e-01 1 1  ON 25
 eO_6                 2.395529e-01 1 1  ON 26
 eO_7                -5.355163e-02 1 1  ON 27
 eO_8                -2.034695e-01 1 1  ON 28
 eO_9                -6.376854e-02 1 1  ON 29
eH1_0                -2.328625e-01 1 1  ON 30
eH1_1                -1.342523e-01 1 1  ON 31
eH1_2                -8.860427e-02 1 1  ON 32
eH1_3                -3.578694e-02 1 1  ON 33
eH1_4                 1.146314e-02 1 1  ON 34
eH1_5                 4.518556e-02 1 1  ON 35
eH1_6                 9.868116e-02 1 1  ON 36
eH1_7                 1.437671e-01 1 1  ON 37
eH1_8                 1.552051e-01 1 1  ON 38
eH1_9                 4.122651e-02 1 1  ON 39
eH2_0                -2.306576e-01 1 1  ON 40
eH2_1                -1.326447e-01 1 1  ON 41
eH2_2                -8.687941e-02 1 1  ON 42
eH2_3                -3.390064e-02 1 1  ON 43
eH2_4                 1.389249e-02 1 1  ON 44
eH2_5                 4.806120e-02 1 1  ON 45
eH2_6                 1.021610e-01 1 1  ON 46
eH2_7                 1.499129e-01 1 1  ON 47
eH2_8                 1.629581e-01 1 1  ON 48
eH2_9                 2.460747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8621
    reference variance = 0.180595
====================================================
  Execution time = 2.0912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4987e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349973543167
                                         uncertainty =       0.011126280789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349973543167
                                         uncertainty =       0.011126280789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418251511
  error estimate for blocks of size 2^( 2) =       0.000430463178
  error estimate for blocks of size 2^( 3) =       0.000443486029
  error estimate for blocks of size 2^( 4) =       0.000455504225
  error estimate for blocks of size 2^( 5) =       0.000465193664
  error estimate for blocks of size 2^( 6) =       0.000472206155
  error estimate for blocks of size 2^( 7) =       0.000475523898

      target function =                  N/A
              le_mean =     -16.906703381948
             les_mean =     286.186487722493
             stat err =       0.000467106985
             autocorr =       1.247261990693
              std dev =       0.591496958790
             le_variance =       0.349868652258


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690670338195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906703381948       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906703590195       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906704191817       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906704327673       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906704861521       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906704712275       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906704783049       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906704769015       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906704771170       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.452275e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906703381948       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906703438977       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906703609155       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703657899       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906703758980       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703795817       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906703756511       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906703756133       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 6.402742e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906703381948       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906703396554       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906703440536       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703453899       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906703476381       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703487908       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906703477846       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906703477602       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.622257e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083952 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6461e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.065353e-01 1 1  ON 0
 uu_1                 1.406490e-01 1 1  ON 1
 uu_2                 4.006501e-02 1 1  ON 2
 uu_3                -2.097326e-02 1 1  ON 3
 uu_4                -6.455877e-02 1 1  ON 4
 uu_5                -9.711581e-02 1 1  ON 5
 uu_6                -1.228159e-01 1 1  ON 6
 uu_7                -1.344902e-01 1 1  ON 7
 uu_8                -1.257741e-01 1 1  ON 8
 uu_9                -9.434718e-02 1 1  ON 9
 ud_0                 4.416229e-01 1 1  ON 10
 ud_1                 1.767618e-01 1 1  ON 11
 ud_2                 5.800506e-02 1 1  ON 12
 ud_3                -1.144314e-02 1 1  ON 13
 ud_4                -6.709245e-02 1 1  ON 14
 ud_5                -1.069759e-01 1 1  ON 15
 ud_6                -1.329686e-01 1 1  ON 16
 ud_7                -1.481729e-01 1 1  ON 17
 ud_8                -1.494076e-01 1 1  ON 18
 ud_9                -1.361513e-01 1 1  ON 19
 eO_0                -7.492777e-01 1 1  ON 20
 eO_1                -4.311940e-01 1 1  ON 21
 eO_2                -1.662808e-02 1 1  ON 22
 eO_3                 2.962752e-01 1 1  ON 23
 eO_4                 5.122584e-01 1 1  ON 24
 eO_5                 4.676402e-01 1 1  ON 25
 eO_6                 2.395783e-01 1 1  ON 26
 eO_7                -5.354309e-02 1 1  ON 27
 eO_8                -2.035042e-01 1 1  ON 28
 eO_9                -6.379345e-02 1 1  ON 29
eH1_0                -2.329021e-01 1 1  ON 30
eH1_1                -1.342658e-01 1 1  ON 31
eH1_2                -8.861724e-02 1 1  ON 32
eH1_3                -3.577512e-02 1 1  ON 33
eH1_4                 1.146820e-02 1 1  ON 34
eH1_5                 4.517169e-02 1 1  ON 35
eH1_6                 9.869081e-02 1 1  ON 36
eH1_7                 1.437712e-01 1 1  ON 37
eH1_8                 1.552314e-01 1 1  ON 38
eH1_9                 4.125085e-02 1 1  ON 39
eH2_0                -2.307082e-01 1 1  ON 40
eH2_1                -1.326481e-01 1 1  ON 41
eH2_2                -8.688846e-02 1 1  ON 42
eH2_3                -3.390108e-02 1 1  ON 43
eH2_4                 1.391211e-02 1 1  ON 44
eH2_5                 4.806366e-02 1 1  ON 45
eH2_6                 1.021476e-01 1 1  ON 46
eH2_7                 1.499137e-01 1 1  ON 47
eH2_8                 1.629789e-01 1 1  ON 48
eH2_9                 2.463935e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8849
    reference variance = 0.187639
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3546e-01
  Total weights = 2.0000e+06
  Execution time = 1.9040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335452706929
                                         uncertainty =       0.005002366859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335452706929
                                         uncertainty =       0.005002366859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409524813
  error estimate for blocks of size 2^( 2) =       0.000422704172
  error estimate for blocks of size 2^( 3) =       0.000435939742
  error estimate for blocks of size 2^( 4) =       0.000448512777
  error estimate for blocks of size 2^( 5) =       0.000459600764
  error estimate for blocks of size 2^( 6) =       0.000468813329
  error estimate for blocks of size 2^( 7) =       0.000473466953

      target function =                  N/A
              le_mean =     -16.906228759229
             les_mean =     286.155991836523
             stat err =       0.000462598456
             autocorr =       1.275991895448
              std dev =       0.579155544617
             le_variance =       0.335421144860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335593664395
                                         uncertainty =       0.005003946733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335593664395
                                         uncertainty =       0.005003946733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409610854
  error estimate for blocks of size 2^( 2) =       0.000422785106
  error estimate for blocks of size 2^( 3) =       0.000436014806
  error estimate for blocks of size 2^( 4) =       0.000448582724
  error estimate for blocks of size 2^( 5) =       0.000459667682
  error estimate for blocks of size 2^( 6) =       0.000468879167
  error estimate for blocks of size 2^( 7) =       0.000473534404

      target function =                  N/A
              le_mean =     -16.906228837381
             les_mean =     286.156135438326
             stat err =       0.000462665994
             autocorr =       1.275828346490
              std dev =       0.579277225692
             le_variance =       0.335562104206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335529918111
                                         uncertainty =       0.005003223346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335529918111
                                         uncertainty =       0.005003223346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409571945
  error estimate for blocks of size 2^( 2) =       0.000422748517
  error estimate for blocks of size 2^( 3) =       0.000435980931
  error estimate for blocks of size 2^( 4) =       0.000448551224
  error estimate for blocks of size 2^( 5) =       0.000459637573
  error estimate for blocks of size 2^( 6) =       0.000468849569
  error estimate for blocks of size 2^( 7) =       0.000473503991

      target function =                  N/A
              le_mean =     -16.906228770839
             les_mean =     286.156069440922
             stat err =       0.000462635589
             autocorr =       1.275903051644
              std dev =       0.579222199800
             le_variance =       0.335498356741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335462586588
                                         uncertainty =       0.005002477154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335462586588
                                         uncertainty =       0.005002477154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409530844
  error estimate for blocks of size 2^( 2) =       0.000422709844
  error estimate for blocks of size 2^( 3) =       0.000435945009
  error estimate for blocks of size 2^( 4) =       0.000448517692
  error estimate for blocks of size 2^( 5) =       0.000459605469
  error estimate for blocks of size 2^( 6) =       0.000468817962
  error estimate for blocks of size 2^( 7) =       0.000473471687

      target function =                  N/A
              le_mean =     -16.906228759747
             les_mean =     286.156001733824
             stat err =       0.000462603203
             autocorr =       1.275980498699
              std dev =       0.579164074035
             le_variance =       0.335431024653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906228759229        initial
     1.5625e+00     1.5625e+01             2.4523e-04       -16.906228837381  <--
     6.2500e+00     6.2500e+01             6.4027e-05       -16.906228770839
     2.5000e+01     2.5000e+02             1.6223e-05       -16.906228759747

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 3.0129e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.065928e-01 1 1  ON 0
 uu_1                 1.406584e-01 1 1  ON 1
 uu_2                 4.006506e-02 1 1  ON 2
 uu_3                -2.098727e-02 1 1  ON 3
 uu_4                -6.454781e-02 1 1  ON 4
 uu_5                -9.712353e-02 1 1  ON 5
 uu_6                -1.228184e-01 1 1  ON 6
 uu_7                -1.345464e-01 1 1  ON 7
 uu_8                -1.258130e-01 1 1  ON 8
 uu_9                -9.440176e-02 1 1  ON 9
 ud_0                 4.417551e-01 1 1  ON 10
 ud_1                 1.768409e-01 1 1  ON 11
 ud_2                 5.802291e-02 1 1  ON 12
 ud_3                -1.144873e-02 1 1  ON 13
 ud_4                -6.712271e-02 1 1  ON 14
 ud_5                -1.070084e-01 1 1  ON 15
 ud_6                -1.329650e-01 1 1  ON 16
 ud_7                -1.481624e-01 1 1  ON 17
 ud_8                -1.494770e-01 1 1  ON 18
 ud_9                -1.362423e-01 1 1  ON 19
 eO_0                -7.494589e-01 1 1  ON 20
 eO_1                -4.312542e-01 1 1  ON 21
 eO_2                -1.662981e-02 1 1  ON 22
 eO_3                 2.963730e-01 1 1  ON 23
 eO_4                 5.123782e-01 1 1  ON 24
 eO_5                 4.677512e-01 1 1  ON 25
 eO_6                 2.396558e-01 1 1  ON 26
 eO_7                -5.351519e-02 1 1  ON 27
 eO_8                -2.036089e-01 1 1  ON 28
 eO_9                -6.386952e-02 1 1  ON 29
eH1_0                -2.330157e-01 1 1  ON 30
eH1_1                -1.343061e-01 1 1  ON 31
eH1_2                -8.865535e-02 1 1  ON 32
eH1_3                -3.574774e-02 1 1  ON 33
eH1_4                 1.148010e-02 1 1  ON 34
eH1_5                 4.513137e-02 1 1  ON 35
eH1_6                 9.871938e-02 1 1  ON 36
eH1_7                 1.437830e-01 1 1  ON 37
eH1_8                 1.553126e-01 1 1  ON 38
eH1_9                 4.132594e-02 1 1  ON 39
eH2_0                -2.308516e-01 1 1  ON 40
eH2_1                -1.326636e-01 1 1  ON 41
eH2_2                -8.691901e-02 1 1  ON 42
eH2_3                -3.389930e-02 1 1  ON 43
eH2_4                 1.396022e-02 1 1  ON 44
eH2_5                 4.807068e-02 1 1  ON 45
eH2_6                 1.021104e-01 1 1  ON 46
eH2_7                 1.499172e-01 1 1  ON 47
eH2_8                 1.630430e-01 1 1  ON 48
eH2_9                 2.473740e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6597e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9664
    reference variance = 0.228766
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3518e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335233880087
                                         uncertainty =       0.004179440134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335233880087
                                         uncertainty =       0.004179440134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409380256
  error estimate for blocks of size 2^( 2) =       0.000422229240
  error estimate for blocks of size 2^( 3) =       0.000434991442
  error estimate for blocks of size 2^( 4) =       0.000447172091
  error estimate for blocks of size 2^( 5) =       0.000457529146
  error estimate for blocks of size 2^( 6) =       0.000462019345
  error estimate for blocks of size 2^( 7) =       0.000469466518

      target function =                  N/A
              le_mean =     -16.905893376060
             les_mean =     286.144415062806
             stat err =       0.000459046775
             autocorr =       1.257361318965
              std dev =       0.578951109929
             le_variance =       0.335184387688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589337606e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905893376060       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905894006705       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905894136234       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895280731       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895188900       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895200853       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895638946       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905896119524       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905895847396       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905895774532       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 7.103631e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905893376060       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905893599290       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905893638979       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905893937742       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905893939581       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905893925002       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905894014307       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905894016602       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905894045707       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.866465e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905893376060       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905893438343       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905893449418       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905893523747       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905893524698       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905893520879       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905893541565       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905893535865       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.821833e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6113e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.066603e-01 1 1  ON 0
 uu_1                 1.406691e-01 1 1  ON 1
 uu_2                 4.001737e-02 1 1  ON 2
 uu_3                -2.100076e-02 1 1  ON 3
 uu_4                -6.453300e-02 1 1  ON 4
 uu_5                -9.714171e-02 1 1  ON 5
 uu_6                -1.228259e-01 1 1  ON 6
 uu_7                -1.345453e-01 1 1  ON 7
 uu_8                -1.258966e-01 1 1  ON 8
 uu_9                -9.449249e-02 1 1  ON 9
 ud_0                 4.418928e-01 1 1  ON 10
 ud_1                 1.769660e-01 1 1  ON 11
 ud_2                 5.805883e-02 1 1  ON 12
 ud_3                -1.147344e-02 1 1  ON 13
 ud_4                -6.713758e-02 1 1  ON 14
 ud_5                -1.070110e-01 1 1  ON 15
 ud_6                -1.330370e-01 1 1  ON 16
 ud_7                -1.481705e-01 1 1  ON 17
 ud_8                -1.495438e-01 1 1  ON 18
 ud_9                -1.363517e-01 1 1  ON 19
 eO_0                -7.496453e-01 1 1  ON 20
 eO_1                -4.313862e-01 1 1  ON 21
 eO_2                -1.661741e-02 1 1  ON 22
 eO_3                 2.964195e-01 1 1  ON 23
 eO_4                 5.125398e-01 1 1  ON 24
 eO_5                 4.679290e-01 1 1  ON 25
 eO_6                 2.397854e-01 1 1  ON 26
 eO_7                -5.346810e-02 1 1  ON 27
 eO_8                -2.037528e-01 1 1  ON 28
 eO_9                -6.396962e-02 1 1  ON 29
eH1_0                -2.332023e-01 1 1  ON 30
eH1_1                -1.343532e-01 1 1  ON 31
eH1_2                -8.868045e-02 1 1  ON 32
eH1_3                -3.583121e-02 1 1  ON 33
eH1_4                 1.150853e-02 1 1  ON 34
eH1_5                 4.503884e-02 1 1  ON 35
eH1_6                 9.879012e-02 1 1  ON 36
eH1_7                 1.439065e-01 1 1  ON 37
eH1_8                 1.553991e-01 1 1  ON 38
eH1_9                 4.144053e-02 1 1  ON 39
eH2_0                -2.310285e-01 1 1  ON 40
eH2_1                -1.326928e-01 1 1  ON 41
eH2_2                -8.689376e-02 1 1  ON 42
eH2_3                -3.391835e-02 1 1  ON 43
eH2_4                 1.393162e-02 1 1  ON 44
eH2_5                 4.803112e-02 1 1  ON 45
eH2_6                 1.021425e-01 1 1  ON 46
eH2_7                 1.499199e-01 1 1  ON 47
eH2_8                 1.631370e-01 1 1  ON 48
eH2_9                 2.487369e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8706
    reference variance = 0.253353
====================================================
  Execution time = 2.0205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3148e-01
  Total weights = 2.0000e+06
  Execution time = 1.8893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331396488208
                                         uncertainty =       0.004216700556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331396488208
                                         uncertainty =       0.004216700556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407059763
  error estimate for blocks of size 2^( 2) =       0.000419464550
  error estimate for blocks of size 2^( 3) =       0.000432109429
  error estimate for blocks of size 2^( 4) =       0.000444470535
  error estimate for blocks of size 2^( 5) =       0.000454363350
  error estimate for blocks of size 2^( 6) =       0.000461605795
  error estimate for blocks of size 2^( 7) =       0.000466358242

      target function =                  N/A
              le_mean =     -16.906047992048
             les_mean =     286.145853845024
             stat err =       0.000456699480
             autocorr =       1.258765073827
              std dev =       0.575669437518
             le_variance =       0.331395301292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331657734050
                                         uncertainty =       0.004222896717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331657734050
                                         uncertainty =       0.004222896717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407220144
  error estimate for blocks of size 2^( 2) =       0.000419615558
  error estimate for blocks of size 2^( 3) =       0.000432247943
  error estimate for blocks of size 2^( 4) =       0.000444596678
  error estimate for blocks of size 2^( 5) =       0.000454485850
  error estimate for blocks of size 2^( 6) =       0.000461728905
  error estimate for blocks of size 2^( 7) =       0.000466474135

      target function =                  N/A
              le_mean =     -16.906044560694
             les_mean =     286.145999013733
             stat err =       0.000456821392
             autocorr =       1.258445347239
              std dev =       0.575896250549
             le_variance =       0.331656491396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331566943872
                                         uncertainty =       0.004221062422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331566943872
                                         uncertainty =       0.004221062422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407164419
  error estimate for blocks of size 2^( 2) =       0.000419562920
  error estimate for blocks of size 2^( 3) =       0.000432199691
  error estimate for blocks of size 2^( 4) =       0.000444553454
  error estimate for blocks of size 2^( 5) =       0.000454444413
  error estimate for blocks of size 2^( 6) =       0.000461687202
  error estimate for blocks of size 2^( 7) =       0.000466435785

      target function =                  N/A
              le_mean =     -16.906045350979
             les_mean =     286.145934971291
             stat err =       0.000456780214
             autocorr =       1.258562910742
              std dev =       0.575817443041
             le_variance =       0.331565727711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331419258921
                                         uncertainty =       0.004217322489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331419258921
                                         uncertainty =       0.004217322489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407073746
  error estimate for blocks of size 2^( 2) =       0.000419477659
  error estimate for blocks of size 2^( 3) =       0.000432121432
  error estimate for blocks of size 2^( 4) =       0.000444481595
  error estimate for blocks of size 2^( 5) =       0.000454374190
  error estimate for blocks of size 2^( 6) =       0.000461616675
  error estimate for blocks of size 2^( 7) =       0.000466368632

      target function =                  N/A
              le_mean =     -16.906047592383
             les_mean =     286.145863098922
             stat err =       0.000456710273
             autocorr =       1.258738089227
              std dev =       0.575689211915
             le_variance =       0.331418068715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906047992048        initial  <--
     3.9062e-01     3.9062e+00             7.1036e-04       -16.906044560694
     1.5625e+00     1.5625e+01             1.8665e-04       -16.906045350979
     6.2500e+00     6.2500e+01             4.8218e-05       -16.906047592383

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7435
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.065928e-01 1 1  ON 0
 uu_1                 1.406584e-01 1 1  ON 1
 uu_2                 4.006506e-02 1 1  ON 2
 uu_3                -2.098727e-02 1 1  ON 3
 uu_4                -6.454781e-02 1 1  ON 4
 uu_5                -9.712353e-02 1 1  ON 5
 uu_6                -1.228184e-01 1 1  ON 6
 uu_7                -1.345464e-01 1 1  ON 7
 uu_8                -1.258130e-01 1 1  ON 8
 uu_9                -9.440176e-02 1 1  ON 9
 ud_0                 4.417551e-01 1 1  ON 10
 ud_1                 1.768409e-01 1 1  ON 11
 ud_2                 5.802291e-02 1 1  ON 12
 ud_3                -1.144873e-02 1 1  ON 13
 ud_4                -6.712271e-02 1 1  ON 14
 ud_5                -1.070084e-01 1 1  ON 15
 ud_6                -1.329650e-01 1 1  ON 16
 ud_7                -1.481624e-01 1 1  ON 17
 ud_8                -1.494770e-01 1 1  ON 18
 ud_9                -1.362423e-01 1 1  ON 19
 eO_0                -7.494589e-01 1 1  ON 20
 eO_1                -4.312542e-01 1 1  ON 21
 eO_2                -1.662981e-02 1 1  ON 22
 eO_3                 2.963730e-01 1 1  ON 23
 eO_4                 5.123782e-01 1 1  ON 24
 eO_5                 4.677512e-01 1 1  ON 25
 eO_6                 2.396558e-01 1 1  ON 26
 eO_7                -5.351519e-02 1 1  ON 27
 eO_8                -2.036089e-01 1 1  ON 28
 eO_9                -6.386952e-02 1 1  ON 29
eH1_0                -2.330157e-01 1 1  ON 30
eH1_1                -1.343061e-01 1 1  ON 31
eH1_2                -8.865535e-02 1 1  ON 32
eH1_3                -3.574774e-02 1 1  ON 33
eH1_4                 1.148010e-02 1 1  ON 34
eH1_5                 4.513137e-02 1 1  ON 35
eH1_6                 9.871938e-02 1 1  ON 36
eH1_7                 1.437830e-01 1 1  ON 37
eH1_8                 1.553126e-01 1 1  ON 38
eH1_9                 4.132594e-02 1 1  ON 39
eH2_0                -2.308516e-01 1 1  ON 40
eH2_1                -1.326636e-01 1 1  ON 41
eH2_2                -8.691901e-02 1 1  ON 42
eH2_3                -3.389930e-02 1 1  ON 43
eH2_4                 1.396022e-02 1 1  ON 44
eH2_5                 4.807068e-02 1 1  ON 45
eH2_6                 1.021104e-01 1 1  ON 46
eH2_7                 1.499172e-01 1 1  ON 47
eH2_8                 1.630430e-01 1 1  ON 48
eH2_9                 2.473740e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5862e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9073
    reference variance = 0.264564
====================================================
  Execution time = 2.0696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3978e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339713922963
                                         uncertainty =       0.004712042246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339713922963
                                         uncertainty =       0.004712042246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412174379
  error estimate for blocks of size 2^( 2) =       0.000425213720
  error estimate for blocks of size 2^( 3) =       0.000438244198
  error estimate for blocks of size 2^( 4) =       0.000450802215
  error estimate for blocks of size 2^( 5) =       0.000461771876
  error estimate for blocks of size 2^( 6) =       0.000470845364
  error estimate for blocks of size 2^( 7) =       0.000475236300

      target function =                  N/A
              le_mean =     -16.906679780396
             les_mean =     286.175596465092
             stat err =       0.000464663939
             autocorr =       1.270913384619
              std dev =       0.582902597477
             le_variance =       0.339775438145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690667978040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906679780396       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906679782136       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906679619228       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906679615313       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906679807729       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906679955972       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906679952433       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906679937708       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 9.393028e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906679780396       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906679780844       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906679737947       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906679737095       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906679784865       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906679822072       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906679822802       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906679819518       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.394702e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906679780396       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906679780508       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906679769640       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906679769436       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906679781346       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906679790655       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906679790949       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906679790160       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 6.017469e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6288e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.066017e-01 1 1  ON 0
 uu_1                 1.406639e-01 1 1  ON 1
 uu_2                 4.006792e-02 1 1  ON 2
 uu_3                -2.098810e-02 1 1  ON 3
 uu_4                -6.454840e-02 1 1  ON 4
 uu_5                -9.712622e-02 1 1  ON 5
 uu_6                -1.228228e-01 1 1  ON 6
 uu_7                -1.345551e-01 1 1  ON 7
 uu_8                -1.258267e-01 1 1  ON 8
 uu_9                -9.440818e-02 1 1  ON 9
 ud_0                 4.417589e-01 1 1  ON 10
 ud_1                 1.768496e-01 1 1  ON 11
 ud_2                 5.802464e-02 1 1  ON 12
 ud_3                -1.145087e-02 1 1  ON 13
 ud_4                -6.712588e-02 1 1  ON 14
 ud_5                -1.070073e-01 1 1  ON 15
 ud_6                -1.329678e-01 1 1  ON 16
 ud_7                -1.481646e-01 1 1  ON 17
 ud_8                -1.494756e-01 1 1  ON 18
 ud_9                -1.362456e-01 1 1  ON 19
 eO_0                -7.494829e-01 1 1  ON 20
 eO_1                -4.312603e-01 1 1  ON 21
 eO_2                -1.662933e-02 1 1  ON 22
 eO_3                 2.963841e-01 1 1  ON 23
 eO_4                 5.123918e-01 1 1  ON 24
 eO_5                 4.677654e-01 1 1  ON 25
 eO_6                 2.396646e-01 1 1  ON 26
 eO_7                -5.351232e-02 1 1  ON 27
 eO_8                -2.036209e-01 1 1  ON 28
 eO_9                -6.387760e-02 1 1  ON 29
eH1_0                -2.330365e-01 1 1  ON 30
eH1_1                -1.343196e-01 1 1  ON 31
eH1_2                -8.865794e-02 1 1  ON 32
eH1_3                -3.574161e-02 1 1  ON 33
eH1_4                 1.148448e-02 1 1  ON 34
eH1_5                 4.513193e-02 1 1  ON 35
eH1_6                 9.871808e-02 1 1  ON 36
eH1_7                 1.437892e-01 1 1  ON 37
eH1_8                 1.553244e-01 1 1  ON 38
eH1_9                 4.133528e-02 1 1  ON 39
eH2_0                -2.308696e-01 1 1  ON 40
eH2_1                -1.326611e-01 1 1  ON 41
eH2_2                -8.691862e-02 1 1  ON 42
eH2_3                -3.390395e-02 1 1  ON 43
eH2_4                 1.395980e-02 1 1  ON 44
eH2_5                 4.806365e-02 1 1  ON 45
eH2_6                 1.021071e-01 1 1  ON 46
eH2_7                 1.499194e-01 1 1  ON 47
eH2_8                 1.630560e-01 1 1  ON 48
eH2_9                 2.475177e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9453
    reference variance = 0.199554
====================================================
  Execution time = 2.0654e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4224e-01
  Total weights = 2.0000e+06
  Execution time = 1.9028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342202512103
                                         uncertainty =       0.008479036650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342202512103
                                         uncertainty =       0.008479036650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413663576
  error estimate for blocks of size 2^( 2) =       0.000426202463
  error estimate for blocks of size 2^( 3) =       0.000439620024
  error estimate for blocks of size 2^( 4) =       0.000451683871
  error estimate for blocks of size 2^( 5) =       0.000463332949
  error estimate for blocks of size 2^( 6) =       0.000471720197
  error estimate for blocks of size 2^( 7) =       0.000477849295

      target function =                  N/A
              le_mean =     -16.905690895650
             les_mean =     286.144619595831
             stat err =       0.000466146578
             autocorr =       1.269844192328
              std dev =       0.585008638974
             le_variance =       0.342235107675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211304272
                                         uncertainty =       0.008479223029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211304272
                                         uncertainty =       0.008479223029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413668887
  error estimate for blocks of size 2^( 2) =       0.000426207146
  error estimate for blocks of size 2^( 3) =       0.000439623895
  error estimate for blocks of size 2^( 4) =       0.000451686867
  error estimate for blocks of size 2^( 5) =       0.000463335637
  error estimate for blocks of size 2^( 6) =       0.000471722971
  error estimate for blocks of size 2^( 7) =       0.000477852842

      target function =                  N/A
              le_mean =     -16.905690904811
             les_mean =     286.144628694722
             stat err =       0.000466149579
             autocorr =       1.269827934869
              std dev =       0.585016150928
             le_variance =       0.342243896846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342206193992
                                         uncertainty =       0.008479100684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342206193992
                                         uncertainty =       0.008479100684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413665800
  error estimate for blocks of size 2^( 2) =       0.000426204383
  error estimate for blocks of size 2^( 3) =       0.000439621544
  error estimate for blocks of size 2^( 4) =       0.000451684968
  error estimate for blocks of size 2^( 5) =       0.000463333908
  error estimate for blocks of size 2^( 6) =       0.000471721215
  error estimate for blocks of size 2^( 7) =       0.000477850711

      target function =                  N/A
              le_mean =     -16.905690900177
             les_mean =     286.144623428836
             stat err =       0.000466147700
             autocorr =       1.269836655078
              std dev =       0.585011784181
             le_variance =       0.342238787631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342202946119
                                         uncertainty =       0.008479043623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342202946119
                                         uncertainty =       0.008479043623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413663838
  error estimate for blocks of size 2^( 2) =       0.000426202688
  error estimate for blocks of size 2^( 3) =       0.000439620199
  error estimate for blocks of size 2^( 4) =       0.000451683993
  error estimate for blocks of size 2^( 5) =       0.000463333054
  error estimate for blocks of size 2^( 6) =       0.000471720310
  error estimate for blocks of size 2^( 7) =       0.000477849459

      target function =                  N/A
              le_mean =     -16.905690896030
             les_mean =     286.144620042419
             stat err =       0.000466146704
             autocorr =       1.269843270574
              std dev =       0.585009009703
             le_variance =       0.342235541434


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905690895650        initial
     3.9062e+00     3.9062e+01             9.3930e-05       -16.905690904811  <--
     1.5625e+01     1.5625e+02             2.3947e-05       -16.905690900177
     6.2500e+01     6.2500e+02             6.0175e-06       -16.905690896030

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.0244e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.066284e-01 1 1  ON 0
 uu_1                 1.406803e-01 1 1  ON 1
 uu_2                 4.007647e-02 1 1  ON 2
 uu_3                -2.099031e-02 1 1  ON 3
 uu_4                -6.455053e-02 1 1  ON 4
 uu_5                -9.713421e-02 1 1  ON 5
 uu_6                -1.228360e-01 1 1  ON 6
 uu_7                -1.345810e-01 1 1  ON 7
 uu_8                -1.258674e-01 1 1  ON 8
 uu_9                -9.442743e-02 1 1  ON 9
 ud_0                 4.417717e-01 1 1  ON 10
 ud_1                 1.768739e-01 1 1  ON 11
 ud_2                 5.803025e-02 1 1  ON 12
 ud_3                -1.145723e-02 1 1  ON 13
 ud_4                -6.713494e-02 1 1  ON 14
 ud_5                -1.070051e-01 1 1  ON 15
 ud_6                -1.329759e-01 1 1  ON 16
 ud_7                -1.481710e-01 1 1  ON 17
 ud_8                -1.494715e-01 1 1  ON 18
 ud_9                -1.362558e-01 1 1  ON 19
 eO_0                -7.495529e-01 1 1  ON 20
 eO_1                -4.312794e-01 1 1  ON 21
 eO_2                -1.662808e-02 1 1  ON 22
 eO_3                 2.964164e-01 1 1  ON 23
 eO_4                 5.124323e-01 1 1  ON 24
 eO_5                 4.678076e-01 1 1  ON 25
 eO_6                 2.396909e-01 1 1  ON 26
 eO_7                -5.350379e-02 1 1  ON 27
 eO_8                -2.036568e-01 1 1  ON 28
 eO_9                -6.390172e-02 1 1  ON 29
eH1_0                -2.330986e-01 1 1  ON 30
eH1_1                -1.343587e-01 1 1  ON 31
eH1_2                -8.866557e-02 1 1  ON 32
eH1_3                -3.572449e-02 1 1  ON 33
eH1_4                 1.149764e-02 1 1  ON 34
eH1_5                 4.513358e-02 1 1  ON 35
eH1_6                 9.871418e-02 1 1  ON 36
eH1_7                 1.438078e-01 1 1  ON 37
eH1_8                 1.553597e-01 1 1  ON 38
eH1_9                 4.136311e-02 1 1  ON 39
eH2_0                -2.309226e-01 1 1  ON 40
eH2_1                -1.326547e-01 1 1  ON 41
eH2_2                -8.691777e-02 1 1  ON 42
eH2_3                -3.391719e-02 1 1  ON 43
eH2_4                 1.395832e-02 1 1  ON 44
eH2_5                 4.804278e-02 1 1  ON 45
eH2_6                 1.020972e-01 1 1  ON 46
eH2_7                 1.499259e-01 1 1  ON 47
eH2_8                 1.630947e-01 1 1  ON 48
eH2_9                 2.479461e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9104
    reference variance = 0.184825
====================================================
  Execution time = 2.0712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334826157059
                                         uncertainty =       0.003573602704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334826157059
                                         uncertainty =       0.003573602704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409085736
  error estimate for blocks of size 2^( 2) =       0.000422330351
  error estimate for blocks of size 2^( 3) =       0.000435435415
  error estimate for blocks of size 2^( 4) =       0.000448353212
  error estimate for blocks of size 2^( 5) =       0.000459592419
  error estimate for blocks of size 2^( 6) =       0.000467874590
  error estimate for blocks of size 2^( 7) =       0.000472149458

      target function =                  N/A
              le_mean =     -16.906552166064
             les_mean =     286.166208254803
             stat err =       0.000461992420
             autocorr =       1.275384182649
              std dev =       0.578534595614
             le_variance =       0.334702278323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655216606e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906552166064       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906552069869       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906553918006       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906554641223       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906555141314       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906555099846       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906554958894       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906554819865       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906554867776       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.761736e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906552166064       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906552138449       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906552610273       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906552822445       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906552988000       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906552953919       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906552952387       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906552907105       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 9.787552e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906552166064       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906552158894       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906552277281       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906552332648       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906552377364       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906552368028       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906552368269       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906552357267       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.470865e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092455 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6261e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.066703e-01 1 1  ON 0
 uu_1                 1.406817e-01 1 1  ON 1
 uu_2                 4.007991e-02 1 1  ON 2
 uu_3                -2.100948e-02 1 1  ON 3
 uu_4                -6.453674e-02 1 1  ON 4
 uu_5                -9.714448e-02 1 1  ON 5
 uu_6                -1.228488e-01 1 1  ON 6
 uu_7                -1.345654e-01 1 1  ON 7
 uu_8                -1.258966e-01 1 1  ON 8
 uu_9                -9.447430e-02 1 1  ON 9
 ud_0                 4.418421e-01 1 1  ON 10
 ud_1                 1.769253e-01 1 1  ON 11
 ud_2                 5.805110e-02 1 1  ON 12
 ud_3                -1.148417e-02 1 1  ON 13
 ud_4                -6.714936e-02 1 1  ON 14
 ud_5                -1.070088e-01 1 1  ON 15
 ud_6                -1.330164e-01 1 1  ON 16
 ud_7                -1.481539e-01 1 1  ON 17
 ud_8                -1.494751e-01 1 1  ON 18
 ud_9                -1.363093e-01 1 1  ON 19
 eO_0                -7.496508e-01 1 1  ON 20
 eO_1                -4.313187e-01 1 1  ON 21
 eO_2                -1.661439e-02 1 1  ON 22
 eO_3                 2.964584e-01 1 1  ON 23
 eO_4                 5.124759e-01 1 1  ON 24
 eO_5                 4.678786e-01 1 1  ON 25
 eO_6                 2.397209e-01 1 1  ON 26
 eO_7                -5.347609e-02 1 1  ON 27
 eO_8                -2.036951e-01 1 1  ON 28
 eO_9                -6.394758e-02 1 1  ON 29
eH1_0                -2.331592e-01 1 1  ON 30
eH1_1                -1.344022e-01 1 1  ON 31
eH1_2                -8.867722e-02 1 1  ON 32
eH1_3                -3.575665e-02 1 1  ON 33
eH1_4                 1.149314e-02 1 1  ON 34
eH1_5                 4.512701e-02 1 1  ON 35
eH1_6                 9.871725e-02 1 1  ON 36
eH1_7                 1.438552e-01 1 1  ON 37
eH1_8                 1.554254e-01 1 1  ON 38
eH1_9                 4.140810e-02 1 1  ON 39
eH2_0                -2.310091e-01 1 1  ON 40
eH2_1                -1.326761e-01 1 1  ON 41
eH2_2                -8.692455e-02 1 1  ON 42
eH2_3                -3.391559e-02 1 1  ON 43
eH2_4                 1.397047e-02 1 1  ON 44
eH2_5                 4.805207e-02 1 1  ON 45
eH2_6                 1.021023e-01 1 1  ON 46
eH2_7                 1.499177e-01 1 1  ON 47
eH2_8                 1.631422e-01 1 1  ON 48
eH2_9                 2.484832e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9379
    reference variance = 0.268307
====================================================
  Execution time = 2.0589e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3627e-01
  Total weights = 2.0000e+06
  Execution time = 1.8996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336288556968
                                         uncertainty =       0.004103534357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336288556968
                                         uncertainty =       0.004103534357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410013548
  error estimate for blocks of size 2^( 2) =       0.000422526574
  error estimate for blocks of size 2^( 3) =       0.000435580712
  error estimate for blocks of size 2^( 4) =       0.000446968773
  error estimate for blocks of size 2^( 5) =       0.000456548825
  error estimate for blocks of size 2^( 6) =       0.000463057071
  error estimate for blocks of size 2^( 7) =       0.000468005451

      target function =                  N/A
              le_mean =     -16.905907841451
             les_mean =     286.145941994803
             stat err =       0.000458645030
             autocorr =       1.251287104357
              std dev =       0.579846720514
             le_variance =       0.336222219290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336450165461
                                         uncertainty =       0.004106571589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336450165461
                                         uncertainty =       0.004106571589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410112048
  error estimate for blocks of size 2^( 2) =       0.000422617783
  error estimate for blocks of size 2^( 3) =       0.000435665216
  error estimate for blocks of size 2^( 4) =       0.000447047962
  error estimate for blocks of size 2^( 5) =       0.000456621697
  error estimate for blocks of size 2^( 6) =       0.000463127651
  error estimate for blocks of size 2^( 7) =       0.000468077694

      target function =                  N/A
              le_mean =     -16.905909878715
             les_mean =     286.146172442115
             stat err =       0.000458718751
             autocorr =       1.251088209495
              std dev =       0.579986019712
             le_variance =       0.336383783062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336376241193
                                         uncertainty =       0.004105180211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336376241193
                                         uncertainty =       0.004105180211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410066992
  error estimate for blocks of size 2^( 2) =       0.000422575961
  error estimate for blocks of size 2^( 3) =       0.000435626534
  error estimate for blocks of size 2^( 4) =       0.000447011719
  error estimate for blocks of size 2^( 5) =       0.000456588299
  error estimate for blocks of size 2^( 6) =       0.000463095486
  error estimate for blocks of size 2^( 7) =       0.000468045032

      target function =                  N/A
              le_mean =     -16.905908969128
             les_mean =     286.146067780766
             stat err =       0.000458685134
             autocorr =       1.251179741130
              std dev =       0.579922302103
             le_variance =       0.336309876476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336299508042
                                         uncertainty =       0.004103741556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336299508042
                                         uncertainty =       0.004103741556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410020223
  error estimate for blocks of size 2^( 2) =       0.000422532730
  error estimate for blocks of size 2^( 3) =       0.000435586418
  error estimate for blocks of size 2^( 4) =       0.000446974114
  error estimate for blocks of size 2^( 5) =       0.000456553724
  error estimate for blocks of size 2^( 6) =       0.000463061838
  error estimate for blocks of size 2^( 7) =       0.000468010381

      target function =                  N/A
              le_mean =     -16.905907985940
             les_mean =     286.145957828035
             stat err =       0.000458650015
             autocorr =       1.251273559334
              std dev =       0.579856160686
             le_variance =       0.336233167086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905907841451        initial
     9.7656e-01     9.7656e+00             3.7617e-04       -16.905909878715  <--
     3.9062e+00     3.9062e+01             9.7876e-05       -16.905908969128
     1.5625e+01     1.5625e+02             2.4709e-05       -16.905907985940

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.0143e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009772e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716613e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461301e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810532e-02 1 1  ON 12
 ud_3                -1.153562e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494833e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339124e-02 1 1  ON 27
 eO_8                -2.038094e-01 1 1  ON 28
 eO_9                -6.408720e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584471e-02 1 1  ON 33
eH1_4                 1.146492e-02 1 1  ON 34
eH1_5                 4.510730e-02 1 1  ON 35
eH1_6                 9.872713e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556259e-01 1 1  ON 38
eH1_9                 4.154685e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695783e-02 1 1  ON 42
eH2_3                -3.391450e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9647
    reference variance = 0.402523
====================================================
  Execution time = 2.2743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3043e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330461263364
                                         uncertainty =       0.003168487009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330461263364
                                         uncertainty =       0.003168487009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406465187
  error estimate for blocks of size 2^( 2) =       0.000418866094
  error estimate for blocks of size 2^( 3) =       0.000431984690
  error estimate for blocks of size 2^( 4) =       0.000443819596
  error estimate for blocks of size 2^( 5) =       0.000454870455
  error estimate for blocks of size 2^( 6) =       0.000461909469
  error estimate for blocks of size 2^( 7) =       0.000466322199

      target function =                  N/A
              le_mean =     -16.905895851727
             les_mean =     286.139742281037
             stat err =       0.000456730430
             autocorr =       1.262621513461
              std dev =       0.574828580361
             le_variance =       0.330427896800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589585173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895851727       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905897642459       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898894849       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898328231       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905900542521       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905901588786       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905901145221       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905901038587       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905901550095       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905901278672       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905901360555       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 9.535902e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895851727       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905896486566       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905896815868       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905896595063       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905897535528       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905897410064       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905897257132       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905897340692       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905897336610       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.373570e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895851727       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905896028960       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905896108993       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905896051332       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905896316163       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905896255547       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905896201043       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905896228141       residual = 9.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.005285e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8330e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.069438e-01 1 1  ON 0
 uu_1                 1.407657e-01 1 1  ON 1
 uu_2                 4.015918e-02 1 1  ON 2
 uu_3                -2.108539e-02 1 1  ON 3
 uu_4                -6.455601e-02 1 1  ON 4
 uu_5                -9.721923e-02 1 1  ON 5
 uu_6                -1.230398e-01 1 1  ON 6
 uu_7                -1.346190e-01 1 1  ON 7
 uu_8                -1.260910e-01 1 1  ON 8
 uu_9                -9.469579e-02 1 1  ON 9
 ud_0                 4.423677e-01 1 1  ON 10
 ud_1                 1.771834e-01 1 1  ON 11
 ud_2                 5.823755e-02 1 1  ON 12
 ud_3                -1.163464e-02 1 1  ON 13
 ud_4                -6.724952e-02 1 1  ON 14
 ud_5                -1.070796e-01 1 1  ON 15
 ud_6                -1.331277e-01 1 1  ON 16
 ud_7                -1.483241e-01 1 1  ON 17
 ud_8                -1.496188e-01 1 1  ON 18
 ud_9                -1.365116e-01 1 1  ON 19
 eO_0                -7.501666e-01 1 1  ON 20
 eO_1                -4.316823e-01 1 1  ON 21
 eO_2                -1.653675e-02 1 1  ON 22
 eO_3                 2.966851e-01 1 1  ON 23
 eO_4                 5.128650e-01 1 1  ON 24
 eO_5                 4.683229e-01 1 1  ON 25
 eO_6                 2.399482e-01 1 1  ON 26
 eO_7                -5.339613e-02 1 1  ON 27
 eO_8                -2.039720e-01 1 1  ON 28
 eO_9                -6.419945e-02 1 1  ON 29
eH1_0                -2.335620e-01 1 1  ON 30
eH1_1                -1.345932e-01 1 1  ON 31
eH1_2                -8.887783e-02 1 1  ON 32
eH1_3                -3.592203e-02 1 1  ON 33
eH1_4                 1.152014e-02 1 1  ON 34
eH1_5                 4.506639e-02 1 1  ON 35
eH1_6                 9.877654e-02 1 1  ON 36
eH1_7                 1.440518e-01 1 1  ON 37
eH1_8                 1.557912e-01 1 1  ON 38
eH1_9                 4.173920e-02 1 1  ON 39
eH2_0                -2.315121e-01 1 1  ON 40
eH2_1                -1.328116e-01 1 1  ON 41
eH2_2                -8.706886e-02 1 1  ON 42
eH2_3                -3.390762e-02 1 1  ON 43
eH2_4                 1.401485e-02 1 1  ON 44
eH2_5                 4.800732e-02 1 1  ON 45
eH2_6                 1.021179e-01 1 1  ON 46
eH2_7                 1.499807e-01 1 1  ON 47
eH2_8                 1.634594e-01 1 1  ON 48
eH2_9                 2.522813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8413
    reference variance = 0.377152
====================================================
  Execution time = 2.0455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6325e-01
  Total weights = 2.0000e+06
  Execution time = 1.8997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363036539996
                                         uncertainty =       0.025027386574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363036539996
                                         uncertainty =       0.025027386574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426034581
  error estimate for blocks of size 2^( 2) =       0.000438494819
  error estimate for blocks of size 2^( 3) =       0.000451765392
  error estimate for blocks of size 2^( 4) =       0.000463966072
  error estimate for blocks of size 2^( 5) =       0.000473854395
  error estimate for blocks of size 2^( 6) =       0.000483232327
  error estimate for blocks of size 2^( 7) =       0.000490536399

      target function =                  N/A
              le_mean =     -16.905747638364
             les_mean =     286.167313958796
             stat err =       0.000477897298
             autocorr =       1.258286239135
              std dev =       0.602503882346
             le_variance =       0.363010928242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363681706534
                                         uncertainty =       0.025037302091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363681706534
                                         uncertainty =       0.025037302091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426412911
  error estimate for blocks of size 2^( 2) =       0.000438852670
  error estimate for blocks of size 2^( 3) =       0.000452096650
  error estimate for blocks of size 2^( 4) =       0.000464270247
  error estimate for blocks of size 2^( 5) =       0.000474146024
  error estimate for blocks of size 2^( 6) =       0.000483523618
  error estimate for blocks of size 2^( 7) =       0.000490829807

      target function =                  N/A
              le_mean =     -16.905745028853
             les_mean =     286.167870740671
             stat err =       0.000478192424
             autocorr =       1.257606259041
              std dev =       0.603038922393
             le_variance =       0.363655941921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363515111953
                                         uncertainty =       0.025035174415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363515111953
                                         uncertainty =       0.025035174415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426315231
  error estimate for blocks of size 2^( 2) =       0.000438760523
  error estimate for blocks of size 2^( 3) =       0.000452012412
  error estimate for blocks of size 2^( 4) =       0.000464194438
  error estimate for blocks of size 2^( 5) =       0.000474074720
  error estimate for blocks of size 2^( 6) =       0.000483452538
  error estimate for blocks of size 2^( 7) =       0.000490754787

      target function =                  N/A
              le_mean =     -16.905745034481
             les_mean =     286.167704341131
             stat err =       0.000478119121
             autocorr =       1.257796920838
              std dev =       0.602900781222
             le_variance =       0.363489351998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363106789754
                                         uncertainty =       0.025028679415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363106789754
                                         uncertainty =       0.025028679415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426075787
  error estimate for blocks of size 2^( 2) =       0.000438533891
  error estimate for blocks of size 2^( 3) =       0.000451801866
  error estimate for blocks of size 2^( 4) =       0.000463999890
  error estimate for blocks of size 2^( 5) =       0.000473887233
  error estimate for blocks of size 2^( 6) =       0.000483265049
  error estimate for blocks of size 2^( 7) =       0.000490568357

      target function =                  N/A
              le_mean =     -16.905747073533
             les_mean =     286.167365085763
             stat err =       0.000477930132
             autocorr =       1.258215741905
              std dev =       0.602562156976
             le_variance =       0.363081153020


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905747638364        initial  <--
     2.4414e-01     2.4414e+00             9.5359e-04       -16.905745028853
     9.7656e-01     9.7656e+00             3.3736e-04       -16.905745034481
     3.9062e+00     3.9062e+01             1.0053e-04       -16.905747073533

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0325
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009772e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716613e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461301e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810532e-02 1 1  ON 12
 ud_3                -1.153562e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494833e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339124e-02 1 1  ON 27
 eO_8                -2.038094e-01 1 1  ON 28
 eO_9                -6.408720e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584471e-02 1 1  ON 33
eH1_4                 1.146492e-02 1 1  ON 34
eH1_5                 4.510730e-02 1 1  ON 35
eH1_6                 9.872713e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556259e-01 1 1  ON 38
eH1_9                 4.154685e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695783e-02 1 1  ON 42
eH2_3                -3.391450e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8375e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9169
    reference variance = 0.188679
====================================================
  Execution time = 2.0881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3662e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336663513507
                                         uncertainty =       0.003796655773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336663513507
                                         uncertainty =       0.003796655773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410255717
  error estimate for blocks of size 2^( 2) =       0.000423190185
  error estimate for blocks of size 2^( 3) =       0.000436229071
  error estimate for blocks of size 2^( 4) =       0.000449121855
  error estimate for blocks of size 2^( 5) =       0.000458996512
  error estimate for blocks of size 2^( 6) =       0.000467650696
  error estimate for blocks of size 2^( 7) =       0.000472735143

      target function =                  N/A
              le_mean =     -16.906010328039
             les_mean =     286.149804549906
             stat err =       0.000462126052
             autocorr =       1.268853905131
              std dev =       0.580189198858
             le_variance =       0.336619506472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601032804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906010328039       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906010118791       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906010479407       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906010409842       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906010710478       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906010858655       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906010935334       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906010904441       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.557019e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906010328039       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906010272937       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906010368703       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906010353811       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906010435287       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906010470568       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906010482130       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906010483056       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.990670e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906010328039       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906010314077       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906010338397       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906010334877       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906010355702       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906010364345       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906010366907       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906010367782       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.004532e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6394e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.067911e-01 1 1  ON 0
 uu_1                 1.406980e-01 1 1  ON 1
 uu_2                 4.009970e-02 1 1  ON 2
 uu_3                -2.106474e-02 1 1  ON 3
 uu_4                -6.453137e-02 1 1  ON 4
 uu_5                -9.718466e-02 1 1  ON 5
 uu_6                -1.228764e-01 1 1  ON 6
 uu_7                -1.345279e-01 1 1  ON 7
 uu_8                -1.259899e-01 1 1  ON 8
 uu_9                -9.461720e-02 1 1  ON 9
 ud_0                 4.420595e-01 1 1  ON 10
 ud_1                 1.770738e-01 1 1  ON 11
 ud_2                 5.810706e-02 1 1  ON 12
 ud_3                -1.153272e-02 1 1  ON 13
 ud_4                -6.719363e-02 1 1  ON 14
 ud_5                -1.070325e-01 1 1  ON 15
 ud_6                -1.331243e-01 1 1  ON 16
 ud_7                -1.481217e-01 1 1  ON 17
 ud_8                -1.494886e-01 1 1  ON 18
 ud_9                -1.364688e-01 1 1  ON 19
 eO_0                -7.499690e-01 1 1  ON 20
 eO_1                -4.314484e-01 1 1  ON 21
 eO_2                -1.658865e-02 1 1  ON 22
 eO_3                 2.965847e-01 1 1  ON 23
 eO_4                 5.126469e-01 1 1  ON 24
 eO_5                 4.681208e-01 1 1  ON 25
 eO_6                 2.398212e-01 1 1  ON 26
 eO_7                -5.339282e-02 1 1  ON 27
 eO_8                -2.038232e-01 1 1  ON 28
 eO_9                -6.409861e-02 1 1  ON 29
eH1_0                -2.333538e-01 1 1  ON 30
eH1_1                -1.345339e-01 1 1  ON 31
eH1_2                -8.874201e-02 1 1  ON 32
eH1_3                -3.585100e-02 1 1  ON 33
eH1_4                 1.147569e-02 1 1  ON 34
eH1_5                 4.510487e-02 1 1  ON 35
eH1_6                 9.872361e-02 1 1  ON 36
eH1_7                 1.440025e-01 1 1  ON 37
eH1_8                 1.556439e-01 1 1  ON 38
eH1_9                 4.156612e-02 1 1  ON 39
eH2_0                -2.312850e-01 1 1  ON 40
eH2_1                -1.327514e-01 1 1  ON 41
eH2_2                -8.696146e-02 1 1  ON 42
eH2_3                -3.390501e-02 1 1  ON 43
eH2_4                 1.398750e-02 1 1  ON 44
eH2_5                 4.807885e-02 1 1  ON 45
eH2_6                 1.021248e-01 1 1  ON 46
eH2_7                 1.499008e-01 1 1  ON 47
eH2_8                 1.633019e-01 1 1  ON 48
eH2_9                 2.503491e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.916
    reference variance = 0.198236
====================================================
  Execution time = 2.0567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3841e-01
  Total weights = 2.0000e+06
  Execution time = 1.8951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338420816278
                                         uncertainty =       0.007564129396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338420816278
                                         uncertainty =       0.007564129396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411325716
  error estimate for blocks of size 2^( 2) =       0.000424090004
  error estimate for blocks of size 2^( 3) =       0.000437741478
  error estimate for blocks of size 2^( 4) =       0.000449765452
  error estimate for blocks of size 2^( 5) =       0.000461029857
  error estimate for blocks of size 2^( 6) =       0.000469436673
  error estimate for blocks of size 2^( 7) =       0.000476042294

      target function =                  N/A
              le_mean =     -16.906226933926
             les_mean =     286.158886661703
             stat err =       0.000464068569
             autocorr =       1.272895012945
              std dev =       0.581702406296
             le_variance =       0.338377689490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338525001872
                                         uncertainty =       0.007567663372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338525001872
                                         uncertainty =       0.007567663372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411389020
  error estimate for blocks of size 2^( 2) =       0.000424149522
  error estimate for blocks of size 2^( 3) =       0.000437797418
  error estimate for blocks of size 2^( 4) =       0.000449818976
  error estimate for blocks of size 2^( 5) =       0.000461082108
  error estimate for blocks of size 2^( 6) =       0.000469486867
  error estimate for blocks of size 2^( 7) =       0.000476091528

      target function =                  N/A
              le_mean =     -16.906226881104
             les_mean =     286.158989037609
             stat err =       0.000464119870
             autocorr =       1.272784657873
              std dev =       0.581791931440
             le_variance =       0.338481851488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338477299834
                                         uncertainty =       0.007566139264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338477299834
                                         uncertainty =       0.007566139264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411360037
  error estimate for blocks of size 2^( 2) =       0.000424122268
  error estimate for blocks of size 2^( 3) =       0.000437771810
  error estimate for blocks of size 2^( 4) =       0.000449794480
  error estimate for blocks of size 2^( 5) =       0.000461058223
  error estimate for blocks of size 2^( 6) =       0.000469463961
  error estimate for blocks of size 2^( 7) =       0.000476069077

      target function =                  N/A
              le_mean =     -16.906226897965
             les_mean =     286.158941916629
             stat err =       0.000464096435
             autocorr =       1.272835466596
              std dev =       0.581750943589
             le_variance =       0.338434160367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338428035170
                                         uncertainty =       0.007564394820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338428035170
                                         uncertainty =       0.007564394820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411330103
  error estimate for blocks of size 2^( 2) =       0.000424094127
  error estimate for blocks of size 2^( 3) =       0.000437745354
  error estimate for blocks of size 2^( 4) =       0.000449769161
  error estimate for blocks of size 2^( 5) =       0.000461033482
  error estimate for blocks of size 2^( 6) =       0.000469440161
  error estimate for blocks of size 2^( 7) =       0.000476045720

      target function =                  N/A
              le_mean =     -16.906226928584
             les_mean =     286.158893698339
             stat err =       0.000464072131
             autocorr =       1.272887404111
              std dev =       0.581708609831
             le_variance =       0.338384906752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906226933926        initial  <--
     2.4414e+00     2.4414e+01             1.5570e-04       -16.906226881104
     9.7656e+00     9.7656e+01             3.9907e-05       -16.906226897965
     3.9062e+01     3.9062e+02             1.0045e-05       -16.906226928584

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1388
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009772e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716613e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461301e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810532e-02 1 1  ON 12
 ud_3                -1.153562e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494833e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339124e-02 1 1  ON 27
 eO_8                -2.038094e-01 1 1  ON 28
 eO_9                -6.408720e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584471e-02 1 1  ON 33
eH1_4                 1.146492e-02 1 1  ON 34
eH1_5                 4.510730e-02 1 1  ON 35
eH1_6                 9.872713e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556259e-01 1 1  ON 38
eH1_9                 4.154685e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695783e-02 1 1  ON 42
eH2_3                -3.391450e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6539e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.923
    reference variance = 0.212117
====================================================
  Execution time = 2.0977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3384e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333884654534
                                         uncertainty =       0.002683551514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333884654534
                                         uncertainty =       0.002683551514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408557999
  error estimate for blocks of size 2^( 2) =       0.000421621209
  error estimate for blocks of size 2^( 3) =       0.000435135106
  error estimate for blocks of size 2^( 4) =       0.000447986649
  error estimate for blocks of size 2^( 5) =       0.000460312575
  error estimate for blocks of size 2^( 6) =       0.000469673868
  error estimate for blocks of size 2^( 7) =       0.000476190120

      target function =                  N/A
              le_mean =     -16.906118740911
             les_mean =     286.150689992164
             stat err =       0.000463540803
             autocorr =       1.287266601594
              std dev =       0.577788263368
             le_variance =       0.333839277286


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611874091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118740911       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118780133       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118800285       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906118801430       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118797253       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906118808317       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906118806282       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906118808161       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.394808e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118740911       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118750768       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118755858       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906118756116       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118755029       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906118757743       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906118757252       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906118757706       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.489485e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118740911       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118743379       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118744655       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906118744717       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118744443       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906118745118       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906118744996       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906118745109       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 8.725253e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6669e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.067816e-01 1 1  ON 0
 uu_1                 1.406919e-01 1 1  ON 1
 uu_2                 4.009784e-02 1 1  ON 2
 uu_3                -2.104988e-02 1 1  ON 3
 uu_4                -6.451372e-02 1 1  ON 4
 uu_5                -9.716773e-02 1 1  ON 5
 uu_6                -1.228916e-01 1 1  ON 6
 uu_7                -1.345313e-01 1 1  ON 7
 uu_8                -1.259814e-01 1 1  ON 8
 uu_9                -9.461274e-02 1 1  ON 9
 ud_0                 4.420324e-01 1 1  ON 10
 ud_1                 1.770681e-01 1 1  ON 11
 ud_2                 5.810550e-02 1 1  ON 12
 ud_3                -1.153717e-02 1 1  ON 13
 ud_4                -6.719384e-02 1 1  ON 14
 ud_5                -1.070299e-01 1 1  ON 15
 ud_6                -1.331117e-01 1 1  ON 16
 ud_7                -1.481133e-01 1 1  ON 17
 ud_8                -1.494821e-01 1 1  ON 18
 ud_9                -1.364658e-01 1 1  ON 19
 eO_0                -7.499319e-01 1 1  ON 20
 eO_1                -4.314342e-01 1 1  ON 21
 eO_2                -1.659367e-02 1 1  ON 22
 eO_3                 2.965682e-01 1 1  ON 23
 eO_4                 5.126172e-01 1 1  ON 24
 eO_5                 4.681001e-01 1 1  ON 25
 eO_6                 2.398156e-01 1 1  ON 26
 eO_7                -5.339093e-02 1 1  ON 27
 eO_8                -2.038108e-01 1 1  ON 28
 eO_9                -6.408808e-02 1 1  ON 29
eH1_0                -2.333394e-01 1 1  ON 30
eH1_1                -1.345250e-01 1 1  ON 31
eH1_2                -8.872868e-02 1 1  ON 32
eH1_3                -3.584493e-02 1 1  ON 33
eH1_4                 1.146598e-02 1 1  ON 34
eH1_5                 4.510709e-02 1 1  ON 35
eH1_6                 9.872773e-02 1 1  ON 36
eH1_7                 1.439978e-01 1 1  ON 37
eH1_8                 1.556273e-01 1 1  ON 38
eH1_9                 4.154865e-02 1 1  ON 39
eH2_0                -2.312528e-01 1 1  ON 40
eH2_1                -1.327421e-01 1 1  ON 41
eH2_2                -8.695758e-02 1 1  ON 42
eH2_3                -3.391439e-02 1 1  ON 43
eH2_4                 1.399482e-02 1 1  ON 44
eH2_5                 4.807662e-02 1 1  ON 45
eH2_6                 1.021201e-01 1 1  ON 46
eH2_7                 1.498967e-01 1 1  ON 47
eH2_8                 1.632903e-01 1 1  ON 48
eH2_9                 2.501516e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9239
    reference variance = 0.211162
====================================================
  Execution time = 2.0295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4548e-01
  Total weights = 2.0000e+06
  Execution time = 1.9193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345520333844
                                         uncertainty =       0.009968929169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345520333844
                                         uncertainty =       0.009968929169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415621321
  error estimate for blocks of size 2^( 2) =       0.000428504164
  error estimate for blocks of size 2^( 3) =       0.000441326345
  error estimate for blocks of size 2^( 4) =       0.000453824930
  error estimate for blocks of size 2^( 5) =       0.000464339387
  error estimate for blocks of size 2^( 6) =       0.000472784812
  error estimate for blocks of size 2^( 7) =       0.000480587029

      target function =                  N/A
              le_mean =     -16.905730087347
             les_mean =     286.149191777668
             stat err =       0.000467884039
             autocorr =       1.267304057884
              std dev =       0.587777308313
             le_variance =       0.345482164168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345526787737
                                         uncertainty =       0.009969239104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345526787737
                                         uncertainty =       0.009969239104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415625202
  error estimate for blocks of size 2^( 2) =       0.000428507843
  error estimate for blocks of size 2^( 3) =       0.000441329791
  error estimate for blocks of size 2^( 4) =       0.000453828226
  error estimate for blocks of size 2^( 5) =       0.000464342607
  error estimate for blocks of size 2^( 6) =       0.000472787930
  error estimate for blocks of size 2^( 7) =       0.000480590098

      target function =                  N/A
              le_mean =     -16.905730028439
             les_mean =     286.149196237972
             stat err =       0.000467887215
             autocorr =       1.267297594307
              std dev =       0.587782796826
             le_variance =       0.345488616244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345523575853
                                         uncertainty =       0.009969085649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345523575853
                                         uncertainty =       0.009969085649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415623270
  error estimate for blocks of size 2^( 2) =       0.000428506012
  error estimate for blocks of size 2^( 3) =       0.000441328076
  error estimate for blocks of size 2^( 4) =       0.000453826586
  error estimate for blocks of size 2^( 5) =       0.000464341005
  error estimate for blocks of size 2^( 6) =       0.000472786379
  error estimate for blocks of size 2^( 7) =       0.000480588572

      target function =                  N/A
              le_mean =     -16.905730057482
             les_mean =     286.149194008950
             stat err =       0.000467885635
             autocorr =       1.267300815464
              std dev =       0.587780065374
             le_variance =       0.345485405251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345520739544
                                         uncertainty =       0.009968948776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345520739544
                                         uncertainty =       0.009968948776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415621564
  error estimate for blocks of size 2^( 2) =       0.000428504395
  error estimate for blocks of size 2^( 3) =       0.000441326561
  error estimate for blocks of size 2^( 4) =       0.000453825137
  error estimate for blocks of size 2^( 5) =       0.000464339590
  error estimate for blocks of size 2^( 6) =       0.000472785008
  error estimate for blocks of size 2^( 7) =       0.000480587222

      target function =                  N/A
              le_mean =     -16.905730083596
             les_mean =     286.149192056413
             stat err =       0.000467884239
             autocorr =       1.267303652230
              std dev =       0.587777653327
             le_variance =       0.345482569751


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905730087347        initial  <--
     2.4414e+01     2.4414e+02             1.3948e-05       -16.905730028439
     9.7656e+01     9.7656e+02             3.4895e-06       -16.905730057482
     3.9062e+02     3.9062e+03             8.7253e-07       -16.905730083596

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9023
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009772e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716613e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461301e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810532e-02 1 1  ON 12
 ud_3                -1.153562e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494833e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339124e-02 1 1  ON 27
 eO_8                -2.038094e-01 1 1  ON 28
 eO_9                -6.408720e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584471e-02 1 1  ON 33
eH1_4                 1.146492e-02 1 1  ON 34
eH1_5                 4.510730e-02 1 1  ON 35
eH1_6                 9.872713e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556259e-01 1 1  ON 38
eH1_9                 4.154685e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695783e-02 1 1  ON 42
eH2_3                -3.391450e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6578e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8592
    reference variance = 0.42284
====================================================
  Execution time = 2.0743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354749679475
                                         uncertainty =       0.014809246076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354749679475
                                         uncertainty =       0.014809246076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421132420
  error estimate for blocks of size 2^( 2) =       0.000433476213
  error estimate for blocks of size 2^( 3) =       0.000446051387
  error estimate for blocks of size 2^( 4) =       0.000458825936
  error estimate for blocks of size 2^( 5) =       0.000470155101
  error estimate for blocks of size 2^( 6) =       0.000477887279
  error estimate for blocks of size 2^( 7) =       0.000484476857

      target function =                  N/A
              le_mean =     -16.906057990319
             les_mean =     286.169501624441
             stat err =       0.000472836293
             autocorr =       1.260620185168
              std dev =       0.595571179438
             le_variance =       0.354705029777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690605799032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906057990319       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906057992144       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906057993410       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906057993832       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906057994056       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906057994236       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906057994581       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906057995331       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.345167e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906057990319       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906057990775       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906057991092       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906057991197       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906057991253       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906057991297       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906057991382       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906057991570       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 3.363462e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906057990319       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906057990433       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906057990512       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906057990538       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906057990552       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906057990568       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906057990585       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906057990633       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 8.408994e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103588 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6273e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.067807e-01 1 1  ON 0
 uu_1                 1.406916e-01 1 1  ON 1
 uu_2                 4.009769e-02 1 1  ON 2
 uu_3                -2.105014e-02 1 1  ON 3
 uu_4                -6.451376e-02 1 1  ON 4
 uu_5                -9.716617e-02 1 1  ON 5
 uu_6                -1.228910e-01 1 1  ON 6
 uu_7                -1.345301e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461309e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770675e-01 1 1  ON 11
 ud_2                 5.810534e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719216e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331107e-01 1 1  ON 16
 ud_7                -1.481129e-01 1 1  ON 17
 ud_8                -1.494835e-01 1 1  ON 18
 ud_9                -1.364666e-01 1 1  ON 19
 eO_0                -7.499294e-01 1 1  ON 20
 eO_1                -4.314315e-01 1 1  ON 21
 eO_2                -1.659434e-02 1 1  ON 22
 eO_3                 2.965680e-01 1 1  ON 23
 eO_4                 5.126150e-01 1 1  ON 24
 eO_5                 4.680978e-01 1 1  ON 25
 eO_6                 2.398141e-01 1 1  ON 26
 eO_7                -5.339119e-02 1 1  ON 27
 eO_8                -2.038096e-01 1 1  ON 28
 eO_9                -6.408734e-02 1 1  ON 29
eH1_0                -2.333362e-01 1 1  ON 30
eH1_1                -1.345233e-01 1 1  ON 31
eH1_2                -8.872813e-02 1 1  ON 32
eH1_3                -3.584468e-02 1 1  ON 33
eH1_4                 1.146491e-02 1 1  ON 34
eH1_5                 4.510738e-02 1 1  ON 35
eH1_6                 9.872720e-02 1 1  ON 36
eH1_7                 1.439968e-01 1 1  ON 37
eH1_8                 1.556261e-01 1 1  ON 38
eH1_9                 4.154696e-02 1 1  ON 39
eH2_0                -2.312504e-01 1 1  ON 40
eH2_1                -1.327409e-01 1 1  ON 41
eH2_2                -8.695771e-02 1 1  ON 42
eH2_3                -3.391445e-02 1 1  ON 43
eH2_4                 1.399513e-02 1 1  ON 44
eH2_5                 4.807712e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498959e-01 1 1  ON 47
eH2_8                 1.632885e-01 1 1  ON 48
eH2_9                 2.501357e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 0.18991
====================================================
  Execution time = 2.0471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4908e-01
  Total weights = 2.0000e+06
  Execution time = 1.8903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348634917564
                                         uncertainty =       0.007525802877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348634917564
                                         uncertainty =       0.007525802877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417779075
  error estimate for blocks of size 2^( 2) =       0.000430609206
  error estimate for blocks of size 2^( 3) =       0.000443511891
  error estimate for blocks of size 2^( 4) =       0.000456307558
  error estimate for blocks of size 2^( 5) =       0.000467648900
  error estimate for blocks of size 2^( 6) =       0.000475382381
  error estimate for blocks of size 2^( 7) =       0.000479404846

      target function =                  N/A
              le_mean =     -16.905593464046
             les_mean =     286.148168908517
             stat err =       0.000469685921
             autocorr =       1.263926199987
              std dev =       0.590828834324
             le_variance =       0.349078711469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348635193532
                                         uncertainty =       0.007525776938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348635193532
                                         uncertainty =       0.007525776938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417779241
  error estimate for blocks of size 2^( 2) =       0.000430609354
  error estimate for blocks of size 2^( 3) =       0.000443512016
  error estimate for blocks of size 2^( 4) =       0.000456307670
  error estimate for blocks of size 2^( 5) =       0.000467649009
  error estimate for blocks of size 2^( 6) =       0.000475382503
  error estimate for blocks of size 2^( 7) =       0.000479404983

      target function =                  N/A
              le_mean =     -16.905593460406
             les_mean =     286.148169063092
             stat err =       0.000469686041
             autocorr =       1.263925839747
              std dev =       0.590829069272
             le_variance =       0.349078989097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348635055378
                                         uncertainty =       0.007525789879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348635055378
                                         uncertainty =       0.007525789879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417779158
  error estimate for blocks of size 2^( 2) =       0.000430609280
  error estimate for blocks of size 2^( 3) =       0.000443511953
  error estimate for blocks of size 2^( 4) =       0.000456307614
  error estimate for blocks of size 2^( 5) =       0.000467648954
  error estimate for blocks of size 2^( 6) =       0.000475382442
  error estimate for blocks of size 2^( 7) =       0.000479404914

      target function =                  N/A
              le_mean =     -16.905593462225
             les_mean =     286.148168985601
             stat err =       0.000469685981
             autocorr =       1.263926020008
              std dev =       0.590828951655
             le_variance =       0.349078850113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348634934785
                                         uncertainty =       0.007525801251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348634934785
                                         uncertainty =       0.007525801251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417779086
  error estimate for blocks of size 2^( 2) =       0.000430609216
  error estimate for blocks of size 2^( 3) =       0.000443511899
  error estimate for blocks of size 2^( 4) =       0.000456307565
  error estimate for blocks of size 2^( 5) =       0.000467648907
  error estimate for blocks of size 2^( 6) =       0.000475382389
  error estimate for blocks of size 2^( 7) =       0.000479404854

      target function =                  N/A
              le_mean =     -16.905593463818
             les_mean =     286.148168918144
             stat err =       0.000469685929
             autocorr =       1.263926177495
              std dev =       0.590828848986
             le_variance =       0.349078728794


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905593464046        initial  <--
     2.4414e+02     2.4414e+03             1.3452e-06       -16.905593460406
     9.7656e+02     9.7656e+03             3.3635e-07       -16.905593462225
     3.9062e+03     3.9062e+04             8.4090e-08       -16.905593463818

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0133
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009772e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716613e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461301e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810532e-02 1 1  ON 12
 ud_3                -1.153562e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494833e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339124e-02 1 1  ON 27
 eO_8                -2.038094e-01 1 1  ON 28
 eO_9                -6.408720e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584471e-02 1 1  ON 33
eH1_4                 1.146492e-02 1 1  ON 34
eH1_5                 4.510730e-02 1 1  ON 35
eH1_6                 9.872713e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556259e-01 1 1  ON 38
eH1_9                 4.154685e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695783e-02 1 1  ON 42
eH2_3                -3.391450e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6292e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9127
    reference variance = 0.366795
====================================================
  Execution time = 2.0778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3253e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332578665304
                                         uncertainty =       0.002668978904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332578665304
                                         uncertainty =       0.002668978904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407755454
  error estimate for blocks of size 2^( 2) =       0.000420380070
  error estimate for blocks of size 2^( 3) =       0.000433652730
  error estimate for blocks of size 2^( 4) =       0.000447082448
  error estimate for blocks of size 2^( 5) =       0.000456905392
  error estimate for blocks of size 2^( 6) =       0.000466263673
  error estimate for blocks of size 2^( 7) =       0.000471762032

      target function =                  N/A
              le_mean =     -16.905815480114
             les_mean =     286.139125901406
             stat err =       0.000460503386
             autocorr =       1.275457815985
              std dev =       0.576653292719
             le_variance =       0.332529020004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581548011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905815480114       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905815480354       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905815480485       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905815480791       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905815480922       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905815480783       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905815480868       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905815480830       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.262666e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905815480114       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905815480174       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905815480207       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905815480280       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905815480320       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905815480278       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905815480305       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905815480298       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 3.156730e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905815480114       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905815480129       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905815480137       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905815480156       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905815480165       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905815480166       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905815480141       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905815480183       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 7.891866e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6390e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009772e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451375e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461302e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810532e-02 1 1  ON 12
 ud_3                -1.153562e-02 1 1  ON 13
 ud_4                -6.719213e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494833e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659444e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339123e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408721e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872798e-02 1 1  ON 32
eH1_3                -3.584470e-02 1 1  ON 33
eH1_4                 1.146492e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872712e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154687e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399507e-02 1 1  ON 44
eH2_5                 4.807720e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501342e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9293
    reference variance = 0.193329
====================================================
  Execution time = 2.0472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3403e-01
  Total weights = 2.0000e+06
  Execution time = 1.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334015531739
                                         uncertainty =       0.003758829672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334015531739
                                         uncertainty =       0.003758829672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408677799
  error estimate for blocks of size 2^( 2) =       0.000421816162
  error estimate for blocks of size 2^( 3) =       0.000435517589
  error estimate for blocks of size 2^( 4) =       0.000448923593
  error estimate for blocks of size 2^( 5) =       0.000459277877
  error estimate for blocks of size 2^( 6) =       0.000465014318
  error estimate for blocks of size 2^( 7) =       0.000471521614

      target function =                  N/A
              le_mean =     -16.905878722940
             les_mean =     286.142770314522
             stat err =       0.000461184350
             autocorr =       1.273465053676
              std dev =       0.577957685970
             le_variance =       0.334035086772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334015591212
                                         uncertainty =       0.003758829999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334015591212
                                         uncertainty =       0.003758829999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408677835
  error estimate for blocks of size 2^( 2) =       0.000421816196
  error estimate for blocks of size 2^( 3) =       0.000435517620
  error estimate for blocks of size 2^( 4) =       0.000448923622
  error estimate for blocks of size 2^( 5) =       0.000459277906
  error estimate for blocks of size 2^( 6) =       0.000465014345
  error estimate for blocks of size 2^( 7) =       0.000471521639

      target function =                  N/A
              le_mean =     -16.905878722836
             les_mean =     286.142770370499
             stat err =       0.000461184378
             autocorr =       1.273464980769
              std dev =       0.577957737441
             le_variance =       0.334035146268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334015561477
                                         uncertainty =       0.003758829836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334015561477
                                         uncertainty =       0.003758829836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408677817
  error estimate for blocks of size 2^( 2) =       0.000421816179
  error estimate for blocks of size 2^( 3) =       0.000435517605
  error estimate for blocks of size 2^( 4) =       0.000448923608
  error estimate for blocks of size 2^( 5) =       0.000459277891
  error estimate for blocks of size 2^( 6) =       0.000465014331
  error estimate for blocks of size 2^( 7) =       0.000471521626

      target function =                  N/A
              le_mean =     -16.905878722888
             les_mean =     286.142770342512
             stat err =       0.000461184364
             autocorr =       1.273465017221
              std dev =       0.577957711707
             le_variance =       0.334035116522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334015535456
                                         uncertainty =       0.003758829693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334015535456
                                         uncertainty =       0.003758829693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408677801
  error estimate for blocks of size 2^( 2) =       0.000421816164
  error estimate for blocks of size 2^( 3) =       0.000435517591
  error estimate for blocks of size 2^( 4) =       0.000448923595
  error estimate for blocks of size 2^( 5) =       0.000459277879
  error estimate for blocks of size 2^( 6) =       0.000465014319
  error estimate for blocks of size 2^( 7) =       0.000471521615

      target function =                  N/A
              le_mean =     -16.905878722934
             les_mean =     286.142770318021
             stat err =       0.000461184352
             autocorr =       1.273465049115
              std dev =       0.577957689188
             le_variance =       0.334035090491


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905878722940        initial  <--
     2.4414e+03     2.4414e+04             1.2627e-07       -16.905878722836
     9.7656e+03     9.7656e+04             3.1567e-08       -16.905878722888
     3.9062e+04     3.9062e+05             7.8919e-09       -16.905878722934

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0335
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009772e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716613e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461301e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810532e-02 1 1  ON 12
 ud_3                -1.153562e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494833e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339124e-02 1 1  ON 27
 eO_8                -2.038094e-01 1 1  ON 28
 eO_9                -6.408720e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584471e-02 1 1  ON 33
eH1_4                 1.146492e-02 1 1  ON 34
eH1_5                 4.510730e-02 1 1  ON 35
eH1_6                 9.872713e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556259e-01 1 1  ON 38
eH1_9                 4.154685e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695783e-02 1 1  ON 42
eH2_3                -3.391450e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9702
    reference variance = 0.230377
====================================================
  Execution time = 2.0834e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3137e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331395970290
                                         uncertainty =       0.003626519949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331395970290
                                         uncertainty =       0.003626519949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407044990
  error estimate for blocks of size 2^( 2) =       0.000420154762
  error estimate for blocks of size 2^( 3) =       0.000433422017
  error estimate for blocks of size 2^( 4) =       0.000445420943
  error estimate for blocks of size 2^( 5) =       0.000455997957
  error estimate for blocks of size 2^( 6) =       0.000464944720
  error estimate for blocks of size 2^( 7) =       0.000469848704

      target function =                  N/A
              le_mean =     -16.905698786438
             les_mean =     286.134022540058
             stat err =       0.000459053081
             autocorr =       1.271864909918
              std dev =       0.575648545523
             le_variance =       0.331371247963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569878644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698786438       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698786476       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698786495       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698786500       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698786483       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698786479       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698786514       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698786502       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.364663e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698786438       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698786448       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698786452       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698786418       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698786450       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698786425       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698786472       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698786489       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 3.411661e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698786438       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698786441       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698786442       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698786419       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698786315       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698786254       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698786314       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698786411       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 8.529154e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6368e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009772e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451374e-02 1 1  ON 4
 uu_5                -9.716613e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461301e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810532e-02 1 1  ON 12
 ud_3                -1.153562e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494833e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339124e-02 1 1  ON 27
 eO_8                -2.038094e-01 1 1  ON 28
 eO_9                -6.408720e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584471e-02 1 1  ON 33
eH1_4                 1.146492e-02 1 1  ON 34
eH1_5                 4.510730e-02 1 1  ON 35
eH1_6                 9.872713e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556259e-01 1 1  ON 38
eH1_9                 4.154685e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695783e-02 1 1  ON 42
eH2_3                -3.391449e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9025
    reference variance = 0.209849
====================================================
  Execution time = 2.2430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4093e-01
  Total weights = 2.0000e+06
  Execution time = 1.8867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340921070907
                                         uncertainty =       0.004238848821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340921070907
                                         uncertainty =       0.004238848821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412871672
  error estimate for blocks of size 2^( 2) =       0.000425565305
  error estimate for blocks of size 2^( 3) =       0.000439100582
  error estimate for blocks of size 2^( 4) =       0.000451318241
  error estimate for blocks of size 2^( 5) =       0.000462507177
  error estimate for blocks of size 2^( 6) =       0.000470334785
  error estimate for blocks of size 2^( 7) =       0.000474430425

      target function =                  N/A
              le_mean =     -16.905838201011
             les_mean =     286.148291143021
             stat err =       0.000464647657
             autocorr =       1.266535397201
              std dev =       0.583888717744
             le_variance =       0.340926034709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340921081398
                                         uncertainty =       0.004238849065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340921081398
                                         uncertainty =       0.004238849065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412871678
  error estimate for blocks of size 2^( 2) =       0.000425565311
  error estimate for blocks of size 2^( 3) =       0.000439100588
  error estimate for blocks of size 2^( 4) =       0.000451318247
  error estimate for blocks of size 2^( 5) =       0.000462507183
  error estimate for blocks of size 2^( 6) =       0.000470334790
  error estimate for blocks of size 2^( 7) =       0.000474430431

      target function =                  N/A
              le_mean =     -16.905838201092
             les_mean =     286.148291156226
             stat err =       0.000464647663
             autocorr =       1.266535387499
              std dev =       0.583888726729
             le_variance =       0.340926045201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340921076152
                                         uncertainty =       0.004238848943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340921076152
                                         uncertainty =       0.004238848943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412871675
  error estimate for blocks of size 2^( 2) =       0.000425565308
  error estimate for blocks of size 2^( 3) =       0.000439100585
  error estimate for blocks of size 2^( 4) =       0.000451318244
  error estimate for blocks of size 2^( 5) =       0.000462507180
  error estimate for blocks of size 2^( 6) =       0.000470334788
  error estimate for blocks of size 2^( 7) =       0.000474430428

      target function =                  N/A
              le_mean =     -16.905838201051
             les_mean =     286.148291149623
             stat err =       0.000464647660
             autocorr =       1.266535392356
              std dev =       0.583888722236
             le_variance =       0.340926039955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340921071562
                                         uncertainty =       0.004238848837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340921071562
                                         uncertainty =       0.004238848837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412871672
  error estimate for blocks of size 2^( 2) =       0.000425565305
  error estimate for blocks of size 2^( 3) =       0.000439100583
  error estimate for blocks of size 2^( 4) =       0.000451318242
  error estimate for blocks of size 2^( 5) =       0.000462507178
  error estimate for blocks of size 2^( 6) =       0.000470334785
  error estimate for blocks of size 2^( 7) =       0.000474430426

      target function =                  N/A
              le_mean =     -16.905838201016
             les_mean =     286.148291143846
             stat err =       0.000464647658
             autocorr =       1.266535396607
              std dev =       0.583888718306
             le_variance =       0.340926035364


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905838201011        initial
     2.4414e+04     2.4414e+05             1.3647e-08       -16.905838201092  <--
     9.7656e+04     9.7656e+05             3.4117e-09       -16.905838201051
     3.9062e+05     3.9062e+06             8.5292e-10       -16.905838201016

*****************************************************************************
Applying the update for shift_i =   2.4414e+04     and shift_s =   2.4414e+05
*****************************************************************************

  Execution time = 3.1962e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451374e-02 1 1  ON 4
 uu_5                -9.716613e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461301e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810532e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494833e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339123e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408720e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584471e-02 1 1  ON 33
eH1_4                 1.146491e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872713e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556259e-01 1 1  ON 38
eH1_9                 4.154686e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695783e-02 1 1  ON 42
eH2_3                -3.391449e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501341e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8352e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8796
    reference variance = 0.457455
====================================================
  Execution time = 2.0482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5578e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355886457573
                                         uncertainty =       0.019384763096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355886457573
                                         uncertainty =       0.019384763096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421770865
  error estimate for blocks of size 2^( 2) =       0.000434378618
  error estimate for blocks of size 2^( 3) =       0.000447413623
  error estimate for blocks of size 2^( 4) =       0.000458760199
  error estimate for blocks of size 2^( 5) =       0.000469278640
  error estimate for blocks of size 2^( 6) =       0.000475412690
  error estimate for blocks of size 2^( 7) =       0.000477892836

      target function =                  N/A
              le_mean =     -16.906538733799
             les_mean =     286.186833104398
             stat err =       0.000470336091
             autocorr =       1.243550593403
              std dev =       0.596474077252
             le_variance =       0.355781324833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653873380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906538733799       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906538733813       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906538733861       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906538733927       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906538733912       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906538733936       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906538733941       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906538733966       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 5.990533e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906538733799       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906538733803       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906538733815       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906538733831       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906538733823       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906538733833       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906538733834       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906538733846       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.497662e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906538733799       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906538733800       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906538733803       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906538733813       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906538733807       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906538733829       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906538733866       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906538733745       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 3.744171e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5996e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716613e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461302e-02 1 1  ON 9
 ud_0                 4.420303e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339123e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408721e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584471e-02 1 1  ON 33
eH1_4                 1.146492e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872712e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154687e-02 1 1  ON 39
eH2_0                -2.312501e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695783e-02 1 1  ON 42
eH2_3                -3.391449e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021203e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501341e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8022
    reference variance = 0.266488
====================================================
  Execution time = 2.0570e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4720e-01
  Total weights = 2.0000e+06
  Execution time = 1.8891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347235921094
                                         uncertainty =       0.007621849607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347235921094
                                         uncertainty =       0.007621849607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416655561
  error estimate for blocks of size 2^( 2) =       0.000429128066
  error estimate for blocks of size 2^( 3) =       0.000441955104
  error estimate for blocks of size 2^( 4) =       0.000454097343
  error estimate for blocks of size 2^( 5) =       0.000464636485
  error estimate for blocks of size 2^( 6) =       0.000472497902
  error estimate for blocks of size 2^( 7) =       0.000475171739

      target function =                  N/A
              le_mean =     -16.906106867233
             les_mean =     286.163652945808
             stat err =       0.000466600867
             autocorr =       1.254113139881
              std dev =       0.589239945284
             le_variance =       0.347203713119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347235952574
                                         uncertainty =       0.007621850746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347235952574
                                         uncertainty =       0.007621850746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416655580
  error estimate for blocks of size 2^( 2) =       0.000429128084
  error estimate for blocks of size 2^( 3) =       0.000441955120
  error estimate for blocks of size 2^( 4) =       0.000454097358
  error estimate for blocks of size 2^( 5) =       0.000464636499
  error estimate for blocks of size 2^( 6) =       0.000472497916
  error estimate for blocks of size 2^( 7) =       0.000475171753

      target function =                  N/A
              le_mean =     -16.906106867287
             les_mean =     286.163652979123
             stat err =       0.000466600881
             autocorr =       1.254113102205
              std dev =       0.589239971993
             le_variance =       0.347203744594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347235936834
                                         uncertainty =       0.007621850176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347235936834
                                         uncertainty =       0.007621850176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416655570
  error estimate for blocks of size 2^( 2) =       0.000429128075
  error estimate for blocks of size 2^( 3) =       0.000441955112
  error estimate for blocks of size 2^( 4) =       0.000454097351
  error estimate for blocks of size 2^( 5) =       0.000464636492
  error estimate for blocks of size 2^( 6) =       0.000472497909
  error estimate for blocks of size 2^( 7) =       0.000475171746

      target function =                  N/A
              le_mean =     -16.906106867260
             les_mean =     286.163652962466
             stat err =       0.000466600874
             autocorr =       1.254113121045
              std dev =       0.589239958638
             le_variance =       0.347203728856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347235923061
                                         uncertainty =       0.007621849678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347235923061
                                         uncertainty =       0.007621849678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416655562
  error estimate for blocks of size 2^( 2) =       0.000429128068
  error estimate for blocks of size 2^( 3) =       0.000441955105
  error estimate for blocks of size 2^( 4) =       0.000454097344
  error estimate for blocks of size 2^( 5) =       0.000464636486
  error estimate for blocks of size 2^( 6) =       0.000472497903
  error estimate for blocks of size 2^( 7) =       0.000475171740

      target function =                  N/A
              le_mean =     -16.906106867236
             les_mean =     286.163652947890
             stat err =       0.000466600868
             autocorr =       1.254113137530
              std dev =       0.589239946954
             le_variance =       0.347203715086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906106867233        initial
     6.1035e+03     6.1035e+04             5.9905e-08       -16.906106867287  <--
     2.4414e+04     2.4414e+05             1.4977e-08       -16.906106867260
     9.7656e+04     9.7656e+05             3.7442e-09       -16.906106867236

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 3.0140e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105016e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6143e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9887
    reference variance = 0.269666
====================================================
  Execution time = 2.0755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4122e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341341009345
                                         uncertainty =       0.005489129890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341341009345
                                         uncertainty =       0.005489129890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413048769
  error estimate for blocks of size 2^( 2) =       0.000425818686
  error estimate for blocks of size 2^( 3) =       0.000439033323
  error estimate for blocks of size 2^( 4) =       0.000451162623
  error estimate for blocks of size 2^( 5) =       0.000462957100
  error estimate for blocks of size 2^( 6) =       0.000470997299
  error estimate for blocks of size 2^( 7) =       0.000477133550

      target function =                  N/A
              le_mean =     -16.906309726229
             les_mean =     286.164526958991
             stat err =       0.000465562643
             autocorr =       1.270438324723
              std dev =       0.584139170418
             le_variance =       0.341218570417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630972623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906309726229       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906309727195       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906309727681       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906309727677       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906309727477       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906309727548       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906309727549       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906309727585       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.361710e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906309726229       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906309726471       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906309726592       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906309726587       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906309726541       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906309726559       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906309726560       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906309726567       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 5.904524e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906309726229       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906309726289       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906309726320       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906309726314       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906309726307       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906309726312       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906309726291       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906309726302       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.476147e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6324e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009769e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716615e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345300e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461305e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770674e-01 1 1  ON 11
 ud_2                 5.810534e-02 1 1  ON 12
 ud_3                -1.153564e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331109e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364665e-01 1 1  ON 19
 eO_0                -7.499292e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126150e-01 1 1  ON 24
 eO_5                 4.680977e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339120e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408724e-02 1 1  ON 29
eH1_0                -2.333360e-01 1 1  ON 30
eH1_1                -1.345232e-01 1 1  ON 31
eH1_2                -8.872798e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146495e-02 1 1  ON 34
eH1_5                 4.510728e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154691e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399505e-02 1 1  ON 44
eH2_5                 4.807719e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498959e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501347e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9608
    reference variance = 0.387102
====================================================
  Execution time = 2.0244e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3407e-01
  Total weights = 2.0000e+06
  Execution time = 1.8852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334045845799
                                         uncertainty =       0.003086220795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334045845799
                                         uncertainty =       0.003086220795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408697033
  error estimate for blocks of size 2^( 2) =       0.000421384280
  error estimate for blocks of size 2^( 3) =       0.000434192400
  error estimate for blocks of size 2^( 4) =       0.000446279239
  error estimate for blocks of size 2^( 5) =       0.000456748557
  error estimate for blocks of size 2^( 6) =       0.000463905215
  error estimate for blocks of size 2^( 7) =       0.000468272059

      target function =                  N/A
              le_mean =     -16.905893142050
             les_mean =     286.143289292527
             stat err =       0.000458801267
             autocorr =       1.260219654369
              std dev =       0.577984886600
             le_variance =       0.334066529138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334045917274
                                         uncertainty =       0.003086221572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334045917274
                                         uncertainty =       0.003086221572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408697077
  error estimate for blocks of size 2^( 2) =       0.000421384321
  error estimate for blocks of size 2^( 3) =       0.000434192438
  error estimate for blocks of size 2^( 4) =       0.000446279274
  error estimate for blocks of size 2^( 5) =       0.000456748588
  error estimate for blocks of size 2^( 6) =       0.000463905245
  error estimate for blocks of size 2^( 7) =       0.000468272091

      target function =                  N/A
              le_mean =     -16.905893141658
             les_mean =     286.143289350825
             stat err =       0.000458801300
             autocorr =       1.260219562063
              std dev =       0.577984948505
             le_variance =       0.334066600699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334045881536
                                         uncertainty =       0.003086221184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334045881536
                                         uncertainty =       0.003086221184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408697055
  error estimate for blocks of size 2^( 2) =       0.000421384300
  error estimate for blocks of size 2^( 3) =       0.000434192419
  error estimate for blocks of size 2^( 4) =       0.000446279257
  error estimate for blocks of size 2^( 5) =       0.000456748573
  error estimate for blocks of size 2^( 6) =       0.000463905230
  error estimate for blocks of size 2^( 7) =       0.000468272075

      target function =                  N/A
              le_mean =     -16.905893141854
             les_mean =     286.143289321676
             stat err =       0.000458801284
             autocorr =       1.260219608210
              std dev =       0.577984917553
             le_variance =       0.334066564918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334045850266
                                         uncertainty =       0.003086220843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334045850266
                                         uncertainty =       0.003086220843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408697035
  error estimate for blocks of size 2^( 2) =       0.000421384282
  error estimate for blocks of size 2^( 3) =       0.000434192403
  error estimate for blocks of size 2^( 4) =       0.000446279241
  error estimate for blocks of size 2^( 5) =       0.000456748559
  error estimate for blocks of size 2^( 6) =       0.000463905217
  error estimate for blocks of size 2^( 7) =       0.000468272061

      target function =                  N/A
              le_mean =     -16.905893142026
             les_mean =     286.143289296171
             stat err =       0.000458801269
             autocorr =       1.260219648594
              std dev =       0.577984890469
             le_variance =       0.334066533611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905893142050        initial  <--
     1.5259e+03     1.5259e+04             2.3617e-07       -16.905893141658
     6.1035e+03     6.1035e+04             5.9045e-08       -16.905893141854
     2.4414e+04     2.4414e+05             1.4761e-08       -16.905893142026

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8112
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105016e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6141e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8501
    reference variance = 0.254423
====================================================
  Execution time = 2.0626e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2839e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328386159097
                                         uncertainty =       0.002604554062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328386159097
                                         uncertainty =       0.002604554062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405211397
  error estimate for blocks of size 2^( 2) =       0.000418196221
  error estimate for blocks of size 2^( 3) =       0.000431194613
  error estimate for blocks of size 2^( 4) =       0.000443930395
  error estimate for blocks of size 2^( 5) =       0.000453717412
  error estimate for blocks of size 2^( 6) =       0.000461350874
  error estimate for blocks of size 2^( 7) =       0.000467677192

      target function =                  N/A
              le_mean =     -16.904980545903
             les_mean =     286.106759645142
             stat err =       0.000456668968
             autocorr =       1.270105216180
              std dev =       0.573055452799
             le_variance =       0.328392551982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690498054590e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904980545903       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904980545895       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904980545933       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904980545949       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904980545977       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904980545975       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904980545988       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904980545990       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.016705e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904980545903       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904980545901       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904980545911       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904980545905       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904980545921       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904980545922       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904980545906       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904980545921       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 5.041772e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904980545903       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904980545902       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904980545905       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904980545908       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904980545908       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904980546037       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904980545841       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904980545908       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.260443e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116519 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6186e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333360e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8656
    reference variance = 0.142332
====================================================
  Execution time = 2.0233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3781e-01
  Total weights = 2.0000e+06
  Execution time = 1.8759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770675707
                                         uncertainty =       0.004717146180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770675707
                                         uncertainty =       0.004717146180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982514
  error estimate for blocks of size 2^( 2) =       0.000423906290
  error estimate for blocks of size 2^( 3) =       0.000437133336
  error estimate for blocks of size 2^( 4) =       0.000448638940
  error estimate for blocks of size 2^( 5) =       0.000460433483
  error estimate for blocks of size 2^( 6) =       0.000468655026
  error estimate for blocks of size 2^( 7) =       0.000472110098

      target function =                  N/A
              le_mean =     -16.906231084520
             les_mean =     286.158462568690
             stat err =       0.000462459387
             autocorr =       1.266194747980
              std dev =       0.581217045877
             le_variance =       0.337813254418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770694338
                                         uncertainty =       0.004717146540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770694338
                                         uncertainty =       0.004717146540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982526
  error estimate for blocks of size 2^( 2) =       0.000423906301
  error estimate for blocks of size 2^( 3) =       0.000437133346
  error estimate for blocks of size 2^( 4) =       0.000448638949
  error estimate for blocks of size 2^( 5) =       0.000460433492
  error estimate for blocks of size 2^( 6) =       0.000468655035
  error estimate for blocks of size 2^( 7) =       0.000472110106

      target function =                  N/A
              le_mean =     -16.906231084469
             les_mean =     286.158462585626
             stat err =       0.000462459396
             autocorr =       1.266194727966
              std dev =       0.581217061908
             le_variance =       0.337813273053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770685023
                                         uncertainty =       0.004717146360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770685023
                                         uncertainty =       0.004717146360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982520
  error estimate for blocks of size 2^( 2) =       0.000423906295
  error estimate for blocks of size 2^( 3) =       0.000437133341
  error estimate for blocks of size 2^( 4) =       0.000448638944
  error estimate for blocks of size 2^( 5) =       0.000460433488
  error estimate for blocks of size 2^( 6) =       0.000468655031
  error estimate for blocks of size 2^( 7) =       0.000472110102

      target function =                  N/A
              le_mean =     -16.906231084495
             les_mean =     286.158462577158
             stat err =       0.000462459391
             autocorr =       1.266194737974
              std dev =       0.581217053893
             le_variance =       0.337813263736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770676872
                                         uncertainty =       0.004717146202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770676872
                                         uncertainty =       0.004717146202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982515
  error estimate for blocks of size 2^( 2) =       0.000423906290
  error estimate for blocks of size 2^( 3) =       0.000437133337
  error estimate for blocks of size 2^( 4) =       0.000448638940
  error estimate for blocks of size 2^( 5) =       0.000460433484
  error estimate for blocks of size 2^( 6) =       0.000468655027
  error estimate for blocks of size 2^( 7) =       0.000472110098

      target function =                  N/A
              le_mean =     -16.906231084517
             les_mean =     286.158462569749
             stat err =       0.000462459387
             autocorr =       1.266194746726
              std dev =       0.581217046879
             le_variance =       0.337813255583


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906231084520        initial  <--
     1.5259e+04     1.5259e+05             2.0167e-08       -16.906231084469
     6.1035e+04     6.1035e+05             5.0418e-09       -16.906231084495
     2.4414e+05     2.4414e+06             1.2604e-09       -16.906231084517

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7886
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105016e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.199535
====================================================
  Execution time = 2.0646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3631e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336351709856
                                         uncertainty =       0.003353483572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336351709856
                                         uncertainty =       0.003353483572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410066366
  error estimate for blocks of size 2^( 2) =       0.000422943632
  error estimate for blocks of size 2^( 3) =       0.000436279188
  error estimate for blocks of size 2^( 4) =       0.000448827737
  error estimate for blocks of size 2^( 5) =       0.000459561165
  error estimate for blocks of size 2^( 6) =       0.000468297056
  error estimate for blocks of size 2^( 7) =       0.000472841427

      target function =                  N/A
              le_mean =     -16.906196373166
             les_mean =     286.155784488387
             stat err =       0.000462381846
             autocorr =       1.271432331994
              std dev =       0.579921415784
             le_variance =       0.336308848485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619637317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906196373166       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906196373165       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906196373169       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906196373195       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906196373149       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906196373176       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906196373282       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906196373428       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.121831e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906196373166       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906196373166       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906196373167       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906196373233       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906196373342       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906196372790       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906196373171       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906196373131       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 5.304577e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906196373166       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906196373166       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906196373166       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906196372900       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906196372138       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906196373741       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906196373171       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906196373412       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.326144e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6183e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105016e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9041
    reference variance = 0.29615
====================================================
  Execution time = 2.0434e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3511e-01
  Total weights = 2.0000e+06
  Execution time = 1.8735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335028371249
                                         uncertainty =       0.004211475588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335028371249
                                         uncertainty =       0.004211475588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409331996
  error estimate for blocks of size 2^( 2) =       0.000421911035
  error estimate for blocks of size 2^( 3) =       0.000435504117
  error estimate for blocks of size 2^( 4) =       0.000447932166
  error estimate for blocks of size 2^( 5) =       0.000457900849
  error estimate for blocks of size 2^( 6) =       0.000465624802
  error estimate for blocks of size 2^( 7) =       0.000469947928

      target function =                  N/A
              le_mean =     -16.906418059926
             les_mean =     286.162076814916
             stat err =       0.000460351436
             autocorr =       1.264816780511
              std dev =       0.578882859885
             le_variance =       0.335105365468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335028372383
                                         uncertainty =       0.004211475591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335028372383
                                         uncertainty =       0.004211475591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409331996
  error estimate for blocks of size 2^( 2) =       0.000421911036
  error estimate for blocks of size 2^( 3) =       0.000435504118
  error estimate for blocks of size 2^( 4) =       0.000447932167
  error estimate for blocks of size 2^( 5) =       0.000457900849
  error estimate for blocks of size 2^( 6) =       0.000465624802
  error estimate for blocks of size 2^( 7) =       0.000469947928

      target function =                  N/A
              le_mean =     -16.906418059913
             les_mean =     286.162076815595
             stat err =       0.000460351437
             autocorr =       1.264816779362
              std dev =       0.578882860866
             le_variance =       0.335105366604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335028371816
                                         uncertainty =       0.004211475590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335028371816
                                         uncertainty =       0.004211475590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409331996
  error estimate for blocks of size 2^( 2) =       0.000421911035
  error estimate for blocks of size 2^( 3) =       0.000435504118
  error estimate for blocks of size 2^( 4) =       0.000447932167
  error estimate for blocks of size 2^( 5) =       0.000457900849
  error estimate for blocks of size 2^( 6) =       0.000465624802
  error estimate for blocks of size 2^( 7) =       0.000469947928

      target function =                  N/A
              le_mean =     -16.906418059920
             les_mean =     286.162076815256
             stat err =       0.000460351436
             autocorr =       1.264816779937
              std dev =       0.578882860375
             le_variance =       0.335105366036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335028371320
                                         uncertainty =       0.004211475588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335028371320
                                         uncertainty =       0.004211475588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409331996
  error estimate for blocks of size 2^( 2) =       0.000421911035
  error estimate for blocks of size 2^( 3) =       0.000435504117
  error estimate for blocks of size 2^( 4) =       0.000447932166
  error estimate for blocks of size 2^( 5) =       0.000457900849
  error estimate for blocks of size 2^( 6) =       0.000465624802
  error estimate for blocks of size 2^( 7) =       0.000469947928

      target function =                  N/A
              le_mean =     -16.906418059925
             les_mean =     286.162076814959
             stat err =       0.000460351436
             autocorr =       1.264816780435
              std dev =       0.578882859946
             le_variance =       0.335105365539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906418059926        initial  <--
     1.5259e+05     1.5259e+06             2.1218e-09       -16.906418059913
     6.1035e+05     6.1035e+06             5.3046e-10       -16.906418059920
     2.4414e+06     2.4414e+07             1.3261e-10       -16.906418059925

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2373
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105016e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6426e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8825
    reference variance = 0.268486
====================================================
  Execution time = 2.0854e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4342e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343392307269
                                         uncertainty =       0.005495869920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343392307269
                                         uncertainty =       0.005495869920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414379954
  error estimate for blocks of size 2^( 2) =       0.000426557300
  error estimate for blocks of size 2^( 3) =       0.000439495896
  error estimate for blocks of size 2^( 4) =       0.000451262727
  error estimate for blocks of size 2^( 5) =       0.000460982968
  error estimate for blocks of size 2^( 6) =       0.000467972665
  error estimate for blocks of size 2^( 7) =       0.000472210269

      target function =                  N/A
              le_mean =     -16.905147757155
             les_mean =     286.127442012251
             stat err =       0.000463107157
             autocorr =       1.249008834855
              std dev =       0.586021751059
             le_variance =       0.343421492714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690514775716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905147757155       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905147757156       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905147757156       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905147757155       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905147757147       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905147756594       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905147757328       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905147757007       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.762769e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905147757155       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905147757155       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905147757155       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905147757155       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905147757155       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905147759994       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905147754672       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905147747690       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 4.406927e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905147757155       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905147757155       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905147757155       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905147763412       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905147757155       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905147771571       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905147767227       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905147759629       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 1.101723e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6342e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105016e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8692
    reference variance = 0.28329
====================================================
  Execution time = 2.0793e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5917e-01
  Total weights = 2.0000e+06
  Execution time = 2.2094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359290065117
                                         uncertainty =       0.012836954441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359290065117
                                         uncertainty =       0.012836954441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423777679
  error estimate for blocks of size 2^( 2) =       0.000436382980
  error estimate for blocks of size 2^( 3) =       0.000449201540
  error estimate for blocks of size 2^( 4) =       0.000460653467
  error estimate for blocks of size 2^( 5) =       0.000471623492
  error estimate for blocks of size 2^( 6) =       0.000481408948
  error estimate for blocks of size 2^( 7) =       0.000484307231

      target function =                  N/A
              le_mean =     -16.905873405777
             les_mean =     286.167730475232
             stat err =       0.000474498285
             autocorr =       1.253698588562
              std dev =       0.599312141263
             le_variance =       0.359175042665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359290065283
                                         uncertainty =       0.012836954446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359290065283
                                         uncertainty =       0.012836954446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423777679
  error estimate for blocks of size 2^( 2) =       0.000436382981
  error estimate for blocks of size 2^( 3) =       0.000449201540
  error estimate for blocks of size 2^( 4) =       0.000460653468
  error estimate for blocks of size 2^( 5) =       0.000471623492
  error estimate for blocks of size 2^( 6) =       0.000481408948
  error estimate for blocks of size 2^( 7) =       0.000484307231

      target function =                  N/A
              le_mean =     -16.905873405777
             les_mean =     286.167730475403
             stat err =       0.000474498285
             autocorr =       1.253698588392
              std dev =       0.599312141401
             le_variance =       0.359175042830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359290065200
                                         uncertainty =       0.012836954443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359290065200
                                         uncertainty =       0.012836954443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423777679
  error estimate for blocks of size 2^( 2) =       0.000436382980
  error estimate for blocks of size 2^( 3) =       0.000449201540
  error estimate for blocks of size 2^( 4) =       0.000460653468
  error estimate for blocks of size 2^( 5) =       0.000471623492
  error estimate for blocks of size 2^( 6) =       0.000481408948
  error estimate for blocks of size 2^( 7) =       0.000484307231

      target function =                  N/A
              le_mean =     -16.905873405777
             les_mean =     286.167730475318
             stat err =       0.000474498285
             autocorr =       1.253698588489
              std dev =       0.599312141332
             le_variance =       0.359175042747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359290065128
                                         uncertainty =       0.012836954441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359290065128
                                         uncertainty =       0.012836954441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423777679
  error estimate for blocks of size 2^( 2) =       0.000436382980
  error estimate for blocks of size 2^( 3) =       0.000449201540
  error estimate for blocks of size 2^( 4) =       0.000460653467
  error estimate for blocks of size 2^( 5) =       0.000471623492
  error estimate for blocks of size 2^( 6) =       0.000481408948
  error estimate for blocks of size 2^( 7) =       0.000484307231

      target function =                  N/A
              le_mean =     -16.905873405777
             les_mean =     286.167730475243
             stat err =       0.000474498285
             autocorr =       1.253698588557
              std dev =       0.599312141271
             le_variance =       0.359175042675


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905873405777        initial
     1.5259e+06     1.5259e+07             1.7628e-10       -16.905873405777  <--
     6.1035e+06     6.1035e+07             4.4069e-11       -16.905873405777
     2.4414e+07     2.4414e+08             1.1017e-11       -16.905873405777

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 3.1232e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7580e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8079
    reference variance = 0.250972
====================================================
  Execution time = 2.0493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3826e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338303890189
                                         uncertainty =       0.005768322217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338303890189
                                         uncertainty =       0.005768322217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411254349
  error estimate for blocks of size 2^( 2) =       0.000423944755
  error estimate for blocks of size 2^( 3) =       0.000436901285
  error estimate for blocks of size 2^( 4) =       0.000449132920
  error estimate for blocks of size 2^( 5) =       0.000459595759
  error estimate for blocks of size 2^( 6) =       0.000468538484
  error estimate for blocks of size 2^( 7) =       0.000472106225

      target function =                  N/A
              le_mean =     -16.906161392302
             les_mean =     286.156553133095
             stat err =       0.000462343347
             autocorr =       1.263886914019
              std dev =       0.581601478383
             le_variance =       0.338260279657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616139230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906161392302       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161392303       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906161392303       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906161392221       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906161392445       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161392156       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161393034       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906161392332       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 9.216433e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906161392302       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161392302       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906161392302       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906161391459       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906161392301       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161392353       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161392217       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906161391128       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 2.304107e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906161392302       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161392302       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906161392302       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906161392302       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906161392451       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161392302       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161384263       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906161385910       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 5.760221e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5991e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8975
    reference variance = 0.251648
====================================================
  Execution time = 2.0202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.0000e+06
  Execution time = 1.8796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337542105599
                                         uncertainty =       0.004412595447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337542105599
                                         uncertainty =       0.004412595447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827450
  error estimate for blocks of size 2^( 2) =       0.000423519773
  error estimate for blocks of size 2^( 3) =       0.000436549334
  error estimate for blocks of size 2^( 4) =       0.000448377877
  error estimate for blocks of size 2^( 5) =       0.000458835686
  error estimate for blocks of size 2^( 6) =       0.000466043020
  error estimate for blocks of size 2^( 7) =       0.000473686004

      target function =                  N/A
              le_mean =     -16.905785887809
             les_mean =     286.143154703513
             stat err =       0.000461735647
             autocorr =       1.263187733733
              std dev =       0.580997752031
             le_variance =       0.337558387866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337542106070
                                         uncertainty =       0.004412595455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337542106070
                                         uncertainty =       0.004412595455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827451
  error estimate for blocks of size 2^( 2) =       0.000423519773
  error estimate for blocks of size 2^( 3) =       0.000436549334
  error estimate for blocks of size 2^( 4) =       0.000448377877
  error estimate for blocks of size 2^( 5) =       0.000458835686
  error estimate for blocks of size 2^( 6) =       0.000466043021
  error estimate for blocks of size 2^( 7) =       0.000473686005

      target function =                  N/A
              le_mean =     -16.905785887804
             les_mean =     286.143154703824
             stat err =       0.000461735647
             autocorr =       1.263187733187
              std dev =       0.580997752436
             le_variance =       0.337558388336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337542105834
                                         uncertainty =       0.004412595451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337542105834
                                         uncertainty =       0.004412595451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827450
  error estimate for blocks of size 2^( 2) =       0.000423519773
  error estimate for blocks of size 2^( 3) =       0.000436549334
  error estimate for blocks of size 2^( 4) =       0.000448377877
  error estimate for blocks of size 2^( 5) =       0.000458835686
  error estimate for blocks of size 2^( 6) =       0.000466043020
  error estimate for blocks of size 2^( 7) =       0.000473686005

      target function =                  N/A
              le_mean =     -16.905785887806
             les_mean =     286.143154703669
             stat err =       0.000461735647
             autocorr =       1.263187733463
              std dev =       0.580997752234
             le_variance =       0.337558388101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337542105628
                                         uncertainty =       0.004412595447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337542105628
                                         uncertainty =       0.004412595447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827450
  error estimate for blocks of size 2^( 2) =       0.000423519773
  error estimate for blocks of size 2^( 3) =       0.000436549334
  error estimate for blocks of size 2^( 4) =       0.000448377877
  error estimate for blocks of size 2^( 5) =       0.000458835686
  error estimate for blocks of size 2^( 6) =       0.000466043020
  error estimate for blocks of size 2^( 7) =       0.000473686004

      target function =                  N/A
              le_mean =     -16.905785887808
             les_mean =     286.143154703533
             stat err =       0.000461735647
             autocorr =       1.263187733699
              std dev =       0.580997752057
             le_variance =       0.337558387895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905785887809        initial  <--
     3.8147e+05     3.8147e+06             9.2164e-10       -16.905785887804
     1.5259e+06     1.5259e+07             2.3041e-10       -16.905785887806
     6.1035e+06     6.1035e+07             5.7602e-11       -16.905785887808

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7684
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8463
    reference variance = 0.169922
====================================================
  Execution time = 2.0574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4524e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345304233649
                                         uncertainty =       0.009780173486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345304233649
                                         uncertainty =       0.009780173486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415475853
  error estimate for blocks of size 2^( 2) =       0.000427453211
  error estimate for blocks of size 2^( 3) =       0.000440398604
  error estimate for blocks of size 2^( 4) =       0.000453161859
  error estimate for blocks of size 2^( 5) =       0.000463608026
  error estimate for blocks of size 2^( 6) =       0.000468900424
  error estimate for blocks of size 2^( 7) =       0.000474325575

      target function =                  N/A
              le_mean =     -16.906236063013
             les_mean =     286.166058013883
             stat err =       0.000464998971
             autocorr =       1.252600002823
              std dev =       0.587571585586
             le_variance =       0.345240368188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623606301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906236063013       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906236063013       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906236063013       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906236063194       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906236062813       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906236062858       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906236063884       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906236064220       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 1.018809e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906236063013       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906236063013       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906236063013       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906236063013       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906236063013       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906236062863       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906236069074       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906236065736       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 2.547018e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906236063013       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906236063013       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906236063013       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906236063013       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906236098900       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906236096810       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906236076724       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906236048113       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 6.367278e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6102e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9139
    reference variance = 0.183848
====================================================
  Execution time = 2.0376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2948e-01
  Total weights = 2.0000e+06
  Execution time = 1.8783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329537442440
                                         uncertainty =       0.002672178050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329537442440
                                         uncertainty =       0.002672178050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405880822
  error estimate for blocks of size 2^( 2) =       0.000418355218
  error estimate for blocks of size 2^( 3) =       0.000431124130
  error estimate for blocks of size 2^( 4) =       0.000442465398
  error estimate for blocks of size 2^( 5) =       0.000453001824
  error estimate for blocks of size 2^( 6) =       0.000460111184
  error estimate for blocks of size 2^( 7) =       0.000464529579

      target function =                  N/A
              le_mean =     -16.905967161455
             les_mean =     286.141203983144
             stat err =       0.000455026996
             autocorr =       1.256832101204
              std dev =       0.574002163476
             le_variance =       0.329478483676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329537442432
                                         uncertainty =       0.002672178050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329537442432
                                         uncertainty =       0.002672178050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405880822
  error estimate for blocks of size 2^( 2) =       0.000418355218
  error estimate for blocks of size 2^( 3) =       0.000431124130
  error estimate for blocks of size 2^( 4) =       0.000442465398
  error estimate for blocks of size 2^( 5) =       0.000453001824
  error estimate for blocks of size 2^( 6) =       0.000460111184
  error estimate for blocks of size 2^( 7) =       0.000464529579

      target function =                  N/A
              le_mean =     -16.905967161456
             les_mean =     286.141203983142
             stat err =       0.000455026996
             autocorr =       1.256832101207
              std dev =       0.574002163469
             le_variance =       0.329478483667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329537442436
                                         uncertainty =       0.002672178050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329537442436
                                         uncertainty =       0.002672178050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405880822
  error estimate for blocks of size 2^( 2) =       0.000418355218
  error estimate for blocks of size 2^( 3) =       0.000431124130
  error estimate for blocks of size 2^( 4) =       0.000442465398
  error estimate for blocks of size 2^( 5) =       0.000453001824
  error estimate for blocks of size 2^( 6) =       0.000460111184
  error estimate for blocks of size 2^( 7) =       0.000464529579

      target function =                  N/A
              le_mean =     -16.905967161455
             les_mean =     286.141203983143
             stat err =       0.000455026996
             autocorr =       1.256832101204
              std dev =       0.574002163473
             le_variance =       0.329478483671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329537442439
                                         uncertainty =       0.002672178050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329537442439
                                         uncertainty =       0.002672178050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405880822
  error estimate for blocks of size 2^( 2) =       0.000418355218
  error estimate for blocks of size 2^( 3) =       0.000431124130
  error estimate for blocks of size 2^( 4) =       0.000442465398
  error estimate for blocks of size 2^( 5) =       0.000453001824
  error estimate for blocks of size 2^( 6) =       0.000460111184
  error estimate for blocks of size 2^( 7) =       0.000464529579

      target function =                  N/A
              le_mean =     -16.905967161455
             les_mean =     286.141203983144
             stat err =       0.000455026996
             autocorr =       1.256832101196
              std dev =       0.574002163476
             le_variance =       0.329478483675


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905967161455        initial
     3.8147e+06     3.8147e+07             1.0188e-10       -16.905967161456  <--
     1.5259e+07     1.5259e+08             2.5470e-11       -16.905967161455
     6.1035e+07     6.1035e+08             6.3673e-12       -16.905967161455

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 2.9934e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6042e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9482
    reference variance = 0.152212
====================================================
  Execution time = 2.0794e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2877e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328667866947
                                         uncertainty =       0.002914882371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328667866947
                                         uncertainty =       0.002914882371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405443697
  error estimate for blocks of size 2^( 2) =       0.000418340301
  error estimate for blocks of size 2^( 3) =       0.000431442968
  error estimate for blocks of size 2^( 4) =       0.000444111306
  error estimate for blocks of size 2^( 5) =       0.000455308670
  error estimate for blocks of size 2^( 6) =       0.000466449096
  error estimate for blocks of size 2^( 7) =       0.000470591307

      target function =                  N/A
              le_mean =     -16.905289621674
             les_mean =     286.117586211673
             stat err =       0.000459115095
             autocorr =       1.282277543596
              std dev =       0.573383975508
             le_variance =       0.328769183369


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690528962167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905289621674       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905289621675       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905289621675       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905289621676       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905289621767       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905289621944       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905289621548       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905289621179       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.064513e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905289621674       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905289621674       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905289621674       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905289625975       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905289621277       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905289620605       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905289621828       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905289624256       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 7.661281e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905289621674       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905289621674       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905289621674       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905289621674       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905289629279       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905289620250       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905289614191       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905289616879       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.915313e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6428e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105016e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.902
    reference variance = 0.231593
====================================================
  Execution time = 2.0237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3421e-01
  Total weights = 2.0000e+06
  Execution time = 1.8731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334275059210
                                         uncertainty =       0.006320190268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334275059210
                                         uncertainty =       0.006320190268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408784276
  error estimate for blocks of size 2^( 2) =       0.000421719973
  error estimate for blocks of size 2^( 3) =       0.000435143302
  error estimate for blocks of size 2^( 4) =       0.000447671473
  error estimate for blocks of size 2^( 5) =       0.000459000560
  error estimate for blocks of size 2^( 6) =       0.000468441746
  error estimate for blocks of size 2^( 7) =       0.000471866391

      target function =                  N/A
              le_mean =     -16.905954277557
             les_mean =     286.145499036807
             stat err =       0.000461745042
             autocorr =       1.275898473260
              std dev =       0.578108267582
             le_variance =       0.334209169047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334275059568
                                         uncertainty =       0.006320190277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334275059568
                                         uncertainty =       0.006320190277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408784276
  error estimate for blocks of size 2^( 2) =       0.000421719973
  error estimate for blocks of size 2^( 3) =       0.000435143302
  error estimate for blocks of size 2^( 4) =       0.000447671473
  error estimate for blocks of size 2^( 5) =       0.000459000561
  error estimate for blocks of size 2^( 6) =       0.000468441746
  error estimate for blocks of size 2^( 7) =       0.000471866391

      target function =                  N/A
              le_mean =     -16.905954277557
             les_mean =     286.145499037142
             stat err =       0.000461745043
             autocorr =       1.275898472902
              std dev =       0.578108267892
             le_variance =       0.334209169405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334275059389
                                         uncertainty =       0.006320190272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334275059389
                                         uncertainty =       0.006320190272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408784276
  error estimate for blocks of size 2^( 2) =       0.000421719973
  error estimate for blocks of size 2^( 3) =       0.000435143302
  error estimate for blocks of size 2^( 4) =       0.000447671473
  error estimate for blocks of size 2^( 5) =       0.000459000561
  error estimate for blocks of size 2^( 6) =       0.000468441746
  error estimate for blocks of size 2^( 7) =       0.000471866391

      target function =                  N/A
              le_mean =     -16.905954277557
             les_mean =     286.145499036975
             stat err =       0.000461745043
             autocorr =       1.275898473082
              std dev =       0.578108267737
             le_variance =       0.334209169226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334275059232
                                         uncertainty =       0.006320190269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334275059232
                                         uncertainty =       0.006320190269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408784276
  error estimate for blocks of size 2^( 2) =       0.000421719973
  error estimate for blocks of size 2^( 3) =       0.000435143302
  error estimate for blocks of size 2^( 4) =       0.000447671473
  error estimate for blocks of size 2^( 5) =       0.000459000561
  error estimate for blocks of size 2^( 6) =       0.000468441746
  error estimate for blocks of size 2^( 7) =       0.000471866391

      target function =                  N/A
              le_mean =     -16.905954277557
             les_mean =     286.145499036828
             stat err =       0.000461745043
             autocorr =       1.275898473242
              std dev =       0.578108267602
             le_variance =       0.334209169069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905954277557        initial  <--
     9.5367e+05     9.5367e+06             3.0645e-10       -16.905954277557
     3.8147e+06     3.8147e+07             7.6613e-11       -16.905954277557
     1.5259e+07     1.5259e+08             1.9153e-11       -16.905954277557

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7695
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6204e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9122
    reference variance = 0.250786
====================================================
  Execution time = 2.0954e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4099e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340931142020
                                         uncertainty =       0.004165276649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340931142020
                                         uncertainty =       0.004165276649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412911025
  error estimate for blocks of size 2^( 2) =       0.000425649664
  error estimate for blocks of size 2^( 3) =       0.000438929509
  error estimate for blocks of size 2^( 4) =       0.000451310776
  error estimate for blocks of size 2^( 5) =       0.000460917148
  error estimate for blocks of size 2^( 6) =       0.000468159594
  error estimate for blocks of size 2^( 7) =       0.000475313607

      target function =                  N/A
              le_mean =     -16.905380139940
             les_mean =     286.132868535194
             stat err =       0.000463925281
             autocorr =       1.262359697444
              std dev =       0.583944372196
             le_variance =       0.340991029819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690538013994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905380139940       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905380139940       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905380139940       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905380139940       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905380140313       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905380142093       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905380141182       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905380137141       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 3.394109e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905380139940       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905380139940       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905380139940       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905380139940       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905380147674       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905380140847       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905380115114       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905380166030       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 8.485107e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905380139940       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905380139940       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905380139940       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905380110602       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905380145877       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905380130730       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905380152031       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905380097914       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 2.121297e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6452e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.7539
    reference variance = 0.365346
====================================================
  Execution time = 2.0378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3358e-01
  Total weights = 2.0000e+06
  Execution time = 1.8697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333724997827
                                         uncertainty =       0.002914795180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333724997827
                                         uncertainty =       0.002914795180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408400227
  error estimate for blocks of size 2^( 2) =       0.000421403190
  error estimate for blocks of size 2^( 3) =       0.000435076103
  error estimate for blocks of size 2^( 4) =       0.000448013478
  error estimate for blocks of size 2^( 5) =       0.000459323736
  error estimate for blocks of size 2^( 6) =       0.000465910870
  error estimate for blocks of size 2^( 7) =       0.000469758723

      target function =                  N/A
              le_mean =     -16.905132575962
             les_mean =     286.117088734190
             stat err =       0.000460751702
             autocorr =       1.272805219293
              std dev =       0.577565139293
             le_variance =       0.333581490126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333724997847
                                         uncertainty =       0.002914795181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333724997847
                                         uncertainty =       0.002914795181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408400227
  error estimate for blocks of size 2^( 2) =       0.000421403190
  error estimate for blocks of size 2^( 3) =       0.000435076103
  error estimate for blocks of size 2^( 4) =       0.000448013478
  error estimate for blocks of size 2^( 5) =       0.000459323736
  error estimate for blocks of size 2^( 6) =       0.000465910870
  error estimate for blocks of size 2^( 7) =       0.000469758723

      target function =                  N/A
              le_mean =     -16.905132575962
             les_mean =     286.117088734205
             stat err =       0.000460751702
             autocorr =       1.272805219257
              std dev =       0.577565139310
             le_variance =       0.333581490146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333724997837
                                         uncertainty =       0.002914795181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333724997837
                                         uncertainty =       0.002914795181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408400227
  error estimate for blocks of size 2^( 2) =       0.000421403190
  error estimate for blocks of size 2^( 3) =       0.000435076103
  error estimate for blocks of size 2^( 4) =       0.000448013478
  error estimate for blocks of size 2^( 5) =       0.000459323736
  error estimate for blocks of size 2^( 6) =       0.000465910870
  error estimate for blocks of size 2^( 7) =       0.000469758723

      target function =                  N/A
              le_mean =     -16.905132575962
             les_mean =     286.117088734198
             stat err =       0.000460751702
             autocorr =       1.272805219281
              std dev =       0.577565139301
             le_variance =       0.333581490136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333724997829
                                         uncertainty =       0.002914795180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333724997829
                                         uncertainty =       0.002914795180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408400227
  error estimate for blocks of size 2^( 2) =       0.000421403190
  error estimate for blocks of size 2^( 3) =       0.000435076103
  error estimate for blocks of size 2^( 4) =       0.000448013478
  error estimate for blocks of size 2^( 5) =       0.000459323736
  error estimate for blocks of size 2^( 6) =       0.000465910870
  error estimate for blocks of size 2^( 7) =       0.000469758723

      target function =                  N/A
              le_mean =     -16.905132575962
             les_mean =     286.117088734191
             stat err =       0.000460751702
             autocorr =       1.272805219292
              std dev =       0.577565139294
             le_variance =       0.333581490128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905132575962        initial  <--
     9.5367e+06     9.5367e+07             3.3941e-11       -16.905132575962
     3.8147e+07     3.8147e+08             8.4851e-12       -16.905132575962
     1.5259e+08     1.5259e+09             2.1213e-12       -16.905132575962

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9052
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6363e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9223
    reference variance = 0.216199
====================================================
  Execution time = 2.0896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4691e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346990999754
                                         uncertainty =       0.007207159175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346990999754
                                         uncertainty =       0.007207159175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416480804
  error estimate for blocks of size 2^( 2) =       0.000429196087
  error estimate for blocks of size 2^( 3) =       0.000442257746
  error estimate for blocks of size 2^( 4) =       0.000454492270
  error estimate for blocks of size 2^( 5) =       0.000465703551
  error estimate for blocks of size 2^( 6) =       0.000473544252
  error estimate for blocks of size 2^( 7) =       0.000481182614

      target function =                  N/A
              le_mean =     -16.905372293822
             les_mean =     286.138524738756
             stat err =       0.000468730672
             autocorr =       1.266650411667
              std dev =       0.588992800889
             le_variance =       0.346912519500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690537229382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905372293822       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905372293822       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905372293822       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905372293822       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905372266682       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905372293419       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905372306426       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905372307852       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.986537e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905372293822       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905372293822       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905372293822       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905372285131       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905372293822       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905372299020       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905372301384       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905372422412       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 7.466246e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905372293822       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905372293822       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905372293822       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905372293822       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905372817020       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905372396702       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905370799856       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905372775849       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.867553e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6452e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8787
    reference variance = 0.371446
====================================================
  Execution time = 2.0276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2726e-01
  Total weights = 2.0000e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327225029126
                                         uncertainty =       0.002853232122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327225029126
                                         uncertainty =       0.002853232122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404513119
  error estimate for blocks of size 2^( 2) =       0.000417203698
  error estimate for blocks of size 2^( 3) =       0.000430244697
  error estimate for blocks of size 2^( 4) =       0.000442496738
  error estimate for blocks of size 2^( 5) =       0.000452682548
  error estimate for blocks of size 2^( 6) =       0.000461920713
  error estimate for blocks of size 2^( 7) =       0.000465542926

      target function =                  N/A
              le_mean =     -16.906240458423
             les_mean =     286.148228002049
             stat err =       0.000455660731
             autocorr =       1.268872492889
              std dev =       0.572067939716
             le_variance =       0.327261727651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327225029127
                                         uncertainty =       0.002853232122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327225029127
                                         uncertainty =       0.002853232122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404513119
  error estimate for blocks of size 2^( 2) =       0.000417203698
  error estimate for blocks of size 2^( 3) =       0.000430244697
  error estimate for blocks of size 2^( 4) =       0.000442496738
  error estimate for blocks of size 2^( 5) =       0.000452682548
  error estimate for blocks of size 2^( 6) =       0.000461920713
  error estimate for blocks of size 2^( 7) =       0.000465542926

      target function =                  N/A
              le_mean =     -16.906240458423
             les_mean =     286.148228002050
             stat err =       0.000455660731
             autocorr =       1.268872492886
              std dev =       0.572067939717
             le_variance =       0.327261727652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327225029127
                                         uncertainty =       0.002853232122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327225029127
                                         uncertainty =       0.002853232122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404513119
  error estimate for blocks of size 2^( 2) =       0.000417203698
  error estimate for blocks of size 2^( 3) =       0.000430244697
  error estimate for blocks of size 2^( 4) =       0.000442496738
  error estimate for blocks of size 2^( 5) =       0.000452682548
  error estimate for blocks of size 2^( 6) =       0.000461920713
  error estimate for blocks of size 2^( 7) =       0.000465542926

      target function =                  N/A
              le_mean =     -16.906240458423
             les_mean =     286.148228002049
             stat err =       0.000455660731
             autocorr =       1.268872492888
              std dev =       0.572067939717
             le_variance =       0.327261727652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327225029126
                                         uncertainty =       0.002853232122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327225029126
                                         uncertainty =       0.002853232122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404513119
  error estimate for blocks of size 2^( 2) =       0.000417203698
  error estimate for blocks of size 2^( 3) =       0.000430244697
  error estimate for blocks of size 2^( 4) =       0.000442496738
  error estimate for blocks of size 2^( 5) =       0.000452682548
  error estimate for blocks of size 2^( 6) =       0.000461920713
  error estimate for blocks of size 2^( 7) =       0.000465542926

      target function =                  N/A
              le_mean =     -16.906240458423
             les_mean =     286.148228002049
             stat err =       0.000455660731
             autocorr =       1.268872492889
              std dev =       0.572067939716
             le_variance =       0.327261727651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906240458423        initial
     9.5367e+07     9.5367e+08             2.9865e-12       -16.906240458423
     3.8147e+08     3.8147e+09             7.4662e-13       -16.906240458423
     1.5259e+09     1.5259e+10             1.8676e-13       -16.906240458423  <--

*****************************************************************************
Applying the update for shift_i =   1.5259e+09     and shift_s =   1.5259e+10
*****************************************************************************

  Execution time = 2.9842e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6300e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9271
    reference variance = 0.219215
====================================================
  Execution time = 2.2571e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3758e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337559357642
                                         uncertainty =       0.004845954659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337559357642
                                         uncertainty =       0.004845954659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410841512
  error estimate for blocks of size 2^( 2) =       0.000423516282
  error estimate for blocks of size 2^( 3) =       0.000436207124
  error estimate for blocks of size 2^( 4) =       0.000448028663
  error estimate for blocks of size 2^( 5) =       0.000457734704
  error estimate for blocks of size 2^( 6) =       0.000464537057
  error estimate for blocks of size 2^( 7) =       0.000465806055

      target function =                  N/A
              le_mean =     -16.905749647722
             les_mean =     286.141952478801
             stat err =       0.000459026620
             autocorr =       1.248323382955
              std dev =       0.581017638392
             le_variance =       0.337581496123


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574964772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749647722       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749647722       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749647722       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749648243       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749600603       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749522111       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749537264       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749594954       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 7.855332e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749647722       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749647722       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749647722       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749647722       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749103067       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749815446       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749951921       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749706856       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.963863e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749647722       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749647722       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749647722       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749647722       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905750795329       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905766582362       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905751091795       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905743356321       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905752661849       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 4.861657e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137141 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8104e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8953
    reference variance = 0.202268
====================================================
  Execution time = 2.0070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3835e-01
  Total weights = 2.0000e+06
  Execution time = 1.8825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338400967851
                                         uncertainty =       0.003025103976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338400967851
                                         uncertainty =       0.003025103976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411310496
  error estimate for blocks of size 2^( 2) =       0.000424183160
  error estimate for blocks of size 2^( 3) =       0.000437395362
  error estimate for blocks of size 2^( 4) =       0.000448990240
  error estimate for blocks of size 2^( 5) =       0.000459117624
  error estimate for blocks of size 2^( 6) =       0.000467372387
  error estimate for blocks of size 2^( 7) =       0.000470458210

      target function =                  N/A
              le_mean =     -16.905718958835
             les_mean =     286.141685993728
             stat err =       0.000461484615
             autocorr =       1.258852570374
              std dev =       0.581680881396
             le_variance =       0.338352647782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338400967851
                                         uncertainty =       0.003025103976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338400967851
                                         uncertainty =       0.003025103976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411310496
  error estimate for blocks of size 2^( 2) =       0.000424183160
  error estimate for blocks of size 2^( 3) =       0.000437395362
  error estimate for blocks of size 2^( 4) =       0.000448990240
  error estimate for blocks of size 2^( 5) =       0.000459117624
  error estimate for blocks of size 2^( 6) =       0.000467372387
  error estimate for blocks of size 2^( 7) =       0.000470458210

      target function =                  N/A
              le_mean =     -16.905718958835
             les_mean =     286.141685993729
             stat err =       0.000461484615
             autocorr =       1.258852570370
              std dev =       0.581680881397
             le_variance =       0.338352647783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338400967851
                                         uncertainty =       0.003025103976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338400967851
                                         uncertainty =       0.003025103976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411310496
  error estimate for blocks of size 2^( 2) =       0.000424183160
  error estimate for blocks of size 2^( 3) =       0.000437395362
  error estimate for blocks of size 2^( 4) =       0.000448990240
  error estimate for blocks of size 2^( 5) =       0.000459117624
  error estimate for blocks of size 2^( 6) =       0.000467372387
  error estimate for blocks of size 2^( 7) =       0.000470458210

      target function =                  N/A
              le_mean =     -16.905718958835
             les_mean =     286.141685993728
             stat err =       0.000461484615
             autocorr =       1.258852570376
              std dev =       0.581680881397
             le_variance =       0.338352647782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338400967851
                                         uncertainty =       0.003025103976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338400967851
                                         uncertainty =       0.003025103976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411310496
  error estimate for blocks of size 2^( 2) =       0.000424183160
  error estimate for blocks of size 2^( 3) =       0.000437395362
  error estimate for blocks of size 2^( 4) =       0.000448990240
  error estimate for blocks of size 2^( 5) =       0.000459117624
  error estimate for blocks of size 2^( 6) =       0.000467372387
  error estimate for blocks of size 2^( 7) =       0.000470458210

      target function =                  N/A
              le_mean =     -16.905718958835
             les_mean =     286.141685993728
             stat err =       0.000461484615
             autocorr =       1.258852570377
              std dev =       0.581680881396
             le_variance =       0.338352647782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905718958835        initial
     3.8147e+08     3.8147e+09             7.8553e-13       -16.905718958835
     1.5259e+09     1.5259e+10             1.9639e-13       -16.905718958835  <--
     6.1035e+09     6.1035e+10             4.8617e-14       -16.905718958835

*****************************************************************************
Applying the update for shift_i =   1.5259e+09     and shift_s =   1.5259e+10
*****************************************************************************

  Execution time = 2.9644e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8513
    reference variance = 0.241123
====================================================
  Execution time = 2.0722e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3159e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331666755200
                                         uncertainty =       0.002655787609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331666755200
                                         uncertainty =       0.002655787609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407180334
  error estimate for blocks of size 2^( 2) =       0.000420269572
  error estimate for blocks of size 2^( 3) =       0.000433705396
  error estimate for blocks of size 2^( 4) =       0.000446169428
  error estimate for blocks of size 2^( 5) =       0.000457447216
  error estimate for blocks of size 2^( 6) =       0.000466883443
  error estimate for blocks of size 2^( 7) =       0.000473698375

      target function =                  N/A
              le_mean =     -16.905358371279
             les_mean =     286.122733144399
             stat err =       0.000461049615
             autocorr =       1.282099526057
              std dev =       0.575839950697
             le_variance =       0.331591648818


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690535837128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905358371279       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905358371279       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905358371279       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905358378182       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905358417817       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905358438203       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905358651802       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905358524367       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 8.848185e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905358371279       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905358371279       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905358371279       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905357482642       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905359861959       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905358718717       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905358400517       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905358310403       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 2.210693e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905358371279       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905358371279       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905358371279       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905361072007       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905358757325       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905358426270       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905355315489       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905359487383       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 5.533198e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139755 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6146e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8436
    reference variance = 0.287307
====================================================
  Execution time = 1.9971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5252e-01
  Total weights = 2.0000e+06
  Execution time = 1.8814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352531233142
                                         uncertainty =       0.015358112760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352531233142
                                         uncertainty =       0.015358112760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419832163
  error estimate for blocks of size 2^( 2) =       0.000432138836
  error estimate for blocks of size 2^( 3) =       0.000445344406
  error estimate for blocks of size 2^( 4) =       0.000458103187
  error estimate for blocks of size 2^( 5) =       0.000469482670
  error estimate for blocks of size 2^( 6) =       0.000478458077
  error estimate for blocks of size 2^( 7) =       0.000485552451

      target function =                  N/A
              le_mean =     -16.906039588277
             les_mean =     286.166692474963
             stat err =       0.000472899096
             autocorr =       1.268777751507
              std dev =       0.593732339395
             le_variance =       0.352518090844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352531233143
                                         uncertainty =       0.015358112760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352531233143
                                         uncertainty =       0.015358112760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419832163
  error estimate for blocks of size 2^( 2) =       0.000432138836
  error estimate for blocks of size 2^( 3) =       0.000445344406
  error estimate for blocks of size 2^( 4) =       0.000458103187
  error estimate for blocks of size 2^( 5) =       0.000469482670
  error estimate for blocks of size 2^( 6) =       0.000478458077
  error estimate for blocks of size 2^( 7) =       0.000485552451

      target function =                  N/A
              le_mean =     -16.906039588277
             les_mean =     286.166692474963
             stat err =       0.000472899096
             autocorr =       1.268777751507
              std dev =       0.593732339396
             le_variance =       0.352518090844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352531233142
                                         uncertainty =       0.015358112760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352531233142
                                         uncertainty =       0.015358112760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419832163
  error estimate for blocks of size 2^( 2) =       0.000432138836
  error estimate for blocks of size 2^( 3) =       0.000445344406
  error estimate for blocks of size 2^( 4) =       0.000458103187
  error estimate for blocks of size 2^( 5) =       0.000469482670
  error estimate for blocks of size 2^( 6) =       0.000478458077
  error estimate for blocks of size 2^( 7) =       0.000485552451

      target function =                  N/A
              le_mean =     -16.906039588277
             les_mean =     286.166692474963
             stat err =       0.000472899096
             autocorr =       1.268777751508
              std dev =       0.593732339395
             le_variance =       0.352518090844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352531233142
                                         uncertainty =       0.015358112760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352531233142
                                         uncertainty =       0.015358112760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419832163
  error estimate for blocks of size 2^( 2) =       0.000432138836
  error estimate for blocks of size 2^( 3) =       0.000445344406
  error estimate for blocks of size 2^( 4) =       0.000458103187
  error estimate for blocks of size 2^( 5) =       0.000469482670
  error estimate for blocks of size 2^( 6) =       0.000478458077
  error estimate for blocks of size 2^( 7) =       0.000485552451

      target function =                  N/A
              le_mean =     -16.906039588277
             les_mean =     286.166692474963
             stat err =       0.000472899096
             autocorr =       1.268777751507
              std dev =       0.593732339395
             le_variance =       0.352518090844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906039588277        initial  <--
     3.8147e+08     3.8147e+09             8.8482e-13       -16.906039588277
     1.5259e+09     1.5259e+10             2.2107e-13       -16.906039588277
     6.1035e+09     6.1035e+10             5.5332e-14       -16.906039588277

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5441
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5696e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9207
    reference variance = 0.261588
====================================================
  Execution time = 2.0390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346960136256
                                         uncertainty =       0.009351956511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346960136256
                                         uncertainty =       0.009351956511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416715036
  error estimate for blocks of size 2^( 2) =       0.000429389979
  error estimate for blocks of size 2^( 3) =       0.000442029838
  error estimate for blocks of size 2^( 4) =       0.000453763097
  error estimate for blocks of size 2^( 5) =       0.000463446684
  error estimate for blocks of size 2^( 6) =       0.000471266803
  error estimate for blocks of size 2^( 7) =       0.000472994561

      target function =                  N/A
              le_mean =     -16.905491263628
             les_mean =     286.142937533097
             stat err =       0.000465367786
             autocorr =       1.247137369501
              std dev =       0.589324055293
             le_variance =       0.347302842147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690549126363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905491263628       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905491263628       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491263628       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905492560415       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905489876698       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905490493916       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905491263148       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905488757345       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905489461499       residual = 8.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 9.523082e-14

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905491263628       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905491263628       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491263628       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905490461318       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905491024366       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905489361513       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905481507385       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905497927940       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905499952134       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905468065604       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905530963229       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905695378028       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905442612550       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904915157285       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906254129356       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905845480817       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906176332612       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905257422432       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907069625185       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905205943251       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904160973463       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906025772753       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904519175095       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906313243829       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905974133823       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906639875596       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906980461156       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906197033156       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.905251479719       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906228253499       residual = 6.21e-05           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.906316506557       residual = 8.23e-05           smallest_sin_value = 9.90e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.56e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+10 is 2.377427e-14

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905491263628       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905491263628       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491263628       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905489638480       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905491987448       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905476067971       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905482433080       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905367549240       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905571823307       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906112377904       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905101669056       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905818295249       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905161217582       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907310959759       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.902117971423       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907481912167       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906119602250       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.893923209159       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909765833056       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907397212513       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909956078452       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904625217452       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.910051410269       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907638964536       residual = 6.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.904562431273       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906665235470       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.900818037109       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905431741699       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.902599501208       residual = 9.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.904387457832       residual = 1.30e-04           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.915576002513       residual = 1.26e-02           smallest_sin_value = 9.97e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.905459581703       residual = 1.25e-04           smallest_sin_value = 9.91e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.10e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 6.291616e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169021 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6153e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8373
    reference variance = 1.07881
====================================================
  Execution time = 2.0073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2828e-01
  Total weights = 2.0000e+06
  Execution time = 1.8774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328195539841
                                         uncertainty =       0.002521656921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328195539841
                                         uncertainty =       0.002521656921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405142375
  error estimate for blocks of size 2^( 2) =       0.000418088437
  error estimate for blocks of size 2^( 3) =       0.000431745958
  error estimate for blocks of size 2^( 4) =       0.000444752983
  error estimate for blocks of size 2^( 5) =       0.000456689544
  error estimate for blocks of size 2^( 6) =       0.000463898528
  error estimate for blocks of size 2^( 7) =       0.000472083214

      target function =                  N/A
              le_mean =     -16.905185285120
             les_mean =     286.113570047411
             stat err =       0.000459356067
             autocorr =       1.285534022864
              std dev =       0.572957840789
             le_variance =       0.328280687321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328195539841
                                         uncertainty =       0.002521656921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328195539841
                                         uncertainty =       0.002521656921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405142375
  error estimate for blocks of size 2^( 2) =       0.000418088437
  error estimate for blocks of size 2^( 3) =       0.000431745958
  error estimate for blocks of size 2^( 4) =       0.000444752983
  error estimate for blocks of size 2^( 5) =       0.000456689544
  error estimate for blocks of size 2^( 6) =       0.000463898528
  error estimate for blocks of size 2^( 7) =       0.000472083214

      target function =                  N/A
              le_mean =     -16.905185285120
             les_mean =     286.113570047411
             stat err =       0.000459356067
             autocorr =       1.285534022861
              std dev =       0.572957840789
             le_variance =       0.328280687321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328195539841
                                         uncertainty =       0.002521656921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328195539841
                                         uncertainty =       0.002521656921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405142375
  error estimate for blocks of size 2^( 2) =       0.000418088437
  error estimate for blocks of size 2^( 3) =       0.000431745958
  error estimate for blocks of size 2^( 4) =       0.000444752983
  error estimate for blocks of size 2^( 5) =       0.000456689544
  error estimate for blocks of size 2^( 6) =       0.000463898528
  error estimate for blocks of size 2^( 7) =       0.000472083214

      target function =                  N/A
              le_mean =     -16.905185285120
             les_mean =     286.113570047411
             stat err =       0.000459356067
             autocorr =       1.285534022861
              std dev =       0.572957840789
             le_variance =       0.328280687321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328195539841
                                         uncertainty =       0.002521656921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328195539841
                                         uncertainty =       0.002521656921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405142375
  error estimate for blocks of size 2^( 2) =       0.000418088437
  error estimate for blocks of size 2^( 3) =       0.000431745958
  error estimate for blocks of size 2^( 4) =       0.000444752983
  error estimate for blocks of size 2^( 5) =       0.000456689544
  error estimate for blocks of size 2^( 6) =       0.000463898528
  error estimate for blocks of size 2^( 7) =       0.000472083214

      target function =                  N/A
              le_mean =     -16.905185285120
             les_mean =     286.113570047411
             stat err =       0.000459356067
             autocorr =       1.285534022861
              std dev =       0.572957840789
             le_variance =       0.328280687321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905185285120        initial  <--
     3.8147e+09     3.8147e+10             9.5231e-14       -16.905185285120
     1.5259e+10     1.5259e+11             2.3774e-14       -16.905185285120
     6.1035e+10     6.1035e+11             6.2916e-15       -16.905185285120

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6368
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5796e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.642561
====================================================
  Execution time = 2.0502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3560e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335623642564
                                         uncertainty =       0.003514106460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335623642564
                                         uncertainty =       0.003514106460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409633526
  error estimate for blocks of size 2^( 2) =       0.000422450946
  error estimate for blocks of size 2^( 3) =       0.000435804524
  error estimate for blocks of size 2^( 4) =       0.000448440982
  error estimate for blocks of size 2^( 5) =       0.000459621565
  error estimate for blocks of size 2^( 6) =       0.000467376842
  error estimate for blocks of size 2^( 7) =       0.000472489917

      target function =                  N/A
              le_mean =     -16.905887833101
             les_mean =     286.144642509072
             stat err =       0.000461982327
             autocorr =       1.271919821379
              std dev =       0.579309288279
             le_variance =       0.335599251487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588783310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905887833101       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905887833101       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905887833101       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905888933344       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905887532393       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905888004272       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905902947572       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905882407567       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905909149617       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906086594117       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906034503815       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905896102983       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905718468936       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906328770029       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906504679580       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907534239611       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906503277371       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.903929022902       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.903725812834       residual = 6.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907538277687       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906660600904       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906106709966       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.907605176080       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908136691799       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905283348770       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.909531650021       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.904514034129       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906598421421       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.904204463719       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.903911377146       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.910821209335       residual = 3.72e-03           smallest_sin_value = 9.97e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 9.508766e-15

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905887833101       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905887833101       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905887833101       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905969949245       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905955517079       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906720461017       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904724093427       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905580661735       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906367255181       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904051682652       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905142405384       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903081198257       residual = 9.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.902863546871       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.900250178709       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.902159345283       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.912466212123       residual = 5.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908644131275       residual = 9.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.899465732331       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.915188956396       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.888583909093       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910534528999       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.893507317678       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.897438346462       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.894024070792       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.901354219972       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908263940588       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.895729669178       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.909654052208       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.889779675018       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.913614981761       residual = 7.99e-03           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.905093318501       residual = 1.55e-04           smallest_sin_value = 9.93e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+11 is 1.846468e-15

solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905887833101       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905887833101       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905887833101       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905887833101       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906145558206       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905739436900       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905546779561       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908170465797       residual = 7.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906172303920       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907543415254       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905901975880       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906348311445       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911932156421       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910065160510       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.917304494403       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908211750837       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.885113169081       residual = 5.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.924870381120       residual = 4.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.953029305489       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.940748135781       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908842954045       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.893339913730       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.938732462816       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.932200169830       residual = 8.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.916971653158       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.822354665883       residual = 8.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.939161469114       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.938445956869       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.842896267866       residual = 5.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.861641064065       residual = 2.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.881870288425       residual = 1.04e-01           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.933891547216       residual = 8.38e-02           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.31e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+11 is 3.229960e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6044e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8826
    reference variance = 0.231737
====================================================
  Execution time = 1.9855e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 9.2210e-01
  Total weights = 2.0000e+06
  Execution time = 1.8884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.923098161604
                                         uncertainty =       0.586306073153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.923098161604
                                         uncertainty =       0.586306073153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000679005644
  error estimate for blocks of size 2^( 2) =       0.000686877722
  error estimate for blocks of size 2^( 3) =       0.000694961044
  error estimate for blocks of size 2^( 4) =       0.000703423372
  error estimate for blocks of size 2^( 5) =       0.000710464462
  error estimate for blocks of size 2^( 6) =       0.000713899582
  error estimate for blocks of size 2^( 7) =       0.000719528353

      target function =                  N/A
              le_mean =     -16.905817333407
             les_mean =     286.728756578088
             stat err =       0.000711828942
             autocorr =       1.099017266597
              std dev =       0.960258990392
             le_variance =       0.922097328628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.923098161604
                                         uncertainty =       0.586306073153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.923098161604
                                         uncertainty =       0.586306073153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000679005644
  error estimate for blocks of size 2^( 2) =       0.000686877722
  error estimate for blocks of size 2^( 3) =       0.000694961044
  error estimate for blocks of size 2^( 4) =       0.000703423372
  error estimate for blocks of size 2^( 5) =       0.000710464462
  error estimate for blocks of size 2^( 6) =       0.000713899582
  error estimate for blocks of size 2^( 7) =       0.000719528353

      target function =                  N/A
              le_mean =     -16.905817333407
             les_mean =     286.728756578088
             stat err =       0.000711828942
             autocorr =       1.099017266598
              std dev =       0.960258990392
             le_variance =       0.922097328628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.923098161604
                                         uncertainty =       0.586306073153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.923098161604
                                         uncertainty =       0.586306073153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000679005644
  error estimate for blocks of size 2^( 2) =       0.000686877722
  error estimate for blocks of size 2^( 3) =       0.000694961044
  error estimate for blocks of size 2^( 4) =       0.000703423372
  error estimate for blocks of size 2^( 5) =       0.000710464462
  error estimate for blocks of size 2^( 6) =       0.000713899582
  error estimate for blocks of size 2^( 7) =       0.000719528353

      target function =                  N/A
              le_mean =     -16.905817333407
             les_mean =     286.728756578088
             stat err =       0.000711828942
             autocorr =       1.099017266595
              std dev =       0.960258990392
             le_variance =       0.922097328628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.923098161604
                                         uncertainty =       0.586306073153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.923098161604
                                         uncertainty =       0.586306073153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000679005644
  error estimate for blocks of size 2^( 2) =       0.000686877722
  error estimate for blocks of size 2^( 3) =       0.000694961044
  error estimate for blocks of size 2^( 4) =       0.000703423372
  error estimate for blocks of size 2^( 5) =       0.000710464462
  error estimate for blocks of size 2^( 6) =       0.000713899582
  error estimate for blocks of size 2^( 7) =       0.000719528353

      target function =                  N/A
              le_mean =     -16.905817333407
             les_mean =     286.728756578088
             stat err =       0.000711828942
             autocorr =       1.099017266598
              std dev =       0.960258990392
             le_variance =       0.922097328628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905817333407        initial  <--
     3.8147e+10     3.8147e+11             9.5088e-15       -16.905817333407
     1.5259e+11     1.5259e+12             1.8465e-15       -16.905817333407
     6.1035e+11     6.1035e+12             3.2300e-16       -16.905817333407

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4142
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5465e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8917
    reference variance = 0.196549
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3227e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332332004504
                                         uncertainty =       0.002975257843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332332004504
                                         uncertainty =       0.002975257843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407596795
  error estimate for blocks of size 2^( 2) =       0.000420428031
  error estimate for blocks of size 2^( 3) =       0.000434227542
  error estimate for blocks of size 2^( 4) =       0.000447466871
  error estimate for blocks of size 2^( 5) =       0.000459253726
  error estimate for blocks of size 2^( 6) =       0.000466440441
  error estimate for blocks of size 2^( 7) =       0.000471883084

      target function =                  N/A
              le_mean =     -16.906533573117
             les_mean =     286.163147586933
             stat err =       0.000461261030
             autocorr =       1.280654586419
              std dev =       0.576428915085
             le_variance =       0.332270294146


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653357312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906533573117       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533573117       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906533573117       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906533573117       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906481906364       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906526381730       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193288410       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906605599367       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906862914588       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908749431832       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906996781373       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906816456345       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909610194842       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906945649623       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907586549788       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.896602223404       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910878655948       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.902285707121       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.880141187810       residual = 9.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.913335089870       residual = 6.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.917645033714       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.927525590214       residual = 5.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911407227188       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908834210177       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906820413480       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.885749396403       residual = 6.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.850777448283       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.877634371196       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.904708492078       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.891438842927       residual = 3.41e-02           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.871109053337       residual = 1.69e-01           smallest_sin_value = 9.98e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 9.432088e-16

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906533573117       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533573117       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906533573117       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533573117       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5978e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9422
    reference variance = 0.303539
====================================================
  Execution time = 1.9906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3182e-01
  Total weights = 2.0000e+06
  Execution time = 1.8852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331849200612
                                         uncertainty =       0.002963162274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331849200612
                                         uncertainty =       0.002963162274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407322555
  error estimate for blocks of size 2^( 2) =       0.000420383788
  error estimate for blocks of size 2^( 3) =       0.000433628315
  error estimate for blocks of size 2^( 4) =       0.000446915594
  error estimate for blocks of size 2^( 5) =       0.000458064703
  error estimate for blocks of size 2^( 6) =       0.000467446471
  error estimate for blocks of size 2^( 7) =       0.000473061528

      target function =                  N/A
              le_mean =     -16.905950188033
             les_mean =     286.142974921428
             stat err =       0.000461372074
             autocorr =       1.282997145622
              std dev =       0.576041081087
             le_variance =       0.331823327100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331849200612
                                         uncertainty =       0.002963162274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331849200612
                                         uncertainty =       0.002963162274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407322555
  error estimate for blocks of size 2^( 2) =       0.000420383788
  error estimate for blocks of size 2^( 3) =       0.000433628315
  error estimate for blocks of size 2^( 4) =       0.000446915594
  error estimate for blocks of size 2^( 5) =       0.000458064703
  error estimate for blocks of size 2^( 6) =       0.000467446471
  error estimate for blocks of size 2^( 7) =       0.000473061528

      target function =                  N/A
              le_mean =     -16.905950188033
             les_mean =     286.142974921428
             stat err =       0.000461372074
             autocorr =       1.282997145619
              std dev =       0.576041081087
             le_variance =       0.331823327100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331849200612
                                         uncertainty =       0.002963162274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331849200612
                                         uncertainty =       0.002963162274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407322555
  error estimate for blocks of size 2^( 2) =       0.000420383788
  error estimate for blocks of size 2^( 3) =       0.000433628315
  error estimate for blocks of size 2^( 4) =       0.000446915594
  error estimate for blocks of size 2^( 5) =       0.000458064703
  error estimate for blocks of size 2^( 6) =       0.000467446471
  error estimate for blocks of size 2^( 7) =       0.000473061528

      target function =                  N/A
              le_mean =     -16.905950188033
             les_mean =     286.142974921428
             stat err =       0.000461372074
             autocorr =       1.282997145622
              std dev =       0.576041081087
             le_variance =       0.331823327100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331849200612
                                         uncertainty =       0.002963162274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331849200612
                                         uncertainty =       0.002963162274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407322555
  error estimate for blocks of size 2^( 2) =       0.000420383788
  error estimate for blocks of size 2^( 3) =       0.000433628315
  error estimate for blocks of size 2^( 4) =       0.000446915594
  error estimate for blocks of size 2^( 5) =       0.000458064703
  error estimate for blocks of size 2^( 6) =       0.000467446471
  error estimate for blocks of size 2^( 7) =       0.000473061528

      target function =                  N/A
              le_mean =     -16.905950188033
             les_mean =     286.142974921428
             stat err =       0.000461372074
             autocorr =       1.282997145622
              std dev =       0.576041081087
             le_variance =       0.331823327100


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905950188033        initial  <--
     3.8147e+11     3.8147e+12             9.4321e-16       -16.905950188033
     1.5259e+12     1.5259e+13             0.0000e+00       -16.905950188033
     6.1035e+12     6.1035e+13             0.0000e+00       -16.905950188033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4457
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5431e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8767
    reference variance = 0.189098
====================================================
  Execution time = 2.0409e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339654105809
                                         uncertainty =       0.006349477629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339654105809
                                         uncertainty =       0.006349477629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412109620
  error estimate for blocks of size 2^( 2) =       0.000424611487
  error estimate for blocks of size 2^( 3) =       0.000437696308
  error estimate for blocks of size 2^( 4) =       0.000450414082
  error estimate for blocks of size 2^( 5) =       0.000462014514
  error estimate for blocks of size 2^( 6) =       0.000470351569
  error estimate for blocks of size 2^( 7) =       0.000476888271

      target function =                  N/A
              le_mean =     -16.904738926439
             les_mean =     286.109866679609
             stat err =       0.000464917109
             autocorr =       1.272698556231
              std dev =       0.582811014281
             le_variance =       0.339668678367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690473892644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904738926439       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904738926439       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904738926439       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904738926439       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.900840229082       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914908721338       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915101163689       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.920510001180       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.891716913496       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.920542898204       residual = 3.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903219753295       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908041451532       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.885774551672       residual = 4.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.924444717655       residual = 5.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.919200554395       residual = 5.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.893802375817       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.936488011959       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904299716897       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.890912099865       residual = 7.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.852653108828       residual = 4.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.948359428691       residual = 4.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.976901302852       residual = 9.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.973166891274       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.017937154614       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.769323184431       residual = 2.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.947146278371       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.566088589987       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.860508314243       residual = 3.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.840316864523       residual = 6.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.871830284927       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.809171988471       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.650846402163       residual = 7.87e+00           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.768904077702       residual = 5.30e+00           smallest_sin_value = 9.95e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904738926439       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904738926439       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904738926439       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904738926439       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907676645149       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.917279587227       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912361537437       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.133052864960       residual = 7.37e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.002442134638       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.787590278552       residual = 2.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.835212864946       residual = 4.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.668553447302       residual = 7.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.927784056924       residual = 5.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.282592762116       residual = 5.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.949610335125       residual = 6.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.679482015324       residual = 7.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.433819001247       residual = 4.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.796048410562       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.170704385210       residual = 7.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -15.364105400951       residual = 3.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.539143008970       residual = 3.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.461784702772       residual = 2.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -18.937591770302       residual = 5.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.102524850577       residual = 8.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -15.749769705885       residual = 1.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -15.290854635921       residual = 3.60e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -19.244552064612       residual = 7.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.906219428117       residual = 1.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -15.391230118400       residual = 3.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.138142556105       residual = 7.58e+00           smallest_sin_value = 9.98e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904738926439       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904738926439       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904738926439       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904738926439       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907337102399       residual = 4.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.945389919119       residual = 2.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908838356161       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.847666622343       residual = 6.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922706912943       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.259979673412       residual = 1.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.223903152491       residual = 6.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.360812574935       residual = 3.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.697607270232       residual = 4.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -18.064466759010       residual = 1.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.592096015046       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.158742600919       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.748678498239       residual = 6.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.052125892711       residual = 5.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.666411640566       residual = 8.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -15.238258698408       residual = 3.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -15.602043977014       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.009829600795       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.443068930919       residual = 5.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -23.837313019528       residual = 5.81e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.397779611474       residual = 1.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -10.524567264267       residual = 5.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -15.192982296788       residual = 1.19e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.580963233178       residual = 2.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -21.904664406165       residual = 3.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -19.361779204286       residual = 8.86e+02           smallest_sin_value = 9.98e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262723 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5967e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8768
    reference variance = 0.262512
====================================================
  Execution time = 2.2255e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3644e-01
  Total weights = 2.0000e+06
  Execution time = 1.8892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336485134423
                                         uncertainty =       0.003508327645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336485134423
                                         uncertainty =       0.003508327645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410143904
  error estimate for blocks of size 2^( 2) =       0.000423393987
  error estimate for blocks of size 2^( 3) =       0.000437232885
  error estimate for blocks of size 2^( 4) =       0.000449742332
  error estimate for blocks of size 2^( 5) =       0.000462026733
  error estimate for blocks of size 2^( 6) =       0.000472339668
  error estimate for blocks of size 2^( 7) =       0.000476788780

      target function =                  N/A
              le_mean =     -16.905685746954
             les_mean =     286.138646450643
             stat err =       0.000465224378
             autocorr =       1.286626245002
              std dev =       0.580031071658
             le_variance =       0.336436044089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336485134423
                                         uncertainty =       0.003508327645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336485134423
                                         uncertainty =       0.003508327645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410143904
  error estimate for blocks of size 2^( 2) =       0.000423393987
  error estimate for blocks of size 2^( 3) =       0.000437232885
  error estimate for blocks of size 2^( 4) =       0.000449742332
  error estimate for blocks of size 2^( 5) =       0.000462026733
  error estimate for blocks of size 2^( 6) =       0.000472339668
  error estimate for blocks of size 2^( 7) =       0.000476788780

      target function =                  N/A
              le_mean =     -16.905685746954
             les_mean =     286.138646450643
             stat err =       0.000465224378
             autocorr =       1.286626245002
              std dev =       0.580031071658
             le_variance =       0.336436044089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336485134423
                                         uncertainty =       0.003508327645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336485134423
                                         uncertainty =       0.003508327645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410143904
  error estimate for blocks of size 2^( 2) =       0.000423393987
  error estimate for blocks of size 2^( 3) =       0.000437232885
  error estimate for blocks of size 2^( 4) =       0.000449742332
  error estimate for blocks of size 2^( 5) =       0.000462026733
  error estimate for blocks of size 2^( 6) =       0.000472339668
  error estimate for blocks of size 2^( 7) =       0.000476788780

      target function =                  N/A
              le_mean =     -16.905685746954
             les_mean =     286.138646450643
             stat err =       0.000465224378
             autocorr =       1.286626245002
              std dev =       0.580031071658
             le_variance =       0.336436044089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336485134423
                                         uncertainty =       0.003508327645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336485134423
                                         uncertainty =       0.003508327645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410143904
  error estimate for blocks of size 2^( 2) =       0.000423393987
  error estimate for blocks of size 2^( 3) =       0.000437232885
  error estimate for blocks of size 2^( 4) =       0.000449742332
  error estimate for blocks of size 2^( 5) =       0.000462026733
  error estimate for blocks of size 2^( 6) =       0.000472339668
  error estimate for blocks of size 2^( 7) =       0.000476788780

      target function =                  N/A
              le_mean =     -16.905685746954
             les_mean =     286.138646450643
             stat err =       0.000465224378
             autocorr =       1.286626245002
              std dev =       0.580031071658
             le_variance =       0.336436044089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905685746954        initial  <--
     3.8147e+12     3.8147e+13             0.0000e+00       -16.905685746954
     1.5259e+13     1.5259e+14             0.0000e+00       -16.905685746954
     6.1035e+13     6.1035e+14             0.0000e+00       -16.905685746954

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8460
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7819e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8445
    reference variance = 0.305175
====================================================
  Execution time = 2.0044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3324e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333211058594
                                         uncertainty =       0.003000393620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333211058594
                                         uncertainty =       0.003000393620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408188201
  error estimate for blocks of size 2^( 2) =       0.000421030554
  error estimate for blocks of size 2^( 3) =       0.000434587073
  error estimate for blocks of size 2^( 4) =       0.000447644853
  error estimate for blocks of size 2^( 5) =       0.000459340422
  error estimate for blocks of size 2^( 6) =       0.000468108102
  error estimate for blocks of size 2^( 7) =       0.000475327917

      target function =                  N/A
              le_mean =     -16.905892396233
             les_mean =     286.142432761352
             stat err =       0.000462605323
             autocorr =       1.284400181689
              std dev =       0.577265289943
             le_variance =       0.333235214973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589239623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905892396233       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905892396233       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905892396233       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905892396233       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905892396233       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905892396233       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5637e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9251
    reference variance = 0.121341
====================================================
  Execution time = 2.0142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6407e-01
  Total weights = 2.0000e+06
  Execution time = 1.8982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363950797978
                                         uncertainty =       0.026749107330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363950797978
                                         uncertainty =       0.026749107330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426657320
  error estimate for blocks of size 2^( 2) =       0.000439655920
  error estimate for blocks of size 2^( 3) =       0.000453894084
  error estimate for blocks of size 2^( 4) =       0.000466449922
  error estimate for blocks of size 2^( 5) =       0.000477240767
  error estimate for blocks of size 2^( 6) =       0.000487173479
  error estimate for blocks of size 2^( 7) =       0.000491433694

      target function =                  N/A
              le_mean =     -16.905943628273
             les_mean =     286.175002716892
             stat err =       0.000480574465
             autocorr =       1.268711807478
              std dev =       0.603384567748
             le_variance =       0.364072936596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363950797978
                                         uncertainty =       0.026749107330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363950797978
                                         uncertainty =       0.026749107330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426657320
  error estimate for blocks of size 2^( 2) =       0.000439655920
  error estimate for blocks of size 2^( 3) =       0.000453894084
  error estimate for blocks of size 2^( 4) =       0.000466449922
  error estimate for blocks of size 2^( 5) =       0.000477240767
  error estimate for blocks of size 2^( 6) =       0.000487173479
  error estimate for blocks of size 2^( 7) =       0.000491433694

      target function =                  N/A
              le_mean =     -16.905943628273
             les_mean =     286.175002716892
             stat err =       0.000480574465
             autocorr =       1.268711807478
              std dev =       0.603384567748
             le_variance =       0.364072936596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363950797978
                                         uncertainty =       0.026749107330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363950797978
                                         uncertainty =       0.026749107330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426657320
  error estimate for blocks of size 2^( 2) =       0.000439655920
  error estimate for blocks of size 2^( 3) =       0.000453894084
  error estimate for blocks of size 2^( 4) =       0.000466449922
  error estimate for blocks of size 2^( 5) =       0.000477240767
  error estimate for blocks of size 2^( 6) =       0.000487173479
  error estimate for blocks of size 2^( 7) =       0.000491433694

      target function =                  N/A
              le_mean =     -16.905943628273
             les_mean =     286.175002716892
             stat err =       0.000480574465
             autocorr =       1.268711807478
              std dev =       0.603384567748
             le_variance =       0.364072936596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363950797978
                                         uncertainty =       0.026749107330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363950797978
                                         uncertainty =       0.026749107330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426657320
  error estimate for blocks of size 2^( 2) =       0.000439655920
  error estimate for blocks of size 2^( 3) =       0.000453894084
  error estimate for blocks of size 2^( 4) =       0.000466449922
  error estimate for blocks of size 2^( 5) =       0.000477240767
  error estimate for blocks of size 2^( 6) =       0.000487173479
  error estimate for blocks of size 2^( 7) =       0.000491433694

      target function =                  N/A
              le_mean =     -16.905943628273
             les_mean =     286.175002716892
             stat err =       0.000480574465
             autocorr =       1.268711807478
              std dev =       0.603384567748
             le_variance =       0.364072936596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905943628273        initial  <--
     3.8147e+13     3.8147e+14             0.0000e+00       -16.905943628273
     1.5259e+14     1.5259e+15             0.0000e+00       -16.905943628273
     6.1035e+14     6.1035e+15             0.0000e+00       -16.905943628273

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7399
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5382e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8412
    reference variance = 0.265577
====================================================
  Execution time = 1.9999e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337000842119
                                         uncertainty =       0.003196143438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337000842119
                                         uncertainty =       0.003196143438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410458985
  error estimate for blocks of size 2^( 2) =       0.000423167655
  error estimate for blocks of size 2^( 3) =       0.000436130136
  error estimate for blocks of size 2^( 4) =       0.000448733943
  error estimate for blocks of size 2^( 5) =       0.000459891845
  error estimate for blocks of size 2^( 6) =       0.000466391757
  error estimate for blocks of size 2^( 7) =       0.000471253408

      target function =                  N/A
              le_mean =     -16.905946290189
             les_mean =     286.147972954535
             stat err =       0.000461567738
             autocorr =       1.264536467657
              std dev =       0.580476662966
             le_variance =       0.336953156248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594629019e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905946290189       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905946290189       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905946290189       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.708543093565       residual = 5.61e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.859142918814       residual = 9.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.928165059834       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.651882376569       residual = 1.31e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -18.597682227632       residual = 3.73e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.593996525116       residual = 5.71e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -23.291086378975       residual = 5.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.090007083444       residual = 3.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -10.885485627169       residual = 5.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.652903353447       residual = 9.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -25.841097377923       residual = 1.10e+04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -11.996428056611       residual = 3.51e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.192590080055       residual = 1.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   16 stopping due to too large eigenvalue change
davidson solver did not converge after         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 1.904649e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905946290189       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905946290189       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905946290189       residual = 3.71e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905946290189       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.969761398039       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.568790940457       residual = 5.70e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =      -8.432849986462       residual = 1.04e+04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.468193775515       residual = 1.30e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -23.621556603974       residual = 6.64e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -23.824515883734       residual = 6.03e+03           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+15 is 4.761622e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905946290189       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905946290189       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905946290189       residual = 9.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+15 is 1.190406e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5523e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9961
    reference variance = 0.221197
====================================================
  Execution time = 2.0020e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3840e-01
  Total weights = 2.0000e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338370710223
                                         uncertainty =       0.003048442315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338370710223
                                         uncertainty =       0.003048442315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411337848
  error estimate for blocks of size 2^( 2) =       0.000424214794
  error estimate for blocks of size 2^( 3) =       0.000437817545
  error estimate for blocks of size 2^( 4) =       0.000450888569
  error estimate for blocks of size 2^( 5) =       0.000463279834
  error estimate for blocks of size 2^( 6) =       0.000472818719
  error estimate for blocks of size 2^( 7) =       0.000477680025

      target function =                  N/A
              le_mean =     -16.905511304681
             les_mean =     286.134709953274
             stat err =       0.000466166787
             autocorr =       1.284355687140
              std dev =       0.581719562834
             le_variance =       0.338397649784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338370710223
                                         uncertainty =       0.003048442315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338370710223
                                         uncertainty =       0.003048442315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411337848
  error estimate for blocks of size 2^( 2) =       0.000424214794
  error estimate for blocks of size 2^( 3) =       0.000437817545
  error estimate for blocks of size 2^( 4) =       0.000450888569
  error estimate for blocks of size 2^( 5) =       0.000463279834
  error estimate for blocks of size 2^( 6) =       0.000472818719
  error estimate for blocks of size 2^( 7) =       0.000477680025

      target function =                  N/A
              le_mean =     -16.905511304681
             les_mean =     286.134709953274
             stat err =       0.000466166787
             autocorr =       1.284355687140
              std dev =       0.581719562834
             le_variance =       0.338397649784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338370710223
                                         uncertainty =       0.003048442315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338370710223
                                         uncertainty =       0.003048442315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411337848
  error estimate for blocks of size 2^( 2) =       0.000424214794
  error estimate for blocks of size 2^( 3) =       0.000437817545
  error estimate for blocks of size 2^( 4) =       0.000450888569
  error estimate for blocks of size 2^( 5) =       0.000463279834
  error estimate for blocks of size 2^( 6) =       0.000472818719
  error estimate for blocks of size 2^( 7) =       0.000477680025

      target function =                  N/A
              le_mean =     -16.905511304681
             les_mean =     286.134709953274
             stat err =       0.000466166787
             autocorr =       1.284355687140
              std dev =       0.581719562834
             le_variance =       0.338397649784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338370710223
                                         uncertainty =       0.003048442315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338370710223
                                         uncertainty =       0.003048442315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411337848
  error estimate for blocks of size 2^( 2) =       0.000424214794
  error estimate for blocks of size 2^( 3) =       0.000437817545
  error estimate for blocks of size 2^( 4) =       0.000450888569
  error estimate for blocks of size 2^( 5) =       0.000463279834
  error estimate for blocks of size 2^( 6) =       0.000472818719
  error estimate for blocks of size 2^( 7) =       0.000477680025

      target function =                  N/A
              le_mean =     -16.905511304681
             les_mean =     286.134709953274
             stat err =       0.000466166787
             autocorr =       1.284355687140
              std dev =       0.581719562834
             le_variance =       0.338397649784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905511304681        initial  <--
     3.8147e+14     3.8147e+15             1.9046e-19       -16.905511304681
     1.5259e+15     1.5259e+16             4.7616e-20       -16.905511304681
     6.1035e+15     6.1035e+16             1.1904e-20       -16.905511304681

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5928
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5122e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8639
    reference variance = 0.229788
====================================================
  Execution time = 2.0436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3575e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335771136424
                                         uncertainty =       0.005710132343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335771136424
                                         uncertainty =       0.005710132343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409723646
  error estimate for blocks of size 2^( 2) =       0.000422673570
  error estimate for blocks of size 2^( 3) =       0.000436131421
  error estimate for blocks of size 2^( 4) =       0.000448737518
  error estimate for blocks of size 2^( 5) =       0.000459724057
  error estimate for blocks of size 2^( 6) =       0.000468840814
  error estimate for blocks of size 2^( 7) =       0.000471871442

      target function =                  N/A
              le_mean =     -16.905967912088
             les_mean =     286.147497808116
             stat err =       0.000462293458
             autocorr =       1.273073383713
              std dev =       0.579436736370
             le_variance =       0.335746931455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596791209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905967912088       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905967912088       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905967912088       residual = 4.87e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -18.375258710585       residual = 2.99e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.359246423993       residual = 2.68e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -10.174690174596       residual = 8.15e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -10.226959080154       residual = 8.31e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -10.476979062802       residual = 5.02e+03           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 1.169829e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905967912088       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905967912088       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905967912088       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+16 is 2.924573e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905967912088       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905967912088       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905967912088       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+16 is 7.311432e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270753 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5977e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.954
    reference variance = 0.372622
====================================================
  Execution time = 2.0364e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3746e-01
  Total weights = 2.0000e+06
  Execution time = 1.8953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436439019
                                         uncertainty =       0.003569125870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436439019
                                         uncertainty =       0.003569125870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410765601
  error estimate for blocks of size 2^( 2) =       0.000423789108
  error estimate for blocks of size 2^( 3) =       0.000436896322
  error estimate for blocks of size 2^( 4) =       0.000450051734
  error estimate for blocks of size 2^( 5) =       0.000460955431
  error estimate for blocks of size 2^( 6) =       0.000467489735
  error estimate for blocks of size 2^( 7) =       0.000473080391

      target function =                  N/A
              le_mean =     -16.905838272313
             les_mean =     286.144824279370
             stat err =       0.000462894323
             autocorr =       1.269917691924
              std dev =       0.580910284387
             le_variance =       0.337456758506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436439019
                                         uncertainty =       0.003569125870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436439019
                                         uncertainty =       0.003569125870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410765601
  error estimate for blocks of size 2^( 2) =       0.000423789108
  error estimate for blocks of size 2^( 3) =       0.000436896322
  error estimate for blocks of size 2^( 4) =       0.000450051734
  error estimate for blocks of size 2^( 5) =       0.000460955431
  error estimate for blocks of size 2^( 6) =       0.000467489735
  error estimate for blocks of size 2^( 7) =       0.000473080391

      target function =                  N/A
              le_mean =     -16.905838272313
             les_mean =     286.144824279370
             stat err =       0.000462894323
             autocorr =       1.269917691924
              std dev =       0.580910284387
             le_variance =       0.337456758506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436439019
                                         uncertainty =       0.003569125870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436439019
                                         uncertainty =       0.003569125870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410765601
  error estimate for blocks of size 2^( 2) =       0.000423789108
  error estimate for blocks of size 2^( 3) =       0.000436896322
  error estimate for blocks of size 2^( 4) =       0.000450051734
  error estimate for blocks of size 2^( 5) =       0.000460955431
  error estimate for blocks of size 2^( 6) =       0.000467489735
  error estimate for blocks of size 2^( 7) =       0.000473080391

      target function =                  N/A
              le_mean =     -16.905838272313
             les_mean =     286.144824279370
             stat err =       0.000462894323
             autocorr =       1.269917691924
              std dev =       0.580910284387
             le_variance =       0.337456758506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436439019
                                         uncertainty =       0.003569125870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436439019
                                         uncertainty =       0.003569125870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410765601
  error estimate for blocks of size 2^( 2) =       0.000423789108
  error estimate for blocks of size 2^( 3) =       0.000436896322
  error estimate for blocks of size 2^( 4) =       0.000450051734
  error estimate for blocks of size 2^( 5) =       0.000460955431
  error estimate for blocks of size 2^( 6) =       0.000467489735
  error estimate for blocks of size 2^( 7) =       0.000473080391

      target function =                  N/A
              le_mean =     -16.905838272313
             les_mean =     286.144824279370
             stat err =       0.000462894323
             autocorr =       1.269917691924
              std dev =       0.580910284387
             le_variance =       0.337456758506


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905838272313        initial  <--
     3.8147e+15     3.8147e+16             1.1698e-20       -16.905838272313
     1.5259e+16     1.5259e+17             2.9246e-21       -16.905838272313
     6.1035e+16     6.1035e+17             7.3114e-22       -16.905838272313

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9054
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5889e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8786
    reference variance = 0.270972
====================================================
  Execution time = 2.0192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4012e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340162137830
                                         uncertainty =       0.006077787586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340162137830
                                         uncertainty =       0.006077787586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412380440
  error estimate for blocks of size 2^( 2) =       0.000425735296
  error estimate for blocks of size 2^( 3) =       0.000439143342
  error estimate for blocks of size 2^( 4) =       0.000451758775
  error estimate for blocks of size 2^( 5) =       0.000463034747
  error estimate for blocks of size 2^( 6) =       0.000469947002
  error estimate for blocks of size 2^( 7) =       0.000472356686

      target function =                  N/A
              le_mean =     -16.905596042492
             les_mean =     286.139292636721
             stat err =       0.000464274302
             autocorr =       1.267515200953
              std dev =       0.583194011326
             le_variance =       0.340115254847


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559604249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905596042492       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905596042492       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.54e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905596042492       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905596042492       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905596042492       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905596042492       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271727 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5646e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0016
    reference variance = 0.35797
====================================================
  Execution time = 2.0323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3236e-01
  Total weights = 2.0000e+06
  Execution time = 1.8898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332323181967
                                         uncertainty =       0.003009830636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332323181967
                                         uncertainty =       0.003009830636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407650222
  error estimate for blocks of size 2^( 2) =       0.000420691858
  error estimate for blocks of size 2^( 3) =       0.000433703206
  error estimate for blocks of size 2^( 4) =       0.000446072396
  error estimate for blocks of size 2^( 5) =       0.000455883929
  error estimate for blocks of size 2^( 6) =       0.000462567677
  error estimate for blocks of size 2^( 7) =       0.000464227646

      target function =                  N/A
              le_mean =     -16.906161091869
             les_mean =     286.150640105787
             stat err =       0.000457187912
             autocorr =       1.257807299147
              std dev =       0.576504473310
             le_variance =       0.332357407746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332323181967
                                         uncertainty =       0.003009830636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332323181967
                                         uncertainty =       0.003009830636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407650222
  error estimate for blocks of size 2^( 2) =       0.000420691858
  error estimate for blocks of size 2^( 3) =       0.000433703206
  error estimate for blocks of size 2^( 4) =       0.000446072396
  error estimate for blocks of size 2^( 5) =       0.000455883929
  error estimate for blocks of size 2^( 6) =       0.000462567677
  error estimate for blocks of size 2^( 7) =       0.000464227646

      target function =                  N/A
              le_mean =     -16.906161091869
             les_mean =     286.150640105787
             stat err =       0.000457187912
             autocorr =       1.257807299147
              std dev =       0.576504473310
             le_variance =       0.332357407746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332323181967
                                         uncertainty =       0.003009830636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332323181967
                                         uncertainty =       0.003009830636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407650222
  error estimate for blocks of size 2^( 2) =       0.000420691858
  error estimate for blocks of size 2^( 3) =       0.000433703206
  error estimate for blocks of size 2^( 4) =       0.000446072396
  error estimate for blocks of size 2^( 5) =       0.000455883929
  error estimate for blocks of size 2^( 6) =       0.000462567677
  error estimate for blocks of size 2^( 7) =       0.000464227646

      target function =                  N/A
              le_mean =     -16.906161091869
             les_mean =     286.150640105787
             stat err =       0.000457187912
             autocorr =       1.257807299147
              std dev =       0.576504473310
             le_variance =       0.332357407746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332323181967
                                         uncertainty =       0.003009830636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332323181967
                                         uncertainty =       0.003009830636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407650222
  error estimate for blocks of size 2^( 2) =       0.000420691858
  error estimate for blocks of size 2^( 3) =       0.000433703206
  error estimate for blocks of size 2^( 4) =       0.000446072396
  error estimate for blocks of size 2^( 5) =       0.000455883929
  error estimate for blocks of size 2^( 6) =       0.000462567677
  error estimate for blocks of size 2^( 7) =       0.000464227646

      target function =                  N/A
              le_mean =     -16.906161091869
             les_mean =     286.150640105787
             stat err =       0.000457187912
             autocorr =       1.257807299147
              std dev =       0.576504473310
             le_variance =       0.332357407746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906161091869        initial  <--
     3.8147e+16     3.8147e+17             0.0000e+00       -16.906161091869
     1.5259e+17     1.5259e+18             0.0000e+00       -16.906161091869
     6.1035e+17     6.1035e+18             0.0000e+00       -16.906161091869

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9190
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5571e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9653
    reference variance = 0.233212
====================================================
  Execution time = 2.0711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3264e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332488700231
                                         uncertainty =       0.004027270524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332488700231
                                         uncertainty =       0.004027270524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407823115
  error estimate for blocks of size 2^( 2) =       0.000420774181
  error estimate for blocks of size 2^( 3) =       0.000433857828
  error estimate for blocks of size 2^( 4) =       0.000444727969
  error estimate for blocks of size 2^( 5) =       0.000454005698
  error estimate for blocks of size 2^( 6) =       0.000461864407
  error estimate for blocks of size 2^( 7) =       0.000465763326

      target function =                  N/A
              le_mean =     -16.905404471636
             les_mean =     286.125339569837
             stat err =       0.000456590350
             autocorr =       1.253457985464
              std dev =       0.576748980530
             le_variance =       0.332639386543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540447164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404471636       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404471636       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404471636       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404471636       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404471636       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404471636       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6256e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9177
    reference variance = 0.198305
====================================================
  Execution time = 2.0421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4547e-01
  Total weights = 2.0000e+06
  Execution time = 2.1701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345542792571
                                         uncertainty =       0.006332596873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345542792571
                                         uncertainty =       0.006332596873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415616232
  error estimate for blocks of size 2^( 2) =       0.000428134087
  error estimate for blocks of size 2^( 3) =       0.000440457008
  error estimate for blocks of size 2^( 4) =       0.000452609236
  error estimate for blocks of size 2^( 5) =       0.000464425828
  error estimate for blocks of size 2^( 6) =       0.000470573795
  error estimate for blocks of size 2^( 7) =       0.000473955055

      target function =                  N/A
              le_mean =     -16.905741193983
             les_mean =     286.149558849543
             stat err =       0.000465390979
             autocorr =       1.253865404977
              std dev =       0.587770111818
             le_variance =       0.345473704346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345542792571
                                         uncertainty =       0.006332596873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345542792571
                                         uncertainty =       0.006332596873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415616232
  error estimate for blocks of size 2^( 2) =       0.000428134087
  error estimate for blocks of size 2^( 3) =       0.000440457008
  error estimate for blocks of size 2^( 4) =       0.000452609236
  error estimate for blocks of size 2^( 5) =       0.000464425828
  error estimate for blocks of size 2^( 6) =       0.000470573795
  error estimate for blocks of size 2^( 7) =       0.000473955055

      target function =                  N/A
              le_mean =     -16.905741193983
             les_mean =     286.149558849543
             stat err =       0.000465390979
             autocorr =       1.253865404977
              std dev =       0.587770111818
             le_variance =       0.345473704346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345542792571
                                         uncertainty =       0.006332596873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345542792571
                                         uncertainty =       0.006332596873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415616232
  error estimate for blocks of size 2^( 2) =       0.000428134087
  error estimate for blocks of size 2^( 3) =       0.000440457008
  error estimate for blocks of size 2^( 4) =       0.000452609236
  error estimate for blocks of size 2^( 5) =       0.000464425828
  error estimate for blocks of size 2^( 6) =       0.000470573795
  error estimate for blocks of size 2^( 7) =       0.000473955055

      target function =                  N/A
              le_mean =     -16.905741193983
             les_mean =     286.149558849543
             stat err =       0.000465390979
             autocorr =       1.253865404977
              std dev =       0.587770111818
             le_variance =       0.345473704346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345542792571
                                         uncertainty =       0.006332596873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345542792571
                                         uncertainty =       0.006332596873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415616232
  error estimate for blocks of size 2^( 2) =       0.000428134087
  error estimate for blocks of size 2^( 3) =       0.000440457008
  error estimate for blocks of size 2^( 4) =       0.000452609236
  error estimate for blocks of size 2^( 5) =       0.000464425828
  error estimate for blocks of size 2^( 6) =       0.000470573795
  error estimate for blocks of size 2^( 7) =       0.000473955055

      target function =                  N/A
              le_mean =     -16.905741193983
             les_mean =     286.149558849543
             stat err =       0.000465390979
             autocorr =       1.253865404977
              std dev =       0.587770111818
             le_variance =       0.345473704346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905741193983        initial  <--
     3.8147e+17     3.8147e+18             0.0000e+00       -16.905741193983
     1.5259e+18     1.5259e+19             0.0000e+00       -16.905741193983
     6.1035e+18     6.1035e+19             0.0000e+00       -16.905741193983

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8269
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8089e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8837
    reference variance = 0.299438
====================================================
  Execution time = 2.0379e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4436e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344298910535
                                         uncertainty =       0.005901012190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344298910535
                                         uncertainty =       0.005901012190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414943998
  error estimate for blocks of size 2^( 2) =       0.000427837598
  error estimate for blocks of size 2^( 3) =       0.000440974331
  error estimate for blocks of size 2^( 4) =       0.000452698551
  error estimate for blocks of size 2^( 5) =       0.000462512969
  error estimate for blocks of size 2^( 6) =       0.000470458175
  error estimate for blocks of size 2^( 7) =       0.000475835984

      target function =                  N/A
              le_mean =     -16.905071844612
             les_mean =     286.125810942179
             stat err =       0.000465376420
             autocorr =       1.257852665208
              std dev =       0.586819429509
             le_variance =       0.344357042850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690507184461e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905071844612       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905071844612       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905071844612       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905071844612       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905071844612       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905071844612       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273820 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5921e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.895
    reference variance = 0.197294
====================================================
  Execution time = 2.0153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3953e-01
  Total weights = 2.0000e+06
  Execution time = 1.8913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584458324
                                         uncertainty =       0.006485797659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584458324
                                         uncertainty =       0.006485797659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412023445
  error estimate for blocks of size 2^( 2) =       0.000424898235
  error estimate for blocks of size 2^( 3) =       0.000437588585
  error estimate for blocks of size 2^( 4) =       0.000449632197
  error estimate for blocks of size 2^( 5) =       0.000458593378
  error estimate for blocks of size 2^( 6) =       0.000467376045
  error estimate for blocks of size 2^( 7) =       0.000473022531

      target function =                  N/A
              le_mean =     -16.905534344667
             les_mean =     286.136617947914
             stat err =       0.000462156038
             autocorr =       1.258152843249
              std dev =       0.582689144380
             le_variance =       0.339526638978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584458324
                                         uncertainty =       0.006485797659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584458324
                                         uncertainty =       0.006485797659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412023445
  error estimate for blocks of size 2^( 2) =       0.000424898235
  error estimate for blocks of size 2^( 3) =       0.000437588585
  error estimate for blocks of size 2^( 4) =       0.000449632197
  error estimate for blocks of size 2^( 5) =       0.000458593378
  error estimate for blocks of size 2^( 6) =       0.000467376045
  error estimate for blocks of size 2^( 7) =       0.000473022531

      target function =                  N/A
              le_mean =     -16.905534344667
             les_mean =     286.136617947914
             stat err =       0.000462156038
             autocorr =       1.258152843249
              std dev =       0.582689144380
             le_variance =       0.339526638978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584458324
                                         uncertainty =       0.006485797659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584458324
                                         uncertainty =       0.006485797659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412023445
  error estimate for blocks of size 2^( 2) =       0.000424898235
  error estimate for blocks of size 2^( 3) =       0.000437588585
  error estimate for blocks of size 2^( 4) =       0.000449632197
  error estimate for blocks of size 2^( 5) =       0.000458593378
  error estimate for blocks of size 2^( 6) =       0.000467376045
  error estimate for blocks of size 2^( 7) =       0.000473022531

      target function =                  N/A
              le_mean =     -16.905534344667
             les_mean =     286.136617947914
             stat err =       0.000462156038
             autocorr =       1.258152843249
              std dev =       0.582689144380
             le_variance =       0.339526638978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584458324
                                         uncertainty =       0.006485797659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584458324
                                         uncertainty =       0.006485797659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412023445
  error estimate for blocks of size 2^( 2) =       0.000424898235
  error estimate for blocks of size 2^( 3) =       0.000437588585
  error estimate for blocks of size 2^( 4) =       0.000449632197
  error estimate for blocks of size 2^( 5) =       0.000458593378
  error estimate for blocks of size 2^( 6) =       0.000467376045
  error estimate for blocks of size 2^( 7) =       0.000473022531

      target function =                  N/A
              le_mean =     -16.905534344667
             les_mean =     286.136617947914
             stat err =       0.000462156038
             autocorr =       1.258152843249
              std dev =       0.582689144380
             le_variance =       0.339526638978


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905534344667        initial  <--
     3.8147e+18     3.8147e+19             0.0000e+00       -16.905534344667
     1.5259e+19     1.5259e+20             0.0000e+00       -16.905534344667
     6.1035e+19     6.1035e+20             0.0000e+00       -16.905534344667

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7234
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.89
    reference variance = 0.269138
====================================================
  Execution time = 2.0559e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3334e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333340655206
                                         uncertainty =       0.005156004770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333340655206
                                         uncertainty =       0.005156004770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408253369
  error estimate for blocks of size 2^( 2) =       0.000420871524
  error estimate for blocks of size 2^( 3) =       0.000434074240
  error estimate for blocks of size 2^( 4) =       0.000447977176
  error estimate for blocks of size 2^( 5) =       0.000458499181
  error estimate for blocks of size 2^( 6) =       0.000466662870
  error estimate for blocks of size 2^( 7) =       0.000471690941

      target function =                  N/A
              le_mean =     -16.905656144171
             les_mean =     286.134551124589
             stat err =       0.000461207542
             autocorr =       1.276242628947
              std dev =       0.577357451062
             le_variance =       0.333341626296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565614417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905656144171       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905656144171       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905656144171       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905656144171       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905656144171       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905656144171       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905656144171       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6080e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8601
    reference variance = 0.21593
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3854e-01
  Total weights = 2.0000e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587727838
                                         uncertainty =       0.004454714317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587727838
                                         uncertainty =       0.004454714317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411425030
  error estimate for blocks of size 2^( 2) =       0.000424425994
  error estimate for blocks of size 2^( 3) =       0.000438007731
  error estimate for blocks of size 2^( 4) =       0.000450024335
  error estimate for blocks of size 2^( 5) =       0.000460289196
  error estimate for blocks of size 2^( 6) =       0.000469739439
  error estimate for blocks of size 2^( 7) =       0.000474805814

      target function =                  N/A
              le_mean =     -16.906502127788
             les_mean =     286.168355137977
             stat err =       0.000463714696
             autocorr =       1.270340960085
              std dev =       0.581842857100
             le_variance =       0.338541110358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587727838
                                         uncertainty =       0.004454714317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587727838
                                         uncertainty =       0.004454714317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411425030
  error estimate for blocks of size 2^( 2) =       0.000424425994
  error estimate for blocks of size 2^( 3) =       0.000438007731
  error estimate for blocks of size 2^( 4) =       0.000450024335
  error estimate for blocks of size 2^( 5) =       0.000460289196
  error estimate for blocks of size 2^( 6) =       0.000469739439
  error estimate for blocks of size 2^( 7) =       0.000474805814

      target function =                  N/A
              le_mean =     -16.906502127788
             les_mean =     286.168355137977
             stat err =       0.000463714696
             autocorr =       1.270340960085
              std dev =       0.581842857100
             le_variance =       0.338541110358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587727838
                                         uncertainty =       0.004454714317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587727838
                                         uncertainty =       0.004454714317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411425030
  error estimate for blocks of size 2^( 2) =       0.000424425994
  error estimate for blocks of size 2^( 3) =       0.000438007731
  error estimate for blocks of size 2^( 4) =       0.000450024335
  error estimate for blocks of size 2^( 5) =       0.000460289196
  error estimate for blocks of size 2^( 6) =       0.000469739439
  error estimate for blocks of size 2^( 7) =       0.000474805814

      target function =                  N/A
              le_mean =     -16.906502127788
             les_mean =     286.168355137977
             stat err =       0.000463714696
             autocorr =       1.270340960085
              std dev =       0.581842857100
             le_variance =       0.338541110358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587727838
                                         uncertainty =       0.004454714317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587727838
                                         uncertainty =       0.004454714317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411425030
  error estimate for blocks of size 2^( 2) =       0.000424425994
  error estimate for blocks of size 2^( 3) =       0.000438007731
  error estimate for blocks of size 2^( 4) =       0.000450024335
  error estimate for blocks of size 2^( 5) =       0.000460289196
  error estimate for blocks of size 2^( 6) =       0.000469739439
  error estimate for blocks of size 2^( 7) =       0.000474805814

      target function =                  N/A
              le_mean =     -16.906502127788
             les_mean =     286.168355137977
             stat err =       0.000463714696
             autocorr =       1.270340960085
              std dev =       0.581842857100
             le_variance =       0.338541110358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906502127788        initial  <--
     3.8147e+19     3.8147e+20             0.0000e+00       -16.906502127788
     1.5259e+20     1.5259e+21             0.0000e+00       -16.906502127788
     6.1035e+20     6.1035e+21             0.0000e+00       -16.906502127788

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7626
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5848e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8352
    reference variance = 0.422316
====================================================
  Execution time = 2.0420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3763e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337400320345
                                         uncertainty =       0.003880388873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337400320345
                                         uncertainty =       0.003880388873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410868168
  error estimate for blocks of size 2^( 2) =       0.000422900197
  error estimate for blocks of size 2^( 3) =       0.000436029502
  error estimate for blocks of size 2^( 4) =       0.000447888841
  error estimate for blocks of size 2^( 5) =       0.000458215883
  error estimate for blocks of size 2^( 6) =       0.000464007587
  error estimate for blocks of size 2^( 7) =       0.000468586611

      target function =                  N/A
              le_mean =     -16.905729490395
             les_mean =     286.141314736684
             stat err =       0.000459674730
             autocorr =       1.251688519383
              std dev =       0.581055335645
             le_variance =       0.337625303081


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572949040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905729490395       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905729490395       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905729490395       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905729490395       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905729490395       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905729490395       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5923e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9053
    reference variance = 0.617117
====================================================
  Execution time = 1.9949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2822e-01
  Total weights = 2.0000e+06
  Execution time = 1.9018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328255823246
                                         uncertainty =       0.002785112781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328255823246
                                         uncertainty =       0.002785112781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405107285
  error estimate for blocks of size 2^( 2) =       0.000418049618
  error estimate for blocks of size 2^( 3) =       0.000431112582
  error estimate for blocks of size 2^( 4) =       0.000442311502
  error estimate for blocks of size 2^( 5) =       0.000452455080
  error estimate for blocks of size 2^( 6) =       0.000460779960
  error estimate for blocks of size 2^( 7) =       0.000464582320

      target function =                  N/A
              le_mean =     -16.906475415807
             les_mean =     286.157134646176
             stat err =       0.000455032215
             autocorr =       1.261665371203
              std dev =       0.572908216918
             le_variance =       0.328223825012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328255823246
                                         uncertainty =       0.002785112781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328255823246
                                         uncertainty =       0.002785112781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405107285
  error estimate for blocks of size 2^( 2) =       0.000418049618
  error estimate for blocks of size 2^( 3) =       0.000431112582
  error estimate for blocks of size 2^( 4) =       0.000442311502
  error estimate for blocks of size 2^( 5) =       0.000452455080
  error estimate for blocks of size 2^( 6) =       0.000460779960
  error estimate for blocks of size 2^( 7) =       0.000464582320

      target function =                  N/A
              le_mean =     -16.906475415807
             les_mean =     286.157134646176
             stat err =       0.000455032215
             autocorr =       1.261665371203
              std dev =       0.572908216918
             le_variance =       0.328223825012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328255823246
                                         uncertainty =       0.002785112781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328255823246
                                         uncertainty =       0.002785112781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405107285
  error estimate for blocks of size 2^( 2) =       0.000418049618
  error estimate for blocks of size 2^( 3) =       0.000431112582
  error estimate for blocks of size 2^( 4) =       0.000442311502
  error estimate for blocks of size 2^( 5) =       0.000452455080
  error estimate for blocks of size 2^( 6) =       0.000460779960
  error estimate for blocks of size 2^( 7) =       0.000464582320

      target function =                  N/A
              le_mean =     -16.906475415807
             les_mean =     286.157134646176
             stat err =       0.000455032215
             autocorr =       1.261665371203
              std dev =       0.572908216918
             le_variance =       0.328223825012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328255823246
                                         uncertainty =       0.002785112781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328255823246
                                         uncertainty =       0.002785112781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405107285
  error estimate for blocks of size 2^( 2) =       0.000418049618
  error estimate for blocks of size 2^( 3) =       0.000431112582
  error estimate for blocks of size 2^( 4) =       0.000442311502
  error estimate for blocks of size 2^( 5) =       0.000452455080
  error estimate for blocks of size 2^( 6) =       0.000460779960
  error estimate for blocks of size 2^( 7) =       0.000464582320

      target function =                  N/A
              le_mean =     -16.906475415807
             les_mean =     286.157134646176
             stat err =       0.000455032215
             autocorr =       1.261665371203
              std dev =       0.572908216918
             le_variance =       0.328223825012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906475415807        initial  <--
     3.8147e+20     3.8147e+21             0.0000e+00       -16.906475415807
     1.5259e+21     1.5259e+22             0.0000e+00       -16.906475415807
     6.1035e+21     6.1035e+22             0.0000e+00       -16.906475415807

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5737
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5503e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8552
    reference variance = 0.167211
====================================================
  Execution time = 2.0289e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3957e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339624597499
                                         uncertainty =       0.005679255702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339624597499
                                         uncertainty =       0.005679255702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412051810
  error estimate for blocks of size 2^( 2) =       0.000424841417
  error estimate for blocks of size 2^( 3) =       0.000437699304
  error estimate for blocks of size 2^( 4) =       0.000450418091
  error estimate for blocks of size 2^( 5) =       0.000460811377
  error estimate for blocks of size 2^( 6) =       0.000469366755
  error estimate for blocks of size 2^( 7) =       0.000474487294

      target function =                  N/A
              le_mean =     -16.906567209059
             les_mean =     286.171588012701
             stat err =       0.000463770879
             autocorr =       1.266786125453
              std dev =       0.582729257953
             le_variance =       0.339573388074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690656720906e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906567209059       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906567209059       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906567209059       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906567209059       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+22 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906567209059       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906567209059       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+22 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5787e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9359
    reference variance = 0.193273
====================================================
  Execution time = 2.0188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.7911e-01
  Total weights = 2.0000e+06
  Execution time = 1.9076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379195826019
                                         uncertainty =       0.040177388250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379195826019
                                         uncertainty =       0.040177388250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435377062
  error estimate for blocks of size 2^( 2) =       0.000447233430
  error estimate for blocks of size 2^( 3) =       0.000459796912
  error estimate for blocks of size 2^( 4) =       0.000472263735
  error estimate for blocks of size 2^( 5) =       0.000484160967
  error estimate for blocks of size 2^( 6) =       0.000493009290
  error estimate for blocks of size 2^( 7) =       0.000498091140

      target function =                  N/A
              le_mean =     -16.905299107996
             les_mean =     286.168244112883
             stat err =       0.000486881283
             autocorr =       1.250590342545
              std dev =       0.615716145324
             le_variance =       0.379106371612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379195826019
                                         uncertainty =       0.040177388250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379195826019
                                         uncertainty =       0.040177388250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435377062
  error estimate for blocks of size 2^( 2) =       0.000447233430
  error estimate for blocks of size 2^( 3) =       0.000459796912
  error estimate for blocks of size 2^( 4) =       0.000472263735
  error estimate for blocks of size 2^( 5) =       0.000484160967
  error estimate for blocks of size 2^( 6) =       0.000493009290
  error estimate for blocks of size 2^( 7) =       0.000498091140

      target function =                  N/A
              le_mean =     -16.905299107996
             les_mean =     286.168244112883
             stat err =       0.000486881283
             autocorr =       1.250590342545
              std dev =       0.615716145324
             le_variance =       0.379106371612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379195826019
                                         uncertainty =       0.040177388250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379195826019
                                         uncertainty =       0.040177388250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435377062
  error estimate for blocks of size 2^( 2) =       0.000447233430
  error estimate for blocks of size 2^( 3) =       0.000459796912
  error estimate for blocks of size 2^( 4) =       0.000472263735
  error estimate for blocks of size 2^( 5) =       0.000484160967
  error estimate for blocks of size 2^( 6) =       0.000493009290
  error estimate for blocks of size 2^( 7) =       0.000498091140

      target function =                  N/A
              le_mean =     -16.905299107996
             les_mean =     286.168244112883
             stat err =       0.000486881283
             autocorr =       1.250590342545
              std dev =       0.615716145324
             le_variance =       0.379106371612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379195826019
                                         uncertainty =       0.040177388250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379195826019
                                         uncertainty =       0.040177388250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435377062
  error estimate for blocks of size 2^( 2) =       0.000447233430
  error estimate for blocks of size 2^( 3) =       0.000459796912
  error estimate for blocks of size 2^( 4) =       0.000472263735
  error estimate for blocks of size 2^( 5) =       0.000484160967
  error estimate for blocks of size 2^( 6) =       0.000493009290
  error estimate for blocks of size 2^( 7) =       0.000498091140

      target function =                  N/A
              le_mean =     -16.905299107996
             les_mean =     286.168244112883
             stat err =       0.000486881283
             autocorr =       1.250590342545
              std dev =       0.615716145324
             le_variance =       0.379106371612


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905299107996        initial  <--
     3.8147e+21     3.8147e+22             0.0000e+00       -16.905299107996
     1.5259e+22     1.5259e+23             0.0000e+00       -16.905299107996
     6.1035e+22     6.1035e+23             0.0000e+00       -16.905299107996

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8091
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.067805e-01 1 1  ON 0
 uu_1                 1.406915e-01 1 1  ON 1
 uu_2                 4.009771e-02 1 1  ON 2
 uu_3                -2.105015e-02 1 1  ON 3
 uu_4                -6.451373e-02 1 1  ON 4
 uu_5                -9.716614e-02 1 1  ON 5
 uu_6                -1.228909e-01 1 1  ON 6
 uu_7                -1.345299e-01 1 1  ON 7
 uu_8                -1.259801e-01 1 1  ON 8
 uu_9                -9.461304e-02 1 1  ON 9
 ud_0                 4.420304e-01 1 1  ON 10
 ud_1                 1.770673e-01 1 1  ON 11
 ud_2                 5.810533e-02 1 1  ON 12
 ud_3                -1.153563e-02 1 1  ON 13
 ud_4                -6.719212e-02 1 1  ON 14
 ud_5                -1.070291e-01 1 1  ON 15
 ud_6                -1.331108e-01 1 1  ON 16
 ud_7                -1.481128e-01 1 1  ON 17
 ud_8                -1.494834e-01 1 1  ON 18
 ud_9                -1.364664e-01 1 1  ON 19
 eO_0                -7.499291e-01 1 1  ON 20
 eO_1                -4.314314e-01 1 1  ON 21
 eO_2                -1.659442e-02 1 1  ON 22
 eO_3                 2.965679e-01 1 1  ON 23
 eO_4                 5.126149e-01 1 1  ON 24
 eO_5                 4.680976e-01 1 1  ON 25
 eO_6                 2.398140e-01 1 1  ON 26
 eO_7                -5.339122e-02 1 1  ON 27
 eO_8                -2.038095e-01 1 1  ON 28
 eO_9                -6.408722e-02 1 1  ON 29
eH1_0                -2.333359e-01 1 1  ON 30
eH1_1                -1.345231e-01 1 1  ON 31
eH1_2                -8.872797e-02 1 1  ON 32
eH1_3                -3.584472e-02 1 1  ON 33
eH1_4                 1.146494e-02 1 1  ON 34
eH1_5                 4.510729e-02 1 1  ON 35
eH1_6                 9.872711e-02 1 1  ON 36
eH1_7                 1.439967e-01 1 1  ON 37
eH1_8                 1.556260e-01 1 1  ON 38
eH1_9                 4.154689e-02 1 1  ON 39
eH2_0                -2.312502e-01 1 1  ON 40
eH2_1                -1.327408e-01 1 1  ON 41
eH2_2                -8.695784e-02 1 1  ON 42
eH2_3                -3.391448e-02 1 1  ON 43
eH2_4                 1.399508e-02 1 1  ON 44
eH2_5                 4.807721e-02 1 1  ON 45
eH2_6                 1.021202e-01 1 1  ON 46
eH2_7                 1.498958e-01 1 1  ON 47
eH2_8                 1.632884e-01 1 1  ON 48
eH2_9                 2.501344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5601e+01 secs
  Total Execution time = 2.2584e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
