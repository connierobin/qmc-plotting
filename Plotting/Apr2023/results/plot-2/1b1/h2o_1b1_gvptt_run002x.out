Rank =    0  Free Memory = 83693 MB
Rank =    1  Free Memory = 83693 MB
Rank =    2  Free Memory = 83693 MB
Rank =    3  Free Memory = 83693 MB
Rank =    4  Free Memory = 83692 MB
Rank =    5  Free Memory = 83692 MB
Rank =    6  Free Memory = 83691 MB
Rank =    7  Free Memory = 83691 MB
Rank =    8  Free Memory = 83691 MB
Rank =    9  Free Memory = 83691 MB
Rank =   10  Free Memory = 83691 MB
Rank =   11  Free Memory = 83691 MB
Rank =   12  Free Memory = 83691 MB
Rank =   13  Free Memory = 83691 MB
Rank =   14  Free Memory = 83690 MB
Rank =   15  Free Memory = 83677 MB
Rank =   16  Free Memory = 83676 MB
Rank =   17  Free Memory = 83676 MB
Rank =   18  Free Memory = 83676 MB
Rank =   19  Free Memory = 83676 MB
Rank =   20  Free Memory = 83676 MB
Rank =   21  Free Memory = 83676 MB
Rank =   22  Free Memory = 83676 MB
Rank =   23  Free Memory = 83676 MB
Rank =   24  Free Memory = 83676 MB
Rank =   25  Free Memory = 83676 MB
Rank =   26  Free Memory = 83676 MB
Rank =   27  Free Memory = 83676 MB
Rank =   28  Free Memory = 83676 MB
Rank =   29  Free Memory = 83676 MB
Rank =   30  Free Memory = 83676 MB
Rank =   31  Free Memory = 83676 MB
Rank =   32  Free Memory = 64319 MB
Rank =   33  Free Memory = 64319 MB
Rank =   34  Free Memory = 64319 MB
Rank =   35  Free Memory = 64319 MB
Rank =   36  Free Memory = 64319 MB
Rank =   37  Free Memory = 64319 MB
Rank =   38  Free Memory = 64319 MB
Rank =   39  Free Memory = 64319 MB
Rank =   40  Free Memory = 64319 MB
Rank =   41  Free Memory = 64319 MB
Rank =   42  Free Memory = 64319 MB
Rank =   43  Free Memory = 64319 MB
Rank =   44  Free Memory = 64319 MB
Rank =   45  Free Memory = 64319 MB
Rank =   46  Free Memory = 64319 MB
Rank =   47  Free Memory = 64319 MB
Rank =   48  Free Memory = 64319 MB
Rank =   49  Free Memory = 64319 MB
Rank =   50  Free Memory = 64319 MB
Rank =   51  Free Memory = 64319 MB
Rank =   52  Free Memory = 64319 MB
Rank =   53  Free Memory = 64319 MB
Rank =   54  Free Memory = 64319 MB
Rank =   55  Free Memory = 64319 MB
Rank =   56  Free Memory = 64319 MB
Rank =   57  Free Memory = 64319 MB
Rank =   58  Free Memory = 64319 MB
Rank =   59  Free Memory = 64319 MB
Rank =   60  Free Memory = 64319 MB
Rank =   61  Free Memory = 64319 MB
Rank =   62  Free Memory = 64319 MB
Rank =   63  Free Memory = 64319 MB
Rank =   64  Free Memory = 64319 MB
Rank =   65  Free Memory = 64319 MB
Rank =   66  Free Memory = 64319 MB
Rank =   67  Free Memory = 64319 MB
Rank =   68  Free Memory = 64319 MB
Rank =   69  Free Memory = 64319 MB
Rank =   70  Free Memory = 64319 MB
Rank =   71  Free Memory = 64319 MB
Rank =   72  Free Memory = 76654 MB
Rank =   73  Free Memory = 76654 MB
Rank =   74  Free Memory = 76654 MB
Rank =   75  Free Memory = 76654 MB
Rank =   76  Free Memory = 76654 MB
Rank =   77  Free Memory = 76654 MB
Rank =   78  Free Memory = 76654 MB
Rank =   79  Free Memory = 76654 MB
Rank =   80  Free Memory = 76654 MB
Rank =   81  Free Memory = 76654 MB
Rank =   82  Free Memory = 76654 MB
Rank =   83  Free Memory = 76654 MB
Rank =   84  Free Memory = 76654 MB
Rank =   85  Free Memory = 76654 MB
Rank =   86  Free Memory = 76654 MB
Rank =   87  Free Memory = 76654 MB
Rank =   88  Free Memory = 76654 MB
Rank =   89  Free Memory = 76654 MB
Rank =   90  Free Memory = 76654 MB
Rank =   91  Free Memory = 76654 MB
Rank =   92  Free Memory = 76654 MB
Rank =   93  Free Memory = 76654 MB
Rank =   94  Free Memory = 76654 MB
Rank =   95  Free Memory = 76654 MB
Rank =   96  Free Memory = 76654 MB
Rank =   97  Free Memory = 76654 MB
Rank =   98  Free Memory = 76654 MB
Rank =   99  Free Memory = 76654 MB
Rank =  100  Free Memory = 76654 MB
Rank =  101  Free Memory = 76654 MB
Rank =  102  Free Memory = 76654 MB
Rank =  103  Free Memory = 76654 MB
Rank =  104  Free Memory = 76654 MB
Rank =  105  Free Memory = 76654 MB
Rank =  106  Free Memory = 76654 MB
Rank =  107  Free Memory = 76654 MB
Rank =  108  Free Memory = 76654 MB
Rank =  109  Free Memory = 76654 MB
Rank =  110  Free Memory = 76654 MB
Rank =  111  Free Memory = 76654 MB
  Input file(s): opt_h2o_1b1_gvptt_run002x.xml 
Rank =  112  Free Memory = 70342 MB
Rank =  113  Free Memory = 70342 MB
Rank =  114  Free Memory = 70342 MB
Rank =  115  Free Memory = 70342 MB
Rank =  116  Free Memory = 70342 MB
Rank =  117  Free Memory = 70342 MB
Rank =  118  Free Memory = 70342 MB
Rank =  119  Free Memory = 70342 MB
Rank =  120  Free Memory = 70342 MB
Rank =  121  Free Memory = 70342 MB
Rank =  122  Free Memory = 70342 MB
Rank =  127  Free Memory = 70342 MB
Rank =  123  Free Memory = 70342 MB
Rank =  124  Free Memory = 70342 MB
Rank =  125  Free Memory = 70342 MB
Rank =  126  Free Memory = 70342 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002x.xml

  Project = H2O
  date    = 2023-04-25 19:06:15 PDT
  host    = n0110.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 791

  Range of prime numbers to use as seeds over processors and threads = 6079-7211


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.093234e-01    1         1  ON     0
     uu_1                 1.424393e-01    1         1  ON     1
     uu_2                 4.035239e-02    1         1  ON     2
     uu_3                -2.262760e-02    1         1  ON     3
     uu_4                -6.861458e-02    1         1  ON     4
     uu_5                -1.038993e-01    1         1  ON     5
     uu_6                -1.320312e-01    1         1  ON     6
     uu_7                -1.463950e-01    1         1  ON     7
     uu_8                -1.390393e-01    1         1  ON     8
     uu_9                -1.110353e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.545291e-01    1         1  ON     0
     ud_1                 1.880352e-01    1         1  ON     1
     ud_2                 6.677867e-02    1         1  ON     2
     ud_3                -5.307788e-03    1         1  ON     3
     ud_4                -6.304060e-02    1         1  ON     4
     ud_5                -1.052234e-01    1         1  ON     5
     ud_6                -1.337748e-01    1         1  ON     6
     ud_7                -1.514805e-01    1         1  ON     7
     ud_8                -1.527640e-01    1         1  ON     8
     ud_9                -1.453072e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.629990e-01    1         1  ON     0
     eO_1                -4.398936e-01    1         1  ON     1
     eO_2                -1.719188e-02    1         1  ON     2
     eO_3                 3.067130e-01    1         1  ON     3
     eO_4                 5.357810e-01    1         1  ON     4
     eO_5                 4.998056e-01    1         1  ON     5
     eO_6                 2.706130e-01    1         1  ON     6
     eO_7                -3.695337e-02    1         1  ON     7
     eO_8                -2.404229e-01    1         1  ON     8
     eO_9                -1.100430e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.568796e-01    1         1  ON     0
     eH1_1                -1.552948e-01    1         1  ON     1
     eH1_2                -1.078395e-01    1         1  ON     2
     eH1_3                -5.285368e-02    1         1  ON     3
     eH1_4                -3.900338e-03    1         1  ON     4
     eH1_5                 3.156554e-02    1         1  ON     5
     eH1_6                 9.284655e-02    1         1  ON     6
     eH1_7                 1.557771e-01    1         1  ON     7
     eH1_8                 1.962656e-01    1         1  ON     8
     eH1_9                 9.881973e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.541980e-01    1         1  ON     0
     eH2_1                -1.521785e-01    1         1  ON     1
     eH2_2                -1.048816e-01    1         1  ON     2
     eH2_3                -5.021411e-02    1         1  ON     3
     eH2_4                -1.231206e-03    1         1  ON     4
     eH2_5                 3.330003e-02    1         1  ON     5
     eH2_6                 9.473265e-02    1         1  ON     6
     eH2_7                 1.558654e-01    1         1  ON     7
     eH2_8                 1.990265e-01    1         1  ON     8
     eH2_9                 9.252337e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.447413e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.7911e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9401
    reference variance = 0.935371
====================================================
  Execution time = 2.4020e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336839932450
                                         uncertainty =       0.003393907502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336839932450
                                         uncertainty =       0.003393907502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410380870
  error estimate for blocks of size 2^( 2) =       0.000422733299
  error estimate for blocks of size 2^( 3) =       0.000435754599
  error estimate for blocks of size 2^( 4) =       0.000447335250
  error estimate for blocks of size 2^( 5) =       0.000458022271
  error estimate for blocks of size 2^( 6) =       0.000463148295
  error estimate for blocks of size 2^( 7) =       0.000466942925

      target function =                  N/A
              le_mean =     -16.906607136539
             les_mean =     286.170189618387
             stat err =       0.000458862185
             autocorr =       1.250231167925
              std dev =       0.580366192619
             le_variance =       0.336824917535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690660713654e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906607136539       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906609264889       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906609446975       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906609461675       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906611765533       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906612141527       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906611278380       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906611736256       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906611664871       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906611575649       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.496652e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906607136539       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906607846341       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906607880856       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906607904021       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906608597970       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906608852783       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906608553071       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906608625319       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.592624e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906607136539       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906607330156       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906607338006       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906607347589       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906607518563       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906607603295       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906607528546       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906607545613       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 4.093051e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9674e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.093619e-01                 1 1 ON  0
uu_1  1.423917e-01                 1 1 ON  1
uu_2  4.034648e-02                 1 1 ON  2
uu_3  -2.258408e-02                1 1 ON  3
uu_4  -6.860828e-02                1 1 ON  4
uu_5  -1.039162e-01                1 1 ON  5
uu_6  -1.321396e-01                1 1 ON  6
uu_7  -1.464889e-01                1 1 ON  7
uu_8  -1.390419e-01                1 1 ON  8
uu_9  -1.109960e-01                1 1 ON  9
ud_0  4.544809e-01                 1 1 ON  10
ud_1  1.880635e-01                 1 1 ON  11
ud_2  6.686716e-02                 1 1 ON  12
ud_3  -5.262388e-03                1 1 ON  13
ud_4  -6.304344e-02                1 1 ON  14
ud_5  -1.052647e-01                1 1 ON  15
ud_6  -1.337453e-01                1 1 ON  16
ud_7  -1.514952e-01                1 1 ON  17
ud_8  -1.528279e-01                1 1 ON  18
ud_9  -1.452821e-01                1 1 ON  19
eO_0  -7.628847e-01                1 1 ON  20
eO_1  -4.397624e-01                1 1 ON  21
eO_2  -1.726614e-02                1 1 ON  22
eO_3  3.066559e-01                 1 1 ON  23
eO_4  5.358451e-01                 1 1 ON  24
eO_5  4.998429e-01                 1 1 ON  25
eO_6  2.706356e-01                 1 1 ON  26
eO_7  -3.695724e-02                1 1 ON  27
eO_8  -2.405335e-01                1 1 ON  28
eO_9  -1.101546e-01                1 1 ON  29
eH1_0 -2.569622e-01                1 1 ON  30
eH1_1 -1.553437e-01                1 1 ON  31
eH1_2 -1.078234e-01                1 1 ON  32
eH1_3 -5.285069e-02                1 1 ON  33
eH1_4 -3.897864e-03                1 1 ON  34
eH1_5 3.149351e-02                 1 1 ON  35
eH1_6 9.273757e-02                 1 1 ON  36
eH1_7 1.557937e-01                 1 1 ON  37
eH1_8 1.963562e-01                 1 1 ON  38
eH1_9 9.897900e-02                 1 1 ON  39
eH2_0 -2.543535e-01                1 1 ON  40
eH2_1 -1.522184e-01                1 1 ON  41
eH2_2 -1.049527e-01                1 1 ON  42
eH2_3 -5.030742e-02                1 1 ON  43
eH2_4 -1.271594e-03                1 1 ON  44
eH2_5 3.339774e-02                 1 1 ON  45
eH2_6 9.470713e-02                 1 1 ON  46
eH2_7 1.559685e-01                 1 1 ON  47
eH2_8 1.990920e-01                 1 1 ON  48
eH2_9 9.266087e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9025
    reference variance = 0.18276
====================================================
  Execution time = 2.0458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3863e-01
  Total weights = 2.0000e+06
  Execution time = 1.9024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338801612735
                                         uncertainty =       0.003877319593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338801612735
                                         uncertainty =       0.003877319593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411542847
  error estimate for blocks of size 2^( 2) =       0.000424122051
  error estimate for blocks of size 2^( 3) =       0.000436726758
  error estimate for blocks of size 2^( 4) =       0.000449079052
  error estimate for blocks of size 2^( 5) =       0.000458507168
  error estimate for blocks of size 2^( 6) =       0.000465691817
  error estimate for blocks of size 2^( 7) =       0.000470543516

      target function =                  N/A
              le_mean =     -16.906198643258
             les_mean =     286.158287425314
             stat err =       0.000460955388
             autocorr =       1.254549139510
              std dev =       0.582009475328
             le_variance =       0.338735029372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338558415271
                                         uncertainty =       0.003874210565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338558415271
                                         uncertainty =       0.003874210565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411395050
  error estimate for blocks of size 2^( 2) =       0.000423983912
  error estimate for blocks of size 2^( 3) =       0.000436595420
  error estimate for blocks of size 2^( 4) =       0.000448951186
  error estimate for blocks of size 2^( 5) =       0.000458380681
  error estimate for blocks of size 2^( 6) =       0.000465566526
  error estimate for blocks of size 2^( 7) =       0.000470428305

      target function =                  N/A
              le_mean =     -16.906200865789
             les_mean =     286.158119319326
             stat err =       0.000460831675
             autocorr =       1.254776917263
              std dev =       0.581800459070
             le_variance =       0.338491774174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338583211284
                                         uncertainty =       0.003874431529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338583211284
                                         uncertainty =       0.003874431529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411410131
  error estimate for blocks of size 2^( 2) =       0.000423998380
  error estimate for blocks of size 2^( 3) =       0.000436609749
  error estimate for blocks of size 2^( 4) =       0.000448965794
  error estimate for blocks of size 2^( 5) =       0.000458395747
  error estimate for blocks of size 2^( 6) =       0.000465581490
  error estimate for blocks of size 2^( 7) =       0.000470439960

      target function =                  N/A
              le_mean =     -16.906200089264
             les_mean =     286.158117880502
             stat err =       0.000460845748
             autocorr =       1.254761560815
              std dev =       0.581821786737
             le_variance =       0.338516591522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338767169756
                                         uncertainty =       0.003876868177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338767169756
                                         uncertainty =       0.003876868177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411521920
  error estimate for blocks of size 2^( 2) =       0.000424102557
  error estimate for blocks of size 2^( 3) =       0.000436708329
  error estimate for blocks of size 2^( 4) =       0.000449061256
  error estimate for blocks of size 2^( 5) =       0.000458489684
  error estimate for blocks of size 2^( 6) =       0.000465674526
  error estimate for blocks of size 2^( 7) =       0.000470527181

      target function =                  N/A
              le_mean =     -16.906198818190
             les_mean =     286.158258892220
             stat err =       0.000460938162
             autocorr =       1.254582960879
              std dev =       0.581979880587
             le_variance =       0.338700581408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906198643258        initial
     2.5000e-01     2.5000e+00             6.4967e-04       -16.906200865789  <--
     1.0000e+00     1.0000e+01             1.5926e-04       -16.906200089264
     4.0000e+00     4.0000e+01             4.0931e-05       -16.906198818190

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0078e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.093837e-01 1 1  ON 0
 uu_1                 1.423215e-01 1 1  ON 1
 uu_2                 4.034587e-02 1 1  ON 2
 uu_3                -2.251777e-02 1 1  ON 3
 uu_4                -6.857589e-02 1 1  ON 4
 uu_5                -1.039936e-01 1 1  ON 5
 uu_6                -1.323626e-01 1 1  ON 6
 uu_7                -1.467503e-01 1 1  ON 7
 uu_8                -1.390869e-01 1 1  ON 8
 uu_9                -1.108915e-01 1 1  ON 9
 ud_0                 4.544798e-01 1 1  ON 10
 ud_1                 1.881459e-01 1 1  ON 11
 ud_2                 6.700453e-02 1 1  ON 12
 ud_3                -5.147335e-03 1 1  ON 13
 ud_4                -6.304916e-02 1 1  ON 14
 ud_5                -1.053135e-01 1 1  ON 15
 ud_6                -1.337373e-01 1 1  ON 16
 ud_7                -1.515306e-01 1 1  ON 17
 ud_8                -1.530009e-01 1 1  ON 18
 ud_9                -1.452152e-01 1 1  ON 19
 eO_0                -7.625829e-01 1 1  ON 20
 eO_1                -4.395183e-01 1 1  ON 21
 eO_2                -1.727655e-02 1 1  ON 22
 eO_3                 3.065534e-01 1 1  ON 23
 eO_4                 5.359798e-01 1 1  ON 24
 eO_5                 4.999444e-01 1 1  ON 25
 eO_6                 2.707046e-01 1 1  ON 26
 eO_7                -3.696781e-02 1 1  ON 27
 eO_8                -2.408770e-01 1 1  ON 28
 eO_9                -1.105013e-01 1 1  ON 29
eH1_0                -2.571792e-01 1 1  ON 30
eH1_1                -1.554510e-01 1 1  ON 31
eH1_2                -1.078226e-01 1 1  ON 32
eH1_3                -5.287088e-02 1 1  ON 33
eH1_4                -3.931776e-03 1 1  ON 34
eH1_5                 3.130797e-02 1 1  ON 35
eH1_6                 9.242771e-02 1 1  ON 36
eH1_7                 1.558306e-01 1 1  ON 37
eH1_8                 1.966259e-01 1 1  ON 38
eH1_9                 9.946940e-02 1 1  ON 39
eH2_0                -2.547759e-01 1 1  ON 40
eH2_1                -1.523944e-01 1 1  ON 41
eH2_2                -1.051730e-01 1 1  ON 42
eH2_3                -5.051669e-02 1 1  ON 43
eH2_4                -1.399734e-03 1 1  ON 44
eH2_5                 3.360732e-02 1 1  ON 45
eH2_6                 9.464060e-02 1 1  ON 46
eH2_7                 1.562854e-01 1 1  ON 47
eH2_8                 1.992962e-01 1 1  ON 48
eH2_9                 9.308552e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9766e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9554
    reference variance = 0.712848
====================================================
  Execution time = 2.1087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3772e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337550268028
                                         uncertainty =       0.004650491209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337550268028
                                         uncertainty =       0.004650491209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410923121
  error estimate for blocks of size 2^( 2) =       0.000423774864
  error estimate for blocks of size 2^( 3) =       0.000436411546
  error estimate for blocks of size 2^( 4) =       0.000447539771
  error estimate for blocks of size 2^( 5) =       0.000457713563
  error estimate for blocks of size 2^( 6) =       0.000465117539
  error estimate for blocks of size 2^( 7) =       0.000467810437

      target function =                  N/A
              le_mean =     -16.906184097358
             les_mean =     286.156776188393
             stat err =       0.000459545327
             autocorr =       1.250649321686
              std dev =       0.581133051445
             le_variance =       0.337715623482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618409736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184097358       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906183775908       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906185679478       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906185312244       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186271313       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906188198862       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906188068080       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906187611235       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906189138357       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906189508275       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906189438615       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906188680197       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906189021512       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.115904e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184097358       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906183913717       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906184665695       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906184002084       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906184567102       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906185081555       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906184983671       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906185106058       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906185204518       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906185181163       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.705479e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184097358       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906184029715       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906184227948       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906183948464       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906184096803       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906184047163       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906184199874       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906184247008       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.872077e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015269 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6865e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.093862e-01 1 1  ON 0
 uu_1                 1.422635e-01 1 1  ON 1
 uu_2                 4.034219e-02 1 1  ON 2
 uu_3                -2.260303e-02 1 1  ON 3
 uu_4                -6.855318e-02 1 1  ON 4
 uu_5                -1.038696e-01 1 1  ON 5
 uu_6                -1.322420e-01 1 1  ON 6
 uu_7                -1.466865e-01 1 1  ON 7
 uu_8                -1.392795e-01 1 1  ON 8
 uu_9                -1.113720e-01 1 1  ON 9
 ud_0                 4.546943e-01 1 1  ON 10
 ud_1                 1.883150e-01 1 1  ON 11
 ud_2                 6.710839e-02 1 1  ON 12
 ud_3                -5.013495e-03 1 1  ON 13
 ud_4                -6.279994e-02 1 1  ON 14
 ud_5                -1.052567e-01 1 1  ON 15
 ud_6                -1.338356e-01 1 1  ON 16
 ud_7                -1.517910e-01 1 1  ON 17
 ud_8                -1.531817e-01 1 1  ON 18
 ud_9                -1.452471e-01 1 1  ON 19
 eO_0                -7.621990e-01 1 1  ON 20
 eO_1                -4.392008e-01 1 1  ON 21
 eO_2                -1.707176e-02 1 1  ON 22
 eO_3                 3.066154e-01 1 1  ON 23
 eO_4                 5.358483e-01 1 1  ON 24
 eO_5                 5.000756e-01 1 1  ON 25
 eO_6                 2.709213e-01 1 1  ON 26
 eO_7                -3.706951e-02 1 1  ON 27
 eO_8                -2.412658e-01 1 1  ON 28
 eO_9                -1.110455e-01 1 1  ON 29
eH1_0                -2.574268e-01 1 1  ON 30
eH1_1                -1.556798e-01 1 1  ON 31
eH1_2                -1.080131e-01 1 1  ON 32
eH1_3                -5.300770e-02 1 1  ON 33
eH1_4                -4.026784e-03 1 1  ON 34
eH1_5                 3.129283e-02 1 1  ON 35
eH1_6                 9.215081e-02 1 1  ON 36
eH1_7                 1.559640e-01 1 1  ON 37
eH1_8                 1.969489e-01 1 1  ON 38
eH1_9                 1.002399e-01 1 1  ON 39
eH2_0                -2.546099e-01 1 1  ON 40
eH2_1                -1.527913e-01 1 1  ON 41
eH2_2                -1.053040e-01 1 1  ON 42
eH2_3                -5.041999e-02 1 1  ON 43
eH2_4                -1.458867e-03 1 1  ON 44
eH2_5                 3.351737e-02 1 1  ON 45
eH2_6                 9.423919e-02 1 1  ON 46
eH2_7                 1.560303e-01 1 1  ON 47
eH2_8                 1.994441e-01 1 1  ON 48
eH2_9                 9.384667e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8678
    reference variance = 0.247017
====================================================
  Execution time = 2.0469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.0960e-01
  Total weights = 2.0000e+06
  Execution time = 1.8963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409747732571
                                         uncertainty =       0.072163643667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409747732571
                                         uncertainty =       0.072163643667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000452497029
  error estimate for blocks of size 2^( 2) =       0.000464233566
  error estimate for blocks of size 2^( 3) =       0.000476644431
  error estimate for blocks of size 2^( 4) =       0.000488449037
  error estimate for blocks of size 2^( 5) =       0.000499048533
  error estimate for blocks of size 2^( 6) =       0.000506395293
  error estimate for blocks of size 2^( 7) =       0.000512336440

      target function =                  N/A
              le_mean =     -16.905621877750
             les_mean =     286.209557990442
             stat err =       0.000501557326
             autocorr =       1.228597687104
              std dev =       0.639927434733
             le_variance =       0.409507121723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409816291775
                                         uncertainty =       0.072191909444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409816291775
                                         uncertainty =       0.072191909444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000452534831
  error estimate for blocks of size 2^( 2) =       0.000464262164
  error estimate for blocks of size 2^( 3) =       0.000476666021
  error estimate for blocks of size 2^( 4) =       0.000488472523
  error estimate for blocks of size 2^( 5) =       0.000499068799
  error estimate for blocks of size 2^( 6) =       0.000506425055
  error estimate for blocks of size 2^( 7) =       0.000512380575

      target function =                  N/A
              le_mean =     -16.905622828297
             les_mean =     286.209658555017
             stat err =       0.000501586738
             autocorr =       1.228536505162
              std dev =       0.639980895932
             le_variance =       0.409575547158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409937904512
                                         uncertainty =       0.072218848843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409937904512
                                         uncertainty =       0.072218848843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000452601960
  error estimate for blocks of size 2^( 2) =       0.000464327430
  error estimate for blocks of size 2^( 3) =       0.000476729845
  error estimate for blocks of size 2^( 4) =       0.000488536097
  error estimate for blocks of size 2^( 5) =       0.000499129148
  error estimate for blocks of size 2^( 6) =       0.000506484935
  error estimate for blocks of size 2^( 7) =       0.000512440777

      target function =                  N/A
              le_mean =     -16.905622241838
             les_mean =     286.209760248073
             stat err =       0.000501647739
             autocorr =       1.228470854661
              std dev =       0.640075830820
             le_variance =       0.409697069200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409794465970
                                         uncertainty =       0.072177183656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409794465970
                                         uncertainty =       0.072177183656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000452522820
  error estimate for blocks of size 2^( 2) =       0.000464257142
  error estimate for blocks of size 2^( 3) =       0.000476666221
  error estimate for blocks of size 2^( 4) =       0.000488470992
  error estimate for blocks of size 2^( 5) =       0.000499069294
  error estimate for blocks of size 2^( 6) =       0.000506417764
  error estimate for blocks of size 2^( 7) =       0.000512361364

      target function =                  N/A
              le_mean =     -16.905621696229
             les_mean =     286.209598535891
             stat err =       0.000501579854
             autocorr =       1.228568000560
              std dev =       0.639963908878
             le_variance =       0.409553804667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905621877750        initial
     6.2500e-02     6.2500e-01             3.1159e-03       -16.905622828297  <--
     2.5000e-01     2.5000e+00             7.7055e-04       -16.905622241838
     1.0000e+00     1.0000e+01             1.8721e-04       -16.905621696229

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.0047e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.093023e-01 1 1  ON 0
 uu_1                 1.421811e-01 1 1  ON 1
 uu_2                 4.030507e-02 1 1  ON 2
 uu_3                -2.261366e-02 1 1  ON 3
 uu_4                -6.849812e-02 1 1  ON 4
 uu_5                -1.037269e-01 1 1  ON 5
 uu_6                -1.321306e-01 1 1  ON 6
 uu_7                -1.466982e-01 1 1  ON 7
 uu_8                -1.395485e-01 1 1  ON 8
 uu_9                -1.126279e-01 1 1  ON 9
 ud_0                 4.550168e-01 1 1  ON 10
 ud_1                 1.886057e-01 1 1  ON 11
 ud_2                 6.740060e-02 1 1  ON 12
 ud_3                -4.711472e-03 1 1  ON 13
 ud_4                -6.242670e-02 1 1  ON 14
 ud_5                -1.050654e-01 1 1  ON 15
 ud_6                -1.338074e-01 1 1  ON 16
 ud_7                -1.520604e-01 1 1  ON 17
 ud_8                -1.535006e-01 1 1  ON 18
 ud_9                -1.453570e-01 1 1  ON 19
 eO_0                -7.612606e-01 1 1  ON 20
 eO_1                -4.384409e-01 1 1  ON 21
 eO_2                -1.651950e-02 1 1  ON 22
 eO_3                 3.069405e-01 1 1  ON 23
 eO_4                 5.359076e-01 1 1  ON 24
 eO_5                 5.004421e-01 1 1  ON 25
 eO_6                 2.713970e-01 1 1  ON 26
 eO_7                -3.731611e-02 1 1  ON 27
 eO_8                -2.423914e-01 1 1  ON 28
 eO_9                -1.126932e-01 1 1  ON 29
eH1_0                -2.580685e-01 1 1  ON 30
eH1_1                -1.562537e-01 1 1  ON 31
eH1_2                -1.085869e-01 1 1  ON 32
eH1_3                -5.350004e-02 1 1  ON 33
eH1_4                -4.447294e-03 1 1  ON 34
eH1_5                 3.106159e-02 1 1  ON 35
eH1_6                 9.154777e-02 1 1  ON 36
eH1_7                 1.562962e-01 1 1  ON 37
eH1_8                 1.979123e-01 1 1  ON 38
eH1_9                 1.025853e-01 1 1  ON 39
eH2_0                -2.547580e-01 1 1  ON 40
eH2_1                -1.532344e-01 1 1  ON 41
eH2_2                -1.056251e-01 1 1  ON 42
eH2_3                -5.055270e-02 1 1  ON 43
eH2_4                -1.642173e-03 1 1  ON 44
eH2_5                 3.320115e-02 1 1  ON 45
eH2_6                 9.333895e-02 1 1  ON 46
eH2_7                 1.552893e-01 1 1  ON 47
eH2_8                 1.998469e-01 1 1  ON 48
eH2_9                 9.613724e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.7931
    reference variance = 0.261818
====================================================
  Execution time = 2.1058e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5649e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356545697642
                                         uncertainty =       0.013866487957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356545697642
                                         uncertainty =       0.013866487957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422193605
  error estimate for blocks of size 2^( 2) =       0.000434571297
  error estimate for blocks of size 2^( 3) =       0.000446854827
  error estimate for blocks of size 2^( 4) =       0.000458152930
  error estimate for blocks of size 2^( 5) =       0.000468728803
  error estimate for blocks of size 2^( 6) =       0.000477023446
  error estimate for blocks of size 2^( 7) =       0.000481374128

      target function =                  N/A
              le_mean =     -16.906031984720
             les_mean =     286.170412170800
             stat err =       0.000471319827
             autocorr =       1.246258451390
              std dev =       0.597071922537
             le_variance =       0.356494880682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603198472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906031984720       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033347816       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033521823       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906035049707       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906031197671       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906032173070       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906034759037       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906036745647       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906034091246       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906035673208       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906037151723       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906041424156       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906039753572       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906041169593       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906041990174       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906043217302       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906043234242       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906042960575       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906042164108       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.190374e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906031984720       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032975822       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033514873       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906034615464       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906032291064       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906032179900       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033768235       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906033824118       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906033713036       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906034120630       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906033740445       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906034836279       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906034722952       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.943674e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906031984720       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032458565       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033236488       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033301229       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906032542832       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906032460089       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906032421678       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906032651493       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906032780760       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906032834643       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.285247e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6841e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.093964e-01 1 1  ON 0
 uu_1                 1.421610e-01 1 1  ON 1
 uu_2                 4.032520e-02 1 1  ON 2
 uu_3                -2.261239e-02 1 1  ON 3
 uu_4                -6.860857e-02 1 1  ON 4
 uu_5                -1.044226e-01 1 1  ON 5
 uu_6                -1.323884e-01 1 1  ON 6
 uu_7                -1.473012e-01 1 1  ON 7
 uu_8                -1.410858e-01 1 1  ON 8
 uu_9                -1.127256e-01 1 1  ON 9
 ud_0                 4.556367e-01 1 1  ON 10
 ud_1                 1.890575e-01 1 1  ON 11
 ud_2                 6.784196e-02 1 1  ON 12
 ud_3                -4.092647e-03 1 1  ON 13
 ud_4                -6.179971e-02 1 1  ON 14
 ud_5                -1.045631e-01 1 1  ON 15
 ud_6                -1.336012e-01 1 1  ON 16
 ud_7                -1.514823e-01 1 1  ON 17
 ud_8                -1.539561e-01 1 1  ON 18
 ud_9                -1.467235e-01 1 1  ON 19
 eO_0                -7.603396e-01 1 1  ON 20
 eO_1                -4.375634e-01 1 1  ON 21
 eO_2                -1.534046e-02 1 1  ON 22
 eO_3                 3.071645e-01 1 1  ON 23
 eO_4                 5.366668e-01 1 1  ON 24
 eO_5                 5.009028e-01 1 1  ON 25
 eO_6                 2.717546e-01 1 1  ON 26
 eO_7                -3.793750e-02 1 1  ON 27
 eO_8                -2.443039e-01 1 1  ON 28
 eO_9                -1.147426e-01 1 1  ON 29
eH1_0                -2.589650e-01 1 1  ON 30
eH1_1                -1.569801e-01 1 1  ON 31
eH1_2                -1.088554e-01 1 1  ON 32
eH1_3                -5.433450e-02 1 1  ON 33
eH1_4                -4.887644e-03 1 1  ON 34
eH1_5                 3.096743e-02 1 1  ON 35
eH1_6                 9.199583e-02 1 1  ON 36
eH1_7                 1.560801e-01 1 1  ON 37
eH1_8                 1.984976e-01 1 1  ON 38
eH1_9                 1.045063e-01 1 1  ON 39
eH2_0                -2.565380e-01 1 1  ON 40
eH2_1                -1.542091e-01 1 1  ON 41
eH2_2                -1.066093e-01 1 1  ON 42
eH2_3                -5.147033e-02 1 1  ON 43
eH2_4                -2.388585e-03 1 1  ON 44
eH2_5                 3.274341e-02 1 1  ON 45
eH2_6                 9.399560e-02 1 1  ON 46
eH2_7                 1.563434e-01 1 1  ON 47
eH2_8                 2.002917e-01 1 1  ON 48
eH2_9                 9.908091e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8919
    reference variance = 0.273788
====================================================
  Execution time = 2.0479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3648e-01
  Total weights = 2.0000e+06
  Execution time = 1.9085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336441526582
                                         uncertainty =       0.003392967272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336441526582
                                         uncertainty =       0.003392967272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410132980
  error estimate for blocks of size 2^( 2) =       0.000423084106
  error estimate for blocks of size 2^( 3) =       0.000435690398
  error estimate for blocks of size 2^( 4) =       0.000448788271
  error estimate for blocks of size 2^( 5) =       0.000460517038
  error estimate for blocks of size 2^( 6) =       0.000468191281
  error estimate for blocks of size 2^( 7) =       0.000474511184

      target function =                  N/A
              le_mean =     -16.905010179243
             les_mean =     286.115787114137
             stat err =       0.000463001944
             autocorr =       1.274430750545
              std dev =       0.580015622222
             le_variance =       0.336418122021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336573971816
                                         uncertainty =       0.003395769442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336573971816
                                         uncertainty =       0.003395769442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410213621
  error estimate for blocks of size 2^( 2) =       0.000423154119
  error estimate for blocks of size 2^( 3) =       0.000435744899
  error estimate for blocks of size 2^( 4) =       0.000448831494
  error estimate for blocks of size 2^( 5) =       0.000460552413
  error estimate for blocks of size 2^( 6) =       0.000468219387
  error estimate for blocks of size 2^( 7) =       0.000474544113

      target function =                  N/A
              le_mean =     -16.905008201667
             les_mean =     286.115852559141
             stat err =       0.000463036852
             autocorr =       1.274121839642
              std dev =       0.580129665675
             le_variance =       0.336550428996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336582659959
                                         uncertainty =       0.003396843653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336582659959
                                         uncertainty =       0.003396843653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410218830
  error estimate for blocks of size 2^( 2) =       0.000423160597
  error estimate for blocks of size 2^( 3) =       0.000435757815
  error estimate for blocks of size 2^( 4) =       0.000448853381
  error estimate for blocks of size 2^( 5) =       0.000460579889
  error estimate for blocks of size 2^( 6) =       0.000468245211
  error estimate for blocks of size 2^( 7) =       0.000474578557

      target function =                  N/A
              le_mean =     -16.905007652404
             les_mean =     286.115842536764
             stat err =       0.000463064259
             autocorr =       1.274240313695
              std dev =       0.580137033119
             le_variance =       0.336558977196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336501892960
                                         uncertainty =       0.003394470419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336501892960
                                         uncertainty =       0.003394470419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410169722
  error estimate for blocks of size 2^( 2) =       0.000423118065
  error estimate for blocks of size 2^( 3) =       0.000435722956
  error estimate for blocks of size 2^( 4) =       0.000448821805
  error estimate for blocks of size 2^( 5) =       0.000460550042
  error estimate for blocks of size 2^( 6) =       0.000468220503
  error estimate for blocks of size 2^( 7) =       0.000474543577

      target function =                  N/A
              le_mean =     -16.905008431485
             les_mean =     286.115788302010
             stat err =       0.000463033982
             autocorr =       1.274378784925
              std dev =       0.580067583711
             le_variance =       0.336478401672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905010179243        initial  <--
     1.5625e-02     1.5625e-01             1.1904e-02       -16.905008201667
     6.2500e-02     6.2500e-01             2.9437e-03       -16.905007652404
     2.5000e-01     2.5000e+00             7.2852e-04       -16.905008431485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0554
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.093023e-01 1 1  ON 0
 uu_1                 1.421811e-01 1 1  ON 1
 uu_2                 4.030507e-02 1 1  ON 2
 uu_3                -2.261366e-02 1 1  ON 3
 uu_4                -6.849812e-02 1 1  ON 4
 uu_5                -1.037269e-01 1 1  ON 5
 uu_6                -1.321306e-01 1 1  ON 6
 uu_7                -1.466982e-01 1 1  ON 7
 uu_8                -1.395485e-01 1 1  ON 8
 uu_9                -1.126279e-01 1 1  ON 9
 ud_0                 4.550168e-01 1 1  ON 10
 ud_1                 1.886057e-01 1 1  ON 11
 ud_2                 6.740060e-02 1 1  ON 12
 ud_3                -4.711472e-03 1 1  ON 13
 ud_4                -6.242670e-02 1 1  ON 14
 ud_5                -1.050654e-01 1 1  ON 15
 ud_6                -1.338074e-01 1 1  ON 16
 ud_7                -1.520604e-01 1 1  ON 17
 ud_8                -1.535006e-01 1 1  ON 18
 ud_9                -1.453570e-01 1 1  ON 19
 eO_0                -7.612606e-01 1 1  ON 20
 eO_1                -4.384409e-01 1 1  ON 21
 eO_2                -1.651950e-02 1 1  ON 22
 eO_3                 3.069405e-01 1 1  ON 23
 eO_4                 5.359076e-01 1 1  ON 24
 eO_5                 5.004421e-01 1 1  ON 25
 eO_6                 2.713970e-01 1 1  ON 26
 eO_7                -3.731611e-02 1 1  ON 27
 eO_8                -2.423914e-01 1 1  ON 28
 eO_9                -1.126932e-01 1 1  ON 29
eH1_0                -2.580685e-01 1 1  ON 30
eH1_1                -1.562537e-01 1 1  ON 31
eH1_2                -1.085869e-01 1 1  ON 32
eH1_3                -5.350004e-02 1 1  ON 33
eH1_4                -4.447294e-03 1 1  ON 34
eH1_5                 3.106159e-02 1 1  ON 35
eH1_6                 9.154777e-02 1 1  ON 36
eH1_7                 1.562962e-01 1 1  ON 37
eH1_8                 1.979123e-01 1 1  ON 38
eH1_9                 1.025853e-01 1 1  ON 39
eH2_0                -2.547580e-01 1 1  ON 40
eH2_1                -1.532344e-01 1 1  ON 41
eH2_2                -1.056251e-01 1 1  ON 42
eH2_3                -5.055270e-02 1 1  ON 43
eH2_4                -1.642173e-03 1 1  ON 44
eH2_5                 3.320115e-02 1 1  ON 45
eH2_6                 9.333895e-02 1 1  ON 46
eH2_7                 1.552893e-01 1 1  ON 47
eH2_8                 1.998469e-01 1 1  ON 48
eH2_9                 9.613724e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6907e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.238084
====================================================
  Execution time = 2.1078e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3596e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335975421246
                                         uncertainty =       0.002764794858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335975421246
                                         uncertainty =       0.002764794858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409851933
  error estimate for blocks of size 2^( 2) =       0.000422810567
  error estimate for blocks of size 2^( 3) =       0.000436216475
  error estimate for blocks of size 2^( 4) =       0.000448363818
  error estimate for blocks of size 2^( 5) =       0.000458306416
  error estimate for blocks of size 2^( 6) =       0.000467122359
  error estimate for blocks of size 2^( 7) =       0.000472348869

      target function =                  N/A
              le_mean =     -16.906039927213
             les_mean =     286.150143066861
             stat err =       0.000461535365
             autocorr =       1.268107273913
              std dev =       0.579618162515
             le_variance =       0.335957214317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603992721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039927213       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040408246       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040505953       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040614996       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906042534564       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906042138444       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906041710629       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906041247444       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906041579298       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906041735664       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906041868728       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.598524e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039927213       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040117733       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040276528       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040418000       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040631669       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040742779       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040559516       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040636390       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906040579863       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.015446e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039927213       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906039982990       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040050013       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040105475       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040066150       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040129569       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040105243       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040124777       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.854505e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6890e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.092688e-01 1 1  ON 0
 uu_1                 1.421442e-01 1 1  ON 1
 uu_2                 4.025974e-02 1 1  ON 2
 uu_3                -2.263853e-02 1 1  ON 3
 uu_4                -6.854562e-02 1 1  ON 4
 uu_5                -1.036391e-01 1 1  ON 5
 uu_6                -1.320986e-01 1 1  ON 6
 uu_7                -1.467108e-01 1 1  ON 7
 uu_8                -1.395642e-01 1 1  ON 8
 uu_9                -1.126852e-01 1 1  ON 9
 ud_0                 4.550071e-01 1 1  ON 10
 ud_1                 1.885704e-01 1 1  ON 11
 ud_2                 6.735186e-02 1 1  ON 12
 ud_3                -4.650517e-03 1 1  ON 13
 ud_4                -6.237806e-02 1 1  ON 14
 ud_5                -1.050851e-01 1 1  ON 15
 ud_6                -1.337793e-01 1 1  ON 16
 ud_7                -1.519734e-01 1 1  ON 17
 ud_8                -1.534845e-01 1 1  ON 18
 ud_9                -1.452674e-01 1 1  ON 19
 eO_0                -7.611797e-01 1 1  ON 20
 eO_1                -4.384078e-01 1 1  ON 21
 eO_2                -1.646774e-02 1 1  ON 22
 eO_3                 3.069279e-01 1 1  ON 23
 eO_4                 5.359465e-01 1 1  ON 24
 eO_5                 5.005149e-01 1 1  ON 25
 eO_6                 2.714466e-01 1 1  ON 26
 eO_7                -3.735337e-02 1 1  ON 27
 eO_8                -2.424302e-01 1 1  ON 28
 eO_9                -1.128699e-01 1 1  ON 29
eH1_0                -2.580889e-01 1 1  ON 30
eH1_1                -1.562201e-01 1 1  ON 31
eH1_2                -1.084877e-01 1 1  ON 32
eH1_3                -5.353030e-02 1 1  ON 33
eH1_4                -4.523173e-03 1 1  ON 34
eH1_5                 3.089895e-02 1 1  ON 35
eH1_6                 9.153637e-02 1 1  ON 36
eH1_7                 1.562254e-01 1 1  ON 37
eH1_8                 1.979800e-01 1 1  ON 38
eH1_9                 1.027794e-01 1 1  ON 39
eH2_0                -2.549206e-01 1 1  ON 40
eH2_1                -1.532382e-01 1 1  ON 41
eH2_2                -1.057191e-01 1 1  ON 42
eH2_3                -5.076063e-02 1 1  ON 43
eH2_4                -1.818732e-03 1 1  ON 44
eH2_5                 3.330751e-02 1 1  ON 45
eH2_6                 9.330011e-02 1 1  ON 46
eH2_7                 1.552383e-01 1 1  ON 47
eH2_8                 1.999564e-01 1 1  ON 48
eH2_9                 9.653878e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9731
    reference variance = 0.376575
====================================================
  Execution time = 2.0864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3622e-01
  Total weights = 2.0000e+06
  Execution time = 1.9213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336267821266
                                         uncertainty =       0.002668893740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336267821266
                                         uncertainty =       0.002668893740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410006144
  error estimate for blocks of size 2^( 2) =       0.000423024550
  error estimate for blocks of size 2^( 3) =       0.000435844181
  error estimate for blocks of size 2^( 4) =       0.000447430382
  error estimate for blocks of size 2^( 5) =       0.000457381463
  error estimate for blocks of size 2^( 6) =       0.000463851013
  error estimate for blocks of size 2^( 7) =       0.000469433512

      target function =                  N/A
              le_mean =     -16.906512006772
             les_mean =     286.166358142579
             stat err =       0.000459524093
             autocorr =       1.256133632259
              std dev =       0.579836248919
             le_variance =       0.336210075560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336224842645
                                         uncertainty =       0.002668735972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336224842645
                                         uncertainty =       0.002668735972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409979923
  error estimate for blocks of size 2^( 2) =       0.000423001692
  error estimate for blocks of size 2^( 3) =       0.000435827139
  error estimate for blocks of size 2^( 4) =       0.000447417545
  error estimate for blocks of size 2^( 5) =       0.000457367131
  error estimate for blocks of size 2^( 6) =       0.000463833054
  error estimate for blocks of size 2^( 7) =       0.000469416643

      target function =                  N/A
              le_mean =     -16.906512931207
             les_mean =     286.166346399666
             stat err =       0.000459508593
             autocorr =       1.256209565700
              std dev =       0.579799167539
             le_variance =       0.336167074679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336292149167
                                         uncertainty =       0.002669561166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336292149167
                                         uncertainty =       0.002669561166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410020957
  error estimate for blocks of size 2^( 2) =       0.000423040537
  error estimate for blocks of size 2^( 3) =       0.000435863268
  error estimate for blocks of size 2^( 4) =       0.000447450991
  error estimate for blocks of size 2^( 5) =       0.000457400212
  error estimate for blocks of size 2^( 6) =       0.000463866155
  error estimate for blocks of size 2^( 7) =       0.000469447908

      target function =                  N/A
              le_mean =     -16.906513011025
             les_mean =     286.166416394201
             stat err =       0.000459541317
             autocorr =       1.256137029331
              std dev =       0.579857198259
             le_variance =       0.336234370373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336278579462
                                         uncertainty =       0.002669081865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336278579462
                                         uncertainty =       0.002669081865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410012698
  error estimate for blocks of size 2^( 2) =       0.000423031043
  error estimate for blocks of size 2^( 3) =       0.000435850911
  error estimate for blocks of size 2^( 4) =       0.000447437073
  error estimate for blocks of size 2^( 5) =       0.000457387699
  error estimate for blocks of size 2^( 6) =       0.000463856588
  error estimate for blocks of size 2^( 7) =       0.000469439039

      target function =                  N/A
              le_mean =     -16.906512112494
             les_mean =     286.166372466123
             stat err =       0.000459530099
             autocorr =       1.256126312855
              std dev =       0.579845517652
             le_variance =       0.336220824341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906512006772        initial
     1.5625e-01     1.5625e+00             1.5985e-03       -16.906512931207
     6.2500e-01     6.2500e+00             4.0154e-04       -16.906513011025  <--
     2.5000e+00     2.5000e+01             9.8545e-05       -16.906512112494

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0498e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.092688e-01 1 1  ON 0
 uu_1                 1.421442e-01 1 1  ON 1
 uu_2                 4.025974e-02 1 1  ON 2
 uu_3                -2.263853e-02 1 1  ON 3
 uu_4                -6.854562e-02 1 1  ON 4
 uu_5                -1.036391e-01 1 1  ON 5
 uu_6                -1.320986e-01 1 1  ON 6
 uu_7                -1.467108e-01 1 1  ON 7
 uu_8                -1.395642e-01 1 1  ON 8
 uu_9                -1.126852e-01 1 1  ON 9
 ud_0                 4.550071e-01 1 1  ON 10
 ud_1                 1.885704e-01 1 1  ON 11
 ud_2                 6.735186e-02 1 1  ON 12
 ud_3                -4.650517e-03 1 1  ON 13
 ud_4                -6.237806e-02 1 1  ON 14
 ud_5                -1.050851e-01 1 1  ON 15
 ud_6                -1.337793e-01 1 1  ON 16
 ud_7                -1.519734e-01 1 1  ON 17
 ud_8                -1.534845e-01 1 1  ON 18
 ud_9                -1.452674e-01 1 1  ON 19
 eO_0                -7.611797e-01 1 1  ON 20
 eO_1                -4.384078e-01 1 1  ON 21
 eO_2                -1.646774e-02 1 1  ON 22
 eO_3                 3.069279e-01 1 1  ON 23
 eO_4                 5.359465e-01 1 1  ON 24
 eO_5                 5.005149e-01 1 1  ON 25
 eO_6                 2.714466e-01 1 1  ON 26
 eO_7                -3.735337e-02 1 1  ON 27
 eO_8                -2.424302e-01 1 1  ON 28
 eO_9                -1.128699e-01 1 1  ON 29
eH1_0                -2.580889e-01 1 1  ON 30
eH1_1                -1.562201e-01 1 1  ON 31
eH1_2                -1.084877e-01 1 1  ON 32
eH1_3                -5.353030e-02 1 1  ON 33
eH1_4                -4.523173e-03 1 1  ON 34
eH1_5                 3.089895e-02 1 1  ON 35
eH1_6                 9.153637e-02 1 1  ON 36
eH1_7                 1.562254e-01 1 1  ON 37
eH1_8                 1.979800e-01 1 1  ON 38
eH1_9                 1.027794e-01 1 1  ON 39
eH2_0                -2.549206e-01 1 1  ON 40
eH2_1                -1.532382e-01 1 1  ON 41
eH2_2                -1.057191e-01 1 1  ON 42
eH2_3                -5.076063e-02 1 1  ON 43
eH2_4                -1.818732e-03 1 1  ON 44
eH2_5                 3.330751e-02 1 1  ON 45
eH2_6                 9.330011e-02 1 1  ON 46
eH2_7                 1.552383e-01 1 1  ON 47
eH2_8                 1.999564e-01 1 1  ON 48
eH2_9                 9.653878e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.0019
    reference variance = 0.276998
====================================================
  Execution time = 2.0923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4563e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343919619998
                                         uncertainty =       0.007104378986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343919619998
                                         uncertainty =       0.007104378986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415713186
  error estimate for blocks of size 2^( 2) =       0.000428366157
  error estimate for blocks of size 2^( 3) =       0.000441692522
  error estimate for blocks of size 2^( 4) =       0.000454053450
  error estimate for blocks of size 2^( 5) =       0.000466003070
  error estimate for blocks of size 2^( 6) =       0.000472650744
  error estimate for blocks of size 2^( 7) =       0.000478465936

      target function =                  N/A
              le_mean =     -16.906030732513
             les_mean =     286.159509861293
             stat err =       0.000467793300
             autocorr =       1.266252730339
              std dev =       0.587907225198
             le_variance =       0.345634905440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603073251e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906030732513       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906030498583       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906030959523       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906032159781       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906031411395       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906030990243       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906031879480       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906031255952       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906031888471       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906031989133       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.333742e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906030732513       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906030621953       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906030735145       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906031274268       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906031035043       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906030725173       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906030905221       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906030972272       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906030923470       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.377275e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906030732513       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906030696957       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906030717486       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906030883439       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906030811201       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906030713544       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906030759206       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906030780214       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.355959e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.035326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6723e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.092523e-01 1 1  ON 0
 uu_1                 1.422208e-01 1 1  ON 1
 uu_2                 4.028013e-02 1 1  ON 2
 uu_3                -2.259545e-02 1 1  ON 3
 uu_4                -6.860571e-02 1 1  ON 4
 uu_5                -1.036854e-01 1 1  ON 5
 uu_6                -1.320439e-01 1 1  ON 6
 uu_7                -1.467971e-01 1 1  ON 7
 uu_8                -1.396971e-01 1 1  ON 8
 uu_9                -1.127142e-01 1 1  ON 9
 ud_0                 4.549579e-01 1 1  ON 10
 ud_1                 1.885016e-01 1 1  ON 11
 ud_2                 6.733199e-02 1 1  ON 12
 ud_3                -4.633399e-03 1 1  ON 13
 ud_4                -6.242327e-02 1 1  ON 14
 ud_5                -1.050550e-01 1 1  ON 15
 ud_6                -1.338132e-01 1 1  ON 16
 ud_7                -1.518043e-01 1 1  ON 17
 ud_8                -1.534881e-01 1 1  ON 18
 ud_9                -1.452114e-01 1 1  ON 19
 eO_0                -7.612506e-01 1 1  ON 20
 eO_1                -4.383827e-01 1 1  ON 21
 eO_2                -1.635929e-02 1 1  ON 22
 eO_3                 3.069724e-01 1 1  ON 23
 eO_4                 5.361654e-01 1 1  ON 24
 eO_5                 5.005162e-01 1 1  ON 25
 eO_6                 2.714858e-01 1 1  ON 26
 eO_7                -3.737380e-02 1 1  ON 27
 eO_8                -2.425391e-01 1 1  ON 28
 eO_9                -1.130760e-01 1 1  ON 29
eH1_0                -2.582164e-01 1 1  ON 30
eH1_1                -1.562780e-01 1 1  ON 31
eH1_2                -1.086215e-01 1 1  ON 32
eH1_3                -5.368404e-02 1 1  ON 33
eH1_4                -4.595142e-03 1 1  ON 34
eH1_5                 3.078156e-02 1 1  ON 35
eH1_6                 9.161172e-02 1 1  ON 36
eH1_7                 1.562132e-01 1 1  ON 37
eH1_8                 1.981652e-01 1 1  ON 38
eH1_9                 1.031171e-01 1 1  ON 39
eH2_0                -2.551172e-01 1 1  ON 40
eH2_1                -1.532911e-01 1 1  ON 41
eH2_2                -1.056241e-01 1 1  ON 42
eH2_3                -5.088087e-02 1 1  ON 43
eH2_4                -2.001415e-03 1 1  ON 44
eH2_5                 3.332098e-02 1 1  ON 45
eH2_6                 9.330805e-02 1 1  ON 46
eH2_7                 1.552763e-01 1 1  ON 47
eH2_8                 2.000194e-01 1 1  ON 48
eH2_9                 9.681234e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8942
    reference variance = 0.263671
====================================================
  Execution time = 2.0371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3754e-01
  Total weights = 2.0000e+06
  Execution time = 1.9063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337589988343
                                         uncertainty =       0.003809006100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337589988343
                                         uncertainty =       0.003809006100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410832438
  error estimate for blocks of size 2^( 2) =       0.000423318696
  error estimate for blocks of size 2^( 3) =       0.000436011217
  error estimate for blocks of size 2^( 4) =       0.000448481622
  error estimate for blocks of size 2^( 5) =       0.000457819800
  error estimate for blocks of size 2^( 6) =       0.000466814406
  error estimate for blocks of size 2^( 7) =       0.000468772681

      target function =                  N/A
              le_mean =     -16.905496737131
             les_mean =     286.133386345385
             stat err =       0.000460472127
             autocorr =       1.256253369707
              std dev =       0.581004806369
             le_variance =       0.337566585024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337549687170
                                         uncertainty =       0.003808327973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337549687170
                                         uncertainty =       0.003808327973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410807899
  error estimate for blocks of size 2^( 2) =       0.000423296791
  error estimate for blocks of size 2^( 3) =       0.000435992092
  error estimate for blocks of size 2^( 4) =       0.000448468594
  error estimate for blocks of size 2^( 5) =       0.000457806830
  error estimate for blocks of size 2^( 6) =       0.000466795378
  error estimate for blocks of size 2^( 7) =       0.000468753372

      target function =                  N/A
              le_mean =     -16.905495197291
             les_mean =     286.133293957172
             stat err =       0.000460456043
             autocorr =       1.256315686869
              std dev =       0.580970102755
             le_variance =       0.337526260295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337534351259
                                         uncertainty =       0.003808143056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337534351259
                                         uncertainty =       0.003808143056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410798579
  error estimate for blocks of size 2^( 2) =       0.000423287665
  error estimate for blocks of size 2^( 3) =       0.000435983557
  error estimate for blocks of size 2^( 4) =       0.000448460511
  error estimate for blocks of size 2^( 5) =       0.000457799668
  error estimate for blocks of size 2^( 6) =       0.000466790309
  error estimate for blocks of size 2^( 7) =       0.000468749655

      target function =                  N/A
              le_mean =     -16.905495058152
             les_mean =     286.133273938016
             stat err =       0.000460450036
             autocorr =       1.256339908933
              std dev =       0.580956922293
             le_variance =       0.337510945560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337582886252
                                         uncertainty =       0.003808883013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337582886252
                                         uncertainty =       0.003808883013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410828116
  error estimate for blocks of size 2^( 2) =       0.000423314709
  error estimate for blocks of size 2^( 3) =       0.000436007678
  error estimate for blocks of size 2^( 4) =       0.000448479093
  error estimate for blocks of size 2^( 5) =       0.000457817335
  error estimate for blocks of size 2^( 6) =       0.000466811336
  error estimate for blocks of size 2^( 7) =       0.000468769832

      target function =                  N/A
              le_mean =     -16.905496437992
             les_mean =     286.133369127259
             stat err =       0.000460469399
             autocorr =       1.256264920706
              std dev =       0.580998692828
             le_variance =       0.337559481068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905496737131        initial  <--
     1.5625e-01     1.5625e+00             1.3337e-03       -16.905495197291
     6.2500e-01     6.2500e+00             3.3773e-04       -16.905495058152
     2.5000e+00     2.5000e+01             8.3560e-05       -16.905496437992

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9865
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.092688e-01 1 1  ON 0
 uu_1                 1.421442e-01 1 1  ON 1
 uu_2                 4.025974e-02 1 1  ON 2
 uu_3                -2.263853e-02 1 1  ON 3
 uu_4                -6.854562e-02 1 1  ON 4
 uu_5                -1.036391e-01 1 1  ON 5
 uu_6                -1.320986e-01 1 1  ON 6
 uu_7                -1.467108e-01 1 1  ON 7
 uu_8                -1.395642e-01 1 1  ON 8
 uu_9                -1.126852e-01 1 1  ON 9
 ud_0                 4.550071e-01 1 1  ON 10
 ud_1                 1.885704e-01 1 1  ON 11
 ud_2                 6.735186e-02 1 1  ON 12
 ud_3                -4.650517e-03 1 1  ON 13
 ud_4                -6.237806e-02 1 1  ON 14
 ud_5                -1.050851e-01 1 1  ON 15
 ud_6                -1.337793e-01 1 1  ON 16
 ud_7                -1.519734e-01 1 1  ON 17
 ud_8                -1.534845e-01 1 1  ON 18
 ud_9                -1.452674e-01 1 1  ON 19
 eO_0                -7.611797e-01 1 1  ON 20
 eO_1                -4.384078e-01 1 1  ON 21
 eO_2                -1.646774e-02 1 1  ON 22
 eO_3                 3.069279e-01 1 1  ON 23
 eO_4                 5.359465e-01 1 1  ON 24
 eO_5                 5.005149e-01 1 1  ON 25
 eO_6                 2.714466e-01 1 1  ON 26
 eO_7                -3.735337e-02 1 1  ON 27
 eO_8                -2.424302e-01 1 1  ON 28
 eO_9                -1.128699e-01 1 1  ON 29
eH1_0                -2.580889e-01 1 1  ON 30
eH1_1                -1.562201e-01 1 1  ON 31
eH1_2                -1.084877e-01 1 1  ON 32
eH1_3                -5.353030e-02 1 1  ON 33
eH1_4                -4.523173e-03 1 1  ON 34
eH1_5                 3.089895e-02 1 1  ON 35
eH1_6                 9.153637e-02 1 1  ON 36
eH1_7                 1.562254e-01 1 1  ON 37
eH1_8                 1.979800e-01 1 1  ON 38
eH1_9                 1.027794e-01 1 1  ON 39
eH2_0                -2.549206e-01 1 1  ON 40
eH2_1                -1.532382e-01 1 1  ON 41
eH2_2                -1.057191e-01 1 1  ON 42
eH2_3                -5.076063e-02 1 1  ON 43
eH2_4                -1.818732e-03 1 1  ON 44
eH2_5                 3.330751e-02 1 1  ON 45
eH2_6                 9.330011e-02 1 1  ON 46
eH2_7                 1.552383e-01 1 1  ON 47
eH2_8                 1.999564e-01 1 1  ON 48
eH2_9                 9.653878e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6715e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8535
    reference variance = 0.151163
====================================================
  Execution time = 2.1147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4023e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257622232
                                         uncertainty =       0.004587271995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257622232
                                         uncertainty =       0.004587271995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412452281
  error estimate for blocks of size 2^( 2) =       0.000425051778
  error estimate for blocks of size 2^( 3) =       0.000438662121
  error estimate for blocks of size 2^( 4) =       0.000451595577
  error estimate for blocks of size 2^( 5) =       0.000462255168
  error estimate for blocks of size 2^( 6) =       0.000470366300
  error estimate for blocks of size 2^( 7) =       0.000472557666

      target function =                  N/A
              le_mean =     -16.906091279798
             les_mean =     286.156155958735
             stat err =       0.000464193678
             autocorr =       1.266633653487
              std dev =       0.583295609450
             le_variance =       0.340233768004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609127980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906091279798       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906091303638       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906091489660       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906091649146       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906091738244       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906091541602       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906091573115       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906091525479       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.345251e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906091279798       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906091286189       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906091319102       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906091362715       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906091406623       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906091356554       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906091355762       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906091344982       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.413652e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906091279798       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906091281425       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906091288670       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906091299820       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906091312089       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906091299656       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906091299122       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906091296480       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.568681e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9918e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.092733e-01 1 1  ON 0
 uu_1                 1.421455e-01 1 1  ON 1
 uu_2                 4.026668e-02 1 1  ON 2
 uu_3                -2.262890e-02 1 1  ON 3
 uu_4                -6.853749e-02 1 1  ON 4
 uu_5                -1.036473e-01 1 1  ON 5
 uu_6                -1.321191e-01 1 1  ON 6
 uu_7                -1.467219e-01 1 1  ON 7
 uu_8                -1.395739e-01 1 1  ON 8
 uu_9                -1.126844e-01 1 1  ON 9
 ud_0                 4.549995e-01 1 1  ON 10
 ud_1                 1.885787e-01 1 1  ON 11
 ud_2                 6.735374e-02 1 1  ON 12
 ud_3                -4.649282e-03 1 1  ON 13
 ud_4                -6.238396e-02 1 1  ON 14
 ud_5                -1.050771e-01 1 1  ON 15
 ud_6                -1.337663e-01 1 1  ON 16
 ud_7                -1.519541e-01 1 1  ON 17
 ud_8                -1.534911e-01 1 1  ON 18
 ud_9                -1.452766e-01 1 1  ON 19
 eO_0                -7.611742e-01 1 1  ON 20
 eO_1                -4.383952e-01 1 1  ON 21
 eO_2                -1.645868e-02 1 1  ON 22
 eO_3                 3.069316e-01 1 1  ON 23
 eO_4                 5.359580e-01 1 1  ON 24
 eO_5                 5.005111e-01 1 1  ON 25
 eO_6                 2.714443e-01 1 1  ON 26
 eO_7                -3.734977e-02 1 1  ON 27
 eO_8                -2.424439e-01 1 1  ON 28
 eO_9                -1.128910e-01 1 1  ON 29
eH1_0                -2.581018e-01 1 1  ON 30
eH1_1                -1.562284e-01 1 1  ON 31
eH1_2                -1.084918e-01 1 1  ON 32
eH1_3                -5.354846e-02 1 1  ON 33
eH1_4                -4.515970e-03 1 1  ON 34
eH1_5                 3.088702e-02 1 1  ON 35
eH1_6                 9.154133e-02 1 1  ON 36
eH1_7                 1.562315e-01 1 1  ON 37
eH1_8                 1.979876e-01 1 1  ON 38
eH1_9                 1.028048e-01 1 1  ON 39
eH2_0                -2.549375e-01 1 1  ON 40
eH2_1                -1.532557e-01 1 1  ON 41
eH2_2                -1.057239e-01 1 1  ON 42
eH2_3                -5.076070e-02 1 1  ON 43
eH2_4                -1.809626e-03 1 1  ON 44
eH2_5                 3.329895e-02 1 1  ON 45
eH2_6                 9.329586e-02 1 1  ON 46
eH2_7                 1.552364e-01 1 1  ON 47
eH2_8                 1.999641e-01 1 1  ON 48
eH2_9                 9.657292e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9315
    reference variance = 0.175604
====================================================
  Execution time = 2.1863e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3940e-01
  Total weights = 2.0000e+06
  Execution time = 1.9047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339499696513
                                         uncertainty =       0.003474791956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339499696513
                                         uncertainty =       0.003474791956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411953948
  error estimate for blocks of size 2^( 2) =       0.000424876045
  error estimate for blocks of size 2^( 3) =       0.000438705153
  error estimate for blocks of size 2^( 4) =       0.000450332444
  error estimate for blocks of size 2^( 5) =       0.000460843030
  error estimate for blocks of size 2^( 6) =       0.000469746632
  error estimate for blocks of size 2^( 7) =       0.000473949137

      target function =                  N/A
              le_mean =     -16.905764261481
             les_mean =     286.144277205767
             stat err =       0.000463717811
             autocorr =       1.267098028396
              std dev =       0.582590860459
             le_variance =       0.339412110690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339457155379
                                         uncertainty =       0.003473967763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339457155379
                                         uncertainty =       0.003473967763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411928153
  error estimate for blocks of size 2^( 2) =       0.000424851232
  error estimate for blocks of size 2^( 3) =       0.000438681303
  error estimate for blocks of size 2^( 4) =       0.000450309013
  error estimate for blocks of size 2^( 5) =       0.000460820829
  error estimate for blocks of size 2^( 6) =       0.000469725463
  error estimate for blocks of size 2^( 7) =       0.000473928545

      target function =                  N/A
              le_mean =     -16.905764748163
             les_mean =     286.144251157007
             stat err =       0.000463695962
             autocorr =       1.267137311989
              std dev =       0.582554380680
             le_variance =       0.339369606450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339473311559
                                         uncertainty =       0.003474310030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339473311559
                                         uncertainty =       0.003474310030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411937950
  error estimate for blocks of size 2^( 2) =       0.000424860678
  error estimate for blocks of size 2^( 3) =       0.000438690395
  error estimate for blocks of size 2^( 4) =       0.000450317966
  error estimate for blocks of size 2^( 5) =       0.000460829225
  error estimate for blocks of size 2^( 6) =       0.000469733437
  error estimate for blocks of size 2^( 7) =       0.000473936226

      target function =                  N/A
              le_mean =     -16.905764519820
             les_mean =     286.144259578615
             stat err =       0.000463704213
             autocorr =       1.267122137101
              std dev =       0.582568235241
             le_variance =       0.339385748712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339496197264
                                         uncertainty =       0.003474729084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339496197264
                                         uncertainty =       0.003474729084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411951826
  error estimate for blocks of size 2^( 2) =       0.000424874007
  error estimate for blocks of size 2^( 3) =       0.000438703197
  error estimate for blocks of size 2^( 4) =       0.000450330525
  error estimate for blocks of size 2^( 5) =       0.000460841197
  error estimate for blocks of size 2^( 6) =       0.000469744879
  error estimate for blocks of size 2^( 7) =       0.000473947419

      target function =                  N/A
              le_mean =     -16.905764293821
             les_mean =     286.144274803024
             stat err =       0.000463716005
             autocorr =       1.267101210164
              std dev =       0.582587859888
             le_variance =       0.339408614489


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905764261481        initial
     1.5625e+00     1.5625e+01             1.3453e-04       -16.905764748163  <--
     6.2500e+00     6.2500e+01             3.4137e-05       -16.905764519820
     2.5000e+01     2.5000e+02             8.5687e-06       -16.905764293821

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 3.1431e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.092872e-01 1 1  ON 0
 uu_1                 1.421538e-01 1 1  ON 1
 uu_2                 4.028565e-02 1 1  ON 2
 uu_3                -2.260114e-02 1 1  ON 3
 uu_4                -6.851791e-02 1 1  ON 4
 uu_5                -1.036688e-01 1 1  ON 5
 uu_6                -1.321776e-01 1 1  ON 6
 uu_7                -1.467564e-01 1 1  ON 7
 uu_8                -1.396029e-01 1 1  ON 8
 uu_9                -1.126824e-01 1 1  ON 9
 ud_0                 4.549845e-01 1 1  ON 10
 ud_1                 1.885975e-01 1 1  ON 11
 ud_2                 6.735934e-02 1 1  ON 12
 ud_3                -4.647070e-03 1 1  ON 13
 ud_4                -6.239761e-02 1 1  ON 14
 ud_5                -1.050564e-01 1 1  ON 15
 ud_6                -1.337293e-01 1 1  ON 16
 ud_7                -1.518974e-01 1 1  ON 17
 ud_8                -1.535097e-01 1 1  ON 18
 ud_9                -1.453035e-01 1 1  ON 19
 eO_0                -7.611565e-01 1 1  ON 20
 eO_1                -4.383593e-01 1 1  ON 21
 eO_2                -1.643190e-02 1 1  ON 22
 eO_3                 3.069432e-01 1 1  ON 23
 eO_4                 5.359908e-01 1 1  ON 24
 eO_5                 5.004998e-01 1 1  ON 25
 eO_6                 2.714375e-01 1 1  ON 26
 eO_7                -3.733926e-02 1 1  ON 27
 eO_8                -2.424842e-01 1 1  ON 28
 eO_9                -1.129530e-01 1 1  ON 29
eH1_0                -2.581386e-01 1 1  ON 30
eH1_1                -1.562539e-01 1 1  ON 31
eH1_2                -1.085058e-01 1 1  ON 32
eH1_3                -5.359843e-02 1 1  ON 33
eH1_4                -4.497610e-03 1 1  ON 34
eH1_5                 3.085319e-02 1 1  ON 35
eH1_6                 9.155607e-02 1 1  ON 36
eH1_7                 1.562498e-01 1 1  ON 37
eH1_8                 1.980104e-01 1 1  ON 38
eH1_9                 1.028795e-01 1 1  ON 39
eH2_0                -2.549870e-01 1 1  ON 40
eH2_1                -1.533042e-01 1 1  ON 41
eH2_2                -1.057381e-01 1 1  ON 42
eH2_3                -5.076205e-02 1 1  ON 43
eH2_4                -1.783073e-03 1 1  ON 44
eH2_5                 3.327398e-02 1 1  ON 45
eH2_6                 9.328249e-02 1 1  ON 46
eH2_7                 1.552300e-01 1 1  ON 47
eH2_8                 1.999866e-01 1 1  ON 48
eH2_9                 9.667331e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1367e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.168575
====================================================
  Execution time = 2.1109e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3959e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584277010
                                         uncertainty =       0.003523308742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339584277010
                                         uncertainty =       0.003523308742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412060975
  error estimate for blocks of size 2^( 2) =       0.000424475334
  error estimate for blocks of size 2^( 3) =       0.000437378186
  error estimate for blocks of size 2^( 4) =       0.000448689057
  error estimate for blocks of size 2^( 5) =       0.000458162022
  error estimate for blocks of size 2^( 6) =       0.000465841645
  error estimate for blocks of size 2^( 7) =       0.000472699292

      target function =                  N/A
              le_mean =     -16.905922779699
             les_mean =     286.149813358009
             stat err =       0.000461348004
             autocorr =       1.253528808945
              std dev =       0.582742219722
             le_variance =       0.339588494647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592277970e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905922779699       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905923399559       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905924041352       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905924257544       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905924056839       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905924034870       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905924268585       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905924232961       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905924251327       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.921617e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905922779699       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905922994183       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905923195493       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905923260826       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905923182997       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905923151089       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905923152200       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905923137752       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.142370e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905922779699       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905922839016       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905922893143       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905922911084       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905922891013       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905922877473       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905922874794       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905922864771       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.042772e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6759e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.092776e-01 1 1  ON 0
 uu_1                 1.421445e-01 1 1  ON 1
 uu_2                 4.026677e-02 1 1  ON 2
 uu_3                -2.258694e-02 1 1  ON 3
 uu_4                -6.847288e-02 1 1  ON 4
 uu_5                -1.036544e-01 1 1  ON 5
 uu_6                -1.320634e-01 1 1  ON 6
 uu_7                -1.468206e-01 1 1  ON 7
 uu_8                -1.396550e-01 1 1  ON 8
 uu_9                -1.127467e-01 1 1  ON 9
 ud_0                 4.550450e-01 1 1  ON 10
 ud_1                 1.886200e-01 1 1  ON 11
 ud_2                 6.740333e-02 1 1  ON 12
 ud_3                -4.640698e-03 1 1  ON 13
 ud_4                -6.239940e-02 1 1  ON 14
 ud_5                -1.050510e-01 1 1  ON 15
 ud_6                -1.337214e-01 1 1  ON 16
 ud_7                -1.518934e-01 1 1  ON 17
 ud_8                -1.535668e-01 1 1  ON 18
 ud_9                -1.453228e-01 1 1  ON 19
 eO_0                -7.611242e-01 1 1  ON 20
 eO_1                -4.383224e-01 1 1  ON 21
 eO_2                -1.642104e-02 1 1  ON 22
 eO_3                 3.069585e-01 1 1  ON 23
 eO_4                 5.360283e-01 1 1  ON 24
 eO_5                 5.005259e-01 1 1  ON 25
 eO_6                 2.714520e-01 1 1  ON 26
 eO_7                -3.733679e-02 1 1  ON 27
 eO_8                -2.425548e-01 1 1  ON 28
 eO_9                -1.130361e-01 1 1  ON 29
eH1_0                -2.581717e-01 1 1  ON 30
eH1_1                -1.562345e-01 1 1  ON 31
eH1_2                -1.085038e-01 1 1  ON 32
eH1_3                -5.358049e-02 1 1  ON 33
eH1_4                -4.543173e-03 1 1  ON 34
eH1_5                 3.085758e-02 1 1  ON 35
eH1_6                 9.145916e-02 1 1  ON 36
eH1_7                 1.562390e-01 1 1  ON 37
eH1_8                 1.980362e-01 1 1  ON 38
eH1_9                 1.029773e-01 1 1  ON 39
eH2_0                -2.550307e-01 1 1  ON 40
eH2_1                -1.532987e-01 1 1  ON 41
eH2_2                -1.057872e-01 1 1  ON 42
eH2_3                -5.079956e-02 1 1  ON 43
eH2_4                -1.842487e-03 1 1  ON 44
eH2_5                 3.327952e-02 1 1  ON 45
eH2_6                 9.334349e-02 1 1  ON 46
eH2_7                 1.552146e-01 1 1  ON 47
eH2_8                 2.000348e-01 1 1  ON 48
eH2_9                 9.676378e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9039
    reference variance = 0.21173
====================================================
  Execution time = 2.0581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4684e-01
  Total weights = 2.0000e+06
  Execution time = 1.9107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346817302219
                                         uncertainty =       0.005729689069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346817302219
                                         uncertainty =       0.005729689069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416424473
  error estimate for blocks of size 2^( 2) =       0.000428973685
  error estimate for blocks of size 2^( 3) =       0.000442046803
  error estimate for blocks of size 2^( 4) =       0.000454080115
  error estimate for blocks of size 2^( 5) =       0.000465396031
  error estimate for blocks of size 2^( 6) =       0.000472168360
  error estimate for blocks of size 2^( 7) =       0.000477544340

      target function =                  N/A
              le_mean =     -16.906148370823
             les_mean =     286.164671247052
             stat err =       0.000467297212
             autocorr =       1.259255593445
              std dev =       0.588913138054
             le_variance =       0.346818684172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859415478
                                         uncertainty =       0.005729728032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859415478
                                         uncertainty =       0.005729728032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416449773
  error estimate for blocks of size 2^( 2) =       0.000428997453
  error estimate for blocks of size 2^( 3) =       0.000442068931
  error estimate for blocks of size 2^( 4) =       0.000454101469
  error estimate for blocks of size 2^( 5) =       0.000465418132
  error estimate for blocks of size 2^( 6) =       0.000472187403
  error estimate for blocks of size 2^( 7) =       0.000477563808

      target function =                  N/A
              le_mean =     -16.906148737288
             les_mean =     286.164725780434
             stat err =       0.000467317703
             autocorr =       1.259213028071
              std dev =       0.588948916754
             le_variance =       0.346860826545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346857922142
                                         uncertainty =       0.005729860785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346857922142
                                         uncertainty =       0.005729860785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416448873
  error estimate for blocks of size 2^( 2) =       0.000428996920
  error estimate for blocks of size 2^( 3) =       0.000442068808
  error estimate for blocks of size 2^( 4) =       0.000454101421
  error estimate for blocks of size 2^( 5) =       0.000465417412
  error estimate for blocks of size 2^( 6) =       0.000472186726
  error estimate for blocks of size 2^( 7) =       0.000477562870

      target function =                  N/A
              le_mean =     -16.906148443465
             les_mean =     286.164714346504
             stat err =       0.000467317107
             autocorr =       1.259215257570
              std dev =       0.588947644079
             le_variance =       0.346859327466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346823475293
                                         uncertainty =       0.005729729367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346823475293
                                         uncertainty =       0.005729729367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416428182
  error estimate for blocks of size 2^( 2) =       0.000428977224
  error estimate for blocks of size 2^( 3) =       0.000442050170
  error estimate for blocks of size 2^( 4) =       0.000454083386
  error estimate for blocks of size 2^( 5) =       0.000465399292
  error estimate for blocks of size 2^( 6) =       0.000472171168
  error estimate for blocks of size 2^( 7) =       0.000477547154

      target function =                  N/A
              le_mean =     -16.906148362945
             les_mean =     286.164677157601
             stat err =       0.000467300250
             autocorr =       1.259249540522
              std dev =       0.588918382384
             le_variance =       0.346824861110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906148370823        initial
     3.9062e-01     3.9062e+00             3.9216e-04       -16.906148737288  <--
     1.5625e+00     1.5625e+01             1.1424e-04       -16.906148443465
     6.2500e+00     6.2500e+01             3.0428e-05       -16.906148362945

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 3.0162e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.092510e-01 1 1  ON 0
 uu_1                 1.421264e-01 1 1  ON 1
 uu_2                 4.024184e-02 1 1  ON 2
 uu_3                -2.255503e-02 1 1  ON 3
 uu_4                -6.836739e-02 1 1  ON 4
 uu_5                -1.035964e-01 1 1  ON 5
 uu_6                -1.318217e-01 1 1  ON 6
 uu_7                -1.469506e-01 1 1  ON 7
 uu_8                -1.397879e-01 1 1  ON 8
 uu_9                -1.129409e-01 1 1  ON 9
 ud_0                 4.551699e-01 1 1  ON 10
 ud_1                 1.887044e-01 1 1  ON 11
 ud_2                 6.749474e-02 1 1  ON 12
 ud_3                -4.591639e-03 1 1  ON 13
 ud_4                -6.240073e-02 1 1  ON 14
 ud_5                -1.050255e-01 1 1  ON 15
 ud_6                -1.337019e-01 1 1  ON 16
 ud_7                -1.518664e-01 1 1  ON 17
 ud_8                -1.537123e-01 1 1  ON 18
 ud_9                -1.453785e-01 1 1  ON 19
 eO_0                -7.610180e-01 1 1  ON 20
 eO_1                -4.382453e-01 1 1  ON 21
 eO_2                -1.636074e-02 1 1  ON 22
 eO_3                 3.070021e-01 1 1  ON 23
 eO_4                 5.361277e-01 1 1  ON 24
 eO_5                 5.006056e-01 1 1  ON 25
 eO_6                 2.714998e-01 1 1  ON 26
 eO_7                -3.732287e-02 1 1  ON 27
 eO_8                -2.427648e-01 1 1  ON 28
 eO_9                -1.132868e-01 1 1  ON 29
eH1_0                -2.582564e-01 1 1  ON 30
eH1_1                -1.561958e-01 1 1  ON 31
eH1_2                -1.084986e-01 1 1  ON 32
eH1_3                -5.354986e-02 1 1  ON 33
eH1_4                -4.650770e-03 1 1  ON 34
eH1_5                 3.085761e-02 1 1  ON 35
eH1_6                 9.118039e-02 1 1  ON 36
eH1_7                 1.562073e-01 1 1  ON 37
eH1_8                 1.981128e-01 1 1  ON 38
eH1_9                 1.032716e-01 1 1  ON 39
eH2_0                -2.551613e-01 1 1  ON 40
eH2_1                -1.533306e-01 1 1  ON 41
eH2_2                -1.059156e-01 1 1  ON 42
eH2_3                -5.090396e-02 1 1  ON 43
eH2_4                -1.991466e-03 1 1  ON 44
eH2_5                 3.328164e-02 1 1  ON 45
eH2_6                 9.351748e-02 1 1  ON 46
eH2_7                 1.551781e-01 1 1  ON 47
eH2_8                 2.001833e-01 1 1  ON 48
eH2_9                 9.703679e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6928e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9278
    reference variance = 0.634605
====================================================
  Execution time = 2.0818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4635e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254642851
                                         uncertainty =       0.005300047370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254642851
                                         uncertainty =       0.005300047370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416140717
  error estimate for blocks of size 2^( 2) =       0.000428282399
  error estimate for blocks of size 2^( 3) =       0.000441473799
  error estimate for blocks of size 2^( 4) =       0.000452963139
  error estimate for blocks of size 2^( 5) =       0.000463524799
  error estimate for blocks of size 2^( 6) =       0.000470013078
  error estimate for blocks of size 2^( 7) =       0.000471756152

      target function =                  N/A
              le_mean =     -16.905595304926
             les_mean =     286.145498632653
             stat err =       0.000464564292
             autocorr =       1.246267383527
              std dev =       0.588511845165
             le_variance =       0.346346191899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559530493e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905595304926       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905596520218       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905596209884       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905595992906       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905595574110       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905594427945       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905596058927       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905596223207       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905596453896       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905596799726       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.801222e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905595304926       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595882143       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905595706125       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905595690325       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905595610252       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905595341968       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905595379915       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905595588303       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.543598e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905595304926       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595491116       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905595430152       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905595441560       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905595430979       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905595355001       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905595329501       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905595348740       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.170732e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6441e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.092131e-01 1 1  ON 0
 uu_1                 1.420596e-01 1 1  ON 1
 uu_2                 4.025052e-02 1 1  ON 2
 uu_3                -2.261124e-02 1 1  ON 3
 uu_4                -6.837587e-02 1 1  ON 4
 uu_5                -1.037074e-01 1 1  ON 5
 uu_6                -1.319008e-01 1 1  ON 6
 uu_7                -1.469122e-01 1 1  ON 7
 uu_8                -1.399383e-01 1 1  ON 8
 uu_9                -1.129457e-01 1 1  ON 9
 ud_0                 4.551559e-01 1 1  ON 10
 ud_1                 1.887908e-01 1 1  ON 11
 ud_2                 6.753372e-02 1 1  ON 12
 ud_3                -4.564681e-03 1 1  ON 13
 ud_4                -6.243746e-02 1 1  ON 14
 ud_5                -1.049941e-01 1 1  ON 15
 ud_6                -1.335209e-01 1 1  ON 16
 ud_7                -1.518307e-01 1 1  ON 17
 ud_8                -1.538284e-01 1 1  ON 18
 ud_9                -1.453945e-01 1 1  ON 19
 eO_0                -7.608789e-01 1 1  ON 20
 eO_1                -4.382609e-01 1 1  ON 21
 eO_2                -1.632347e-02 1 1  ON 22
 eO_3                 3.072599e-01 1 1  ON 23
 eO_4                 5.361662e-01 1 1  ON 24
 eO_5                 5.006379e-01 1 1  ON 25
 eO_6                 2.717316e-01 1 1  ON 26
 eO_7                -3.742889e-02 1 1  ON 27
 eO_8                -2.430363e-01 1 1  ON 28
 eO_9                -1.135861e-01 1 1  ON 29
eH1_0                -2.584246e-01 1 1  ON 30
eH1_1                -1.563172e-01 1 1  ON 31
eH1_2                -1.086321e-01 1 1  ON 32
eH1_3                -5.354381e-02 1 1  ON 33
eH1_4                -4.672002e-03 1 1  ON 34
eH1_5                 3.082818e-02 1 1  ON 35
eH1_6                 9.119487e-02 1 1  ON 36
eH1_7                 1.560151e-01 1 1  ON 37
eH1_8                 1.981973e-01 1 1  ON 38
eH1_9                 1.037260e-01 1 1  ON 39
eH2_0                -2.555923e-01 1 1  ON 40
eH2_1                -1.534545e-01 1 1  ON 41
eH2_2                -1.058919e-01 1 1  ON 42
eH2_3                -5.098287e-02 1 1  ON 43
eH2_4                -2.017563e-03 1 1  ON 44
eH2_5                 3.316023e-02 1 1  ON 45
eH2_6                 9.345233e-02 1 1  ON 46
eH2_7                 1.554202e-01 1 1  ON 47
eH2_8                 2.003012e-01 1 1  ON 48
eH2_9                 9.743695e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.869
    reference variance = 0.181797
====================================================
  Execution time = 2.0669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4348e-01
  Total weights = 2.0000e+06
  Execution time = 1.9166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343681406522
                                         uncertainty =       0.004548385900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343681406522
                                         uncertainty =       0.004548385900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414488694
  error estimate for blocks of size 2^( 2) =       0.000427624102
  error estimate for blocks of size 2^( 3) =       0.000440692555
  error estimate for blocks of size 2^( 4) =       0.000452571939
  error estimate for blocks of size 2^( 5) =       0.000462839314
  error estimate for blocks of size 2^( 6) =       0.000470917152
  error estimate for blocks of size 2^( 7) =       0.000477150110

      target function =                  N/A
              le_mean =     -16.906069531348
             les_mean =     286.158788581983
             stat err =       0.000465869629
             autocorr =       1.263291051573
              std dev =       0.586175532607
             le_variance =       0.343601755027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517752483
                                         uncertainty =       0.004547843913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517752483
                                         uncertainty =       0.004547843913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414389966
  error estimate for blocks of size 2^( 2) =       0.000427529979
  error estimate for blocks of size 2^( 3) =       0.000440601816
  error estimate for blocks of size 2^( 4) =       0.000452484868
  error estimate for blocks of size 2^( 5) =       0.000462754861
  error estimate for blocks of size 2^( 6) =       0.000470832094
  error estimate for blocks of size 2^( 7) =       0.000477064023

      target function =                  N/A
              le_mean =     -16.906069560756
             les_mean =     286.158625909617
             stat err =       0.000465783961
             autocorr =       1.263428292893
              std dev =       0.586035910357
             le_variance =       0.343438088228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343449560884
                                         uncertainty =       0.004547048423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343449560884
                                         uncertainty =       0.004547048423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414348836
  error estimate for blocks of size 2^( 2) =       0.000427491082
  error estimate for blocks of size 2^( 3) =       0.000440565094
  error estimate for blocks of size 2^( 4) =       0.000452450013
  error estimate for blocks of size 2^( 5) =       0.000462723409
  error estimate for blocks of size 2^( 6) =       0.000470802743
  error estimate for blocks of size 2^( 7) =       0.000477037171

      target function =                  N/A
              le_mean =     -16.906070213768
             les_mean =     286.158579817336
             stat err =       0.000465753334
             autocorr =       1.263512950289
              std dev =       0.585977743755
             le_variance =       0.343369916176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343630723707
                                         uncertainty =       0.004548062351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343630723707
                                         uncertainty =       0.004548062351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414458129
  error estimate for blocks of size 2^( 2) =       0.000427594860
  error estimate for blocks of size 2^( 3) =       0.000440664479
  error estimate for blocks of size 2^( 4) =       0.000452544890
  error estimate for blocks of size 2^( 5) =       0.000462813489
  error estimate for blocks of size 2^( 6) =       0.000470891756
  error estimate for blocks of size 2^( 7) =       0.000477125117

      target function =                  N/A
              le_mean =     -16.906069714522
             les_mean =     286.158744101167
             stat err =       0.000465843813
             autocorr =       1.263337362206
              std dev =       0.586132306461
             le_variance =       0.343551080677


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906069531348        initial
     9.7656e-02     9.7656e-01             1.8012e-03       -16.906069560756
     3.9062e-01     3.9062e+00             4.5436e-04       -16.906070213768  <--
     1.5625e+00     1.5625e+01             1.1707e-04       -16.906069714522

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 3.0269e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.092131e-01 1 1  ON 0
 uu_1                 1.420596e-01 1 1  ON 1
 uu_2                 4.025052e-02 1 1  ON 2
 uu_3                -2.261124e-02 1 1  ON 3
 uu_4                -6.837587e-02 1 1  ON 4
 uu_5                -1.037074e-01 1 1  ON 5
 uu_6                -1.319008e-01 1 1  ON 6
 uu_7                -1.469122e-01 1 1  ON 7
 uu_8                -1.399383e-01 1 1  ON 8
 uu_9                -1.129457e-01 1 1  ON 9
 ud_0                 4.551559e-01 1 1  ON 10
 ud_1                 1.887908e-01 1 1  ON 11
 ud_2                 6.753372e-02 1 1  ON 12
 ud_3                -4.564681e-03 1 1  ON 13
 ud_4                -6.243746e-02 1 1  ON 14
 ud_5                -1.049941e-01 1 1  ON 15
 ud_6                -1.335209e-01 1 1  ON 16
 ud_7                -1.518307e-01 1 1  ON 17
 ud_8                -1.538284e-01 1 1  ON 18
 ud_9                -1.453945e-01 1 1  ON 19
 eO_0                -7.608789e-01 1 1  ON 20
 eO_1                -4.382609e-01 1 1  ON 21
 eO_2                -1.632347e-02 1 1  ON 22
 eO_3                 3.072599e-01 1 1  ON 23
 eO_4                 5.361662e-01 1 1  ON 24
 eO_5                 5.006379e-01 1 1  ON 25
 eO_6                 2.717316e-01 1 1  ON 26
 eO_7                -3.742889e-02 1 1  ON 27
 eO_8                -2.430363e-01 1 1  ON 28
 eO_9                -1.135861e-01 1 1  ON 29
eH1_0                -2.584246e-01 1 1  ON 30
eH1_1                -1.563172e-01 1 1  ON 31
eH1_2                -1.086321e-01 1 1  ON 32
eH1_3                -5.354381e-02 1 1  ON 33
eH1_4                -4.672002e-03 1 1  ON 34
eH1_5                 3.082818e-02 1 1  ON 35
eH1_6                 9.119487e-02 1 1  ON 36
eH1_7                 1.560151e-01 1 1  ON 37
eH1_8                 1.981973e-01 1 1  ON 38
eH1_9                 1.037260e-01 1 1  ON 39
eH2_0                -2.555923e-01 1 1  ON 40
eH2_1                -1.534545e-01 1 1  ON 41
eH2_2                -1.058919e-01 1 1  ON 42
eH2_3                -5.098287e-02 1 1  ON 43
eH2_4                -2.017563e-03 1 1  ON 44
eH2_5                 3.316023e-02 1 1  ON 45
eH2_6                 9.345233e-02 1 1  ON 46
eH2_7                 1.554202e-01 1 1  ON 47
eH2_8                 2.003012e-01 1 1  ON 48
eH2_9                 9.743695e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8983
    reference variance = 1.00276
====================================================
  Execution time = 2.0781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3998e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339967259279
                                         uncertainty =       0.003803968800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339967259279
                                         uncertainty =       0.003803968800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412301223
  error estimate for blocks of size 2^( 2) =       0.000425267928
  error estimate for blocks of size 2^( 3) =       0.000438545408
  error estimate for blocks of size 2^( 4) =       0.000450683548
  error estimate for blocks of size 2^( 5) =       0.000461055633
  error estimate for blocks of size 2^( 6) =       0.000469173516
  error estimate for blocks of size 2^( 7) =       0.000473920044

      target function =                  N/A
              le_mean =     -16.906169052217
             les_mean =     286.158536448414
             stat err =       0.000463708185
             autocorr =       1.264911900507
              std dev =       0.583081980747
             le_variance =       0.339984596272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616905222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906169052217       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906170466370       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906169947525       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171752648       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906173151737       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906173118173       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171573806       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906173650632       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906172665519       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906173956260       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906173709241       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906173809349       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.336014e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906169052217       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906169701071       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906169290392       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906169835523       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171317418       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906170142689       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906170052655       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906170394160       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906170210768       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.701285e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906169052217       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906169257246       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906169081373       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906169133446       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906169415162       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906169576044       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906169309846       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906169367832       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.445021e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6467e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.089858e-01 1 1  ON 0
 uu_1                 1.420309e-01 1 1  ON 1
 uu_2                 4.021212e-02 1 1  ON 2
 uu_3                -2.271218e-02 1 1  ON 3
 uu_4                -6.850950e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.320130e-01 1 1  ON 6
 uu_7                -1.468880e-01 1 1  ON 7
 uu_8                -1.397901e-01 1 1  ON 8
 uu_9                -1.127937e-01 1 1  ON 9
 ud_0                 4.550089e-01 1 1  ON 10
 ud_1                 1.888565e-01 1 1  ON 11
 ud_2                 6.765740e-02 1 1  ON 12
 ud_3                -4.462436e-03 1 1  ON 13
 ud_4                -6.243246e-02 1 1  ON 14
 ud_5                -1.049505e-01 1 1  ON 15
 ud_6                -1.335479e-01 1 1  ON 16
 ud_7                -1.519750e-01 1 1  ON 17
 ud_8                -1.536441e-01 1 1  ON 18
 ud_9                -1.452603e-01 1 1  ON 19
 eO_0                -7.607758e-01 1 1  ON 20
 eO_1                -4.382407e-01 1 1  ON 21
 eO_2                -1.611120e-02 1 1  ON 22
 eO_3                 3.073238e-01 1 1  ON 23
 eO_4                 5.360890e-01 1 1  ON 24
 eO_5                 5.008437e-01 1 1  ON 25
 eO_6                 2.716911e-01 1 1  ON 26
 eO_7                -3.742371e-02 1 1  ON 27
 eO_8                -2.431305e-01 1 1  ON 28
 eO_9                -1.139060e-01 1 1  ON 29
eH1_0                -2.586785e-01 1 1  ON 30
eH1_1                -1.563730e-01 1 1  ON 31
eH1_2                -1.088095e-01 1 1  ON 32
eH1_3                -5.359603e-02 1 1  ON 33
eH1_4                -4.878848e-03 1 1  ON 34
eH1_5                 3.051760e-02 1 1  ON 35
eH1_6                 9.131281e-02 1 1  ON 36
eH1_7                 1.560312e-01 1 1  ON 37
eH1_8                 1.984270e-01 1 1  ON 38
eH1_9                 1.042961e-01 1 1  ON 39
eH2_0                -2.557766e-01 1 1  ON 40
eH2_1                -1.535221e-01 1 1  ON 41
eH2_2                -1.057639e-01 1 1  ON 42
eH2_3                -5.106494e-02 1 1  ON 43
eH2_4                -2.282544e-03 1 1  ON 44
eH2_5                 3.275451e-02 1 1  ON 45
eH2_6                 9.344825e-02 1 1  ON 46
eH2_7                 1.555465e-01 1 1  ON 47
eH2_8                 2.005135e-01 1 1  ON 48
eH2_9                 9.793725e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.378289
====================================================
  Execution time = 2.0729e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3255e-01
  Total weights = 2.0000e+06
  Execution time = 1.9061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332958344329
                                         uncertainty =       0.002914284278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332958344329
                                         uncertainty =       0.002914284278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407936842
  error estimate for blocks of size 2^( 2) =       0.000420683069
  error estimate for blocks of size 2^( 3) =       0.000433757775
  error estimate for blocks of size 2^( 4) =       0.000445962437
  error estimate for blocks of size 2^( 5) =       0.000456380486
  error estimate for blocks of size 2^( 6) =       0.000465312210
  error estimate for blocks of size 2^( 7) =       0.000470287314

      target function =                  N/A
              le_mean =     -16.905412573855
             les_mean =     286.125799059194
             stat err =       0.000459485612
             autocorr =       1.268697180405
              std dev =       0.576909813889
             le_variance =       0.332824933362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332538786951
                                         uncertainty =       0.002910651706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332538786951
                                         uncertainty =       0.002910651706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407679825
  error estimate for blocks of size 2^( 2) =       0.000420438673
  error estimate for blocks of size 2^( 3) =       0.000433527827
  error estimate for blocks of size 2^( 4) =       0.000445741831
  error estimate for blocks of size 2^( 5) =       0.000456163377
  error estimate for blocks of size 2^( 6) =       0.000465096037
  error estimate for blocks of size 2^( 7) =       0.000470072842

      target function =                  N/A
              le_mean =     -16.905415071708
             les_mean =     286.125464259384
             stat err =       0.000459268522
             autocorr =       1.269097301436
              std dev =       0.576546337130
             le_variance =       0.332405678858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414286561
                                         uncertainty =       0.002909376912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414286561
                                         uncertainty =       0.002909376912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407603532
  error estimate for blocks of size 2^( 2) =       0.000420365414
  error estimate for blocks of size 2^( 3) =       0.000433457859
  error estimate for blocks of size 2^( 4) =       0.000445674077
  error estimate for blocks of size 2^( 5) =       0.000456096356
  error estimate for blocks of size 2^( 6) =       0.000465031438
  error estimate for blocks of size 2^( 7) =       0.000470010421

      target function =                  N/A
              le_mean =     -16.905414775875
             les_mean =     286.125329856861
             stat err =       0.000459203073
             autocorr =       1.269210611007
              std dev =       0.576438443061
             le_variance =       0.332281278638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841505743
                                         uncertainty =       0.002913222415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841505743
                                         uncertainty =       0.002913222415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407865282
  error estimate for blocks of size 2^( 2) =       0.000420614692
  error estimate for blocks of size 2^( 3) =       0.000433692904
  error estimate for blocks of size 2^( 4) =       0.000445899886
  error estimate for blocks of size 2^( 5) =       0.000456318658
  error estimate for blocks of size 2^( 6) =       0.000465251142
  error estimate for blocks of size 2^( 7) =       0.000470227117

      target function =                  N/A
              le_mean =     -16.905412655935
             les_mean =     286.125685078082
             stat err =       0.000459424201
             autocorr =       1.268803178089
              std dev =       0.576808613844
             le_variance =       0.332708177004


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905412573855        initial
     9.7656e-02     9.7656e-01             2.3360e-03       -16.905415071708  <--
     3.9062e-01     3.9062e+00             5.7013e-04       -16.905414775875
     1.5625e+00     1.5625e+01             1.4450e-04       -16.905412655935

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.0281e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.086380e-01 1 1  ON 0
 uu_1                 1.418295e-01 1 1  ON 1
 uu_2                 3.998279e-02 1 1  ON 2
 uu_3                -2.297992e-02 1 1  ON 3
 uu_4                -6.880050e-02 1 1  ON 4
 uu_5                -1.042405e-01 1 1  ON 5
 uu_6                -1.322526e-01 1 1  ON 6
 uu_7                -1.469725e-01 1 1  ON 7
 uu_8                -1.396134e-01 1 1  ON 8
 uu_9                -1.124172e-01 1 1  ON 9
 ud_0                 4.550721e-01 1 1  ON 10
 ud_1                 1.890403e-01 1 1  ON 11
 ud_2                 6.784442e-02 1 1  ON 12
 ud_3                -4.258450e-03 1 1  ON 13
 ud_4                -6.231099e-02 1 1  ON 14
 ud_5                -1.048697e-01 1 1  ON 15
 ud_6                -1.335652e-01 1 1  ON 16
 ud_7                -1.521544e-01 1 1  ON 17
 ud_8                -1.534679e-01 1 1  ON 18
 ud_9                -1.449905e-01 1 1  ON 19
 eO_0                -7.604704e-01 1 1  ON 20
 eO_1                -4.379575e-01 1 1  ON 21
 eO_2                -1.560025e-02 1 1  ON 22
 eO_3                 3.076291e-01 1 1  ON 23
 eO_4                 5.360885e-01 1 1  ON 24
 eO_5                 5.011715e-01 1 1  ON 25
 eO_6                 2.716509e-01 1 1  ON 26
 eO_7                -3.746387e-02 1 1  ON 27
 eO_8                -2.435165e-01 1 1  ON 28
 eO_9                -1.149239e-01 1 1  ON 29
eH1_0                -2.592738e-01 1 1  ON 30
eH1_1                -1.567728e-01 1 1  ON 31
eH1_2                -1.092370e-01 1 1  ON 32
eH1_3                -5.397275e-02 1 1  ON 33
eH1_4                -5.380281e-03 1 1  ON 34
eH1_5                 2.982464e-02 1 1  ON 35
eH1_6                 9.141139e-02 1 1  ON 36
eH1_7                 1.560630e-01 1 1  ON 37
eH1_8                 1.991381e-01 1 1  ON 38
eH1_9                 1.060620e-01 1 1  ON 39
eH2_0                -2.561759e-01 1 1  ON 40
eH2_1                -1.537778e-01 1 1  ON 41
eH2_2                -1.058643e-01 1 1  ON 42
eH2_3                -5.133979e-02 1 1  ON 43
eH2_4                -2.849831e-03 1 1  ON 44
eH2_5                 3.191429e-02 1 1  ON 45
eH2_6                 9.324653e-02 1 1  ON 46
eH2_7                 1.558558e-01 1 1  ON 47
eH2_8                 2.011594e-01 1 1  ON 48
eH2_9                 9.948969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.829
    reference variance = 0.192722
====================================================
  Execution time = 2.1280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5307e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353065931140
                                         uncertainty =       0.015751909271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353065931140
                                         uncertainty =       0.015751909271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420161503
  error estimate for blocks of size 2^( 2) =       0.000432749174
  error estimate for blocks of size 2^( 3) =       0.000445665713
  error estimate for blocks of size 2^( 4) =       0.000458100167
  error estimate for blocks of size 2^( 5) =       0.000468442597
  error estimate for blocks of size 2^( 6) =       0.000475124687
  error estimate for blocks of size 2^( 7) =       0.000479915453

      target function =                  N/A
              le_mean =     -16.905567580404
             les_mean =     286.151286415503
             stat err =       0.000470395726
             autocorr =       1.253413071308
              std dev =       0.594198095264
             le_variance =       0.353071376416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556758040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905567580405       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567892206       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567650477       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905571089414       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905571208025       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568236404       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905572866616       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905573524623       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905575638565       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905575657321       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905575145554       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905575827148       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905576257178       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905575693289       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905576547261       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 7.816643e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905567580405       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567801037       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567317651       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905569434774       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905569346286       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568938846       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905570530522       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905569205011       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905570399153       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905570120350       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905570205319       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905570006007       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.976113e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905567580405       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567682099       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567201686       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905567707309       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905568012413       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568501464       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905567901317       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905567926410       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905568002792       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.887837e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6897e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.086353e-01 1 1  ON 0
 uu_1                 1.413693e-01 1 1  ON 1
 uu_2                 3.962469e-02 1 1  ON 2
 uu_3                -2.303642e-02 1 1  ON 3
 uu_4                -6.897171e-02 1 1  ON 4
 uu_5                -1.043616e-01 1 1  ON 5
 uu_6                -1.323970e-01 1 1  ON 6
 uu_7                -1.474235e-01 1 1  ON 7
 uu_8                -1.387989e-01 1 1  ON 8
 uu_9                -1.123588e-01 1 1  ON 9
 ud_0                 4.555456e-01 1 1  ON 10
 ud_1                 1.889546e-01 1 1  ON 11
 ud_2                 6.784393e-02 1 1  ON 12
 ud_3                -4.355233e-03 1 1  ON 13
 ud_4                -6.226930e-02 1 1  ON 14
 ud_5                -1.046732e-01 1 1  ON 15
 ud_6                -1.334111e-01 1 1  ON 16
 ud_7                -1.518438e-01 1 1  ON 17
 ud_8                -1.535745e-01 1 1  ON 18
 ud_9                -1.454585e-01 1 1  ON 19
 eO_0                -7.601819e-01 1 1  ON 20
 eO_1                -4.377432e-01 1 1  ON 21
 eO_2                -1.559942e-02 1 1  ON 22
 eO_3                 3.081479e-01 1 1  ON 23
 eO_4                 5.366107e-01 1 1  ON 24
 eO_5                 5.014740e-01 1 1  ON 25
 eO_6                 2.719963e-01 1 1  ON 26
 eO_7                -3.726625e-02 1 1  ON 27
 eO_8                -2.442835e-01 1 1  ON 28
 eO_9                -1.163098e-01 1 1  ON 29
eH1_0                -2.597463e-01 1 1  ON 30
eH1_1                -1.572850e-01 1 1  ON 31
eH1_2                -1.097923e-01 1 1  ON 32
eH1_3                -5.486211e-02 1 1  ON 33
eH1_4                -5.601847e-03 1 1  ON 34
eH1_5                 2.970633e-02 1 1  ON 35
eH1_6                 9.140802e-02 1 1  ON 36
eH1_7                 1.558624e-01 1 1  ON 37
eH1_8                 1.995722e-01 1 1  ON 38
eH1_9                 1.080381e-01 1 1  ON 39
eH2_0                -2.563048e-01 1 1  ON 40
eH2_1                -1.543063e-01 1 1  ON 41
eH2_2                -1.063121e-01 1 1  ON 42
eH2_3                -5.158821e-02 1 1  ON 43
eH2_4                -3.212762e-03 1 1  ON 44
eH2_5                 3.146747e-02 1 1  ON 45
eH2_6                 9.246105e-02 1 1  ON 46
eH2_7                 1.558649e-01 1 1  ON 47
eH2_8                 2.020114e-01 1 1  ON 48
eH2_9                 1.013015e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9102
    reference variance = 0.228257
====================================================
  Execution time = 2.0976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3767e-01
  Total weights = 2.0000e+06
  Execution time = 1.8990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337225960935
                                         uncertainty =       0.005034794266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337225960935
                                         uncertainty =       0.005034794266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410629491
  error estimate for blocks of size 2^( 2) =       0.000423844584
  error estimate for blocks of size 2^( 3) =       0.000437356758
  error estimate for blocks of size 2^( 4) =       0.000449931945
  error estimate for blocks of size 2^( 5) =       0.000460705917
  error estimate for blocks of size 2^( 6) =       0.000470481940
  error estimate for blocks of size 2^( 7) =       0.000473074492

      target function =                  N/A
              le_mean =     -16.905404942711
             les_mean =     286.129949266559
             stat err =       0.000463548573
             autocorr =       1.274354402907
              std dev =       0.580717795620
             le_variance =       0.337233158150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337692543154
                                         uncertainty =       0.005027062443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337692543154
                                         uncertainty =       0.005027062443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410913482
  error estimate for blocks of size 2^( 2) =       0.000424121475
  error estimate for blocks of size 2^( 3) =       0.000437630505
  error estimate for blocks of size 2^( 4) =       0.000450197251
  error estimate for blocks of size 2^( 5) =       0.000460967407
  error estimate for blocks of size 2^( 6) =       0.000470719001
  error estimate for blocks of size 2^( 7) =       0.000473301896

      target function =                  N/A
              le_mean =     -16.905407118403
             les_mean =     286.130489449671
             stat err =       0.000463796389
             autocorr =       1.273954578030
              std dev =       0.581119419370
             le_variance =       0.337699779569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338121234629
                                         uncertainty =       0.005019909489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338121234629
                                         uncertainty =       0.005019909489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411174230
  error estimate for blocks of size 2^( 2) =       0.000424373011
  error estimate for blocks of size 2^( 3) =       0.000437876310
  error estimate for blocks of size 2^( 4) =       0.000450437421
  error estimate for blocks of size 2^( 5) =       0.000461208518
  error estimate for blocks of size 2^( 6) =       0.000470957081
  error estimate for blocks of size 2^( 7) =       0.000473545949

      target function =                  N/A
              le_mean =     -16.905408254723
             les_mean =     286.130956584589
             stat err =       0.000464037242
             autocorr =       1.273661139963
              std dev =       0.581488172547
             le_variance =       0.338128494812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337501874738
                                         uncertainty =       0.005030541108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337501874738
                                         uncertainty =       0.005030541108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410797451
  error estimate for blocks of size 2^( 2) =       0.000424006623
  error estimate for blocks of size 2^( 3) =       0.000437515075
  error estimate for blocks of size 2^( 4) =       0.000450085040
  error estimate for blocks of size 2^( 5) =       0.000460858877
  error estimate for blocks of size 2^( 6) =       0.000470628698
  error estimate for blocks of size 2^( 7) =       0.000473221859

      target function =                  N/A
              le_mean =     -16.905404690839
             les_mean =     286.130216684196
             stat err =       0.000463698619
             autocorr =       1.274136988287
              std dev =       0.580955326948
             le_variance =       0.337509091909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905404942711        initial
     2.4414e-02     2.4414e-01             7.8166e-03       -16.905407118403
     9.7656e-02     9.7656e-01             1.9761e-03       -16.905408254723  <--
     3.9062e-01     3.9062e+00             4.8878e-04       -16.905404690839

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.0505e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.086353e-01 1 1  ON 0
 uu_1                 1.413693e-01 1 1  ON 1
 uu_2                 3.962469e-02 1 1  ON 2
 uu_3                -2.303642e-02 1 1  ON 3
 uu_4                -6.897171e-02 1 1  ON 4
 uu_5                -1.043616e-01 1 1  ON 5
 uu_6                -1.323970e-01 1 1  ON 6
 uu_7                -1.474235e-01 1 1  ON 7
 uu_8                -1.387989e-01 1 1  ON 8
 uu_9                -1.123588e-01 1 1  ON 9
 ud_0                 4.555456e-01 1 1  ON 10
 ud_1                 1.889546e-01 1 1  ON 11
 ud_2                 6.784393e-02 1 1  ON 12
 ud_3                -4.355233e-03 1 1  ON 13
 ud_4                -6.226930e-02 1 1  ON 14
 ud_5                -1.046732e-01 1 1  ON 15
 ud_6                -1.334111e-01 1 1  ON 16
 ud_7                -1.518438e-01 1 1  ON 17
 ud_8                -1.535745e-01 1 1  ON 18
 ud_9                -1.454585e-01 1 1  ON 19
 eO_0                -7.601819e-01 1 1  ON 20
 eO_1                -4.377432e-01 1 1  ON 21
 eO_2                -1.559942e-02 1 1  ON 22
 eO_3                 3.081479e-01 1 1  ON 23
 eO_4                 5.366107e-01 1 1  ON 24
 eO_5                 5.014740e-01 1 1  ON 25
 eO_6                 2.719963e-01 1 1  ON 26
 eO_7                -3.726625e-02 1 1  ON 27
 eO_8                -2.442835e-01 1 1  ON 28
 eO_9                -1.163098e-01 1 1  ON 29
eH1_0                -2.597463e-01 1 1  ON 30
eH1_1                -1.572850e-01 1 1  ON 31
eH1_2                -1.097923e-01 1 1  ON 32
eH1_3                -5.486211e-02 1 1  ON 33
eH1_4                -5.601847e-03 1 1  ON 34
eH1_5                 2.970633e-02 1 1  ON 35
eH1_6                 9.140802e-02 1 1  ON 36
eH1_7                 1.558624e-01 1 1  ON 37
eH1_8                 1.995722e-01 1 1  ON 38
eH1_9                 1.080381e-01 1 1  ON 39
eH2_0                -2.563048e-01 1 1  ON 40
eH2_1                -1.543063e-01 1 1  ON 41
eH2_2                -1.063121e-01 1 1  ON 42
eH2_3                -5.158821e-02 1 1  ON 43
eH2_4                -3.212762e-03 1 1  ON 44
eH2_5                 3.146747e-02 1 1  ON 45
eH2_6                 9.246105e-02 1 1  ON 46
eH2_7                 1.558649e-01 1 1  ON 47
eH2_8                 2.020114e-01 1 1  ON 48
eH2_9                 1.013015e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.897
    reference variance = 0.1395
====================================================
  Execution time = 2.0860e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3769e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337767807401
                                         uncertainty =       0.003372811313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337767807401
                                         uncertainty =       0.003372811313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410908419
  error estimate for blocks of size 2^( 2) =       0.000423694503
  error estimate for blocks of size 2^( 3) =       0.000436787165
  error estimate for blocks of size 2^( 4) =       0.000449310426
  error estimate for blocks of size 2^( 5) =       0.000460261842
  error estimate for blocks of size 2^( 6) =       0.000469283448
  error estimate for blocks of size 2^( 7) =       0.000474774535

      target function =                  N/A
              le_mean =     -16.906524384014
             les_mean =     286.168258036342
             stat err =       0.000463407563
             autocorr =       1.271850763339
              std dev =       0.581112259305
             le_variance =       0.337691457915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652438401e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906524384014       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906524375810       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906522143763       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906521601390       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906524372107       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906523647677       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906528579290       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906528287034       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906528968249       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906530143782       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906530108731       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906530863660       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906530398961       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906530096612       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906530524844       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906530524925       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 6.951472e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906524384014       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906524378068       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906522436201       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906522521026       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906524263400       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906523517566       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906525321737       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906524908422       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906525156589       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906525593308       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906525430646       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906525348011       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.744497e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906524384014       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906524381184       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906523176048       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906523410416       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906524297293       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906523842842       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906523771414       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906523768923       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906523916482       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.324356e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6521e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.084491e-01 1 1  ON 0
 uu_1                 1.418500e-01 1 1  ON 1
 uu_2                 3.992779e-02 1 1  ON 2
 uu_3                -2.282610e-02 1 1  ON 3
 uu_4                -6.870884e-02 1 1  ON 4
 uu_5                -1.046144e-01 1 1  ON 5
 uu_6                -1.331315e-01 1 1  ON 6
 uu_7                -1.485049e-01 1 1  ON 7
 uu_8                -1.398328e-01 1 1  ON 8
 uu_9                -1.122332e-01 1 1  ON 9
 ud_0                 4.550602e-01 1 1  ON 10
 ud_1                 1.888550e-01 1 1  ON 11
 ud_2                 6.771525e-02 1 1  ON 12
 ud_3                -4.411240e-03 1 1  ON 13
 ud_4                -6.212548e-02 1 1  ON 14
 ud_5                -1.043843e-01 1 1  ON 15
 ud_6                -1.328172e-01 1 1  ON 16
 ud_7                -1.512407e-01 1 1  ON 17
 ud_8                -1.531817e-01 1 1  ON 18
 ud_9                -1.450947e-01 1 1  ON 19
 eO_0                -7.599159e-01 1 1  ON 20
 eO_1                -4.373417e-01 1 1  ON 21
 eO_2                -1.540301e-02 1 1  ON 22
 eO_3                 3.083750e-01 1 1  ON 23
 eO_4                 5.367637e-01 1 1  ON 24
 eO_5                 5.018050e-01 1 1  ON 25
 eO_6                 2.726954e-01 1 1  ON 26
 eO_7                -3.744397e-02 1 1  ON 27
 eO_8                -2.448171e-01 1 1  ON 28
 eO_9                -1.175647e-01 1 1  ON 29
eH1_0                -2.607883e-01 1 1  ON 30
eH1_1                -1.581716e-01 1 1  ON 31
eH1_2                -1.103258e-01 1 1  ON 32
eH1_3                -5.511900e-02 1 1  ON 33
eH1_4                -6.008143e-03 1 1  ON 34
eH1_5                 2.911942e-02 1 1  ON 35
eH1_6                 9.098506e-02 1 1  ON 36
eH1_7                 1.564886e-01 1 1  ON 37
eH1_8                 2.007694e-01 1 1  ON 38
eH1_9                 1.097826e-01 1 1  ON 39
eH2_0                -2.565336e-01 1 1  ON 40
eH2_1                -1.548065e-01 1 1  ON 41
eH2_2                -1.070092e-01 1 1  ON 42
eH2_3                -5.221776e-02 1 1  ON 43
eH2_4                -3.819028e-03 1 1  ON 44
eH2_5                 3.140717e-02 1 1  ON 45
eH2_6                 9.261161e-02 1 1  ON 46
eH2_7                 1.562452e-01 1 1  ON 47
eH2_8                 2.028185e-01 1 1  ON 48
eH2_9                 1.026020e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8505
    reference variance = 0.115006
====================================================
  Execution time = 2.2878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3702e-01
  Total weights = 2.0000e+06
  Execution time = 1.8964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337502359194
                                         uncertainty =       0.002986062404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337502359194
                                         uncertainty =       0.002986062404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410735271
  error estimate for blocks of size 2^( 2) =       0.000423182899
  error estimate for blocks of size 2^( 3) =       0.000436501669
  error estimate for blocks of size 2^( 4) =       0.000448422316
  error estimate for blocks of size 2^( 5) =       0.000459163528
  error estimate for blocks of size 2^( 6) =       0.000467729528
  error estimate for blocks of size 2^( 7) =       0.000470871762

      target function =                  N/A
              le_mean =     -16.905765751075
             les_mean =     286.142322387384
             stat err =       0.000461546783
             autocorr =       1.262721164785
              std dev =       0.580867390958
             le_variance =       0.337406925879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063087683
                                         uncertainty =       0.002984595634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063087683
                                         uncertainty =       0.002984595634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410467976
  error estimate for blocks of size 2^( 2) =       0.000422929663
  error estimate for blocks of size 2^( 3) =       0.000436253756
  error estimate for blocks of size 2^( 4) =       0.000448181443
  error estimate for blocks of size 2^( 5) =       0.000458923408
  error estimate for blocks of size 2^( 6) =       0.000467487011
  error estimate for blocks of size 2^( 7) =       0.000470647871

      target function =                  N/A
              le_mean =     -16.905769436451
             les_mean =     286.142007988041
             stat err =       0.000461309933
             autocorr =       1.263068932606
              std dev =       0.580489378104
             le_variance =       0.336967918092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746984166
                                         uncertainty =       0.002983103564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746984166
                                         uncertainty =       0.002983103564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410275493
  error estimate for blocks of size 2^( 2) =       0.000422743338
  error estimate for blocks of size 2^( 3) =       0.000436071753
  error estimate for blocks of size 2^( 4) =       0.000448009072
  error estimate for blocks of size 2^( 5) =       0.000458763279
  error estimate for blocks of size 2^( 6) =       0.000467332172
  error estimate for blocks of size 2^( 7) =       0.000470510068

      target function =                  N/A
              le_mean =     -16.905770594282
             les_mean =     286.141731178367
             stat err =       0.000461153648
             autocorr =       1.263397882600
              std dev =       0.580217166402
             le_variance =       0.336651960188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337275296655
                                         uncertainty =       0.002985088210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337275296655
                                         uncertainty =       0.002985088210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410597111
  error estimate for blocks of size 2^( 2) =       0.000423050006
  error estimate for blocks of size 2^( 3) =       0.000436370610
  error estimate for blocks of size 2^( 4) =       0.000448295812
  error estimate for blocks of size 2^( 5) =       0.000459041065
  error estimate for blocks of size 2^( 6) =       0.000467609105
  error estimate for blocks of size 2^( 7) =       0.000470763278

      target function =                  N/A
              le_mean =     -16.905766159928
             les_mean =     286.142109259923
             stat err =       0.000461427315
             autocorr =       1.262917037212
              std dev =       0.580672002385
             le_variance =       0.337179974354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905765751075        initial
     2.4414e-02     2.4414e-01             6.9515e-03       -16.905769436451
     9.7656e-02     9.7656e-01             1.7445e-03       -16.905770594282  <--
     3.9062e-01     3.9062e+00             4.3244e-04       -16.905766159928

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.2426e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.084491e-01 1 1  ON 0
 uu_1                 1.418500e-01 1 1  ON 1
 uu_2                 3.992779e-02 1 1  ON 2
 uu_3                -2.282610e-02 1 1  ON 3
 uu_4                -6.870884e-02 1 1  ON 4
 uu_5                -1.046144e-01 1 1  ON 5
 uu_6                -1.331315e-01 1 1  ON 6
 uu_7                -1.485049e-01 1 1  ON 7
 uu_8                -1.398328e-01 1 1  ON 8
 uu_9                -1.122332e-01 1 1  ON 9
 ud_0                 4.550602e-01 1 1  ON 10
 ud_1                 1.888550e-01 1 1  ON 11
 ud_2                 6.771525e-02 1 1  ON 12
 ud_3                -4.411240e-03 1 1  ON 13
 ud_4                -6.212548e-02 1 1  ON 14
 ud_5                -1.043843e-01 1 1  ON 15
 ud_6                -1.328172e-01 1 1  ON 16
 ud_7                -1.512407e-01 1 1  ON 17
 ud_8                -1.531817e-01 1 1  ON 18
 ud_9                -1.450947e-01 1 1  ON 19
 eO_0                -7.599159e-01 1 1  ON 20
 eO_1                -4.373417e-01 1 1  ON 21
 eO_2                -1.540301e-02 1 1  ON 22
 eO_3                 3.083750e-01 1 1  ON 23
 eO_4                 5.367637e-01 1 1  ON 24
 eO_5                 5.018050e-01 1 1  ON 25
 eO_6                 2.726954e-01 1 1  ON 26
 eO_7                -3.744397e-02 1 1  ON 27
 eO_8                -2.448171e-01 1 1  ON 28
 eO_9                -1.175647e-01 1 1  ON 29
eH1_0                -2.607883e-01 1 1  ON 30
eH1_1                -1.581716e-01 1 1  ON 31
eH1_2                -1.103258e-01 1 1  ON 32
eH1_3                -5.511900e-02 1 1  ON 33
eH1_4                -6.008143e-03 1 1  ON 34
eH1_5                 2.911942e-02 1 1  ON 35
eH1_6                 9.098506e-02 1 1  ON 36
eH1_7                 1.564886e-01 1 1  ON 37
eH1_8                 2.007694e-01 1 1  ON 38
eH1_9                 1.097826e-01 1 1  ON 39
eH2_0                -2.565336e-01 1 1  ON 40
eH2_1                -1.548065e-01 1 1  ON 41
eH2_2                -1.070092e-01 1 1  ON 42
eH2_3                -5.221776e-02 1 1  ON 43
eH2_4                -3.819028e-03 1 1  ON 44
eH2_5                 3.140717e-02 1 1  ON 45
eH2_6                 9.261161e-02 1 1  ON 46
eH2_7                 1.562452e-01 1 1  ON 47
eH2_8                 2.028185e-01 1 1  ON 48
eH2_9                 1.026020e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8953e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9013
    reference variance = 0.264193
====================================================
  Execution time = 2.0832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4921e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348875384201
                                         uncertainty =       0.007188252106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348875384201
                                         uncertainty =       0.007188252106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417858969
  error estimate for blocks of size 2^( 2) =       0.000430367016
  error estimate for blocks of size 2^( 3) =       0.000443095062
  error estimate for blocks of size 2^( 4) =       0.000455289811
  error estimate for blocks of size 2^( 5) =       0.000466028068
  error estimate for blocks of size 2^( 6) =       0.000474695359
  error estimate for blocks of size 2^( 7) =       0.000481656492

      target function =                  N/A
              le_mean =     -16.906180207192
             les_mean =     286.168141260149
             stat err =       0.000469417432
             autocorr =       1.261998880099
              std dev =       0.590941821770
             le_variance =       0.349212236717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618020719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906180207192       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906185331891       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906185650581       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906188696854       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906189215903       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187685025       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906189365606       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906192462377       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906192165657       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906192732902       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906193210464       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906192718199       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906193167578       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906192569542       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906192295728       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906192452527       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906192603678       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 6.962018e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906180207192       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906184045658       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906184359025       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906186114537       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186034198       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906185364605       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906186250705       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906186827396       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906187204376       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906186824207       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906187102142       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906186824805       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.717037e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906180207192       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906182122643       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906182450998       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906182493165       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906182516297       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906182925174       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906182552219       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906182888833       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906182867862       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.090438e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6401e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.087182e-01 1 1  ON 0
 uu_1                 1.417302e-01 1 1  ON 1
 uu_2                 3.991464e-02 1 1  ON 2
 uu_3                -2.311737e-02 1 1  ON 3
 uu_4                -6.908761e-02 1 1  ON 4
 uu_5                -1.044184e-01 1 1  ON 5
 uu_6                -1.330984e-01 1 1  ON 6
 uu_7                -1.486211e-01 1 1  ON 7
 uu_8                -1.407552e-01 1 1  ON 8
 uu_9                -1.123553e-01 1 1  ON 9
 ud_0                 4.556000e-01 1 1  ON 10
 ud_1                 1.891115e-01 1 1  ON 11
 ud_2                 6.799224e-02 1 1  ON 12
 ud_3                -3.975552e-03 1 1  ON 13
 ud_4                -6.176458e-02 1 1  ON 14
 ud_5                -1.044742e-01 1 1  ON 15
 ud_6                -1.328805e-01 1 1  ON 16
 ud_7                -1.512206e-01 1 1  ON 17
 ud_8                -1.535755e-01 1 1  ON 18
 ud_9                -1.455157e-01 1 1  ON 19
 eO_0                -7.590261e-01 1 1  ON 20
 eO_1                -4.363845e-01 1 1  ON 21
 eO_2                -1.499305e-02 1 1  ON 22
 eO_3                 3.081198e-01 1 1  ON 23
 eO_4                 5.372821e-01 1 1  ON 24
 eO_5                 5.007539e-01 1 1  ON 25
 eO_6                 2.729171e-01 1 1  ON 26
 eO_7                -3.728209e-02 1 1  ON 27
 eO_8                -2.452403e-01 1 1  ON 28
 eO_9                -1.187326e-01 1 1  ON 29
eH1_0                -2.607513e-01 1 1  ON 30
eH1_1                -1.585364e-01 1 1  ON 31
eH1_2                -1.109158e-01 1 1  ON 32
eH1_3                -5.580060e-02 1 1  ON 33
eH1_4                -6.988814e-03 1 1  ON 34
eH1_5                 2.886387e-02 1 1  ON 35
eH1_6                 9.118946e-02 1 1  ON 36
eH1_7                 1.563718e-01 1 1  ON 37
eH1_8                 2.013311e-01 1 1  ON 38
eH1_9                 1.114996e-01 1 1  ON 39
eH2_0                -2.572781e-01 1 1  ON 40
eH2_1                -1.555601e-01 1 1  ON 41
eH2_2                -1.077409e-01 1 1  ON 42
eH2_3                -5.270023e-02 1 1  ON 43
eH2_4                -4.154971e-03 1 1  ON 44
eH2_5                 3.201751e-02 1 1  ON 45
eH2_6                 9.271198e-02 1 1  ON 46
eH2_7                 1.564523e-01 1 1  ON 47
eH2_8                 2.031142e-01 1 1  ON 48
eH2_9                 1.039717e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9584
    reference variance = 0.241638
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3616e-01
  Total weights = 2.0000e+06
  Execution time = 1.8955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335794797628
                                         uncertainty =       0.002845423533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335794797628
                                         uncertainty =       0.002845423533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409737527
  error estimate for blocks of size 2^( 2) =       0.000422516218
  error estimate for blocks of size 2^( 3) =       0.000435519386
  error estimate for blocks of size 2^( 4) =       0.000448341039
  error estimate for blocks of size 2^( 5) =       0.000459420164
  error estimate for blocks of size 2^( 6) =       0.000467208467
  error estimate for blocks of size 2^( 7) =       0.000471652199

      target function =                  N/A
              le_mean =     -16.906590861062
             les_mean =     286.168584057897
             stat err =       0.000461655467
             autocorr =       1.269475964043
              std dev =       0.579456368029
             le_variance =       0.335769682450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336206619277
                                         uncertainty =       0.002847134281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336206619277
                                         uncertainty =       0.002847134281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409988888
  error estimate for blocks of size 2^( 2) =       0.000422745113
  error estimate for blocks of size 2^( 3) =       0.000435723931
  error estimate for blocks of size 2^( 4) =       0.000448526427
  error estimate for blocks of size 2^( 5) =       0.000459604788
  error estimate for blocks of size 2^( 6) =       0.000467408369
  error estimate for blocks of size 2^( 7) =       0.000471871434

      target function =                  N/A
              le_mean =     -16.906583026315
             les_mean =     286.168731234347
             stat err =       0.000461852755
             autocorr =       1.269003745234
              std dev =       0.579811845981
             le_variance =       0.336181776740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336595902110
                                         uncertainty =       0.002849505956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336595902110
                                         uncertainty =       0.002849505956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410226192
  error estimate for blocks of size 2^( 2) =       0.000422972852
  error estimate for blocks of size 2^( 3) =       0.000435939073
  error estimate for blocks of size 2^( 4) =       0.000448731164
  error estimate for blocks of size 2^( 5) =       0.000459805197
  error estimate for blocks of size 2^( 6) =       0.000467612351
  error estimate for blocks of size 2^( 7) =       0.000472075235

      target function =                  N/A
              le_mean =     -16.906581612891
             les_mean =     286.169072721730
             stat err =       0.000462055987
             autocorr =       1.268651779726
              std dev =       0.580147443905
             le_variance =       0.336571056670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336033726111
                                         uncertainty =       0.002846565555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336033726111
                                         uncertainty =       0.002846565555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409883322
  error estimate for blocks of size 2^( 2) =       0.000422652647
  error estimate for blocks of size 2^( 3) =       0.000435644647
  error estimate for blocks of size 2^( 4) =       0.000448457992
  error estimate for blocks of size 2^( 5) =       0.000459534047
  error estimate for blocks of size 2^( 6) =       0.000467325468
  error estimate for blocks of size 2^( 7) =       0.000471772973

      target function =                  N/A
              le_mean =     -16.906586907751
             les_mean =     286.168689376487
             stat err =       0.000461772620
             autocorr =       1.269216948797
              std dev =       0.579662552816
             le_variance =       0.336008675137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906590861062        initial  <--
     2.4414e-02     2.4414e-01             6.9620e-03       -16.906583026315
     9.7656e-02     9.7656e-01             1.7170e-03       -16.906581612891
     3.9062e-01     3.9062e+00             4.0904e-04       -16.906586907751

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9556
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.084491e-01 1 1  ON 0
 uu_1                 1.418500e-01 1 1  ON 1
 uu_2                 3.992779e-02 1 1  ON 2
 uu_3                -2.282610e-02 1 1  ON 3
 uu_4                -6.870884e-02 1 1  ON 4
 uu_5                -1.046144e-01 1 1  ON 5
 uu_6                -1.331315e-01 1 1  ON 6
 uu_7                -1.485049e-01 1 1  ON 7
 uu_8                -1.398328e-01 1 1  ON 8
 uu_9                -1.122332e-01 1 1  ON 9
 ud_0                 4.550602e-01 1 1  ON 10
 ud_1                 1.888550e-01 1 1  ON 11
 ud_2                 6.771525e-02 1 1  ON 12
 ud_3                -4.411240e-03 1 1  ON 13
 ud_4                -6.212548e-02 1 1  ON 14
 ud_5                -1.043843e-01 1 1  ON 15
 ud_6                -1.328172e-01 1 1  ON 16
 ud_7                -1.512407e-01 1 1  ON 17
 ud_8                -1.531817e-01 1 1  ON 18
 ud_9                -1.450947e-01 1 1  ON 19
 eO_0                -7.599159e-01 1 1  ON 20
 eO_1                -4.373417e-01 1 1  ON 21
 eO_2                -1.540301e-02 1 1  ON 22
 eO_3                 3.083750e-01 1 1  ON 23
 eO_4                 5.367637e-01 1 1  ON 24
 eO_5                 5.018050e-01 1 1  ON 25
 eO_6                 2.726954e-01 1 1  ON 26
 eO_7                -3.744397e-02 1 1  ON 27
 eO_8                -2.448171e-01 1 1  ON 28
 eO_9                -1.175647e-01 1 1  ON 29
eH1_0                -2.607883e-01 1 1  ON 30
eH1_1                -1.581716e-01 1 1  ON 31
eH1_2                -1.103258e-01 1 1  ON 32
eH1_3                -5.511900e-02 1 1  ON 33
eH1_4                -6.008143e-03 1 1  ON 34
eH1_5                 2.911942e-02 1 1  ON 35
eH1_6                 9.098506e-02 1 1  ON 36
eH1_7                 1.564886e-01 1 1  ON 37
eH1_8                 2.007694e-01 1 1  ON 38
eH1_9                 1.097826e-01 1 1  ON 39
eH2_0                -2.565336e-01 1 1  ON 40
eH2_1                -1.548065e-01 1 1  ON 41
eH2_2                -1.070092e-01 1 1  ON 42
eH2_3                -5.221776e-02 1 1  ON 43
eH2_4                -3.819028e-03 1 1  ON 44
eH2_5                 3.140717e-02 1 1  ON 45
eH2_6                 9.261161e-02 1 1  ON 46
eH2_7                 1.562452e-01 1 1  ON 47
eH2_8                 2.028185e-01 1 1  ON 48
eH2_9                 1.026020e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9415
    reference variance = 0.264606
====================================================
  Execution time = 2.1062e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4127e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341280771474
                                         uncertainty =       0.005237466103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341280771474
                                         uncertainty =       0.005237466103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413082557
  error estimate for blocks of size 2^( 2) =       0.000425821493
  error estimate for blocks of size 2^( 3) =       0.000439382891
  error estimate for blocks of size 2^( 4) =       0.000452302205
  error estimate for blocks of size 2^( 5) =       0.000464175810
  error estimate for blocks of size 2^( 6) =       0.000473912794
  error estimate for blocks of size 2^( 7) =       0.000477275869

      target function =                  N/A
              le_mean =     -16.905697558677
             les_mean =     286.143884173055
             stat err =       0.000466916669
             autocorr =       1.277629832251
              std dev =       0.584186954873
             le_variance =       0.341274398244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569755868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905697558677       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905696987434       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905696660920       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905695919390       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905696560746       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905696018574       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905696660772       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905697139906       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905696745374       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 6.593738e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905697558677       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905697346474       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905696998459       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905696845265       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905697040720       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905696862516       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905696910426       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905697033313       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.696117e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905697558677       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905697498291       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905697370560       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905697361227       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905697370876       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905697325858       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905697345935       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905697362591       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.474881e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6672e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.084678e-01 1 1  ON 0
 uu_1                 1.418502e-01 1 1  ON 1
 uu_2                 3.993113e-02 1 1  ON 2
 uu_3                -2.283750e-02 1 1  ON 3
 uu_4                -6.871444e-02 1 1  ON 4
 uu_5                -1.046296e-01 1 1  ON 5
 uu_6                -1.331575e-01 1 1  ON 6
 uu_7                -1.484596e-01 1 1  ON 7
 uu_8                -1.398909e-01 1 1  ON 8
 uu_9                -1.122700e-01 1 1  ON 9
 ud_0                 4.551656e-01 1 1  ON 10
 ud_1                 1.889001e-01 1 1  ON 11
 ud_2                 6.769386e-02 1 1  ON 12
 ud_3                -4.426105e-03 1 1  ON 13
 ud_4                -6.213610e-02 1 1  ON 14
 ud_5                -1.043578e-01 1 1  ON 15
 ud_6                -1.328987e-01 1 1  ON 16
 ud_7                -1.512329e-01 1 1  ON 17
 ud_8                -1.531999e-01 1 1  ON 18
 ud_9                -1.450910e-01 1 1  ON 19
 eO_0                -7.599545e-01 1 1  ON 20
 eO_1                -4.373256e-01 1 1  ON 21
 eO_2                -1.526286e-02 1 1  ON 22
 eO_3                 3.083651e-01 1 1  ON 23
 eO_4                 5.368329e-01 1 1  ON 24
 eO_5                 5.018219e-01 1 1  ON 25
 eO_6                 2.727253e-01 1 1  ON 26
 eO_7                -3.747256e-02 1 1  ON 27
 eO_8                -2.448823e-01 1 1  ON 28
 eO_9                -1.176641e-01 1 1  ON 29
eH1_0                -2.608404e-01 1 1  ON 30
eH1_1                -1.581304e-01 1 1  ON 31
eH1_2                -1.103706e-01 1 1  ON 32
eH1_3                -5.521101e-02 1 1  ON 33
eH1_4                -6.177755e-03 1 1  ON 34
eH1_5                 2.910539e-02 1 1  ON 35
eH1_6                 9.109847e-02 1 1  ON 36
eH1_7                 1.565123e-01 1 1  ON 37
eH1_8                 2.007915e-01 1 1  ON 38
eH1_9                 1.099206e-01 1 1  ON 39
eH2_0                -2.565977e-01 1 1  ON 40
eH2_1                -1.548799e-01 1 1  ON 41
eH2_2                -1.070194e-01 1 1  ON 42
eH2_3                -5.230343e-02 1 1  ON 43
eH2_4                -3.812481e-03 1 1  ON 44
eH2_5                 3.136811e-02 1 1  ON 45
eH2_6                 9.259003e-02 1 1  ON 46
eH2_7                 1.562976e-01 1 1  ON 47
eH2_8                 2.028374e-01 1 1  ON 48
eH2_9                 1.027671e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9502
    reference variance = 0.462173
====================================================
  Execution time = 2.0748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5021e-01
  Total weights = 2.0000e+06
  Execution time = 1.9387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350118663966
                                         uncertainty =       0.006315778626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350118663966
                                         uncertainty =       0.006315778626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418394626
  error estimate for blocks of size 2^( 2) =       0.000430599960
  error estimate for blocks of size 2^( 3) =       0.000443499326
  error estimate for blocks of size 2^( 4) =       0.000456637094
  error estimate for blocks of size 2^( 5) =       0.000467949443
  error estimate for blocks of size 2^( 6) =       0.000476459152
  error estimate for blocks of size 2^( 7) =       0.000480933482

      target function =                  N/A
              le_mean =     -16.906582259802
             les_mean =     286.182631657898
             stat err =       0.000470494792
             autocorr =       1.264554196626
              std dev =       0.591699353978
             le_variance =       0.350108125498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350368055752
                                         uncertainty =       0.006320087349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350368055752
                                         uncertainty =       0.006320087349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418543719
  error estimate for blocks of size 2^( 2) =       0.000430740671
  error estimate for blocks of size 2^( 3) =       0.000443631364
  error estimate for blocks of size 2^( 4) =       0.000456761588
  error estimate for blocks of size 2^( 5) =       0.000468065732
  error estimate for blocks of size 2^( 6) =       0.000476568298
  error estimate for blocks of size 2^( 7) =       0.000481036805

      target function =                  N/A
              le_mean =     -16.906580967330
             les_mean =     286.182837518844
             stat err =       0.000470608106
             autocorr =       1.264262189043
              std dev =       0.591910203598
             le_variance =       0.350357689123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350329618416
                                         uncertainty =       0.006319332489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350329618416
                                         uncertainty =       0.006319332489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418520748
  error estimate for blocks of size 2^( 2) =       0.000430718847
  error estimate for blocks of size 2^( 3) =       0.000443610904
  error estimate for blocks of size 2^( 4) =       0.000456742687
  error estimate for blocks of size 2^( 5) =       0.000468048764
  error estimate for blocks of size 2^( 6) =       0.000476552348
  error estimate for blocks of size 2^( 7) =       0.000481022569

      target function =                  N/A
              le_mean =     -16.906581401251
             les_mean =     286.182813734897
             stat err =       0.000470591592
             autocorr =       1.264312238776
              std dev =       0.591877717880
             le_variance =       0.350319232922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350149927567
                                         uncertainty =       0.006316292957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350149927567
                                         uncertainty =       0.006316292957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418413321
  error estimate for blocks of size 2^( 2) =       0.000430617557
  error estimate for blocks of size 2^( 3) =       0.000443515814
  error estimate for blocks of size 2^( 4) =       0.000456652692
  error estimate for blocks of size 2^( 5) =       0.000467964129
  error estimate for blocks of size 2^( 6) =       0.000476472876
  error estimate for blocks of size 2^( 7) =       0.000480946665

      target function =                  N/A
              le_mean =     -16.906582100034
             les_mean =     286.182657543787
             stat err =       0.000470509090
             autocorr =       1.264518048386
              std dev =       0.591725792620
             le_variance =       0.350139413652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906582259802        initial  <--
     2.4414e-01     2.4414e+00             6.5937e-04       -16.906580967330
     9.7656e-01     9.7656e+00             1.6961e-04       -16.906581401251
     3.9062e+00     3.9062e+01             4.4749e-05       -16.906582100034

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3845
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.084491e-01 1 1  ON 0
 uu_1                 1.418500e-01 1 1  ON 1
 uu_2                 3.992779e-02 1 1  ON 2
 uu_3                -2.282610e-02 1 1  ON 3
 uu_4                -6.870884e-02 1 1  ON 4
 uu_5                -1.046144e-01 1 1  ON 5
 uu_6                -1.331315e-01 1 1  ON 6
 uu_7                -1.485049e-01 1 1  ON 7
 uu_8                -1.398328e-01 1 1  ON 8
 uu_9                -1.122332e-01 1 1  ON 9
 ud_0                 4.550602e-01 1 1  ON 10
 ud_1                 1.888550e-01 1 1  ON 11
 ud_2                 6.771525e-02 1 1  ON 12
 ud_3                -4.411240e-03 1 1  ON 13
 ud_4                -6.212548e-02 1 1  ON 14
 ud_5                -1.043843e-01 1 1  ON 15
 ud_6                -1.328172e-01 1 1  ON 16
 ud_7                -1.512407e-01 1 1  ON 17
 ud_8                -1.531817e-01 1 1  ON 18
 ud_9                -1.450947e-01 1 1  ON 19
 eO_0                -7.599159e-01 1 1  ON 20
 eO_1                -4.373417e-01 1 1  ON 21
 eO_2                -1.540301e-02 1 1  ON 22
 eO_3                 3.083750e-01 1 1  ON 23
 eO_4                 5.367637e-01 1 1  ON 24
 eO_5                 5.018050e-01 1 1  ON 25
 eO_6                 2.726954e-01 1 1  ON 26
 eO_7                -3.744397e-02 1 1  ON 27
 eO_8                -2.448171e-01 1 1  ON 28
 eO_9                -1.175647e-01 1 1  ON 29
eH1_0                -2.607883e-01 1 1  ON 30
eH1_1                -1.581716e-01 1 1  ON 31
eH1_2                -1.103258e-01 1 1  ON 32
eH1_3                -5.511900e-02 1 1  ON 33
eH1_4                -6.008143e-03 1 1  ON 34
eH1_5                 2.911942e-02 1 1  ON 35
eH1_6                 9.098506e-02 1 1  ON 36
eH1_7                 1.564886e-01 1 1  ON 37
eH1_8                 2.007694e-01 1 1  ON 38
eH1_9                 1.097826e-01 1 1  ON 39
eH2_0                -2.565336e-01 1 1  ON 40
eH2_1                -1.548065e-01 1 1  ON 41
eH2_2                -1.070092e-01 1 1  ON 42
eH2_3                -5.221776e-02 1 1  ON 43
eH2_4                -3.819028e-03 1 1  ON 44
eH2_5                 3.140717e-02 1 1  ON 45
eH2_6                 9.261161e-02 1 1  ON 46
eH2_7                 1.562452e-01 1 1  ON 47
eH2_8                 2.028185e-01 1 1  ON 48
eH2_9                 1.026020e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8645
    reference variance = 0.228347
====================================================
  Execution time = 2.0856e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4181e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341880916691
                                         uncertainty =       0.004985264319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341880916691
                                         uncertainty =       0.004985264319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413409011
  error estimate for blocks of size 2^( 2) =       0.000425932110
  error estimate for blocks of size 2^( 3) =       0.000438773832
  error estimate for blocks of size 2^( 4) =       0.000450979934
  error estimate for blocks of size 2^( 5) =       0.000462561394
  error estimate for blocks of size 2^( 6) =       0.000469897459
  error estimate for blocks of size 2^( 7) =       0.000475204039

      target function =                  N/A
              le_mean =     -16.905484679588
             les_mean =     286.137226101637
             stat err =       0.000464660706
             autocorr =       1.263316066805
              std dev =       0.584648630173
             le_variance =       0.341814020764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548467959e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905484679588       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905484748101       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905484689810       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905484524358       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905484641141       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905484647923       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905484716443       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905484725673       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.565738e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905484679588       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905484697432       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905484680881       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905484636034       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905484665577       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905484665558       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905484682738       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905484683490       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.353514e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905484679588       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905484684096       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905484679817       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905484668350       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905484675711       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905484675608       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905484679919       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905484679990       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.034378e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6495e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.084502e-01 1 1  ON 0
 uu_1                 1.418497e-01 1 1  ON 1
 uu_2                 3.993144e-02 1 1  ON 2
 uu_3                -2.282777e-02 1 1  ON 3
 uu_4                -6.871514e-02 1 1  ON 4
 uu_5                -1.046122e-01 1 1  ON 5
 uu_6                -1.331376e-01 1 1  ON 6
 uu_7                -1.485029e-01 1 1  ON 7
 uu_8                -1.398365e-01 1 1  ON 8
 uu_9                -1.122376e-01 1 1  ON 9
 ud_0                 4.550837e-01 1 1  ON 10
 ud_1                 1.888560e-01 1 1  ON 11
 ud_2                 6.770760e-02 1 1  ON 12
 ud_3                -4.406443e-03 1 1  ON 13
 ud_4                -6.212796e-02 1 1  ON 14
 ud_5                -1.043880e-01 1 1  ON 15
 ud_6                -1.328221e-01 1 1  ON 16
 ud_7                -1.512576e-01 1 1  ON 17
 ud_8                -1.531734e-01 1 1  ON 18
 ud_9                -1.450834e-01 1 1  ON 19
 eO_0                -7.599119e-01 1 1  ON 20
 eO_1                -4.373443e-01 1 1  ON 21
 eO_2                -1.538383e-02 1 1  ON 22
 eO_3                 3.083669e-01 1 1  ON 23
 eO_4                 5.367724e-01 1 1  ON 24
 eO_5                 5.018056e-01 1 1  ON 25
 eO_6                 2.726970e-01 1 1  ON 26
 eO_7                -3.744827e-02 1 1  ON 27
 eO_8                -2.448239e-01 1 1  ON 28
 eO_9                -1.175742e-01 1 1  ON 29
eH1_0                -2.607775e-01 1 1  ON 30
eH1_1                -1.581751e-01 1 1  ON 31
eH1_2                -1.103320e-01 1 1  ON 32
eH1_3                -5.513257e-02 1 1  ON 33
eH1_4                -6.021180e-03 1 1  ON 34
eH1_5                 2.911560e-02 1 1  ON 35
eH1_6                 9.098732e-02 1 1  ON 36
eH1_7                 1.564842e-01 1 1  ON 37
eH1_8                 2.007774e-01 1 1  ON 38
eH1_9                 1.098025e-01 1 1  ON 39
eH2_0                -2.565421e-01 1 1  ON 40
eH2_1                -1.548059e-01 1 1  ON 41
eH2_2                -1.070204e-01 1 1  ON 42
eH2_3                -5.222391e-02 1 1  ON 43
eH2_4                -3.813899e-03 1 1  ON 44
eH2_5                 3.140474e-02 1 1  ON 45
eH2_6                 9.261633e-02 1 1  ON 46
eH2_7                 1.562450e-01 1 1  ON 47
eH2_8                 2.028186e-01 1 1  ON 48
eH2_9                 1.026179e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9424
    reference variance = 0.314808
====================================================
  Execution time = 2.0348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3785e-01
  Total weights = 2.0000e+06
  Execution time = 1.9102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337787807617
                                         uncertainty =       0.002842129577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337787807617
                                         uncertainty =       0.002842129577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410990823
  error estimate for blocks of size 2^( 2) =       0.000423400996
  error estimate for blocks of size 2^( 3) =       0.000436302660
  error estimate for blocks of size 2^( 4) =       0.000449544847
  error estimate for blocks of size 2^( 5) =       0.000461555527
  error estimate for blocks of size 2^( 6) =       0.000468058164
  error estimate for blocks of size 2^( 7) =       0.000473458322

      target function =                  N/A
              le_mean =     -16.906037966018
             les_mean =     286.151946453515
             stat err =       0.000463154215
             autocorr =       1.269951078229
              std dev =       0.581228796595
             le_variance =       0.337826913992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337878998453
                                         uncertainty =       0.002842646091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337878998453
                                         uncertainty =       0.002842646091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411046287
  error estimate for blocks of size 2^( 2) =       0.000423452853
  error estimate for blocks of size 2^( 3) =       0.000436350484
  error estimate for blocks of size 2^( 4) =       0.000449590502
  error estimate for blocks of size 2^( 5) =       0.000461599313
  error estimate for blocks of size 2^( 6) =       0.000468101050
  error estimate for blocks of size 2^( 7) =       0.000473500653

      target function =                  N/A
              le_mean =     -16.906038161303
             les_mean =     286.152044242941
             stat err =       0.000463197879
             autocorr =       1.269847783364
              std dev =       0.581307234154
             le_variance =       0.337918100479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337838473103
                                         uncertainty =       0.002842412994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337838473103
                                         uncertainty =       0.002842412994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411021640
  error estimate for blocks of size 2^( 2) =       0.000423429792
  error estimate for blocks of size 2^( 3) =       0.000436329213
  error estimate for blocks of size 2^( 4) =       0.000449570199
  error estimate for blocks of size 2^( 5) =       0.000461579871
  error estimate for blocks of size 2^( 6) =       0.000468081989
  error estimate for blocks of size 2^( 7) =       0.000473481734

      target function =                  N/A
              le_mean =     -16.906038082549
             les_mean =     286.152001056460
             stat err =       0.000463178448
             autocorr =       1.269893532019
              std dev =       0.581272377459
             le_variance =       0.337877576797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337794319312
                                         uncertainty =       0.002842165875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337794319312
                                         uncertainty =       0.002842165875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410994784
  error estimate for blocks of size 2^( 2) =       0.000423404696
  error estimate for blocks of size 2^( 3) =       0.000436306071
  error estimate for blocks of size 2^( 4) =       0.000449548104
  error estimate for blocks of size 2^( 5) =       0.000461558655
  error estimate for blocks of size 2^( 6) =       0.000468061224
  error estimate for blocks of size 2^( 7) =       0.000473461326

      target function =                  N/A
              le_mean =     -16.906037980765
             les_mean =     286.151953463467
             stat err =       0.000463157327
             autocorr =       1.269943669541
              std dev =       0.581234397924
             le_variance =       0.337833425330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906037966018        initial
     2.4414e+00     2.4414e+01             8.5657e-05       -16.906038161303  <--
     9.7656e+00     9.7656e+01             2.3535e-05       -16.906038082549
     3.9062e+01     3.9062e+02             6.0344e-06       -16.906037980765

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9918e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.084527e-01 1 1  ON 0
 uu_1                 1.418490e-01 1 1  ON 1
 uu_2                 3.993991e-02 1 1  ON 2
 uu_3                -2.283234e-02 1 1  ON 3
 uu_4                -6.873217e-02 1 1  ON 4
 uu_5                -1.046071e-01 1 1  ON 5
 uu_6                -1.331544e-01 1 1  ON 6
 uu_7                -1.484970e-01 1 1  ON 7
 uu_8                -1.398472e-01 1 1  ON 8
 uu_9                -1.122506e-01 1 1  ON 9
 ud_0                 4.551459e-01 1 1  ON 10
 ud_1                 1.888591e-01 1 1  ON 11
 ud_2                 6.769053e-02 1 1  ON 12
 ud_3                -4.395026e-03 1 1  ON 13
 ud_4                -6.213260e-02 1 1  ON 14
 ud_5                -1.043996e-01 1 1  ON 15
 ud_6                -1.328358e-01 1 1  ON 16
 ud_7                -1.513063e-01 1 1  ON 17
 ud_8                -1.531492e-01 1 1  ON 18
 ud_9                -1.450502e-01 1 1  ON 19
 eO_0                -7.599011e-01 1 1  ON 20
 eO_1                -4.373497e-01 1 1  ON 21
 eO_2                -1.533081e-02 1 1  ON 22
 eO_3                 3.083461e-01 1 1  ON 23
 eO_4                 5.367974e-01 1 1  ON 24
 eO_5                 5.018075e-01 1 1  ON 25
 eO_6                 2.727020e-01 1 1  ON 26
 eO_7                -3.746096e-02 1 1  ON 27
 eO_8                -2.448439e-01 1 1  ON 28
 eO_9                -1.176025e-01 1 1  ON 29
eH1_0                -2.607464e-01 1 1  ON 30
eH1_1                -1.581864e-01 1 1  ON 31
eH1_2                -1.103510e-01 1 1  ON 32
eH1_3                -5.517163e-02 1 1  ON 33
eH1_4                -6.059446e-03 1 1  ON 34
eH1_5                 2.910450e-02 1 1  ON 35
eH1_6                 9.099417e-02 1 1  ON 36
eH1_7                 1.564712e-01 1 1  ON 37
eH1_8                 2.008009e-01 1 1  ON 38
eH1_9                 1.098615e-01 1 1  ON 39
eH2_0                -2.565672e-01 1 1  ON 40
eH2_1                -1.548060e-01 1 1  ON 41
eH2_2                -1.070516e-01 1 1  ON 42
eH2_3                -5.224188e-02 1 1  ON 43
eH2_4                -3.799716e-03 1 1  ON 44
eH2_5                 3.139839e-02 1 1  ON 45
eH2_6                 9.263030e-02 1 1  ON 46
eH2_7                 1.562445e-01 1 1  ON 47
eH2_8                 2.028187e-01 1 1  ON 48
eH2_9                 1.026649e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.975
    reference variance = 0.193324
====================================================
  Execution time = 2.1170e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4473e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344785483333
                                         uncertainty =       0.004030021493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344785483333
                                         uncertainty =       0.004030021493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415169824
  error estimate for blocks of size 2^( 2) =       0.000427547245
  error estimate for blocks of size 2^( 3) =       0.000441145540
  error estimate for blocks of size 2^( 4) =       0.000453585800
  error estimate for blocks of size 2^( 5) =       0.000464405205
  error estimate for blocks of size 2^( 6) =       0.000473588152
  error estimate for blocks of size 2^( 7) =       0.000480257745

      target function =                  N/A
              le_mean =     -16.906077381211
             les_mean =     286.160184213233
             stat err =       0.000467959225
             autocorr =       1.270470151494
              std dev =       0.587138796287
             le_variance =       0.344731966105


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607738121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906077381211       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906078163407       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906078666136       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906078441874       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906078817151       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906078908027       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906079102861       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906079086667       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906079058298       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.326332e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906077381211       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906077615773       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906077740746       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906077686805       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906077793354       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906077778637       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906077836013       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906077841435       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.074834e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906077381211       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906077442930       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906077473597       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906077460530       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906077487967       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906077481709       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906077495950       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906077497753       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.071637e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082546 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6793e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.085055e-01 1 1  ON 0
 uu_1                 1.418477e-01 1 1  ON 1
 uu_2                 3.993677e-02 1 1  ON 2
 uu_3                -2.283523e-02 1 1  ON 3
 uu_4                -6.877059e-02 1 1  ON 4
 uu_5                -1.046571e-01 1 1  ON 5
 uu_6                -1.331660e-01 1 1  ON 6
 uu_7                -1.484812e-01 1 1  ON 7
 uu_8                -1.398646e-01 1 1  ON 8
 uu_9                -1.122560e-01 1 1  ON 9
 ud_0                 4.551324e-01 1 1  ON 10
 ud_1                 1.888643e-01 1 1  ON 11
 ud_2                 6.765701e-02 1 1  ON 12
 ud_3                -4.386984e-03 1 1  ON 13
 ud_4                -6.209405e-02 1 1  ON 14
 ud_5                -1.044046e-01 1 1  ON 15
 ud_6                -1.328579e-01 1 1  ON 16
 ud_7                -1.512922e-01 1 1  ON 17
 ud_8                -1.531269e-01 1 1  ON 18
 ud_9                -1.450183e-01 1 1  ON 19
 eO_0                -7.599202e-01 1 1  ON 20
 eO_1                -4.372725e-01 1 1  ON 21
 eO_2                -1.531139e-02 1 1  ON 22
 eO_3                 3.083037e-01 1 1  ON 23
 eO_4                 5.368349e-01 1 1  ON 24
 eO_5                 5.018237e-01 1 1  ON 25
 eO_6                 2.726944e-01 1 1  ON 26
 eO_7                -3.746282e-02 1 1  ON 27
 eO_8                -2.448681e-01 1 1  ON 28
 eO_9                -1.176503e-01 1 1  ON 29
eH1_0                -2.607464e-01 1 1  ON 30
eH1_1                -1.581772e-01 1 1  ON 31
eH1_2                -1.103507e-01 1 1  ON 32
eH1_3                -5.515763e-02 1 1  ON 33
eH1_4                -6.061147e-03 1 1  ON 34
eH1_5                 2.905875e-02 1 1  ON 35
eH1_6                 9.094968e-02 1 1  ON 36
eH1_7                 1.564587e-01 1 1  ON 37
eH1_8                 2.008110e-01 1 1  ON 38
eH1_9                 1.099152e-01 1 1  ON 39
eH2_0                -2.566323e-01 1 1  ON 40
eH2_1                -1.547530e-01 1 1  ON 41
eH2_2                -1.070838e-01 1 1  ON 42
eH2_3                -5.228902e-02 1 1  ON 43
eH2_4                -3.829181e-03 1 1  ON 44
eH2_5                 3.132655e-02 1 1  ON 45
eH2_6                 9.265729e-02 1 1  ON 46
eH2_7                 1.562750e-01 1 1  ON 47
eH2_8                 2.028579e-01 1 1  ON 48
eH2_9                 1.027457e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9662
    reference variance = 0.286228
====================================================
  Execution time = 2.0481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3274e-01
  Total weights = 2.0000e+06
  Execution time = 1.9114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332715965157
                                         uncertainty =       0.002528188109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332715965157
                                         uncertainty =       0.002528188109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407865370
  error estimate for blocks of size 2^( 2) =       0.000420645651
  error estimate for blocks of size 2^( 3) =       0.000433571356
  error estimate for blocks of size 2^( 4) =       0.000445766373
  error estimate for blocks of size 2^( 5) =       0.000455680038
  error estimate for blocks of size 2^( 6) =       0.000463713409
  error estimate for blocks of size 2^( 7) =       0.000467321828

      target function =                  N/A
              le_mean =     -16.906224397146
             les_mean =     286.153131520413
             stat err =       0.000458120412
             autocorr =       1.261611443392
              std dev =       0.576808737900
             le_variance =       0.332708320118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332801434047
                                         uncertainty =       0.002529198809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332801434047
                                         uncertainty =       0.002529198809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407917722
  error estimate for blocks of size 2^( 2) =       0.000420695006
  error estimate for blocks of size 2^( 3) =       0.000433616965
  error estimate for blocks of size 2^( 4) =       0.000445811457
  error estimate for blocks of size 2^( 5) =       0.000455723935
  error estimate for blocks of size 2^( 6) =       0.000463757880
  error estimate for blocks of size 2^( 7) =       0.000467366267

      target function =                  N/A
              le_mean =     -16.906225291304
             les_mean =     286.153247168983
             stat err =       0.000458164885
             autocorr =       1.261532532309
              std dev =       0.576882774086
             le_variance =       0.332793735037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332772894435
                                         uncertainty =       0.002528847780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332772894435
                                         uncertainty =       0.002528847780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407900239
  error estimate for blocks of size 2^( 2) =       0.000420678297
  error estimate for blocks of size 2^( 3) =       0.000433601366
  error estimate for blocks of size 2^( 4) =       0.000445796055
  error estimate for blocks of size 2^( 5) =       0.000455708693
  error estimate for blocks of size 2^( 6) =       0.000463742332
  error estimate for blocks of size 2^( 7) =       0.000467350650

      target function =                  N/A
              le_mean =     -16.906224790190
             les_mean =     286.153201700381
             stat err =       0.000458149432
             autocorr =       1.261555571062
              std dev =       0.576858050425
             le_variance =       0.332765210340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332723367944
                                         uncertainty =       0.002528269505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332723367944
                                         uncertainty =       0.002528269505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407869904
  error estimate for blocks of size 2^( 2) =       0.000420649880
  error estimate for blocks of size 2^( 3) =       0.000433575223
  error estimate for blocks of size 2^( 4) =       0.000445770191
  error estimate for blocks of size 2^( 5) =       0.000455683698
  error estimate for blocks of size 2^( 6) =       0.000463717103
  error estimate for blocks of size 2^( 7) =       0.000467325499

      target function =                  N/A
              le_mean =     -16.906224434384
             les_mean =     286.153140176905
             stat err =       0.000458124123
             autocorr =       1.261603830799
              std dev =       0.576815150187
             le_variance =       0.332715717485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906224397146        initial
     6.1035e-01     6.1035e+00             3.3263e-04       -16.906225291304  <--
     2.4414e+00     2.4414e+01             8.0748e-05       -16.906224790190
     9.7656e+00     9.7656e+01             2.0716e-05       -16.906224434384

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 3.0086e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.086350e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993212e-02 1 1  ON 2
 uu_3                -2.284738e-02 1 1  ON 3
 uu_4                -6.886474e-02 1 1  ON 4
 uu_5                -1.047828e-01 1 1  ON 5
 uu_6                -1.332094e-01 1 1  ON 6
 uu_7                -1.484481e-01 1 1  ON 7
 uu_8                -1.399178e-01 1 1  ON 8
 uu_9                -1.122729e-01 1 1  ON 9
 ud_0                 4.551062e-01 1 1  ON 10
 ud_1                 1.888599e-01 1 1  ON 11
 ud_2                 6.760362e-02 1 1  ON 12
 ud_3                -4.385160e-03 1 1  ON 13
 ud_4                -6.200489e-02 1 1  ON 14
 ud_5                -1.044094e-01 1 1  ON 15
 ud_6                -1.329067e-01 1 1  ON 16
 ud_7                -1.512608e-01 1 1  ON 17
 ud_8                -1.530660e-01 1 1  ON 18
 ud_9                -1.449207e-01 1 1  ON 19
 eO_0                -7.599227e-01 1 1  ON 20
 eO_1                -4.371111e-01 1 1  ON 21
 eO_2                -1.525442e-02 1 1  ON 22
 eO_3                 3.082208e-01 1 1  ON 23
 eO_4                 5.369401e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726706e-01 1 1  ON 26
 eO_7                -3.747087e-02 1 1  ON 27
 eO_8                -2.449447e-01 1 1  ON 28
 eO_9                -1.177995e-01 1 1  ON 29
eH1_0                -2.607481e-01 1 1  ON 30
eH1_1                -1.581587e-01 1 1  ON 31
eH1_2                -1.103486e-01 1 1  ON 32
eH1_3                -5.512173e-02 1 1  ON 33
eH1_4                -6.058897e-03 1 1  ON 34
eH1_5                 2.892659e-02 1 1  ON 35
eH1_6                 9.081332e-02 1 1  ON 36
eH1_7                 1.564191e-01 1 1  ON 37
eH1_8                 2.008413e-01 1 1  ON 38
eH1_9                 1.100821e-01 1 1  ON 39
eH2_0                -2.568065e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071711e-01 1 1  ON 42
eH2_3                -5.241033e-02 1 1  ON 43
eH2_4                -3.910850e-03 1 1  ON 44
eH2_5                 3.112461e-02 1 1  ON 45
eH2_6                 9.272793e-02 1 1  ON 46
eH2_7                 1.563643e-01 1 1  ON 47
eH2_8                 2.029799e-01 1 1  ON 48
eH2_9                 1.029976e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9048
    reference variance = 0.303507
====================================================
  Execution time = 2.1119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3842e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7325e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405646733
                                         uncertainty =       0.003703134238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405646733
                                         uncertainty =       0.003703134238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411351733
  error estimate for blocks of size 2^( 2) =       0.000424675508
  error estimate for blocks of size 2^( 3) =       0.000438129500
  error estimate for blocks of size 2^( 4) =       0.000450103334
  error estimate for blocks of size 2^( 5) =       0.000461537473
  error estimate for blocks of size 2^( 6) =       0.000468159885
  error estimate for blocks of size 2^( 7) =       0.000473201936

      target function =                  N/A
              le_mean =     -16.905371487361
             les_mean =     286.130005453017
             stat err =       0.000463250657
             autocorr =       1.268251617860
              std dev =       0.581739199784
             le_variance =       0.338420496565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690537148736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905371487361       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905371488815       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905372396795       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905372479007       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905372176747       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905374473137       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905373995988       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905374055076       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905374018395       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905374254129       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905373993183       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.307353e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905371487361       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905371487987       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905371762747       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905371768449       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905371900905       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905372537825       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905372533014       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905372420326       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905372475962       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.302477e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905371487361       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905371487552       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905371556325       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905371542707       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905371646134       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905371790803       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905371820534       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905371795648       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.141568e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085851 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6859e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.086369e-01 1 1  ON 0
 uu_1                 1.417948e-01 1 1  ON 1
 uu_2                 3.988295e-02 1 1  ON 2
 uu_3                -2.291646e-02 1 1  ON 3
 uu_4                -6.898240e-02 1 1  ON 4
 uu_5                -1.046906e-01 1 1  ON 5
 uu_6                -1.331177e-01 1 1  ON 6
 uu_7                -1.483976e-01 1 1  ON 7
 uu_8                -1.400308e-01 1 1  ON 8
 uu_9                -1.123179e-01 1 1  ON 9
 ud_0                 4.552213e-01 1 1  ON 10
 ud_1                 1.888014e-01 1 1  ON 11
 ud_2                 6.759360e-02 1 1  ON 12
 ud_3                -4.423637e-03 1 1  ON 13
 ud_4                -6.205481e-02 1 1  ON 14
 ud_5                -1.044162e-01 1 1  ON 15
 ud_6                -1.329676e-01 1 1  ON 16
 ud_7                -1.513813e-01 1 1  ON 17
 ud_8                -1.529396e-01 1 1  ON 18
 ud_9                -1.447273e-01 1 1  ON 19
 eO_0                -7.598100e-01 1 1  ON 20
 eO_1                -4.371524e-01 1 1  ON 21
 eO_2                -1.523151e-02 1 1  ON 22
 eO_3                 3.083098e-01 1 1  ON 23
 eO_4                 5.370471e-01 1 1  ON 24
 eO_5                 5.018388e-01 1 1  ON 25
 eO_6                 2.727262e-01 1 1  ON 26
 eO_7                -3.750481e-02 1 1  ON 27
 eO_8                -2.449952e-01 1 1  ON 28
 eO_9                -1.179974e-01 1 1  ON 29
eH1_0                -2.607474e-01 1 1  ON 30
eH1_1                -1.580375e-01 1 1  ON 31
eH1_2                -1.104661e-01 1 1  ON 32
eH1_3                -5.519159e-02 1 1  ON 33
eH1_4                -6.246375e-03 1 1  ON 34
eH1_5                 2.880350e-02 1 1  ON 35
eH1_6                 9.075271e-02 1 1  ON 36
eH1_7                 1.564409e-01 1 1  ON 37
eH1_8                 2.009398e-01 1 1  ON 38
eH1_9                 1.103451e-01 1 1  ON 39
eH2_0                -2.568747e-01 1 1  ON 40
eH2_1                -1.547526e-01 1 1  ON 41
eH2_2                -1.071931e-01 1 1  ON 42
eH2_3                -5.247442e-02 1 1  ON 43
eH2_4                -4.064473e-03 1 1  ON 44
eH2_5                 3.097438e-02 1 1  ON 45
eH2_6                 9.279997e-02 1 1  ON 46
eH2_7                 1.563409e-01 1 1  ON 47
eH2_8                 2.030463e-01 1 1  ON 48
eH2_9                 1.033278e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.114773
====================================================
  Execution time = 2.0468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4261e-01
  Total weights = 2.0000e+06
  Execution time = 1.9124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342525437645
                                         uncertainty =       0.004236298872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342525437645
                                         uncertainty =       0.004236298872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413805417
  error estimate for blocks of size 2^( 2) =       0.000426984039
  error estimate for blocks of size 2^( 3) =       0.000440193770
  error estimate for blocks of size 2^( 4) =       0.000452767490
  error estimate for blocks of size 2^( 5) =       0.000463142123
  error estimate for blocks of size 2^( 6) =       0.000472451189
  error estimate for blocks of size 2^( 7) =       0.000480277659

      target function =                  N/A
              le_mean =     -16.905295448572
             les_mean =     286.131483878623
             stat err =       0.000467159615
             autocorr =       1.274495306964
              std dev =       0.585209232962
             le_variance =       0.342469846344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342791432711
                                         uncertainty =       0.004238502083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342791432711
                                         uncertainty =       0.004238502083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413966088
  error estimate for blocks of size 2^( 2) =       0.000427136564
  error estimate for blocks of size 2^( 3) =       0.000440341198
  error estimate for blocks of size 2^( 4) =       0.000452907322
  error estimate for blocks of size 2^( 5) =       0.000463276040
  error estimate for blocks of size 2^( 6) =       0.000472582308
  error estimate for blocks of size 2^( 7) =       0.000480410626

      target function =                  N/A
              le_mean =     -16.905293992465
             les_mean =     286.131700644941
             stat err =       0.000467294074
             autocorr =       1.274239360397
              std dev =       0.585436456521
             le_variance =       0.342735844624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342804472971
                                         uncertainty =       0.004238814976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342804472971
                                         uncertainty =       0.004238814976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413973984
  error estimate for blocks of size 2^( 2) =       0.000427144146
  error estimate for blocks of size 2^( 3) =       0.000440348362
  error estimate for blocks of size 2^( 4) =       0.000452914690
  error estimate for blocks of size 2^( 5) =       0.000463283616
  error estimate for blocks of size 2^( 6) =       0.000472591097
  error estimate for blocks of size 2^( 7) =       0.000480419885

      target function =                  N/A
              le_mean =     -16.905293971749
             les_mean =     286.131713018798
             stat err =       0.000467302322
             autocorr =       1.274235734882
              std dev =       0.585447622683
             le_variance =       0.342748918905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342581946245
                                         uncertainty =       0.004236846217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342581946245
                                         uncertainty =       0.004236846217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413839561
  error estimate for blocks of size 2^( 2) =       0.000427016411
  error estimate for blocks of size 2^( 3) =       0.000440224961
  error estimate for blocks of size 2^( 4) =       0.000452797209
  error estimate for blocks of size 2^( 5) =       0.000463170778
  error estimate for blocks of size 2^( 6) =       0.000472479598
  error estimate for blocks of size 2^( 7) =       0.000480306522

      target function =                  N/A
              le_mean =     -16.905295091622
             les_mean =     286.131528328041
             stat err =       0.000467188527
             autocorr =       1.274442741579
              std dev =       0.585257519812
             le_variance =       0.342526364497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905295448572        initial  <--
     1.5259e-01     1.5259e+00             1.3074e-03       -16.905293992465
     6.1035e-01     6.1035e+00             3.3025e-04       -16.905293971749
     2.4414e+00     2.4414e+01             8.1416e-05       -16.905295091622

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.0606
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.086350e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993212e-02 1 1  ON 2
 uu_3                -2.284738e-02 1 1  ON 3
 uu_4                -6.886474e-02 1 1  ON 4
 uu_5                -1.047828e-01 1 1  ON 5
 uu_6                -1.332094e-01 1 1  ON 6
 uu_7                -1.484481e-01 1 1  ON 7
 uu_8                -1.399178e-01 1 1  ON 8
 uu_9                -1.122729e-01 1 1  ON 9
 ud_0                 4.551062e-01 1 1  ON 10
 ud_1                 1.888599e-01 1 1  ON 11
 ud_2                 6.760362e-02 1 1  ON 12
 ud_3                -4.385160e-03 1 1  ON 13
 ud_4                -6.200489e-02 1 1  ON 14
 ud_5                -1.044094e-01 1 1  ON 15
 ud_6                -1.329067e-01 1 1  ON 16
 ud_7                -1.512608e-01 1 1  ON 17
 ud_8                -1.530660e-01 1 1  ON 18
 ud_9                -1.449207e-01 1 1  ON 19
 eO_0                -7.599227e-01 1 1  ON 20
 eO_1                -4.371111e-01 1 1  ON 21
 eO_2                -1.525442e-02 1 1  ON 22
 eO_3                 3.082208e-01 1 1  ON 23
 eO_4                 5.369401e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726706e-01 1 1  ON 26
 eO_7                -3.747087e-02 1 1  ON 27
 eO_8                -2.449447e-01 1 1  ON 28
 eO_9                -1.177995e-01 1 1  ON 29
eH1_0                -2.607481e-01 1 1  ON 30
eH1_1                -1.581587e-01 1 1  ON 31
eH1_2                -1.103486e-01 1 1  ON 32
eH1_3                -5.512173e-02 1 1  ON 33
eH1_4                -6.058897e-03 1 1  ON 34
eH1_5                 2.892659e-02 1 1  ON 35
eH1_6                 9.081332e-02 1 1  ON 36
eH1_7                 1.564191e-01 1 1  ON 37
eH1_8                 2.008413e-01 1 1  ON 38
eH1_9                 1.100821e-01 1 1  ON 39
eH2_0                -2.568065e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071711e-01 1 1  ON 42
eH2_3                -5.241033e-02 1 1  ON 43
eH2_4                -3.910850e-03 1 1  ON 44
eH2_5                 3.112461e-02 1 1  ON 45
eH2_6                 9.272793e-02 1 1  ON 46
eH2_7                 1.563643e-01 1 1  ON 47
eH2_8                 2.029799e-01 1 1  ON 48
eH2_9                 1.029976e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9930e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9891
    reference variance = 0.20334
====================================================
  Execution time = 2.1146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3761e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5667e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337675512658
                                         uncertainty =       0.003111746564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337675512658
                                         uncertainty =       0.003111746564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410858957
  error estimate for blocks of size 2^( 2) =       0.000423428672
  error estimate for blocks of size 2^( 3) =       0.000436070041
  error estimate for blocks of size 2^( 4) =       0.000447685424
  error estimate for blocks of size 2^( 5) =       0.000457271717
  error estimate for blocks of size 2^( 6) =       0.000464317162
  error estimate for blocks of size 2^( 7) =       0.000467092474

      target function =                  N/A
              le_mean =     -16.907475971764
             les_mean =     286.200353731975
             stat err =       0.000459091694
             autocorr =       1.248571315247
              std dev =       0.581042309122
             le_variance =       0.337610164990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690747597176e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907475971764       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907475592881       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907475701944       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907475766642       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907475878576       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907475937028       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907475967510       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907475961036       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.203218e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907475971764       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907475866251       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907475894749       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907475906395       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907475932078       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907475952045       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907475953555       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907475951827       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.092678e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907475971764       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907475944613       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907475951811       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907475954428       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907475960315       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907475965396       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907475965827       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907475965499       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 7.729066e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6727e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.086295e-01 1 1  ON 0
 uu_1                 1.418473e-01 1 1  ON 1
 uu_2                 3.994950e-02 1 1  ON 2
 uu_3                -2.285590e-02 1 1  ON 3
 uu_4                -6.885587e-02 1 1  ON 4
 uu_5                -1.047606e-01 1 1  ON 5
 uu_6                -1.332003e-01 1 1  ON 6
 uu_7                -1.484513e-01 1 1  ON 7
 uu_8                -1.399472e-01 1 1  ON 8
 uu_9                -1.122941e-01 1 1  ON 9
 ud_0                 4.551080e-01 1 1  ON 10
 ud_1                 1.888804e-01 1 1  ON 11
 ud_2                 6.760634e-02 1 1  ON 12
 ud_3                -4.372330e-03 1 1  ON 13
 ud_4                -6.200666e-02 1 1  ON 14
 ud_5                -1.043926e-01 1 1  ON 15
 ud_6                -1.329038e-01 1 1  ON 16
 ud_7                -1.512665e-01 1 1  ON 17
 ud_8                -1.530829e-01 1 1  ON 18
 ud_9                -1.449315e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.370959e-01 1 1  ON 21
 eO_2                -1.523917e-02 1 1  ON 22
 eO_3                 3.082234e-01 1 1  ON 23
 eO_4                 5.369523e-01 1 1  ON 24
 eO_5                 5.018704e-01 1 1  ON 25
 eO_6                 2.726778e-01 1 1  ON 26
 eO_7                -3.747599e-02 1 1  ON 27
 eO_8                -2.449678e-01 1 1  ON 28
 eO_9                -1.178228e-01 1 1  ON 29
eH1_0                -2.607512e-01 1 1  ON 30
eH1_1                -1.581593e-01 1 1  ON 31
eH1_2                -1.103552e-01 1 1  ON 32
eH1_3                -5.512046e-02 1 1  ON 33
eH1_4                -6.066029e-03 1 1  ON 34
eH1_5                 2.893244e-02 1 1  ON 35
eH1_6                 9.081586e-02 1 1  ON 36
eH1_7                 1.564098e-01 1 1  ON 37
eH1_8                 2.008386e-01 1 1  ON 38
eH1_9                 1.101008e-01 1 1  ON 39
eH2_0                -2.568357e-01 1 1  ON 40
eH2_1                -1.546962e-01 1 1  ON 41
eH2_2                -1.071912e-01 1 1  ON 42
eH2_3                -5.241011e-02 1 1  ON 43
eH2_4                -3.894991e-03 1 1  ON 44
eH2_5                 3.112047e-02 1 1  ON 45
eH2_6                 9.273885e-02 1 1  ON 46
eH2_7                 1.563755e-01 1 1  ON 47
eH2_8                 2.029899e-01 1 1  ON 48
eH2_9                 1.030285e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8287
    reference variance = 0.720838
====================================================
  Execution time = 2.0914e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4701e-01
  Total weights = 2.0000e+06
  Execution time = 1.8993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346938838124
                                         uncertainty =       0.004481299705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346938838124
                                         uncertainty =       0.004481299705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416545025
  error estimate for blocks of size 2^( 2) =       0.000429665649
  error estimate for blocks of size 2^( 3) =       0.000442801939
  error estimate for blocks of size 2^( 4) =       0.000455718791
  error estimate for blocks of size 2^( 5) =       0.000466181152
  error estimate for blocks of size 2^( 6) =       0.000475502820
  error estimate for blocks of size 2^( 7) =       0.000479034335

      target function =                  N/A
              le_mean =     -16.905697693211
             les_mean =     286.149633836034
             stat err =       0.000469109274
             autocorr =       1.268306256803
              std dev =       0.589083623348
             le_variance =       0.347019515297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346913497603
                                         uncertainty =       0.004481009581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346913497603
                                         uncertainty =       0.004481009581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416529749
  error estimate for blocks of size 2^( 2) =       0.000429649624
  error estimate for blocks of size 2^( 3) =       0.000442784806
  error estimate for blocks of size 2^( 4) =       0.000455701800
  error estimate for blocks of size 2^( 5) =       0.000466164621
  error estimate for blocks of size 2^( 6) =       0.000475489509
  error estimate for blocks of size 2^( 7) =       0.000479019860

      target function =                  N/A
              le_mean =     -16.905696851011
             les_mean =     286.149579908176
             stat err =       0.000469093947
             autocorr =       1.268316404579
              std dev =       0.589062019995
             le_variance =       0.346994063400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346921512525
                                         uncertainty =       0.004481177477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346921512525
                                         uncertainty =       0.004481177477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416534587
  error estimate for blocks of size 2^( 2) =       0.000429654846
  error estimate for blocks of size 2^( 3) =       0.000442790596
  error estimate for blocks of size 2^( 4) =       0.000455707621
  error estimate for blocks of size 2^( 5) =       0.000466170321
  error estimate for blocks of size 2^( 6) =       0.000475493954
  error estimate for blocks of size 2^( 7) =       0.000479024670

      target function =                  N/A
              le_mean =     -16.905697114344
             les_mean =     286.149596873590
             stat err =       0.000469099141
             autocorr =       1.268315023722
              std dev =       0.589068862835
             le_variance =       0.347002125162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346936493082
                                         uncertainty =       0.004481286694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346936493082
                                         uncertainty =       0.004481286694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416543612
  error estimate for blocks of size 2^( 2) =       0.000429664191
  error estimate for blocks of size 2^( 3) =       0.000442800413
  error estimate for blocks of size 2^( 4) =       0.000455717289
  error estimate for blocks of size 2^( 5) =       0.000466179695
  error estimate for blocks of size 2^( 6) =       0.000475501622
  error estimate for blocks of size 2^( 7) =       0.000479033029

      target function =                  N/A
              le_mean =     -16.905697614044
             les_mean =     286.149628805945
             stat err =       0.000469107909
             autocorr =       1.268307473546
              std dev =       0.589081625883
             le_variance =       0.347017161953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905697693211        initial  <--
     1.5259e+00     1.5259e+01             1.2032e-04       -16.905696851011
     6.1035e+00     6.1035e+01             3.0927e-05       -16.905697114344
     2.4414e+01     2.4414e+02             7.7291e-06       -16.905697614044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4871
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.086350e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993212e-02 1 1  ON 2
 uu_3                -2.284738e-02 1 1  ON 3
 uu_4                -6.886474e-02 1 1  ON 4
 uu_5                -1.047828e-01 1 1  ON 5
 uu_6                -1.332094e-01 1 1  ON 6
 uu_7                -1.484481e-01 1 1  ON 7
 uu_8                -1.399178e-01 1 1  ON 8
 uu_9                -1.122729e-01 1 1  ON 9
 ud_0                 4.551062e-01 1 1  ON 10
 ud_1                 1.888599e-01 1 1  ON 11
 ud_2                 6.760362e-02 1 1  ON 12
 ud_3                -4.385160e-03 1 1  ON 13
 ud_4                -6.200489e-02 1 1  ON 14
 ud_5                -1.044094e-01 1 1  ON 15
 ud_6                -1.329067e-01 1 1  ON 16
 ud_7                -1.512608e-01 1 1  ON 17
 ud_8                -1.530660e-01 1 1  ON 18
 ud_9                -1.449207e-01 1 1  ON 19
 eO_0                -7.599227e-01 1 1  ON 20
 eO_1                -4.371111e-01 1 1  ON 21
 eO_2                -1.525442e-02 1 1  ON 22
 eO_3                 3.082208e-01 1 1  ON 23
 eO_4                 5.369401e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726706e-01 1 1  ON 26
 eO_7                -3.747087e-02 1 1  ON 27
 eO_8                -2.449447e-01 1 1  ON 28
 eO_9                -1.177995e-01 1 1  ON 29
eH1_0                -2.607481e-01 1 1  ON 30
eH1_1                -1.581587e-01 1 1  ON 31
eH1_2                -1.103486e-01 1 1  ON 32
eH1_3                -5.512173e-02 1 1  ON 33
eH1_4                -6.058897e-03 1 1  ON 34
eH1_5                 2.892659e-02 1 1  ON 35
eH1_6                 9.081332e-02 1 1  ON 36
eH1_7                 1.564191e-01 1 1  ON 37
eH1_8                 2.008413e-01 1 1  ON 38
eH1_9                 1.100821e-01 1 1  ON 39
eH2_0                -2.568065e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071711e-01 1 1  ON 42
eH2_3                -5.241033e-02 1 1  ON 43
eH2_4                -3.910850e-03 1 1  ON 44
eH2_5                 3.112461e-02 1 1  ON 45
eH2_6                 9.272793e-02 1 1  ON 46
eH2_7                 1.563643e-01 1 1  ON 47
eH2_8                 2.029799e-01 1 1  ON 48
eH2_9                 1.029976e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8422
    reference variance = 0.284659
====================================================
  Execution time = 2.1112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342947614926
                                         uncertainty =       0.004955528281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342947614926
                                         uncertainty =       0.004955528281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414069703
  error estimate for blocks of size 2^( 2) =       0.000426357175
  error estimate for blocks of size 2^( 3) =       0.000439350139
  error estimate for blocks of size 2^( 4) =       0.000451174741
  error estimate for blocks of size 2^( 5) =       0.000461719956
  error estimate for blocks of size 2^( 6) =       0.000468574736
  error estimate for blocks of size 2^( 7) =       0.000473591068

      target function =                  N/A
              le_mean =     -16.905912616706
             les_mean =     286.152788670005
             stat err =       0.000463765125
             autocorr =       1.254438183105
              std dev =       0.585582989656
             le_variance =       0.342907437774


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591261671e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905912616706       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905912597621       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905912606760       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905912588856       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905912566585       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905912572227       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905912579436       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905912578943       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.289221e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905912616706       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905912611881       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905912614140       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905912609597       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905912603912       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905912605117       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905912606978       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905912606872       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.256429e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905912616706       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905912615496       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905912616059       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905912614919       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905912613490       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905912613778       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905912614248       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905912614222       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 8.162317e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6835e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.086366e-01 1 1  ON 0
 uu_1                 1.418428e-01 1 1  ON 1
 uu_2                 3.993260e-02 1 1  ON 2
 uu_3                -2.284770e-02 1 1  ON 3
 uu_4                -6.886607e-02 1 1  ON 4
 uu_5                -1.047806e-01 1 1  ON 5
 uu_6                -1.332097e-01 1 1  ON 6
 uu_7                -1.484487e-01 1 1  ON 7
 uu_8                -1.399207e-01 1 1  ON 8
 uu_9                -1.122739e-01 1 1  ON 9
 ud_0                 4.551060e-01 1 1  ON 10
 ud_1                 1.888604e-01 1 1  ON 11
 ud_2                 6.760471e-02 1 1  ON 12
 ud_3                -4.382955e-03 1 1  ON 13
 ud_4                -6.200569e-02 1 1  ON 14
 ud_5                -1.044097e-01 1 1  ON 15
 ud_6                -1.329064e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530663e-01 1 1  ON 18
 ud_9                -1.449197e-01 1 1  ON 19
 eO_0                -7.599209e-01 1 1  ON 20
 eO_1                -4.371112e-01 1 1  ON 21
 eO_2                -1.525375e-02 1 1  ON 22
 eO_3                 3.082211e-01 1 1  ON 23
 eO_4                 5.369405e-01 1 1  ON 24
 eO_5                 5.018667e-01 1 1  ON 25
 eO_6                 2.726717e-01 1 1  ON 26
 eO_7                -3.747152e-02 1 1  ON 27
 eO_8                -2.449464e-01 1 1  ON 28
 eO_9                -1.178017e-01 1 1  ON 29
eH1_0                -2.607496e-01 1 1  ON 30
eH1_1                -1.581597e-01 1 1  ON 31
eH1_2                -1.103478e-01 1 1  ON 32
eH1_3                -5.512498e-02 1 1  ON 33
eH1_4                -6.059662e-03 1 1  ON 34
eH1_5                 2.892769e-02 1 1  ON 35
eH1_6                 9.081424e-02 1 1  ON 36
eH1_7                 1.564189e-01 1 1  ON 37
eH1_8                 2.008424e-01 1 1  ON 38
eH1_9                 1.100846e-01 1 1  ON 39
eH2_0                -2.568082e-01 1 1  ON 40
eH2_1                -1.546715e-01 1 1  ON 41
eH2_2                -1.071726e-01 1 1  ON 42
eH2_3                -5.241145e-02 1 1  ON 43
eH2_4                -3.908857e-03 1 1  ON 44
eH2_5                 3.112499e-02 1 1  ON 45
eH2_6                 9.272825e-02 1 1  ON 46
eH2_7                 1.563654e-01 1 1  ON 47
eH2_8                 2.029805e-01 1 1  ON 48
eH2_9                 1.029998e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9198
    reference variance = 0.248641
====================================================
  Execution time = 2.0591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4975e-01
  Total weights = 2.0000e+06
  Execution time = 1.9097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349829894935
                                         uncertainty =       0.005867614928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349829894935
                                         uncertainty =       0.005867614928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418181603
  error estimate for blocks of size 2^( 2) =       0.000430345492
  error estimate for blocks of size 2^( 3) =       0.000443341445
  error estimate for blocks of size 2^( 4) =       0.000456139340
  error estimate for blocks of size 2^( 5) =       0.000467223139
  error estimate for blocks of size 2^( 6) =       0.000475914870
  error estimate for blocks of size 2^( 7) =       0.000480678746

      target function =                  N/A
              le_mean =     -16.906045319548
             les_mean =     286.164119877708
             stat err =       0.000469989024
             autocorr =       1.263122829951
              std dev =       0.591398094329
             le_variance =       0.349751705976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349825088303
                                         uncertainty =       0.005867551445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349825088303
                                         uncertainty =       0.005867551445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418178731
  error estimate for blocks of size 2^( 2) =       0.000430342777
  error estimate for blocks of size 2^( 3) =       0.000443338911
  error estimate for blocks of size 2^( 4) =       0.000456136929
  error estimate for blocks of size 2^( 5) =       0.000467221000
  error estimate for blocks of size 2^( 6) =       0.000475912750
  error estimate for blocks of size 2^( 7) =       0.000480676906

      target function =                  N/A
              le_mean =     -16.906045297785
             les_mean =     286.164114338501
             stat err =       0.000469986896
             autocorr =       1.263128742184
              std dev =       0.591394033288
             le_variance =       0.349746902609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349827458815
                                         uncertainty =       0.005867583070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349827458815
                                         uncertainty =       0.005867583070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418180148
  error estimate for blocks of size 2^( 2) =       0.000430344116
  error estimate for blocks of size 2^( 3) =       0.000443340161
  error estimate for blocks of size 2^( 4) =       0.000456138119
  error estimate for blocks of size 2^( 5) =       0.000467222056
  error estimate for blocks of size 2^( 6) =       0.000475913797
  error estimate for blocks of size 2^( 7) =       0.000480677816

      target function =                  N/A
              le_mean =     -16.906045308300
             les_mean =     286.164117062943
             stat err =       0.000469987947
             autocorr =       1.263125836151
              std dev =       0.591396036110
             le_variance =       0.349749271527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349829589321
                                         uncertainty =       0.005867610943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349829589321
                                         uncertainty =       0.005867610943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418181420
  error estimate for blocks of size 2^( 2) =       0.000430345319
  error estimate for blocks of size 2^( 3) =       0.000443341284
  error estimate for blocks of size 2^( 4) =       0.000456139187
  error estimate for blocks of size 2^( 5) =       0.000467223003
  error estimate for blocks of size 2^( 6) =       0.000475914735
  error estimate for blocks of size 2^( 7) =       0.000480678629

      target function =                  N/A
              le_mean =     -16.906045318118
             les_mean =     286.164119523941
             stat err =       0.000469988889
             autocorr =       1.263123207273
              std dev =       0.591397836124
             le_variance =       0.349751400572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906045319548        initial  <--
     1.5259e+01     1.5259e+02             1.2892e-05       -16.906045297785
     6.1035e+01     6.1035e+02             3.2564e-06       -16.906045308300
     2.4414e+02     2.4414e+03             8.1623e-07       -16.906045318118

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1688
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.086350e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993212e-02 1 1  ON 2
 uu_3                -2.284738e-02 1 1  ON 3
 uu_4                -6.886474e-02 1 1  ON 4
 uu_5                -1.047828e-01 1 1  ON 5
 uu_6                -1.332094e-01 1 1  ON 6
 uu_7                -1.484481e-01 1 1  ON 7
 uu_8                -1.399178e-01 1 1  ON 8
 uu_9                -1.122729e-01 1 1  ON 9
 ud_0                 4.551062e-01 1 1  ON 10
 ud_1                 1.888599e-01 1 1  ON 11
 ud_2                 6.760362e-02 1 1  ON 12
 ud_3                -4.385160e-03 1 1  ON 13
 ud_4                -6.200489e-02 1 1  ON 14
 ud_5                -1.044094e-01 1 1  ON 15
 ud_6                -1.329067e-01 1 1  ON 16
 ud_7                -1.512608e-01 1 1  ON 17
 ud_8                -1.530660e-01 1 1  ON 18
 ud_9                -1.449207e-01 1 1  ON 19
 eO_0                -7.599227e-01 1 1  ON 20
 eO_1                -4.371111e-01 1 1  ON 21
 eO_2                -1.525442e-02 1 1  ON 22
 eO_3                 3.082208e-01 1 1  ON 23
 eO_4                 5.369401e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726706e-01 1 1  ON 26
 eO_7                -3.747087e-02 1 1  ON 27
 eO_8                -2.449447e-01 1 1  ON 28
 eO_9                -1.177995e-01 1 1  ON 29
eH1_0                -2.607481e-01 1 1  ON 30
eH1_1                -1.581587e-01 1 1  ON 31
eH1_2                -1.103486e-01 1 1  ON 32
eH1_3                -5.512173e-02 1 1  ON 33
eH1_4                -6.058897e-03 1 1  ON 34
eH1_5                 2.892659e-02 1 1  ON 35
eH1_6                 9.081332e-02 1 1  ON 36
eH1_7                 1.564191e-01 1 1  ON 37
eH1_8                 2.008413e-01 1 1  ON 38
eH1_9                 1.100821e-01 1 1  ON 39
eH2_0                -2.568065e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071711e-01 1 1  ON 42
eH2_3                -5.241033e-02 1 1  ON 43
eH2_4                -3.910850e-03 1 1  ON 44
eH2_5                 3.112461e-02 1 1  ON 45
eH2_6                 9.272793e-02 1 1  ON 46
eH2_7                 1.563643e-01 1 1  ON 47
eH2_8                 2.029799e-01 1 1  ON 48
eH2_9                 1.029976e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9076
    reference variance = 0.243049
====================================================
  Execution time = 2.1004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4162e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341664037945
                                         uncertainty =       0.003835182116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341664037945
                                         uncertainty =       0.003835182116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413289992
  error estimate for blocks of size 2^( 2) =       0.000425688615
  error estimate for blocks of size 2^( 3) =       0.000438193620
  error estimate for blocks of size 2^( 4) =       0.000449897969
  error estimate for blocks of size 2^( 5) =       0.000460411020
  error estimate for blocks of size 2^( 6) =       0.000467525383
  error estimate for blocks of size 2^( 7) =       0.000471687827

      target function =                  N/A
              le_mean =     -16.905777005411
             les_mean =     286.146913220380
             stat err =       0.000462380550
             autocorr =       1.251668541393
              std dev =       0.584480311478
             le_variance =       0.341617234505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577700541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905777005411       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905777009302       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905777013855       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905777012875       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905777017017       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905777016797       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905777016741       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.371361e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905777005411       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905777006385       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905777007526       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905777007276       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905777008315       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905777008262       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905777008246       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.430264e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905777005411       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905777005654       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905777005940       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905777005877       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905777006137       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905777006124       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905777006120       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 8.576818e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105363 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6629e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.086351e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993221e-02 1 1  ON 2
 uu_3                -2.284741e-02 1 1  ON 3
 uu_4                -6.886491e-02 1 1  ON 4
 uu_5                -1.047827e-01 1 1  ON 5
 uu_6                -1.332096e-01 1 1  ON 6
 uu_7                -1.484482e-01 1 1  ON 7
 uu_8                -1.399179e-01 1 1  ON 8
 uu_9                -1.122730e-01 1 1  ON 9
 ud_0                 4.551062e-01 1 1  ON 10
 ud_1                 1.888599e-01 1 1  ON 11
 ud_2                 6.760370e-02 1 1  ON 12
 ud_3                -4.385067e-03 1 1  ON 13
 ud_4                -6.200486e-02 1 1  ON 14
 ud_5                -1.044093e-01 1 1  ON 15
 ud_6                -1.329067e-01 1 1  ON 16
 ud_7                -1.512610e-01 1 1  ON 17
 ud_8                -1.530661e-01 1 1  ON 18
 ud_9                -1.449207e-01 1 1  ON 19
 eO_0                -7.599227e-01 1 1  ON 20
 eO_1                -4.371110e-01 1 1  ON 21
 eO_2                -1.525431e-02 1 1  ON 22
 eO_3                 3.082209e-01 1 1  ON 23
 eO_4                 5.369401e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726707e-01 1 1  ON 26
 eO_7                -3.747092e-02 1 1  ON 27
 eO_8                -2.449448e-01 1 1  ON 28
 eO_9                -1.177997e-01 1 1  ON 29
eH1_0                -2.607480e-01 1 1  ON 30
eH1_1                -1.581587e-01 1 1  ON 31
eH1_2                -1.103487e-01 1 1  ON 32
eH1_3                -5.512186e-02 1 1  ON 33
eH1_4                -6.059240e-03 1 1  ON 34
eH1_5                 2.892682e-02 1 1  ON 35
eH1_6                 9.081319e-02 1 1  ON 36
eH1_7                 1.564190e-01 1 1  ON 37
eH1_8                 2.008415e-01 1 1  ON 38
eH1_9                 1.100824e-01 1 1  ON 39
eH2_0                -2.568064e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071712e-01 1 1  ON 42
eH2_3                -5.241054e-02 1 1  ON 43
eH2_4                -3.910937e-03 1 1  ON 44
eH2_5                 3.112453e-02 1 1  ON 45
eH2_6                 9.272782e-02 1 1  ON 46
eH2_7                 1.563644e-01 1 1  ON 47
eH2_8                 2.029800e-01 1 1  ON 48
eH2_9                 1.029978e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.991
    reference variance = 0.169556
====================================================
  Execution time = 2.0626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4479e-01
  Total weights = 2.0000e+06
  Execution time = 1.9194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344818484704
                                         uncertainty =       0.005537991364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344818484704
                                         uncertainty =       0.005537991364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415202250
  error estimate for blocks of size 2^( 2) =       0.000428125797
  error estimate for blocks of size 2^( 3) =       0.000441707077
  error estimate for blocks of size 2^( 4) =       0.000454349175
  error estimate for blocks of size 2^( 5) =       0.000466395309
  error estimate for blocks of size 2^( 6) =       0.000474991202
  error estimate for blocks of size 2^( 7) =       0.000481959021

      target function =                  N/A
              le_mean =     -16.905120180669
             les_mean =     286.127873967462
             stat err =       0.000469423677
             autocorr =       1.278234645140
              std dev =       0.587184653226
             le_variance =       0.344785816984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344818218317
                                         uncertainty =       0.005537989731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344818218317
                                         uncertainty =       0.005537989731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415202089
  error estimate for blocks of size 2^( 2) =       0.000428125649
  error estimate for blocks of size 2^( 3) =       0.000441706938
  error estimate for blocks of size 2^( 4) =       0.000454349039
  error estimate for blocks of size 2^( 5) =       0.000466395166
  error estimate for blocks of size 2^( 6) =       0.000474991052
  error estimate for blocks of size 2^( 7) =       0.000481958878

      target function =                  N/A
              le_mean =     -16.905120184723
             les_mean =     286.127873837772
             stat err =       0.000469423534
             autocorr =       1.278234855726
              std dev =       0.587184426079
             le_variance =       0.344785550230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344818351304
                                         uncertainty =       0.005537990551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344818351304
                                         uncertainty =       0.005537990551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415202170
  error estimate for blocks of size 2^( 2) =       0.000428125723
  error estimate for blocks of size 2^( 3) =       0.000441707008
  error estimate for blocks of size 2^( 4) =       0.000454349107
  error estimate for blocks of size 2^( 5) =       0.000466395238
  error estimate for blocks of size 2^( 6) =       0.000474991127
  error estimate for blocks of size 2^( 7) =       0.000481958949

      target function =                  N/A
              le_mean =     -16.905120182696
             les_mean =     286.127873902402
             stat err =       0.000469423605
             autocorr =       1.278234750635
              std dev =       0.587184539476
             le_variance =       0.344785683400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344818468022
                                         uncertainty =       0.005537991263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344818468022
                                         uncertainty =       0.005537991263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415202240
  error estimate for blocks of size 2^( 2) =       0.000428125788
  error estimate for blocks of size 2^( 3) =       0.000441707068
  error estimate for blocks of size 2^( 4) =       0.000454349166
  error estimate for blocks of size 2^( 5) =       0.000466395301
  error estimate for blocks of size 2^( 6) =       0.000474991193
  error estimate for blocks of size 2^( 7) =       0.000481959012

      target function =                  N/A
              le_mean =     -16.905120180923
             les_mean =     286.127873959319
             stat err =       0.000469423668
             autocorr =       1.278234658345
              std dev =       0.587184639001
             le_variance =       0.344785800279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905120180669        initial
     1.5259e+02     1.5259e+03             1.3714e-06       -16.905120184723  <--
     6.1035e+02     6.1035e+03             3.4303e-07       -16.905120182696
     2.4414e+03     2.4414e+04             8.5768e-08       -16.905120180923

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 3.0305e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.086354e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284750e-02 1 1  ON 3
 uu_4                -6.886540e-02 1 1  ON 4
 uu_5                -1.047823e-01 1 1  ON 5
 uu_6                -1.332100e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384788e-03 1 1  ON 13
 ud_4                -6.200477e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525397e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512226e-02 1 1  ON 33
eH1_4                -6.060268e-03 1 1  ON 34
eH1_5                 2.892753e-02 1 1  ON 35
eH1_6                 9.081282e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071713e-01 1 1  ON 42
eH2_3                -5.241116e-02 1 1  ON 43
eH2_4                -3.911197e-03 1 1  ON 44
eH2_5                 3.112427e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6949e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8432
    reference variance = 0.149801
====================================================
  Execution time = 2.1054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3469e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334753169716
                                         uncertainty =       0.003046131011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334753169716
                                         uncertainty =       0.003046131011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409076536
  error estimate for blocks of size 2^( 2) =       0.000421717031
  error estimate for blocks of size 2^( 3) =       0.000434586335
  error estimate for blocks of size 2^( 4) =       0.000446211433
  error estimate for blocks of size 2^( 5) =       0.000456094094
  error estimate for blocks of size 2^( 6) =       0.000462535745
  error estimate for blocks of size 2^( 7) =       0.000467193334

      target function =                  N/A
              le_mean =     -16.906021745860
             les_mean =     286.148258328091
             stat err =       0.000458008652
             autocorr =       1.253540082193
              std dev =       0.578521584671
             le_variance =       0.334687223931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602174586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906021745860       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906021756342       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906021756498       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906021760018       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906021751598       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906021753636       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021752070       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906021753504       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.407948e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906021745860       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906021748488       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906021748527       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906021749403       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906021747290       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906021747806       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021747415       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906021747770       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.102647e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906021745860       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906021746518       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906021746527       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906021746746       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906021746218       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906021746347       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021746249       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906021746337       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 2.757031e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112042 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6616e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.086363e-01 1 1  ON 0
 uu_1                 1.418432e-01 1 1  ON 1
 uu_2                 3.993257e-02 1 1  ON 2
 uu_3                -2.284747e-02 1 1  ON 3
 uu_4                -6.886535e-02 1 1  ON 4
 uu_5                -1.047817e-01 1 1  ON 5
 uu_6                -1.332103e-01 1 1  ON 6
 uu_7                -1.484488e-01 1 1  ON 7
 uu_8                -1.399196e-01 1 1  ON 8
 uu_9                -1.122736e-01 1 1  ON 9
 ud_0                 4.551066e-01 1 1  ON 10
 ud_1                 1.888600e-01 1 1  ON 11
 ud_2                 6.760432e-02 1 1  ON 12
 ud_3                -4.384328e-03 1 1  ON 13
 ud_4                -6.200504e-02 1 1  ON 14
 ud_5                -1.044092e-01 1 1  ON 15
 ud_6                -1.329068e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530668e-01 1 1  ON 18
 ud_9                -1.449204e-01 1 1  ON 19
 eO_0                -7.599224e-01 1 1  ON 20
 eO_1                -4.371105e-01 1 1  ON 21
 eO_2                -1.525346e-02 1 1  ON 22
 eO_3                 3.082210e-01 1 1  ON 23
 eO_4                 5.369410e-01 1 1  ON 24
 eO_5                 5.018663e-01 1 1  ON 25
 eO_6                 2.726712e-01 1 1  ON 26
 eO_7                -3.747172e-02 1 1  ON 27
 eO_8                -2.449459e-01 1 1  ON 28
 eO_9                -1.178010e-01 1 1  ON 29
eH1_0                -2.607475e-01 1 1  ON 30
eH1_1                -1.581585e-01 1 1  ON 31
eH1_2                -1.103494e-01 1 1  ON 32
eH1_3                -5.512292e-02 1 1  ON 33
eH1_4                -6.061329e-03 1 1  ON 34
eH1_5                 2.892686e-02 1 1  ON 35
eH1_6                 9.081290e-02 1 1  ON 36
eH1_7                 1.564189e-01 1 1  ON 37
eH1_8                 2.008426e-01 1 1  ON 38
eH1_9                 1.100843e-01 1 1  ON 39
eH2_0                -2.568063e-01 1 1  ON 40
eH2_1                -1.546698e-01 1 1  ON 41
eH2_2                -1.071715e-01 1 1  ON 42
eH2_3                -5.241114e-02 1 1  ON 43
eH2_4                -3.911241e-03 1 1  ON 44
eH2_5                 3.112487e-02 1 1  ON 45
eH2_6                 9.272680e-02 1 1  ON 46
eH2_7                 1.563646e-01 1 1  ON 47
eH2_8                 2.029807e-01 1 1  ON 48
eH2_9                 1.029994e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9362
    reference variance = 0.374294
====================================================
  Execution time = 2.0508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3488e-01
  Total weights = 2.0000e+06
  Execution time = 1.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334877596400
                                         uncertainty =       0.003342249917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334877596400
                                         uncertainty =       0.003342249917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409192174
  error estimate for blocks of size 2^( 2) =       0.000421881111
  error estimate for blocks of size 2^( 3) =       0.000434720809
  error estimate for blocks of size 2^( 4) =       0.000446527815
  error estimate for blocks of size 2^( 5) =       0.000455949347
  error estimate for blocks of size 2^( 6) =       0.000463634582
  error estimate for blocks of size 2^( 7) =       0.000467570418

      target function =                  N/A
              le_mean =     -16.905644878826
             les_mean =     286.135705072749
             stat err =       0.000458420540
             autocorr =       1.255086037583
              std dev =       0.578685122693
             le_variance =       0.334876471226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334879852593
                                         uncertainty =       0.003342253817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334879852593
                                         uncertainty =       0.003342253817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409193553
  error estimate for blocks of size 2^( 2) =       0.000421882395
  error estimate for blocks of size 2^( 3) =       0.000434721983
  error estimate for blocks of size 2^( 4) =       0.000446528932
  error estimate for blocks of size 2^( 5) =       0.000455950477
  error estimate for blocks of size 2^( 6) =       0.000463635651
  error estimate for blocks of size 2^( 7) =       0.000467571549

      target function =                  N/A
              le_mean =     -16.905644848832
             les_mean =     286.135706315535
             stat err =       0.000458421652
             autocorr =       1.255083667640
              std dev =       0.578687072731
             le_variance =       0.334878728146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878731890
                                         uncertainty =       0.003342251896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878731890
                                         uncertainty =       0.003342251896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409192868
  error estimate for blocks of size 2^( 2) =       0.000421881757
  error estimate for blocks of size 2^( 3) =       0.000434721400
  error estimate for blocks of size 2^( 4) =       0.000446528377
  error estimate for blocks of size 2^( 5) =       0.000455949915
  error estimate for blocks of size 2^( 6) =       0.000463635120
  error estimate for blocks of size 2^( 7) =       0.000467570987

      target function =                  N/A
              le_mean =     -16.905644863750
             les_mean =     286.135705698897
             stat err =       0.000458421100
             autocorr =       1.255084846313
              std dev =       0.578686104105
             le_variance =       0.334877607084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334877738564
                                         uncertainty =       0.003342250165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334877738564
                                         uncertainty =       0.003342250165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409192261
  error estimate for blocks of size 2^( 2) =       0.000421881192
  error estimate for blocks of size 2^( 3) =       0.000434720883
  error estimate for blocks of size 2^( 4) =       0.000446527885
  error estimate for blocks of size 2^( 5) =       0.000455949418
  error estimate for blocks of size 2^( 6) =       0.000463634649
  error estimate for blocks of size 2^( 7) =       0.000467570489

      target function =                  N/A
              le_mean =     -16.905644876938
             les_mean =     286.135705151122
             stat err =       0.000458420610
             autocorr =       1.255085888471
              std dev =       0.578685245567
             le_variance =       0.334876613437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905644878826        initial  <--
     3.8147e+01     3.8147e+02             4.4079e-06       -16.905644848832
     1.5259e+02     1.5259e+03             1.1026e-06       -16.905644863750
     6.1035e+02     6.1035e+03             2.7570e-07       -16.905644876938

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1027
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.086354e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284750e-02 1 1  ON 3
 uu_4                -6.886540e-02 1 1  ON 4
 uu_5                -1.047823e-01 1 1  ON 5
 uu_6                -1.332100e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384788e-03 1 1  ON 13
 ud_4                -6.200477e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525397e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512226e-02 1 1  ON 33
eH1_4                -6.060268e-03 1 1  ON 34
eH1_5                 2.892753e-02 1 1  ON 35
eH1_6                 9.081282e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071713e-01 1 1  ON 42
eH2_3                -5.241116e-02 1 1  ON 43
eH2_4                -3.911197e-03 1 1  ON 44
eH2_5                 3.112427e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.200609
====================================================
  Execution time = 2.0937e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345814153195
                                         uncertainty =       0.005375692798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345814153195
                                         uncertainty =       0.005375692798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415809591
  error estimate for blocks of size 2^( 2) =       0.000428414679
  error estimate for blocks of size 2^( 3) =       0.000441126271
  error estimate for blocks of size 2^( 4) =       0.000452368603
  error estimate for blocks of size 2^( 5) =       0.000461912182
  error estimate for blocks of size 2^( 6) =       0.000469321083
  error estimate for blocks of size 2^( 7) =       0.000473973205

      target function =                  N/A
              le_mean =     -16.906248405286
             les_mean =     286.167030200065
             stat err =       0.000464393768
             autocorr =       1.247336876051
              std dev =       0.588043562773
             le_variance =       0.345795231718


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624840529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906248405286       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906248408573       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906248410168       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906248410842       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906248410351       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906248411891       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906248411675       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906248411453       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.383970e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906248405286       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906248406108       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906248406507       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906248406676       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906248406553       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906248406937       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906248406883       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906248406826       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.096020e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906248405286       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906248405492       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906248405592       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906248405633       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906248405602       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906248405701       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906248405686       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906248405668       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 2.740066e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6524e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993242e-02 1 1  ON 2
 uu_3                -2.284754e-02 1 1  ON 3
 uu_4                -6.886546e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332100e-01 1 1  ON 6
 uu_7                -1.484482e-01 1 1  ON 7
 uu_8                -1.399186e-01 1 1  ON 8
 uu_9                -1.122732e-01 1 1  ON 9
 ud_0                 4.551060e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760401e-02 1 1  ON 12
 ud_3                -4.384755e-03 1 1  ON 13
 ud_4                -6.200473e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512615e-01 1 1  ON 17
 ud_8                -1.530666e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525388e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369405e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747110e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178003e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581587e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512237e-02 1 1  ON 33
eH1_4                -6.060378e-03 1 1  ON 34
eH1_5                 2.892751e-02 1 1  ON 35
eH1_6                 9.081284e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100834e-01 1 1  ON 39
eH2_0                -2.568062e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241116e-02 1 1  ON 43
eH2_4                -3.911219e-03 1 1  ON 44
eH2_5                 3.112426e-02 1 1  ON 45
eH2_6                 9.272747e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029804e-01 1 1  ON 48
eH2_9                 1.029986e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.844
    reference variance = 0.807472
====================================================
  Execution time = 2.0570e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4777e-01
  Total weights = 2.0000e+06
  Execution time = 1.9096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347779405407
                                         uncertainty =       0.005537730244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347779405407
                                         uncertainty =       0.005537730244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416997337
  error estimate for blocks of size 2^( 2) =       0.000429616707
  error estimate for blocks of size 2^( 3) =       0.000442522463
  error estimate for blocks of size 2^( 4) =       0.000454435432
  error estimate for blocks of size 2^( 5) =       0.000464450016
  error estimate for blocks of size 2^( 6) =       0.000472091465
  error estimate for blocks of size 2^( 7) =       0.000476681028

      target function =                  N/A
              le_mean =     -16.906561214620
             les_mean =     286.179585487921
             stat err =       0.000466914485
             autocorr =       1.253741875236
              std dev =       0.589723289452
             le_variance =       0.347773558122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347779560476
                                         uncertainty =       0.005537736349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347779560476
                                         uncertainty =       0.005537736349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416997430
  error estimate for blocks of size 2^( 2) =       0.000429616793
  error estimate for blocks of size 2^( 3) =       0.000442522538
  error estimate for blocks of size 2^( 4) =       0.000454435500
  error estimate for blocks of size 2^( 5) =       0.000464450084
  error estimate for blocks of size 2^( 6) =       0.000472091526
  error estimate for blocks of size 2^( 7) =       0.000476681083

      target function =                  N/A
              le_mean =     -16.906561211209
             les_mean =     286.179585527560
             stat err =       0.000466914548
             autocorr =       1.253741655297
              std dev =       0.589723420847
             le_variance =       0.347773713096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347779482939
                                         uncertainty =       0.005537733297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347779482939
                                         uncertainty =       0.005537733297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416997383
  error estimate for blocks of size 2^( 2) =       0.000429616750
  error estimate for blocks of size 2^( 3) =       0.000442522500
  error estimate for blocks of size 2^( 4) =       0.000454435466
  error estimate for blocks of size 2^( 5) =       0.000464450050
  error estimate for blocks of size 2^( 6) =       0.000472091495
  error estimate for blocks of size 2^( 7) =       0.000476681055

      target function =                  N/A
              le_mean =     -16.906561212913
             les_mean =     286.179585507704
             stat err =       0.000466914517
             autocorr =       1.253741765237
              std dev =       0.589723355148
             le_variance =       0.347773635607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347779415098
                                         uncertainty =       0.005537730626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347779415098
                                         uncertainty =       0.005537730626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416997343
  error estimate for blocks of size 2^( 2) =       0.000429616713
  error estimate for blocks of size 2^( 3) =       0.000442522468
  error estimate for blocks of size 2^( 4) =       0.000454435436
  error estimate for blocks of size 2^( 5) =       0.000464450020
  error estimate for blocks of size 2^( 6) =       0.000472091468
  error estimate for blocks of size 2^( 7) =       0.000476681031

      target function =                  N/A
              le_mean =     -16.906561214406
             les_mean =     286.179585490392
             stat err =       0.000466914489
             autocorr =       1.253741861491
              std dev =       0.589723297664
             le_variance =       0.347773567808


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906561214620        initial  <--
     3.8147e+02     3.8147e+03             4.3840e-07       -16.906561211209
     1.5259e+03     1.5259e+04             1.0960e-07       -16.906561212913
     6.1035e+03     6.1035e+04             2.7401e-08       -16.906561214406

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1624
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.086354e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284750e-02 1 1  ON 3
 uu_4                -6.886540e-02 1 1  ON 4
 uu_5                -1.047823e-01 1 1  ON 5
 uu_6                -1.332100e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384788e-03 1 1  ON 13
 ud_4                -6.200477e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525397e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512226e-02 1 1  ON 33
eH1_4                -6.060268e-03 1 1  ON 34
eH1_5                 2.892753e-02 1 1  ON 35
eH1_6                 9.081282e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071713e-01 1 1  ON 42
eH2_3                -5.241116e-02 1 1  ON 43
eH2_4                -3.911197e-03 1 1  ON 44
eH2_5                 3.112427e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8639
    reference variance = 0.281152
====================================================
  Execution time = 2.3239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3207e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332094151968
                                         uncertainty =       0.002671879526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332094151968
                                         uncertainty =       0.002671879526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407473538
  error estimate for blocks of size 2^( 2) =       0.000420363012
  error estimate for blocks of size 2^( 3) =       0.000434239944
  error estimate for blocks of size 2^( 4) =       0.000446630285
  error estimate for blocks of size 2^( 5) =       0.000457636315
  error estimate for blocks of size 2^( 6) =       0.000466911931
  error estimate for blocks of size 2^( 7) =       0.000471201073

      target function =                  N/A
              le_mean =     -16.905763036952
             les_mean =     286.136893063754
             stat err =       0.000460594901
             autocorr =       1.277731001168
              std dev =       0.576254603638
             le_variance =       0.332069368214


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576303695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905763036952       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763037158       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763037178       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905763037206       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905763037292       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905763037238       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905763037316       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763037321       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 6.333945e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905763036952       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763037003       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763037009       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905763037018       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905763037036       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905763037020       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905763037042       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763037046       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.583545e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905763036952       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763036965       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763036966       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905763036972       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905763036963       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905763036974       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905763036995       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763036994       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.958901e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8868e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284750e-02 1 1  ON 3
 uu_4                -6.886540e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332100e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384785e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525396e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512227e-02 1 1  ON 33
eH1_4                -6.060271e-03 1 1  ON 34
eH1_5                 2.892753e-02 1 1  ON 35
eH1_6                 9.081282e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071713e-01 1 1  ON 42
eH2_3                -5.241116e-02 1 1  ON 43
eH2_4                -3.911195e-03 1 1  ON 44
eH2_5                 3.112427e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9999
    reference variance = 0.311565
====================================================
  Execution time = 2.0871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4195e-01
  Total weights = 2.0000e+06
  Execution time = 1.9255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341962819761
                                         uncertainty =       0.004068250211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341962819761
                                         uncertainty =       0.004068250211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413489892
  error estimate for blocks of size 2^( 2) =       0.000426316239
  error estimate for blocks of size 2^( 3) =       0.000439745875
  error estimate for blocks of size 2^( 4) =       0.000451238144
  error estimate for blocks of size 2^( 5) =       0.000461527822
  error estimate for blocks of size 2^( 6) =       0.000471538325
  error estimate for blocks of size 2^( 7) =       0.000477124865

      target function =                  N/A
              le_mean =     -16.906184404694
             les_mean =     286.161018736789
             stat err =       0.000465357289
             autocorr =       1.266610972942
              std dev =       0.584763013731
             le_variance =       0.341947782228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341962816001
                                         uncertainty =       0.004068250263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341962816001
                                         uncertainty =       0.004068250263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413489890
  error estimate for blocks of size 2^( 2) =       0.000426316237
  error estimate for blocks of size 2^( 3) =       0.000439745873
  error estimate for blocks of size 2^( 4) =       0.000451238142
  error estimate for blocks of size 2^( 5) =       0.000461527821
  error estimate for blocks of size 2^( 6) =       0.000471538323
  error estimate for blocks of size 2^( 7) =       0.000477124864

      target function =                  N/A
              le_mean =     -16.906184404789
             les_mean =     286.161018736276
             stat err =       0.000465357287
             autocorr =       1.266610976141
              std dev =       0.584763010555
             le_variance =       0.341947778514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341962817880
                                         uncertainty =       0.004068250237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341962817880
                                         uncertainty =       0.004068250237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413489891
  error estimate for blocks of size 2^( 2) =       0.000426316238
  error estimate for blocks of size 2^( 3) =       0.000439745874
  error estimate for blocks of size 2^( 4) =       0.000451238143
  error estimate for blocks of size 2^( 5) =       0.000461527821
  error estimate for blocks of size 2^( 6) =       0.000471538324
  error estimate for blocks of size 2^( 7) =       0.000477124865

      target function =                  N/A
              le_mean =     -16.906184404742
             les_mean =     286.161018736532
             stat err =       0.000465357288
             autocorr =       1.266610974541
              std dev =       0.584763012143
             le_variance =       0.341947780370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341962819526
                                         uncertainty =       0.004068250214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341962819526
                                         uncertainty =       0.004068250214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413489892
  error estimate for blocks of size 2^( 2) =       0.000426316239
  error estimate for blocks of size 2^( 3) =       0.000439745875
  error estimate for blocks of size 2^( 4) =       0.000451238143
  error estimate for blocks of size 2^( 5) =       0.000461527822
  error estimate for blocks of size 2^( 6) =       0.000471538325
  error estimate for blocks of size 2^( 7) =       0.000477124865

      target function =                  N/A
              le_mean =     -16.906184404700
             les_mean =     286.161018736757
             stat err =       0.000465357289
             autocorr =       1.266610973149
              std dev =       0.584763013533
             le_variance =       0.341947781996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906184404694        initial
     3.8147e+03     3.8147e+04             6.3339e-08       -16.906184404789  <--
     1.5259e+04     1.5259e+05             1.5835e-08       -16.906184404742
     6.1035e+04     6.1035e+05             3.9589e-09       -16.906184404700

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 3.0605e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993245e-02 1 1  ON 2
 uu_3                -2.284751e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760396e-02 1 1  ON 12
 ud_3                -4.384776e-03 1 1  ON 13
 ud_4                -6.200479e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525395e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512228e-02 1 1  ON 33
eH1_4                -6.060279e-03 1 1  ON 34
eH1_5                 2.892753e-02 1 1  ON 35
eH1_6                 9.081285e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241118e-02 1 1  ON 43
eH2_4                -3.911190e-03 1 1  ON 44
eH2_5                 3.112427e-02 1 1  ON 45
eH2_6                 9.272749e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9480e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9849
    reference variance = 0.164709
====================================================
  Execution time = 2.0834e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3498e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335053083476
                                         uncertainty =       0.002892100564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335053083476
                                         uncertainty =       0.002892100564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409257685
  error estimate for blocks of size 2^( 2) =       0.000422022737
  error estimate for blocks of size 2^( 3) =       0.000434831425
  error estimate for blocks of size 2^( 4) =       0.000446713829
  error estimate for blocks of size 2^( 5) =       0.000456951660
  error estimate for blocks of size 2^( 6) =       0.000464395149
  error estimate for blocks of size 2^( 7) =       0.000470238743

      target function =                  N/A
              le_mean =     -16.906761785655
             les_mean =     286.173577614917
             stat err =       0.000459574845
             autocorr =       1.261010819242
              std dev =       0.578777768680
             le_variance =       0.334983705518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690676178566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906761785655       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906761785607       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906761786137       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906761786255       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906761786031       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906761785926       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906761786161       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906761786035       residual = 1.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.775091e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906761785655       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906761785643       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906761785776       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906761785804       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906761785749       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906761785721       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906761785783       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906761785744       residual = 1.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 4.437813e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906761785655       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906761785652       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906761785685       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906761785690       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906761785679       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906761785738       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906761785664       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906761785687       residual = 1.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.109459e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6555e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993245e-02 1 1  ON 2
 uu_3                -2.284750e-02 1 1  ON 3
 uu_4                -6.886542e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551060e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384776e-03 1 1  ON 13
 ud_4                -6.200480e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525392e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747110e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178003e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512231e-02 1 1  ON 33
eH1_4                -6.060295e-03 1 1  ON 34
eH1_5                 2.892755e-02 1 1  ON 35
eH1_6                 9.081286e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100834e-01 1 1  ON 39
eH2_0                -2.568062e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241118e-02 1 1  ON 43
eH2_4                -3.911192e-03 1 1  ON 44
eH2_5                 3.112427e-02 1 1  ON 45
eH2_6                 9.272749e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029986e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.293602
====================================================
  Execution time = 2.0774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4497e-01
  Total weights = 2.0000e+06
  Execution time = 1.9189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345061365719
                                         uncertainty =       0.004040932079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345061365719
                                         uncertainty =       0.004040932079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415315071
  error estimate for blocks of size 2^( 2) =       0.000428143557
  error estimate for blocks of size 2^( 3) =       0.000440829766
  error estimate for blocks of size 2^( 4) =       0.000453510987
  error estimate for blocks of size 2^( 5) =       0.000463648545
  error estimate for blocks of size 2^( 6) =       0.000470773851
  error estimate for blocks of size 2^( 7) =       0.000477097652

      target function =                  N/A
              le_mean =     -16.906651789701
             les_mean =     286.179847782476
             stat err =       0.000466257759
             autocorr =       1.260366237382
              std dev =       0.587344206368
             le_variance =       0.344973216754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345061406627
                                         uncertainty =       0.004040932473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345061406627
                                         uncertainty =       0.004040932473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415315096
  error estimate for blocks of size 2^( 2) =       0.000428143579
  error estimate for blocks of size 2^( 3) =       0.000440829786
  error estimate for blocks of size 2^( 4) =       0.000453511003
  error estimate for blocks of size 2^( 5) =       0.000463648560
  error estimate for blocks of size 2^( 6) =       0.000470773866
  error estimate for blocks of size 2^( 7) =       0.000477097669

      target function =                  N/A
              le_mean =     -16.906651789295
             les_mean =     286.179847809586
             stat err =       0.000466257774
             autocorr =       1.260366172245
              std dev =       0.587344241146
             le_variance =       0.344973257607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345061386174
                                         uncertainty =       0.004040932276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345061386174
                                         uncertainty =       0.004040932276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415315084
  error estimate for blocks of size 2^( 2) =       0.000428143568
  error estimate for blocks of size 2^( 3) =       0.000440829776
  error estimate for blocks of size 2^( 4) =       0.000453510995
  error estimate for blocks of size 2^( 5) =       0.000463648553
  error estimate for blocks of size 2^( 6) =       0.000470773859
  error estimate for blocks of size 2^( 7) =       0.000477097660

      target function =                  N/A
              le_mean =     -16.906651789498
             les_mean =     286.179847796027
             stat err =       0.000466257767
             autocorr =       1.260366204818
              std dev =       0.587344223757
             le_variance =       0.344973237181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345061368276
                                         uncertainty =       0.004040932103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345061368276
                                         uncertainty =       0.004040932103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415315073
  error estimate for blocks of size 2^( 2) =       0.000428143558
  error estimate for blocks of size 2^( 3) =       0.000440829767
  error estimate for blocks of size 2^( 4) =       0.000453510988
  error estimate for blocks of size 2^( 5) =       0.000463648546
  error estimate for blocks of size 2^( 6) =       0.000470773852
  error estimate for blocks of size 2^( 7) =       0.000477097653

      target function =                  N/A
              le_mean =     -16.906651789676
             les_mean =     286.179847784169
             stat err =       0.000466257760
             autocorr =       1.260366233304
              std dev =       0.587344208541
             le_variance =       0.344973219307


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906651789701        initial  <--
     9.5367e+02     9.5367e+03             1.7751e-07       -16.906651789295
     3.8147e+03     3.8147e+04             4.4378e-08       -16.906651789498
     1.5259e+04     1.5259e+05             1.1095e-08       -16.906651789676

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3297
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993245e-02 1 1  ON 2
 uu_3                -2.284751e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760396e-02 1 1  ON 12
 ud_3                -4.384776e-03 1 1  ON 13
 ud_4                -6.200479e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525395e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512228e-02 1 1  ON 33
eH1_4                -6.060279e-03 1 1  ON 34
eH1_5                 2.892753e-02 1 1  ON 35
eH1_6                 9.081285e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241118e-02 1 1  ON 43
eH2_4                -3.911190e-03 1 1  ON 44
eH2_5                 3.112427e-02 1 1  ON 45
eH2_6                 9.272749e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8195
    reference variance = 0.294426
====================================================
  Execution time = 2.1146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5096e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350998622345
                                         uncertainty =       0.018181707042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350998622345
                                         uncertainty =       0.018181707042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418904088
  error estimate for blocks of size 2^( 2) =       0.000431621363
  error estimate for blocks of size 2^( 3) =       0.000444729971
  error estimate for blocks of size 2^( 4) =       0.000456264064
  error estimate for blocks of size 2^( 5) =       0.000467077840
  error estimate for blocks of size 2^( 6) =       0.000473929139
  error estimate for blocks of size 2^( 7) =       0.000477825025

      target function =                  N/A
              le_mean =     -16.906681176313
             les_mean =     286.186829492318
             stat err =       0.000468774017
             autocorr =       1.252269681613
              std dev =       0.592419842937
             le_variance =       0.350961270306


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690668117631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906681176313       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906681176277       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906681176328       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906681176350       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906681176343       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906681176322       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906681176351       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906681176356       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.000418e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906681176313       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906681176304       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906681176317       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906681176321       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906681176322       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906681176283       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906681176310       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906681176283       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.001081e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906681176313       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906681176311       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906681176314       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906681176315       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906681176241       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906681176281       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906681176499       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906681176314       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.250273e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6752e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993245e-02 1 1  ON 2
 uu_3                -2.284751e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384776e-03 1 1  ON 13
 ud_4                -6.200479e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512228e-02 1 1  ON 33
eH1_4                -6.060282e-03 1 1  ON 34
eH1_5                 2.892753e-02 1 1  ON 35
eH1_6                 9.081284e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241118e-02 1 1  ON 43
eH2_4                -3.911192e-03 1 1  ON 44
eH2_5                 3.112427e-02 1 1  ON 45
eH2_6                 9.272749e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8841
    reference variance = 0.48755
====================================================
  Execution time = 2.0405e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3787e-01
  Total weights = 2.0000e+06
  Execution time = 1.9178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337885000534
                                         uncertainty =       0.003889491877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337885000534
                                         uncertainty =       0.003889491877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411014381
  error estimate for blocks of size 2^( 2) =       0.000423675012
  error estimate for blocks of size 2^( 3) =       0.000437042159
  error estimate for blocks of size 2^( 4) =       0.000449384590
  error estimate for blocks of size 2^( 5) =       0.000461364120
  error estimate for blocks of size 2^( 6) =       0.000471411290
  error estimate for blocks of size 2^( 7) =       0.000478690850

      target function =                  N/A
              le_mean =     -16.906406000777
             les_mean =     286.164429337661
             stat err =       0.000465212713
             autocorr =       1.281117936245
              std dev =       0.581262112558
             le_variance =       0.337865643496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884989604
                                         uncertainty =       0.003889491756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884989604
                                         uncertainty =       0.003889491756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411014375
  error estimate for blocks of size 2^( 2) =       0.000423675006
  error estimate for blocks of size 2^( 3) =       0.000437042152
  error estimate for blocks of size 2^( 4) =       0.000449384584
  error estimate for blocks of size 2^( 5) =       0.000461364114
  error estimate for blocks of size 2^( 6) =       0.000471411284
  error estimate for blocks of size 2^( 7) =       0.000478690844

      target function =                  N/A
              le_mean =     -16.906406000789
             les_mean =     286.164429327147
             stat err =       0.000465212706
             autocorr =       1.281117943565
              std dev =       0.581262103153
             le_variance =       0.337865632562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884995069
                                         uncertainty =       0.003889491817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884995069
                                         uncertainty =       0.003889491817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411014378
  error estimate for blocks of size 2^( 2) =       0.000423675009
  error estimate for blocks of size 2^( 3) =       0.000437042156
  error estimate for blocks of size 2^( 4) =       0.000449384587
  error estimate for blocks of size 2^( 5) =       0.000461364117
  error estimate for blocks of size 2^( 6) =       0.000471411287
  error estimate for blocks of size 2^( 7) =       0.000478690847

      target function =                  N/A
              le_mean =     -16.906406000783
             les_mean =     286.164429332404
             stat err =       0.000465212709
             autocorr =       1.281117939904
              std dev =       0.581262107856
             le_variance =       0.337865638029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884999851
                                         uncertainty =       0.003889491870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884999851
                                         uncertainty =       0.003889491870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411014381
  error estimate for blocks of size 2^( 2) =       0.000423675012
  error estimate for blocks of size 2^( 3) =       0.000437042158
  error estimate for blocks of size 2^( 4) =       0.000449384590
  error estimate for blocks of size 2^( 5) =       0.000461364120
  error estimate for blocks of size 2^( 6) =       0.000471411290
  error estimate for blocks of size 2^( 7) =       0.000478690849

      target function =                  N/A
              le_mean =     -16.906406000777
             les_mean =     286.164429337004
             stat err =       0.000465212712
             autocorr =       1.281117936713
              std dev =       0.581262111970
             le_variance =       0.337865642812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906406000777        initial
     9.5367e+03     9.5367e+04             2.0004e-08       -16.906406000789  <--
     3.8147e+04     3.8147e+05             5.0011e-09       -16.906406000783
     1.5259e+05     1.5259e+06             1.2503e-09       -16.906406000777

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 3.0023e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993245e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384775e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060292e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911196e-03 1 1  ON 44
eH2_5                 3.112429e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9303
    reference variance = 0.230462
====================================================
  Execution time = 2.1053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3799e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338073298727
                                         uncertainty =       0.003726045790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338073298727
                                         uncertainty =       0.003726045790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411088797
  error estimate for blocks of size 2^( 2) =       0.000423500668
  error estimate for blocks of size 2^( 3) =       0.000436303139
  error estimate for blocks of size 2^( 4) =       0.000447928538
  error estimate for blocks of size 2^( 5) =       0.000457883472
  error estimate for blocks of size 2^( 6) =       0.000466261896
  error estimate for blocks of size 2^( 7) =       0.000469368274

      target function =                  N/A
              le_mean =     -16.906526895310
             les_mean =     286.168639490735
             stat err =       0.000460360545
             autocorr =       1.254079036369
              std dev =       0.581367351936
             le_variance =       0.337987997897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652689531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906526895310       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906526895483       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906526895105       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906526895215       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906526895141       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906526895047       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906526895076       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906526895119       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 9.076114e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906526895310       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906526895353       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906526895259       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906526895286       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906526895271       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906526895244       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906526895248       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906526895259       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.269055e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906526895310       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906526895321       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906526895297       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906526895304       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906526895306       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906526895293       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906526895335       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906526895287       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.672654e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6718e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886539e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384768e-03 1 1  ON 13
 ud_4                -6.200479e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525393e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178003e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512230e-02 1 1  ON 33
eH1_4                -6.060308e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911200e-03 1 1  ON 44
eH2_5                 3.112428e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029986e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8119
    reference variance = 0.229373
====================================================
  Execution time = 2.0599e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3349e-01
  Total weights = 2.0000e+06
  Execution time = 1.9220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506591303
                                         uncertainty =       0.002486862267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506591303
                                         uncertainty =       0.002486862267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408346702
  error estimate for blocks of size 2^( 2) =       0.000421656270
  error estimate for blocks of size 2^( 3) =       0.000435463995
  error estimate for blocks of size 2^( 4) =       0.000448172816
  error estimate for blocks of size 2^( 5) =       0.000460611497
  error estimate for blocks of size 2^( 6) =       0.000469442369
  error estimate for blocks of size 2^( 7) =       0.000477093665

      target function =                  N/A
              le_mean =     -16.906459309088
             les_mean =     286.161860261839
             stat err =       0.000463830087
             autocorr =       1.290207989883
              std dev =       0.577489444694
             le_variance =       0.333494058733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506581672
                                         uncertainty =       0.002486861954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506581672
                                         uncertainty =       0.002486861954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408346697
  error estimate for blocks of size 2^( 2) =       0.000421656264
  error estimate for blocks of size 2^( 3) =       0.000435463988
  error estimate for blocks of size 2^( 4) =       0.000448172809
  error estimate for blocks of size 2^( 5) =       0.000460611491
  error estimate for blocks of size 2^( 6) =       0.000469442363
  error estimate for blocks of size 2^( 7) =       0.000477093659

      target function =                  N/A
              le_mean =     -16.906459309006
             les_mean =     286.161860249437
             stat err =       0.000463830081
             autocorr =       1.290207991911
              std dev =       0.577489436350
             le_variance =       0.333494049096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506586485
                                         uncertainty =       0.002486862111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506586485
                                         uncertainty =       0.002486862111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408346699
  error estimate for blocks of size 2^( 2) =       0.000421656267
  error estimate for blocks of size 2^( 3) =       0.000435463992
  error estimate for blocks of size 2^( 4) =       0.000448172813
  error estimate for blocks of size 2^( 5) =       0.000460611494
  error estimate for blocks of size 2^( 6) =       0.000469442366
  error estimate for blocks of size 2^( 7) =       0.000477093662

      target function =                  N/A
              le_mean =     -16.906459309047
             les_mean =     286.161860255635
             stat err =       0.000463830084
             autocorr =       1.290207990892
              std dev =       0.577489440520
             le_variance =       0.333494053912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506590700
                                         uncertainty =       0.002486862248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506590700
                                         uncertainty =       0.002486862248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408346702
  error estimate for blocks of size 2^( 2) =       0.000421656270
  error estimate for blocks of size 2^( 3) =       0.000435463994
  error estimate for blocks of size 2^( 4) =       0.000448172816
  error estimate for blocks of size 2^( 5) =       0.000460611497
  error estimate for blocks of size 2^( 6) =       0.000469442369
  error estimate for blocks of size 2^( 7) =       0.000477093665

      target function =                  N/A
              le_mean =     -16.906459309083
             les_mean =     286.161860261063
             stat err =       0.000463830087
             autocorr =       1.290207990010
              std dev =       0.577489444172
             le_variance =       0.333494058130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906459309088        initial  <--
     2.3842e+03     2.3842e+04             9.0761e-08       -16.906459309006
     9.5367e+03     9.5367e+04             2.2691e-08       -16.906459309047
     3.8147e+04     3.8147e+05             5.6727e-09       -16.906459309083

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2322
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993245e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384775e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060292e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911196e-03 1 1  ON 44
eH2_5                 3.112429e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.0048
    reference variance = 0.308716
====================================================
  Execution time = 2.0831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6128e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361322265690
                                         uncertainty =       0.023748415976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361322265690
                                         uncertainty =       0.023748415976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425015975
  error estimate for blocks of size 2^( 2) =       0.000437635001
  error estimate for blocks of size 2^( 3) =       0.000450289937
  error estimate for blocks of size 2^( 4) =       0.000462494543
  error estimate for blocks of size 2^( 5) =       0.000475066607
  error estimate for blocks of size 2^( 6) =       0.000482695106
  error estimate for blocks of size 2^( 7) =       0.000486540511

      target function =                  N/A
              le_mean =     -16.906186379648
             les_mean =     286.180414880058
             stat err =       0.000476699192
             autocorr =       1.257993288842
              std dev =       0.601063355493
             le_variance =       0.361277157317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618637965e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906186379648       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906186379651       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906186379638       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906186379642       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186379646       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906186379671       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906186379638       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 8.429881e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906186379648       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906186379648       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906186379645       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906186379642       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186380127       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906186379982       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906186379686       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.107482e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906186379648       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906186379648       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906186379647       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906186379643       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186379523       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906186379818       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906186379987       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.268719e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6396e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993245e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384775e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060293e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911195e-03 1 1  ON 44
eH2_5                 3.112429e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8462
    reference variance = 0.231339
====================================================
  Execution time = 2.0489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3726e-01
  Total weights = 2.0000e+06
  Execution time = 1.9226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337196160357
                                         uncertainty =       0.002997209162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337196160357
                                         uncertainty =       0.002997209162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410643918
  error estimate for blocks of size 2^( 2) =       0.000423732226
  error estimate for blocks of size 2^( 3) =       0.000437082188
  error estimate for blocks of size 2^( 4) =       0.000449490423
  error estimate for blocks of size 2^( 5) =       0.000461743643
  error estimate for blocks of size 2^( 6) =       0.000470696330
  error estimate for blocks of size 2^( 7) =       0.000482160153

      target function =                  N/A
              le_mean =     -16.904934409516
             les_mean =     286.114064075708
             stat err =       0.000466022637
             autocorr =       1.287903243342
              std dev =       0.580738197725
             le_variance =       0.337256854297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337196163472
                                         uncertainty =       0.002997209212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337196163472
                                         uncertainty =       0.002997209212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410643920
  error estimate for blocks of size 2^( 2) =       0.000423732228
  error estimate for blocks of size 2^( 3) =       0.000437082190
  error estimate for blocks of size 2^( 4) =       0.000449490425
  error estimate for blocks of size 2^( 5) =       0.000461743645
  error estimate for blocks of size 2^( 6) =       0.000470696331
  error estimate for blocks of size 2^( 7) =       0.000482160155

      target function =                  N/A
              le_mean =     -16.904934409499
             les_mean =     286.114064078261
             stat err =       0.000466022639
             autocorr =       1.287903241610
              std dev =       0.580738200408
             le_variance =       0.337256857413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337196161914
                                         uncertainty =       0.002997209187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337196161914
                                         uncertainty =       0.002997209187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410643919
  error estimate for blocks of size 2^( 2) =       0.000423732227
  error estimate for blocks of size 2^( 3) =       0.000437082189
  error estimate for blocks of size 2^( 4) =       0.000449490424
  error estimate for blocks of size 2^( 5) =       0.000461743644
  error estimate for blocks of size 2^( 6) =       0.000470696331
  error estimate for blocks of size 2^( 7) =       0.000482160154

      target function =                  N/A
              le_mean =     -16.904934409508
             les_mean =     286.114064076985
             stat err =       0.000466022638
             autocorr =       1.287903242484
              std dev =       0.580738199067
             le_variance =       0.337256855855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337196160551
                                         uncertainty =       0.002997209165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337196160551
                                         uncertainty =       0.002997209165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410643918
  error estimate for blocks of size 2^( 2) =       0.000423732226
  error estimate for blocks of size 2^( 3) =       0.000437082188
  error estimate for blocks of size 2^( 4) =       0.000449490423
  error estimate for blocks of size 2^( 5) =       0.000461743643
  error estimate for blocks of size 2^( 6) =       0.000470696330
  error estimate for blocks of size 2^( 7) =       0.000482160153

      target function =                  N/A
              le_mean =     -16.904934409515
             les_mean =     286.114064075868
             stat err =       0.000466022637
             autocorr =       1.287903243242
              std dev =       0.580738197893
             le_variance =       0.337256854492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904934409516        initial  <--
     2.3842e+04     2.3842e+05             8.4299e-09       -16.904934409499
     9.5367e+04     9.5367e+05             2.1075e-09       -16.904934409508
     3.8147e+05     3.8147e+06             5.2687e-10       -16.904934409515

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2339
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993245e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384775e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060292e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911196e-03 1 1  ON 44
eH2_5                 3.112429e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9469
    reference variance = 0.235568
====================================================
  Execution time = 2.2264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3939e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339393233217
                                         uncertainty =       0.003798539087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339393233217
                                         uncertainty =       0.003798539087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411940451
  error estimate for blocks of size 2^( 2) =       0.000425249419
  error estimate for blocks of size 2^( 3) =       0.000438274679
  error estimate for blocks of size 2^( 4) =       0.000451297429
  error estimate for blocks of size 2^( 5) =       0.000463305084
  error estimate for blocks of size 2^( 6) =       0.000472234588
  error estimate for blocks of size 2^( 7) =       0.000479426048

      target function =                  N/A
              le_mean =     -16.905684573737
             les_mean =     286.141560607427
             stat err =       0.000466565787
             autocorr =       1.282793934335
              std dev =       0.582571772785
             le_variance =       0.339389870445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568457374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905684573737       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905684573739       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905684573740       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905684573724       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905684573829       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905684573634       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905684573765       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905684573713       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 9.096375e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905684573737       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905684573737       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905684573737       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905684573737       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905684574439       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905684574230       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905684574302       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905684573756       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.274097e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905684573737       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905684573737       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905684573737       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905684573737       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905684573737       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905684572927       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905684575605       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905684573623       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 5.685234e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8198e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384775e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060292e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911196e-03 1 1  ON 44
eH2_5                 3.112429e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9428
    reference variance = 0.129957
====================================================
  Execution time = 2.1006e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3454e-01
  Total weights = 2.0000e+06
  Execution time = 1.9028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591018768
                                         uncertainty =       0.004313394509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591018768
                                         uncertainty =       0.004313394509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408985820
  error estimate for blocks of size 2^( 2) =       0.000421897267
  error estimate for blocks of size 2^( 3) =       0.000434504557
  error estimate for blocks of size 2^( 4) =       0.000447041722
  error estimate for blocks of size 2^( 5) =       0.000457019630
  error estimate for blocks of size 2^( 6) =       0.000464750391
  error estimate for blocks of size 2^( 7) =       0.000469388229

      target function =                  N/A
              le_mean =     -16.905902167931
             les_mean =     286.144066745903
             stat err =       0.000459549993
             autocorr =       1.262551279263
              std dev =       0.578393293127
             le_variance =       0.334538801534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591018872
                                         uncertainty =       0.004313394516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591018872
                                         uncertainty =       0.004313394516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408985820
  error estimate for blocks of size 2^( 2) =       0.000421897267
  error estimate for blocks of size 2^( 3) =       0.000434504557
  error estimate for blocks of size 2^( 4) =       0.000447041722
  error estimate for blocks of size 2^( 5) =       0.000457019630
  error estimate for blocks of size 2^( 6) =       0.000464750391
  error estimate for blocks of size 2^( 7) =       0.000469388229

      target function =                  N/A
              le_mean =     -16.905902167932
             les_mean =     286.144066746059
             stat err =       0.000459549993
             autocorr =       1.262551279133
              std dev =       0.578393293216
             le_variance =       0.334538801638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591018820
                                         uncertainty =       0.004313394512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591018820
                                         uncertainty =       0.004313394512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408985820
  error estimate for blocks of size 2^( 2) =       0.000421897267
  error estimate for blocks of size 2^( 3) =       0.000434504557
  error estimate for blocks of size 2^( 4) =       0.000447041722
  error estimate for blocks of size 2^( 5) =       0.000457019630
  error estimate for blocks of size 2^( 6) =       0.000464750391
  error estimate for blocks of size 2^( 7) =       0.000469388229

      target function =                  N/A
              le_mean =     -16.905902167931
             les_mean =     286.144066745981
             stat err =       0.000459549993
             autocorr =       1.262551279195
              std dev =       0.578393293171
             le_variance =       0.334538801586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591018775
                                         uncertainty =       0.004313394509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591018775
                                         uncertainty =       0.004313394509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408985820
  error estimate for blocks of size 2^( 2) =       0.000421897267
  error estimate for blocks of size 2^( 3) =       0.000434504557
  error estimate for blocks of size 2^( 4) =       0.000447041722
  error estimate for blocks of size 2^( 5) =       0.000457019630
  error estimate for blocks of size 2^( 6) =       0.000464750391
  error estimate for blocks of size 2^( 7) =       0.000469388229

      target function =                  N/A
              le_mean =     -16.905902167931
             les_mean =     286.144066745912
             stat err =       0.000459549993
             autocorr =       1.262551279263
              std dev =       0.578393293132
             le_variance =       0.334538801540


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905902167931        initial
     2.3842e+05     2.3842e+06             9.0964e-10       -16.905902167932  <--
     9.5367e+05     9.5367e+06             2.2741e-10       -16.905902167931
     3.8147e+06     3.8147e+07             5.6852e-11       -16.905902167931

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 3.0565e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384775e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060293e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911196e-03 1 1  ON 44
eH2_5                 3.112429e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.854
    reference variance = 0.422672
====================================================
  Execution time = 2.1297e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4169e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341794743516
                                         uncertainty =       0.004530782900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341794743516
                                         uncertainty =       0.004530782900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413335178
  error estimate for blocks of size 2^( 2) =       0.000425993471
  error estimate for blocks of size 2^( 3) =       0.000438588036
  error estimate for blocks of size 2^( 4) =       0.000450551801
  error estimate for blocks of size 2^( 5) =       0.000458782198
  error estimate for blocks of size 2^( 6) =       0.000465000650
  error estimate for blocks of size 2^( 7) =       0.000469569296

      target function =                  N/A
              le_mean =     -16.905926298634
             les_mean =     286.152035782349
             stat err =       0.000460975986
             autocorr =       1.243803764776
              std dev =       0.584544214202
             le_variance =       0.341691938357


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592629863e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926298634       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926298644       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926298658       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926298658       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926298674       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926298667       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926298666       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926298678       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.031209e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926298634       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926298636       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926298640       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926298574       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926298719       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926298640       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926298640       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926298724       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 7.578025e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926298634       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926298634       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926298635       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926297856       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926297536       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926298703       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926298284       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926298602       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 1.894503e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7000e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384775e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060293e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911196e-03 1 1  ON 44
eH2_5                 3.112429e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8467
    reference variance = 0.208501
====================================================
  Execution time = 2.0739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3095e-01
  Total weights = 2.0000e+06
  Execution time = 1.9132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331049078166
                                         uncertainty =       0.002781551868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331049078166
                                         uncertainty =       0.002781551868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406787505
  error estimate for blocks of size 2^( 2) =       0.000419603532
  error estimate for blocks of size 2^( 3) =       0.000433135959
  error estimate for blocks of size 2^( 4) =       0.000445512053
  error estimate for blocks of size 2^( 5) =       0.000456993197
  error estimate for blocks of size 2^( 6) =       0.000464227453
  error estimate for blocks of size 2^( 7) =       0.000468322116

      target function =                  N/A
              le_mean =     -16.905848623690
             les_mean =     286.138669669467
             stat err =       0.000458763705
             autocorr =       1.271870498905
              std dev =       0.575284406040
             le_variance =       0.330952147832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331049078204
                                         uncertainty =       0.002781551853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331049078204
                                         uncertainty =       0.002781551853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406787505
  error estimate for blocks of size 2^( 2) =       0.000419603532
  error estimate for blocks of size 2^( 3) =       0.000433135959
  error estimate for blocks of size 2^( 4) =       0.000445512053
  error estimate for blocks of size 2^( 5) =       0.000456993197
  error estimate for blocks of size 2^( 6) =       0.000464227453
  error estimate for blocks of size 2^( 7) =       0.000468322116

      target function =                  N/A
              le_mean =     -16.905848623697
             les_mean =     286.138669669747
             stat err =       0.000458763705
             autocorr =       1.271870499032
              std dev =       0.575284406072
             le_variance =       0.330952147870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331049078185
                                         uncertainty =       0.002781551860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331049078185
                                         uncertainty =       0.002781551860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406787505
  error estimate for blocks of size 2^( 2) =       0.000419603532
  error estimate for blocks of size 2^( 3) =       0.000433135959
  error estimate for blocks of size 2^( 4) =       0.000445512053
  error estimate for blocks of size 2^( 5) =       0.000456993197
  error estimate for blocks of size 2^( 6) =       0.000464227453
  error estimate for blocks of size 2^( 7) =       0.000468322116

      target function =                  N/A
              le_mean =     -16.905848623693
             les_mean =     286.138669669607
             stat err =       0.000458763705
             autocorr =       1.271870498963
              std dev =       0.575284406056
             le_variance =       0.330952147851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331049078168
                                         uncertainty =       0.002781551867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331049078168
                                         uncertainty =       0.002781551867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406787505
  error estimate for blocks of size 2^( 2) =       0.000419603532
  error estimate for blocks of size 2^( 3) =       0.000433135959
  error estimate for blocks of size 2^( 4) =       0.000445512053
  error estimate for blocks of size 2^( 5) =       0.000456993197
  error estimate for blocks of size 2^( 6) =       0.000464227453
  error estimate for blocks of size 2^( 7) =       0.000468322116

      target function =                  N/A
              le_mean =     -16.905848623690
             les_mean =     286.138669669484
             stat err =       0.000458763705
             autocorr =       1.271870498908
              std dev =       0.575284406042
             le_variance =       0.330952147835


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905848623690        initial
     5.9605e+04     5.9605e+05             3.0312e-09       -16.905848623697  <--
     2.3842e+05     2.3842e+06             7.5780e-10       -16.905848623693
     9.5367e+05     9.5367e+06             1.8945e-10       -16.905848623690

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 3.0283e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384776e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060295e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911195e-03 1 1  ON 44
eH2_5                 3.112429e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7289e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.888
    reference variance = 0.171829
====================================================
  Execution time = 2.0949e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3463e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334712747452
                                         uncertainty =       0.003758396941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334712747452
                                         uncertainty =       0.003758396941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409041398
  error estimate for blocks of size 2^( 2) =       0.000421920211
  error estimate for blocks of size 2^( 3) =       0.000434949318
  error estimate for blocks of size 2^( 4) =       0.000447958819
  error estimate for blocks of size 2^( 5) =       0.000458738668
  error estimate for blocks of size 2^( 6) =       0.000466851480
  error estimate for blocks of size 2^( 7) =       0.000473509447

      target function =                  N/A
              le_mean =     -16.905551566888
             les_mean =     286.132303344227
             stat err =       0.000461764603
             autocorr =       1.274402895038
              std dev =       0.578471892877
             le_variance =       0.334629730849


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555156689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905551566888       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905551566936       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905551566954       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905551566965       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905551566987       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551566999       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905551566993       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905551566999       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.409772e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905551566888       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905551566900       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905551566904       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905551566903       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905551566911       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551566933       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905551566905       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905551566874       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.524461e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905551566888       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905551566891       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905551566892       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905551566890       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905551566847       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551567014       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905551566959       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905551566865       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 8.811173e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6673e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284752e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384775e-03 1 1  ON 13
 ud_4                -6.200479e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525394e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060297e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911197e-03 1 1  ON 44
eH2_5                 3.112428e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9115
    reference variance = 0.308095
====================================================
  Execution time = 2.0663e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3761e-01
  Total weights = 2.0000e+06
  Execution time = 1.9132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337522702268
                                         uncertainty =       0.003482742201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337522702268
                                         uncertainty =       0.003482742201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410861013
  error estimate for blocks of size 2^( 2) =       0.000423621276
  error estimate for blocks of size 2^( 3) =       0.000437051876
  error estimate for blocks of size 2^( 4) =       0.000449115232
  error estimate for blocks of size 2^( 5) =       0.000459402468
  error estimate for blocks of size 2^( 6) =       0.000468581650
  error estimate for blocks of size 2^( 7) =       0.000473491318

      target function =                  N/A
              le_mean =     -16.905526906210
             les_mean =     286.134453351119
             stat err =       0.000462647667
             autocorr =       1.267975577036
              std dev =       0.581045216263
             le_variance =       0.337613543342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337522699815
                                         uncertainty =       0.003482742167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337522699815
                                         uncertainty =       0.003482742167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410861011
  error estimate for blocks of size 2^( 2) =       0.000423621275
  error estimate for blocks of size 2^( 3) =       0.000437051875
  error estimate for blocks of size 2^( 4) =       0.000449115230
  error estimate for blocks of size 2^( 5) =       0.000459402466
  error estimate for blocks of size 2^( 6) =       0.000468581649
  error estimate for blocks of size 2^( 7) =       0.000473491317

      target function =                  N/A
              le_mean =     -16.905526906304
             les_mean =     286.134453351863
             stat err =       0.000462647666
             autocorr =       1.267975578664
              std dev =       0.581045214149
             le_variance =       0.337613540885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337522701041
                                         uncertainty =       0.003482742184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337522701041
                                         uncertainty =       0.003482742184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410861012
  error estimate for blocks of size 2^( 2) =       0.000423621275
  error estimate for blocks of size 2^( 3) =       0.000437051876
  error estimate for blocks of size 2^( 4) =       0.000449115231
  error estimate for blocks of size 2^( 5) =       0.000459402467
  error estimate for blocks of size 2^( 6) =       0.000468581650
  error estimate for blocks of size 2^( 7) =       0.000473491317

      target function =                  N/A
              le_mean =     -16.905526906257
             les_mean =     286.134453351491
             stat err =       0.000462647666
             autocorr =       1.267975577857
              std dev =       0.581045215206
             le_variance =       0.337613542113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337522702115
                                         uncertainty =       0.003482742199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337522702115
                                         uncertainty =       0.003482742199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410861013
  error estimate for blocks of size 2^( 2) =       0.000423621276
  error estimate for blocks of size 2^( 3) =       0.000437051876
  error estimate for blocks of size 2^( 4) =       0.000449115232
  error estimate for blocks of size 2^( 5) =       0.000459402468
  error estimate for blocks of size 2^( 6) =       0.000468581650
  error estimate for blocks of size 2^( 7) =       0.000473491318

      target function =                  N/A
              le_mean =     -16.905526906216
             les_mean =     286.134453351165
             stat err =       0.000462647667
             autocorr =       1.267975577143
              std dev =       0.581045216131
             le_variance =       0.337613543188


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905526906210        initial
     1.4901e+04     1.4901e+05             1.4098e-08       -16.905526906304  <--
     5.9605e+04     5.9605e+05             3.5245e-09       -16.905526906257
     2.3842e+05     2.3842e+06             8.8112e-10       -16.905526906216

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 3.0220e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284753e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760397e-02 1 1  ON 12
 ud_3                -4.384770e-03 1 1  ON 13
 ud_4                -6.200479e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525393e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178002e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512229e-02 1 1  ON 33
eH1_4                -6.060301e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100833e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911200e-03 1 1  ON 44
eH2_5                 3.112428e-02 1 1  ON 45
eH2_6                 9.272749e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029986e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6899e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.0547
    reference variance = 0.610819
====================================================
  Execution time = 2.1287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3484e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334897732618
                                         uncertainty =       0.004241216164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334897732618
                                         uncertainty =       0.004241216164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409170175
  error estimate for blocks of size 2^( 2) =       0.000421895582
  error estimate for blocks of size 2^( 3) =       0.000434720551
  error estimate for blocks of size 2^( 4) =       0.000446259221
  error estimate for blocks of size 2^( 5) =       0.000456948034
  error estimate for blocks of size 2^( 6) =       0.000464715220
  error estimate for blocks of size 2^( 7) =       0.000469918813

      target function =                  N/A
              le_mean =     -16.906340886672
             les_mean =     286.159202473083
             stat err =       0.000459460322
             autocorr =       1.260921603034
              std dev =       0.578654010732
             le_variance =       0.334840464136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634088667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906340886672       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906340886506       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906340886570       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906340886787       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906340886813       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906340886785       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906340886776       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906340886746       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.718835e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906340886672       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906340886631       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906340886647       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906340886701       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906340886708       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906340886701       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906340886700       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906340886695       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.429773e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906340886672       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906340886662       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906340886666       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906340886688       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906340886711       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906340886663       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906340886675       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906340886692       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.574471e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6921e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284754e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399185e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760398e-02 1 1  ON 12
 ud_3                -4.384765e-03 1 1  ON 13
 ud_4                -6.200479e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525392e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369404e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178003e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512230e-02 1 1  ON 33
eH1_4                -6.060303e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081282e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100834e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911201e-03 1 1  ON 44
eH2_5                 3.112428e-02 1 1  ON 45
eH2_6                 9.272749e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029986e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.964
    reference variance = 0.341264
====================================================
  Execution time = 2.0766e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4428e-01
  Total weights = 2.0000e+06
  Execution time = 1.9010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344283240403
                                         uncertainty =       0.005450348934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344283240403
                                         uncertainty =       0.005450348934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414899422
  error estimate for blocks of size 2^( 2) =       0.000427798661
  error estimate for blocks of size 2^( 3) =       0.000440891747
  error estimate for blocks of size 2^( 4) =       0.000453485204
  error estimate for blocks of size 2^( 5) =       0.000464621812
  error estimate for blocks of size 2^( 6) =       0.000473426271
  error estimate for blocks of size 2^( 7) =       0.000479976564

      target function =                  N/A
              le_mean =     -16.907175521645
             les_mean =     286.196867009000
             stat err =       0.000467877463
             autocorr =       1.271682197013
              std dev =       0.586756390199
             le_variance =       0.344283061440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344283250617
                                         uncertainty =       0.005450345670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344283250617
                                         uncertainty =       0.005450345670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414899429
  error estimate for blocks of size 2^( 2) =       0.000427798667
  error estimate for blocks of size 2^( 3) =       0.000440891752
  error estimate for blocks of size 2^( 4) =       0.000453485208
  error estimate for blocks of size 2^( 5) =       0.000464621815
  error estimate for blocks of size 2^( 6) =       0.000473426273
  error estimate for blocks of size 2^( 7) =       0.000479976568

      target function =                  N/A
              le_mean =     -16.907175521806
             les_mean =     286.196867024675
             stat err =       0.000467877466
             autocorr =       1.271682177664
              std dev =       0.586756398901
             le_variance =       0.344283071651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344283245511
                                         uncertainty =       0.005450347302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344283245511
                                         uncertainty =       0.005450347302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414899425
  error estimate for blocks of size 2^( 2) =       0.000427798664
  error estimate for blocks of size 2^( 3) =       0.000440891749
  error estimate for blocks of size 2^( 4) =       0.000453485206
  error estimate for blocks of size 2^( 5) =       0.000464621813
  error estimate for blocks of size 2^( 6) =       0.000473426272
  error estimate for blocks of size 2^( 7) =       0.000479976566

      target function =                  N/A
              le_mean =     -16.907175521726
             les_mean =     286.196867016838
             stat err =       0.000467877464
             autocorr =       1.271682187334
              std dev =       0.586756394551
             le_variance =       0.344283066546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344283241042
                                         uncertainty =       0.005450348730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344283241042
                                         uncertainty =       0.005450348730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414899423
  error estimate for blocks of size 2^( 2) =       0.000427798661
  error estimate for blocks of size 2^( 3) =       0.000440891747
  error estimate for blocks of size 2^( 4) =       0.000453485204
  error estimate for blocks of size 2^( 5) =       0.000464621812
  error estimate for blocks of size 2^( 6) =       0.000473426271
  error estimate for blocks of size 2^( 7) =       0.000479976564

      target function =                  N/A
              le_mean =     -16.907175521655
             les_mean =     286.196867009980
             stat err =       0.000467877463
             autocorr =       1.271682195810
              std dev =       0.586756390743
             le_variance =       0.344283062078


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907175521645        initial
     3.7253e+03     3.7253e+04             5.7188e-08       -16.907175521806  <--
     1.4901e+04     1.4901e+05             1.4298e-08       -16.907175521726
     5.9605e+04     5.9605e+05             3.5745e-09       -16.907175521655

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 3.0380e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993245e-02 1 1  ON 2
 uu_3                -2.284754e-02 1 1  ON 3
 uu_4                -6.886541e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332100e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399186e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551060e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760401e-02 1 1  ON 12
 ud_3                -4.384752e-03 1 1  ON 13
 ud_4                -6.200478e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530665e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525392e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369405e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747108e-02 1 1  ON 27
 eO_8                -2.449453e-01 1 1  ON 28
 eO_9                -1.178003e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512231e-02 1 1  ON 33
eH1_4                -6.060308e-03 1 1  ON 34
eH1_5                 2.892751e-02 1 1  ON 35
eH1_6                 9.081281e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100834e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071714e-01 1 1  ON 42
eH2_3                -5.241119e-02 1 1  ON 43
eH2_4                -3.911202e-03 1 1  ON 44
eH2_5                 3.112427e-02 1 1  ON 45
eH2_6                 9.272751e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029803e-01 1 1  ON 48
eH2_9                 1.029986e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7307e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8886
    reference variance = 0.218711
====================================================
  Execution time = 2.1173e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5755e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357664160970
                                         uncertainty =       0.011092589686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357664160970
                                         uncertainty =       0.011092589686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422820125
  error estimate for blocks of size 2^( 2) =       0.000435215887
  error estimate for blocks of size 2^( 3) =       0.000448043801
  error estimate for blocks of size 2^( 4) =       0.000460453733
  error estimate for blocks of size 2^( 5) =       0.000468799298
  error estimate for blocks of size 2^( 6) =       0.000477237063
  error estimate for blocks of size 2^( 7) =       0.000483408895

      target function =                  N/A
              le_mean =     -16.906864224851
             les_mean =     286.199611455414
             stat err =       0.000472474747
             autocorr =       1.248664894025
              std dev =       0.597957955579
             le_variance =       0.357553716640


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690686422485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906864224851       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906864225382       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906864225971       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906864225870       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906864225617       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906864225778       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906864225724       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906864225717       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.168584e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906864224851       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906864224984       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906864225131       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906864225106       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906864225043       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906864225083       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906864225068       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906864225063       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.421561e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906864224851       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906864224884       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906864224921       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906864224915       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906864224889       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906864224905       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906864224914       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906864224905       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.355397e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6771e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.086354e-01 1 1  ON 0
 uu_1                 1.418429e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.284755e-02 1 1  ON 3
 uu_4                -6.886540e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332100e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399186e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551060e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760402e-02 1 1  ON 12
 ud_3                -4.384750e-03 1 1  ON 13
 ud_4                -6.200480e-02 1 1  ON 14
 ud_5                -1.044091e-01 1 1  ON 15
 ud_6                -1.329066e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530666e-01 1 1  ON 18
 ud_9                -1.449205e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371108e-01 1 1  ON 21
 eO_2                -1.525390e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369405e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747110e-02 1 1  ON 27
 eO_8                -2.449454e-01 1 1  ON 28
 eO_9                -1.178003e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512236e-02 1 1  ON 33
eH1_4                -6.060332e-03 1 1  ON 34
eH1_5                 2.892752e-02 1 1  ON 35
eH1_6                 9.081281e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008421e-01 1 1  ON 38
eH1_9                 1.100834e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546691e-01 1 1  ON 41
eH2_2                -1.071715e-01 1 1  ON 42
eH2_3                -5.241120e-02 1 1  ON 43
eH2_4                -3.911199e-03 1 1  ON 44
eH2_5                 3.112422e-02 1 1  ON 45
eH2_6                 9.272748e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029804e-01 1 1  ON 48
eH2_9                 1.029986e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8707
    reference variance = 0.412038
====================================================
  Execution time = 2.0597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3484e-01
  Total weights = 2.0000e+06
  Execution time = 1.9167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334934947270
                                         uncertainty =       0.004139714442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334934947270
                                         uncertainty =       0.004139714442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409171129
  error estimate for blocks of size 2^( 2) =       0.000421671129
  error estimate for blocks of size 2^( 3) =       0.000434341783
  error estimate for blocks of size 2^( 4) =       0.000445983765
  error estimate for blocks of size 2^( 5) =       0.000456334350
  error estimate for blocks of size 2^( 6) =       0.000463543764
  error estimate for blocks of size 2^( 7) =       0.000467909477

      target function =                  N/A
              le_mean =     -16.906471109245
             les_mean =     286.163607226364
             stat err =       0.000458442839
             autocorr =       1.255337264510
              std dev =       0.578655360334
             le_variance =       0.334842026044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334934923258
                                         uncertainty =       0.004139715397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334934923258
                                         uncertainty =       0.004139715397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409171115
  error estimate for blocks of size 2^( 2) =       0.000421671116
  error estimate for blocks of size 2^( 3) =       0.000434341770
  error estimate for blocks of size 2^( 4) =       0.000445983751
  error estimate for blocks of size 2^( 5) =       0.000456334336
  error estimate for blocks of size 2^( 6) =       0.000463543747
  error estimate for blocks of size 2^( 7) =       0.000467909464

      target function =                  N/A
              le_mean =     -16.906471109746
             les_mean =     286.163607219367
             stat err =       0.000458442824
             autocorr =       1.255337275144
              std dev =       0.578655339657
             le_variance =       0.334842002114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334934935254
                                         uncertainty =       0.004139714920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334934935254
                                         uncertainty =       0.004139714920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409171122
  error estimate for blocks of size 2^( 2) =       0.000421671122
  error estimate for blocks of size 2^( 3) =       0.000434341776
  error estimate for blocks of size 2^( 4) =       0.000445983758
  error estimate for blocks of size 2^( 5) =       0.000456334343
  error estimate for blocks of size 2^( 6) =       0.000463543755
  error estimate for blocks of size 2^( 7) =       0.000467909470

      target function =                  N/A
              le_mean =     -16.906471109496
             les_mean =     286.163607222857
             stat err =       0.000458442832
             autocorr =       1.255337269839
              std dev =       0.578655349987
             le_variance =       0.334842014069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334934945768
                                         uncertainty =       0.004139714502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334934945768
                                         uncertainty =       0.004139714502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409171128
  error estimate for blocks of size 2^( 2) =       0.000421671128
  error estimate for blocks of size 2^( 3) =       0.000434341782
  error estimate for blocks of size 2^( 4) =       0.000445983764
  error estimate for blocks of size 2^( 5) =       0.000456334349
  error estimate for blocks of size 2^( 6) =       0.000463543763
  error estimate for blocks of size 2^( 7) =       0.000467909476

      target function =                  N/A
              le_mean =     -16.906471109276
             les_mean =     286.163607225925
             stat err =       0.000458442838
             autocorr =       1.255337265187
              std dev =       0.578655359041
             le_variance =       0.334842024546


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906471109245        initial
     9.3132e+02     9.3132e+03             2.1686e-07       -16.906471109746  <--
     3.7253e+03     3.7253e+04             5.4216e-08       -16.906471109496
     1.4901e+04     1.4901e+05             1.3554e-08       -16.906471109276

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 3.0304e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.086354e-01 1 1  ON 0
 uu_1                 1.418429e-01 1 1  ON 1
 uu_2                 3.993249e-02 1 1  ON 2
 uu_3                -2.284755e-02 1 1  ON 3
 uu_4                -6.886539e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332100e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399187e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551060e-01 1 1  ON 10
 ud_1                 1.888598e-01 1 1  ON 11
 ud_2                 6.760406e-02 1 1  ON 12
 ud_3                -4.384741e-03 1 1  ON 13
 ud_4                -6.200486e-02 1 1  ON 14
 ud_5                -1.044090e-01 1 1  ON 15
 ud_6                -1.329067e-01 1 1  ON 16
 ud_7                -1.512615e-01 1 1  ON 17
 ud_8                -1.530666e-01 1 1  ON 18
 ud_9                -1.449204e-01 1 1  ON 19
 eO_0                -7.599228e-01 1 1  ON 20
 eO_1                -4.371107e-01 1 1  ON 21
 eO_2                -1.525384e-02 1 1  ON 22
 eO_3                 3.082212e-01 1 1  ON 23
 eO_4                 5.369406e-01 1 1  ON 24
 eO_5                 5.018659e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747114e-02 1 1  ON 27
 eO_8                -2.449454e-01 1 1  ON 28
 eO_9                -1.178004e-01 1 1  ON 29
eH1_0                -2.607478e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103492e-01 1 1  ON 32
eH1_3                -5.512250e-02 1 1  ON 33
eH1_4                -6.060403e-03 1 1  ON 34
eH1_5                 2.892757e-02 1 1  ON 35
eH1_6                 9.081283e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008422e-01 1 1  ON 38
eH1_9                 1.100836e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546690e-01 1 1  ON 41
eH2_2                -1.071716e-01 1 1  ON 42
eH2_3                -5.241124e-02 1 1  ON 43
eH2_4                -3.911189e-03 1 1  ON 44
eH2_5                 3.112408e-02 1 1  ON 45
eH2_6                 9.272741e-02 1 1  ON 46
eH2_7                 1.563648e-01 1 1  ON 47
eH2_8                 2.029805e-01 1 1  ON 48
eH2_9                 1.029988e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7082e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9566
    reference variance = 0.248815
====================================================
  Execution time = 2.0706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4438e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437641938
                                         uncertainty =       0.004326034767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437641938
                                         uncertainty =       0.004326034767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414960630
  error estimate for blocks of size 2^( 2) =       0.000427341162
  error estimate for blocks of size 2^( 3) =       0.000439840686
  error estimate for blocks of size 2^( 4) =       0.000451204884
  error estimate for blocks of size 2^( 5) =       0.000460995941
  error estimate for blocks of size 2^( 6) =       0.000467746846
  error estimate for blocks of size 2^( 7) =       0.000472934219

      target function =                  N/A
              le_mean =     -16.905949097711
             les_mean =     286.155499370361
             stat err =       0.000463220473
             autocorr =       1.246125269394
              std dev =       0.586842950165
             le_variance =       0.344384648159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594909771e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905949097711       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905949100223       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905949099559       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905949100750       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905949101257       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905949099841       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905949100669       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 9.084907e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905949097711       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905949098339       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905949098173       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905949098472       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905949098598       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905949098245       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905949098451       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.272994e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905949097711       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905949097868       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905949097827       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905949097901       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905949097932       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905949097845       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905949097895       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.683590e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146274 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6362e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.086353e-01 1 1  ON 0
 uu_1                 1.418429e-01 1 1  ON 1
 uu_2                 3.993247e-02 1 1  ON 2
 uu_3                -2.284760e-02 1 1  ON 3
 uu_4                -6.886537e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332101e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399187e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551059e-01 1 1  ON 10
 ud_1                 1.888599e-01 1 1  ON 11
 ud_2                 6.760411e-02 1 1  ON 12
 ud_3                -4.384703e-03 1 1  ON 13
 ud_4                -6.200480e-02 1 1  ON 14
 ud_5                -1.044090e-01 1 1  ON 15
 ud_6                -1.329068e-01 1 1  ON 16
 ud_7                -1.512614e-01 1 1  ON 17
 ud_8                -1.530666e-01 1 1  ON 18
 ud_9                -1.449204e-01 1 1  ON 19
 eO_0                -7.599227e-01 1 1  ON 20
 eO_1                -4.371107e-01 1 1  ON 21
 eO_2                -1.525377e-02 1 1  ON 22
 eO_3                 3.082211e-01 1 1  ON 23
 eO_4                 5.369407e-01 1 1  ON 24
 eO_5                 5.018660e-01 1 1  ON 25
 eO_6                 2.726708e-01 1 1  ON 26
 eO_7                -3.747118e-02 1 1  ON 27
 eO_8                -2.449454e-01 1 1  ON 28
 eO_9                -1.178005e-01 1 1  ON 29
eH1_0                -2.607479e-01 1 1  ON 30
eH1_1                -1.581590e-01 1 1  ON 31
eH1_2                -1.103493e-01 1 1  ON 32
eH1_3                -5.512257e-02 1 1  ON 33
eH1_4                -6.060376e-03 1 1  ON 34
eH1_5                 2.892760e-02 1 1  ON 35
eH1_6                 9.081272e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008423e-01 1 1  ON 38
eH1_9                 1.100838e-01 1 1  ON 39
eH2_0                -2.568061e-01 1 1  ON 40
eH2_1                -1.546693e-01 1 1  ON 41
eH2_2                -1.071716e-01 1 1  ON 42
eH2_3                -5.241117e-02 1 1  ON 43
eH2_4                -3.911200e-03 1 1  ON 44
eH2_5                 3.112392e-02 1 1  ON 45
eH2_6                 9.272731e-02 1 1  ON 46
eH2_7                 1.563648e-01 1 1  ON 47
eH2_8                 2.029806e-01 1 1  ON 48
eH2_9                 1.029990e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.948
    reference variance = 0.290718
====================================================
  Execution time = 2.3141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3387e-01
  Total weights = 2.0000e+06
  Execution time = 1.9022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333868433030
                                         uncertainty =       0.002652519726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333868433030
                                         uncertainty =       0.002652519726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408577435
  error estimate for blocks of size 2^( 2) =       0.000421773362
  error estimate for blocks of size 2^( 3) =       0.000435159500
  error estimate for blocks of size 2^( 4) =       0.000447755114
  error estimate for blocks of size 2^( 5) =       0.000457534791
  error estimate for blocks of size 2^( 6) =       0.000466801799
  error estimate for blocks of size 2^( 7) =       0.000472979910

      target function =                  N/A
              le_mean =     -16.906605910779
             les_mean =     286.167194296365
             stat err =       0.000461267903
             autocorr =       1.274552463233
              std dev =       0.577815749960
             le_variance =       0.333871040902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333868095819
                                         uncertainty =       0.002652516173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333868095819
                                         uncertainty =       0.002652516173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408577229
  error estimate for blocks of size 2^( 2) =       0.000421773165
  error estimate for blocks of size 2^( 3) =       0.000435159310
  error estimate for blocks of size 2^( 4) =       0.000447754931
  error estimate for blocks of size 2^( 5) =       0.000457534620
  error estimate for blocks of size 2^( 6) =       0.000466801638
  error estimate for blocks of size 2^( 7) =       0.000472979736

      target function =                  N/A
              le_mean =     -16.906605912090
             les_mean =     286.167194003479
             stat err =       0.000461267731
             autocorr =       1.274552798833
              std dev =       0.577815458179
             le_variance =       0.333870703711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333868264269
                                         uncertainty =       0.002652517948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333868264269
                                         uncertainty =       0.002652517948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408577332
  error estimate for blocks of size 2^( 2) =       0.000421773264
  error estimate for blocks of size 2^( 3) =       0.000435159405
  error estimate for blocks of size 2^( 4) =       0.000447755022
  error estimate for blocks of size 2^( 5) =       0.000457534705
  error estimate for blocks of size 2^( 6) =       0.000466801719
  error estimate for blocks of size 2^( 7) =       0.000472979823

      target function =                  N/A
              le_mean =     -16.906605911434
             les_mean =     286.167194149739
             stat err =       0.000461267817
             autocorr =       1.274552631183
              std dev =       0.577815603935
             le_variance =       0.333870872151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333868411930
                                         uncertainty =       0.002652519503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333868411930
                                         uncertainty =       0.002652519503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408577422
  error estimate for blocks of size 2^( 2) =       0.000421773350
  error estimate for blocks of size 2^( 3) =       0.000435159488
  error estimate for blocks of size 2^( 4) =       0.000447755102
  error estimate for blocks of size 2^( 5) =       0.000457534781
  error estimate for blocks of size 2^( 6) =       0.000466801789
  error estimate for blocks of size 2^( 7) =       0.000472979899

      target function =                  N/A
              le_mean =     -16.906605910861
             les_mean =     286.167194278030
             stat err =       0.000461267893
             autocorr =       1.274552484230
              std dev =       0.577815731703
             le_variance =       0.333871019803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906605910779        initial
     2.3283e+02     2.3283e+03             9.0849e-07       -16.906605912090  <--
     9.3132e+02     9.3132e+03             2.2730e-07       -16.906605911434
     3.7253e+03     3.7253e+04             5.6836e-08       -16.906605910861

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 3.2812e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.086352e-01 1 1  ON 0
 uu_1                 1.418430e-01 1 1  ON 1
 uu_2                 3.993242e-02 1 1  ON 2
 uu_3                -2.284773e-02 1 1  ON 3
 uu_4                -6.886532e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.484483e-01 1 1  ON 7
 uu_8                -1.399187e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551058e-01 1 1  ON 10
 ud_1                 1.888599e-01 1 1  ON 11
 ud_2                 6.760425e-02 1 1  ON 12
 ud_3                -4.384592e-03 1 1  ON 13
 ud_4                -6.200463e-02 1 1  ON 14
 ud_5                -1.044089e-01 1 1  ON 15
 ud_6                -1.329071e-01 1 1  ON 16
 ud_7                -1.512613e-01 1 1  ON 17
 ud_8                -1.530666e-01 1 1  ON 18
 ud_9                -1.449204e-01 1 1  ON 19
 eO_0                -7.599224e-01 1 1  ON 20
 eO_1                -4.371106e-01 1 1  ON 21
 eO_2                -1.525354e-02 1 1  ON 22
 eO_3                 3.082208e-01 1 1  ON 23
 eO_4                 5.369409e-01 1 1  ON 24
 eO_5                 5.018662e-01 1 1  ON 25
 eO_6                 2.726709e-01 1 1  ON 26
 eO_7                -3.747129e-02 1 1  ON 27
 eO_8                -2.449456e-01 1 1  ON 28
 eO_9                -1.178009e-01 1 1  ON 29
eH1_0                -2.607480e-01 1 1  ON 30
eH1_1                -1.581593e-01 1 1  ON 31
eH1_2                -1.103493e-01 1 1  ON 32
eH1_3                -5.512277e-02 1 1  ON 33
eH1_4                -6.060296e-03 1 1  ON 34
eH1_5                 2.892769e-02 1 1  ON 35
eH1_6                 9.081241e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008426e-01 1 1  ON 38
eH1_9                 1.100843e-01 1 1  ON 39
eH2_0                -2.568062e-01 1 1  ON 40
eH2_1                -1.546699e-01 1 1  ON 41
eH2_2                -1.071715e-01 1 1  ON 42
eH2_3                -5.241096e-02 1 1  ON 43
eH2_4                -3.911235e-03 1 1  ON 44
eH2_5                 3.112343e-02 1 1  ON 45
eH2_6                 9.272704e-02 1 1  ON 46
eH2_7                 1.563650e-01 1 1  ON 47
eH2_8                 2.029809e-01 1 1  ON 48
eH2_9                 1.029997e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9180e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.161217
====================================================
  Execution time = 2.0969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344762761372
                                         uncertainty =       0.004368655433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344762761372
                                         uncertainty =       0.004368655433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415103499
  error estimate for blocks of size 2^( 2) =       0.000427882290
  error estimate for blocks of size 2^( 3) =       0.000440651390
  error estimate for blocks of size 2^( 4) =       0.000452268505
  error estimate for blocks of size 2^( 5) =       0.000462923588
  error estimate for blocks of size 2^( 6) =       0.000470937116
  error estimate for blocks of size 2^( 7) =       0.000480095375

      target function =                  N/A
              le_mean =     -16.906790105004
             les_mean =     286.184173311803
             stat err =       0.000466556146
             autocorr =       1.263266681471
              std dev =       0.587044997820
             le_variance =       0.344621829465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690679010500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906790105004       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906790112420       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906790119276       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906790122928       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906790119916       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906790120254       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906790120544       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906790120345       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.553674e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906790105004       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906790106862       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906790108588       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906790109507       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906790108760       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906790108840       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906790108911       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906790108859       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 8.886422e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906790105004       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906790105469       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906790105901       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906790106131       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906790105944       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906790105964       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906790105982       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906790105969       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.221746e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148853 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6547e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.086355e-01 1 1  ON 0
 uu_1                 1.418426e-01 1 1  ON 1
 uu_2                 3.993260e-02 1 1  ON 2
 uu_3                -2.284758e-02 1 1  ON 3
 uu_4                -6.886568e-02 1 1  ON 4
 uu_5                -1.047820e-01 1 1  ON 5
 uu_6                -1.332106e-01 1 1  ON 6
 uu_7                -1.484486e-01 1 1  ON 7
 uu_8                -1.399189e-01 1 1  ON 8
 uu_9                -1.122729e-01 1 1  ON 9
 ud_0                 4.551055e-01 1 1  ON 10
 ud_1                 1.888601e-01 1 1  ON 11
 ud_2                 6.760463e-02 1 1  ON 12
 ud_3                -4.384540e-03 1 1  ON 13
 ud_4                -6.200456e-02 1 1  ON 14
 ud_5                -1.044090e-01 1 1  ON 15
 ud_6                -1.329071e-01 1 1  ON 16
 ud_7                -1.512616e-01 1 1  ON 17
 ud_8                -1.530667e-01 1 1  ON 18
 ud_9                -1.449202e-01 1 1  ON 19
 eO_0                -7.599221e-01 1 1  ON 20
 eO_1                -4.371103e-01 1 1  ON 21
 eO_2                -1.525374e-02 1 1  ON 22
 eO_3                 3.082209e-01 1 1  ON 23
 eO_4                 5.369411e-01 1 1  ON 24
 eO_5                 5.018664e-01 1 1  ON 25
 eO_6                 2.726709e-01 1 1  ON 26
 eO_7                -3.747136e-02 1 1  ON 27
 eO_8                -2.449459e-01 1 1  ON 28
 eO_9                -1.178014e-01 1 1  ON 29
eH1_0                -2.607485e-01 1 1  ON 30
eH1_1                -1.581596e-01 1 1  ON 31
eH1_2                -1.103493e-01 1 1  ON 32
eH1_3                -5.512335e-02 1 1  ON 33
eH1_4                -6.060533e-03 1 1  ON 34
eH1_5                 2.892783e-02 1 1  ON 35
eH1_6                 9.081282e-02 1 1  ON 36
eH1_7                 1.564187e-01 1 1  ON 37
eH1_8                 2.008428e-01 1 1  ON 38
eH1_9                 1.100850e-01 1 1  ON 39
eH2_0                -2.568065e-01 1 1  ON 40
eH2_1                -1.546706e-01 1 1  ON 41
eH2_2                -1.071720e-01 1 1  ON 42
eH2_3                -5.241122e-02 1 1  ON 43
eH2_4                -3.911437e-03 1 1  ON 44
eH2_5                 3.112392e-02 1 1  ON 45
eH2_6                 9.272712e-02 1 1  ON 46
eH2_7                 1.563650e-01 1 1  ON 47
eH2_8                 2.029812e-01 1 1  ON 48
eH2_9                 1.030005e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9099
    reference variance = 0.24235
====================================================
  Execution time = 2.0509e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3847e-01
  Total weights = 2.0000e+06
  Execution time = 1.9071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338487436312
                                         uncertainty =       0.004363695618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338487436312
                                         uncertainty =       0.004363695618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411383816
  error estimate for blocks of size 2^( 2) =       0.000424146941
  error estimate for blocks of size 2^( 3) =       0.000438061150
  error estimate for blocks of size 2^( 4) =       0.000450991744
  error estimate for blocks of size 2^( 5) =       0.000461756146
  error estimate for blocks of size 2^( 6) =       0.000471195493
  error estimate for blocks of size 2^( 7) =       0.000474488855

      target function =                  N/A
              le_mean =     -16.906042514402
             les_mean =     286.152746618054
             stat err =       0.000464608059
             autocorr =       1.275495916944
              std dev =       0.581784572249
             le_variance =       0.338473288507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338484891359
                                         uncertainty =       0.004363697205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338484891359
                                         uncertainty =       0.004363697205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411382271
  error estimate for blocks of size 2^( 2) =       0.000424145499
  error estimate for blocks of size 2^( 3) =       0.000438059816
  error estimate for blocks of size 2^( 4) =       0.000450990454
  error estimate for blocks of size 2^( 5) =       0.000461754856
  error estimate for blocks of size 2^( 6) =       0.000471194184
  error estimate for blocks of size 2^( 7) =       0.000474487565

      target function =                  N/A
              le_mean =     -16.906042521262
             les_mean =     286.152744306745
             stat err =       0.000464606765
             autocorr =       1.275498392361
              std dev =       0.581782386523
             le_variance =       0.338470745268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338486156031
                                         uncertainty =       0.004363696403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338486156031
                                         uncertainty =       0.004363696403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411383039
  error estimate for blocks of size 2^( 2) =       0.000424146216
  error estimate for blocks of size 2^( 3) =       0.000438060479
  error estimate for blocks of size 2^( 4) =       0.000450991095
  error estimate for blocks of size 2^( 5) =       0.000461755497
  error estimate for blocks of size 2^( 6) =       0.000471194834
  error estimate for blocks of size 2^( 7) =       0.000474488206

      target function =                  N/A
              le_mean =     -16.906042517854
             les_mean =     286.152745455329
             stat err =       0.000464607408
             autocorr =       1.275497162113
              std dev =       0.581783472684
             le_variance =       0.338472009088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338487276026
                                         uncertainty =       0.004363695716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338487276026
                                         uncertainty =       0.004363695716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411383719
  error estimate for blocks of size 2^( 2) =       0.000424146850
  error estimate for blocks of size 2^( 3) =       0.000438061066
  error estimate for blocks of size 2^( 4) =       0.000450991662
  error estimate for blocks of size 2^( 5) =       0.000461756064
  error estimate for blocks of size 2^( 6) =       0.000471195410
  error estimate for blocks of size 2^( 7) =       0.000474488774

      target function =                  N/A
              le_mean =     -16.906042514834
             les_mean =     286.152746472466
             stat err =       0.000464607978
             autocorr =       1.275496072826
              std dev =       0.581784434588
             le_variance =       0.338473128329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906042514402        initial
     5.8208e+01     5.8208e+02             3.5537e-06       -16.906042521262  <--
     2.3283e+02     2.3283e+03             8.8864e-07       -16.906042517854
     9.3132e+02     9.3132e+03             2.2217e-07       -16.906042514834

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 3.0093e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.086362e-01 1 1  ON 0
 uu_1                 1.418411e-01 1 1  ON 1
 uu_2                 3.993314e-02 1 1  ON 2
 uu_3                -2.284713e-02 1 1  ON 3
 uu_4                -6.886677e-02 1 1  ON 4
 uu_5                -1.047815e-01 1 1  ON 5
 uu_6                -1.332111e-01 1 1  ON 6
 uu_7                -1.484493e-01 1 1  ON 7
 uu_8                -1.399197e-01 1 1  ON 8
 uu_9                -1.122723e-01 1 1  ON 9
 ud_0                 4.551046e-01 1 1  ON 10
 ud_1                 1.888606e-01 1 1  ON 11
 ud_2                 6.760576e-02 1 1  ON 12
 ud_3                -4.384381e-03 1 1  ON 13
 ud_4                -6.200436e-02 1 1  ON 14
 ud_5                -1.044093e-01 1 1  ON 15
 ud_6                -1.329072e-01 1 1  ON 16
 ud_7                -1.512624e-01 1 1  ON 17
 ud_8                -1.530670e-01 1 1  ON 18
 ud_9                -1.449194e-01 1 1  ON 19
 eO_0                -7.599212e-01 1 1  ON 20
 eO_1                -4.371092e-01 1 1  ON 21
 eO_2                -1.525434e-02 1 1  ON 22
 eO_3                 3.082213e-01 1 1  ON 23
 eO_4                 5.369415e-01 1 1  ON 24
 eO_5                 5.018668e-01 1 1  ON 25
 eO_6                 2.726711e-01 1 1  ON 26
 eO_7                -3.747159e-02 1 1  ON 27
 eO_8                -2.449467e-01 1 1  ON 28
 eO_9                -1.178028e-01 1 1  ON 29
eH1_0                -2.607501e-01 1 1  ON 30
eH1_1                -1.581605e-01 1 1  ON 31
eH1_2                -1.103493e-01 1 1  ON 32
eH1_3                -5.512510e-02 1 1  ON 33
eH1_4                -6.061245e-03 1 1  ON 34
eH1_5                 2.892825e-02 1 1  ON 35
eH1_6                 9.081405e-02 1 1  ON 36
eH1_7                 1.564190e-01 1 1  ON 37
eH1_8                 2.008432e-01 1 1  ON 38
eH1_9                 1.100871e-01 1 1  ON 39
eH2_0                -2.568074e-01 1 1  ON 40
eH2_1                -1.546725e-01 1 1  ON 41
eH2_2                -1.071737e-01 1 1  ON 42
eH2_3                -5.241201e-02 1 1  ON 43
eH2_4                -3.912042e-03 1 1  ON 44
eH2_5                 3.112542e-02 1 1  ON 45
eH2_6                 9.272737e-02 1 1  ON 46
eH2_7                 1.563652e-01 1 1  ON 47
eH2_8                 2.029820e-01 1 1  ON 48
eH2_9                 1.030032e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8898
    reference variance = 0.261729
====================================================
  Execution time = 2.0939e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3975e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339820458372
                                         uncertainty =       0.005761772111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339820458372
                                         uncertainty =       0.005761772111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412158235
  error estimate for blocks of size 2^( 2) =       0.000425178724
  error estimate for blocks of size 2^( 3) =       0.000437854838
  error estimate for blocks of size 2^( 4) =       0.000449627970
  error estimate for blocks of size 2^( 5) =       0.000459901227
  error estimate for blocks of size 2^( 6) =       0.000469086374
  error estimate for blocks of size 2^( 7) =       0.000475460189

      target function =                  N/A
              le_mean =     -16.906329182033
             les_mean =     286.163715062798
             stat err =       0.000463518940
             autocorr =       1.264756751600
              std dev =       0.582879765834
             le_variance =       0.339748821418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632918203e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906329182033       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906329163666       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906329140910       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906329155480       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906329151779       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906329156365       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906329158366       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906329157987       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.093710e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906329182033       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906329177379       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906329171557       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906329175072       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906329174308       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906329175816       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906329175867       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906329175887       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.737703e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906329182033       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906329180866       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906329179402       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906329180272       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906329180092       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906329180494       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906329180469       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906329180488       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 6.846467e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6812e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.086371e-01 1 1  ON 0
 uu_1                 1.418405e-01 1 1  ON 1
 uu_2                 3.993255e-02 1 1  ON 2
 uu_3                -2.284842e-02 1 1  ON 3
 uu_4                -6.886617e-02 1 1  ON 4
 uu_5                -1.047817e-01 1 1  ON 5
 uu_6                -1.332113e-01 1 1  ON 6
 uu_7                -1.484478e-01 1 1  ON 7
 uu_8                -1.399202e-01 1 1  ON 8
 uu_9                -1.122727e-01 1 1  ON 9
 ud_0                 4.551043e-01 1 1  ON 10
 ud_1                 1.888609e-01 1 1  ON 11
 ud_2                 6.760716e-02 1 1  ON 12
 ud_3                -4.383517e-03 1 1  ON 13
 ud_4                -6.200539e-02 1 1  ON 14
 ud_5                -1.044083e-01 1 1  ON 15
 ud_6                -1.329084e-01 1 1  ON 16
 ud_7                -1.512621e-01 1 1  ON 17
 ud_8                -1.530666e-01 1 1  ON 18
 ud_9                -1.449187e-01 1 1  ON 19
 eO_0                -7.599200e-01 1 1  ON 20
 eO_1                -4.371089e-01 1 1  ON 21
 eO_2                -1.525370e-02 1 1  ON 22
 eO_3                 3.082210e-01 1 1  ON 23
 eO_4                 5.369436e-01 1 1  ON 24
 eO_5                 5.018660e-01 1 1  ON 25
 eO_6                 2.726721e-01 1 1  ON 26
 eO_7                -3.747153e-02 1 1  ON 27
 eO_8                -2.449481e-01 1 1  ON 28
 eO_9                -1.178051e-01 1 1  ON 29
eH1_0                -2.607506e-01 1 1  ON 30
eH1_1                -1.581600e-01 1 1  ON 31
eH1_2                -1.103504e-01 1 1  ON 32
eH1_3                -5.512636e-02 1 1  ON 33
eH1_4                -6.062572e-03 1 1  ON 34
eH1_5                 2.892864e-02 1 1  ON 35
eH1_6                 9.081387e-02 1 1  ON 36
eH1_7                 1.564188e-01 1 1  ON 37
eH1_8                 2.008434e-01 1 1  ON 38
eH1_9                 1.100898e-01 1 1  ON 39
eH2_0                -2.568069e-01 1 1  ON 40
eH2_1                -1.546744e-01 1 1  ON 41
eH2_2                -1.071750e-01 1 1  ON 42
eH2_3                -5.241153e-02 1 1  ON 43
eH2_4                -3.913466e-03 1 1  ON 44
eH2_5                 3.112579e-02 1 1  ON 45
eH2_6                 9.272786e-02 1 1  ON 46
eH2_7                 1.563657e-01 1 1  ON 47
eH2_8                 2.029823e-01 1 1  ON 48
eH2_9                 1.030053e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8869
    reference variance = 0.178925
====================================================
  Execution time = 2.0632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3939e-01
  Total weights = 2.0000e+06
  Execution time = 1.9133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339404052015
                                         uncertainty =       0.003350066471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339404052015
                                         uncertainty =       0.003350066471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411939526
  error estimate for blocks of size 2^( 2) =       0.000424512666
  error estimate for blocks of size 2^( 3) =       0.000437218072
  error estimate for blocks of size 2^( 4) =       0.000449636452
  error estimate for blocks of size 2^( 5) =       0.000461132206
  error estimate for blocks of size 2^( 6) =       0.000468497179
  error estimate for blocks of size 2^( 7) =       0.000472505739

      target function =                  N/A
              le_mean =     -16.905966339617
             les_mean =     286.151086052876
             stat err =       0.000462942894
             autocorr =       1.262955109599
              std dev =       0.582570464671
             le_variance =       0.339388346307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339401795490
                                         uncertainty =       0.003349976665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339401795490
                                         uncertainty =       0.003349976665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411938154
  error estimate for blocks of size 2^( 2) =       0.000424511360
  error estimate for blocks of size 2^( 3) =       0.000437216815
  error estimate for blocks of size 2^( 4) =       0.000449635214
  error estimate for blocks of size 2^( 5) =       0.000461130927
  error estimate for blocks of size 2^( 6) =       0.000468496012
  error estimate for blocks of size 2^( 7) =       0.000472504458

      target function =                  N/A
              le_mean =     -16.905966350520
             les_mean =     286.151084160862
             stat err =       0.000462941653
             autocorr =       1.262956748965
              std dev =       0.582568524408
             le_variance =       0.339386085631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339402901920
                                         uncertainty =       0.003350021023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339402901920
                                         uncertainty =       0.003350021023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411938827
  error estimate for blocks of size 2^( 2) =       0.000424512001
  error estimate for blocks of size 2^( 3) =       0.000437217432
  error estimate for blocks of size 2^( 4) =       0.000449635822
  error estimate for blocks of size 2^( 5) =       0.000461131555
  error estimate for blocks of size 2^( 6) =       0.000468496585
  error estimate for blocks of size 2^( 7) =       0.000472505087

      target function =                  N/A
              le_mean =     -16.905966345294
             les_mean =     286.151085092628
             stat err =       0.000462942262
             autocorr =       1.262955949228
              std dev =       0.582569475771
             le_variance =       0.339387194101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339403907537
                                         uncertainty =       0.003350060773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339403907537
                                         uncertainty =       0.003350060773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411939438
  error estimate for blocks of size 2^( 2) =       0.000424512583
  error estimate for blocks of size 2^( 3) =       0.000437217992
  error estimate for blocks of size 2^( 4) =       0.000449636373
  error estimate for blocks of size 2^( 5) =       0.000461132124
  error estimate for blocks of size 2^( 6) =       0.000468497104
  error estimate for blocks of size 2^( 7) =       0.000472505657

      target function =                  N/A
              le_mean =     -16.905966340327
             les_mean =     286.151085932138
             stat err =       0.000462942815
             autocorr =       1.262955215154
              std dev =       0.582570340443
             le_variance =       0.339388201564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905966339617        initial
     1.4552e+01     1.4552e+02             1.0937e-05       -16.905966350520  <--
     5.8208e+01     5.8208e+02             2.7377e-06       -16.905966345294
     2.3283e+02     2.3283e+03             6.8465e-07       -16.905966340327

*****************************************************************************
Applying the update for shift_i =   1.4552e+01     and shift_s =   1.4552e+02
*****************************************************************************

  Execution time = 3.0308e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.086398e-01 1 1  ON 0
 uu_1                 1.418388e-01 1 1  ON 1
 uu_2                 3.993080e-02 1 1  ON 2
 uu_3                -2.285220e-02 1 1  ON 3
 uu_4                -6.886446e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332120e-01 1 1  ON 6
 uu_7                -1.484432e-01 1 1  ON 7
 uu_8                -1.399217e-01 1 1  ON 8
 uu_9                -1.122740e-01 1 1  ON 9
 ud_0                 4.551033e-01 1 1  ON 10
 ud_1                 1.888616e-01 1 1  ON 11
 ud_2                 6.761128e-02 1 1  ON 12
 ud_3                -4.380963e-03 1 1  ON 13
 ud_4                -6.200839e-02 1 1  ON 14
 ud_5                -1.044055e-01 1 1  ON 15
 ud_6                -1.329121e-01 1 1  ON 16
 ud_7                -1.512611e-01 1 1  ON 17
 ud_8                -1.530657e-01 1 1  ON 18
 ud_9                -1.449166e-01 1 1  ON 19
 eO_0                -7.599166e-01 1 1  ON 20
 eO_1                -4.371081e-01 1 1  ON 21
 eO_2                -1.525177e-02 1 1  ON 22
 eO_3                 3.082202e-01 1 1  ON 23
 eO_4                 5.369499e-01 1 1  ON 24
 eO_5                 5.018635e-01 1 1  ON 25
 eO_6                 2.726752e-01 1 1  ON 26
 eO_7                -3.747137e-02 1 1  ON 27
 eO_8                -2.449523e-01 1 1  ON 28
 eO_9                -1.178117e-01 1 1  ON 29
eH1_0                -2.607522e-01 1 1  ON 30
eH1_1                -1.581584e-01 1 1  ON 31
eH1_2                -1.103536e-01 1 1  ON 32
eH1_3                -5.513010e-02 1 1  ON 33
eH1_4                -6.066540e-03 1 1  ON 34
eH1_5                 2.892978e-02 1 1  ON 35
eH1_6                 9.081332e-02 1 1  ON 36
eH1_7                 1.564181e-01 1 1  ON 37
eH1_8                 2.008439e-01 1 1  ON 38
eH1_9                 1.100980e-01 1 1  ON 39
eH2_0                -2.568056e-01 1 1  ON 40
eH2_1                -1.546798e-01 1 1  ON 41
eH2_2                -1.071790e-01 1 1  ON 42
eH2_3                -5.241016e-02 1 1  ON 43
eH2_4                -3.917687e-03 1 1  ON 44
eH2_5                 3.112690e-02 1 1  ON 45
eH2_6                 9.272930e-02 1 1  ON 46
eH2_7                 1.563673e-01 1 1  ON 47
eH2_8                 2.029835e-01 1 1  ON 48
eH2_9                 1.030114e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7126e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.208654
====================================================
  Execution time = 2.0843e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336925159710
                                         uncertainty =       0.003062622964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336925159710
                                         uncertainty =       0.003062622964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410378967
  error estimate for blocks of size 2^( 2) =       0.000423083032
  error estimate for blocks of size 2^( 3) =       0.000435869493
  error estimate for blocks of size 2^( 4) =       0.000448160310
  error estimate for blocks of size 2^( 5) =       0.000459250748
  error estimate for blocks of size 2^( 6) =       0.000465559796
  error estimate for blocks of size 2^( 7) =       0.000469425110

      target function =                  N/A
              le_mean =     -16.905916976777
             les_mean =     286.146850451108
             stat err =       0.000460598991
             autocorr =       1.259725079630
              std dev =       0.580363501461
             le_variance =       0.336821793828


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591697678e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916976777       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905917112952       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905917195828       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905917287810       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905917331891       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905917300650       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905917323163       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905917333835       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 5.232757e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916976777       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905917011884       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905917034236       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905917057817       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905917069850       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905917062961       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905917069726       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.336947e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916976777       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905916985623       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905916991323       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905916997256       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905917000337       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905916998681       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905917000370       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.364248e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6632e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.086405e-01 1 1  ON 0
 uu_1                 1.418390e-01 1 1  ON 1
 uu_2                 3.993325e-02 1 1  ON 2
 uu_3                -2.285340e-02 1 1  ON 3
 uu_4                -6.887248e-02 1 1  ON 4
 uu_5                -1.047716e-01 1 1  ON 5
 uu_6                -1.332164e-01 1 1  ON 6
 uu_7                -1.484409e-01 1 1  ON 7
 uu_8                -1.399238e-01 1 1  ON 8
 uu_9                -1.122793e-01 1 1  ON 9
 ud_0                 4.551037e-01 1 1  ON 10
 ud_1                 1.888625e-01 1 1  ON 11
 ud_2                 6.761440e-02 1 1  ON 12
 ud_3                -4.376382e-03 1 1  ON 13
 ud_4                -6.200794e-02 1 1  ON 14
 ud_5                -1.044066e-01 1 1  ON 15
 ud_6                -1.329139e-01 1 1  ON 16
 ud_7                -1.512607e-01 1 1  ON 17
 ud_8                -1.530690e-01 1 1  ON 18
 ud_9                -1.449175e-01 1 1  ON 19
 eO_0                -7.599145e-01 1 1  ON 20
 eO_1                -4.371023e-01 1 1  ON 21
 eO_2                -1.525290e-02 1 1  ON 22
 eO_3                 3.082259e-01 1 1  ON 23
 eO_4                 5.369530e-01 1 1  ON 24
 eO_5                 5.018644e-01 1 1  ON 25
 eO_6                 2.726770e-01 1 1  ON 26
 eO_7                -3.747148e-02 1 1  ON 27
 eO_8                -2.449597e-01 1 1  ON 28
 eO_9                -1.178211e-01 1 1  ON 29
eH1_0                -2.607473e-01 1 1  ON 30
eH1_1                -1.581604e-01 1 1  ON 31
eH1_2                -1.103584e-01 1 1  ON 32
eH1_3                -5.513122e-02 1 1  ON 33
eH1_4                -6.079909e-03 1 1  ON 34
eH1_5                 2.892923e-02 1 1  ON 35
eH1_6                 9.081627e-02 1 1  ON 36
eH1_7                 1.564149e-01 1 1  ON 37
eH1_8                 2.008460e-01 1 1  ON 38
eH1_9                 1.101098e-01 1 1  ON 39
eH2_0                -2.568103e-01 1 1  ON 40
eH2_1                -1.546878e-01 1 1  ON 41
eH2_2                -1.071834e-01 1 1  ON 42
eH2_3                -5.240919e-02 1 1  ON 43
eH2_4                -3.914784e-03 1 1  ON 44
eH2_5                 3.112946e-02 1 1  ON 45
eH2_6                 9.272527e-02 1 1  ON 46
eH2_7                 1.563681e-01 1 1  ON 47
eH2_8                 2.029875e-01 1 1  ON 48
eH2_9                 1.030201e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9071
    reference variance = 0.24491
====================================================
  Execution time = 2.0346e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3838e-01
  Total weights = 2.0000e+06
  Execution time = 1.9206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338338728907
                                         uncertainty =       0.004002416775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338338728907
                                         uncertainty =       0.004002416775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411326660
  error estimate for blocks of size 2^( 2) =       0.000424298609
  error estimate for blocks of size 2^( 3) =       0.000437691904
  error estimate for blocks of size 2^( 4) =       0.000449518219
  error estimate for blocks of size 2^( 5) =       0.000460952416
  error estimate for blocks of size 2^( 6) =       0.000468537892
  error estimate for blocks of size 2^( 7) =       0.000473691001

      target function =                  N/A
              le_mean =     -16.906480625686
             les_mean =     286.167466219809
             stat err =       0.000463174882
             autocorr =       1.267991321361
              std dev =       0.581703741003
             le_variance =       0.338379242297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338335108741
                                         uncertainty =       0.004002446983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338335108741
                                         uncertainty =       0.004002446983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411324461
  error estimate for blocks of size 2^( 2) =       0.000424295983
  error estimate for blocks of size 2^( 3) =       0.000437689102
  error estimate for blocks of size 2^( 4) =       0.000449514967
  error estimate for blocks of size 2^( 5) =       0.000460949662
  error estimate for blocks of size 2^( 6) =       0.000468535597
  error estimate for blocks of size 2^( 7) =       0.000473689606

      target function =                  N/A
              le_mean =     -16.906480442422
             les_mean =     286.167456404483
             stat err =       0.000463172458
             autocorr =       1.267991610820
              std dev =       0.581700630617
             le_variance =       0.338375623661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338336436440
                                         uncertainty =       0.004002433416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338336436440
                                         uncertainty =       0.004002433416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411325267
  error estimate for blocks of size 2^( 2) =       0.000424296998
  error estimate for blocks of size 2^( 3) =       0.000437690214
  error estimate for blocks of size 2^( 4) =       0.000449516292
  error estimate for blocks of size 2^( 5) =       0.000460950781
  error estimate for blocks of size 2^( 6) =       0.000468536506
  error estimate for blocks of size 2^( 7) =       0.000473690090

      target function =                  N/A
              le_mean =     -16.906480523420
             les_mean =     286.167460469936
             stat err =       0.000463173417
             autocorr =       1.267991889225
              std dev =       0.581701770960
             le_variance =       0.338376950338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338338444425
                                         uncertainty =       0.004002419031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338338444425
                                         uncertainty =       0.004002419031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411326487
  error estimate for blocks of size 2^( 2) =       0.000424298409
  error estimate for blocks of size 2^( 3) =       0.000437691693
  error estimate for blocks of size 2^( 4) =       0.000449517978
  error estimate for blocks of size 2^( 5) =       0.000460952212
  error estimate for blocks of size 2^( 6) =       0.000468537719
  error estimate for blocks of size 2^( 7) =       0.000473690888

      target function =                  N/A
              le_mean =     -16.906480612580
             les_mean =     286.167465492228
             stat err =       0.000463174699
             autocorr =       1.267991387363
              std dev =       0.581703496528
             le_variance =       0.338378957873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906480625686        initial  <--
     3.6380e+00     3.6380e+01             5.2328e-05       -16.906480442422
     1.4552e+01     1.4552e+02             1.3369e-05       -16.906480523420
     5.8208e+01     5.8208e+02             3.3642e-06       -16.906480612580

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9794
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.086398e-01 1 1  ON 0
 uu_1                 1.418388e-01 1 1  ON 1
 uu_2                 3.993080e-02 1 1  ON 2
 uu_3                -2.285220e-02 1 1  ON 3
 uu_4                -6.886446e-02 1 1  ON 4
 uu_5                -1.047822e-01 1 1  ON 5
 uu_6                -1.332120e-01 1 1  ON 6
 uu_7                -1.484432e-01 1 1  ON 7
 uu_8                -1.399217e-01 1 1  ON 8
 uu_9                -1.122740e-01 1 1  ON 9
 ud_0                 4.551033e-01 1 1  ON 10
 ud_1                 1.888616e-01 1 1  ON 11
 ud_2                 6.761128e-02 1 1  ON 12
 ud_3                -4.380963e-03 1 1  ON 13
 ud_4                -6.200839e-02 1 1  ON 14
 ud_5                -1.044055e-01 1 1  ON 15
 ud_6                -1.329121e-01 1 1  ON 16
 ud_7                -1.512611e-01 1 1  ON 17
 ud_8                -1.530657e-01 1 1  ON 18
 ud_9                -1.449166e-01 1 1  ON 19
 eO_0                -7.599166e-01 1 1  ON 20
 eO_1                -4.371081e-01 1 1  ON 21
 eO_2                -1.525177e-02 1 1  ON 22
 eO_3                 3.082202e-01 1 1  ON 23
 eO_4                 5.369499e-01 1 1  ON 24
 eO_5                 5.018635e-01 1 1  ON 25
 eO_6                 2.726752e-01 1 1  ON 26
 eO_7                -3.747137e-02 1 1  ON 27
 eO_8                -2.449523e-01 1 1  ON 28
 eO_9                -1.178117e-01 1 1  ON 29
eH1_0                -2.607522e-01 1 1  ON 30
eH1_1                -1.581584e-01 1 1  ON 31
eH1_2                -1.103536e-01 1 1  ON 32
eH1_3                -5.513010e-02 1 1  ON 33
eH1_4                -6.066540e-03 1 1  ON 34
eH1_5                 2.892978e-02 1 1  ON 35
eH1_6                 9.081332e-02 1 1  ON 36
eH1_7                 1.564181e-01 1 1  ON 37
eH1_8                 2.008439e-01 1 1  ON 38
eH1_9                 1.100980e-01 1 1  ON 39
eH2_0                -2.568056e-01 1 1  ON 40
eH2_1                -1.546798e-01 1 1  ON 41
eH2_2                -1.071790e-01 1 1  ON 42
eH2_3                -5.241016e-02 1 1  ON 43
eH2_4                -3.917687e-03 1 1  ON 44
eH2_5                 3.112690e-02 1 1  ON 45
eH2_6                 9.272930e-02 1 1  ON 46
eH2_7                 1.563673e-01 1 1  ON 47
eH2_8                 2.029835e-01 1 1  ON 48
eH2_9                 1.030114e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6618e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8225
    reference variance = 0.233143
====================================================
  Execution time = 2.0836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3691e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336997586269
                                         uncertainty =       0.003676164435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336997586269
                                         uncertainty =       0.003676164435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410431175
  error estimate for blocks of size 2^( 2) =       0.000423719801
  error estimate for blocks of size 2^( 3) =       0.000437500347
  error estimate for blocks of size 2^( 4) =       0.000450840972
  error estimate for blocks of size 2^( 5) =       0.000461483833
  error estimate for blocks of size 2^( 6) =       0.000469580657
  error estimate for blocks of size 2^( 7) =       0.000473214458

      target function =                  N/A
              le_mean =     -16.905993849144
             les_mean =     286.149535357459
             stat err =       0.000463779980
             autocorr =       1.276860093360
              std dev =       0.580437333926
             le_variance =       0.336907498615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599384914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905993849144       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905993858555       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905993873815       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905993874806       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905993876082       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905993874052       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905993876533       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 7.999620e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905993849144       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905993851507       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905993855337       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905993855583       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905993855930       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905993855414       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905993856045       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 2.015860e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905993849144       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905993849735       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905993850694       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905993850755       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905993850844       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905993850714       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905993850873       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 5.049727e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6625e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.086408e-01 1 1  ON 0
 uu_1                 1.418374e-01 1 1  ON 1
 uu_2                 3.993071e-02 1 1  ON 2
 uu_3                -2.285277e-02 1 1  ON 3
 uu_4                -6.886539e-02 1 1  ON 4
 uu_5                -1.047811e-01 1 1  ON 5
 uu_6                -1.332118e-01 1 1  ON 6
 uu_7                -1.484433e-01 1 1  ON 7
 uu_8                -1.399219e-01 1 1  ON 8
 uu_9                -1.122739e-01 1 1  ON 9
 ud_0                 4.551053e-01 1 1  ON 10
 ud_1                 1.888614e-01 1 1  ON 11
 ud_2                 6.761139e-02 1 1  ON 12
 ud_3                -4.381091e-03 1 1  ON 13
 ud_4                -6.200829e-02 1 1  ON 14
 ud_5                -1.044062e-01 1 1  ON 15
 ud_6                -1.329131e-01 1 1  ON 16
 ud_7                -1.512619e-01 1 1  ON 17
 ud_8                -1.530652e-01 1 1  ON 18
 ud_9                -1.449161e-01 1 1  ON 19
 eO_0                -7.599157e-01 1 1  ON 20
 eO_1                -4.371087e-01 1 1  ON 21
 eO_2                -1.525154e-02 1 1  ON 22
 eO_3                 3.082199e-01 1 1  ON 23
 eO_4                 5.369507e-01 1 1  ON 24
 eO_5                 5.018638e-01 1 1  ON 25
 eO_6                 2.726753e-01 1 1  ON 26
 eO_7                -3.747200e-02 1 1  ON 27
 eO_8                -2.449523e-01 1 1  ON 28
 eO_9                -1.178123e-01 1 1  ON 29
eH1_0                -2.607516e-01 1 1  ON 30
eH1_1                -1.581588e-01 1 1  ON 31
eH1_2                -1.103540e-01 1 1  ON 32
eH1_3                -5.513074e-02 1 1  ON 33
eH1_4                -6.067660e-03 1 1  ON 34
eH1_5                 2.892964e-02 1 1  ON 35
eH1_6                 9.081368e-02 1 1  ON 36
eH1_7                 1.564186e-01 1 1  ON 37
eH1_8                 2.008442e-01 1 1  ON 38
eH1_9                 1.100989e-01 1 1  ON 39
eH2_0                -2.568057e-01 1 1  ON 40
eH2_1                -1.546806e-01 1 1  ON 41
eH2_2                -1.071794e-01 1 1  ON 42
eH2_3                -5.241045e-02 1 1  ON 43
eH2_4                -3.918475e-03 1 1  ON 44
eH2_5                 3.112675e-02 1 1  ON 45
eH2_6                 9.273006e-02 1 1  ON 46
eH2_7                 1.563676e-01 1 1  ON 47
eH2_8                 2.029838e-01 1 1  ON 48
eH2_9                 1.030123e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9341
    reference variance = 0.207384
====================================================
  Execution time = 2.0290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3889e-01
  Total weights = 2.0000e+06
  Execution time = 1.8994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338815583197
                                         uncertainty =       0.003574686795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338815583197
                                         uncertainty =       0.003574686795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411632988
  error estimate for blocks of size 2^( 2) =       0.000424708889
  error estimate for blocks of size 2^( 3) =       0.000437996949
  error estimate for blocks of size 2^( 4) =       0.000450539662
  error estimate for blocks of size 2^( 5) =       0.000460462232
  error estimate for blocks of size 2^( 6) =       0.000469436255
  error estimate for blocks of size 2^( 7) =       0.000475201034

      target function =                  N/A
              le_mean =     -16.905754898026
             les_mean =     286.143431936797
             stat err =       0.000463909796
             autocorr =       1.270125812966
              std dev =       0.582136954756
             le_variance =       0.338883434093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338822758044
                                         uncertainty =       0.003574745269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338822758044
                                         uncertainty =       0.003574745269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411637347
  error estimate for blocks of size 2^( 2) =       0.000424713092
  error estimate for blocks of size 2^( 3) =       0.000438000956
  error estimate for blocks of size 2^( 4) =       0.000450543570
  error estimate for blocks of size 2^( 5) =       0.000460465953
  error estimate for blocks of size 2^( 6) =       0.000469440004
  error estimate for blocks of size 2^( 7) =       0.000475204563

      target function =                  N/A
              le_mean =     -16.905754899631
             les_mean =     286.143439167715
             stat err =       0.000463913522
             autocorr =       1.270119321052
              std dev =       0.582143118808
             le_variance =       0.338890610776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338819198732
                                         uncertainty =       0.003574716345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338819198732
                                         uncertainty =       0.003574716345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411635185
  error estimate for blocks of size 2^( 2) =       0.000424711007
  error estimate for blocks of size 2^( 3) =       0.000437998968
  error estimate for blocks of size 2^( 4) =       0.000450541631
  error estimate for blocks of size 2^( 5) =       0.000460464108
  error estimate for blocks of size 2^( 6) =       0.000469438145
  error estimate for blocks of size 2^( 7) =       0.000475202813

      target function =                  N/A
              le_mean =     -16.905754898868
             les_mean =     286.143435581713
             stat err =       0.000463911674
             autocorr =       1.270122544721
              std dev =       0.582140060945
             le_variance =       0.338887050558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338816035986
                                         uncertainty =       0.003574690499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338816035986
                                         uncertainty =       0.003574690499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411633263
  error estimate for blocks of size 2^( 2) =       0.000424709154
  error estimate for blocks of size 2^( 3) =       0.000437997201
  error estimate for blocks of size 2^( 4) =       0.000450539909
  error estimate for blocks of size 2^( 5) =       0.000460462467
  error estimate for blocks of size 2^( 6) =       0.000469436491
  error estimate for blocks of size 2^( 7) =       0.000475201257

      target function =                  N/A
              le_mean =     -16.905754898130
             les_mean =     286.143432393189
             stat err =       0.000463910031
             autocorr =       1.270125403751
              std dev =       0.582137343759
             le_variance =       0.338883886998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905754898026        initial
     3.6380e+01     3.6380e+02             7.9996e-06       -16.905754899631  <--
     1.4552e+02     1.4552e+03             2.0159e-06       -16.905754898868
     5.8208e+02     5.8208e+03             5.0497e-07       -16.905754898130

*****************************************************************************
Applying the update for shift_i =   3.6380e+01     and shift_s =   3.6380e+02
*****************************************************************************

  Execution time = 2.9844e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.086437e-01 1 1  ON 0
 uu_1                 1.418333e-01 1 1  ON 1
 uu_2                 3.993044e-02 1 1  ON 2
 uu_3                -2.285446e-02 1 1  ON 3
 uu_4                -6.886815e-02 1 1  ON 4
 uu_5                -1.047780e-01 1 1  ON 5
 uu_6                -1.332111e-01 1 1  ON 6
 uu_7                -1.484438e-01 1 1  ON 7
 uu_8                -1.399226e-01 1 1  ON 8
 uu_9                -1.122735e-01 1 1  ON 9
 ud_0                 4.551113e-01 1 1  ON 10
 ud_1                 1.888606e-01 1 1  ON 11
 ud_2                 6.761172e-02 1 1  ON 12
 ud_3                -4.381464e-03 1 1  ON 13
 ud_4                -6.200798e-02 1 1  ON 14
 ud_5                -1.044082e-01 1 1  ON 15
 ud_6                -1.329161e-01 1 1  ON 16
 ud_7                -1.512640e-01 1 1  ON 17
 ud_8                -1.530639e-01 1 1  ON 18
 ud_9                -1.449144e-01 1 1  ON 19
 eO_0                -7.599129e-01 1 1  ON 20
 eO_1                -4.371106e-01 1 1  ON 21
 eO_2                -1.525087e-02 1 1  ON 22
 eO_3                 3.082190e-01 1 1  ON 23
 eO_4                 5.369531e-01 1 1  ON 24
 eO_5                 5.018650e-01 1 1  ON 25
 eO_6                 2.726753e-01 1 1  ON 26
 eO_7                -3.747388e-02 1 1  ON 27
 eO_8                -2.449523e-01 1 1  ON 28
 eO_9                -1.178142e-01 1 1  ON 29
eH1_0                -2.607501e-01 1 1  ON 30
eH1_1                -1.581603e-01 1 1  ON 31
eH1_2                -1.103550e-01 1 1  ON 32
eH1_3                -5.513262e-02 1 1  ON 33
eH1_4                -6.071014e-03 1 1  ON 34
eH1_5                 2.892923e-02 1 1  ON 35
eH1_6                 9.081477e-02 1 1  ON 36
eH1_7                 1.564203e-01 1 1  ON 37
eH1_8                 2.008453e-01 1 1  ON 38
eH1_9                 1.101015e-01 1 1  ON 39
eH2_0                -2.568063e-01 1 1  ON 40
eH2_1                -1.546830e-01 1 1  ON 41
eH2_2                -1.071805e-01 1 1  ON 42
eH2_3                -5.241133e-02 1 1  ON 43
eH2_4                -3.920835e-03 1 1  ON 44
eH2_5                 3.112628e-02 1 1  ON 45
eH2_6                 9.273233e-02 1 1  ON 46
eH2_7                 1.563687e-01 1 1  ON 47
eH2_8                 2.029849e-01 1 1  ON 48
eH2_9                 1.030151e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9641
    reference variance = 0.175793
====================================================
  Execution time = 2.0858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3485e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334966793923
                                         uncertainty =       0.003100588592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334966793923
                                         uncertainty =       0.003100588592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409177255
  error estimate for blocks of size 2^( 2) =       0.000421971971
  error estimate for blocks of size 2^( 3) =       0.000435148921
  error estimate for blocks of size 2^( 4) =       0.000448191461
  error estimate for blocks of size 2^( 5) =       0.000459680751
  error estimate for blocks of size 2^( 6) =       0.000467963968
  error estimate for blocks of size 2^( 7) =       0.000470718661

      target function =                  N/A
              le_mean =     -16.906063596735
             les_mean =     286.149838221575
             stat err =       0.000461638710
             autocorr =       1.272862431512
              std dev =       0.578664023547
             le_variance =       0.334852052148


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606359674e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906063596735       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906063622890       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906063636785       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906063539702       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906063570326       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906063550852       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906063562165       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 1.658546e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906063596735       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906063603336       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906063606881       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906063582371       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906063589992       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906063584822       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906063587292       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 4.165656e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906063596735       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906063598389       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906063599280       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906063593138       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906063595040       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906063593729       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906063594323       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.042618e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6598e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.086462e-01 1 1  ON 0
 uu_1                 1.418321e-01 1 1  ON 1
 uu_2                 3.993100e-02 1 1  ON 2
 uu_3                -2.285552e-02 1 1  ON 3
 uu_4                -6.886801e-02 1 1  ON 4
 uu_5                -1.047770e-01 1 1  ON 5
 uu_6                -1.332132e-01 1 1  ON 6
 uu_7                -1.484436e-01 1 1  ON 7
 uu_8                -1.399247e-01 1 1  ON 8
 uu_9                -1.122748e-01 1 1  ON 9
 ud_0                 4.551107e-01 1 1  ON 10
 ud_1                 1.888635e-01 1 1  ON 11
 ud_2                 6.761350e-02 1 1  ON 12
 ud_3                -4.381087e-03 1 1  ON 13
 ud_4                -6.200832e-02 1 1  ON 14
 ud_5                -1.044101e-01 1 1  ON 15
 ud_6                -1.329172e-01 1 1  ON 16
 ud_7                -1.512631e-01 1 1  ON 17
 ud_8                -1.530638e-01 1 1  ON 18
 ud_9                -1.449162e-01 1 1  ON 19
 eO_0                -7.599126e-01 1 1  ON 20
 eO_1                -4.371115e-01 1 1  ON 21
 eO_2                -1.524903e-02 1 1  ON 22
 eO_3                 3.082218e-01 1 1  ON 23
 eO_4                 5.369565e-01 1 1  ON 24
 eO_5                 5.018644e-01 1 1  ON 25
 eO_6                 2.726753e-01 1 1  ON 26
 eO_7                -3.747335e-02 1 1  ON 27
 eO_8                -2.449553e-01 1 1  ON 28
 eO_9                -1.178182e-01 1 1  ON 29
eH1_0                -2.607501e-01 1 1  ON 30
eH1_1                -1.581578e-01 1 1  ON 31
eH1_2                -1.103567e-01 1 1  ON 32
eH1_3                -5.513584e-02 1 1  ON 33
eH1_4                -6.073865e-03 1 1  ON 34
eH1_5                 2.893167e-02 1 1  ON 35
eH1_6                 9.081331e-02 1 1  ON 36
eH1_7                 1.564191e-01 1 1  ON 37
eH1_8                 2.008459e-01 1 1  ON 38
eH1_9                 1.101051e-01 1 1  ON 39
eH2_0                -2.568065e-01 1 1  ON 40
eH2_1                -1.546835e-01 1 1  ON 41
eH2_2                -1.071840e-01 1 1  ON 42
eH2_3                -5.241291e-02 1 1  ON 43
eH2_4                -3.924349e-03 1 1  ON 44
eH2_5                 3.112727e-02 1 1  ON 45
eH2_6                 9.273252e-02 1 1  ON 46
eH2_7                 1.563695e-01 1 1  ON 47
eH2_8                 2.029876e-01 1 1  ON 48
eH2_9                 1.030193e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9513
    reference variance = 0.271457
====================================================
  Execution time = 2.1880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4652e-01
  Total weights = 2.0000e+06
  Execution time = 2.5885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346647798755
                                         uncertainty =       0.006429227950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346647798755
                                         uncertainty =       0.006429227950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416245615
  error estimate for blocks of size 2^( 2) =       0.000428614802
  error estimate for blocks of size 2^( 3) =       0.000441173840
  error estimate for blocks of size 2^( 4) =       0.000452787660
  error estimate for blocks of size 2^( 5) =       0.000462268110
  error estimate for blocks of size 2^( 6) =       0.000466956948
  error estimate for blocks of size 2^( 7) =       0.000470718433

      target function =                  N/A
              le_mean =     -16.905394364952
             les_mean =     286.138879285126
             stat err =       0.000463182788
             autocorr =       1.238241860082
              std dev =       0.588660193868
             le_variance =       0.346520823845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346642784232
                                         uncertainty =       0.006428974723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346642784232
                                         uncertainty =       0.006428974723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416242605
  error estimate for blocks of size 2^( 2) =       0.000428611984
  error estimate for blocks of size 2^( 3) =       0.000441171118
  error estimate for blocks of size 2^( 4) =       0.000452784858
  error estimate for blocks of size 2^( 5) =       0.000462265179
  error estimate for blocks of size 2^( 6) =       0.000466954180
  error estimate for blocks of size 2^( 7) =       0.000470715595

      target function =                  N/A
              le_mean =     -16.905394361886
             les_mean =     286.138874170759
             stat err =       0.000463179953
             autocorr =       1.238244609655
              std dev =       0.588655937832
             le_variance =       0.346515813145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346645059937
                                         uncertainty =       0.006429091969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346645059937
                                         uncertainty =       0.006429091969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416243971
  error estimate for blocks of size 2^( 2) =       0.000428613260
  error estimate for blocks of size 2^( 3) =       0.000441172351
  error estimate for blocks of size 2^( 4) =       0.000452786134
  error estimate for blocks of size 2^( 5) =       0.000462266521
  error estimate for blocks of size 2^( 6) =       0.000466955446
  error estimate for blocks of size 2^( 7) =       0.000470716897

      target function =                  N/A
              le_mean =     -16.905394363002
             les_mean =     286.138876482357
             stat err =       0.000463181249
             autocorr =       1.238243415529
              std dev =       0.588657869232
             le_variance =       0.346518087009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346647448619
                                         uncertainty =       0.006429210642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346647448619
                                         uncertainty =       0.006429210642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416245405
  error estimate for blocks of size 2^( 2) =       0.000428614605
  error estimate for blocks of size 2^( 3) =       0.000441173649
  error estimate for blocks of size 2^( 4) =       0.000452787465
  error estimate for blocks of size 2^( 5) =       0.000462267907
  error estimate for blocks of size 2^( 6) =       0.000466956756
  error estimate for blocks of size 2^( 7) =       0.000470718237

      target function =                  N/A
              le_mean =     -16.905394364675
             les_mean =     286.138878925895
             stat err =       0.000463182591
             autocorr =       1.238242060454
              std dev =       0.588659896680
             le_variance =       0.346520473959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905394364952        initial  <--
     9.0949e+00     9.0949e+01             1.6585e-05       -16.905394361886
     3.6380e+01     3.6380e+02             4.1657e-06       -16.905394363002
     1.4552e+02     1.4552e+03             1.0426e-06       -16.905394364675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1744
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.086437e-01 1 1  ON 0
 uu_1                 1.418333e-01 1 1  ON 1
 uu_2                 3.993044e-02 1 1  ON 2
 uu_3                -2.285446e-02 1 1  ON 3
 uu_4                -6.886815e-02 1 1  ON 4
 uu_5                -1.047780e-01 1 1  ON 5
 uu_6                -1.332111e-01 1 1  ON 6
 uu_7                -1.484438e-01 1 1  ON 7
 uu_8                -1.399226e-01 1 1  ON 8
 uu_9                -1.122735e-01 1 1  ON 9
 ud_0                 4.551113e-01 1 1  ON 10
 ud_1                 1.888606e-01 1 1  ON 11
 ud_2                 6.761172e-02 1 1  ON 12
 ud_3                -4.381464e-03 1 1  ON 13
 ud_4                -6.200798e-02 1 1  ON 14
 ud_5                -1.044082e-01 1 1  ON 15
 ud_6                -1.329161e-01 1 1  ON 16
 ud_7                -1.512640e-01 1 1  ON 17
 ud_8                -1.530639e-01 1 1  ON 18
 ud_9                -1.449144e-01 1 1  ON 19
 eO_0                -7.599129e-01 1 1  ON 20
 eO_1                -4.371106e-01 1 1  ON 21
 eO_2                -1.525087e-02 1 1  ON 22
 eO_3                 3.082190e-01 1 1  ON 23
 eO_4                 5.369531e-01 1 1  ON 24
 eO_5                 5.018650e-01 1 1  ON 25
 eO_6                 2.726753e-01 1 1  ON 26
 eO_7                -3.747388e-02 1 1  ON 27
 eO_8                -2.449523e-01 1 1  ON 28
 eO_9                -1.178142e-01 1 1  ON 29
eH1_0                -2.607501e-01 1 1  ON 30
eH1_1                -1.581603e-01 1 1  ON 31
eH1_2                -1.103550e-01 1 1  ON 32
eH1_3                -5.513262e-02 1 1  ON 33
eH1_4                -6.071014e-03 1 1  ON 34
eH1_5                 2.892923e-02 1 1  ON 35
eH1_6                 9.081477e-02 1 1  ON 36
eH1_7                 1.564203e-01 1 1  ON 37
eH1_8                 2.008453e-01 1 1  ON 38
eH1_9                 1.101015e-01 1 1  ON 39
eH2_0                -2.568063e-01 1 1  ON 40
eH2_1                -1.546830e-01 1 1  ON 41
eH2_2                -1.071805e-01 1 1  ON 42
eH2_3                -5.241133e-02 1 1  ON 43
eH2_4                -3.920835e-03 1 1  ON 44
eH2_5                 3.112628e-02 1 1  ON 45
eH2_6                 9.273233e-02 1 1  ON 46
eH2_7                 1.563687e-01 1 1  ON 47
eH2_8                 2.029849e-01 1 1  ON 48
eH2_9                 1.030151e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8778e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8799
    reference variance = 0.357703
====================================================
  Execution time = 2.1263e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3767e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337538204413
                                         uncertainty =       0.003488262368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337538204413
                                         uncertainty =       0.003488262368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410892860
  error estimate for blocks of size 2^( 2) =       0.000423853836
  error estimate for blocks of size 2^( 3) =       0.000436925085
  error estimate for blocks of size 2^( 4) =       0.000449567784
  error estimate for blocks of size 2^( 5) =       0.000459961298
  error estimate for blocks of size 2^( 6) =       0.000467834831
  error estimate for blocks of size 2^( 7) =       0.000471277577

      target function =                  N/A
              le_mean =     -16.906116746360
             les_mean =     286.154449157017
             stat err =       0.000462160373
             autocorr =       1.265109801915
              std dev =       0.581090254849
             le_variance =       0.337665884281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611674636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116746360       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116749609       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116750207       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116752317       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116752780       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116755720       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116752581       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116752542       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.370174e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116746360       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116747174       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116747324       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116747852       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116747968       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116748706       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116747923       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116747912       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.926307e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116746360       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116746564       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116746601       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116746734       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116746762       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116746949       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116746752       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116746746       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.481631e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6880e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.086438e-01 1 1  ON 0
 uu_1                 1.418332e-01 1 1  ON 1
 uu_2                 3.993039e-02 1 1  ON 2
 uu_3                -2.285449e-02 1 1  ON 3
 uu_4                -6.886856e-02 1 1  ON 4
 uu_5                -1.047780e-01 1 1  ON 5
 uu_6                -1.332111e-01 1 1  ON 6
 uu_7                -1.484437e-01 1 1  ON 7
 uu_8                -1.399227e-01 1 1  ON 8
 uu_9                -1.122734e-01 1 1  ON 9
 ud_0                 4.551114e-01 1 1  ON 10
 ud_1                 1.888604e-01 1 1  ON 11
 ud_2                 6.761178e-02 1 1  ON 12
 ud_3                -4.381352e-03 1 1  ON 13
 ud_4                -6.200801e-02 1 1  ON 14
 ud_5                -1.044081e-01 1 1  ON 15
 ud_6                -1.329163e-01 1 1  ON 16
 ud_7                -1.512641e-01 1 1  ON 17
 ud_8                -1.530637e-01 1 1  ON 18
 ud_9                -1.449142e-01 1 1  ON 19
 eO_0                -7.599129e-01 1 1  ON 20
 eO_1                -4.371102e-01 1 1  ON 21
 eO_2                -1.525081e-02 1 1  ON 22
 eO_3                 3.082188e-01 1 1  ON 23
 eO_4                 5.369534e-01 1 1  ON 24
 eO_5                 5.018651e-01 1 1  ON 25
 eO_6                 2.726753e-01 1 1  ON 26
 eO_7                -3.747397e-02 1 1  ON 27
 eO_8                -2.449525e-01 1 1  ON 28
 eO_9                -1.178145e-01 1 1  ON 29
eH1_0                -2.607502e-01 1 1  ON 30
eH1_1                -1.581603e-01 1 1  ON 31
eH1_2                -1.103550e-01 1 1  ON 32
eH1_3                -5.513308e-02 1 1  ON 33
eH1_4                -6.070985e-03 1 1  ON 34
eH1_5                 2.892943e-02 1 1  ON 35
eH1_6                 9.081481e-02 1 1  ON 36
eH1_7                 1.564201e-01 1 1  ON 37
eH1_8                 2.008453e-01 1 1  ON 38
eH1_9                 1.101019e-01 1 1  ON 39
eH2_0                -2.568063e-01 1 1  ON 40
eH2_1                -1.546832e-01 1 1  ON 41
eH2_2                -1.071808e-01 1 1  ON 42
eH2_3                -5.241158e-02 1 1  ON 43
eH2_4                -3.920851e-03 1 1  ON 44
eH2_5                 3.112610e-02 1 1  ON 45
eH2_6                 9.273239e-02 1 1  ON 46
eH2_7                 1.563688e-01 1 1  ON 47
eH2_8                 2.029850e-01 1 1  ON 48
eH2_9                 1.030157e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9551
    reference variance = 0.303055
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5228e-01
  Total weights = 2.0000e+06
  Execution time = 1.9010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352190736342
                                         uncertainty =       0.014506706869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352190736342
                                         uncertainty =       0.014506706869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419687419
  error estimate for blocks of size 2^( 2) =       0.000432224200
  error estimate for blocks of size 2^( 3) =       0.000445771860
  error estimate for blocks of size 2^( 4) =       0.000458040243
  error estimate for blocks of size 2^( 5) =       0.000468009804
  error estimate for blocks of size 2^( 6) =       0.000475117847
  error estimate for blocks of size 2^( 7) =       0.000482719249

      target function =                  N/A
              le_mean =     -16.905958265895
             les_mean =     286.163699770999
             stat err =       0.000470971786
             autocorr =       1.259325162842
              std dev =       0.593527639585
             le_variance =       0.352275058952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352191249600
                                         uncertainty =       0.014506755038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352191249600
                                         uncertainty =       0.014506755038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419687725
  error estimate for blocks of size 2^( 2) =       0.000432224499
  error estimate for blocks of size 2^( 3) =       0.000445772162
  error estimate for blocks of size 2^( 4) =       0.000458040549
  error estimate for blocks of size 2^( 5) =       0.000468010105
  error estimate for blocks of size 2^( 6) =       0.000475118130
  error estimate for blocks of size 2^( 7) =       0.000482719521

      target function =                  N/A
              le_mean =     -16.905958273692
             les_mean =     286.163700548596
             stat err =       0.000470972076
             autocorr =       1.259324879129
              std dev =       0.593528072561
             le_variance =       0.352275572918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352190994076
                                         uncertainty =       0.014506731016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352190994076
                                         uncertainty =       0.014506731016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419687573
  error estimate for blocks of size 2^( 2) =       0.000432224350
  error estimate for blocks of size 2^( 3) =       0.000445772012
  error estimate for blocks of size 2^( 4) =       0.000458040397
  error estimate for blocks of size 2^( 5) =       0.000468009955
  error estimate for blocks of size 2^( 6) =       0.000475117989
  error estimate for blocks of size 2^( 7) =       0.000482719386

      target function =                  N/A
              le_mean =     -16.905958269806
             les_mean =     286.163700161327
             stat err =       0.000470971932
             autocorr =       1.259325020375
              std dev =       0.593527857005
             le_variance =       0.352275317041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352190768592
                                         uncertainty =       0.014506709890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352190768592
                                         uncertainty =       0.014506709890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419687438
  error estimate for blocks of size 2^( 2) =       0.000432224219
  error estimate for blocks of size 2^( 3) =       0.000445771879
  error estimate for blocks of size 2^( 4) =       0.000458040262
  error estimate for blocks of size 2^( 5) =       0.000468009823
  error estimate for blocks of size 2^( 6) =       0.000475117865
  error estimate for blocks of size 2^( 7) =       0.000482719266

      target function =                  N/A
              le_mean =     -16.905958266384
             les_mean =     286.163699819830
             stat err =       0.000470971804
             autocorr =       1.259325145011
              std dev =       0.593527666791
             le_variance =       0.352275091247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905958265895        initial
     9.0949e+01     9.0949e+02             2.3702e-06       -16.905958273692  <--
     3.6380e+02     3.6380e+03             5.9263e-07       -16.905958269806
     1.4552e+03     1.4552e+04             1.4816e-07       -16.905958266384

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 2.9813e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.086443e-01 1 1  ON 0
 uu_1                 1.418328e-01 1 1  ON 1
 uu_2                 3.993026e-02 1 1  ON 2
 uu_3                -2.285457e-02 1 1  ON 3
 uu_4                -6.886976e-02 1 1  ON 4
 uu_5                -1.047780e-01 1 1  ON 5
 uu_6                -1.332114e-01 1 1  ON 6
 uu_7                -1.484434e-01 1 1  ON 7
 uu_8                -1.399230e-01 1 1  ON 8
 uu_9                -1.122731e-01 1 1  ON 9
 ud_0                 4.551115e-01 1 1  ON 10
 ud_1                 1.888600e-01 1 1  ON 11
 ud_2                 6.761193e-02 1 1  ON 12
 ud_3                -4.381016e-03 1 1  ON 13
 ud_4                -6.200809e-02 1 1  ON 14
 ud_5                -1.044077e-01 1 1  ON 15
 ud_6                -1.329169e-01 1 1  ON 16
 ud_7                -1.512645e-01 1 1  ON 17
 ud_8                -1.530631e-01 1 1  ON 18
 ud_9                -1.449135e-01 1 1  ON 19
 eO_0                -7.599128e-01 1 1  ON 20
 eO_1                -4.371091e-01 1 1  ON 21
 eO_2                -1.525063e-02 1 1  ON 22
 eO_3                 3.082181e-01 1 1  ON 23
 eO_4                 5.369541e-01 1 1  ON 24
 eO_5                 5.018656e-01 1 1  ON 25
 eO_6                 2.726751e-01 1 1  ON 26
 eO_7                -3.747421e-02 1 1  ON 27
 eO_8                -2.449528e-01 1 1  ON 28
 eO_9                -1.178154e-01 1 1  ON 29
eH1_0                -2.607506e-01 1 1  ON 30
eH1_1                -1.581604e-01 1 1  ON 31
eH1_2                -1.103549e-01 1 1  ON 32
eH1_3                -5.513448e-02 1 1  ON 33
eH1_4                -6.070899e-03 1 1  ON 34
eH1_5                 2.893002e-02 1 1  ON 35
eH1_6                 9.081493e-02 1 1  ON 36
eH1_7                 1.564196e-01 1 1  ON 37
eH1_8                 2.008455e-01 1 1  ON 38
eH1_9                 1.101030e-01 1 1  ON 39
eH2_0                -2.568064e-01 1 1  ON 40
eH2_1                -1.546838e-01 1 1  ON 41
eH2_2                -1.071817e-01 1 1  ON 42
eH2_3                -5.241234e-02 1 1  ON 43
eH2_4                -3.920900e-03 1 1  ON 44
eH2_5                 3.112556e-02 1 1  ON 45
eH2_6                 9.273254e-02 1 1  ON 46
eH2_7                 1.563690e-01 1 1  ON 47
eH2_8                 2.029854e-01 1 1  ON 48
eH2_9                 1.030175e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9387
    reference variance = 0.566112
====================================================
  Execution time = 2.0590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4538e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345162161427
                                         uncertainty =       0.007895660037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345162161427
                                         uncertainty =       0.007895660037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415556987
  error estimate for blocks of size 2^( 2) =       0.000428338701
  error estimate for blocks of size 2^( 3) =       0.000441142598
  error estimate for blocks of size 2^( 4) =       0.000453511546
  error estimate for blocks of size 2^( 5) =       0.000464685996
  error estimate for blocks of size 2^( 6) =       0.000472003014
  error estimate for blocks of size 2^( 7) =       0.000476437375

      target function =                  N/A
              le_mean =     -16.905873352299
             les_mean =     286.153928849525
             stat err =       0.000466659483
             autocorr =       1.261069475567
              std dev =       0.587686326402
             le_variance =       0.345375218240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587335230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905873352299       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905873379134       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905873413219       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905873438906       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905873432848       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905873437282       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905873429787       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905873428817       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 8.220377e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905873352299       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905873359052       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905873367759       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905873374251       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905873372763       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905873373849       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905873371942       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905873371707       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.056020e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905873352299       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905873353990       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905873356179       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905873357806       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905873357436       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905873357706       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905873357227       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905873357169       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.140650e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6237e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.086452e-01 1 1  ON 0
 uu_1                 1.418326e-01 1 1  ON 1
 uu_2                 3.993055e-02 1 1  ON 2
 uu_3                -2.285574e-02 1 1  ON 3
 uu_4                -6.887071e-02 1 1  ON 4
 uu_5                -1.047776e-01 1 1  ON 5
 uu_6                -1.332106e-01 1 1  ON 6
 uu_7                -1.484437e-01 1 1  ON 7
 uu_8                -1.399240e-01 1 1  ON 8
 uu_9                -1.122737e-01 1 1  ON 9
 ud_0                 4.551127e-01 1 1  ON 10
 ud_1                 1.888606e-01 1 1  ON 11
 ud_2                 6.761097e-02 1 1  ON 12
 ud_3                -4.380374e-03 1 1  ON 13
 ud_4                -6.200882e-02 1 1  ON 14
 ud_5                -1.044086e-01 1 1  ON 15
 ud_6                -1.329178e-01 1 1  ON 16
 ud_7                -1.512641e-01 1 1  ON 17
 ud_8                -1.530624e-01 1 1  ON 18
 ud_9                -1.449129e-01 1 1  ON 19
 eO_0                -7.599130e-01 1 1  ON 20
 eO_1                -4.371098e-01 1 1  ON 21
 eO_2                -1.524905e-02 1 1  ON 22
 eO_3                 3.082187e-01 1 1  ON 23
 eO_4                 5.369558e-01 1 1  ON 24
 eO_5                 5.018660e-01 1 1  ON 25
 eO_6                 2.726748e-01 1 1  ON 26
 eO_7                -3.747465e-02 1 1  ON 27
 eO_8                -2.449539e-01 1 1  ON 28
 eO_9                -1.178166e-01 1 1  ON 29
eH1_0                -2.607501e-01 1 1  ON 30
eH1_1                -1.581616e-01 1 1  ON 31
eH1_2                -1.103546e-01 1 1  ON 32
eH1_3                -5.513556e-02 1 1  ON 33
eH1_4                -6.070163e-03 1 1  ON 34
eH1_5                 2.892914e-02 1 1  ON 35
eH1_6                 9.081378e-02 1 1  ON 36
eH1_7                 1.564188e-01 1 1  ON 37
eH1_8                 2.008461e-01 1 1  ON 38
eH1_9                 1.101051e-01 1 1  ON 39
eH2_0                -2.568066e-01 1 1  ON 40
eH2_1                -1.546839e-01 1 1  ON 41
eH2_2                -1.071824e-01 1 1  ON 42
eH2_3                -5.241290e-02 1 1  ON 43
eH2_4                -3.921867e-03 1 1  ON 44
eH2_5                 3.112597e-02 1 1  ON 45
eH2_6                 9.273321e-02 1 1  ON 46
eH2_7                 1.563683e-01 1 1  ON 47
eH2_8                 2.029853e-01 1 1  ON 48
eH2_9                 1.030194e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8984
    reference variance = 0.238227
====================================================
  Execution time = 2.0572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3684e-01
  Total weights = 2.0000e+06
  Execution time = 1.9187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336910796328
                                         uncertainty =       0.002911576031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336910796328
                                         uncertainty =       0.002911576031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410389191
  error estimate for blocks of size 2^( 2) =       0.000423006400
  error estimate for blocks of size 2^( 3) =       0.000436443926
  error estimate for blocks of size 2^( 4) =       0.000448720192
  error estimate for blocks of size 2^( 5) =       0.000458382457
  error estimate for blocks of size 2^( 6) =       0.000463790134
  error estimate for blocks of size 2^( 7) =       0.000468302773

      target function =                  N/A
              le_mean =     -16.905503810129
             les_mean =     286.132897481762
             stat err =       0.000459798889
             autocorr =       1.255289822755
              std dev =       0.580377959514
             le_variance =       0.336838575890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336917333350
                                         uncertainty =       0.002911625687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336917333350
                                         uncertainty =       0.002911625687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410393172
  error estimate for blocks of size 2^( 2) =       0.000423010127
  error estimate for blocks of size 2^( 3) =       0.000436447396
  error estimate for blocks of size 2^( 4) =       0.000448723552
  error estimate for blocks of size 2^( 5) =       0.000458385572
  error estimate for blocks of size 2^( 6) =       0.000463793065
  error estimate for blocks of size 2^( 7) =       0.000468305761

      target function =                  N/A
              le_mean =     -16.905503810232
             les_mean =     286.132904020084
             stat err =       0.000459801987
             autocorr =       1.255282387992
              std dev =       0.580383589297
             le_variance =       0.336845110725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336914091994
                                         uncertainty =       0.002911600989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336914091994
                                         uncertainty =       0.002911600989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410391198
  error estimate for blocks of size 2^( 2) =       0.000423008279
  error estimate for blocks of size 2^( 3) =       0.000436445674
  error estimate for blocks of size 2^( 4) =       0.000448721885
  error estimate for blocks of size 2^( 5) =       0.000458384027
  error estimate for blocks of size 2^( 6) =       0.000463791610
  error estimate for blocks of size 2^( 7) =       0.000468304279

      target function =                  N/A
              le_mean =     -16.905503810230
             les_mean =     286.132900779743
             stat err =       0.000459800451
             autocorr =       1.255286072348
              std dev =       0.580380797798
             le_variance =       0.336841870453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336911209102
                                         uncertainty =       0.002911579155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336911209102
                                         uncertainty =       0.002911579155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410389442
  error estimate for blocks of size 2^( 2) =       0.000423006635
  error estimate for blocks of size 2^( 3) =       0.000436444145
  error estimate for blocks of size 2^( 4) =       0.000448720404
  error estimate for blocks of size 2^( 5) =       0.000458382654
  error estimate for blocks of size 2^( 6) =       0.000463790319
  error estimate for blocks of size 2^( 7) =       0.000468302962

      target function =                  N/A
              le_mean =     -16.905503810138
             les_mean =     286.132897894695
             stat err =       0.000459799084
             autocorr =       1.255289352897
              std dev =       0.580378315003
             le_variance =       0.336838988525


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905503810129        initial
     2.2737e+01     2.2737e+02             8.2204e-06       -16.905503810232  <--
     9.0949e+01     9.0949e+02             2.0560e-06       -16.905503810230
     3.6380e+02     3.6380e+03             5.1407e-07       -16.905503810138

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 3.0228e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.086481e-01 1 1  ON 0
 uu_1                 1.418317e-01 1 1  ON 1
 uu_2                 3.993139e-02 1 1  ON 2
 uu_3                -2.285921e-02 1 1  ON 3
 uu_4                -6.887356e-02 1 1  ON 4
 uu_5                -1.047765e-01 1 1  ON 5
 uu_6                -1.332081e-01 1 1  ON 6
 uu_7                -1.484446e-01 1 1  ON 7
 uu_8                -1.399270e-01 1 1  ON 8
 uu_9                -1.122755e-01 1 1  ON 9
 ud_0                 4.551162e-01 1 1  ON 10
 ud_1                 1.888624e-01 1 1  ON 11
 ud_2                 6.760817e-02 1 1  ON 12
 ud_3                -4.378522e-03 1 1  ON 13
 ud_4                -6.201096e-02 1 1  ON 14
 ud_5                -1.044114e-01 1 1  ON 15
 ud_6                -1.329205e-01 1 1  ON 16
 ud_7                -1.512631e-01 1 1  ON 17
 ud_8                -1.530602e-01 1 1  ON 18
 ud_9                -1.449112e-01 1 1  ON 19
 eO_0                -7.599133e-01 1 1  ON 20
 eO_1                -4.371121e-01 1 1  ON 21
 eO_2                -1.524435e-02 1 1  ON 22
 eO_3                 3.082205e-01 1 1  ON 23
 eO_4                 5.369608e-01 1 1  ON 24
 eO_5                 5.018669e-01 1 1  ON 25
 eO_6                 2.726738e-01 1 1  ON 26
 eO_7                -3.747596e-02 1 1  ON 27
 eO_8                -2.449573e-01 1 1  ON 28
 eO_9                -1.178200e-01 1 1  ON 29
eH1_0                -2.607486e-01 1 1  ON 30
eH1_1                -1.581651e-01 1 1  ON 31
eH1_2                -1.103538e-01 1 1  ON 32
eH1_3                -5.513877e-02 1 1  ON 33
eH1_4                -6.067982e-03 1 1  ON 34
eH1_5                 2.892651e-02 1 1  ON 35
eH1_6                 9.081033e-02 1 1  ON 36
eH1_7                 1.564165e-01 1 1  ON 37
eH1_8                 2.008480e-01 1 1  ON 38
eH1_9                 1.101113e-01 1 1  ON 39
eH2_0                -2.568072e-01 1 1  ON 40
eH2_1                -1.546842e-01 1 1  ON 41
eH2_2                -1.071847e-01 1 1  ON 42
eH2_3                -5.241458e-02 1 1  ON 43
eH2_4                -3.924761e-03 1 1  ON 44
eH2_5                 3.112718e-02 1 1  ON 45
eH2_6                 9.273520e-02 1 1  ON 46
eH2_7                 1.563661e-01 1 1  ON 47
eH2_8                 2.029848e-01 1 1  ON 48
eH2_9                 1.030251e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8381
    reference variance = 0.410619
====================================================
  Execution time = 2.0881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3600e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335965149662
                                         uncertainty =       0.005279242697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335965149662
                                         uncertainty =       0.005279242697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409877311
  error estimate for blocks of size 2^( 2) =       0.000422837930
  error estimate for blocks of size 2^( 3) =       0.000436370991
  error estimate for blocks of size 2^( 4) =       0.000449061067
  error estimate for blocks of size 2^( 5) =       0.000459178053
  error estimate for blocks of size 2^( 6) =       0.000467577291
  error estimate for blocks of size 2^( 7) =       0.000474541633

      target function =                  N/A
              le_mean =     -16.905026628249
             les_mean =     286.115923953650
             stat err =       0.000462589511
             autocorr =       1.273748853220
              std dev =       0.579654051853
             le_variance =       0.335998819830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690502662825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905026628249       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905026631199       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905026544914       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905026592610       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905026569058       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905026526988       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905026524554       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905026524022       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+00 is 3.322742e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905026628249       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905026629011       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905026606439       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905026618189       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905026611887       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905026600549       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905026599813       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905026599417       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 8.508161e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905026628249       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905026628441       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905026622732       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905026625657       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905026624052       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905026621160       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905026620968       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905026620851       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.145922e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166242 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6574e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.086566e-01 1 1  ON 0
 uu_1                 1.418308e-01 1 1  ON 1
 uu_2                 3.992646e-02 1 1  ON 2
 uu_3                -2.286302e-02 1 1  ON 3
 uu_4                -6.887723e-02 1 1  ON 4
 uu_5                -1.047750e-01 1 1  ON 5
 uu_6                -1.332085e-01 1 1  ON 6
 uu_7                -1.484468e-01 1 1  ON 7
 uu_8                -1.399306e-01 1 1  ON 8
 uu_9                -1.122725e-01 1 1  ON 9
 ud_0                 4.551217e-01 1 1  ON 10
 ud_1                 1.888610e-01 1 1  ON 11
 ud_2                 6.760993e-02 1 1  ON 12
 ud_3                -4.380618e-03 1 1  ON 13
 ud_4                -6.201005e-02 1 1  ON 14
 ud_5                -1.044128e-01 1 1  ON 15
 ud_6                -1.329236e-01 1 1  ON 16
 ud_7                -1.512672e-01 1 1  ON 17
 ud_8                -1.530568e-01 1 1  ON 18
 ud_9                -1.449076e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.371141e-01 1 1  ON 21
 eO_2                -1.524057e-02 1 1  ON 22
 eO_3                 3.082233e-01 1 1  ON 23
 eO_4                 5.369617e-01 1 1  ON 24
 eO_5                 5.018675e-01 1 1  ON 25
 eO_6                 2.726729e-01 1 1  ON 26
 eO_7                -3.747769e-02 1 1  ON 27
 eO_8                -2.449589e-01 1 1  ON 28
 eO_9                -1.178241e-01 1 1  ON 29
eH1_0                -2.607513e-01 1 1  ON 30
eH1_1                -1.581620e-01 1 1  ON 31
eH1_2                -1.103514e-01 1 1  ON 32
eH1_3                -5.514631e-02 1 1  ON 33
eH1_4                -6.070572e-03 1 1  ON 34
eH1_5                 2.892289e-02 1 1  ON 35
eH1_6                 9.080833e-02 1 1  ON 36
eH1_7                 1.564164e-01 1 1  ON 37
eH1_8                 2.008513e-01 1 1  ON 38
eH1_9                 1.101190e-01 1 1  ON 39
eH2_0                -2.568104e-01 1 1  ON 40
eH2_1                -1.546925e-01 1 1  ON 41
eH2_2                -1.071830e-01 1 1  ON 42
eH2_3                -5.241483e-02 1 1  ON 43
eH2_4                -3.922002e-03 1 1  ON 44
eH2_5                 3.112457e-02 1 1  ON 45
eH2_6                 9.273506e-02 1 1  ON 46
eH2_7                 1.563647e-01 1 1  ON 47
eH2_8                 2.029864e-01 1 1  ON 48
eH2_9                 1.030335e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9151
    reference variance = 0.303607
====================================================
  Execution time = 2.0764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4236e-01
  Total weights = 2.0000e+06
  Execution time = 1.9411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342457772593
                                         uncertainty =       0.006199951498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342457772593
                                         uncertainty =       0.006199951498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413732453
  error estimate for blocks of size 2^( 2) =       0.000426041528
  error estimate for blocks of size 2^( 3) =       0.000438603529
  error estimate for blocks of size 2^( 4) =       0.000450807702
  error estimate for blocks of size 2^( 5) =       0.000460430543
  error estimate for blocks of size 2^( 6) =       0.000465654337
  error estimate for blocks of size 2^( 7) =       0.000470232747

      target function =                  N/A
              le_mean =     -16.906502979487
             les_mean =     286.172191909910
             stat err =       0.000461781332
             autocorr =       1.245757665426
              std dev =       0.585106046528
             le_variance =       0.342349085683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342484522448
                                         uncertainty =       0.006201131645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342484522448
                                         uncertainty =       0.006201131645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413748616
  error estimate for blocks of size 2^( 2) =       0.000426057203
  error estimate for blocks of size 2^( 3) =       0.000438618601
  error estimate for blocks of size 2^( 4) =       0.000450822729
  error estimate for blocks of size 2^( 5) =       0.000460445507
  error estimate for blocks of size 2^( 6) =       0.000465669483
  error estimate for blocks of size 2^( 7) =       0.000470248101

      target function =                  N/A
              le_mean =     -16.906503117685
             les_mean =     286.172223331732
             stat err =       0.000461796455
             autocorr =       1.245741926024
              std dev =       0.585128904282
             le_variance =       0.342375834626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342471758539
                                         uncertainty =       0.006200558626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342471758539
                                         uncertainty =       0.006200558626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413740904
  error estimate for blocks of size 2^( 2) =       0.000426049724
  error estimate for blocks of size 2^( 3) =       0.000438611413
  error estimate for blocks of size 2^( 4) =       0.000450815568
  error estimate for blocks of size 2^( 5) =       0.000460438381
  error estimate for blocks of size 2^( 6) =       0.000465662271
  error estimate for blocks of size 2^( 7) =       0.000470240779

      target function =                  N/A
              le_mean =     -16.906503045920
             les_mean =     286.172208141725
             stat err =       0.000461789250
             autocorr =       1.245749492475
              std dev =       0.585117997688
             le_variance =       0.342363071218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342459540255
                                         uncertainty =       0.006200027948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342459540255
                                         uncertainty =       0.006200027948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413733521
  error estimate for blocks of size 2^( 2) =       0.000426042564
  error estimate for blocks of size 2^( 3) =       0.000438604526
  error estimate for blocks of size 2^( 4) =       0.000450808697
  error estimate for blocks of size 2^( 5) =       0.000460431534
  error estimate for blocks of size 2^( 6) =       0.000465655340
  error estimate for blocks of size 2^( 7) =       0.000470233762

      target function =                  N/A
              le_mean =     -16.906502987551
             les_mean =     286.172193950188
             stat err =       0.000461782333
             autocorr =       1.245756633557
              std dev =       0.585107557032
             le_variance =       0.342350853296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906502979487        initial
     5.6843e+00     5.6843e+01             3.3227e-05       -16.906503117685  <--
     2.2737e+01     2.2737e+02             8.5082e-06       -16.906503045920
     9.0949e+01     9.0949e+02             2.1459e-06       -16.906502987551

*****************************************************************************
Applying the update for shift_i =   5.6843e+00     and shift_s =   5.6843e+01
*****************************************************************************

  Execution time = 3.0468e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.086810e-01 1 1  ON 0
 uu_1                 1.418276e-01 1 1  ON 1
 uu_2                 3.991259e-02 1 1  ON 2
 uu_3                -2.287448e-02 1 1  ON 3
 uu_4                -6.888759e-02 1 1  ON 4
 uu_5                -1.047711e-01 1 1  ON 5
 uu_6                -1.332092e-01 1 1  ON 6
 uu_7                -1.484532e-01 1 1  ON 7
 uu_8                -1.399413e-01 1 1  ON 8
 uu_9                -1.122635e-01 1 1  ON 9
 ud_0                 4.551367e-01 1 1  ON 10
 ud_1                 1.888574e-01 1 1  ON 11
 ud_2                 6.761473e-02 1 1  ON 12
 ud_3                -4.386270e-03 1 1  ON 13
 ud_4                -6.200765e-02 1 1  ON 14
 ud_5                -1.044169e-01 1 1  ON 15
 ud_6                -1.329327e-01 1 1  ON 16
 ud_7                -1.512793e-01 1 1  ON 17
 ud_8                -1.530467e-01 1 1  ON 18
 ud_9                -1.448968e-01 1 1  ON 19
 eO_0                -7.599038e-01 1 1  ON 20
 eO_1                -4.371188e-01 1 1  ON 21
 eO_2                -1.522967e-02 1 1  ON 22
 eO_3                 3.082319e-01 1 1  ON 23
 eO_4                 5.369644e-01 1 1  ON 24
 eO_5                 5.018692e-01 1 1  ON 25
 eO_6                 2.726701e-01 1 1  ON 26
 eO_7                -3.748283e-02 1 1  ON 27
 eO_8                -2.449636e-01 1 1  ON 28
 eO_9                -1.178361e-01 1 1  ON 29
eH1_0                -2.607592e-01 1 1  ON 30
eH1_1                -1.581533e-01 1 1  ON 31
eH1_2                -1.103449e-01 1 1  ON 32
eH1_3                -5.516799e-02 1 1  ON 33
eH1_4                -6.078585e-03 1 1  ON 34
eH1_5                 2.891223e-02 1 1  ON 35
eH1_6                 9.080243e-02 1 1  ON 36
eH1_7                 1.564159e-01 1 1  ON 37
eH1_8                 2.008612e-01 1 1  ON 38
eH1_9                 1.101420e-01 1 1  ON 39
eH2_0                -2.568201e-01 1 1  ON 40
eH2_1                -1.547166e-01 1 1  ON 41
eH2_2                -1.071783e-01 1 1  ON 42
eH2_3                -5.241546e-02 1 1  ON 43
eH2_4                -3.913924e-03 1 1  ON 44
eH2_5                 3.111693e-02 1 1  ON 45
eH2_6                 9.273462e-02 1 1  ON 46
eH2_7                 1.563604e-01 1 1  ON 47
eH2_8                 2.029912e-01 1 1  ON 48
eH2_9                 1.030583e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7047e+01 secs
  Total Execution time = 2.2967e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
